{"meta":{"version":1,"warehouse":"3.0.2"},"models":{"Asset":[{"_id":"source/live2d-widget/LICENSE","path":"live2d-widget/LICENSE","modified":1,"renderable":0},{"_id":"source/live2d-widget/assets/browserstack.svg","path":"live2d-widget/assets/browserstack.svg","modified":1,"renderable":0},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon.png","path":"images/apple-touch-icon.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16.ico","path":"images/favicon-16x16.ico","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32.ico","path":"images/favicon-32x32.ico","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/js/algolia-search.js","path":"js/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/bookmark.js","path":"js/bookmark.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/local-search.js","path":"js/local-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/motion.js","path":"js/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/next-boot.js","path":"js/next-boot.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/anime.min.js","path":"lib/anime.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/uploads/alipay.png","path":"uploads/alipay.png","modified":1,"renderable":1},{"_id":"themes/next/source/uploads/avatar.jpg","path":"uploads/avatar.jpg","modified":1,"renderable":1},{"_id":"themes/next/source/uploads/beian.png","path":"uploads/beian.png","modified":1,"renderable":1},{"_id":"themes/next/source/uploads/wechat.png","path":"uploads/wechat.png","modified":1,"renderable":1},{"_id":"source/live2d-widget/assets/screenshot-1.png","path":"live2d-widget/assets/screenshot-1.png","modified":1,"renderable":0},{"_id":"source/live2d-widget/assets/screenshot-2.png","path":"live2d-widget/assets/screenshot-2.png","modified":1,"renderable":0},{"_id":"source/live2d-widget/assets/screenshot-3.png","path":"live2d-widget/assets/screenshot-3.png","modified":1,"renderable":0},{"_id":"themes/next/source/js/src/jquery.backstretch.min.js","path":"js/src/jquery.backstretch.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/schemes/muse.js","path":"js/schemes/muse.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/schemes/pisces.js","path":"js/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/busuanzi.pure.mini.js","path":"js/src/busuanzi.pure.mini.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/custom.js","path":"js/src/custom.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/LICENSE","path":"lib/canvas-nest/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/README.md","path":"lib/canvas-nest/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest-nomobile.min.js","path":"lib/canvas-nest/canvas-nest-nomobile.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/LICENSE","path":"lib/canvas-ribbon/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/README.md","path":"lib/canvas-ribbon/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/LICENSE","path":"lib/fancybox/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/README.md","path":"lib/fancybox/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/LICENSE","path":"lib/pace/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/README.md","path":"lib/pace/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","path":"lib/pace/pace-theme-barber-shop.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","path":"lib/pace/pace-theme-big-counter.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","path":"lib/pace/pace-theme-bounce.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","path":"lib/pace/pace-theme-center-atom.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","path":"lib/pace/pace-theme-center-circle.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","path":"lib/pace/pace-theme-center-radar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","path":"lib/pace/pace-theme-center-simple.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","path":"lib/pace/pace-theme-corner-indicator.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","path":"lib/pace/pace-theme-fill-left.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","path":"lib/pace/pace-theme-flash.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-flat-top.min.css","path":"lib/pace/pace-theme-flat-top.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","path":"lib/pace/pace-theme-loading-bar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","path":"lib/pace/pace-theme-mac-osx.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-material.min.css","path":"lib/pace/pace-theme-material.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","path":"lib/pace/pace-theme-minimal.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace.min.js","path":"lib/pace/pace.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/LICENSE","path":"lib/three/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/README.md","path":"lib/three/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/gulpfile.js","path":"lib/three/gulpfile.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/package.json","path":"lib/three/package.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/renovate.json","path":"lib/three/renovate.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/jquery.min.js","path":"js/src/jquery.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/images/background/bg1.jpg","path":"images/background/bg1.jpg","modified":1,"renderable":1},{"_id":"themes/next/source/images/background/bg2.jpg","path":"images/background/bg2.jpg","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.min.css","path":"lib/fancybox/source/jquery.fancybox.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/lib/CanvasRenderer.js","path":"lib/three/lib/CanvasRenderer.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/lib/Projector.js","path":"lib/three/lib/Projector.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/src/canvas_lines.js","path":"lib/three/src/canvas_lines.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/src/canvas_sphere.js","path":"lib/three/src/canvas_sphere.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/src/three-waves.js","path":"lib/three/src/three-waves.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.min.js","path":"lib/fancybox/source/jquery.fancybox.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/package-lock.json","path":"lib/three/package-lock.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/images/background/bg3.jpg","path":"images/background/bg3.jpg","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":1,"renderable":1}],"Cache":[{"_id":"themes/next/.editorconfig","hash":"8570735a8d8d034a3a175afd1dd40b39140b3e6a","modified":1579022805774},{"_id":"themes/next/.eslintrc.json","hash":"cc5f297f0322672fe3f684f823bc4659e4a54c41","modified":1579022805774},{"_id":"themes/next/.gitattributes","hash":"a54f902957d49356376b59287b894b1a3d7a003f","modified":1579022805774},{"_id":"themes/next/.gitignore","hash":"7b68ca7a46104cf9aa84ec0541a4856ab1836eca","modified":1579022805774},{"_id":"themes/next/.stylintrc","hash":"2cf4d637b56d8eb423f59656a11f6403aa90f550","modified":1579022805774},{"_id":"themes/next/.travis.yml","hash":"ecca3b919a5b15886e3eca58aa84aafc395590da","modified":1579022805774},{"_id":"themes/next/LICENSE.md","hash":"18144d8ed58c75af66cb419d54f3f63374cd5c5b","modified":1579022805774},{"_id":"themes/next/README.md","hash":"dc026053a4d9fb97a58dbc3e9060e480f6852b23","modified":1579022805774},{"_id":"themes/next/_config.yml","hash":"09e07d324157799678b1832611a1aa227c704559","modified":1579449476389},{"_id":"themes/next/crowdin.yml","hash":"e026078448c77dcdd9ef50256bb6635a8f83dca6","modified":1579022805774},{"_id":"themes/next/gulpfile.js","hash":"72e6d5a6e32d5f95d82e4c4d0c963d39555bb760","modified":1579022805778},{"_id":"themes/next/package.json","hash":"9eaaea20e5f778cf60b9a8418c9c20764a5e3dbb","modified":1579032847564},{"_id":"source/_posts/2019银川ACM区域赛总结.md","hash":"17de71625664b7c7eeed4dce69a94c147bfa7525","modified":1579035631675},{"_id":"source/_posts/Hexo-NexT魔改系列-01-准备工作.md","hash":"0653993a31fc923fe2327144dea33a48172b6567","modified":1579033846181},{"_id":"source/_posts/Hexo-NexT魔改系列-02-配置博客背景轮播图.md","hash":"bb0223e2bf07c0c9c7ef85b17b38304622fe8839","modified":1579033846297},{"_id":"source/_posts/Hexo-NexT魔改系列-03-添加数据统计.md","hash":"6f499a5d06b4768bfda703e943b5e1ea572762a6","modified":1579033846413},{"_id":"source/_posts/Hexo-NexT魔改系列-04-进阶设置.md","hash":"5b2e423aa91a0c8c24a4a184310674c4817696eb","modified":1579033846533},{"_id":"source/_posts/Hexo博客的安装与基本配置.md","hash":"40976b7a690c1486737bb6753c50d777d2bc87f3","modified":1579033846681},{"_id":"source/_posts/JavaScript的基本组成部分.md","hash":"3562bead83157242d29274f7c2da8020da64fde7","modified":1579033846797},{"_id":"source/_posts/JavaScript观察者模式与发布订阅.md","hash":"4aa0dd8752089815f5587357d564bf366611296c","modified":1579437611473},{"_id":"source/_posts/JavaScript面向对象-01-Constructor.md","hash":"cd2f1d0113f19234dc6cb4a0472d04739bea499c","modified":1579033846917},{"_id":"source/_posts/JavaScript面向对象-02-Prototype.md","hash":"4f9ed0e17572ce1a33479521364c4e6f8295c09e","modified":1579036672384},{"_id":"source/_posts/JavaScript面向对象-03-原型中的注意点.md","hash":"0bbc82b7cd83b6e091c0dfb68f07c2a3e49a1dce","modified":1579033847133},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm.md","hash":"5698655308a5a331063f3a786110c24eb3e67d1a","modified":1579033847369},{"_id":"source/_posts/UML图例详解.md","hash":"5e3151b527e12e05e37fa0557ee7dffcab40ac6c","modified":1579033847525},{"_id":"source/_posts/主流浏览器内核简述与Web标准.md","hash":"c67e3a6ba20c1a28bdbbba86704b35c19f06dc1f","modified":1579625001923},{"_id":"source/_posts/关于渐进增强与优雅降级.md","hash":"f2de07c1d78022d80ba76b41757dfb76ae29454d","modified":1579033847765},{"_id":"source/_posts/原生JavaScript实现Ajax.md","hash":"59a0078d0a3411483b356214e696916502a1b9de","modified":1579033847877},{"_id":"source/_posts/原生JavaScript实现Promise.md","hash":"ca307143ff217798f435294638d125d4d02205ce","modified":1579638052199},{"_id":"source/_posts/在Apache上开始部署ThinkPHP5.md","hash":"746966c9cfd5d2ed26ce82980b4b59d369b8dc6d","modified":1579033848005},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧.md","hash":"65987a86bee6f9f3fbbec647a621a96f1f9b363c","modified":1579447575304},{"_id":"source/_posts/设置你喜欢的live2d看板娘.md","hash":"57716434485dfdd8de15f4ee6603621540ee8fcc","modified":1579033848125},{"_id":"source/about/index.md","hash":"05e8fc507ab24ac12dc435a6738708b1ae611c54","modified":1579036150460},{"_id":"source/categories/index.md","hash":"534c95bbd234fe2634f7de6eb1be52dc92c524f5","modified":1579023255122},{"_id":"source/live2d-widget/LICENSE","hash":"31a3d460bb3c7d98845187c716a30db81c44b615","modified":1579031303486},{"_id":"source/live2d-widget/README.md","hash":"4a3e515e3fd505c0992755f3d0cd4490205ad4cd","modified":1579031303486},{"_id":"source/live2d-widget/autoload.js","hash":"9c6fdbad32ff0b05472aa185036d18c572d8590f","modified":1579448002651},{"_id":"source/live2d-widget/waifu-tips.js","hash":"35c2eef15315d737a9b6f14353074e651baa7954","modified":1579031419626},{"_id":"source/live2d-widget/waifu-tips.json","hash":"a2332332270c462b62bbe4b5a324d4088e7bec4d","modified":1579031419782},{"_id":"source/live2d-widget/waifu.css","hash":"914b4ec2624c931b2808e0961df079122776a8be","modified":1579449654565},{"_id":"source/tags/index.md","hash":"23b3c88fd2686c83402ec5425207bd004fe2f4fd","modified":1579023212490},{"_id":"themes/next/.github/CODE_OF_CONDUCT.md","hash":"aa4cb7aff595ca628cb58160ee1eee117989ec4e","modified":1579022805774},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"5ef63f34bd3b6bd4d7304d48ce5e0e3e2bead385","modified":1579022805774},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"715dcf9b0429a4a4c7107d6d1d00a34e4cf9aa99","modified":1579022805774},{"_id":"themes/next/.github/config.yml","hash":"e4f4b9afe59bc508c4f7634895b33d7d460a7cb1","modified":1579022805774},{"_id":"themes/next/.github/issue-close-app.yml","hash":"7cba457eec47dbfcfd4086acd1c69eaafca2f0cd","modified":1579022805774},{"_id":"themes/next/.github/issue_label_bot.yaml","hash":"fca600ddef6f80c5e61aeed21722d191e5606e5b","modified":1579022805774},{"_id":"themes/next/.github/lock.yml","hash":"61173b9522ebac13db2c544e138808295624f7fd","modified":1579022805774},{"_id":"themes/next/.github/mergeable.yml","hash":"0ee56e23bbc71e1e76427d2bd255a9879bd36e22","modified":1579022805774},{"_id":"themes/next/.github/release-drafter.yml","hash":"3cc10ce75ecc03a5ce86b00363e2a17eb65d15ea","modified":1579022805774},{"_id":"themes/next/.github/stale.yml","hash":"941209526c2f7d916c76163c9e1ac1af9d956679","modified":1579022805774},{"_id":"themes/next/.github/support.yml","hash":"d75db6ffa7b4ca3b865a925f9de9aef3fc51925c","modified":1579022805774},{"_id":"themes/next/docs/AGPL3.md","hash":"0d2b8c5fa8a614723be0767cc3bca39c49578036","modified":1579022805774},{"_id":"themes/next/docs/ALGOLIA-SEARCH.md","hash":"5b4c013e0598b3211ebd899265936cfdaf7c139f","modified":1579022805774},{"_id":"themes/next/docs/AUTHORS.md","hash":"10135a2f78ac40e9f46b3add3e360c025400752f","modified":1579022805774},{"_id":"themes/next/docs/DATA-FILES.md","hash":"40a8089076005e0d26ef7c0db58a2b5b464cda6c","modified":1579022805774},{"_id":"themes/next/docs/INSTALLATION.md","hash":"af88bcce035780aaa061261ed9d0d6c697678618","modified":1579022805774},{"_id":"themes/next/docs/LEANCLOUD-COUNTER-SECURITY.md","hash":"08cda41b4bcf687facfda19ab39718ec7a05ae54","modified":1579022805774},{"_id":"themes/next/docs/LICENSE.txt","hash":"368bf2c29d70f27d8726dd914f1b3211cae4bbab","modified":1579022805774},{"_id":"themes/next/docs/MATH.md","hash":"f520b336f16665e164d6edf075bdcc6aa17b31bc","modified":1579022805774},{"_id":"themes/next/docs/UPDATE-FROM-5.1.X.md","hash":"682937d48bf5d243842a76190921322e26c75247","modified":1579022805774},{"_id":"themes/next/languages/de.yml","hash":"285b294b1dd2ce49b0694beb4fd75ed05dc20ccb","modified":1579022805778},{"_id":"themes/next/languages/default.yml","hash":"89eb0cff04435307e4eccb0d72a653499627d02d","modified":1579022805778},{"_id":"themes/next/languages/en.yml","hash":"89eb0cff04435307e4eccb0d72a653499627d02d","modified":1579022805778},{"_id":"themes/next/languages/es.yml","hash":"3bd0977225a9b9dc3cdc856161b3a77e5993ac4a","modified":1579022805778},{"_id":"themes/next/languages/fa.yml","hash":"35468531ad0236df5b188f28bd1b4bb0c0537faf","modified":1579022805778},{"_id":"themes/next/languages/fr.yml","hash":"5fe560d14824c71ea90b2a76d0c17b2332b9d08a","modified":1579022805778},{"_id":"themes/next/languages/hu.yml","hash":"dd9e4cd2873ed9a9ae7cb89962eeff911de396b4","modified":1579022805778},{"_id":"themes/next/languages/id.yml","hash":"80c3db4c2dbbea0703f6c8f1191218f692899507","modified":1579022805778},{"_id":"themes/next/languages/it.yml","hash":"68ac5a0aa361210f51915e101c842ed1c9464889","modified":1579022805778},{"_id":"themes/next/languages/ja.yml","hash":"e61529ddf80426a5362ed07642216027615bd740","modified":1579022805778},{"_id":"themes/next/languages/ko.yml","hash":"14a162509dc71bb364335c20281d3bccbd2a51f3","modified":1579022805778},{"_id":"themes/next/languages/nl.yml","hash":"4d9b09aff03648cbbbfeb0c51a2d1214320b5ec6","modified":1579022805778},{"_id":"themes/next/languages/pt-BR.yml","hash":"024dcdeb30c93e57cd1ba4cd707f8988dcad2468","modified":1579022805778},{"_id":"themes/next/languages/pt.yml","hash":"88fb58e537a949c013a2adcdaebcbe09543c0bd2","modified":1579022805778},{"_id":"themes/next/languages/ru.yml","hash":"f7d5efd6289845f2375bbee8fe883813de745767","modified":1579022805778},{"_id":"themes/next/languages/tr.yml","hash":"e08d8d6ee9507a7c7d4450bc1c76b435470a3739","modified":1579022805778},{"_id":"themes/next/languages/uk.yml","hash":"e58393cf726401bf50a772392e23507d9e11049e","modified":1579022805778},{"_id":"themes/next/languages/vi.yml","hash":"0c0890ccffcb5cca0893de63ebad66e3ce740707","modified":1579022805778},{"_id":"themes/next/languages/zh-CN.yml","hash":"4b36a51556e87d236c6ac6ee6975de1beb95724c","modified":1579022805778},{"_id":"themes/next/languages/zh-HK.yml","hash":"6d83daf9df1811e3ae6cde5ad778c888d8027b13","modified":1579022805778},{"_id":"themes/next/languages/zh-TW.yml","hash":"5e395cb492a0b6284f8d2ffdd93f7380db31486f","modified":1579022805778},{"_id":"themes/next/layout/_layout.swig","hash":"9686a38b3597b85b08381f5963e38b33d34f3a77","modified":1579031733819},{"_id":"themes/next/layout/archive.swig","hash":"26526c09a4334099e2141456697696fcd1f9783f","modified":1579022805782},{"_id":"themes/next/layout/category.swig","hash":"c55debb2588e4746b02d31ec249bf0a84fdea260","modified":1579022805782},{"_id":"themes/next/layout/index.swig","hash":"3bc6fb1e9707d74b96e1346d3f03fe6584f764f4","modified":1579022805782},{"_id":"themes/next/layout/page.swig","hash":"e61d64c055b6497a04affc143f47fdd0a6dc495b","modified":1579022805782},{"_id":"themes/next/layout/post.swig","hash":"382d9f9a9b35e1f369585f7f9f9b5dd6fa58d2f0","modified":1579022805782},{"_id":"themes/next/layout/tag.swig","hash":"7ff6e34d557a3da1c6a29ecd97842bf73ff213dc","modified":1579022805782},{"_id":"themes/next/scripts/renderer.js","hash":"49a65df2028a1bc24814dc72fa50d52231ca4f05","modified":1579022805782},{"_id":"source/live2d-widget/live2d.min.js","hash":"59851096d873e10601ecbe23f4a0cefcbfeb9639","modified":1579031419354},{"_id":"source/_posts/Hexo-NexT魔改系列-02-配置博客背景轮播图/F12.jpg","hash":"c0e4056c2dba35e2a24a050aaad0af5c7a85d786","modified":1579033862833},{"_id":"source/_posts/Hexo-NexT魔改系列-03-添加数据统计/busuanzi.png","hash":"9fdc9dda0e0b249e7b2d1657c26dfdad71847a42","modified":1579033861993},{"_id":"source/_posts/Hexo-NexT魔改系列-03-添加数据统计/normal_footer.png","hash":"a8ea1c81fd11b25d62957a153074026ce44f5147","modified":1579033862433},{"_id":"source/_posts/Hexo-NexT魔改系列-03-添加数据统计/title.png","hash":"75b4ee76b5606972dcad14a8b29629f784a9f03c","modified":1579033862633},{"_id":"source/_posts/Hexo-NexT魔改系列-04-进阶设置/footer.png","hash":"a8ea1c81fd11b25d62957a153074026ce44f5147","modified":1579033861821},{"_id":"source/_posts/Hexo博客的安装与基本配置/fork-on-github.png","hash":"65a8a2a3fb76cfb8a58930125f00cb8cd2e39239","modified":1579033860433},{"_id":"source/_posts/Hexo博客的安装与基本配置/hide-hexo.png","hash":"743e24b05c92fc827873c03e1e2cc61e5c129a78","modified":1579033860569},{"_id":"source/_posts/Hexo博客的安装与基本配置/my-copyright.png","hash":"3ea9ce2e84ddf327c0f7e0a95dd463f967c13af1","modified":1579033860669},{"_id":"source/_posts/Hexo博客的安装与基本配置/show-copyright.png","hash":"e481fe7c1cffba8bd1bfb7291cd92484ebbdebeb","modified":1579033860797},{"_id":"source/_posts/Hexo博客的安装与基本配置/social-links.png","hash":"d116572cff52119e9e6be54058bfa33563b495f2","modified":1579033860953},{"_id":"source/_posts/Hexo博客的安装与基本配置/thanks.png","hash":"59178ea1f2a63013b686260d362021a788ef9915","modified":1579033861053},{"_id":"source/_posts/Hexo博客的安装与基本配置/tomorrow-night-blue.png","hash":"5fab562bc2ca35999e40635567ad3338fb5e1e45","modified":1579033861161},{"_id":"source/_posts/Hexo博客的安装与基本配置/tomorrow-night-bright.png","hash":"a5c299247d5658342ef806f51c31411bc075f60e","modified":1579033861265},{"_id":"source/_posts/Hexo博客的安装与基本配置/tomorrow-night-eighties.png","hash":"3cc0a47b6fda06ce436c23c548405ba3962c3980","modified":1579033861365},{"_id":"source/_posts/Hexo博客的安装与基本配置/tomorrow-night.png","hash":"dd9d84a51f3c52bb8a4b6a3206062cf7b6d02505","modified":1579033861497},{"_id":"source/_posts/Hexo博客的安装与基本配置/tomorrow.png","hash":"6c3c72246915ff54c65410128a3197a7dc49fa3c","modified":1579033861621},{"_id":"source/_posts/JavaScript的基本组成部分/java-script.jpg","hash":"3c1961152e6d17d2b5eef213f2b471818616f7ae","modified":1579033860033},{"_id":"source/_posts/JavaScript的基本组成部分/jszxgc.png","hash":"a5b4c6f42cb1347f0dc51e50e6e01f1917dde982","modified":1579033860169},{"_id":"source/_posts/JavaScript的基本组成部分/structure.png","hash":"acfe3472facd63c00c5e348b031cfe1fbab9e226","modified":1579033860273},{"_id":"source/_posts/JavaScript观察者模式与发布订阅/ObserverPattern.png","hash":"309081e6b06454c5b03e4c45386c9f3b910fb842","modified":1579342709896},{"_id":"source/_posts/JavaScript观察者模式与发布订阅/PubSubPattern.gif","hash":"72419ffc59c8420dd44aa42498d6fb937532b249","modified":1579342710048},{"_id":"source/_posts/JavaScript观察者模式与发布订阅/vs.jpeg","hash":"3f29172aa56164d6a97fd37d7222f3adba91f951","modified":1579342710196},{"_id":"source/_posts/JavaScript面向对象-02-Prototype/base__proto__.png","hash":"ac6a024e09b9f22efdc6f64df4cdd70bdc96d4fa","modified":1579033859317},{"_id":"source/_posts/JavaScript面向对象-02-Prototype/object.png","hash":"dc9ef5fbc82ca153ceb21d77820269d625e70f2e","modified":1579033859453},{"_id":"source/_posts/JavaScript面向对象-02-Prototype/prototype_dir.png","hash":"431890b5eb76ed34ef8438c4808fd5b58c2a3418","modified":1579033859553},{"_id":"source/_posts/JavaScript面向对象-02-Prototype/yuanxinglian.png","hash":"1c2642a02f0c224ee2ffa3972f99a665671087c1","modified":1579033859681},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm/1024px-KnnClassification.svg.png","hash":"ff4d0e4607e9920afc45b797c89b49e9bbc78b8f","modified":1579033854765},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm/temp.png","hash":"5c984e10609b39f7ef969cc36330c3a263de84eb","modified":1579033859189},{"_id":"source/_posts/UML图例详解/UML_shixu.jpg","hash":"0517e5624ff77e34553d179498d3710402c42d08","modified":1579033854165},{"_id":"source/_posts/UML图例详解/UML_yongli.png","hash":"cb3677341d1d23e9a08619969b627bb4a250a328","modified":1579033854285},{"_id":"source/_posts/UML图例详解/aggregation.png","hash":"5af483e7c15b977c37e2682f36e963976a1712f0","modified":1579033853081},{"_id":"source/_posts/UML图例详解/association.png","hash":"67c3e7aae641a7316406c19b4dfc86e90834eb02","modified":1579033853193},{"_id":"source/_posts/UML图例详解/composition.png","hash":"3b872ecb6d7d77834aa4073871e8875b01888e55","modified":1579033853313},{"_id":"source/_posts/UML图例详解/dependency.png","hash":"ab58dff83917fb59703c564bda72e2e3bb9452f4","modified":1579033853433},{"_id":"source/_posts/UML图例详解/generalization.png","hash":"0d1d459c77659042d4d0330dc049fd7d26feb185","modified":1579033853553},{"_id":"source/_posts/UML图例详解/group.png","hash":"c67b06332ec25cf475ed8d3a4487f3dd1bff98f6","modified":1579033853665},{"_id":"source/_posts/UML图例详解/implements.png","hash":"faeb17c8889bb30c42f02f5fc19e35f671e53c93","modified":1579033853785},{"_id":"source/_posts/UML图例详解/shengmingxian.png","hash":"184955d306dee751c3ce2754781ef56b4a6ab15a","modified":1579033853897},{"_id":"source/_posts/UML图例详解/tongbuxiaoxi.png","hash":"cf54ccd681c8055f2e873d804203ee8e31791f34","modified":1579033854013},{"_id":"source/_posts/UML图例详解/yibuxiaoxi.png","hash":"b489ce395a8016b0fc3bad4f56b1e2b024052fc7","modified":1579033854397},{"_id":"source/_posts/UML图例详解/yueshu.png","hash":"9f80f50b0d06dc1dee89eb06a710989f399b0f3a","modified":1579033854517},{"_id":"source/_posts/UML图例详解/zhushi.png","hash":"fab1dcc72cd2f316c79faa5bad88e63e3fd6f188","modified":1579033854621},{"_id":"source/_posts/关于渐进增强与优雅降级/main.png","hash":"d1b7b635c6a3754d17b16f43494b70e833030920","modified":1579033852965},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/TcpMessage.png","hash":"c93d289319abee0f7b36fe0dd404596869dea38e","modified":1579447204816},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/four.png","hash":"c4010ad45e50f077d8908c1ce98cc3a72cbe895b","modified":1579447204520},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/four01.png","hash":"e5a6c60f51e721f948e96138b08bc0da3e18abde","modified":1579447204704},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/three.png","hash":"79d6a6614480ca11fe668e62e44b8fb8dab6cf46","modified":1579447204960},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/three01.png","hash":"13010d3905a97eda9796e147db6f7d07b76ec6ca","modified":1579447205148},{"_id":"source/_posts/设置你喜欢的live2d看板娘/Unitychan.png","hash":"26045ee389f7492a8f0057612d9352bdbb5a824e","modified":1579033852101},{"_id":"source/_posts/设置你喜欢的live2d看板娘/chitose.jpg","hash":"336aca2ef46e1e505cff69a9eb2dc9f7341b9a0e","modified":1579033848249},{"_id":"source/_posts/设置你喜欢的live2d看板娘/haruto.png","hash":"60b8ab92f8c78a3d9a59c3e9c0ccb628c1b2711a","modified":1579033849001},{"_id":"source/_posts/设置你喜欢的live2d看板娘/hibiki.png","hash":"2aa5c5e4c9b22644f401a39659fa19e80fc986e2","modified":1579033849153},{"_id":"source/_posts/设置你喜欢的live2d看板娘/hijiki.png","hash":"7a152c3cba0edc2e94cc08d6d0aee2a348e3b492","modified":1579033849269},{"_id":"source/_posts/设置你喜欢的live2d看板娘/izumi.jpg","hash":"1bb6c1bb9b0998402330d0fd19088b650b3e28ec","modified":1579033849381},{"_id":"source/_posts/设置你喜欢的live2d看板娘/koharu.png","hash":"3f9b694f3768cd9c70b198d5ae9fb363bb2dacd6","modified":1579033849521},{"_id":"source/_posts/设置你喜欢的live2d看板娘/models.jpg","hash":"842325c0b5073c47421dd33b727773ffe5e2550a","modified":1579033849937},{"_id":"source/_posts/设置你喜欢的live2d看板娘/ni-j.png","hash":"af4b1d7a894d443e62c43bbebf19fafeee03677d","modified":1579033850113},{"_id":"source/_posts/设置你喜欢的live2d看板娘/nico.png","hash":"1e15f3bedae7c88de4658c477fc27e770c8603e9","modified":1579033850297},{"_id":"source/_posts/设置你喜欢的live2d看板娘/nietzche.png","hash":"5185dae9d40a45ebe0d76b8aaeda7447b273934b","modified":1579033850477},{"_id":"source/_posts/设置你喜欢的live2d看板娘/nipsilon.png","hash":"42b65728bbfcf0d7ec59ecff7bbf9a6440790531","modified":1579033850685},{"_id":"source/_posts/设置你喜欢的live2d看板娘/nito.png","hash":"944197890af298c8ed8afaa27d5c5503616bba8b","modified":1579033850841},{"_id":"source/_posts/设置你喜欢的live2d看板娘/tororo.png","hash":"f4e49f831fce135f5dbefc785353265b2e752b0e","modified":1579033851761},{"_id":"source/_posts/设置你喜欢的live2d看板娘/tsumiki.png","hash":"ea90ba5810d09f5f23113d9a594790f9544e11f8","modified":1579033851941},{"_id":"source/_posts/设置你喜欢的live2d看板娘/wanko.png","hash":"6bb16c34041eb1616cd172127c0ebf82d7f5350f","modified":1579033852261},{"_id":"source/live2d-widget/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1579031303474},{"_id":"source/live2d-widget/.git/config","hash":"23b7b474c3eea8960b76b360fc36436f13c5c5c1","modified":1579031303474},{"_id":"source/live2d-widget/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1579031300778},{"_id":"source/live2d-widget/.git/index","hash":"512a7f2497e21b798ca6b55701636ba9af8114c3","modified":1579031303486},{"_id":"source/live2d-widget/.git/packed-refs","hash":"001f7c5ef8475288b546d7150211e594df9b9662","modified":1579031303470},{"_id":"source/live2d-widget/assets/browserstack.svg","hash":"1ae93ba806a84d276c788beb8cd20243af94404d","modified":1579031303486},{"_id":"source/live2d-widget/demo/demo1.html","hash":"b54968db4c0244e79a06e544f40b616b541f7079","modified":1579031303486},{"_id":"source/live2d-widget/demo/demo2.html","hash":"8ddf814764157fb3abcecc3ec428da55818c7574","modified":1579031303486},{"_id":"themes/next/.github/ISSUE_TEMPLATE/bug-report.md","hash":"8ae029084b9ac482adf0fae2a0979dd388476513","modified":1579022805774},{"_id":"themes/next/.github/ISSUE_TEMPLATE/feature-request.md","hash":"7a9526f749205c882d672a4f51e6a3033c80ca6e","modified":1579022805774},{"_id":"themes/next/.github/ISSUE_TEMPLATE/other.md","hash":"89667adbb85c25716dba607cd7a38191acf60736","modified":1579022805774},{"_id":"themes/next/.github/ISSUE_TEMPLATE/question.md","hash":"789a3cceb8f37a4b63b1fb2452a03332a3c365ed","modified":1579022805774},{"_id":"themes/next/docs/ru/DATA-FILES.md","hash":"0bd2d696f62a997a11a7d84fec0130122234174e","modified":1579022805774},{"_id":"themes/next/docs/ru/INSTALLATION.md","hash":"9c4fe2873123bf9ceacab5c50d17d8a0f1baef27","modified":1579022805774},{"_id":"themes/next/docs/ru/README.md","hash":"89c76e2c45560408001717ed489e78baa92aac23","modified":1579107099330},{"_id":"themes/next/docs/ru/UPDATE-FROM-5.1.X.md","hash":"fe3f5cda1975114884d84bef384a562920d70335","modified":1579022805774},{"_id":"themes/next/docs/zh-CN/ALGOLIA-SEARCH.md","hash":"4245fe9472647226692fcbdd5a52d6e6dcd251bc","modified":1579022805774},{"_id":"themes/next/docs/zh-CN/CODE_OF_CONDUCT.md","hash":"fb23b85db6f7d8279d73ae1f41631f92f64fc864","modified":1579022805774},{"_id":"themes/next/docs/zh-CN/CONTRIBUTING.md","hash":"17d7203e85a8ce9760c42a853dee0f26a8f7ee4e","modified":1579022805774},{"_id":"themes/next/docs/zh-CN/DATA-FILES.md","hash":"ca1030efdfca5e20f9db2e7a428998e66a24c0d0","modified":1579022805774},{"_id":"themes/next/docs/zh-CN/INSTALLATION.md","hash":"579c7bd8341873fb8be4732476d412814f1a3df7","modified":1579022805774},{"_id":"themes/next/docs/zh-CN/LEANCLOUD-COUNTER-SECURITY.md","hash":"0b0b9ec6ec4a89e701a3b91f8d7d95752d3e241b","modified":1579022805778},{"_id":"themes/next/docs/zh-CN/MATH.md","hash":"f0ffb74de522749c9f2fda46970a61bdafbfbc24","modified":1579022805778},{"_id":"themes/next/docs/zh-CN/README.md","hash":"2aaed16566d6b1ff0df04dfcdd74df68935aed59","modified":1579107088646},{"_id":"themes/next/docs/zh-CN/UPDATE-FROM-5.1.X.md","hash":"7f37327bbcae7ed7d04d187fd5e9bc6bbf14926a","modified":1579022805778},{"_id":"themes/next/layout/_custom/custom-foot.swig","hash":"16a516b75df66a458d276c2694d0f32ffa2eacab","modified":1579090509266},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"5b17eea5d001b2456209c8fd5b17bb075ea8d7e5","modified":1579028839788},{"_id":"themes/next/layout/_macro/my-copyright.swig","hash":"fb41aac6aa75fe3e12e292cecfea324d4a80a73a","modified":1579025403738},{"_id":"themes/next/layout/_macro/passage-end-tag.swig","hash":"a7bb49e6f5a2613c6b688b7eb811a202040898d7","modified":1579025057222},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"815676d904f92748ddf4f529bed2baf066997bc6","modified":1579022805778},{"_id":"themes/next/layout/_macro/post.swig","hash":"cdd2525105a4ec6bd13c747c0c235c17d3ca1445","modified":1579034533458},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"1e47aee3f4fab1cc4169a2f9b928d39a29ad3c3f","modified":1579450146024},{"_id":"themes/next/layout/_partials/comments.swig","hash":"0c4914a5fd08f15beec71940218c814ad9a89f3f","modified":1579022805778},{"_id":"themes/next/layout/_partials/footer.swig","hash":"3731e2db721d38263b91cc64ee16647530072b98","modified":1579104538076},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9876dbfc15713c7a47d4bcaa301f4757bd978269","modified":1579022805778},{"_id":"themes/next/layout/_partials/widgets.swig","hash":"83a40ce83dfd5cada417444fb2d6f5470aae6bb0","modified":1579022805778},{"_id":"themes/next/layout/_scripts/index.swig","hash":"cea942b450bcb0f352da78d76dc6d6f1d23d5029","modified":1579022805778},{"_id":"themes/next/layout/_scripts/noscript.swig","hash":"d1f2bfde6f1da51a2b35a7ab9e7e8eb6eefd1c6b","modified":1579022805778},{"_id":"themes/next/layout/_scripts/pjax.swig","hash":"970ad658eb15c8c694b1c17de516ba29ac9f1110","modified":1579022805778},{"_id":"themes/next/layout/_scripts/three.swig","hash":"a4f42f2301866bd25a784a2281069d8b66836d0b","modified":1579022805778},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"ef38c213679e7b6d2a4116f56c9e55d678446069","modified":1579022805778},{"_id":"themes/next/layout/_third-party/baidu-push.swig","hash":"8627c8c8b031ecee16c522433b66fa4d6979b8ea","modified":1579022805778},{"_id":"themes/next/layout/_third-party/index.swig","hash":"70c3c01dd181de81270c57f3d99b6d8f4c723404","modified":1579022805778},{"_id":"themes/next/layout/_third-party/quicklink.swig","hash":"dd6bd817cb69b5ad5e9746498146314b54054ff8","modified":1579022805778},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"da6a9d14ed10203e378c6e2c00a7b5e7afabca58","modified":1579022805778},{"_id":"themes/next/scripts/events/index.js","hash":"9047d8ae2670e43429b16a7919a08a0a0a81afe0","modified":1579022805782},{"_id":"themes/next/scripts/filters/default-injects.js","hash":"aec50ed57b9d5d3faf2db3c88374f107203617e0","modified":1579022805782},{"_id":"themes/next/scripts/filters/front-matter.js","hash":"703bdd142a671b4b67d3d9dfb4a19d1dd7e7e8f7","modified":1579022805782},{"_id":"themes/next/scripts/filters/locals.js","hash":"5bbfdc1c373542159660b7a68ed0b57ca18ad10b","modified":1579022805782},{"_id":"themes/next/scripts/filters/minify.js","hash":"19985723b9f677ff775f3b17dcebf314819a76ac","modified":1579022805782},{"_id":"themes/next/scripts/filters/post.js","hash":"5e5035372b3d94a65309334c93303c858e072012","modified":1579022805782},{"_id":"themes/next/scripts/helpers/engine.js","hash":"cb211b6b50913454b1737782e9e2af96cfa40448","modified":1579022805782},{"_id":"themes/next/scripts/helpers/font.js","hash":"32268fb4c59c5b37c1eb1c9582ab630e09e5cc7d","modified":1579022805782},{"_id":"themes/next/scripts/helpers/next-url.js","hash":"58347687b02f7ab5e64bef07525c8efa97c9e8fb","modified":1579022805782},{"_id":"themes/next/scripts/tags/button.js","hash":"1d1d25f7e579d92fa563778dd0f163e8eda190da","modified":1579022805782},{"_id":"themes/next/scripts/tags/caniuse.js","hash":"20e392b8583ba6ae5037449c2c7e191d3927641b","modified":1579022805782},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"f13430d9d1c9773b390787c2f046bb1f12a79878","modified":1579022805782},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"d902fd313e8d35c3cc36f237607c2a0536c9edf1","modified":1579022805782},{"_id":"themes/next/scripts/tags/label.js","hash":"fc5b267d903facb7a35001792db28b801cccb1f8","modified":1579022805782},{"_id":"themes/next/scripts/tags/mermaid.js","hash":"983c6c4adea86160ecc0ba2204bc312aa338121d","modified":1579022805782},{"_id":"themes/next/scripts/tags/note.js","hash":"0a02bb4c15aec41f6d5f1271cdb5c65889e265d9","modified":1579022805782},{"_id":"themes/next/scripts/tags/pdf.js","hash":"f780cc72bff91d2720626e7af69eed25e9c12a29","modified":1579022805782},{"_id":"themes/next/scripts/tags/tabs.js","hash":"00ca6340d4fe0ccdae7525373e4729117775bbfa","modified":1579022805782},{"_id":"themes/next/scripts/tags/video.js","hash":"e5ff4c44faee604dd3ea9db6b222828c4750c227","modified":1579022805782},{"_id":"themes/next/source/css/main.styl","hash":"33ece02e30016eec70cc77f5425e764e6b93fdf1","modified":1579027028098},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1579022805786},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1579022805786},{"_id":"themes/next/source/images/apple-touch-icon.png","hash":"6c542c08bf7c492cdd18c458d44d7cf16f3e9549","modified":1579025261230},{"_id":"themes/next/source/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1579022805786},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1579022805786},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1579022805786},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1579022805786},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1579022805786},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1579022805786},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1579022805786},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1579022805786},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1579022805786},{"_id":"themes/next/source/images/favicon-16x16.ico","hash":"432672e2a8a03f44382f5be84f0a2da86721ab12","modified":1579025261346},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1579022805786},{"_id":"themes/next/source/images/favicon-32x32.ico","hash":"d9ccd03f5c49603efa3d30020249fe70c9c5e036","modified":1579025261446},{"_id":"themes/next/source/images/logo.svg","hash":"18c02605ad7dea01839548366c91820936c6d21e","modified":1579025346266},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1579022805786},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1579022805786},{"_id":"themes/next/source/js/algolia-search.js","hash":"813afcc30feee11d59f297f2d5a96f98fbbd4743","modified":1579022805786},{"_id":"themes/next/source/js/bookmark.js","hash":"a00945ff886e9f6f835731cdaf29a3a3727c8877","modified":1579022805786},{"_id":"themes/next/source/js/local-search.js","hash":"9f3d3ddff86e7b2828772aba915a5ebfd7d9f55f","modified":1579022805786},{"_id":"themes/next/source/js/motion.js","hash":"36262c60c63ed196764284247ba864343b2693fb","modified":1579022805786},{"_id":"themes/next/source/js/next-boot.js","hash":"f7045763e277e685c271bd4b4c37e531d699ac63","modified":1579022805786},{"_id":"themes/next/source/js/utils.js","hash":"6ef79d54e71d7ddbb2e7ffa5aa9bbd28c543c835","modified":1579022805786},{"_id":"themes/next/source/lib/anime.min.js","hash":"47cb482a8a488620a793d50ba8f6752324b46af3","modified":1579022805786},{"_id":"themes/next/source/uploads/alipay.png","hash":"dded1805de37e8f4d68b408c4f0254469a44abca","modified":1579023513602},{"_id":"themes/next/source/uploads/avatar.jpg","hash":"7bba06ff974748af5f83339653bec127df9d9e52","modified":1579023513774},{"_id":"themes/next/source/uploads/beian.png","hash":"29c400bc3b89f6085766dac4e0330ded5cb73d52","modified":1579029958093},{"_id":"themes/next/source/uploads/wechat.png","hash":"f6e0bbbe63bd8fa6fed668e5addb881819525f8e","modified":1579023513954},{"_id":"source/_posts/JavaScript的基本组成部分/DOM_tree.png","hash":"7b64c07e0b24163a527ee4f07f4bc6315d5a0895","modified":1579033859865},{"_id":"source/_posts/设置你喜欢的live2d看板娘/Epsilon2.1.png","hash":"6495c18cdb9d9787fe6b56a99af62b786066ca7a","modified":1579033848453},{"_id":"source/_posts/设置你喜欢的live2d看板娘/Gantzert_Felixander.png","hash":"92d8861b20e1affdedea9b7f2b8756eba1d1eec7","modified":1579033848653},{"_id":"source/_posts/设置你喜欢的live2d看板娘/haru.png","hash":"2b02a9e8dcacb4a3b6f5e0c595ee00075cc4926c","modified":1579033848841},{"_id":"source/_posts/设置你喜欢的live2d看板娘/miku.png","hash":"b4a0209d8b40814542f3475b5393afec3dbc38dc","modified":1579033849769},{"_id":"source/_posts/设置你喜欢的live2d看板娘/shizuku.png","hash":"c301440ca6fa14f0ad4905e3b7e5d84d05c2af5f","modified":1579033851637},{"_id":"source/_posts/设置你喜欢的live2d看板娘/z16.png","hash":"b2d22eca691f90e7c9914ee7eabc9292f98b8c2d","modified":1579033852485},{"_id":"source/live2d-widget/assets/screenshot-1.png","hash":"4bd4d97a1fcaa5deb3cea1c0a102a895a15af32f","modified":1579031303486},{"_id":"source/live2d-widget/assets/screenshot-2.png","hash":"e766842b0f064efc148613c41f43a8a905c39557","modified":1579031303486},{"_id":"source/live2d-widget/assets/screenshot-3.png","hash":"ead66aa3edb390205081a0c8625a49844470a090","modified":1579031303486},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1579022805786},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1579022805786},{"_id":"themes/next/source/js/src/jquery.backstretch.min.js","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1579031925923},{"_id":"source/_posts/Hexo-NexT魔改系列-03-添加数据统计/mini_footer.png","hash":"2edc09e79ca7ff90620538cb6bfa01841b23ca86","modified":1579033862237},{"_id":"source/live2d-widget/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1579031300778},{"_id":"source/live2d-widget/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1579031300778},{"_id":"source/live2d-widget/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1579031300778},{"_id":"source/live2d-widget/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1579031300778},{"_id":"source/live2d-widget/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1579031300778},{"_id":"source/live2d-widget/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1579031300778},{"_id":"source/live2d-widget/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1579031300778},{"_id":"source/live2d-widget/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1579031300778},{"_id":"source/live2d-widget/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1579031300778},{"_id":"source/live2d-widget/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1579031300778},{"_id":"source/live2d-widget/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1579031300778},{"_id":"source/live2d-widget/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1579031300778},{"_id":"source/live2d-widget/.git/logs/HEAD","hash":"4415893a330c114f9a265f187135d28570944416","modified":1579031303474},{"_id":"themes/next/layout/_partials/head/head-unique.swig","hash":"1638483d2d2dad1da4c841a6fb9f6ee96b850187","modified":1579022805778},{"_id":"themes/next/layout/_partials/head/head.swig","hash":"0172055d118d1d7f4c8379c8495c1ee1aa50c7d9","modified":1579022805778},{"_id":"themes/next/layout/_partials/header/brand.swig","hash":"7487ca8f0e4b16351ea0d6b35dc52b0d32176d57","modified":1579022805778},{"_id":"themes/next/layout/_partials/header/index.swig","hash":"30528a8da30994b1ef9355a72b09b2cd85a7c0e9","modified":1579022805778},{"_id":"themes/next/layout/_partials/header/menu-item.swig","hash":"e6076865dba066c5f0008e22217efb850d5af69c","modified":1579022805778},{"_id":"themes/next/layout/_partials/header/menu.swig","hash":"bbf0c8e42491fac70f4f8165224f1d7d92a040d7","modified":1579022805778},{"_id":"themes/next/layout/_partials/header/sub-menu.swig","hash":"54ba9508a901c295a02c8e34e9cece7c7dcad518","modified":1579022805778},{"_id":"themes/next/layout/_partials/page/breadcrumb.swig","hash":"c851717497ca64789f2176c9ecd1dedab237b752","modified":1579022805778},{"_id":"themes/next/layout/_partials/page/page-header.swig","hash":"a56e4f6ad95c106f361d354f828d1ef4810b1d76","modified":1579022805778},{"_id":"themes/next/layout/_partials/post/post-copyright.swig","hash":"94d54b0c65d504f772af1e62424952e092b6c21d","modified":1579022805778},{"_id":"themes/next/layout/_partials/post/post-footer.swig","hash":"8f14f3f8a1b2998d5114cc56b680fb5c419a6b07","modified":1579022805778},{"_id":"themes/next/layout/_partials/post/post-related.swig","hash":"f79c44692451db26efce704813f7a8872b7e63a0","modified":1579022805778},{"_id":"themes/next/layout/_partials/post/post-reward.swig","hash":"1b7faa20a458b46369779b57bcc695bbc5d1c13a","modified":1579022805778},{"_id":"themes/next/layout/_partials/search/algolia-search.swig","hash":"7fa01334a0ba84500e920bb9202baa08067d2ee1","modified":1579022805778},{"_id":"themes/next/layout/_partials/search/index.swig","hash":"d6fa9e4432b87004c5678dfe2d4b2c1f4a702b93","modified":1579022805778},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"733d6874aa4f50d1071e670a554508a5a0094eb3","modified":1579022805778},{"_id":"themes/next/layout/_partials/sidebar/site-overview.swig","hash":"716b78cd90addc4216413719554721cb362b0c18","modified":1579022805778},{"_id":"themes/next/layout/_scripts/pages/schedule.swig","hash":"a2bb0bec243685e670b60a3d54142950adc03af0","modified":1579022805778},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"1c910fc066c06d5fbbe9f2b0c47447539e029af7","modified":1579022805778},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"7f14ef43d9e82bc1efc204c5adf0b1dbfc919a9f","modified":1579022805778},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"7f14ef43d9e82bc1efc204c5adf0b1dbfc919a9f","modified":1579022805778},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"1c910fc066c06d5fbbe9f2b0c47447539e029af7","modified":1579022805778},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"4790058691b7d36cf6d2d6b4e93795a7b8d608ad","modified":1579022805778},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"2fa2b51d56bfac6a1ea76d651c93b9c20b01c09b","modified":1579022805778},{"_id":"themes/next/layout/_third-party/analytics/growingio.swig","hash":"5adea065641e8c55994dd2328ddae53215604928","modified":1579022805778},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"1472cabb0181f60a6a0b7fec8899a4d03dfb2040","modified":1579022805778},{"_id":"themes/next/layout/_third-party/chat/chatra.swig","hash":"fdcf006e1ba2e53eab65e901b6c63159538307ef","modified":1579022805778},{"_id":"themes/next/layout/_third-party/chat/tidio.swig","hash":"cba0e6e0fad08568a9e74ba9a5bee5341cfc04c1","modified":1579022805778},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"f39a5bf3ce9ee9adad282501235e0c588e4356ec","modified":1579022805778},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"1ef172bc041d6f6b6c8c642ea64496a188d79029","modified":1579022805778},{"_id":"themes/next/layout/_third-party/comments/disqusjs.swig","hash":"d3dc3e051e6816cdd576d00cc70b18b8a4c6a495","modified":1579022805778},{"_id":"themes/next/layout/_third-party/comments/gitalk.swig","hash":"ed236103bccbcf608f7d5d5b33b9f995d2f1a7de","modified":1579022805778},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"f7a9eca599a682479e8ca863db59be7c9c7508c8","modified":1579022805778},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"4d6f9e09ca4056ff6a5d4923e202126a75242183","modified":1579022805778},{"_id":"themes/next/layout/_third-party/math/index.swig","hash":"6c5976621efd5db5f7c4c6b4f11bc79d6554885f","modified":1579022805778},{"_id":"themes/next/layout/_third-party/math/katex.swig","hash":"4791c977a730f29c846efcf6c9c15131b9400ead","modified":1579022805778},{"_id":"themes/next/layout/_third-party/math/mathjax.swig","hash":"fb27a38f9a4b8fcba4f637b03904f7a83cc73416","modified":1579022805778},{"_id":"themes/next/layout/_third-party/search/algolia-search.swig","hash":"e456d7a2aaabe55447f78cd952b30d70a6c1e742","modified":1579022805778},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"767b6c714c22588bcd26ba70b0fc19b6810cbacd","modified":1579022805778},{"_id":"themes/next/layout/_third-party/search/swiftype.swig","hash":"ba0dbc06b9d244073a1c681ff7a722dcbf920b51","modified":1579022805778},{"_id":"themes/next/layout/_third-party/statistics/busuanzi-counter.swig","hash":"d7258d02bcf0dac6c0fd8377c0909ddecb09d1d4","modified":1579022805778},{"_id":"themes/next/layout/_third-party/statistics/cnzz-analytics.swig","hash":"a17ace37876822327a2f9306a472974442c9005d","modified":1579022805778},{"_id":"themes/next/layout/_third-party/statistics/firestore.swig","hash":"0ea0bac09b0747bc16fde852164c0eaab2efe02c","modified":1579022805778},{"_id":"themes/next/layout/_third-party/statistics/index.swig","hash":"5f6a966c509680dbfa70433f9d658cee59c304d7","modified":1579022805782},{"_id":"themes/next/layout/_third-party/statistics/lean-analytics.swig","hash":"801e1d2f59f7d2db4096c4788b8469b4165f4965","modified":1579022805782},{"_id":"themes/next/layout/_third-party/tags/mermaid.swig","hash":"4958fa997ff6df2b2ce05341f40cc3a81b0f91bb","modified":1579022805782},{"_id":"themes/next/layout/_third-party/tags/pdf.swig","hash":"7fa72dc60c078842979861622839b109683e05a3","modified":1579022805782},{"_id":"themes/next/scripts/events/lib/config.js","hash":"b205d72a56b1827681f0a260c266e0c02065fd08","modified":1579022805782},{"_id":"themes/next/scripts/events/lib/injects-point.js","hash":"6661c1c91c7cbdefc6a5e6a034b443b8811235a1","modified":1579022805782},{"_id":"themes/next/scripts/events/lib/injects.js","hash":"f233d8d0103ae7f9b861344aa65c1a3c1de8a845","modified":1579022805782},{"_id":"themes/next/scripts/filters/comment/changyan.js","hash":"1f20213af8da3127701e6bb9da995e5c91be2051","modified":1579022805782},{"_id":"themes/next/scripts/filters/comment/common.js","hash":"0803d4f4d3d02c24417c163ad0b27b60fda79250","modified":1579022805782},{"_id":"themes/next/scripts/filters/comment/default-config.js","hash":"7f2d93af012c1e14b8596fecbfc7febb43d9b7f5","modified":1579022805782},{"_id":"themes/next/scripts/filters/comment/disqus.js","hash":"5ba0480c2dbb0626501c90c920be85ce2308103c","modified":1579022805782},{"_id":"themes/next/scripts/filters/comment/disqusjs.js","hash":"7f8b92913d21070b489457fa5ed996d2a55f2c32","modified":1579022805782},{"_id":"themes/next/scripts/filters/comment/gitalk.js","hash":"e51dc3072c1ba0ea3008f09ecae8b46242ec6021","modified":1579022805782},{"_id":"themes/next/scripts/filters/comment/livere.js","hash":"d5fefc31fba4ab0188305b1af1feb61da49fdeb0","modified":1579022805782},{"_id":"themes/next/scripts/filters/comment/valine.js","hash":"e24c4dd78f6e4adee0e7c15eb8bca12eb92452e4","modified":1579022805782},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"515c05a507cdecefd2554aea3de85354311ea981","modified":1579450418100},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"2315dd8a7a2c7aabd29efa6193df08e805cb15fc","modified":1579022805786},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"644c1f0b02be9bf59955ebdf496136b3fa4b660b","modified":1579022805786},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"0a25f3df1b5c39794365efde387647da81da884a","modified":1579022805786},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"52550138127ae9ebbe049bcdacd94d767c003855","modified":1579022805786},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"b9d7058db61df7bbd2b58779efe45621a06ffc18","modified":1579022805786},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"c261d685c5ed0df34718d94bb2ba977c0ed443e6","modified":1579022805786},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"50bc57e66331c0f15a4527010b4ca3316ac92403","modified":1579022805786},{"_id":"themes/next/source/css/_variables/base.styl","hash":"7fb3391ca23e7b15307d793ff026b46897430743","modified":1579026461194},{"_id":"themes/next/source/js/schemes/muse.js","hash":"792f4522a3b0b96584a041a4aca20fcded410079","modified":1579022805786},{"_id":"themes/next/source/js/schemes/pisces.js","hash":"52d139e6f3bc212c8c9b71bc9e57e931920434a6","modified":1579022805786},{"_id":"themes/next/source/js/src/busuanzi.pure.mini.js","hash":"6e41f31100ae7eb3a6f23f2c168f6dd56e7f7a9a","modified":1579090747778},{"_id":"themes/next/source/js/src/custom.js","hash":"ba2077eb3a0b1d40c2922a1d14ea3a82c7c54865","modified":1579033448889},{"_id":"themes/next/source/lib/canvas-nest/LICENSE","hash":"b29db4c99aa5b8d574026f68804051ff4b75466e","modified":1579024792178},{"_id":"themes/next/source/lib/canvas-nest/README.md","hash":"7617ec90d04a5cdf2e7bb2ecdd955a8778664fbc","modified":1579024792178},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest-nomobile.min.js","hash":"956eada198babd00f028e8908767cb158926c3f3","modified":1579024792178},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1579024792178},{"_id":"themes/next/source/lib/canvas-ribbon/LICENSE","hash":"b29db4c99aa5b8d574026f68804051ff4b75466e","modified":1579024740638},{"_id":"themes/next/source/lib/canvas-ribbon/README.md","hash":"3a18d68b0673c0e79faecc8503268ac7bec7d30e","modified":1579024740638},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"65b1a8f12d04b15d7ed6eeb9d11dec760a799c5f","modified":1579024740638},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"d8bf9cb15d9d91c7ad022ba2954b5b4d326f17f7","modified":1579035837768},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1579035837768},{"_id":"themes/next/source/lib/fancybox/LICENSE","hash":"8624bcdae55baeef00cd11d5dfcfa60f68710a02","modified":1579035837768},{"_id":"themes/next/source/lib/fancybox/README.md","hash":"8286582ed7c338fce8bb03566b769fba378bce83","modified":1579035837768},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1579022805786},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1579022805786},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1579022805786},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1579022805786},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1579022805786},{"_id":"themes/next/source/lib/pace/LICENSE","hash":"b29db4c99aa5b8d574026f68804051ff4b75466e","modified":1579024455754},{"_id":"themes/next/source/lib/pace/README.md","hash":"168f57bb63563b9671d0c4f10c0940e7eec261f0","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-flat-top.min.css","hash":"5e1c97e232b46e48592a8e4983ae5a89e0a7da6a","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-material.min.css","hash":"f1ff83985c090f3a3236554c5ef69542dcceb049","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1579024455754},{"_id":"themes/next/source/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1579024455754},{"_id":"themes/next/source/lib/three/.gitignore","hash":"e691fe9e685cbd50bcd7e138f4ca3503e7b0eaa4","modified":1579024553518},{"_id":"themes/next/source/lib/three/LICENSE","hash":"b29db4c99aa5b8d574026f68804051ff4b75466e","modified":1579024553518},{"_id":"themes/next/source/lib/three/README.md","hash":"1e31051ce404eaa86df192b7000442bacd31e2b4","modified":1579024553518},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"ae6584edc0418d68731cab82c1494f26bd77c07d","modified":1579024553518},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"186c3bd6ae352d336cdbd0e555ee76a844854c94","modified":1579024553518},{"_id":"themes/next/source/lib/three/gulpfile.js","hash":"e0e9e7051d9d82a37c2aba1df396d8b3916323c4","modified":1579024553518},{"_id":"themes/next/source/lib/three/package.json","hash":"b8cd9b9c30b159a4a271e84b0ed11be5a98c2c7c","modified":1579024553518},{"_id":"themes/next/source/lib/three/renovate.json","hash":"cb29cc16e61b0b8a6dac34657d76822ae29ad5aa","modified":1579024553518},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"329483be97cdda030779da9a6cd1e3eae645cf4f","modified":1579024553518},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1579022805790},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1579022805790},{"_id":"themes/next/source/js/src/jquery.min.js","hash":"a8927ac2830b2fdd4a729eb0eb7f80923539ceb9","modified":1579031983947},{"_id":"source/_posts/2019银川ACM区域赛总结/20191020_141204.jpg","hash":"141c1b68f22ad6a2cadccf6bcf1e3d30e017eab3","modified":1579033863505},{"_id":"source/_posts/原生JavaScript实现Ajax/image.jpg","hash":"0c51eeabe48b4fe0eb41315e3c2bfa71119d3aa0","modified":1579033852769},{"_id":"source/live2d-widget/.git/objects/pack/pack-aab08850631f6fb8265de129a87403b0d89906ef.idx","hash":"fab6d01be8d3fcc4cd7b4ecab424d80aad6af221","modified":1579031303454},{"_id":"source/live2d-widget/.git/refs/heads/master","hash":"5b1ba725da5db399a06163ae7992cb26602b73f4","modified":1579031303474},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"80d359661d08b80ad561b97f8508766b3e1f6d01","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"47ee915d7b0a97e74140a25fbfc01c04d6781534","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"112f5e8f1fe5cec4419e87acfbdef0e615ed23f3","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/rainbow.styl","hash":"bc87cea0b534f2d75db60f300b069456f6516d1b","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/reading-progress.styl","hash":"170c4598cbbe49cd1527f94158d97d2320a6b906","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/mobile.styl","hash":"990bd301ce2de0a6b936781c58318f3945d81bc2","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"44fe82eadbdbb2f66adda37ac83ebd0f85876bfc","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"4f7879a50d4608c46cc2061c725a2564597a45bd","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/buttons.styl","hash":"d8ba44b8e1a0332c5c1079ff65fc83d2918a5865","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/comments.styl","hash":"3faa8a7cdb05ef3f3b02920d381773dfd54270a5","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"b56367ea676ea8e8783ea89cd4ab150c7da7a060","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/pagination.styl","hash":"8f58570a1bbc34c4989a47a1b7d42a8030f38b06","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"523fb7b653b87ae37fc91fc8813e4ffad87b0d7e","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"8e1cc5e3b20d804a7265f945b877388bffee39eb","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/toggles.styl","hash":"179e33b8ac7f4d8a8e76736a7e4f965fe9ab8b42","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"1693ec6b53758ac15d2c7798c789d6ae8af913ea","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"4fb385d8533877678440c8faa08b68fa793cb1a2","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Mist/_layout.styl","hash":"24a086a6904bbf5355a354403c9b0e6069f7eb01","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"48743ac61af37a4de2026667e15a65de5e8cf542","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expand.styl","hash":"e321bd62f5e04d1fdc101a470ec13604e99816a5","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"a717969829fa6ef88225095737df3f8ee86c286b","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Muse/_header.styl","hash":"3646e915b0a55f3b66e41d802b082aba88a76e06","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"4d1c17345d2d39ef7698f7acf82dfc0f59308c34","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"c6905c694c6fbbf372b53456a0d219701010a110","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Muse/_sidebar.styl","hash":"eeab294e14abbae231107e1a327e907b25323136","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Muse/_sub-menu.styl","hash":"c48ccd8d6651fe1a01faff8f01179456d39ba9b1","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"6ad168288b213cec357e9b5a97674ff2ef3a910c","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Pisces/_header.styl","hash":"f1f81bca31e82ccbd375f0cb9fb8dbb3beac810d","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"f5abb2ea7746586738fb4e82107fceed041708ee","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"71a3d7f2242706f7a6b79933a67ef3664cca3a24","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"d7587df06b30042091316d8b1cc58ba361211492","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Pisces/_sub-menu.styl","hash":"0424a1fcffa1ae82fe70935972a894aca885bf9a","modified":1579022805786},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"6ad168288b213cec357e9b5a97674ff2ef3a910c","modified":1579022805786},{"_id":"themes/next/source/images/background/bg1.jpg","hash":"97ac1961bb24a7bfefe74f9312f22c448646de8c","modified":1579025242018},{"_id":"themes/next/source/images/background/bg2.jpg","hash":"e3d963c95b3ae13b933a41956611d4d4d894678e","modified":1579025242254},{"_id":"themes/next/source/lib/canvas-nest/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1579024792166},{"_id":"themes/next/source/lib/canvas-nest/.git/config","hash":"7aac3f671ea9ee22cdf431c0ceb7e937b051a3b5","modified":1579024792166},{"_id":"themes/next/source/lib/canvas-nest/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/index","hash":"63a10094909117a3d112a57d719c76659cdd8408","modified":1579024792178},{"_id":"themes/next/source/lib/canvas-nest/.git/packed-refs","hash":"fd1b6267c89ab359510f522c46fd70bfd88f9668","modified":1579024792166},{"_id":"themes/next/source/lib/canvas-nest/.github/stale.yml","hash":"fd0856f6745db8bd0228079ccb92a662830cc4fb","modified":1579024792178},{"_id":"themes/next/source/lib/canvas-ribbon/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1579024740626},{"_id":"themes/next/source/lib/canvas-ribbon/.git/config","hash":"0eed8a3e8ed41efb8f870493cab2263382189ed3","modified":1579024740626},{"_id":"themes/next/source/lib/canvas-ribbon/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/index","hash":"a6bd53184235b4040334ccd83b7e452478bb1e47","modified":1579024740638},{"_id":"themes/next/source/lib/canvas-ribbon/.git/packed-refs","hash":"1a669ea6243f62a7f4c02d82225d6a49fdadb567","modified":1579024740626},{"_id":"themes/next/source/lib/canvas-ribbon/.github/stale.yml","hash":"fd0856f6745db8bd0228079ccb92a662830cc4fb","modified":1579024740638},{"_id":"themes/next/source/lib/fancybox/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1579035837752},{"_id":"themes/next/source/lib/fancybox/.git/config","hash":"20d66faedf1f14f990d90b16690e4030dbc56c70","modified":1579035837752},{"_id":"themes/next/source/lib/fancybox/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/index","hash":"29941c06b3aaed482123f6c07e0ddf979e913ce4","modified":1579035837772},{"_id":"themes/next/source/lib/fancybox/.git/packed-refs","hash":"b6ffcdb23c4f9b3e5576fe104e8596ea71603c84","modified":1579035837752},{"_id":"themes/next/source/lib/fancybox/.github/stale.yml","hash":"fd0856f6745db8bd0228079ccb92a662830cc4fb","modified":1579035837768},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"e43435fb9eaa918f5b8e35c9e110124b8bd13751","modified":1579035837768},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.min.css","hash":"1be9b79be02a1cfc5d96c4a5e0feb8f472babd95","modified":1579035837768},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1579022805786},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1579022805786},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1579022805786},{"_id":"themes/next/source/lib/pace/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1579024455738},{"_id":"themes/next/source/lib/pace/.git/config","hash":"2d2d89ef45678eb4b801dd56299bb7b0216456e9","modified":1579024455738},{"_id":"themes/next/source/lib/pace/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/index","hash":"de93a27aeb8311a1a23e0b3e11337d7e489f89aa","modified":1579024455754},{"_id":"themes/next/source/lib/pace/.git/packed-refs","hash":"7728d474cdaa7943851d42c42eaa718b8afbab97","modified":1579024455734},{"_id":"themes/next/source/lib/pace/.github/stale.yml","hash":"fd0856f6745db8bd0228079ccb92a662830cc4fb","modified":1579024455750},{"_id":"themes/next/source/lib/three/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1579024553502},{"_id":"themes/next/source/lib/three/.git/config","hash":"250a00782b562964ece19407742221ae24e56aac","modified":1579024553506},{"_id":"themes/next/source/lib/three/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/index","hash":"b2d160865c3fa253332ca82a04651168543ebc34","modified":1579024553522},{"_id":"themes/next/source/lib/three/.git/packed-refs","hash":"b21d19ed32ed11f076f4e567b4b229669c52381c","modified":1579024553502},{"_id":"themes/next/source/lib/three/.github/stale.yml","hash":"fd0856f6745db8bd0228079ccb92a662830cc4fb","modified":1579024553518},{"_id":"themes/next/source/lib/three/lib/CanvasRenderer.js","hash":"cf8e1ce6e884023ad0d692cf30f399862407fb40","modified":1579024553518},{"_id":"themes/next/source/lib/three/lib/Projector.js","hash":"1ad16e96cea2a8a9155bb429c83ef9bdd341ce99","modified":1579024553518},{"_id":"themes/next/source/lib/three/src/canvas_lines.js","hash":"650310ff6783671f8ceccf01f840b20d9c87b491","modified":1579024553518},{"_id":"themes/next/source/lib/three/src/canvas_sphere.js","hash":"7614790c67d3e79e3390fe688f6b01afad7e3bb1","modified":1579024553518},{"_id":"themes/next/source/lib/three/src/three-waves.js","hash":"e98e442f14920e9fb8691846dca3a2225d403048","modified":1579024553518},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/total.png","hash":"28ae4edd8579ed66ff0417ddd886c8d57708788d","modified":1579447205904},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.min.js","hash":"6181412e73966696d08e1e5b1243a572d0f22ba6","modified":1579035837768},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1579022805790},{"_id":"themes/next/source/lib/three/package-lock.json","hash":"57c9bed50309a639b024f96a53c62e13e1fccca1","modified":1579024553518},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/four.gif","hash":"d6cba39439f0fff63cb4b6ec38f7525d1a779725","modified":1579447424140},{"_id":"source/live2d-widget/.git/logs/refs/heads/master","hash":"4415893a330c114f9a265f187135d28570944416","modified":1579031303474},{"_id":"source/live2d-widget/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1579031303474},{"_id":"themes/next/source/css/_common/components/pages/breadcrumb.styl","hash":"fafc96c86926b22afba8bb9418c05e6afbc05a57","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"2bd0eb1512415325653b26d62a4463e6de83c5ac","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"7504dbc5c70262b048143b2c37d2b5aa2809afa2","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"6336c2b129db802221b1fd75e5fbe8aab85c0a1f","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/pages/tag-cloud.styl","hash":"7ddb7453bf9b85b01bff136e9d10a7f06baac9e8","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/post/my-post-copyright.styl","hash":"d5ce2f3c7b3ca46d37f51189f992bedbe34d0eba","modified":1579025444670},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"98227b4de364b48b11e21efcf4f1beb2ed3ab329","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"4b84f35e7040f9adb5cc540c366d7f9eb4c48bcc","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"e3ade812b5541eca5b863ad3ff234ea95925bf31","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"5d5c022aa3b2f89c2f2a178212338bb64804dd75","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"72d495a88f7d6515af425c12cbc67308a57d88ea","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/post/post-header.styl","hash":"bcba503e956e4b737b062faa66341bd880f16c10","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"9df5ba77e6cf36129bddc270407215c23c60ff38","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"eca4d80dd0df1c3b1bc06bd39e6a4bd6c56198df","modified":1579035382387},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"f5c2788a78790aca1a2f37f7149d6058afb539e0","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"99e12c9ce3d14d4837e3d3f12fc867ba9c565317","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"5b5649b9749e3fd8b63aef22ceeece0a6e1df605","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"bf8165977c0be48042581af09b5b22012c09462a","modified":1579025489066},{"_id":"themes/next/source/css/_common/components/third-party/gitalk.styl","hash":"8a7fc03a568b95be8d3337195e38bc7ec5ba2b23","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/third-party/math.styl","hash":"ef66c0a08e4243a25e41408d70ca66682b8dcea1","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/third-party/related-posts.styl","hash":"e2992846b39bf3857b5104675af02ba73e72eed5","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/third-party/search.styl","hash":"2d9d68a431a334626d463bb1bdfbcd2ea8242e94","modified":1579022805782},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"9a878d0119785a2316f42aebcceaa05a120b9a7a","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/footer/footer.styl","hash":"f5821481440a0624c8aec5fc85f093de1527095f","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/header/bookmark.styl","hash":"e02b1097a72a7d2ddc45ea8d53aa6d77c25ac407","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/header/github-banner.styl","hash":"0672ea2acf28dcc2cfc5244da36d3387d71a17cb","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/header/header.styl","hash":"4b237e2344f35e9d1f6dbc3842d5e432d478ebfd","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/header/headerband.styl","hash":"0caf32492692ba8e854da43697a2ec8a41612194","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/header/menu.styl","hash":"d5d85d3646d184e0340924addcfd2523fb289d00","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/header/site-meta.styl","hash":"a7ed54e2f52185a7b6bb9a8201f6c3aa74b0cb00","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/header/site-nav.styl","hash":"c27b3056d5e22d3c66d8a152a23634314d5c4a60","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author-links.styl","hash":"2cb1876e9e0c9ac32160888af27b1178dbcb0616","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-author.styl","hash":"9b3ff4aa24069eab0e9771437013f45e450d4217","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-blogroll.styl","hash":"95339b71ac90553fb1634c536c9749055e0c788a","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-button.styl","hash":"a237c290e8934d1a8cbbf22b3f30503d9663021d","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-dimmer.styl","hash":"9b479c2f9a9bfed77885e5093b8245cc5d768ec7","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-nav.styl","hash":"1db4ce981fe9fcb9ee4279395c29553efbb43947","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toc.styl","hash":"e2ad7ccf1865a45548e3f31c70fac2c65d6ef534","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar-toggle.styl","hash":"b3220db827e1adbca7880c2bb23e78fa7cbe95cb","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/sidebar/sidebar.styl","hash":"c83d750238d6ac13b65869a909465fe621c464c3","modified":1579022805782},{"_id":"themes/next/source/css/_common/outline/sidebar/site-state.styl","hash":"9a18b186b08ec220d1b17cf83812bcdd06077814","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/highlight/copy-code.styl","hash":"b492a45422773ab2af06ee345d527ba4c6bbc608","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/highlight/diff.styl","hash":"d3f73688bb7423e3ab0de1efdf6db46db5e34f80","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/highlight/highlight.styl","hash":"b4923515ca8e44aa62e839ce948f759cfd1f896f","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/highlight/theme.styl","hash":"3b3acc5caa0b95a2598bef4eeacb21bab21bea56","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/tags/blockquote-center.styl","hash":"7213e3d0ad7c95717ecd4e701d6ee9248ef2bf9f","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/tags/group-pictures.styl","hash":"709d10f763e357e1472d6471f8be384ec9e2d983","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/tags/label.styl","hash":"5bf28a03ef021c27cfd713971caca5a0b9466fd1","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/tags/note.styl","hash":"1a14c1b92d8a4dd8aabb5949333ac0ac79094c6c","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/tags/pdf.styl","hash":"2dc2a5b7becb11de1d4bdab6b5195588ae878cfc","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/tags/tabs.styl","hash":"d2f0f2171722533bba308f944a2ec727b083582c","modified":1579022805782},{"_id":"themes/next/source/css/_common/scaffolding/tags/tags.styl","hash":"9e4c0653cfd3cc6908fa0d97581bcf80861fb1e7","modified":1579022805782},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1579024790086},{"_id":"themes/next/source/lib/canvas-nest/.git/logs/HEAD","hash":"b47b15c5310d8ed83069a88ee4c53e703204c9aa","modified":1579024792166},{"_id":"themes/next/source/lib/canvas-ribbon/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1579024733610},{"_id":"themes/next/source/lib/canvas-ribbon/.git/logs/HEAD","hash":"57ca7eda075f0b4cced3663aad0c590d440806ff","modified":1579024740626},{"_id":"themes/next/source/lib/fancybox/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1579035835400},{"_id":"themes/next/source/lib/fancybox/.git/logs/HEAD","hash":"4aa8166c9dba109cfbdd9b0bce830bc86945a34d","modified":1579035837752},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1579022805790},{"_id":"themes/next/source/lib/pace/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1579024452970},{"_id":"themes/next/source/lib/pace/.git/logs/HEAD","hash":"f4b39c08cc707fa42599cc41ac5e93ac24288bb0","modified":1579024455738},{"_id":"themes/next/source/lib/three/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1579024546538},{"_id":"themes/next/source/lib/three/.git/logs/HEAD","hash":"31675efaa73089a8875b2f04aa795f8aaf63c854","modified":1579024553502},{"_id":"source/_posts/2019银川ACM区域赛总结/acm.jpg","hash":"9e3133a902067785682c428ee173d232489a8755","modified":1579033864541},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm/run01.png","hash":"5f494504c3c643f19a69445b049cf203fd21e5a3","modified":1579033855149},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm/run02.png","hash":"f5b122ced8f0c921f08480ea79214db05ff0c581","modified":1579033857065},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm/run03.png","hash":"52b02beb18748a30794b7e37abfe6d2436c5e6aa","modified":1579033858717},{"_id":"themes/next/source/images/background/bg3.jpg","hash":"cd7f1bd3ffdb14f4c147a362cfa5e8bbd357b3e0","modified":1579025242550},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1579022805790},{"_id":"source/_posts/2019银川ACM区域赛总结/20191022161721.jpg","hash":"fab6a900d56854b11dfab00ba84afba286de2036","modified":1579033864221},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm/run04.png","hash":"5dcd9f8b6e6e341f587b99660a44e09ae5f4c3b4","modified":1579033859049},{"_id":"source/live2d-widget/.git/logs/refs/remotes/origin/HEAD","hash":"4415893a330c114f9a265f187135d28570944416","modified":1579031303474},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/0c/dada082d621dbfdd00f7020c33dc751129167f","hash":"b490c11cdefde6b331a7d4ddb055e34ad08459d8","modified":1579024792158},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/17/9eb5d6cd5f44ba3dd9e08b4ffcd83bb26db80a","hash":"03d593c92c9fad045d298f58afdbbcfbde923999","modified":1579024792158},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/2a/f622a4d7df40a2708946e91d6d7a0df1dc468c","hash":"3da7207fb18d361b83c56f4e35f67e9e945abd82","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/2f/9eba51ec174b1e0c719d12cafa7c3c07140471","hash":"fc994d9d8b3b21ec7c941eea7e3862970e297e9b","modified":1579024792158},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/44/6ddf9b6c0e5ade17ca5cb99f9b3a5300919c57","hash":"fb72799ff98445f72fda041337da4cf105d9dcba","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/45/9262fe92f0115707bf8d8764f1886bc5e7c9e0","hash":"36040483f8af76775b7e4b6d87cec53729625399","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/46/cad4f872aa93e813aed99547c4705322ca483f","hash":"b0465d3186e2d58a8a99c56c6e68aa2965a396d4","modified":1579024792158},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/50/dd2a6539498a70226c81a587db486b47e839ff","hash":"3844b0c815d0b4b32c6312c751a826bf9dc2c945","modified":1579024792158},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/51/7c5eb7dcc2cb9769efea2e7375ff6e04123150","hash":"ec53157077d47430f4729bf164999d18d370aeab","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/5a/69ce9c2e4a1a34f6063ae9a121af1555669c69","hash":"dad25cc0f450e2827b5676975f4a70636e3fd2c8","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/5e/8ae972c99b04af7dd56dabfc485e8fdae5094d","hash":"791b3349c5696ccacae00bffbdbb8d88a03e61a9","modified":1579024792158},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/69/39233ece53c9bdb9a1faf3271ed5768b034aad","hash":"5a770d418c1bb7b0f031f4d5416530002032fcf3","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/69/a20d65d83035fdb01734a8eabe3340f740a4cb","hash":"9e95b02d8e43ec92e06bee3f60dffb74e8e7b9fa","modified":1579024792158},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/75/de2b8fa62d52690de32c351c63ab6446104ed5","hash":"52d10122d633ce4895a0690c5955e1b356f5a391","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/7b/c7e3186212b6f2e06d3370502565e2c6326890","hash":"379f3c6486f589fc9c1ab07d0382adacf4f655a2","modified":1579024792158},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/86/1c9f4241fe0eb6af02ad770d5ce04c1f68972b","hash":"7005c3e36015a4af30d4b91bd5a849a7861a073e","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/8c/150fefb741be4edee07810003c8a845113e209","hash":"067de29d5efa0a46cdc8f9f113820e5e09bfa50a","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/90/f6477118d05f5f96ce0a63c6f18b7b2baea200","hash":"385f58e92981f27fa54eb52bf60424e87c70a9d8","modified":1579024792158},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/91/f99a0c53b26dd54f56b9e452c68f56b06f8f7e","hash":"3dca8a5629e66599b6e0f146aa32f1b7ce023d89","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/98/67d1132e0e50bbb7df754a63358d70741df6d5","hash":"3cb710a1faee73c08036f5e2df7df3a7ce29e9dd","modified":1579024792158},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/99/be66a33ab4ebc34f62f2880a0e0cc6d334d0f2","hash":"f2346fe8ddd7d7abf38f2946f3083d8150f502d2","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/aa/da83ad9aa55faa2b34ede31b1d41e16966f80b","hash":"b304541ab95b7969a63ba2ec4f60f5391bd8bb44","modified":1579024792158},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/ab/45cbef9bc70ceff60f1ed52f2a5c34f6ad5725","hash":"ee2fa8f3df0de9092a4fce015cefd76ea18f4cfd","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/b1/bb278ca2e50dff1b343f9d5ca025272859432f","hash":"74f0afa72a30268d84613fb0d1d893bba866f01d","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/bb/5755c22b6c1b7461319624f0f000bc947882ee","hash":"2b87a2a354a0fa77cbddf461b03b0b8e43c16a4f","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/ca/3466a8cbf05c2982c58199d6ee71ec6d0271ca","hash":"a9b80b5d827b5e84229b1afd7920d9218dce610f","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/d1/b8c85241243a80f16d56e7a50244d3695f6e6e","hash":"baf56a83286c72af11667786dc59e7c58d30e427","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/d4/95d28a8fab74d23908f6ccef9e4db2625fbacb","hash":"59e6067b0a806deee7bda6460b36c0f63e2e1db5","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/d6/5de52977302632417c21e015956fb3dab8cabd","hash":"e0c8f0483b20434e63748a649ca4afbb417997f4","modified":1579024792162},{"_id":"themes/next/source/lib/canvas-nest/.git/objects/e1/5c0793114874195462829db04d021face6640e","hash":"ff6c6d9f05b171ba67b44564ae3574d16eae6222","modified":1579024792158},{"_id":"themes/next/source/lib/canvas-nest/.git/refs/heads/master","hash":"04088d44304ede9ff4c66a3725444cad71096e18","modified":1579024792166},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/02/5cf882fc75a324b1d71b0921eb52ea427387fd","hash":"4a0f15d00f50c629f01c2274e26ef05b3779b6c6","modified":1579024740618},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/0c/dada082d621dbfdd00f7020c33dc751129167f","hash":"b490c11cdefde6b331a7d4ddb055e34ad08459d8","modified":1579024740618},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/15/9cfb8a3050111dfb3e6635e3f37fe68de2ab30","hash":"f4e1752896135edd6c9a36164b45893a59839548","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/20/47d8728f7950fcc2276c339ee199302805838d","hash":"813e7f6c3b8954c40b250e6ba592d6bac7874397","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/25/3593d429ba9f66eb536d2577e4aa8b74ed7dfa","hash":"b68bb1519d36e82753367a811009e5850db4ddce","modified":1579024740618},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/25/3acc9a19f8a5047f053ea8b4a62684a4204939","hash":"d2210d7c39aa3801a198b38651a3f013d27bdd46","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/2b/41ae14433eb4a13cd99ac9736635723e813c32","hash":"0e30e5106b7021432c917699f60684276e727eb9","modified":1579024740618},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/2f/9eba51ec174b1e0c719d12cafa7c3c07140471","hash":"fc994d9d8b3b21ec7c941eea7e3862970e297e9b","modified":1579024740618},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/39/ea36a17ae4ce235f97d0cc1993cc51f932aa16","hash":"d3b328e06996ff12a2cf1f546bb78ab37a0b3b50","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/56/4913335d11e112ac80e8d550c8347016007f6d","hash":"50e9db730ceac6b2d0c8e8d5a3fec450290fdd8e","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/57/6d268825c6e7b3892828b61b9b408600faa1f2","hash":"2ca9617d2459b9e010e71b3b221fec42d76cae32","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/58/76c74f8c24cb9306189bf49fdf937b955c065c","hash":"283c92c40dc84fa11eba7c8b2ee8c5234dbf7ee6","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/58/b315e0ea2584550eebcda4f1c17a9a7f2bea16","hash":"c7dc07b78ad53f0f515b3243a0ff09fb8ddb8235","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/5d/93512df328612ac84d124d0a64f78ddcd7ec28","hash":"94dc5692c542e87ed40ce00ab5e5d72d4ae78f23","modified":1579024740618},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/69/a20d65d83035fdb01734a8eabe3340f740a4cb","hash":"9e95b02d8e43ec92e06bee3f60dffb74e8e7b9fa","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/6c/34e310dd41c6bfa8db842190388ab83e6d4fa2","hash":"b327c0ce763240a6a8bd2f3fb55ace6b9e3df671","modified":1579024740618},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/7e/871dba93cad35ffcec76a936259ae9a3641bc7","hash":"957e9e7db09ee72fc49ca852d3cc67242567fa45","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/a2/822bd3b1fad40e718ded64ddfac693c4ac24c4","hash":"14b60f650711229ee8301f49e8403bb4bb991e09","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/a4/14bc6b6b6deb276c361d14724cdc6aa9b65b84","hash":"5252d85b51d1de339004b7f6b2cd9efce16730c8","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/a5/b8ea74a3afbc760b01b6d4bd432f4f1ace013e","hash":"afdcce658085edbf16ce7f4719bec0cb5536e77f","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/ab/2197a6f5baffdd1d2895c169f4777921cc4027","hash":"81a75ca40bcfd278d6a9d67dedc8d61d959e2baa","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/b9/07949515b208cc605b513ff9d5b8153cbe2fe1","hash":"8fb6e8f2e6b4df8787239335ef9777a6c888d3c0","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/bc/43844047aa08d2b58a40fe3915a8382214a588","hash":"34086f267f92f39ea9819a5eafc04921661467d7","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/c5/8416b72bd371aaf3bc8952f819c1afd3e4c0b4","hash":"aa8e6e340697fc6d9697c1ab8213ee40aca4ea82","modified":1579024740622},{"_id":"themes/next/source/lib/canvas-ribbon/.git/objects/c6/d0381e6cd08086561110f76b5f921bf81a6f87","hash":"be98eb9329c91132e90d942a44d05a41c78b4470","modified":1579024740618},{"_id":"themes/next/source/lib/canvas-ribbon/.git/refs/heads/master","hash":"16bd947558482613ed699f6cd50bfef39a7837da","modified":1579024740626},{"_id":"themes/next/source/lib/fancybox/.git/objects/00/c03f6be011e8878608eec12f68caf42b73f38e","hash":"8516bd35bc8f9223e13de5877778c8d14d49d6db","modified":1579035837748},{"_id":"themes/next/source/lib/fancybox/.git/objects/0c/dada082d621dbfdd00f7020c33dc751129167f","hash":"b490c11cdefde6b331a7d4ddb055e34ad08459d8","modified":1579035837300},{"_id":"themes/next/source/lib/fancybox/.git/objects/16/b01254a56610f4c6b7721c534ed4fc40ae51dd","hash":"88ca5fd99322d3a4067e0711af79f41c078f2ef5","modified":1579035837316},{"_id":"themes/next/source/lib/fancybox/.git/objects/19/3567a3107003507fafacd255c349857e417926","hash":"ef5eab75e8c6998cb223edb4eb8a26c4cfc9415c","modified":1579035837744},{"_id":"themes/next/source/lib/fancybox/.git/objects/1f/a2c5f332b7e304431213aec21012e53f8781d7","hash":"7632806182aa989d3b7029579d5c03c34b113ee3","modified":1579035837300},{"_id":"themes/next/source/lib/fancybox/.git/objects/2f/9eba51ec174b1e0c719d12cafa7c3c07140471","hash":"fc994d9d8b3b21ec7c941eea7e3862970e297e9b","modified":1579035837300},{"_id":"themes/next/source/lib/fancybox/.git/objects/36/9bab09306448a2970d378b59bb21c059edad63","hash":"877e0c15623d0d6ff8f09bb627fc60a489f3c105","modified":1579035837304},{"_id":"themes/next/source/lib/fancybox/.git/objects/3d/521bfc64755e348870094e85323dc1b9c96a6b","hash":"e9660fc4f89ecb176b0ab6e4860579c1bfe9f9cb","modified":1579035837300},{"_id":"themes/next/source/lib/fancybox/.git/objects/40/9607f1ba381a64c3ccb8d5440299e8ef868ef8","hash":"a462f7a9efebb70c4051f92c09ccbd9885132c77","modified":1579035837748},{"_id":"themes/next/source/lib/fancybox/.git/objects/47/d427b6c52396bbab53a05f57aaa82b52c805b1","hash":"c5626bbb62f4d1d1e39034e7f44baf4c509410d6","modified":1579035837712},{"_id":"themes/next/source/lib/fancybox/.git/objects/51/cf05811ed7d35e92551db1ba5a6e267ce781a5","hash":"99c009035ea86e3876b586577677d4d62ae12379","modified":1579035837300},{"_id":"themes/next/source/lib/fancybox/.git/objects/53/ceaabe0f8677333c5be196778b3e40840a1869","hash":"7bc1c1c42059d5402335b5293bfb5e54bee22557","modified":1579035837300},{"_id":"themes/next/source/lib/fancybox/.git/objects/54/0a7b36ee26decfc3f0f34bf73bc85c48899128","hash":"2e5447a9dd879d71368e9dddd34d93849d00b934","modified":1579035837748},{"_id":"themes/next/source/lib/fancybox/.git/objects/63/c555caede30ab06d6dba16644a827e9574c8cb","hash":"846603220288272ad5d35ebdc3c917cc4adce424","modified":1579035837300},{"_id":"themes/next/source/lib/fancybox/.git/objects/64/c47e893a0fef71c8c0930975ef114d9812da56","hash":"eaad75fab15724f9c2b069fc1ce9b8216be149d7","modified":1579035837304},{"_id":"themes/next/source/lib/fancybox/.git/objects/78/068b93f813cecbbd50c8247de547035009d512","hash":"4bc2bee779bd7e3cca13ee34801cf1e12585e5ae","modified":1579035837304},{"_id":"themes/next/source/lib/fancybox/.git/objects/7b/15d3cb03fda86241f8b2b335f04e9b9de0e1c4","hash":"d1fe3bd82c90f7d93874798a8ee8ebf1391d7207","modified":1579035837740},{"_id":"themes/next/source/lib/fancybox/.git/objects/7c/00ef8195b73793d477d22e723ecdac9553ebf3","hash":"fd8c4fd143b32fb3e86367f123feb7c35b305262","modified":1579035837708},{"_id":"themes/next/source/lib/fancybox/.git/objects/7c/c60b295fa2dcb82537a63792c9b3b3c2e74c33","hash":"b2dc23c71b13726c391aaefaa5312227a9b6ab7e","modified":1579035837316},{"_id":"themes/next/source/lib/fancybox/.git/objects/80/6b27034bd69d563e4243c2f12b43c7064b32dd","hash":"b7d3e8020767ae60a2029da8eccb0068623dc618","modified":1579035837712},{"_id":"themes/next/source/lib/fancybox/.git/objects/89/9d7a75b543fbed2a785f67d995bc77e06eb2e9","hash":"5651e2b80703225f642625c0fb2646543096d2cf","modified":1579035837300},{"_id":"themes/next/source/lib/fancybox/.git/objects/92/4369c371444afb18fb86309229f5b4c24c6cf4","hash":"9eb6fa8ff9081e6650f6bee350d21567df105737","modified":1579035837740},{"_id":"themes/next/source/lib/fancybox/.git/objects/9b/fe9361836240600c1bcc3cab9d42b35e731fad","hash":"3d38ffc7ac1ae85224691ef15d7f32e40c40b3a2","modified":1579035837316},{"_id":"themes/next/source/lib/fancybox/.git/objects/ad/569256343419017e8832a38faaa1c786716a1d","hash":"0538e4abd112b0a843035f28a511edabbe73f2ce","modified":1579035837300},{"_id":"themes/next/source/lib/fancybox/.git/objects/b3/b3098638624b56be968573e2dab1684f8a7f06","hash":"6fa11a2d904dff2b8f4ae1bd88bdbb66736438a1","modified":1579035837520},{"_id":"themes/next/source/lib/fancybox/.git/objects/b6/c361c8dcf2f5a7572e81b956272e4cfe1198c1","hash":"3e160c605dbd94dcef2b9692a4a5a82bddb76264","modified":1579035837748},{"_id":"themes/next/source/lib/fancybox/.git/objects/bd/e1f741357b44b49290d43fdd193125202fef81","hash":"9beefc75cc0c37d04e98dd13b51ad85df40e77b9","modified":1579035837300},{"_id":"themes/next/source/lib/fancybox/.git/objects/c2/fc5def1b6c38369e5e8b849adb956bd79b549e","hash":"27f03b9616e615b2724bac0fa4507d152697f3f1","modified":1579035837300},{"_id":"themes/next/source/lib/fancybox/.git/objects/ce/c0e316bee5d497ee834dbd29e0c5aad8331052","hash":"3d769fa5f55014841d10bb3bdf1b9725c43e9043","modified":1579035837748},{"_id":"themes/next/source/lib/fancybox/.git/objects/d5/d10f6be62acc10fec6e11e8dc4affe1184a17b","hash":"cec51b2539349d2aba1ec5d11eaded3815eccdc5","modified":1579035837520},{"_id":"themes/next/source/lib/fancybox/.git/objects/f6/bb280a0b2c68256a8e906b35c6976c80c1b3be","hash":"5daaee11fc384fbe0f02c7123036c954ee9a73fd","modified":1579035837300},{"_id":"themes/next/source/lib/fancybox/.git/refs/heads/master","hash":"0b56bdb897316a3b4ec6c120673249f65f4cb420","modified":1579035837752},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"27f034e5db8c32e268e2959b9a7c1258d36e4510","modified":1579035837772},{"_id":"themes/next/source/lib/pace/.git/objects/00/13175fe71888324d9142744034e8296501174a","hash":"0ad0e50f7fe91fe14491924aa4b1e2e8f060a5cd","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/08/38a9623fabb4014d7ed7c0fa4ff8a5bc5e697e","hash":"aeee9d11c3a4c1dec1ad8414dca14e5aa9ca2b7d","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/0c/dada082d621dbfdd00f7020c33dc751129167f","hash":"b490c11cdefde6b331a7d4ddb055e34ad08459d8","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/1c/159365320ef5dde63906912f3df067376b40d0","hash":"1dd6b7373c3f9c67e34aa319c9c08fd0f667156a","modified":1579024455722},{"_id":"themes/next/source/lib/pace/.git/objects/23/4f9b3e93f06a85cb2ec01acc872ccdc2bec7cb","hash":"63f8640eceff35a80175a102fcbd8789e690cfaa","modified":1579024455726},{"_id":"themes/next/source/lib/pace/.git/objects/27/8da13dccb38df6bb34360d4919ee2ba81ea6c7","hash":"c5618315849061059ddd6cbea8e11252c561cf48","modified":1579024455730},{"_id":"themes/next/source/lib/pace/.git/objects/2f/9eba51ec174b1e0c719d12cafa7c3c07140471","hash":"fc994d9d8b3b21ec7c941eea7e3862970e297e9b","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/35/a749d823ad0aae6111a76dc501a1170478f376","hash":"e757129fb6bca3170b62b05f3e850e4b55f3ae88","modified":1579024455722},{"_id":"themes/next/source/lib/pace/.git/objects/3e/dcd352d2a1a60dbb6a43e7e9f00bab8b55791a","hash":"725bf5094855cd943dd1cd351906fb1ebec1d861","modified":1579024455358},{"_id":"themes/next/source/lib/pace/.git/objects/41/28e69301ad36a283c0fc523f3aef89644d2467","hash":"d8b985cf431fbdc5b4fa3be89e27db7a3437c920","modified":1579024455726},{"_id":"themes/next/source/lib/pace/.git/objects/49/0db22b657dd64430d003fe2831905a54858b22","hash":"43694656c4c331cfa3667afca630bd486ac0d0fe","modified":1579024455722},{"_id":"themes/next/source/lib/pace/.git/objects/49/234ebf40b265bb9664d22bc391237ff856a3df","hash":"b527eb3cde1e78771ff68c5f633a3cf91816e274","modified":1579024455730},{"_id":"themes/next/source/lib/pace/.git/objects/4d/fbb499a4f7b2f26a535c335cd66c966ff8b261","hash":"14e4cdcc137045c7efed32f796273d40c9fcef87","modified":1579024455722},{"_id":"themes/next/source/lib/pace/.git/objects/53/3d55db0342c2b011ac05703c3b42e88a25c1ed","hash":"c48454760d2e04602a5499188b33d38839c58aee","modified":1579024455722},{"_id":"themes/next/source/lib/pace/.git/objects/5f/2920b23993e6476c3edc77f76eba566e74dd7e","hash":"122d8ac05247282340317587435273e6f3c5a188","modified":1579024455722},{"_id":"themes/next/source/lib/pace/.git/objects/60/0378418401f2b0e7c58407a7bbc5a5196cfa51","hash":"20489d796247dda758599f40cbfcf14d194ef64a","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/60/8cf35556105f51783ede3fa1e6c2102e8945de","hash":"2c71f7a2ff047119ee898a8edec216238710b89b","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/61/fcbe3a99ad371eacdf3a3703883f8e95e072c8","hash":"480b60d684f9a077ade5dda0acfc75bcd9597aff","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/68/54b8cf544e974998061fb08ea2bd96b561ed68","hash":"1aa0706b6495a5ebd70c3822ac3533df41940fb7","modified":1579024455722},{"_id":"themes/next/source/lib/pace/.git/objects/69/a20d65d83035fdb01734a8eabe3340f740a4cb","hash":"9e95b02d8e43ec92e06bee3f60dffb74e8e7b9fa","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/6a/fa2f52022b00caac3817898d4338ce4d99aa45","hash":"1a6e249ff197293bc3733ddb7eb99d82a21b9342","modified":1579024455726},{"_id":"themes/next/source/lib/pace/.git/objects/7e/7e5cf8a2a18caf4e0262d1656dea658374d5ae","hash":"47eb39060193e0032e3223b4dfc1a6a55f6612fd","modified":1579024455730},{"_id":"themes/next/source/lib/pace/.git/objects/82/8dcba3c8a21de08d1eb38f2eee453b51543188","hash":"629aad2ee2e564790e78cd46e99ad396544960ab","modified":1579024455358},{"_id":"themes/next/source/lib/pace/.git/objects/84/a17ac7b4fe9cea559de91f00af88f810bff7f1","hash":"b41b6d3cbccd75b711f0523bba1c26bf19b0a862","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/86/ab4cb05d5132451e71dc4ecf6ef663f7404126","hash":"53f157552aa57d405ce6ab58c424bb948c2820d8","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/8b/b4535a79cc15127f8906b24c4e0bb4a38a5947","hash":"9c2d65a63f18929b09f3592dda064f24309ff98b","modified":1579024455358},{"_id":"themes/next/source/lib/pace/.git/objects/97/1e8a1f2ad6d45f693980c106af0aead9d1c215","hash":"e45f0963920a53a57f6b53d178e5b05a8e315189","modified":1579024455358},{"_id":"themes/next/source/lib/pace/.git/objects/9b/3058068409f2282607ebb91717d7a6a1406230","hash":"651c5857021e11dc397df86dbe0f01e6c7dc7f16","modified":1579024455358},{"_id":"themes/next/source/lib/pace/.git/objects/a6/dbd9c99e726f621e2bdcd3c6fe2795a5d4272d","hash":"25350dd31f504af7206610ced355d162aabda8dd","modified":1579024455358},{"_id":"themes/next/source/lib/pace/.git/objects/aa/813c5a6398600e01b740696cd889eb3becad84","hash":"c62a1513ca820dc59fe1cd6d9ec16c92e0e2fbf0","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/c0/05c71f1a000d8187df58083d215c962d7f5505","hash":"dffd212ca2ec705233fabe82a6f483d6be4b151d","modified":1579024455358},{"_id":"themes/next/source/lib/pace/.git/objects/d4/7aaf8effab41aa414596c56dff4d35ff8da1f5","hash":"33e758f44ad48eb1540363a06c31bed1ed929c60","modified":1579024455730},{"_id":"themes/next/source/lib/pace/.git/objects/da/79363b808519d44a7eda67d7bc81e1587a06e8","hash":"0dc5dc27991da9a09d705e488bc3f1fe5a4d4728","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/db/d45db3a1d6c09fdf30fc1f0bdc2c6fab5a0680","hash":"5c0bc5c141068651fcb47ef549f556d67153eecf","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/de/79ab6539ac3702aaac64b879d95e6575f4eefa","hash":"0046fefd52ed4679e0fee757cc91ced94e3ddc12","modified":1579024455726},{"_id":"themes/next/source/lib/pace/.git/objects/e8/83088ed2cfe69a983e9e277a6b54b7de226344","hash":"2386487a5933380ac3305ea6b5744d75bdd07292","modified":1579024455354},{"_id":"themes/next/source/lib/pace/.git/objects/ec/6708dc18a5dd312a6735d4d09eddbdb76e75c2","hash":"66e03a78b2f1d36feb9f9347dd5e68e344c3ee68","modified":1579024455730},{"_id":"themes/next/source/lib/pace/.git/objects/f3/0e0a99bb016267bde55537dd47b3657ae59544","hash":"8bf0bc17a6111b6a82981073133f33cc8e815c41","modified":1579024455358},{"_id":"themes/next/source/lib/pace/.git/refs/heads/master","hash":"22684435265b2bb504024b34b80ffbd6786a2411","modified":1579024455738},{"_id":"themes/next/source/lib/three/.git/objects/03/c40a4b50e21c63a0e27b1fbcd014168ae3f6da","hash":"987ca2a1169e875a5ac73e8a1a906b9ae88d4d22","modified":1579024548702},{"_id":"themes/next/source/lib/three/.git/objects/03/eb19e6b3194a820c462bc63177b6fc2bda245f","hash":"0be88820832fa6ea30d56905e98b27798805dc92","modified":1579024548870},{"_id":"themes/next/source/lib/three/.git/objects/09/3d290f60c3b467d503633531d7ce7cdd42dd75","hash":"ab09bc8bfc9079e408dc6facc1bfd9aa5d6bdef9","modified":1579024552046},{"_id":"themes/next/source/lib/three/.git/objects/0b/de10292fcd5dd4b66d1bf60f62ea7d7a30b310","hash":"37710386189fe435ea20541a69c1a9b833b5f50b","modified":1579024548870},{"_id":"themes/next/source/lib/three/.git/objects/0c/dada082d621dbfdd00f7020c33dc751129167f","hash":"b490c11cdefde6b331a7d4ddb055e34ad08459d8","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/0e/f76c758387d59ca0221cd50564e9edf7080c99","hash":"874d6d28ce21ce2873016183dd9e22b91f71c750","modified":1579024552250},{"_id":"themes/next/source/lib/three/.git/objects/15/e42465bbd9589d2112d7fe3328bd7f85c6b24f","hash":"c28f5e24b9b15ecfddd666711c6d6ef57317cb29","modified":1579024552050},{"_id":"themes/next/source/lib/three/.git/objects/19/65ef0ba0e2c1ad938cffdcbebed63048751ac6","hash":"75921c60b65a5606a85ab5cec185f430d844048d","modified":1579024553498},{"_id":"themes/next/source/lib/three/.git/objects/1a/f9d30697fd2194a4132a3a6647722be2eb75dc","hash":"0f686b4e26b1e751509ded8a2db697b1d7938004","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/1b/3d1cd16f3e6ce99ea92c7e9c0b78ee30a8c346","hash":"16569e1c4912fd762f32b13de839d05b9c319e54","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/1f/0b95a965630f47a7264fe9e9456ed7da36c2aa","hash":"6e98b6d7740bf53074339ce383089320fe1962b9","modified":1579024551870},{"_id":"themes/next/source/lib/three/.git/objects/21/77c1416c8e91ed918b6d3cf7f333d99d659a24","hash":"7330016805a652c2153bfcfbdd4c3c50e5b5a642","modified":1579024552046},{"_id":"themes/next/source/lib/three/.git/objects/21/cbdd0d76bb18019bcb47aeec029fb13e211b09","hash":"c4466a47cecee06641b74dca59ed92665c24a5d7","modified":1579024553502},{"_id":"themes/next/source/lib/three/.git/objects/29/4f11136ee13277ee96ec3bb56d810f43655298","hash":"a294c3770aa5e7ed386075202f5b88048e1d170d","modified":1579024552046},{"_id":"themes/next/source/lib/three/.git/objects/2f/9eba51ec174b1e0c719d12cafa7c3c07140471","hash":"fc994d9d8b3b21ec7c941eea7e3862970e297e9b","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/34/cbb2a80da03e4d233dcfa3f11fed64894b2de5","hash":"ddf0c1fdb72ed14c50b1d1718a122f5f2a38a3ed","modified":1579024552978},{"_id":"themes/next/source/lib/three/.git/objects/36/3db3ce197d25b8c64db663aa9000a181511461","hash":"f87bc2ce87e37d0ee60eceef8be89dae4c52e01d","modified":1579024548758},{"_id":"themes/next/source/lib/three/.git/objects/3a/4c8581b3aa0d4f9192de158bd4223a90d646b5","hash":"a64efe9f8e2db0ff3cfb7b5e71fedf229ce290fd","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/3a/ae52073909b7ccdbd43538ee6c814691935c57","hash":"652619b1d76f267c1646b6167de80f58a520525e","modified":1579024553498},{"_id":"themes/next/source/lib/three/.git/objects/3a/cef7449b991ee78bb5b7f2f121996b9ec9bba4","hash":"d9165d5939be17750b9edad5d0fc32029e4a23d6","modified":1579024548870},{"_id":"themes/next/source/lib/three/.git/objects/3c/6fef4314903036253335d4550346f6b927c721","hash":"1ee4e7d110363dc5e2676b675c7f7030731cf3a5","modified":1579024552042},{"_id":"themes/next/source/lib/three/.git/objects/3e/4151e56ef50d7ff46a1ce73156c35ac6f1224d","hash":"a47d2e1895903aa7e1b51d35731f212ffc6a1718","modified":1579024552050},{"_id":"themes/next/source/lib/three/.git/objects/3f/f2616b188ab71e1abf2029d7d55834c5643fc5","hash":"65bbc360ee3cc66fba71b9fb0baa3cff744327b9","modified":1579024548706},{"_id":"themes/next/source/lib/three/.git/objects/42/d67e32b0d5f676f7462ad5b013f4eb8cad2486","hash":"fb1c4d377401f2145cc721d96fdf40d89ac23434","modified":1579024552582},{"_id":"themes/next/source/lib/three/.git/objects/4f/f48fd861ac49dd98ce52052bf6214f0a91facf","hash":"ae4d7b9a38e8913c055d37a6f129378d089bfd65","modified":1579024552050},{"_id":"themes/next/source/lib/three/.git/objects/52/71f18c203d24b27ec7bd977c2d5c61300cea1a","hash":"cdae53ba376df246585a2f44a86d0c7da98bca1f","modified":1579024552042},{"_id":"themes/next/source/lib/three/.git/objects/53/c865f8ff0aaa7ae2c8da7324dce73756ffe7c0","hash":"2d1c2dcfa342f46910a5698023b2c208bf3336e0","modified":1579024552250},{"_id":"themes/next/source/lib/three/.git/objects/64/d845d3aed3dce9eab9de39793f1c4d1d6e0deb","hash":"1c7346386e8c3d8830bf36bff7011976ba326b3e","modified":1579024552418},{"_id":"themes/next/source/lib/three/.git/objects/67/6b9f6189356d0201fd72dd6f98db19628a2ff5","hash":"250795ea0af79524945e66b28f233eb8bd9ee7dd","modified":1579024552038},{"_id":"themes/next/source/lib/three/.git/objects/69/a20d65d83035fdb01734a8eabe3340f740a4cb","hash":"9e95b02d8e43ec92e06bee3f60dffb74e8e7b9fa","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/6b/128053933889f264c239abe0d381523daa8fa5","hash":"23df1e6daed83528bc2f36980678ecc31e17f09e","modified":1579024548762},{"_id":"themes/next/source/lib/three/.git/objects/6e/a4473e91dc2dbc452ff446e7cb04cb2ff16da0","hash":"710066cce498e372a932ff272d3d0eb4345fe3cf","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/6f/f9f6347d48d4bc18b07a813f9140d7287df7aa","hash":"46232e003a90f98c78af21c4898ab37c66fda385","modified":1579024552050},{"_id":"themes/next/source/lib/three/.git/objects/70/0960a662785b70b5c72909810794e1c18e9891","hash":"ea3c3330dd0a213a3cebdc42ee57d43fb8f9813c","modified":1579024551874},{"_id":"themes/next/source/lib/three/.git/objects/79/ae5f64ea4be7e1a108b2f1fc8afbca7bfa1fba","hash":"4e28517d80599b1a6051b1d3f657654aca6333b9","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/7b/a927a3390f9a6345039cdb5bc54c6a54297f69","hash":"0d10f821d9e61a27c3f9d9e03e923265693d68ab","modified":1579024552978},{"_id":"themes/next/source/lib/three/.git/objects/7d/2bcbb026e4a38ab45317d8b78bfed70ba25c51","hash":"05394b260c2c58ee38b7224bb4ecb52df1e7f354","modified":1579024552050},{"_id":"themes/next/source/lib/three/.git/objects/7d/d7c1e8f79dc9a9a99e290147528d7a47d46830","hash":"c2104c89bcf686b243061b456ddc86d916b84360","modified":1579024548874},{"_id":"themes/next/source/lib/three/.git/objects/7f/6a7ddb8a04644dc980d83c9878b4621acf82f5","hash":"c517caf5d47c9f1eba2ced6800dab03e2e29a130","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/80/5e5d92b903742c45e359b26a06cf86376301d8","hash":"6d39f5d10ed1e3acaaef5ac5999945b65ab12b88","modified":1579024551870},{"_id":"themes/next/source/lib/three/.git/objects/81/d7d11db23df8681d1a8242fb27252a9d2d7062","hash":"a294b374bb129cc8aaec9c01bf1df1c5addafe9d","modified":1579024552050},{"_id":"themes/next/source/lib/three/.git/objects/82/69b6fd29a514f9bd746497b298176228bd4061","hash":"cf527c08b5d88d72939a61446d128eba2fb94be2","modified":1579024552038},{"_id":"themes/next/source/lib/three/.git/objects/87/782e1008d1f88a9cb63d59407b1cb9e47b0861","hash":"0af5c5e17b27d8114fddd53d7cae8bb3284ae9af","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/89/b7ae569312ae577534d7b58647232fb48bfb08","hash":"a265c0a7e24267bd82d11a48f091d2241edc0080","modified":1579024552046},{"_id":"themes/next/source/lib/three/.git/objects/8a/2159d7a0c70d394071e8dcc79502d5cd1fc5e4","hash":"58ff19b7a9a65c9e562b9e1c7ee0ed3ac005b15d","modified":1579024552046},{"_id":"themes/next/source/lib/three/.git/objects/8e/3ea1a067348d2a9c066fbf201663b462a3ed6c","hash":"f3168176590ac08570ef75b73ecae2b4a455d753","modified":1579024548758},{"_id":"themes/next/source/lib/three/.git/objects/8e/985e4c70f87248ecc33d93410d80d1632c552f","hash":"a1d2084dd43e026f1b93027221629f5cbb135c88","modified":1579024552050},{"_id":"themes/next/source/lib/three/.git/objects/90/e94cbdbfd33fea8606d447d01011ff657478f1","hash":"df922aee3bc7eb3266134797efb6f888743c6a12","modified":1579024552418},{"_id":"themes/next/source/lib/three/.git/objects/94/1060002b98395a31cb47a33166f5568a20d4b5","hash":"c345981cd6097743cbb6f44d61b33ed37b110b31","modified":1579024552050},{"_id":"themes/next/source/lib/three/.git/objects/9d/b082c6081a7d8b8b752bc35ebcba85073f5fac","hash":"c240b76ccdb8552d6d4c75e55d5c4c93807756af","modified":1579024552046},{"_id":"themes/next/source/lib/three/.git/objects/a4/6866ca175f7c27daaf6b39c94d930bc27d4ce5","hash":"fc416f7f3f62c338bda28bb56bfa6f8fb49421ff","modified":1579024551870},{"_id":"themes/next/source/lib/three/.git/objects/a9/27aca23c7f27f5d1ebf2c4baea3aa5d8676143","hash":"dc3e5c853a502fbe7ea3e35c2f7a2bf94318ade4","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/ae/8fa980e909988af2ebd9423658213d2e7e6bba","hash":"9978e4f223de97e23a047986bf21cbf48663a150","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/b0/2d36d33210bc68d3e6451c663eb567ebc5721c","hash":"8d3bac2fa021a8f4609a134167edb84fd46254b2","modified":1579024548758},{"_id":"themes/next/source/lib/three/.git/objects/c3/e49d5369de034ff0788d11519bd9150b67ce74","hash":"256a3f0a7054a3e2cde1fc58f027565c87ad3d1b","modified":1579024552050},{"_id":"themes/next/source/lib/three/.git/objects/ce/175226253f7f31da632b93ab6560debab1bf6d","hash":"55c41b0948cb31fad3a52ab7ac91ba93e6c22751","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/d0/32ce3fe05be57b72cc925f86149497229cda13","hash":"59e5036e95b496852ad3b918eac2e4b28a5951f2","modified":1579024552046},{"_id":"themes/next/source/lib/three/.git/objects/d2/a00ca1067b93b81dae8ea7d0c9838e935595e8","hash":"4b1ecd5271cdf94c10c2e413c7378adb22e940bb","modified":1579024552046},{"_id":"themes/next/source/lib/three/.git/objects/d8/8d5765694f92039daac0f944405d4cf61a0d13","hash":"70d2b236fcd955aa4fa95efc2e18c98919003ec6","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/d9/0026fb76d55bba50ee4a221c887a0f1a8e8102","hash":"ac0ac5756be4b24f2249be101665ff29ed93d1f9","modified":1579024552042},{"_id":"themes/next/source/lib/three/.git/objects/d9/90e2654ec49768cd50d630db99ee00bee2b13c","hash":"6c5cc041391cb5a6b3e0f2f15f30bd62735ac7fa","modified":1579024548870},{"_id":"themes/next/source/lib/three/.git/objects/db/fc5bb53f0ee561f55b18c9796e1e03a9781153","hash":"3cda0d28ce918db5b722db817e69ea522a4db9ce","modified":1579024552050},{"_id":"themes/next/source/lib/three/.git/objects/df/932438893faefc6b9f5ba9191913dfeedc2a1c","hash":"ac939ae39ab04abc99c0caaef00849585ff4886d","modified":1579024552046},{"_id":"themes/next/source/lib/three/.git/objects/e0/52c7542703df4969a95779bd4dc58b568bcb5e","hash":"b1ccf1650011f74939f07233834bdff21baf4952","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/e0/ced7e71c43a729f9653b1c4434b95724fc02ed","hash":"98c61b57d8e5e03cf30d402cfcb840c6e610aaa6","modified":1579024552042},{"_id":"themes/next/source/lib/three/.git/objects/e5/6e96bd99ebe3f0dc8f02c979703c3666f6dd9e","hash":"b971fcaae8424ea1b507379afdcdff74359a1525","modified":1579024552046},{"_id":"themes/next/source/lib/three/.git/objects/ea/7a1bbd08eb930b5f777ec025493ae0c8cb12d4","hash":"3c428fd65f982afbabbf683163bcc88a4eb4cda0","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/ec/00e107b97a0b7a9850219894bf4e533c68bf87","hash":"5b7f94788c3c19c8a0f73f1b712d5d79e0236668","modified":1579024548870},{"_id":"themes/next/source/lib/three/.git/objects/f4/5d8f110c3034162a1091dafe4b03d2e56b323e","hash":"963dad8248030a8d7b185f4726e40a65a0583c0e","modified":1579024548870},{"_id":"themes/next/source/lib/three/.git/objects/fa/be1d6949c228188d07df0f4b99b217c7b7f92e","hash":"de53b76740aff0953bcd79853d8addfabfc29f95","modified":1579024548698},{"_id":"themes/next/source/lib/three/.git/objects/fe/47fa8f2d9edef52a8ea859537c9286363ee168","hash":"dfaa57c592a229b220a7241bbd0567ec38f4e578","modified":1579024548758},{"_id":"themes/next/source/lib/three/.git/refs/heads/master","hash":"34eb0c5e0b55679faf9d23c848367ac5ba51e568","modified":1579024553502},{"_id":"themes/next/source/lib/fancybox/.git/objects/94/a9ed024d3859793618152ea559a168bbcbb5e2","hash":"1c2d080a86f03eb960e112a94910a5115addf57a","modified":1579035837304},{"_id":"themes/next/source/lib/fancybox/.git/objects/ac/97c2cc9f61c52753abe4174a4a74b2064e5af0","hash":"272e74036b0612de83d9d0aa9604d3edf888b249","modified":1579035837736},{"_id":"source/_posts/2019银川ACM区域赛总结/20191020_141340.jpg","hash":"f199ee7ec7b85e6b1819aacddd0369205d2d5a53","modified":1579033863873},{"_id":"themes/next/source/lib/canvas-nest/.git/logs/refs/heads/master","hash":"b47b15c5310d8ed83069a88ee4c53e703204c9aa","modified":1579024792166},{"_id":"themes/next/source/lib/canvas-nest/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1579024792166},{"_id":"themes/next/source/lib/canvas-ribbon/.git/logs/refs/heads/master","hash":"57ca7eda075f0b4cced3663aad0c590d440806ff","modified":1579024740626},{"_id":"themes/next/source/lib/canvas-ribbon/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1579024740626},{"_id":"themes/next/source/lib/fancybox/.git/logs/refs/heads/master","hash":"4aa8166c9dba109cfbdd9b0bce830bc86945a34d","modified":1579035837752},{"_id":"themes/next/source/lib/fancybox/.git/objects/aa/654e17af8c354994f706c4e33bba6b5b70caeb","hash":"22b1bdf0b0974bf5e9022953ac26066056c235ff","modified":1579035837744},{"_id":"themes/next/source/lib/fancybox/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1579035837752},{"_id":"themes/next/source/lib/pace/.git/logs/refs/heads/master","hash":"f4b39c08cc707fa42599cc41ac5e93ac24288bb0","modified":1579024455738},{"_id":"themes/next/source/lib/pace/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1579024455738},{"_id":"themes/next/source/lib/three/.git/logs/refs/heads/master","hash":"31675efaa73089a8875b2f04aa795f8aaf63c854","modified":1579024553502},{"_id":"themes/next/source/lib/three/.git/objects/76/310b5a7e93e66e7d98aaab2960d6354b2288c5","hash":"84de52193b47c83d01eb8800b063ccd83ad42cf9","modified":1579024551718},{"_id":"themes/next/source/lib/three/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1579024553502},{"_id":"source/live2d-widget/.git/objects/pack/pack-aab08850631f6fb8265de129a87403b0d89906ef.pack","hash":"39c0ccc09f27bdda9af7705d482d3e7703cc496c","modified":1579031303454},{"_id":"themes/next/source/lib/canvas-nest/.git/logs/refs/remotes/origin/HEAD","hash":"b47b15c5310d8ed83069a88ee4c53e703204c9aa","modified":1579024792166},{"_id":"themes/next/source/lib/canvas-ribbon/.git/logs/refs/remotes/origin/HEAD","hash":"57ca7eda075f0b4cced3663aad0c590d440806ff","modified":1579024740626},{"_id":"themes/next/source/lib/fancybox/.git/logs/refs/remotes/origin/HEAD","hash":"4aa8166c9dba109cfbdd9b0bce830bc86945a34d","modified":1579035837752},{"_id":"themes/next/source/lib/pace/.git/logs/refs/remotes/origin/HEAD","hash":"f4b39c08cc707fa42599cc41ac5e93ac24288bb0","modified":1579024455738},{"_id":"themes/next/source/lib/three/.git/logs/refs/remotes/origin/HEAD","hash":"31675efaa73089a8875b2f04aa795f8aaf63c854","modified":1579024553502},{"_id":"themes/next/source/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1579024553522},{"_id":"source/_posts/2019银川ACM区域赛总结/20191019_145938.jpg","hash":"e90d4e9d69731bf5f4ce1150bfc51e7b7cbd5378","modified":1579033863229},{"_id":"source/_posts/设置你喜欢的live2d看板娘/shizuku.gif","hash":"e37ed647f267a1ac75e54295bbcfb4f0ccec914f","modified":1579033851337},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/three.gif","hash":"64baf18286418db75a73841e4b4869c1c2867adc","modified":1579447428292},{"_id":"public/live2d-widget/autoload.js","hash":"9c6fdbad32ff0b05472aa185036d18c572d8590f","modified":1579638099411},{"_id":"public/live2d-widget/waifu-tips.js","hash":"30988dd6d31966d1f76e3eaef766d534e1873582","modified":1579638099411},{"_id":"public/live2d-widget/waifu-tips.json","hash":"d4296cba520bc15a17a4b02c6af5b66208b8025f","modified":1579638099411},{"_id":"public/live2d-widget/waifu.css","hash":"914b4ec2624c931b2808e0961df079122776a8be","modified":1579638099411},{"_id":"public/live2d-widget/live2d.min.js","hash":"bff303d464093633dfa70187084be68ce3d7d405","modified":1579638099411},{"_id":"public/./public/search.xml","hash":"d546f216e3fec9230a3cf423ecd7b6cfcd9e2eac","modified":1579638099411},{"_id":"public/about/index.html","hash":"179e65f050e64c47754128fbab00183da9aed9ca","modified":1579638099411},{"_id":"public/categories/index.html","hash":"3ce607be0b4211d399711efb416a6db71f1c4aa6","modified":1579638099411},{"_id":"public/live2d-widget/README.html","hash":"fb4b21c2ac775599455306694ed10d9441a011b9","modified":1579638099411},{"_id":"public/tags/index.html","hash":"6bc757a36c90489a6e5b48ba6565f35c51582883","modified":1579638099411},{"_id":"public/live2d-widget/demo/demo1.html","hash":"387c41485d15e24fcdfd323000fdd7717efee37f","modified":1579638099411},{"_id":"public/live2d-widget/demo/demo2.html","hash":"2b22674d7f63ff296b5928ba57cf429bbf1082d8","modified":1579638099411},{"_id":"public/2020/01/21/原生JavaScript实现Promise/index.html","hash":"74f949a82a8023edf9794e2f638b3fbfa0ef0f5c","modified":1579638099411},{"_id":"public/2020/01/19/来说说TCP的三次握手和四次挥手吧/index.html","hash":"76e201755d089926d2b52af7d1b3e836a3b9a093","modified":1579638099411},{"_id":"public/2020/01/14/JavaScript观察者模式与发布订阅/index.html","hash":"7b28547a3001c34a82b4b9990c94fb52d79be907","modified":1579638099411},{"_id":"public/2020/01/14/JavaScript面向对象-03-原型中的注意点/index.html","hash":"a3dd337659d0f4d9807632a3b2875a56e516c6b2","modified":1579638099411},{"_id":"public/2019/12/08/JavaScript面向对象-02-Prototype/index.html","hash":"99e39dfd72b1b4073f263b56f4a8e248d78ac6aa","modified":1579638099411},{"_id":"public/2019/12/07/JavaScript面向对象-01-Constructor/index.html","hash":"a6d6b38e57db93b6a9cb1982a54cca521fe3e3ea","modified":1579638099411},{"_id":"public/2019/12/07/JavaScript的基本组成部分/index.html","hash":"ea3404ddc9daebb873c87c1622cb980235860838","modified":1579638099411},{"_id":"public/2019/11/18/原生JavaScript实现Ajax/index.html","hash":"7226040cd9d73bb9dab25e89d922f2b5f43a4b34","modified":1579638099411},{"_id":"public/2019/10/21/2019银川ACM区域赛总结/index.html","hash":"16fbdc52cf6c51524756a1ab753dd624a2eb5c79","modified":1579638099411},{"_id":"public/2019/10/18/关于渐进增强与优雅降级/index.html","hash":"aef9043226f5264f35ec63ef5805d605acc6787b","modified":1579638099411},{"_id":"public/2019/10/15/The-K-Nearest-Neighbor-Algorithm/index.html","hash":"f2816300766479a3a254f391a3546b5f96979559","modified":1579638099411},{"_id":"public/2019/09/28/主流浏览器内核简述与Web标准/index.html","hash":"6f4452889f4c5a4d20a852e571f3cbadee542c37","modified":1579638099411},{"_id":"public/2019/09/23/在Apache上开始部署ThinkPHP5/index.html","hash":"f69d9966dc7207a6975a47e4583eb85e9fa2b3c4","modified":1579638099411},{"_id":"public/2019/09/23/Hexo-NexT魔改系列-04-进阶设置/index.html","hash":"ca3f75193c7d4dbb1eaf0372c51a896c8a694a65","modified":1579638099411},{"_id":"public/2019/09/15/Hexo-NexT魔改系列-03-添加数据统计/index.html","hash":"4df843132d1e5d6301886e8ad5243a6a1c3f765e","modified":1579638099411},{"_id":"public/2019/09/10/Hexo-NexT魔改系列-02-配置博客背景轮播图/index.html","hash":"a64f47e925385597134a35a3b4f7f3db01d2c0a3","modified":1579638099411},{"_id":"public/2019/09/08/Hexo-NexT魔改系列-01-准备工作/index.html","hash":"c34c3ce775cdf580231f1c8dbb9c5b14b2b1f0b8","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/index.html","hash":"f708e59dc8cf40aaa5978b218aa4683f3f808e84","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/index.html","hash":"354804b389adb3c5fdace45c52e0f9eabde0a716","modified":1579638099411},{"_id":"public/2019/07/31/Hexo博客的安装与基本配置/index.html","hash":"e3a34e8d7205f202427c852213a247df8859d6a3","modified":1579638099411},{"_id":"public/archives/index.html","hash":"db97424099269cad66cae5a4f8844fc1a9b19298","modified":1579638099411},{"_id":"public/archives/page/2/index.html","hash":"711cf2b20e7ae8feb748e38c5ee430a5d6aad790","modified":1579638099411},{"_id":"public/archives/2019/index.html","hash":"087a8e492687d3fb8dc46cc0197b548b3911e9dc","modified":1579638099411},{"_id":"public/archives/2019/page/2/index.html","hash":"2364a55c20fcff181d00eaa86e4b067fe4ed36e8","modified":1579638099411},{"_id":"public/archives/2019/07/index.html","hash":"52d20f6aaff4d6f1dbf72b9e508780daedf91eba","modified":1579638099411},{"_id":"public/archives/2019/08/index.html","hash":"34f29934252396e15e402a0e5f80301273dec92c","modified":1579638099411},{"_id":"public/archives/2019/09/index.html","hash":"8a4cb9e9d5ff4319cb84f20cbeab2e19dce8e31f","modified":1579638099411},{"_id":"public/archives/2019/10/index.html","hash":"383d35c0b1ba56813839c360e2e4c1ab320c6752","modified":1579638099411},{"_id":"public/archives/2019/11/index.html","hash":"80989c41d7385e5052abde677548e6d7a6fedbbd","modified":1579638099411},{"_id":"public/archives/2019/12/index.html","hash":"49de7550427b378e006b06fd0aa2535a02471728","modified":1579638099411},{"_id":"public/archives/2020/index.html","hash":"97ae7ed910e8b6d646e84e074ced5051e2f8679c","modified":1579638099411},{"_id":"public/archives/2020/01/index.html","hash":"aab1da8f57bde3388e1b4b0c27813f3aeaa1b0df","modified":1579638099411},{"_id":"public/categories/算法/index.html","hash":"f4ae10dfdf01a25cf97fbfc359e889973618d097","modified":1579638099411},{"_id":"public/categories/Hexo/index.html","hash":"2261b677b1795e2e6e12a900a5904008244d1f40","modified":1579638099411},{"_id":"public/categories/算法/ACM/index.html","hash":"c738b01aefaf5ede140df4310f763713c3e86f22","modified":1579638099411},{"_id":"public/categories/Hexo/NexT/index.html","hash":"17c73df2756987c68013f60a3965e1cea03c521e","modified":1579638099411},{"_id":"public/categories/前端/index.html","hash":"ca0a69c0b160577abff2458f32f29f54980aafcf","modified":1579638099411},{"_id":"public/categories/学校课程/index.html","hash":"d288239ad1e138b28916fa286b1301ab57fca259","modified":1579638099411},{"_id":"public/categories/软件工程/index.html","hash":"9cbbca0b0b70064907974b5771c7d858694a58a7","modified":1579638099411},{"_id":"public/categories/Hexo/NexT/魔改/index.html","hash":"a5599ffe34e5bf90a719b5980f59aa194f77ffdf","modified":1579638099411},{"_id":"public/categories/PHP/index.html","hash":"991b0e8a05f060e8aa67f430a937e0feaaed13de","modified":1579638099411},{"_id":"public/categories/面经/index.html","hash":"98c043f5ee2dcc0af916927e354ac2aee69f1496","modified":1579638099411},{"_id":"public/categories/前端/面经/index.html","hash":"d345bc1b7f8ee37d7b20d72d11a56110fa73479f","modified":1579638099411},{"_id":"public/categories/Hexo/NexT/Live2D/index.html","hash":"9c41d1691dfdb66f0fdf8275825a4646bab85f4f","modified":1579638099411},{"_id":"public/categories/PHP/ThinkPHP5/index.html","hash":"f09c54a499190a2595c02bce8a8be0f9d4fd545d","modified":1579638099411},{"_id":"public/categories/面经/计算机网络/index.html","hash":"e64da26365fc6eec35f158edc9f3de8d2fe8325f","modified":1579638099411},{"_id":"public/categories/前端/面经/JavaScript/index.html","hash":"fc3323104c33a3b1f17cf5e31cfb1ee57bd8a6d4","modified":1579638099411},{"_id":"public/categories/面经/计算机网络/TCP/index.html","hash":"27fa716c0e853d3750d3810d3a217b96d64e1985","modified":1579638099411},{"_id":"public/categories/前端/面经/JavaScript/设计模式/index.html","hash":"d95b3ee869cbea48beaf040ec07d0c7df8f90790","modified":1579638099411},{"_id":"public/index.html","hash":"f3d25edbeb5d577992ac58d5cea09585220d449d","modified":1579638099411},{"_id":"public/page/2/index.html","hash":"4277209edef35b1e52da7ecfe245e24479069cdc","modified":1579638099411},{"_id":"public/tags/ACM/index.html","hash":"63a806cd4d7d3f5c1f820d75924e81422c123f64","modified":1579638099411},{"_id":"public/tags/比赛/index.html","hash":"37ac5fe5a6509acd6e0d5d125725ff9e47131225","modified":1579638099411},{"_id":"public/tags/算法/index.html","hash":"e8b420e24a65aaf98d87c34158c0ad8b4da41c01","modified":1579638099411},{"_id":"public/tags/Hexo/index.html","hash":"16564746aa3a03c387228ba1c05c7e1b0be2c5a7","modified":1579638099411},{"_id":"public/tags/NexT/index.html","hash":"2fe598b3b12c7d892f359706575f0f56c4859a89","modified":1579638099411},{"_id":"public/tags/魔改/index.html","hash":"1ac2092bdbc88dd05e31b9e437281d6313f289fb","modified":1579638099411},{"_id":"public/tags/瞎折腾/index.html","hash":"a6b5dbb8247c583ac9357051e804768dbfcf62f6","modified":1579638099411},{"_id":"public/tags/建站/index.html","hash":"b519a790a765e388d278f85b722add53516a8085","modified":1579638099411},{"_id":"public/tags/Nginx/index.html","hash":"b3d0d701a3db72aa1341a798688f1cc58065f0e8","modified":1579638099411},{"_id":"public/tags/Web/index.html","hash":"87a340591094d5af92d199eadfc629445f94827c","modified":1579638099411},{"_id":"public/tags/JavaScript/index.html","hash":"8e3ceb92b31e9daefc3fd708522dfbb8d5641841","modified":1579638099411},{"_id":"public/tags/设计模式/index.html","hash":"2e8f6f15b4d9948a817715152fffaac231c2922e","modified":1579638099411},{"_id":"public/tags/Python/index.html","hash":"3cd754befb3f05b82d73711eb1aee89186896151","modified":1579638099411},{"_id":"public/tags/人工智能/index.html","hash":"86fdaa83f1b15217fa9116d7c686a84f187353f9","modified":1579638099411},{"_id":"public/tags/UML/index.html","hash":"35d3f6e5a538226c01eef8919084e7cf2e931e38","modified":1579638099411},{"_id":"public/tags/软件工程/index.html","hash":"8b0793e65a7a665a94b96bd68e03abe01b858fa3","modified":1579638099411},{"_id":"public/tags/HTML/index.html","hash":"9a98029252fd534a2093196fa61326d50e88b40c","modified":1579638099411},{"_id":"public/tags/浏览器/index.html","hash":"b3cb0a8ef128362b71469d0e21c5e511a1baaaec","modified":1579638099411},{"_id":"public/tags/web/index.html","hash":"21f71c8b8c1bdc7ad5a5c1a9289876c4b31da4c4","modified":1579638099411},{"_id":"public/tags/PHP/index.html","hash":"bff2a667398037f0ec3cb036c521d6979f367ee9","modified":1579638099411},{"_id":"public/tags/ThinkPHP5/index.html","hash":"4b5491ac34477cf7218694cf3887fc9cf0020990","modified":1579638099411},{"_id":"public/tags/Apache/index.html","hash":"ad72820caa86e109cdbc492859b48bc5b64ae138","modified":1579638099411},{"_id":"public/tags/计算机网络/index.html","hash":"318a24577967cc654a30fa7f045cd0731030b500","modified":1579638099411},{"_id":"public/live2d-widget/assets/browserstack.svg","hash":"1ae93ba806a84d276c788beb8cd20243af94404d","modified":1579638099411},{"_id":"public/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1579638099411},{"_id":"public/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1579638099411},{"_id":"public/images/apple-touch-icon.png","hash":"6c542c08bf7c492cdd18c458d44d7cf16f3e9549","modified":1579638099411},{"_id":"public/images/avatar.gif","hash":"18c53e15eb0c84b139995f9334ed8522b40aeaf6","modified":1579638099411},{"_id":"public/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1579638099411},{"_id":"public/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1579638099411},{"_id":"public/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1579638099411},{"_id":"public/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1579638099411},{"_id":"public/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1579638099411},{"_id":"public/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1579638099411},{"_id":"public/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1579638099411},{"_id":"public/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1579638099411},{"_id":"public/images/favicon-16x16.ico","hash":"432672e2a8a03f44382f5be84f0a2da86721ab12","modified":1579638099411},{"_id":"public/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1579638099411},{"_id":"public/images/favicon-32x32.ico","hash":"d9ccd03f5c49603efa3d30020249fe70c9c5e036","modified":1579638099411},{"_id":"public/images/logo.svg","hash":"18c02605ad7dea01839548366c91820936c6d21e","modified":1579638099411},{"_id":"public/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1579638099411},{"_id":"public/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1579638099411},{"_id":"public/uploads/alipay.png","hash":"dded1805de37e8f4d68b408c4f0254469a44abca","modified":1579638099411},{"_id":"public/uploads/avatar.jpg","hash":"7bba06ff974748af5f83339653bec127df9d9e52","modified":1579638099411},{"_id":"public/uploads/beian.png","hash":"29c400bc3b89f6085766dac4e0330ded5cb73d52","modified":1579638099411},{"_id":"public/uploads/wechat.png","hash":"f6e0bbbe63bd8fa6fed668e5addb881819525f8e","modified":1579638099411},{"_id":"public/live2d-widget/assets/screenshot-1.png","hash":"4bd4d97a1fcaa5deb3cea1c0a102a895a15af32f","modified":1579638099411},{"_id":"public/lib/canvas-nest/LICENSE","hash":"b29db4c99aa5b8d574026f68804051ff4b75466e","modified":1579638099411},{"_id":"public/lib/canvas-ribbon/LICENSE","hash":"b29db4c99aa5b8d574026f68804051ff4b75466e","modified":1579638099411},{"_id":"public/lib/fancybox/LICENSE","hash":"8624bcdae55baeef00cd11d5dfcfa60f68710a02","modified":1579638099411},{"_id":"public/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1579638099411},{"_id":"public/lib/pace/LICENSE","hash":"b29db4c99aa5b8d574026f68804051ff4b75466e","modified":1579638099411},{"_id":"public/lib/three/LICENSE","hash":"b29db4c99aa5b8d574026f68804051ff4b75466e","modified":1579638099411},{"_id":"public/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1579638099411},{"_id":"public/2019/10/18/关于渐进增强与优雅降级/main.png","hash":"d1b7b635c6a3754d17b16f43494b70e833030920","modified":1579638099411},{"_id":"public/2020/01/14/JavaScript观察者模式与发布订阅/ObserverPattern.png","hash":"309081e6b06454c5b03e4c45386c9f3b910fb842","modified":1579638099411},{"_id":"public/2020/01/14/JavaScript观察者模式与发布订阅/PubSubPattern.gif","hash":"72419ffc59c8420dd44aa42498d6fb937532b249","modified":1579638099411},{"_id":"public/2020/01/14/JavaScript观察者模式与发布订阅/vs.jpeg","hash":"3f29172aa56164d6a97fd37d7222f3adba91f951","modified":1579638099411},{"_id":"public/2019/09/15/Hexo-NexT魔改系列-03-添加数据统计/busuanzi.png","hash":"9fdc9dda0e0b249e7b2d1657c26dfdad71847a42","modified":1579638099411},{"_id":"public/2019/09/15/Hexo-NexT魔改系列-03-添加数据统计/normal_footer.png","hash":"a8ea1c81fd11b25d62957a153074026ce44f5147","modified":1579638099411},{"_id":"public/2019/09/15/Hexo-NexT魔改系列-03-添加数据统计/title.png","hash":"75b4ee76b5606972dcad14a8b29629f784a9f03c","modified":1579638099411},{"_id":"public/2019/12/07/JavaScript的基本组成部分/java-script.jpg","hash":"3c1961152e6d17d2b5eef213f2b471818616f7ae","modified":1579638099411},{"_id":"public/2019/12/07/JavaScript的基本组成部分/jszxgc.png","hash":"a5b4c6f42cb1347f0dc51e50e6e01f1917dde982","modified":1579638099411},{"_id":"public/2019/12/07/JavaScript的基本组成部分/structure.png","hash":"acfe3472facd63c00c5e348b031cfe1fbab9e226","modified":1579638099411},{"_id":"public/2019/12/08/JavaScript面向对象-02-Prototype/base__proto__.png","hash":"ac6a024e09b9f22efdc6f64df4cdd70bdc96d4fa","modified":1579638099411},{"_id":"public/2019/12/08/JavaScript面向对象-02-Prototype/object.png","hash":"dc9ef5fbc82ca153ceb21d77820269d625e70f2e","modified":1579638099411},{"_id":"public/2019/12/08/JavaScript面向对象-02-Prototype/prototype_dir.png","hash":"431890b5eb76ed34ef8438c4808fd5b58c2a3418","modified":1579638099411},{"_id":"public/2019/12/08/JavaScript面向对象-02-Prototype/yuanxinglian.png","hash":"1c2642a02f0c224ee2ffa3972f99a665671087c1","modified":1579638099411},{"_id":"public/2019/10/15/The-K-Nearest-Neighbor-Algorithm/1024px-KnnClassification.svg.png","hash":"ff4d0e4607e9920afc45b797c89b49e9bbc78b8f","modified":1579638099411},{"_id":"public/2019/10/15/The-K-Nearest-Neighbor-Algorithm/temp.png","hash":"5c984e10609b39f7ef969cc36330c3a263de84eb","modified":1579638099411},{"_id":"public/2020/01/19/来说说TCP的三次握手和四次挥手吧/TcpMessage.png","hash":"c93d289319abee0f7b36fe0dd404596869dea38e","modified":1579638099411},{"_id":"public/2020/01/19/来说说TCP的三次握手和四次挥手吧/four.png","hash":"c4010ad45e50f077d8908c1ce98cc3a72cbe895b","modified":1579638099411},{"_id":"public/2020/01/19/来说说TCP的三次握手和四次挥手吧/four01.png","hash":"e5a6c60f51e721f948e96138b08bc0da3e18abde","modified":1579638099411},{"_id":"public/2020/01/19/来说说TCP的三次握手和四次挥手吧/three.png","hash":"79d6a6614480ca11fe668e62e44b8fb8dab6cf46","modified":1579638099411},{"_id":"public/2020/01/19/来说说TCP的三次握手和四次挥手吧/three01.png","hash":"13010d3905a97eda9796e147db6f7d07b76ec6ca","modified":1579638099411},{"_id":"public/2019/07/31/Hexo博客的安装与基本配置/fork-on-github.png","hash":"65a8a2a3fb76cfb8a58930125f00cb8cd2e39239","modified":1579638099411},{"_id":"public/2019/07/31/Hexo博客的安装与基本配置/hide-hexo.png","hash":"743e24b05c92fc827873c03e1e2cc61e5c129a78","modified":1579638099411},{"_id":"public/2019/07/31/Hexo博客的安装与基本配置/my-copyright.png","hash":"3ea9ce2e84ddf327c0f7e0a95dd463f967c13af1","modified":1579638099411},{"_id":"public/2019/07/31/Hexo博客的安装与基本配置/show-copyright.png","hash":"e481fe7c1cffba8bd1bfb7291cd92484ebbdebeb","modified":1579638099411},{"_id":"public/2019/07/31/Hexo博客的安装与基本配置/social-links.png","hash":"d116572cff52119e9e6be54058bfa33563b495f2","modified":1579638099411},{"_id":"public/2019/07/31/Hexo博客的安装与基本配置/thanks.png","hash":"59178ea1f2a63013b686260d362021a788ef9915","modified":1579638099411},{"_id":"public/2019/07/31/Hexo博客的安装与基本配置/tomorrow-night-blue.png","hash":"5fab562bc2ca35999e40635567ad3338fb5e1e45","modified":1579638099411},{"_id":"public/2019/07/31/Hexo博客的安装与基本配置/tomorrow-night-bright.png","hash":"a5c299247d5658342ef806f51c31411bc075f60e","modified":1579638099411},{"_id":"public/2019/07/31/Hexo博客的安装与基本配置/tomorrow-night-eighties.png","hash":"3cc0a47b6fda06ce436c23c548405ba3962c3980","modified":1579638099411},{"_id":"public/2019/07/31/Hexo博客的安装与基本配置/tomorrow-night.png","hash":"dd9d84a51f3c52bb8a4b6a3206062cf7b6d02505","modified":1579638099411},{"_id":"public/2019/07/31/Hexo博客的安装与基本配置/tomorrow.png","hash":"6c3c72246915ff54c65410128a3197a7dc49fa3c","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/UML_shixu.jpg","hash":"0517e5624ff77e34553d179498d3710402c42d08","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/UML_yongli.png","hash":"cb3677341d1d23e9a08619969b627bb4a250a328","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/aggregation.png","hash":"5af483e7c15b977c37e2682f36e963976a1712f0","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/association.png","hash":"67c3e7aae641a7316406c19b4dfc86e90834eb02","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/composition.png","hash":"3b872ecb6d7d77834aa4073871e8875b01888e55","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/dependency.png","hash":"ab58dff83917fb59703c564bda72e2e3bb9452f4","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/generalization.png","hash":"0d1d459c77659042d4d0330dc049fd7d26feb185","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/group.png","hash":"c67b06332ec25cf475ed8d3a4487f3dd1bff98f6","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/implements.png","hash":"faeb17c8889bb30c42f02f5fc19e35f671e53c93","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/shengmingxian.png","hash":"184955d306dee751c3ce2754781ef56b4a6ab15a","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/tongbuxiaoxi.png","hash":"cf54ccd681c8055f2e873d804203ee8e31791f34","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/yibuxiaoxi.png","hash":"b489ce395a8016b0fc3bad4f56b1e2b024052fc7","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/yueshu.png","hash":"9f80f50b0d06dc1dee89eb06a710989f399b0f3a","modified":1579638099411},{"_id":"public/2019/08/28/UML图例详解/zhushi.png","hash":"fab1dcc72cd2f316c79faa5bad88e63e3fd6f188","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/Unitychan.png","hash":"26045ee389f7492a8f0057612d9352bdbb5a824e","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/chitose.jpg","hash":"336aca2ef46e1e505cff69a9eb2dc9f7341b9a0e","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/haruto.png","hash":"60b8ab92f8c78a3d9a59c3e9c0ccb628c1b2711a","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/hibiki.png","hash":"2aa5c5e4c9b22644f401a39659fa19e80fc986e2","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/hijiki.png","hash":"7a152c3cba0edc2e94cc08d6d0aee2a348e3b492","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/izumi.jpg","hash":"1bb6c1bb9b0998402330d0fd19088b650b3e28ec","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/koharu.png","hash":"3f9b694f3768cd9c70b198d5ae9fb363bb2dacd6","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/models.jpg","hash":"842325c0b5073c47421dd33b727773ffe5e2550a","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/ni-j.png","hash":"af4b1d7a894d443e62c43bbebf19fafeee03677d","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/nietzche.png","hash":"5185dae9d40a45ebe0d76b8aaeda7447b273934b","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/nito.png","hash":"944197890af298c8ed8afaa27d5c5503616bba8b","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/tororo.png","hash":"f4e49f831fce135f5dbefc785353265b2e752b0e","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/tsumiki.png","hash":"ea90ba5810d09f5f23113d9a594790f9544e11f8","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/wanko.png","hash":"6bb16c34041eb1616cd172127c0ebf82d7f5350f","modified":1579638099411},{"_id":"public/live2d-widget/LICENSE","hash":"31a3d460bb3c7d98845187c716a30db81c44b615","modified":1579638099411},{"_id":"public/live2d-widget/assets/screenshot-2.png","hash":"e766842b0f064efc148613c41f43a8a905c39557","modified":1579638099411},{"_id":"public/live2d-widget/assets/screenshot-3.png","hash":"ead66aa3edb390205081a0c8625a49844470a090","modified":1579638099411},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1579638099411},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1579638099411},{"_id":"public/2019/09/10/Hexo-NexT魔改系列-02-配置博客背景轮播图/F12.jpg","hash":"c0e4056c2dba35e2a24a050aaad0af5c7a85d786","modified":1579638099411},{"_id":"public/2019/09/23/Hexo-NexT魔改系列-04-进阶设置/footer.png","hash":"a8ea1c81fd11b25d62957a153074026ce44f5147","modified":1579638099411},{"_id":"public/2019/12/07/JavaScript的基本组成部分/DOM_tree.png","hash":"7b64c07e0b24163a527ee4f07f4bc6315d5a0895","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/Epsilon2.1.png","hash":"6495c18cdb9d9787fe6b56a99af62b786066ca7a","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/Gantzert_Felixander.png","hash":"92d8861b20e1affdedea9b7f2b8756eba1d1eec7","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/haru.png","hash":"2b02a9e8dcacb4a3b6f5e0c595ee00075cc4926c","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/miku.png","hash":"b4a0209d8b40814542f3475b5393afec3dbc38dc","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/nico.png","hash":"1e15f3bedae7c88de4658c477fc27e770c8603e9","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/nipsilon.png","hash":"42b65728bbfcf0d7ec59ecff7bbf9a6440790531","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/shizuku.png","hash":"c301440ca6fa14f0ad4905e3b7e5d84d05c2af5f","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/z16.png","hash":"b2d22eca691f90e7c9914ee7eabc9292f98b8c2d","modified":1579638099411},{"_id":"public/js/algolia-search.js","hash":"813afcc30feee11d59f297f2d5a96f98fbbd4743","modified":1579638099411},{"_id":"public/js/bookmark.js","hash":"a00945ff886e9f6f835731cdaf29a3a3727c8877","modified":1579638099411},{"_id":"public/js/local-search.js","hash":"9f3d3ddff86e7b2828772aba915a5ebfd7d9f55f","modified":1579638099411},{"_id":"public/js/motion.js","hash":"36262c60c63ed196764284247ba864343b2693fb","modified":1579638099411},{"_id":"public/js/next-boot.js","hash":"f7045763e277e685c271bd4b4c37e531d699ac63","modified":1579638099411},{"_id":"public/js/utils.js","hash":"6ef79d54e71d7ddbb2e7ffa5aa9bbd28c543c835","modified":1579638099411},{"_id":"public/js/src/jquery.backstretch.min.js","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1579638099411},{"_id":"public/js/schemes/muse.js","hash":"792f4522a3b0b96584a041a4aca20fcded410079","modified":1579638099411},{"_id":"public/js/schemes/pisces.js","hash":"52d139e6f3bc212c8c9b71bc9e57e931920434a6","modified":1579638099411},{"_id":"public/js/src/busuanzi.pure.mini.js","hash":"6e41f31100ae7eb3a6f23f2c168f6dd56e7f7a9a","modified":1579638099411},{"_id":"public/js/src/custom.js","hash":"57e168cb6ba31ee8463476a9675cb27a0d2a6499","modified":1579638099411},{"_id":"public/lib/canvas-nest/canvas-nest-nomobile.min.js","hash":"956eada198babd00f028e8908767cb158926c3f3","modified":1579638099411},{"_id":"public/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1579638099411},{"_id":"public/lib/canvas-ribbon/canvas-ribbon.js","hash":"65b1a8f12d04b15d7ed6eeb9d11dec760a799c5f","modified":1579638099411},{"_id":"public/lib/font-awesome/bower.json","hash":"64394a2a9aa00f8e321d8daa5e51a420f0e96dad","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-flat-top.min.css","hash":"5e1c97e232b46e48592a8e4983ae5a89e0a7da6a","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1579638099411},{"_id":"public/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1579638099411},{"_id":"public/lib/three/gulpfile.js","hash":"e0e9e7051d9d82a37c2aba1df396d8b3916323c4","modified":1579638099411},{"_id":"public/lib/three/package.json","hash":"b26242f5b3aa082ae137c437e2e9ee2a7094028b","modified":1579638099411},{"_id":"public/lib/three/renovate.json","hash":"94990e0ad04ce4a7c6f0ac3543318d9e02db1264","modified":1579638099411},{"_id":"public/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1579638099411},{"_id":"public/lib/fancybox/source/jquery.fancybox.min.css","hash":"1be9b79be02a1cfc5d96c4a5e0feb8f472babd95","modified":1579638099411},{"_id":"public/lib/three/src/canvas_lines.js","hash":"650310ff6783671f8ceccf01f840b20d9c87b491","modified":1579638099411},{"_id":"public/lib/three/src/canvas_sphere.js","hash":"7614790c67d3e79e3390fe688f6b01afad7e3bb1","modified":1579638099411},{"_id":"public/lib/three/src/three-waves.js","hash":"e98e442f14920e9fb8691846dca3a2225d403048","modified":1579638099411},{"_id":"public/lib/canvas-nest/README.html","hash":"87b739ed83cf64c8802657b00ae6e64a9a4728e5","modified":1579638099411},{"_id":"public/lib/canvas-ribbon/README.html","hash":"9557a60df72e2e8875d7ddcdcdd1498ae0e5f4ad","modified":1579638099411},{"_id":"public/lib/fancybox/README.html","hash":"ef332d1b78e923c8ba02c84f37e966c0fd8bb6c5","modified":1579638099411},{"_id":"public/lib/pace/README.html","hash":"e1909ab93f97012da3506bd7aaf184e390ffff16","modified":1579638099411},{"_id":"public/lib/three/README.html","hash":"e3bdcbca539556c09f3bcfa9e77589a0a519af82","modified":1579638099411},{"_id":"public/css/main.css","hash":"e51feafdf2863431160533faa1e223eef52f87d1","modified":1579638099411},{"_id":"public/lib/anime.min.js","hash":"47cb482a8a488620a793d50ba8f6752324b46af3","modified":1579638099411},{"_id":"public/lib/pace/pace-theme-material.min.css","hash":"f1ff83985c090f3a3236554c5ef69542dcceb049","modified":1579638099411},{"_id":"public/lib/three/canvas_lines.min.js","hash":"ae6584edc0418d68731cab82c1494f26bd77c07d","modified":1579638099411},{"_id":"public/lib/three/canvas_sphere.min.js","hash":"186c3bd6ae352d336cdbd0e555ee76a844854c94","modified":1579638099411},{"_id":"public/lib/three/three-waves.min.js","hash":"329483be97cdda030779da9a6cd1e3eae645cf4f","modified":1579638099411},{"_id":"public/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1579638099411},{"_id":"public/js/src/jquery.min.js","hash":"2115753ca5fb7032aec498db7bb5dca624dbe6be","modified":1579638099411},{"_id":"public/lib/fancybox/source/jquery.fancybox.css","hash":"e43435fb9eaa918f5b8e35c9e110124b8bd13751","modified":1579638099411},{"_id":"public/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1579638099411},{"_id":"public/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1579638099411},{"_id":"public/lib/three/lib/CanvasRenderer.js","hash":"cf8e1ce6e884023ad0d692cf30f399862407fb40","modified":1579638099411},{"_id":"public/lib/three/lib/Projector.js","hash":"1ad16e96cea2a8a9155bb429c83ef9bdd341ce99","modified":1579638099411},{"_id":"public/lib/fancybox/source/jquery.fancybox.min.js","hash":"6181412e73966696d08e1e5b1243a572d0f22ba6","modified":1579638099411},{"_id":"public/lib/three/package-lock.json","hash":"18a22a7eadc46729ed033b9318a9dc9b8aed5ba0","modified":1579638099411},{"_id":"public/lib/fancybox/source/jquery.fancybox.pack.js","hash":"27f034e5db8c32e268e2959b9a7c1258d36e4510","modified":1579638099411},{"_id":"public/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1579638099411},{"_id":"public/images/background/bg1.jpg","hash":"97ac1961bb24a7bfefe74f9312f22c448646de8c","modified":1579638099411},{"_id":"public/images/background/bg2.jpg","hash":"e3d963c95b3ae13b933a41956611d4d4d894678e","modified":1579638099411},{"_id":"public/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1579638099411},{"_id":"public/2019/09/15/Hexo-NexT魔改系列-03-添加数据统计/mini_footer.png","hash":"2edc09e79ca7ff90620538cb6bfa01841b23ca86","modified":1579638099411},{"_id":"public/2019/11/18/原生JavaScript实现Ajax/image.jpg","hash":"0c51eeabe48b4fe0eb41315e3c2bfa71119d3aa0","modified":1579638099411},{"_id":"public/2019/10/21/2019银川ACM区域赛总结/20191020_141204.jpg","hash":"141c1b68f22ad6a2cadccf6bcf1e3d30e017eab3","modified":1579638099411},{"_id":"public/images/background/bg3.jpg","hash":"cd7f1bd3ffdb14f4c147a362cfa5e8bbd357b3e0","modified":1579638099411},{"_id":"public/2020/01/19/来说说TCP的三次握手和四次挥手吧/four.gif","hash":"d6cba39439f0fff63cb4b6ec38f7525d1a779725","modified":1579638099411},{"_id":"public/2019/10/21/2019银川ACM区域赛总结/acm.jpg","hash":"9e3133a902067785682c428ee173d232489a8755","modified":1579638099411},{"_id":"public/2019/10/21/2019银川ACM区域赛总结/20191020_141340.jpg","hash":"f199ee7ec7b85e6b1819aacddd0369205d2d5a53","modified":1579638099411},{"_id":"public/2019/10/15/The-K-Nearest-Neighbor-Algorithm/run01.png","hash":"5f494504c3c643f19a69445b049cf203fd21e5a3","modified":1579638099411},{"_id":"public/2019/10/15/The-K-Nearest-Neighbor-Algorithm/run02.png","hash":"f5b122ced8f0c921f08480ea79214db05ff0c581","modified":1579638099411},{"_id":"public/2019/10/15/The-K-Nearest-Neighbor-Algorithm/run04.png","hash":"5dcd9f8b6e6e341f587b99660a44e09ae5f4c3b4","modified":1579638099411},{"_id":"public/2020/01/19/来说说TCP的三次握手和四次挥手吧/total.png","hash":"28ae4edd8579ed66ff0417ddd886c8d57708788d","modified":1579638099411},{"_id":"public/2019/10/21/2019银川ACM区域赛总结/20191022161721.jpg","hash":"fab6a900d56854b11dfab00ba84afba286de2036","modified":1579638099411},{"_id":"public/2019/10/15/The-K-Nearest-Neighbor-Algorithm/run03.png","hash":"52b02beb18748a30794b7e37abfe6d2436c5e6aa","modified":1579638099411},{"_id":"public/2019/10/21/2019银川ACM区域赛总结/20191019_145938.jpg","hash":"e90d4e9d69731bf5f4ce1150bfc51e7b7cbd5378","modified":1579638099411},{"_id":"public/2019/09/04/设置你喜欢的live2d看板娘/shizuku.gif","hash":"e37ed647f267a1ac75e54295bbcfb4f0ccec914f","modified":1579638099411},{"_id":"public/2020/01/19/来说说TCP的三次握手和四次挥手吧/three.gif","hash":"64baf18286418db75a73841e4b4869c1c2867adc","modified":1579638099411}],"Category":[{"name":"算法","_id":"ck5obqn5300042lwjga112xcn"},{"name":"Hexo","_id":"ck5obqn5f000b2lwj94ot25rn"},{"name":"ACM","parent":"ck5obqn5300042lwjga112xcn","_id":"ck5obqn60000t2lwj6j716v61"},{"name":"NexT","parent":"ck5obqn5f000b2lwj94ot25rn","_id":"ck5obqn6600132lwjamnq7dcq"},{"name":"前端","_id":"ck5obqn6g00192lwjctnw5q98"},{"name":"学校课程","_id":"ck5obqn6z001y2lwj2j4s4lau"},{"name":"软件工程","_id":"ck5obqn7000202lwjbka7ht5q"},{"name":"魔改","parent":"ck5obqn6600132lwjamnq7dcq","_id":"ck5obqn78002m2lwjembq0i0h"},{"name":"PHP","_id":"ck5obqn79002o2lwj1n38ff4q"},{"name":"面经","_id":"ck5obqn7a002r2lwje8c59sn3"},{"name":"面经","parent":"ck5obqn6g00192lwjctnw5q98","_id":"ck5obqn7c002x2lwj7ynm3y2b"},{"name":"Live2D","parent":"ck5obqn6600132lwjamnq7dcq","_id":"ck5obqn7d00312lwjfmwk45xh"},{"name":"ThinkPHP5","parent":"ck5obqn79002o2lwj1n38ff4q","_id":"ck5obqn7x004g2lwj2r471jyf"},{"name":"计算机网络","parent":"ck5obqn7a002r2lwje8c59sn3","_id":"ck5obqn7z004m2lwjh7da57s9"},{"name":"JavaScript","parent":"ck5obqn7c002x2lwj7ynm3y2b","_id":"ck5obqn80004p2lwj772pdm51"},{"name":"TCP","parent":"ck5obqn7z004m2lwjh7da57s9","_id":"ck5obqn8a005g2lwjf4b6a6lc"},{"name":"设计模式","parent":"ck5obqn80004p2lwj772pdm51","_id":"ck5obqn8c005m2lwj4ata7tt0"}],"Data":[],"Page":[{"title":"about","date":"2020-01-14T17:34:23.000Z","type":"about","_content":"\n懒得写了暂时 🕊 一会儿\n","source":"about/index.md","raw":"---\ntitle: about\ndate: 2020-01-15 01:34:23\ntype: \"about\"\n---\n\n懒得写了暂时 🕊 一会儿\n","updated":"2020-01-14T21:09:10.460Z","path":"about/index.html","comments":1,"layout":"page","_id":"ck5obqn4y00012lwj4znc2zec","content":"<p>懒得写了暂时 🕊 一会儿</p>\n","site":{"data":{}},"length":11,"excerpt":"","more":"<p>懒得写了暂时 🕊 一会儿</p>\n"},{"title":"categories","date":"2020-01-14T17:33:56.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ndate: 2020-01-15 01:33:56\ntype: \"categories\"\n---\n","updated":"2020-01-14T17:34:15.122Z","path":"categories/index.html","comments":1,"layout":"page","_id":"ck5obqn5100032lwja70e6aqf","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"_content":"# Live2D Widget\n\n![](https://forthebadge.com/images/badges/built-with-love.svg)\n![](https://forthebadge.com/images/badges/uses-html.svg)\n![](https://forthebadge.com/images/badges/made-with-javascript.svg)\n![](https://forthebadge.com/images/badges/contains-cat-gifs.svg)\n![](https://forthebadge.com/images/badges/powered-by-electricity.svg)\n![](https://forthebadge.com/images/badges/makes-people-smile.svg)\n\n## 特性 Feature\n\n在网页中添加 Live2D 看板娘。兼容 PJAX，支持无刷新加载。  \nAdd Live2D widget to web page. Compatible with PJAX.\n\n**警告：本项目不支持 IE 11 等老旧浏览器。**  \n**WARNING: This project does not support legacy browsers such as IE 11.**\n\n## 示例 Demo\n\n在[米米的博客](https://zhangshuqiao.org)的左下角可查看效果。\n\n![](assets/screenshot-1.png)\n![](assets/screenshot-2.png)\n![](assets/screenshot-3.png)\n\n这个仓库中也提供了两个 Demo，即\n\n- [demo1.html](https://mi.js.org/live2d-widget/demo/demo1.html) ，展现基础效果\n- [demo2.html](https://mi.js.org/live2d-widget/demo/demo2.html) ，仿NPM的登陆界面\n\n## 依赖 Dependencies\n\n本插件需要 Font Awesome 4.7.0 支持，请确保相关样式表已在页面中加载，例如在 `<head>` 中加入：  \nFont Awesome 4.7.0 is required for this plugin. You can add this to `<head>`:\n```xml\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\">\n```\n否则无法正常显示。（如果网页中已经加载了 Font Awesome，就不要重复加载了）\n\n## 使用 Usage\n\n可以直接这样使用：\n```xml\n<script src=\"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/autoload.js\"></script>\n```\n将这一行代码加入 `<head>` 或 `<body>`，即可看到效果。如果网站启用了 PJAX，由于看板娘不必每页刷新，因此需要注意将相关脚本放到 PJAX 刷新区域之外。\n\n换句话说，如果你是小白，或者只需要最基础的功能，就只需要把这一行代码，连同前面加载 Font Awesome 的一行代码，一起放到 html 的 `<head>` 中即可。  \n如果页面是用各种模版引擎（例如 Nunjucks，Jinja 或者 PHP）生成的，也要自行修改，方法类似，只是可能略为麻烦。以 Hexo 为例，需要在主题相关的 ejs 或 njk 模版中正确配置路径，才可以加载。\n\n**但是！我们强烈推荐自己进行配置，否则很多功能是不完整的，并且可能产生问题！**  \n如果你有兴趣自己折腾的话，请看下面的详细说明。\n\n### Using CDN\n\n要自定义有关内容，可以把这个仓库 Fork 一份，然后进行修改。这时，使用方法对应地变为\n```xml\n<script src=\"https://cdn.jsdelivr.net/gh/username/live2d-widget/autoload.js\"></script>\n```\n将 `username` 替换为你的 GitHub 用户名即可。\n\n### Self-host\n\n你也可以直接把这些文件放到服务器上，而不是通过 CDN 加载。\n\n- 如果你可以通过 `ssh` 访问你的主机，请把整个项目克隆到服务器上。执行：\n  ```bash\n  cd /path/to/your/webroot\n  # Clone this repository\n  git clone https://github.com/stevenjoezhang/live2d-widget.git\n  ```\n- 如果你的主机无法用 `ssh` 连接（例如一般的虚拟主机），请选择 `Download ZIP`，然后通过 `ftp` 等方式上传到主机上，再解压到网站的目录下。\n- 如果你是通过 Hexo 等工具部署的静态博客，请在本地开命令行进入博客目录，例如 `source` 下与 `_posts` 同级的目录，然后再执行前述的 `git clone` 命令。重新部署博客时，相关文件就会自动上传到对应的路径下。\n\n这样，整个项目就可以通过你的服务器 IP 或者域名从公网访问了。你可以试试能否正常地通过浏览器打开 `autoload.js` 和 `live2d.min.js` 等文件，并确认这些文件的内容是正确的，没有出现乱码。  \n一切正常的话，接下来修改一些配置就行了。（需要通过服务器上的文本编辑器修改；你也可以先在本地完成这一步骤，再上传到服务器上）  \n修改 `autoload.js` 中的常量 `live2d_path` 为 `live2d-widget` 这一文件夹在公网上的路径。比如说，如果你可以通过\n```\nhttps://www.example.com/path/to/live2d-widget/live2d.min.js\n```\n访问到 `live2d.min.js`，那么就把 `live2d_path` 的值修改为\n```\nhttps://www.example.com/path/to/live2d-widget/\n```\n路径末尾的 `/` 一定要加上。具体可以参考 `autoload.js` 内的注释。  \n完成后，在你要添加看板娘的界面加入\n```xml\n<script src=\"https://www.example.com/path/to/live2d-widget/autoload.js\"></script>\n```\n就可以加载了。\n\n## 目录结构 Files\n\n- `waifu-tips.json` 中包含了触发条件（`selector`，选择器）和触发时显示的文字（`text`）；\n- `waifu.css` 是看板娘的样式表。\n\n源文件是对 Hexo 的 NexT 主题有效的，为了适用于你自己的网页，可能需要自行修改，或增加新内容。  \n**警告：作者不对包括但不限于 `waifu-tips.json` 和 `waifu-tips.js` 文件中的内容负责，请自行确保它们是合适的。**\n\n如果有任何疑问，欢迎提 Issue。如果有任何修改建议，欢迎提 Pull Request。\n\n## 鸣谢 Credits\n\n[![](assets/browserstack.svg)](https://www.browserstack.com)\n\n感谢 BrowserStack 容许我们在真实的浏览器中测试此项目。  \nThanks to BrowserStack for allowing us to test this project in real browsers.\n\n代码自这篇博文魔改而来：  \nhttps://www.fghrsh.net/post/123.html\n\n点击看板娘的纸飞机按钮时，会出现一个彩蛋，这来自于 [WebsiteAsteroids](http://www.websiteasteroids.com)。\n\n## 更多 More\n\n更多内容可以参考：  \nhttps://imjad.cn/archives/lab/add-dynamic-poster-girl-with-live2d-to-your-blog-02  \nhttps://github.com/xiazeyu/live2d-widget.js  \nhttps://github.com/summerscar/live2dDemo\n\n还可以自行搭建后端 API，并增加模型（需要修改的内容比较多，此处不再赘述）：  \nhttps://github.com/fghrsh/live2d_api  \nhttps://github.com/xiazeyu/live2d-widget-models  \nhttps://github.com/xiaoski/live2d_models_collection\n\n除此之外，还有桌面版本：  \nhttps://github.com/amorist/platelet  \nhttps://github.com/akiroz/Live2D-Widget\n\n## 许可证 License\n\nReleased under the GNU General Public License v3  \nhttp://www.gnu.org/licenses/gpl-3.0.html\n\n本仓库中涉及的所有 Live2D 模型、图片、动作数据等版权均属于其原作者，仅供研究学习，不得用于商业用途。\n\nLive2D 官方网站：  \nhttps://www.live2d.com/en/  \nhttps://live2d.github.io\n\nLive2D Cubism Core は Live2D Proprietary Software License で提供しています。  \nhttps://www.live2d.com/eula/live2d-proprietary-software-license-agreement_en.html  \nLive2D Cubism Components は Live2D Open Software License で提供しています。  \nhttp://www.live2d.com/eula/live2d-open-software-license-agreement_en.html\n\n> The terms and conditions do prohibit modification, but obfuscating in `live2d.min.js` would not be considered illegal modification.\n\nhttps://community.live2d.com/discussion/140/webgl-developer-licence-and-javascript-question\n\n## 更新 Update\n\n2018年10月31日，由 fghrsh 提供的原 API 停用，请更新至新地址。参考文章：  \nhttps://www.fghrsh.net/post/170.html\n\n2020年1月1日起，本项目不再依赖于 jQuery。\n","source":"live2d-widget/README.md","raw":"# Live2D Widget\n\n![](https://forthebadge.com/images/badges/built-with-love.svg)\n![](https://forthebadge.com/images/badges/uses-html.svg)\n![](https://forthebadge.com/images/badges/made-with-javascript.svg)\n![](https://forthebadge.com/images/badges/contains-cat-gifs.svg)\n![](https://forthebadge.com/images/badges/powered-by-electricity.svg)\n![](https://forthebadge.com/images/badges/makes-people-smile.svg)\n\n## 特性 Feature\n\n在网页中添加 Live2D 看板娘。兼容 PJAX，支持无刷新加载。  \nAdd Live2D widget to web page. Compatible with PJAX.\n\n**警告：本项目不支持 IE 11 等老旧浏览器。**  \n**WARNING: This project does not support legacy browsers such as IE 11.**\n\n## 示例 Demo\n\n在[米米的博客](https://zhangshuqiao.org)的左下角可查看效果。\n\n![](assets/screenshot-1.png)\n![](assets/screenshot-2.png)\n![](assets/screenshot-3.png)\n\n这个仓库中也提供了两个 Demo，即\n\n- [demo1.html](https://mi.js.org/live2d-widget/demo/demo1.html) ，展现基础效果\n- [demo2.html](https://mi.js.org/live2d-widget/demo/demo2.html) ，仿NPM的登陆界面\n\n## 依赖 Dependencies\n\n本插件需要 Font Awesome 4.7.0 支持，请确保相关样式表已在页面中加载，例如在 `<head>` 中加入：  \nFont Awesome 4.7.0 is required for this plugin. You can add this to `<head>`:\n```xml\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\">\n```\n否则无法正常显示。（如果网页中已经加载了 Font Awesome，就不要重复加载了）\n\n## 使用 Usage\n\n可以直接这样使用：\n```xml\n<script src=\"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/autoload.js\"></script>\n```\n将这一行代码加入 `<head>` 或 `<body>`，即可看到效果。如果网站启用了 PJAX，由于看板娘不必每页刷新，因此需要注意将相关脚本放到 PJAX 刷新区域之外。\n\n换句话说，如果你是小白，或者只需要最基础的功能，就只需要把这一行代码，连同前面加载 Font Awesome 的一行代码，一起放到 html 的 `<head>` 中即可。  \n如果页面是用各种模版引擎（例如 Nunjucks，Jinja 或者 PHP）生成的，也要自行修改，方法类似，只是可能略为麻烦。以 Hexo 为例，需要在主题相关的 ejs 或 njk 模版中正确配置路径，才可以加载。\n\n**但是！我们强烈推荐自己进行配置，否则很多功能是不完整的，并且可能产生问题！**  \n如果你有兴趣自己折腾的话，请看下面的详细说明。\n\n### Using CDN\n\n要自定义有关内容，可以把这个仓库 Fork 一份，然后进行修改。这时，使用方法对应地变为\n```xml\n<script src=\"https://cdn.jsdelivr.net/gh/username/live2d-widget/autoload.js\"></script>\n```\n将 `username` 替换为你的 GitHub 用户名即可。\n\n### Self-host\n\n你也可以直接把这些文件放到服务器上，而不是通过 CDN 加载。\n\n- 如果你可以通过 `ssh` 访问你的主机，请把整个项目克隆到服务器上。执行：\n  ```bash\n  cd /path/to/your/webroot\n  # Clone this repository\n  git clone https://github.com/stevenjoezhang/live2d-widget.git\n  ```\n- 如果你的主机无法用 `ssh` 连接（例如一般的虚拟主机），请选择 `Download ZIP`，然后通过 `ftp` 等方式上传到主机上，再解压到网站的目录下。\n- 如果你是通过 Hexo 等工具部署的静态博客，请在本地开命令行进入博客目录，例如 `source` 下与 `_posts` 同级的目录，然后再执行前述的 `git clone` 命令。重新部署博客时，相关文件就会自动上传到对应的路径下。\n\n这样，整个项目就可以通过你的服务器 IP 或者域名从公网访问了。你可以试试能否正常地通过浏览器打开 `autoload.js` 和 `live2d.min.js` 等文件，并确认这些文件的内容是正确的，没有出现乱码。  \n一切正常的话，接下来修改一些配置就行了。（需要通过服务器上的文本编辑器修改；你也可以先在本地完成这一步骤，再上传到服务器上）  \n修改 `autoload.js` 中的常量 `live2d_path` 为 `live2d-widget` 这一文件夹在公网上的路径。比如说，如果你可以通过\n```\nhttps://www.example.com/path/to/live2d-widget/live2d.min.js\n```\n访问到 `live2d.min.js`，那么就把 `live2d_path` 的值修改为\n```\nhttps://www.example.com/path/to/live2d-widget/\n```\n路径末尾的 `/` 一定要加上。具体可以参考 `autoload.js` 内的注释。  \n完成后，在你要添加看板娘的界面加入\n```xml\n<script src=\"https://www.example.com/path/to/live2d-widget/autoload.js\"></script>\n```\n就可以加载了。\n\n## 目录结构 Files\n\n- `waifu-tips.json` 中包含了触发条件（`selector`，选择器）和触发时显示的文字（`text`）；\n- `waifu.css` 是看板娘的样式表。\n\n源文件是对 Hexo 的 NexT 主题有效的，为了适用于你自己的网页，可能需要自行修改，或增加新内容。  \n**警告：作者不对包括但不限于 `waifu-tips.json` 和 `waifu-tips.js` 文件中的内容负责，请自行确保它们是合适的。**\n\n如果有任何疑问，欢迎提 Issue。如果有任何修改建议，欢迎提 Pull Request。\n\n## 鸣谢 Credits\n\n[![](assets/browserstack.svg)](https://www.browserstack.com)\n\n感谢 BrowserStack 容许我们在真实的浏览器中测试此项目。  \nThanks to BrowserStack for allowing us to test this project in real browsers.\n\n代码自这篇博文魔改而来：  \nhttps://www.fghrsh.net/post/123.html\n\n点击看板娘的纸飞机按钮时，会出现一个彩蛋，这来自于 [WebsiteAsteroids](http://www.websiteasteroids.com)。\n\n## 更多 More\n\n更多内容可以参考：  \nhttps://imjad.cn/archives/lab/add-dynamic-poster-girl-with-live2d-to-your-blog-02  \nhttps://github.com/xiazeyu/live2d-widget.js  \nhttps://github.com/summerscar/live2dDemo\n\n还可以自行搭建后端 API，并增加模型（需要修改的内容比较多，此处不再赘述）：  \nhttps://github.com/fghrsh/live2d_api  \nhttps://github.com/xiazeyu/live2d-widget-models  \nhttps://github.com/xiaoski/live2d_models_collection\n\n除此之外，还有桌面版本：  \nhttps://github.com/amorist/platelet  \nhttps://github.com/akiroz/Live2D-Widget\n\n## 许可证 License\n\nReleased under the GNU General Public License v3  \nhttp://www.gnu.org/licenses/gpl-3.0.html\n\n本仓库中涉及的所有 Live2D 模型、图片、动作数据等版权均属于其原作者，仅供研究学习，不得用于商业用途。\n\nLive2D 官方网站：  \nhttps://www.live2d.com/en/  \nhttps://live2d.github.io\n\nLive2D Cubism Core は Live2D Proprietary Software License で提供しています。  \nhttps://www.live2d.com/eula/live2d-proprietary-software-license-agreement_en.html  \nLive2D Cubism Components は Live2D Open Software License で提供しています。  \nhttp://www.live2d.com/eula/live2d-open-software-license-agreement_en.html\n\n> The terms and conditions do prohibit modification, but obfuscating in `live2d.min.js` would not be considered illegal modification.\n\nhttps://community.live2d.com/discussion/140/webgl-developer-licence-and-javascript-question\n\n## 更新 Update\n\n2018年10月31日，由 fghrsh 提供的原 API 停用，请更新至新地址。参考文章：  \nhttps://www.fghrsh.net/post/170.html\n\n2020年1月1日起，本项目不再依赖于 jQuery。\n","date":"2020-01-14T19:48:23.486Z","updated":"2020-01-14T19:48:23.486Z","path":"live2d-widget/README.html","title":"","comments":1,"layout":"page","_id":"ck5obqn5800072lwj09gc052q","content":"<h1 id=\"Live2D-Widget\"><a href=\"#Live2D-Widget\" class=\"headerlink\" title=\"Live2D Widget\"></a>Live2D Widget</h1><p><img src=\"https://forthebadge.com/images/badges/built-with-love.svg\" alt><br><img src=\"https://forthebadge.com/images/badges/uses-html.svg\" alt><br><img src=\"https://forthebadge.com/images/badges/made-with-javascript.svg\" alt><br><img src=\"https://forthebadge.com/images/badges/contains-cat-gifs.svg\" alt><br><img src=\"https://forthebadge.com/images/badges/powered-by-electricity.svg\" alt><br><img src=\"https://forthebadge.com/images/badges/makes-people-smile.svg\" alt></p>\n<h2 id=\"特性-Feature\"><a href=\"#特性-Feature\" class=\"headerlink\" title=\"特性 Feature\"></a>特性 Feature</h2><p>在网页中添加 Live2D 看板娘。兼容 PJAX，支持无刷新加载。<br>Add Live2D widget to web page. Compatible with PJAX.</p>\n<p><strong>警告：本项目不支持 IE 11 等老旧浏览器。</strong><br><strong>WARNING: This project does not support legacy browsers such as IE 11.</strong></p>\n<h2 id=\"示例-Demo\"><a href=\"#示例-Demo\" class=\"headerlink\" title=\"示例 Demo\"></a>示例 Demo</h2><p>在<a href=\"https://zhangshuqiao.org\" target=\"_blank\" rel=\"noopener\">米米的博客</a>的左下角可查看效果。</p>\n<p><img src=\"/live2d-widget/README.htm/screenshot-1.png\" alt><br><img src=\"/live2d-widget/README.htm/screenshot-2.png\" alt><br><img src=\"/live2d-widget/README.htm/screenshot-3.png\" alt></p>\n<p>这个仓库中也提供了两个 Demo，即</p>\n<ul>\n<li><a href=\"https://mi.js.org/live2d-widget/demo/demo1.html\" target=\"_blank\" rel=\"noopener\">demo1.html</a> ，展现基础效果</li>\n<li><a href=\"https://mi.js.org/live2d-widget/demo/demo2.html\" target=\"_blank\" rel=\"noopener\">demo2.html</a> ，仿NPM的登陆界面</li>\n</ul>\n<h2 id=\"依赖-Dependencies\"><a href=\"#依赖-Dependencies\" class=\"headerlink\" title=\"依赖 Dependencies\"></a>依赖 Dependencies</h2><p>本插件需要 Font Awesome 4.7.0 支持，请确保相关样式表已在页面中加载，例如在 <code>&lt;head&gt;</code> 中加入：<br>Font Awesome 4.7.0 is required for this plugin. You can add this to <code>&lt;head&gt;</code>:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\"</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>否则无法正常显示。（如果网页中已经加载了 Font Awesome，就不要重复加载了）</p>\n<h2 id=\"使用-Usage\"><a href=\"#使用-Usage\" class=\"headerlink\" title=\"使用 Usage\"></a>使用 Usage</h2><p>可以直接这样使用：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/autoload.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>将这一行代码加入 <code>&lt;head&gt;</code> 或 <code>&lt;body&gt;</code>，即可看到效果。如果网站启用了 PJAX，由于看板娘不必每页刷新，因此需要注意将相关脚本放到 PJAX 刷新区域之外。</p>\n<p>换句话说，如果你是小白，或者只需要最基础的功能，就只需要把这一行代码，连同前面加载 Font Awesome 的一行代码，一起放到 html 的 <code>&lt;head&gt;</code> 中即可。<br>如果页面是用各种模版引擎（例如 Nunjucks，Jinja 或者 PHP）生成的，也要自行修改，方法类似，只是可能略为麻烦。以 Hexo 为例，需要在主题相关的 ejs 或 njk 模版中正确配置路径，才可以加载。</p>\n<p><strong>但是！我们强烈推荐自己进行配置，否则很多功能是不完整的，并且可能产生问题！</strong><br>如果你有兴趣自己折腾的话，请看下面的详细说明。</p>\n<h3 id=\"Using-CDN\"><a href=\"#Using-CDN\" class=\"headerlink\" title=\"Using CDN\"></a>Using CDN</h3><p>要自定义有关内容，可以把这个仓库 Fork 一份，然后进行修改。这时，使用方法对应地变为</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/gh/username/live2d-widget/autoload.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>将 <code>username</code> 替换为你的 GitHub 用户名即可。</p>\n<h3 id=\"Self-host\"><a href=\"#Self-host\" class=\"headerlink\" title=\"Self-host\"></a>Self-host</h3><p>你也可以直接把这些文件放到服务器上，而不是通过 CDN 加载。</p>\n<ul>\n<li>如果你可以通过 <code>ssh</code> 访问你的主机，请把整个项目克隆到服务器上。执行：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /path/to/your/webroot</span><br><span class=\"line\"><span class=\"comment\"># Clone this repository</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/stevenjoezhang/live2d-widget.git</span><br></pre></td></tr></table></figure></li>\n<li>如果你的主机无法用 <code>ssh</code> 连接（例如一般的虚拟主机），请选择 <code>Download ZIP</code>，然后通过 <code>ftp</code> 等方式上传到主机上，再解压到网站的目录下。</li>\n<li>如果你是通过 Hexo 等工具部署的静态博客，请在本地开命令行进入博客目录，例如 <code>source</code> 下与 <code>_posts</code> 同级的目录，然后再执行前述的 <code>git clone</code> 命令。重新部署博客时，相关文件就会自动上传到对应的路径下。</li>\n</ul>\n<p>这样，整个项目就可以通过你的服务器 IP 或者域名从公网访问了。你可以试试能否正常地通过浏览器打开 <code>autoload.js</code> 和 <code>live2d.min.js</code> 等文件，并确认这些文件的内容是正确的，没有出现乱码。<br>一切正常的话，接下来修改一些配置就行了。（需要通过服务器上的文本编辑器修改；你也可以先在本地完成这一步骤，再上传到服务器上）<br>修改 <code>autoload.js</code> 中的常量 <code>live2d_path</code> 为 <code>live2d-widget</code> 这一文件夹在公网上的路径。比如说，如果你可以通过</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https:&#x2F;&#x2F;www.example.com&#x2F;path&#x2F;to&#x2F;live2d-widget&#x2F;live2d.min.js</span><br></pre></td></tr></table></figure>\n<p>访问到 <code>live2d.min.js</code>，那么就把 <code>live2d_path</code> 的值修改为</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https:&#x2F;&#x2F;www.example.com&#x2F;path&#x2F;to&#x2F;live2d-widget&#x2F;</span><br></pre></td></tr></table></figure>\n<p>路径末尾的 <code>/</code> 一定要加上。具体可以参考 <code>autoload.js</code> 内的注释。<br>完成后，在你要添加看板娘的界面加入</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://www.example.com/path/to/live2d-widget/autoload.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>就可以加载了。</p>\n<h2 id=\"目录结构-Files\"><a href=\"#目录结构-Files\" class=\"headerlink\" title=\"目录结构 Files\"></a>目录结构 Files</h2><ul>\n<li><code>waifu-tips.json</code> 中包含了触发条件（<code>selector</code>，选择器）和触发时显示的文字（<code>text</code>）；</li>\n<li><code>waifu.css</code> 是看板娘的样式表。</li>\n</ul>\n<p>源文件是对 Hexo 的 NexT 主题有效的，为了适用于你自己的网页，可能需要自行修改，或增加新内容。<br><strong>警告：作者不对包括但不限于 <code>waifu-tips.json</code> 和 <code>waifu-tips.js</code> 文件中的内容负责，请自行确保它们是合适的。</strong></p>\n<p>如果有任何疑问，欢迎提 Issue。如果有任何修改建议，欢迎提 Pull Request。</p>\n<h2 id=\"鸣谢-Credits\"><a href=\"#鸣谢-Credits\" class=\"headerlink\" title=\"鸣谢 Credits\"></a>鸣谢 Credits</h2><p><a href=\"https://www.browserstack.com\" target=\"_blank\" rel=\"noopener\"><img src=\"/live2d-widget/README.htm/browserstack.svg\" alt></a></p>\n<p>感谢 BrowserStack 容许我们在真实的浏览器中测试此项目。<br>Thanks to BrowserStack for allowing us to test this project in real browsers.</p>\n<p>代码自这篇博文魔改而来：<br><a href=\"https://www.fghrsh.net/post/123.html\" target=\"_blank\" rel=\"noopener\">https://www.fghrsh.net/post/123.html</a></p>\n<p>点击看板娘的纸飞机按钮时，会出现一个彩蛋，这来自于 <a href=\"http://www.websiteasteroids.com\" target=\"_blank\" rel=\"noopener\">WebsiteAsteroids</a>。</p>\n<h2 id=\"更多-More\"><a href=\"#更多-More\" class=\"headerlink\" title=\"更多 More\"></a>更多 More</h2><p>更多内容可以参考：<br><a href=\"https://imjad.cn/archives/lab/add-dynamic-poster-girl-with-live2d-to-your-blog-02\" target=\"_blank\" rel=\"noopener\">https://imjad.cn/archives/lab/add-dynamic-poster-girl-with-live2d-to-your-blog-02</a><br><a href=\"https://github.com/xiazeyu/live2d-widget.js\" target=\"_blank\" rel=\"noopener\">https://github.com/xiazeyu/live2d-widget.js</a><br><a href=\"https://github.com/summerscar/live2dDemo\" target=\"_blank\" rel=\"noopener\">https://github.com/summerscar/live2dDemo</a></p>\n<p>还可以自行搭建后端 API，并增加模型（需要修改的内容比较多，此处不再赘述）：<br><a href=\"https://github.com/fghrsh/live2d_api\" target=\"_blank\" rel=\"noopener\">https://github.com/fghrsh/live2d_api</a><br><a href=\"https://github.com/xiazeyu/live2d-widget-models\" target=\"_blank\" rel=\"noopener\">https://github.com/xiazeyu/live2d-widget-models</a><br><a href=\"https://github.com/xiaoski/live2d_models_collection\" target=\"_blank\" rel=\"noopener\">https://github.com/xiaoski/live2d_models_collection</a></p>\n<p>除此之外，还有桌面版本：<br><a href=\"https://github.com/amorist/platelet\" target=\"_blank\" rel=\"noopener\">https://github.com/amorist/platelet</a><br><a href=\"https://github.com/akiroz/Live2D-Widget\" target=\"_blank\" rel=\"noopener\">https://github.com/akiroz/Live2D-Widget</a></p>\n<h2 id=\"许可证-License\"><a href=\"#许可证-License\" class=\"headerlink\" title=\"许可证 License\"></a>许可证 License</h2><p>Released under the GNU General Public License v3<br><a href=\"http://www.gnu.org/licenses/gpl-3.0.html\" target=\"_blank\" rel=\"noopener\">http://www.gnu.org/licenses/gpl-3.0.html</a></p>\n<p>本仓库中涉及的所有 Live2D 模型、图片、动作数据等版权均属于其原作者，仅供研究学习，不得用于商业用途。</p>\n<p>Live2D 官方网站：<br><a href=\"https://www.live2d.com/en/\" target=\"_blank\" rel=\"noopener\">https://www.live2d.com/en/</a><br><a href=\"https://live2d.github.io\" target=\"_blank\" rel=\"noopener\">https://live2d.github.io</a></p>\n<p>Live2D Cubism Core は Live2D Proprietary Software License で提供しています。<br><a href=\"https://www.live2d.com/eula/live2d-proprietary-software-license-agreement_en.html\" target=\"_blank\" rel=\"noopener\">https://www.live2d.com/eula/live2d-proprietary-software-license-agreement_en.html</a><br>Live2D Cubism Components は Live2D Open Software License で提供しています。<br><a href=\"http://www.live2d.com/eula/live2d-open-software-license-agreement_en.html\" target=\"_blank\" rel=\"noopener\">http://www.live2d.com/eula/live2d-open-software-license-agreement_en.html</a></p>\n<blockquote>\n<p>The terms and conditions do prohibit modification, but obfuscating in <code>live2d.min.js</code> would not be considered illegal modification.</p>\n</blockquote>\n<p><a href=\"https://community.live2d.com/discussion/140/webgl-developer-licence-and-javascript-question\" target=\"_blank\" rel=\"noopener\">https://community.live2d.com/discussion/140/webgl-developer-licence-and-javascript-question</a></p>\n<h2 id=\"更新-Update\"><a href=\"#更新-Update\" class=\"headerlink\" title=\"更新 Update\"></a>更新 Update</h2><p>2018年10月31日，由 fghrsh 提供的原 API 停用，请更新至新地址。参考文章：<br><a href=\"https://www.fghrsh.net/post/170.html\" target=\"_blank\" rel=\"noopener\">https://www.fghrsh.net/post/170.html</a></p>\n<p>2020年1月1日起，本项目不再依赖于 jQuery。</p>\n","site":{"data":{}},"length":3744,"excerpt":"","more":"<h1 id=\"Live2D-Widget\"><a href=\"#Live2D-Widget\" class=\"headerlink\" title=\"Live2D Widget\"></a>Live2D Widget</h1><p><img src=\"https://forthebadge.com/images/badges/built-with-love.svg\" alt><br><img src=\"https://forthebadge.com/images/badges/uses-html.svg\" alt><br><img src=\"https://forthebadge.com/images/badges/made-with-javascript.svg\" alt><br><img src=\"https://forthebadge.com/images/badges/contains-cat-gifs.svg\" alt><br><img src=\"https://forthebadge.com/images/badges/powered-by-electricity.svg\" alt><br><img src=\"https://forthebadge.com/images/badges/makes-people-smile.svg\" alt></p>\n<h2 id=\"特性-Feature\"><a href=\"#特性-Feature\" class=\"headerlink\" title=\"特性 Feature\"></a>特性 Feature</h2><p>在网页中添加 Live2D 看板娘。兼容 PJAX，支持无刷新加载。<br>Add Live2D widget to web page. Compatible with PJAX.</p>\n<p><strong>警告：本项目不支持 IE 11 等老旧浏览器。</strong><br><strong>WARNING: This project does not support legacy browsers such as IE 11.</strong></p>\n<h2 id=\"示例-Demo\"><a href=\"#示例-Demo\" class=\"headerlink\" title=\"示例 Demo\"></a>示例 Demo</h2><p>在<a href=\"https://zhangshuqiao.org\" target=\"_blank\" rel=\"noopener\">米米的博客</a>的左下角可查看效果。</p>\n<p><img src=\"/live2d-widget/README.htm/screenshot-1.png\" alt><br><img src=\"/live2d-widget/README.htm/screenshot-2.png\" alt><br><img src=\"/live2d-widget/README.htm/screenshot-3.png\" alt></p>\n<p>这个仓库中也提供了两个 Demo，即</p>\n<ul>\n<li><a href=\"https://mi.js.org/live2d-widget/demo/demo1.html\" target=\"_blank\" rel=\"noopener\">demo1.html</a> ，展现基础效果</li>\n<li><a href=\"https://mi.js.org/live2d-widget/demo/demo2.html\" target=\"_blank\" rel=\"noopener\">demo2.html</a> ，仿NPM的登陆界面</li>\n</ul>\n<h2 id=\"依赖-Dependencies\"><a href=\"#依赖-Dependencies\" class=\"headerlink\" title=\"依赖 Dependencies\"></a>依赖 Dependencies</h2><p>本插件需要 Font Awesome 4.7.0 支持，请确保相关样式表已在页面中加载，例如在 <code>&lt;head&gt;</code> 中加入：<br>Font Awesome 4.7.0 is required for this plugin. You can add this to <code>&lt;head&gt;</code>:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\"</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>否则无法正常显示。（如果网页中已经加载了 Font Awesome，就不要重复加载了）</p>\n<h2 id=\"使用-Usage\"><a href=\"#使用-Usage\" class=\"headerlink\" title=\"使用 Usage\"></a>使用 Usage</h2><p>可以直接这样使用：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/autoload.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>将这一行代码加入 <code>&lt;head&gt;</code> 或 <code>&lt;body&gt;</code>，即可看到效果。如果网站启用了 PJAX，由于看板娘不必每页刷新，因此需要注意将相关脚本放到 PJAX 刷新区域之外。</p>\n<p>换句话说，如果你是小白，或者只需要最基础的功能，就只需要把这一行代码，连同前面加载 Font Awesome 的一行代码，一起放到 html 的 <code>&lt;head&gt;</code> 中即可。<br>如果页面是用各种模版引擎（例如 Nunjucks，Jinja 或者 PHP）生成的，也要自行修改，方法类似，只是可能略为麻烦。以 Hexo 为例，需要在主题相关的 ejs 或 njk 模版中正确配置路径，才可以加载。</p>\n<p><strong>但是！我们强烈推荐自己进行配置，否则很多功能是不完整的，并且可能产生问题！</strong><br>如果你有兴趣自己折腾的话，请看下面的详细说明。</p>\n<h3 id=\"Using-CDN\"><a href=\"#Using-CDN\" class=\"headerlink\" title=\"Using CDN\"></a>Using CDN</h3><p>要自定义有关内容，可以把这个仓库 Fork 一份，然后进行修改。这时，使用方法对应地变为</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/gh/username/live2d-widget/autoload.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>将 <code>username</code> 替换为你的 GitHub 用户名即可。</p>\n<h3 id=\"Self-host\"><a href=\"#Self-host\" class=\"headerlink\" title=\"Self-host\"></a>Self-host</h3><p>你也可以直接把这些文件放到服务器上，而不是通过 CDN 加载。</p>\n<ul>\n<li>如果你可以通过 <code>ssh</code> 访问你的主机，请把整个项目克隆到服务器上。执行：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /path/to/your/webroot</span><br><span class=\"line\"><span class=\"comment\"># Clone this repository</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/stevenjoezhang/live2d-widget.git</span><br></pre></td></tr></table></figure></li>\n<li>如果你的主机无法用 <code>ssh</code> 连接（例如一般的虚拟主机），请选择 <code>Download ZIP</code>，然后通过 <code>ftp</code> 等方式上传到主机上，再解压到网站的目录下。</li>\n<li>如果你是通过 Hexo 等工具部署的静态博客，请在本地开命令行进入博客目录，例如 <code>source</code> 下与 <code>_posts</code> 同级的目录，然后再执行前述的 <code>git clone</code> 命令。重新部署博客时，相关文件就会自动上传到对应的路径下。</li>\n</ul>\n<p>这样，整个项目就可以通过你的服务器 IP 或者域名从公网访问了。你可以试试能否正常地通过浏览器打开 <code>autoload.js</code> 和 <code>live2d.min.js</code> 等文件，并确认这些文件的内容是正确的，没有出现乱码。<br>一切正常的话，接下来修改一些配置就行了。（需要通过服务器上的文本编辑器修改；你也可以先在本地完成这一步骤，再上传到服务器上）<br>修改 <code>autoload.js</code> 中的常量 <code>live2d_path</code> 为 <code>live2d-widget</code> 这一文件夹在公网上的路径。比如说，如果你可以通过</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https:&#x2F;&#x2F;www.example.com&#x2F;path&#x2F;to&#x2F;live2d-widget&#x2F;live2d.min.js</span><br></pre></td></tr></table></figure>\n<p>访问到 <code>live2d.min.js</code>，那么就把 <code>live2d_path</code> 的值修改为</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https:&#x2F;&#x2F;www.example.com&#x2F;path&#x2F;to&#x2F;live2d-widget&#x2F;</span><br></pre></td></tr></table></figure>\n<p>路径末尾的 <code>/</code> 一定要加上。具体可以参考 <code>autoload.js</code> 内的注释。<br>完成后，在你要添加看板娘的界面加入</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://www.example.com/path/to/live2d-widget/autoload.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>就可以加载了。</p>\n<h2 id=\"目录结构-Files\"><a href=\"#目录结构-Files\" class=\"headerlink\" title=\"目录结构 Files\"></a>目录结构 Files</h2><ul>\n<li><code>waifu-tips.json</code> 中包含了触发条件（<code>selector</code>，选择器）和触发时显示的文字（<code>text</code>）；</li>\n<li><code>waifu.css</code> 是看板娘的样式表。</li>\n</ul>\n<p>源文件是对 Hexo 的 NexT 主题有效的，为了适用于你自己的网页，可能需要自行修改，或增加新内容。<br><strong>警告：作者不对包括但不限于 <code>waifu-tips.json</code> 和 <code>waifu-tips.js</code> 文件中的内容负责，请自行确保它们是合适的。</strong></p>\n<p>如果有任何疑问，欢迎提 Issue。如果有任何修改建议，欢迎提 Pull Request。</p>\n<h2 id=\"鸣谢-Credits\"><a href=\"#鸣谢-Credits\" class=\"headerlink\" title=\"鸣谢 Credits\"></a>鸣谢 Credits</h2><p><a href=\"https://www.browserstack.com\" target=\"_blank\" rel=\"noopener\"><img src=\"/live2d-widget/README.htm/browserstack.svg\" alt></a></p>\n<p>感谢 BrowserStack 容许我们在真实的浏览器中测试此项目。<br>Thanks to BrowserStack for allowing us to test this project in real browsers.</p>\n<p>代码自这篇博文魔改而来：<br><a href=\"https://www.fghrsh.net/post/123.html\" target=\"_blank\" rel=\"noopener\">https://www.fghrsh.net/post/123.html</a></p>\n<p>点击看板娘的纸飞机按钮时，会出现一个彩蛋，这来自于 <a href=\"http://www.websiteasteroids.com\" target=\"_blank\" rel=\"noopener\">WebsiteAsteroids</a>。</p>\n<h2 id=\"更多-More\"><a href=\"#更多-More\" class=\"headerlink\" title=\"更多 More\"></a>更多 More</h2><p>更多内容可以参考：<br><a href=\"https://imjad.cn/archives/lab/add-dynamic-poster-girl-with-live2d-to-your-blog-02\" target=\"_blank\" rel=\"noopener\">https://imjad.cn/archives/lab/add-dynamic-poster-girl-with-live2d-to-your-blog-02</a><br><a href=\"https://github.com/xiazeyu/live2d-widget.js\" target=\"_blank\" rel=\"noopener\">https://github.com/xiazeyu/live2d-widget.js</a><br><a href=\"https://github.com/summerscar/live2dDemo\" target=\"_blank\" rel=\"noopener\">https://github.com/summerscar/live2dDemo</a></p>\n<p>还可以自行搭建后端 API，并增加模型（需要修改的内容比较多，此处不再赘述）：<br><a href=\"https://github.com/fghrsh/live2d_api\" target=\"_blank\" rel=\"noopener\">https://github.com/fghrsh/live2d_api</a><br><a href=\"https://github.com/xiazeyu/live2d-widget-models\" target=\"_blank\" rel=\"noopener\">https://github.com/xiazeyu/live2d-widget-models</a><br><a href=\"https://github.com/xiaoski/live2d_models_collection\" target=\"_blank\" rel=\"noopener\">https://github.com/xiaoski/live2d_models_collection</a></p>\n<p>除此之外，还有桌面版本：<br><a href=\"https://github.com/amorist/platelet\" target=\"_blank\" rel=\"noopener\">https://github.com/amorist/platelet</a><br><a href=\"https://github.com/akiroz/Live2D-Widget\" target=\"_blank\" rel=\"noopener\">https://github.com/akiroz/Live2D-Widget</a></p>\n<h2 id=\"许可证-License\"><a href=\"#许可证-License\" class=\"headerlink\" title=\"许可证 License\"></a>许可证 License</h2><p>Released under the GNU General Public License v3<br><a href=\"http://www.gnu.org/licenses/gpl-3.0.html\" target=\"_blank\" rel=\"noopener\">http://www.gnu.org/licenses/gpl-3.0.html</a></p>\n<p>本仓库中涉及的所有 Live2D 模型、图片、动作数据等版权均属于其原作者，仅供研究学习，不得用于商业用途。</p>\n<p>Live2D 官方网站：<br><a href=\"https://www.live2d.com/en/\" target=\"_blank\" rel=\"noopener\">https://www.live2d.com/en/</a><br><a href=\"https://live2d.github.io\" target=\"_blank\" rel=\"noopener\">https://live2d.github.io</a></p>\n<p>Live2D Cubism Core は Live2D Proprietary Software License で提供しています。<br><a href=\"https://www.live2d.com/eula/live2d-proprietary-software-license-agreement_en.html\" target=\"_blank\" rel=\"noopener\">https://www.live2d.com/eula/live2d-proprietary-software-license-agreement_en.html</a><br>Live2D Cubism Components は Live2D Open Software License で提供しています。<br><a href=\"http://www.live2d.com/eula/live2d-open-software-license-agreement_en.html\" target=\"_blank\" rel=\"noopener\">http://www.live2d.com/eula/live2d-open-software-license-agreement_en.html</a></p>\n<blockquote>\n<p>The terms and conditions do prohibit modification, but obfuscating in <code>live2d.min.js</code> would not be considered illegal modification.</p>\n</blockquote>\n<p><a href=\"https://community.live2d.com/discussion/140/webgl-developer-licence-and-javascript-question\" target=\"_blank\" rel=\"noopener\">https://community.live2d.com/discussion/140/webgl-developer-licence-and-javascript-question</a></p>\n<h2 id=\"更新-Update\"><a href=\"#更新-Update\" class=\"headerlink\" title=\"更新 Update\"></a>更新 Update</h2><p>2018年10月31日，由 fghrsh 提供的原 API 停用，请更新至新地址。参考文章：<br><a href=\"https://www.fghrsh.net/post/170.html\" target=\"_blank\" rel=\"noopener\">https://www.fghrsh.net/post/170.html</a></p>\n<p>2020年1月1日起，本项目不再依赖于 jQuery。</p>\n"},{"_content":"//注意：live2d_path参数应使用绝对路径\n//const live2d_path = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/\";\nconst live2d_path = \"/live2d-widget/\";\n\n//加载waifu.css\n$(\"<link>\").attr({ href: live2d_path + \"waifu.css\", rel: \"stylesheet\" }).appendTo(\"head\");\n\n//加载live2d.min.js\n$.ajax({\n\turl: \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/live2d.min.js\",\n\tdataType: \"script\",\n\tcache: true,\n\tsuccess(result) {\n        // console.log(\"加载 https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/live2d.min.js 成功\");\n    },\n    error(err) {\n        console.log(err);\n    },\n});\n\n//加载waifu-tips.js\n$.ajax({\n\turl: live2d_path + \"waifu-tips.js\",\n\tdataType: \"script\",\n\tcache: true,\n    success(result) {\n        // console.log(\"加载 \" + live2d_path + \"waifu-tips.js 成功\");\n    },\n    error(err) {\n        console.log(err);\n    },\n});\n\n//初始化看板娘，会自动加载指定目录下的waifu-tips.json\n$(window).on(\"load\", function() {\n\tinitWidget(live2d_path + \"waifu-tips.json\", \"https://live2d.fghrsh.net/api\");\n});\n//initWidget第一个参数为waifu-tips.json的路径\n//第二个参数为api地址（无需修改）\n//api后端可自行搭建，参考https://github.com/fghrsh/live2d_api\n\n// console.log(`\n//   く__,.ヘヽ.        /  ,ー､ 〉\n//            ＼ ', !-─‐-i  /  /´\n//            ／｀ｰ'       L/／｀ヽ､\n//          /   ／,   /|   ,   ,       ',\n//        ｲ   / /-‐/  ｉ  L_ ﾊ ヽ!   i\n//         ﾚ ﾍ 7ｲ｀ﾄ   ﾚ'ｧ-ﾄ､!ハ|   |\n//           !,/7 '0'     ´0iソ|    |\n//           |.从\"    _     ,,,, / |./    |\n//           ﾚ'| i＞.､,,__  _,.イ /   .i   |\n//             ﾚ'| | / k_７_/ﾚ'ヽ,  ﾊ.  |\n//               | |/i 〈|/   i  ,.ﾍ |  i  |\n//              .|/ /  ｉ：    ﾍ!    ＼  |\n//               kヽ>､ﾊ    _,.ﾍ､    /､!\n//               !'〈//｀Ｔ´', ＼ ｀'7'ｰr'\n//               ﾚ'ヽL__|___i,___,ンﾚ|ノ\n//                   ﾄ-,/  |___./\n//                   'ｰ'    !_,.:\n// `);\n","source":"live2d-widget/autoload.js","raw":"//注意：live2d_path参数应使用绝对路径\n//const live2d_path = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/\";\nconst live2d_path = \"/live2d-widget/\";\n\n//加载waifu.css\n$(\"<link>\").attr({ href: live2d_path + \"waifu.css\", rel: \"stylesheet\" }).appendTo(\"head\");\n\n//加载live2d.min.js\n$.ajax({\n\turl: \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/live2d.min.js\",\n\tdataType: \"script\",\n\tcache: true,\n\tsuccess(result) {\n        // console.log(\"加载 https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/live2d.min.js 成功\");\n    },\n    error(err) {\n        console.log(err);\n    },\n});\n\n//加载waifu-tips.js\n$.ajax({\n\turl: live2d_path + \"waifu-tips.js\",\n\tdataType: \"script\",\n\tcache: true,\n    success(result) {\n        // console.log(\"加载 \" + live2d_path + \"waifu-tips.js 成功\");\n    },\n    error(err) {\n        console.log(err);\n    },\n});\n\n//初始化看板娘，会自动加载指定目录下的waifu-tips.json\n$(window).on(\"load\", function() {\n\tinitWidget(live2d_path + \"waifu-tips.json\", \"https://live2d.fghrsh.net/api\");\n});\n//initWidget第一个参数为waifu-tips.json的路径\n//第二个参数为api地址（无需修改）\n//api后端可自行搭建，参考https://github.com/fghrsh/live2d_api\n\n// console.log(`\n//   く__,.ヘヽ.        /  ,ー､ 〉\n//            ＼ ', !-─‐-i  /  /´\n//            ／｀ｰ'       L/／｀ヽ､\n//          /   ／,   /|   ,   ,       ',\n//        ｲ   / /-‐/  ｉ  L_ ﾊ ヽ!   i\n//         ﾚ ﾍ 7ｲ｀ﾄ   ﾚ'ｧ-ﾄ､!ハ|   |\n//           !,/7 '0'     ´0iソ|    |\n//           |.从\"    _     ,,,, / |./    |\n//           ﾚ'| i＞.､,,__  _,.イ /   .i   |\n//             ﾚ'| | / k_７_/ﾚ'ヽ,  ﾊ.  |\n//               | |/i 〈|/   i  ,.ﾍ |  i  |\n//              .|/ /  ｉ：    ﾍ!    ＼  |\n//               kヽ>､ﾊ    _,.ﾍ､    /､!\n//               !'〈//｀Ｔ´', ＼ ｀'7'ｰr'\n//               ﾚ'ヽL__|___i,___,ンﾚ|ノ\n//                   ﾄ-,/  |___./\n//                   'ｰ'    !_,.:\n// `);\n","date":"2020-01-19T15:33:22.651Z","updated":"2020-01-19T15:33:22.651Z","path":"live2d-widget/autoload.js","layout":"false","title":"","comments":1,"_id":"ck5obqn5a00092lwj2r2pb0l0","content":"//注意：live2d_path参数应使用绝对路径\n//const live2d_path = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/\";\nconst live2d_path = \"/live2d-widget/\";\n\n//加载waifu.css\n$(\"<link>\").attr({ href: live2d_path + \"waifu.css\", rel: \"stylesheet\" }).appendTo(\"head\");\n\n//加载live2d.min.js\n$.ajax({\n\turl: \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/live2d.min.js\",\n\tdataType: \"script\",\n\tcache: true,\n\tsuccess(result) {\n        // console.log(\"加载 https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/live2d.min.js 成功\");\n    },\n    error(err) {\n        console.log(err);\n    },\n});\n\n//加载waifu-tips.js\n$.ajax({\n\turl: live2d_path + \"waifu-tips.js\",\n\tdataType: \"script\",\n\tcache: true,\n    success(result) {\n        // console.log(\"加载 \" + live2d_path + \"waifu-tips.js 成功\");\n    },\n    error(err) {\n        console.log(err);\n    },\n});\n\n//初始化看板娘，会自动加载指定目录下的waifu-tips.json\n$(window).on(\"load\", function() {\n\tinitWidget(live2d_path + \"waifu-tips.json\", \"https://live2d.fghrsh.net/api\");\n});\n//initWidget第一个参数为waifu-tips.json的路径\n//第二个参数为api地址（无需修改）\n//api后端可自行搭建，参考https://github.com/fghrsh/live2d_api\n\n// console.log(`\n//   く__,.ヘヽ.        /  ,ー､ 〉\n//            ＼ ', !-─‐-i  /  /´\n//            ／｀ｰ'       L/／｀ヽ､\n//          /   ／,   /|   ,   ,       ',\n//        ｲ   / /-‐/  ｉ  L_ ﾊ ヽ!   i\n//         ﾚ ﾍ 7ｲ｀ﾄ   ﾚ'ｧ-ﾄ､!ハ|   |\n//           !,/7 '0'     ´0iソ|    |\n//           |.从\"    _     ,,,, / |./    |\n//           ﾚ'| i＞.､,,__  _,.イ /   .i   |\n//             ﾚ'| | / k_７_/ﾚ'ヽ,  ﾊ.  |\n//               | |/i 〈|/   i  ,.ﾍ |  i  |\n//              .|/ /  ｉ：    ﾍ!    ＼  |\n//               kヽ>､ﾊ    _,.ﾍ､    /､!\n//               !'〈//｀Ｔ´', ＼ ｀'7'ｰr'\n//               ﾚ'ヽL__|___i,___,ンﾚ|ノ\n//                   ﾄ-,/  |___./\n//                   'ｰ'    !_,.:\n// `);\n","site":{"data":{}},"length":1222,"excerpt":"","more":"//注意：live2d_path参数应使用绝对路径\n//const live2d_path = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/\";\nconst live2d_path = \"/live2d-widget/\";\n\n//加载waifu.css\n$(\"<link>\").attr({ href: live2d_path + \"waifu.css\", rel: \"stylesheet\" }).appendTo(\"head\");\n\n//加载live2d.min.js\n$.ajax({\n\turl: \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/live2d.min.js\",\n\tdataType: \"script\",\n\tcache: true,\n\tsuccess(result) {\n        // console.log(\"加载 https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/live2d.min.js 成功\");\n    },\n    error(err) {\n        console.log(err);\n    },\n});\n\n//加载waifu-tips.js\n$.ajax({\n\turl: live2d_path + \"waifu-tips.js\",\n\tdataType: \"script\",\n\tcache: true,\n    success(result) {\n        // console.log(\"加载 \" + live2d_path + \"waifu-tips.js 成功\");\n    },\n    error(err) {\n        console.log(err);\n    },\n});\n\n//初始化看板娘，会自动加载指定目录下的waifu-tips.json\n$(window).on(\"load\", function() {\n\tinitWidget(live2d_path + \"waifu-tips.json\", \"https://live2d.fghrsh.net/api\");\n});\n//initWidget第一个参数为waifu-tips.json的路径\n//第二个参数为api地址（无需修改）\n//api后端可自行搭建，参考https://github.com/fghrsh/live2d_api\n\n// console.log(`\n//   く__,.ヘヽ.        /  ,ー､ 〉\n//            ＼ ', !-─‐-i  /  /´\n//            ／｀ｰ'       L/／｀ヽ､\n//          /   ／,   /|   ,   ,       ',\n//        ｲ   / /-‐/  ｉ  L_ ﾊ ヽ!   i\n//         ﾚ ﾍ 7ｲ｀ﾄ   ﾚ'ｧ-ﾄ､!ハ|   |\n//           !,/7 '0'     ´0iソ|    |\n//           |.从\"    _     ,,,, / |./    |\n//           ﾚ'| i＞.､,,__  _,.イ /   .i   |\n//             ﾚ'| | / k_７_/ﾚ'ヽ,  ﾊ.  |\n//               | |/i 〈|/   i  ,.ﾍ |  i  |\n//              .|/ /  ｉ：    ﾍ!    ＼  |\n//               kヽ>､ﾊ    _,.ﾍ､    /､!\n//               !'〈//｀Ｔ´', ＼ ｀'7'ｰr'\n//               ﾚ'ヽL__|___i,___,ンﾚ|ノ\n//                   ﾄ-,/  |___./\n//                   'ｰ'    !_,.:\n// `);\n"},{"_content":"/*\n * https://imjad.cn/archives/lab/add-dynamic-poster-girl-with-live2d-to-your-blog-02\n * https://www.fghrsh.net/post/123.html\n */\n\nfunction loadWidget(waifuPath, apiPath) {\n    localStorage.removeItem(\"waifu-display\");\n    sessionStorage.removeItem(\"waifu-text\");\n    $(\"body\").append(`<div id=\"waifu\">\n\t\t\t<div id=\"waifu-tips\"></div>\n\t\t\t<canvas id=\"live2d\" width=\"300\" height=\"300\"></canvas>\n\t\t\t<div id=\"waifu-tool\">\n\t\t\t\t<span class=\"fa fa-lg fa-comment\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-paper-plane\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-user-circle\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-street-view\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-camera-retro\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-info-circle\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-times\"></span>\n\t\t\t</div>\n\t\t</div>`);\n    $(\"#waifu\").show().animate({bottom: 0}, 3000);\n\n    function registerEventListener() {\n        $(\"#waifu-tool .fa-comment\").click(showHitokoto);\n        $(\"#waifu-tool .fa-paper-plane\").click(() => {\n            if (window.Asteroids) {\n                if (!window.ASTEROIDSPLAYERS) window.ASTEROIDSPLAYERS = [];\n                window.ASTEROIDSPLAYERS.push(new Asteroids());\n            } else {\n                $.ajax({\n                    url: \"https://cdn.jsdelivr.net/gh/GalaxyMimi/CDN/asteroids.js\",\n                    dataType: \"script\",\n                    cache: true\n                });\n            }\n        });\n        $(\"#waifu-tool .fa-user-circle\").click(loadOtherModel);\n        $(\"#waifu-tool .fa-street-view\").click(loadRandModel);\n        $(\"#waifu-tool .fa-camera-retro\").click(() => {\n            showMessage(\"照好了嘛，是不是很可爱呢？\", 6000, 9);\n            Live2D.captureName = \"photo.png\";\n            Live2D.captureFrame = true;\n        });\n        $(\"#waifu-tool .fa-info-circle\").click(() => {\n            open(\"https://github.com/stevenjoezhang/live2d-widget\");\n        });\n        $(\"#waifu-tool .fa-times\").click(() => {\n            localStorage.setItem(\"waifu-display\", new Date().getTime());\n            showMessage(\"愿你有一天能与重要的人重逢。\", 2000, 11);\n            $(\"#waifu\").animate({bottom: -500}, 3000, () => {\n                $(\"#waifu\").hide();\n                $(\"#waifu-toggle\").show().animate({\"margin-left\": -50}, 1000);\n            });\n        });\n        var re = /x/;\n        console.log(re);\n        re.toString = () => {\n            showMessage(\"哈哈，你打开了控制台，是想要看看我的小秘密吗？\", 6000, 9);\n            return \"\";\n        };\n        $(document).on(\"copy\", () => {\n            showMessage(\"你都复制了些什么呀，转载要记得加上出处哦！\", 6000, 9);\n        });\n        $(document).on(\"visibilitychange\", () => {\n            if (!document.hidden) showMessage(\"哇，好想你呀～你终于回来了～\", 6000, 9);\n        });\n    }\n\n    registerEventListener();\n\n    function welcomeMessage() {\n        var SiteIndexUrl = location.port ? `${location.protocol}//${location.hostname}:${location.port}/` : `${location.protocol}//${location.hostname}/`,\n            text; //自动获取主页\n        if (location.href == SiteIndexUrl) { //如果是主页\n            var now = new Date().getHours();\n            if (now > 5 && now <= 7) text = \"哇塞你醒的好早呀，Euphoria现在还应该在睡大觉吧！嘻嘻～\";\n            else if (now > 7 && now <= 11) text = \"一日之际在于晨，快去叫醒我的主人Euphoria呀，他一定还在睡觉呢～\";\n            else if (now > 11 && now <= 14) text = \"中午了，现在是午餐时间！我要吃好多好多好吃的～\";\n            else if (now > 14 && now <= 17) text = \"午后很容易犯困呢，今天的BUG改完了吗？\";\n            else if (now > 17 && now <= 19) text = \"傍晚了！窗外夕阳的景色很美丽呢，快带着心上人出去走走吧（没有心上人的可以来找Euphoria）～\";\n            else if (now > 19 && now <= 21) text = \"晚上好，今天过得怎么样？有没有被BUG折磨的痛并快乐着呢？\";\n            else if (now > 21 && now <= 23) text = [\"已经这么晚了呀，早点休息吧，晚安～\", \"深夜时要爱护眼睛呀！\"];\n            else text = [\"你是夜猫子呀？这么晚还不睡觉，明天起的来嘛？\", \"你现在可以找找Euphoria，说不定他也和你一样醒着呢～\"];\n        } else if (document.referrer !== \"\") {\n            var referrer = document.createElement(\"a\");\n            referrer.href = document.referrer;\n            var domain = referrer.hostname.split(\".\")[1];\n            if (location.hostname == referrer.hostname) text = `欢迎阅读<span style=\"color:#0099cc;\">『${document.title.split(\" - \")[0]}』</span>`;\n            else if (domain == \"baidu\") text = `Hello！来自 百度搜索 的朋友<br>你是搜索 <span style=\"color:#0099cc;\">${referrer.search.split(\"&wd=\")[1].split(\"&\")[0]}</span> 找到的我吗？`;\n            else if (domain == \"so\") text = `Hello！来自 360搜索 的朋友<br>你是搜索 <span style=\"color:#0099cc;\">${referrer.search.split(\"&q=\")[1].split(\"&\")[0]}</span> 找到的我吗？`;\n            else if (domain == \"google\") text = `Hello！来自 谷歌搜索 的朋友<br>欢迎阅读<span style=\"color:#0099cc;\">『${document.title.split(\" - \")[0]}』</span>`;\n            else text = `Hello！来自 <span style=\"color:#0099cc;\">${referrer.hostname}</span> 的朋友`;\n        } else {\n            text = `欢迎阅读<span style=\"color:#0099cc;\">『${document.title.split(\" - \")[0]}』</span>`;\n        }\n        showMessage(text, 7000, 8);\n    }\n\n    welcomeMessage();\n    //检测用户活动状态，并在空闲时定时显示一言\n    var userAction = false,\n        hitokotoTimer = null,\n        messageTimer = null,\n        messageArray = [\"好久不见，日子过得好快呢……\", \"大坏蛋！你都多久没碰人家了呀，嘤嘤嘤～\", \"嗨～快来逗我玩吧！\", \"哼！拿小拳拳锤你胸口！\"];\n    if ($(\".fa-share-alt\").is(\":hidden\")) messageArray.push(\"一定要记得把我加入Adblock白名单哦～\");\n    $(document).mousemove(() => {\n        userAction = true;\n    }).keydown(() => {\n        userAction = true;\n    });\n    setInterval(() => {\n        if (!userAction) {\n            if (!hitokotoTimer) hitokotoTimer = setInterval(showHitokoto, 25000);\n        } else {\n            userAction = false;\n            clearInterval(hitokotoTimer);\n            hitokotoTimer = null;\n        }\n    }, 1000);\n\n    function showHitokoto() {\n        //增加 hitokoto.cn 的 API\n        if (Math.random() < 0.6 && messageArray.length > 0) showMessage(messageArray[Math.floor(Math.random() * messageArray.length)], 6000, 9);\n        else $.getJSON(\"https://v1.hitokoto.cn\", function (result) {\n            var text = `这句一言来自 <span style=\"color:#0099cc;\">『${result.from}』</span>，是 <span style=\"color:#0099cc;\">${result.creator}</span> 在 hitokoto.cn 投稿的。`;\n            showMessage(result.hitokoto, 6000, 9);\n            setTimeout(() => {\n                showMessage(text, 4000, 9);\n            }, 6000);\n        });\n    }\n\n    function showMessage(text, timeout, priority) {\n        if (!text) return;\n        if (!sessionStorage.getItem(\"waifu-text\") || sessionStorage.getItem(\"waifu-text\") <= priority) {\n            if (messageTimer) {\n                clearTimeout(messageTimer);\n                messageTimer = null;\n            }\n            if (Array.isArray(text)) text = text[Math.floor(Math.random() * text.length)];\n            sessionStorage.setItem(\"waifu-text\", priority);\n            $(\"#waifu-tips\").stop().html(text).fadeTo(200, 1);\n            messageTimer = setTimeout(() => {\n                sessionStorage.removeItem(\"waifu-text\");\n                $(\"#waifu-tips\").fadeTo(1000, 0);\n            }, timeout);\n        }\n    }\n\n    function initModel() {\n        var modelId = localStorage.getItem(\"modelId\"),\n            modelTexturesId = localStorage.getItem(\"modelTexturesId\");\n        if (modelId == null) {\n            //首次访问加载 指定模型 的 指定材质\n            var modelId = 2, //模型 ID\n                modelTexturesId = 39; //材质 ID\n        }\n        loadModel(modelId, modelTexturesId);\n\n        demoWaifuPath = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/waifu-tips.json\";\n        $.getJSON(\"https://www.wqh4u.cn/live2d-widget/waifu-tips.json\", function (result) {\n            $.each(result.mouseover, function (index, tips) {\n                $(document).on(\"mouseover\", tips.selector, function () {\n                    var text = Array.isArray(tips.text) ? tips.text[Math.floor(Math.random() * tips.text.length)] : tips.text;\n                    text = text.replace(\"{text}\", $(this).text());\n                    showMessage(text, 4000, 8);\n                });\n            });\n            $.each(result.click, function (index, tips) {\n                $(document).on(\"click\", tips.selector, function () {\n                    var text = Array.isArray(tips.text) ? tips.text[Math.floor(Math.random() * tips.text.length)] : tips.text;\n                    text = text.replace(\"{text}\", $(this).text());\n                    showMessage(text, 4000, 8);\n                });\n            });\n            $.each(result.seasons, function (index, tips) {\n                var now = new Date(),\n                    after = tips.date.split(\"-\")[0],\n                    before = tips.date.split(\"-\")[1] || after;\n                if ((after.split(\"/\")[0] <= now.getMonth() + 1 && now.getMonth() + 1 <= before.split(\"/\")[0]) && (after.split(\"/\")[1] <= now.getDate() && now.getDate() <= before.split(\"/\")[1])) {\n                    var text = Array.isArray(tips.text) ? tips.text[Math.floor(Math.random() * tips.text.length)] : tips.text;\n                    text = text.replace(\"{year}\", now.getFullYear());\n                    //showMessage(text, 7000, true);\n                    messageArray.push(text);\n                }\n            });\n        });\n    }\n\n    initModel();\n\n    function loadModel(modelId, modelTexturesId) {\n        localStorage.setItem(\"modelId\", modelId);\n        if (modelTexturesId === undefined) modelTexturesId = 0;\n        localStorage.setItem(\"modelTexturesId\", modelTexturesId);\n        loadlive2d(\"live2d\", `${apiPath}/get/?id=${modelId}-${modelTexturesId}`, console.log(`Live2D 模型 ${modelId}-${modelTexturesId} 加载完成`));\n    }\n\n    function loadRandModel() {\n        var modelId = localStorage.getItem(\"modelId\"),\n            modelTexturesId = localStorage.getItem(\"modelTexturesId\");\n        //可选 \"rand\"(随机), \"switch\"(顺序)\n        $.ajax({\n            cache: false,\n            url: `${apiPath}/rand_textures/?id=${modelId}-${modelTexturesId}`,\n            dataType: \"json\",\n            success: function (result) {\n                if (result.textures[\"id\"] == 1 && (modelTexturesId == 1 || modelTexturesId == 0)) showMessage(\"我还没有其他衣服呢！大坏蛋快给人家增添衣服！\", 4000, 10);\n                else showMessage(\"我的新衣服好看嘛？嘻嘻～只要你觉得好看就好哦～\", 4000, 10);\n                loadModel(modelId, result.textures[\"id\"]);\n            }\n        });\n    }\n\n    function loadOtherModel() {\n        var modelId = localStorage.getItem(\"modelId\");\n        $.ajax({\n            cache: false,\n            url: `${apiPath}/switch/?id=${modelId}`,\n            dataType: \"json\",\n            success: function (result) {\n                loadModel(result.model[\"id\"]);\n                showMessage(result.model[\"message\"], 4000, 10);\n            }\n        });\n    }\n}\n\nfunction initWidget(waifuPath = \"/waifu-tips.json\", apiPath = \"\") {\n    if (screen.width <= 768) return;\n    $(\"body\").append(`<div id=\"waifu-toggle\" style=\"margin-left: -100px;\"><span>看板娘</span></div>`);\n    $(\"#waifu-toggle\").hover(() => {\n        $(\"#waifu-toggle\").animate({\"margin-left\": -30}, 500);\n    }, () => {\n        $(\"#waifu-toggle\").animate({\"margin-left\": -50}, 500);\n    }).click(() => {\n        $(\"#waifu-toggle\").animate({\"margin-left\": -100}, 1000, () => {\n            $(\"#waifu-toggle\").hide();\n        });\n        if ($(\"#waifu-toggle\").attr(\"first-time\")) {\n            loadWidget(waifuPath, apiPath);\n            $(\"#waifu-toggle\").attr(\"first-time\", false);\n        } else {\n            localStorage.removeItem(\"waifu-display\");\n            $(\"#waifu\").show().animate({bottom: 0}, 3000);\n        }\n    });\n    if (localStorage.getItem(\"waifu-display\") && new Date().getTime() - localStorage.getItem(\"waifu-display\") <= 86400000) {\n        $(\"#waifu-toggle\").attr(\"first-time\", true).css({\"margin-left\": -50});\n    } else {\n        loadWidget(waifuPath, apiPath);\n    }\n}\n","source":"live2d-widget/waifu-tips.js","raw":"/*\n * https://imjad.cn/archives/lab/add-dynamic-poster-girl-with-live2d-to-your-blog-02\n * https://www.fghrsh.net/post/123.html\n */\n\nfunction loadWidget(waifuPath, apiPath) {\n    localStorage.removeItem(\"waifu-display\");\n    sessionStorage.removeItem(\"waifu-text\");\n    $(\"body\").append(`<div id=\"waifu\">\n\t\t\t<div id=\"waifu-tips\"></div>\n\t\t\t<canvas id=\"live2d\" width=\"300\" height=\"300\"></canvas>\n\t\t\t<div id=\"waifu-tool\">\n\t\t\t\t<span class=\"fa fa-lg fa-comment\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-paper-plane\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-user-circle\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-street-view\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-camera-retro\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-info-circle\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-times\"></span>\n\t\t\t</div>\n\t\t</div>`);\n    $(\"#waifu\").show().animate({bottom: 0}, 3000);\n\n    function registerEventListener() {\n        $(\"#waifu-tool .fa-comment\").click(showHitokoto);\n        $(\"#waifu-tool .fa-paper-plane\").click(() => {\n            if (window.Asteroids) {\n                if (!window.ASTEROIDSPLAYERS) window.ASTEROIDSPLAYERS = [];\n                window.ASTEROIDSPLAYERS.push(new Asteroids());\n            } else {\n                $.ajax({\n                    url: \"https://cdn.jsdelivr.net/gh/GalaxyMimi/CDN/asteroids.js\",\n                    dataType: \"script\",\n                    cache: true\n                });\n            }\n        });\n        $(\"#waifu-tool .fa-user-circle\").click(loadOtherModel);\n        $(\"#waifu-tool .fa-street-view\").click(loadRandModel);\n        $(\"#waifu-tool .fa-camera-retro\").click(() => {\n            showMessage(\"照好了嘛，是不是很可爱呢？\", 6000, 9);\n            Live2D.captureName = \"photo.png\";\n            Live2D.captureFrame = true;\n        });\n        $(\"#waifu-tool .fa-info-circle\").click(() => {\n            open(\"https://github.com/stevenjoezhang/live2d-widget\");\n        });\n        $(\"#waifu-tool .fa-times\").click(() => {\n            localStorage.setItem(\"waifu-display\", new Date().getTime());\n            showMessage(\"愿你有一天能与重要的人重逢。\", 2000, 11);\n            $(\"#waifu\").animate({bottom: -500}, 3000, () => {\n                $(\"#waifu\").hide();\n                $(\"#waifu-toggle\").show().animate({\"margin-left\": -50}, 1000);\n            });\n        });\n        var re = /x/;\n        console.log(re);\n        re.toString = () => {\n            showMessage(\"哈哈，你打开了控制台，是想要看看我的小秘密吗？\", 6000, 9);\n            return \"\";\n        };\n        $(document).on(\"copy\", () => {\n            showMessage(\"你都复制了些什么呀，转载要记得加上出处哦！\", 6000, 9);\n        });\n        $(document).on(\"visibilitychange\", () => {\n            if (!document.hidden) showMessage(\"哇，好想你呀～你终于回来了～\", 6000, 9);\n        });\n    }\n\n    registerEventListener();\n\n    function welcomeMessage() {\n        var SiteIndexUrl = location.port ? `${location.protocol}//${location.hostname}:${location.port}/` : `${location.protocol}//${location.hostname}/`,\n            text; //自动获取主页\n        if (location.href == SiteIndexUrl) { //如果是主页\n            var now = new Date().getHours();\n            if (now > 5 && now <= 7) text = \"哇塞你醒的好早呀，Euphoria现在还应该在睡大觉吧！嘻嘻～\";\n            else if (now > 7 && now <= 11) text = \"一日之际在于晨，快去叫醒我的主人Euphoria呀，他一定还在睡觉呢～\";\n            else if (now > 11 && now <= 14) text = \"中午了，现在是午餐时间！我要吃好多好多好吃的～\";\n            else if (now > 14 && now <= 17) text = \"午后很容易犯困呢，今天的BUG改完了吗？\";\n            else if (now > 17 && now <= 19) text = \"傍晚了！窗外夕阳的景色很美丽呢，快带着心上人出去走走吧（没有心上人的可以来找Euphoria）～\";\n            else if (now > 19 && now <= 21) text = \"晚上好，今天过得怎么样？有没有被BUG折磨的痛并快乐着呢？\";\n            else if (now > 21 && now <= 23) text = [\"已经这么晚了呀，早点休息吧，晚安～\", \"深夜时要爱护眼睛呀！\"];\n            else text = [\"你是夜猫子呀？这么晚还不睡觉，明天起的来嘛？\", \"你现在可以找找Euphoria，说不定他也和你一样醒着呢～\"];\n        } else if (document.referrer !== \"\") {\n            var referrer = document.createElement(\"a\");\n            referrer.href = document.referrer;\n            var domain = referrer.hostname.split(\".\")[1];\n            if (location.hostname == referrer.hostname) text = `欢迎阅读<span style=\"color:#0099cc;\">『${document.title.split(\" - \")[0]}』</span>`;\n            else if (domain == \"baidu\") text = `Hello！来自 百度搜索 的朋友<br>你是搜索 <span style=\"color:#0099cc;\">${referrer.search.split(\"&wd=\")[1].split(\"&\")[0]}</span> 找到的我吗？`;\n            else if (domain == \"so\") text = `Hello！来自 360搜索 的朋友<br>你是搜索 <span style=\"color:#0099cc;\">${referrer.search.split(\"&q=\")[1].split(\"&\")[0]}</span> 找到的我吗？`;\n            else if (domain == \"google\") text = `Hello！来自 谷歌搜索 的朋友<br>欢迎阅读<span style=\"color:#0099cc;\">『${document.title.split(\" - \")[0]}』</span>`;\n            else text = `Hello！来自 <span style=\"color:#0099cc;\">${referrer.hostname}</span> 的朋友`;\n        } else {\n            text = `欢迎阅读<span style=\"color:#0099cc;\">『${document.title.split(\" - \")[0]}』</span>`;\n        }\n        showMessage(text, 7000, 8);\n    }\n\n    welcomeMessage();\n    //检测用户活动状态，并在空闲时定时显示一言\n    var userAction = false,\n        hitokotoTimer = null,\n        messageTimer = null,\n        messageArray = [\"好久不见，日子过得好快呢……\", \"大坏蛋！你都多久没碰人家了呀，嘤嘤嘤～\", \"嗨～快来逗我玩吧！\", \"哼！拿小拳拳锤你胸口！\"];\n    if ($(\".fa-share-alt\").is(\":hidden\")) messageArray.push(\"一定要记得把我加入Adblock白名单哦～\");\n    $(document).mousemove(() => {\n        userAction = true;\n    }).keydown(() => {\n        userAction = true;\n    });\n    setInterval(() => {\n        if (!userAction) {\n            if (!hitokotoTimer) hitokotoTimer = setInterval(showHitokoto, 25000);\n        } else {\n            userAction = false;\n            clearInterval(hitokotoTimer);\n            hitokotoTimer = null;\n        }\n    }, 1000);\n\n    function showHitokoto() {\n        //增加 hitokoto.cn 的 API\n        if (Math.random() < 0.6 && messageArray.length > 0) showMessage(messageArray[Math.floor(Math.random() * messageArray.length)], 6000, 9);\n        else $.getJSON(\"https://v1.hitokoto.cn\", function (result) {\n            var text = `这句一言来自 <span style=\"color:#0099cc;\">『${result.from}』</span>，是 <span style=\"color:#0099cc;\">${result.creator}</span> 在 hitokoto.cn 投稿的。`;\n            showMessage(result.hitokoto, 6000, 9);\n            setTimeout(() => {\n                showMessage(text, 4000, 9);\n            }, 6000);\n        });\n    }\n\n    function showMessage(text, timeout, priority) {\n        if (!text) return;\n        if (!sessionStorage.getItem(\"waifu-text\") || sessionStorage.getItem(\"waifu-text\") <= priority) {\n            if (messageTimer) {\n                clearTimeout(messageTimer);\n                messageTimer = null;\n            }\n            if (Array.isArray(text)) text = text[Math.floor(Math.random() * text.length)];\n            sessionStorage.setItem(\"waifu-text\", priority);\n            $(\"#waifu-tips\").stop().html(text).fadeTo(200, 1);\n            messageTimer = setTimeout(() => {\n                sessionStorage.removeItem(\"waifu-text\");\n                $(\"#waifu-tips\").fadeTo(1000, 0);\n            }, timeout);\n        }\n    }\n\n    function initModel() {\n        var modelId = localStorage.getItem(\"modelId\"),\n            modelTexturesId = localStorage.getItem(\"modelTexturesId\");\n        if (modelId == null) {\n            //首次访问加载 指定模型 的 指定材质\n            var modelId = 2, //模型 ID\n                modelTexturesId = 39; //材质 ID\n        }\n        loadModel(modelId, modelTexturesId);\n\n        demoWaifuPath = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/waifu-tips.json\";\n        $.getJSON(\"https://www.wqh4u.cn/live2d-widget/waifu-tips.json\", function (result) {\n            $.each(result.mouseover, function (index, tips) {\n                $(document).on(\"mouseover\", tips.selector, function () {\n                    var text = Array.isArray(tips.text) ? tips.text[Math.floor(Math.random() * tips.text.length)] : tips.text;\n                    text = text.replace(\"{text}\", $(this).text());\n                    showMessage(text, 4000, 8);\n                });\n            });\n            $.each(result.click, function (index, tips) {\n                $(document).on(\"click\", tips.selector, function () {\n                    var text = Array.isArray(tips.text) ? tips.text[Math.floor(Math.random() * tips.text.length)] : tips.text;\n                    text = text.replace(\"{text}\", $(this).text());\n                    showMessage(text, 4000, 8);\n                });\n            });\n            $.each(result.seasons, function (index, tips) {\n                var now = new Date(),\n                    after = tips.date.split(\"-\")[0],\n                    before = tips.date.split(\"-\")[1] || after;\n                if ((after.split(\"/\")[0] <= now.getMonth() + 1 && now.getMonth() + 1 <= before.split(\"/\")[0]) && (after.split(\"/\")[1] <= now.getDate() && now.getDate() <= before.split(\"/\")[1])) {\n                    var text = Array.isArray(tips.text) ? tips.text[Math.floor(Math.random() * tips.text.length)] : tips.text;\n                    text = text.replace(\"{year}\", now.getFullYear());\n                    //showMessage(text, 7000, true);\n                    messageArray.push(text);\n                }\n            });\n        });\n    }\n\n    initModel();\n\n    function loadModel(modelId, modelTexturesId) {\n        localStorage.setItem(\"modelId\", modelId);\n        if (modelTexturesId === undefined) modelTexturesId = 0;\n        localStorage.setItem(\"modelTexturesId\", modelTexturesId);\n        loadlive2d(\"live2d\", `${apiPath}/get/?id=${modelId}-${modelTexturesId}`, console.log(`Live2D 模型 ${modelId}-${modelTexturesId} 加载完成`));\n    }\n\n    function loadRandModel() {\n        var modelId = localStorage.getItem(\"modelId\"),\n            modelTexturesId = localStorage.getItem(\"modelTexturesId\");\n        //可选 \"rand\"(随机), \"switch\"(顺序)\n        $.ajax({\n            cache: false,\n            url: `${apiPath}/rand_textures/?id=${modelId}-${modelTexturesId}`,\n            dataType: \"json\",\n            success: function (result) {\n                if (result.textures[\"id\"] == 1 && (modelTexturesId == 1 || modelTexturesId == 0)) showMessage(\"我还没有其他衣服呢！大坏蛋快给人家增添衣服！\", 4000, 10);\n                else showMessage(\"我的新衣服好看嘛？嘻嘻～只要你觉得好看就好哦～\", 4000, 10);\n                loadModel(modelId, result.textures[\"id\"]);\n            }\n        });\n    }\n\n    function loadOtherModel() {\n        var modelId = localStorage.getItem(\"modelId\");\n        $.ajax({\n            cache: false,\n            url: `${apiPath}/switch/?id=${modelId}`,\n            dataType: \"json\",\n            success: function (result) {\n                loadModel(result.model[\"id\"]);\n                showMessage(result.model[\"message\"], 4000, 10);\n            }\n        });\n    }\n}\n\nfunction initWidget(waifuPath = \"/waifu-tips.json\", apiPath = \"\") {\n    if (screen.width <= 768) return;\n    $(\"body\").append(`<div id=\"waifu-toggle\" style=\"margin-left: -100px;\"><span>看板娘</span></div>`);\n    $(\"#waifu-toggle\").hover(() => {\n        $(\"#waifu-toggle\").animate({\"margin-left\": -30}, 500);\n    }, () => {\n        $(\"#waifu-toggle\").animate({\"margin-left\": -50}, 500);\n    }).click(() => {\n        $(\"#waifu-toggle\").animate({\"margin-left\": -100}, 1000, () => {\n            $(\"#waifu-toggle\").hide();\n        });\n        if ($(\"#waifu-toggle\").attr(\"first-time\")) {\n            loadWidget(waifuPath, apiPath);\n            $(\"#waifu-toggle\").attr(\"first-time\", false);\n        } else {\n            localStorage.removeItem(\"waifu-display\");\n            $(\"#waifu\").show().animate({bottom: 0}, 3000);\n        }\n    });\n    if (localStorage.getItem(\"waifu-display\") && new Date().getTime() - localStorage.getItem(\"waifu-display\") <= 86400000) {\n        $(\"#waifu-toggle\").attr(\"first-time\", true).css({\"margin-left\": -50});\n    } else {\n        loadWidget(waifuPath, apiPath);\n    }\n}\n","date":"2020-01-14T19:50:19.626Z","updated":"2020-01-14T19:50:19.626Z","path":"live2d-widget/waifu-tips.js","layout":"false","title":"","comments":1,"_id":"ck5obqn5g000d2lwjcfbahkwv","content":"/*\n * https://imjad.cn/archives/lab/add-dynamic-poster-girl-with-live2d-to-your-blog-02\n * https://www.fghrsh.net/post/123.html\n */\n\nfunction loadWidget(waifuPath, apiPath) {\n    localStorage.removeItem(\"waifu-display\");\n    sessionStorage.removeItem(\"waifu-text\");\n    $(\"body\").append(`<div id=\"waifu\">\n\t\t\t<div id=\"waifu-tips\"></div>\n\t\t\t<canvas id=\"live2d\" width=\"300\" height=\"300\"></canvas>\n\t\t\t<div id=\"waifu-tool\">\n\t\t\t\t<span class=\"fa fa-lg fa-comment\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-paper-plane\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-user-circle\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-street-view\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-camera-retro\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-info-circle\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-times\"></span>\n\t\t\t</div>\n\t\t</div>`);\n    $(\"#waifu\").show().animate({bottom: 0}, 3000);\n\n    function registerEventListener() {\n        $(\"#waifu-tool .fa-comment\").click(showHitokoto);\n        $(\"#waifu-tool .fa-paper-plane\").click(() => {\n            if (window.Asteroids) {\n                if (!window.ASTEROIDSPLAYERS) window.ASTEROIDSPLAYERS = [];\n                window.ASTEROIDSPLAYERS.push(new Asteroids());\n            } else {\n                $.ajax({\n                    url: \"https://cdn.jsdelivr.net/gh/GalaxyMimi/CDN/asteroids.js\",\n                    dataType: \"script\",\n                    cache: true\n                });\n            }\n        });\n        $(\"#waifu-tool .fa-user-circle\").click(loadOtherModel);\n        $(\"#waifu-tool .fa-street-view\").click(loadRandModel);\n        $(\"#waifu-tool .fa-camera-retro\").click(() => {\n            showMessage(\"照好了嘛，是不是很可爱呢？\", 6000, 9);\n            Live2D.captureName = \"photo.png\";\n            Live2D.captureFrame = true;\n        });\n        $(\"#waifu-tool .fa-info-circle\").click(() => {\n            open(\"https://github.com/stevenjoezhang/live2d-widget\");\n        });\n        $(\"#waifu-tool .fa-times\").click(() => {\n            localStorage.setItem(\"waifu-display\", new Date().getTime());\n            showMessage(\"愿你有一天能与重要的人重逢。\", 2000, 11);\n            $(\"#waifu\").animate({bottom: -500}, 3000, () => {\n                $(\"#waifu\").hide();\n                $(\"#waifu-toggle\").show().animate({\"margin-left\": -50}, 1000);\n            });\n        });\n        var re = /x/;\n        console.log(re);\n        re.toString = () => {\n            showMessage(\"哈哈，你打开了控制台，是想要看看我的小秘密吗？\", 6000, 9);\n            return \"\";\n        };\n        $(document).on(\"copy\", () => {\n            showMessage(\"你都复制了些什么呀，转载要记得加上出处哦！\", 6000, 9);\n        });\n        $(document).on(\"visibilitychange\", () => {\n            if (!document.hidden) showMessage(\"哇，好想你呀～你终于回来了～\", 6000, 9);\n        });\n    }\n\n    registerEventListener();\n\n    function welcomeMessage() {\n        var SiteIndexUrl = location.port ? `${location.protocol}//${location.hostname}:${location.port}/` : `${location.protocol}//${location.hostname}/`,\n            text; //自动获取主页\n        if (location.href == SiteIndexUrl) { //如果是主页\n            var now = new Date().getHours();\n            if (now > 5 && now <= 7) text=\"哇塞你醒的好早呀，Euphoria现在还应该在睡大觉吧！嘻嘻～\" ; else if (now> 7 && now <= 11) text=\"一日之际在于晨，快去叫醒我的主人Euphoria呀，他一定还在睡觉呢～\" ; else if (now> 11 && now <= 14) text=\"中午了，现在是午餐时间！我要吃好多好多好吃的～\" ; else if (now> 14 && now <= 17) text=\"午后很容易犯困呢，今天的BUG改完了吗？\" ; else if (now> 17 && now <= 19) text=\"傍晚了！窗外夕阳的景色很美丽呢，快带着心上人出去走走吧（没有心上人的可以来找Euphoria）～\" ; else if (now> 19 && now <= 21) text=\"晚上好，今天过得怎么样？有没有被BUG折磨的痛并快乐着呢？\" ; else if (now> 21 && now <= 23) text=\"[\"已经这么晚了呀，早点休息吧，晚安～\",\" \"深夜时要爱护眼睛呀！\"]; else \"你现在可以找找euphoria，说不定他也和你一样醒着呢～\"]; } if (document.referrer !=\"=\" \"\") { var referrer=\"document.createElement(\"a\");\" referrer.href=\"document.referrer;\" domain=\"referrer.hostname.split(\".\")[1];\" (location.hostname=\"=\" referrer.hostname) style=\"color:#0099cc;\">『${document.title.split(\" - \")[0]}』`;\n            else if (domain == \"baidu\") text = `Hello！来自 百度搜索 的朋友<br>你是搜索 <span style=\"color:#0099cc;\">${referrer.search.split(\"&wd=\")[1].split(\"&\")[0]}</span> 找到的我吗？`;\n            else if (domain == \"so\") text = `Hello！来自 360搜索 的朋友<br>你是搜索 <span style=\"color:#0099cc;\">${referrer.search.split(\"&q=\")[1].split(\"&\")[0]}</span> 找到的我吗？`;\n            else if (domain == \"google\") text = `Hello！来自 谷歌搜索 的朋友<br>欢迎阅读<span style=\"color:#0099cc;\">『${document.title.split(\" - \")[0]}』</span>`;\n            else text = `Hello！来自 <span style=\"color:#0099cc;\">${referrer.hostname}</span> 的朋友`;\n        } else {\n            text = `欢迎阅读<span style=\"color:#0099cc;\">『${document.title.split(\" - \")[0]}』</span>`;\n        }\n        showMessage(text, 7000, 8);\n    }\n\n    welcomeMessage();\n    //检测用户活动状态，并在空闲时定时显示一言\n    var userAction = false,\n        hitokotoTimer = null,\n        messageTimer = null,\n        messageArray = [\"好久不见，日子过得好快呢……\", \"大坏蛋！你都多久没碰人家了呀，嘤嘤嘤～\", \"嗨～快来逗我玩吧！\", \"哼！拿小拳拳锤你胸口！\"];\n    if ($(\".fa-share-alt\").is(\":hidden\")) messageArray.push(\"一定要记得把我加入Adblock白名单哦～\");\n    $(document).mousemove(() => {\n        userAction = true;\n    }).keydown(() => {\n        userAction = true;\n    });\n    setInterval(() => {\n        if (!userAction) {\n            if (!hitokotoTimer) hitokotoTimer = setInterval(showHitokoto, 25000);\n        } else {\n            userAction = false;\n            clearInterval(hitokotoTimer);\n            hitokotoTimer = null;\n        }\n    }, 1000);\n\n    function showHitokoto() {\n        //增加 hitokoto.cn 的 API\n        if (Math.random() < 0.6 && messageArray.length > 0) showMessage(messageArray[Math.floor(Math.random() * messageArray.length)], 6000, 9);\n        else $.getJSON(\"https://v1.hitokoto.cn\", function (result) {\n            var text = `这句一言来自 <span style=\"color:#0099cc;\">『${result.from}』</span>，是 <span style=\"color:#0099cc;\">${result.creator}</span> 在 hitokoto.cn 投稿的。`;\n            showMessage(result.hitokoto, 6000, 9);\n            setTimeout(() => {\n                showMessage(text, 4000, 9);\n            }, 6000);\n        });\n    }\n\n    function showMessage(text, timeout, priority) {\n        if (!text) return;\n        if (!sessionStorage.getItem(\"waifu-text\") || sessionStorage.getItem(\"waifu-text\") <= priority) { if (messagetimer) cleartimeout(messagetimer); messagetimer=\"null;\" } (array.isarray(text)) text=\"text[Math.floor(Math.random()\" * text.length)]; sessionstorage.setitem(\"waifu-text\", priority); $(\"#waifu-tips\").stop().html(text).fadeto(200, 1); => {\n                sessionStorage.removeItem(\"waifu-text\");\n                $(\"#waifu-tips\").fadeTo(1000, 0);\n            }, timeout);\n        }\n    }\n\n    function initModel() {\n        var modelId = localStorage.getItem(\"modelId\"),\n            modelTexturesId = localStorage.getItem(\"modelTexturesId\");\n        if (modelId == null) {\n            //首次访问加载 指定模型 的 指定材质\n            var modelId = 2, //模型 ID\n                modelTexturesId = 39; //材质 ID\n        }\n        loadModel(modelId, modelTexturesId);\n\n        demoWaifuPath = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/waifu-tips.json\";\n        $.getJSON(\"https://www.wqh4u.cn/live2d-widget/waifu-tips.json\", function (result) {\n            $.each(result.mouseover, function (index, tips) {\n                $(document).on(\"mouseover\", tips.selector, function () {\n                    var text = Array.isArray(tips.text) ? tips.text[Math.floor(Math.random() * tips.text.length)] : tips.text;\n                    text = text.replace(\"{text}\", $(this).text());\n                    showMessage(text, 4000, 8);\n                });\n            });\n            $.each(result.click, function (index, tips) {\n                $(document).on(\"click\", tips.selector, function () {\n                    var text = Array.isArray(tips.text) ? tips.text[Math.floor(Math.random() * tips.text.length)] : tips.text;\n                    text = text.replace(\"{text}\", $(this).text());\n                    showMessage(text, 4000, 8);\n                });\n            });\n            $.each(result.seasons, function (index, tips) {\n                var now = new Date(),\n                    after = tips.date.split(\"-\")[0],\n                    before = tips.date.split(\"-\")[1] || after;\n                if ((after.split(\"/\")[0] <= 1 now.getmonth() + && <=\"before.split(\"/\")[0])\" (after.split(\" \")[1] now.getdate() { var text=\"Array.isArray(tips.text)\" ? tips.text[math.floor(math.random() * tips.text.length)] : tips.text; now.getfullyear()); showmessage(text, 7000, true); messagearray.push(text); } }); initmodel(); function loadmodel(modelid, modeltexturesid) localstorage.setitem(\"modelid\", modelid); if (modeltexturesid=\"==\" undefined) modeltexturesid=\"0;\" localstorage.setitem(\"modeltexturesid\", modeltexturesid); loadlive2d(\"live2d\", `${apipath} get ?id=\"${modelId}-${modelTexturesId}`,\" console.log(`live2d 模型 ${modelid}-${modeltexturesid} 加载完成`)); loadrandmodel() modelid=\"localStorage.getItem(\"modelId\"),\" 可选 \"rand\"(随机), \"switch\"(顺序) $.ajax({ cache: false, url: rand_textures datatype: \"json\", success: (result) (result.textures[\"id\"]=\"=\" || 0)) showmessage(\"我还没有其他衣服呢！大坏蛋快给人家增添衣服！\", 4000, 10); else showmessage(\"我的新衣服好看嘛？嘻嘻～只要你觉得好看就好哦～\", result.textures[\"id\"]); loadothermodel() switch loadmodel(result.model[\"id\"]); showmessage(result.model[\"message\"], initwidget(waifupath=\"/waifu-tips.json\" , apipath ) (screen.width return; $(\"body\").append(`<div id=\"waifu-toggle\" style=\"margin-left: -100px;\"><span>看板娘</span>`);\n    $(\"#waifu-toggle\").hover(() => {\n        $(\"#waifu-toggle\").animate({\"margin-left\": -30}, 500);\n    }, () => {\n        $(\"#waifu-toggle\").animate({\"margin-left\": -50}, 500);\n    }).click(() => {\n        $(\"#waifu-toggle\").animate({\"margin-left\": -100}, 1000, () => {\n            $(\"#waifu-toggle\").hide();\n        });\n        if ($(\"#waifu-toggle\").attr(\"first-time\")) {\n            loadWidget(waifuPath, apiPath);\n            $(\"#waifu-toggle\").attr(\"first-time\", false);\n        } else {\n            localStorage.removeItem(\"waifu-display\");\n            $(\"#waifu\").show().animate({bottom: 0}, 3000);\n        }\n    });\n    if (localStorage.getItem(\"waifu-display\") && new Date().getTime() - localStorage.getItem(\"waifu-display\") </=></=></=></=></=></=></=></=></=>","site":{"data":{}},"length":3781,"excerpt":"","more":"/*\n * https://imjad.cn/archives/lab/add-dynamic-poster-girl-with-live2d-to-your-blog-02\n * https://www.fghrsh.net/post/123.html\n */\n\nfunction loadWidget(waifuPath, apiPath) {\n    localStorage.removeItem(\"waifu-display\");\n    sessionStorage.removeItem(\"waifu-text\");\n    $(\"body\").append(`<div id=\"waifu\">\n\t\t\t<div id=\"waifu-tips\"></div>\n\t\t\t<canvas id=\"live2d\" width=\"300\" height=\"300\"></canvas>\n\t\t\t<div id=\"waifu-tool\">\n\t\t\t\t<span class=\"fa fa-lg fa-comment\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-paper-plane\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-user-circle\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-street-view\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-camera-retro\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-info-circle\"></span>\n\t\t\t\t<span class=\"fa fa-lg fa-times\"></span>\n\t\t\t</div>\n\t\t</div>`);\n    $(\"#waifu\").show().animate({bottom: 0}, 3000);\n\n    function registerEventListener() {\n        $(\"#waifu-tool .fa-comment\").click(showHitokoto);\n        $(\"#waifu-tool .fa-paper-plane\").click(() => {\n            if (window.Asteroids) {\n                if (!window.ASTEROIDSPLAYERS) window.ASTEROIDSPLAYERS = [];\n                window.ASTEROIDSPLAYERS.push(new Asteroids());\n            } else {\n                $.ajax({\n                    url: \"https://cdn.jsdelivr.net/gh/GalaxyMimi/CDN/asteroids.js\",\n                    dataType: \"script\",\n                    cache: true\n                });\n            }\n        });\n        $(\"#waifu-tool .fa-user-circle\").click(loadOtherModel);\n        $(\"#waifu-tool .fa-street-view\").click(loadRandModel);\n        $(\"#waifu-tool .fa-camera-retro\").click(() => {\n            showMessage(\"照好了嘛，是不是很可爱呢？\", 6000, 9);\n            Live2D.captureName = \"photo.png\";\n            Live2D.captureFrame = true;\n        });\n        $(\"#waifu-tool .fa-info-circle\").click(() => {\n            open(\"https://github.com/stevenjoezhang/live2d-widget\");\n        });\n        $(\"#waifu-tool .fa-times\").click(() => {\n            localStorage.setItem(\"waifu-display\", new Date().getTime());\n            showMessage(\"愿你有一天能与重要的人重逢。\", 2000, 11);\n            $(\"#waifu\").animate({bottom: -500}, 3000, () => {\n                $(\"#waifu\").hide();\n                $(\"#waifu-toggle\").show().animate({\"margin-left\": -50}, 1000);\n            });\n        });\n        var re = /x/;\n        console.log(re);\n        re.toString = () => {\n            showMessage(\"哈哈，你打开了控制台，是想要看看我的小秘密吗？\", 6000, 9);\n            return \"\";\n        };\n        $(document).on(\"copy\", () => {\n            showMessage(\"你都复制了些什么呀，转载要记得加上出处哦！\", 6000, 9);\n        });\n        $(document).on(\"visibilitychange\", () => {\n            if (!document.hidden) showMessage(\"哇，好想你呀～你终于回来了～\", 6000, 9);\n        });\n    }\n\n    registerEventListener();\n\n    function welcomeMessage() {\n        var SiteIndexUrl = location.port ? `${location.protocol}//${location.hostname}:${location.port}/` : `${location.protocol}//${location.hostname}/`,\n            text; //自动获取主页\n        if (location.href == SiteIndexUrl) { //如果是主页\n            var now = new Date().getHours();\n            if (now > 5 && now <= 7) text=\"哇塞你醒的好早呀，Euphoria现在还应该在睡大觉吧！嘻嘻～\" ; else if (now> 7 && now <= 11) text=\"一日之际在于晨，快去叫醒我的主人Euphoria呀，他一定还在睡觉呢～\" ; else if (now> 11 && now <= 14) text=\"中午了，现在是午餐时间！我要吃好多好多好吃的～\" ; else if (now> 14 && now <= 17) text=\"午后很容易犯困呢，今天的BUG改完了吗？\" ; else if (now> 17 && now <= 19) text=\"傍晚了！窗外夕阳的景色很美丽呢，快带着心上人出去走走吧（没有心上人的可以来找Euphoria）～\" ; else if (now> 19 && now <= 21) text=\"晚上好，今天过得怎么样？有没有被BUG折磨的痛并快乐着呢？\" ; else if (now> 21 && now <= 23) text=\"[\"已经这么晚了呀，早点休息吧，晚安～\",\" \"深夜时要爱护眼睛呀！\"]; else \"你现在可以找找euphoria，说不定他也和你一样醒着呢～\"]; } if (document.referrer !=\"=\" \"\") { var referrer=\"document.createElement(\"a\");\" referrer.href=\"document.referrer;\" domain=\"referrer.hostname.split(\".\")[1];\" (location.hostname=\"=\" referrer.hostname) style=\"color:#0099cc;\">『${document.title.split(\" - \")[0]}』`;\n            else if (domain == \"baidu\") text = `Hello！来自 百度搜索 的朋友<br>你是搜索 <span style=\"color:#0099cc;\">${referrer.search.split(\"&wd=\")[1].split(\"&\")[0]}</span> 找到的我吗？`;\n            else if (domain == \"so\") text = `Hello！来自 360搜索 的朋友<br>你是搜索 <span style=\"color:#0099cc;\">${referrer.search.split(\"&q=\")[1].split(\"&\")[0]}</span> 找到的我吗？`;\n            else if (domain == \"google\") text = `Hello！来自 谷歌搜索 的朋友<br>欢迎阅读<span style=\"color:#0099cc;\">『${document.title.split(\" - \")[0]}』</span>`;\n            else text = `Hello！来自 <span style=\"color:#0099cc;\">${referrer.hostname}</span> 的朋友`;\n        } else {\n            text = `欢迎阅读<span style=\"color:#0099cc;\">『${document.title.split(\" - \")[0]}』</span>`;\n        }\n        showMessage(text, 7000, 8);\n    }\n\n    welcomeMessage();\n    //检测用户活动状态，并在空闲时定时显示一言\n    var userAction = false,\n        hitokotoTimer = null,\n        messageTimer = null,\n        messageArray = [\"好久不见，日子过得好快呢……\", \"大坏蛋！你都多久没碰人家了呀，嘤嘤嘤～\", \"嗨～快来逗我玩吧！\", \"哼！拿小拳拳锤你胸口！\"];\n    if ($(\".fa-share-alt\").is(\":hidden\")) messageArray.push(\"一定要记得把我加入Adblock白名单哦～\");\n    $(document).mousemove(() => {\n        userAction = true;\n    }).keydown(() => {\n        userAction = true;\n    });\n    setInterval(() => {\n        if (!userAction) {\n            if (!hitokotoTimer) hitokotoTimer = setInterval(showHitokoto, 25000);\n        } else {\n            userAction = false;\n            clearInterval(hitokotoTimer);\n            hitokotoTimer = null;\n        }\n    }, 1000);\n\n    function showHitokoto() {\n        //增加 hitokoto.cn 的 API\n        if (Math.random() < 0.6 && messageArray.length > 0) showMessage(messageArray[Math.floor(Math.random() * messageArray.length)], 6000, 9);\n        else $.getJSON(\"https://v1.hitokoto.cn\", function (result) {\n            var text = `这句一言来自 <span style=\"color:#0099cc;\">『${result.from}』</span>，是 <span style=\"color:#0099cc;\">${result.creator}</span> 在 hitokoto.cn 投稿的。`;\n            showMessage(result.hitokoto, 6000, 9);\n            setTimeout(() => {\n                showMessage(text, 4000, 9);\n            }, 6000);\n        });\n    }\n\n    function showMessage(text, timeout, priority) {\n        if (!text) return;\n        if (!sessionStorage.getItem(\"waifu-text\") || sessionStorage.getItem(\"waifu-text\") <= priority) { if (messagetimer) cleartimeout(messagetimer); messagetimer=\"null;\" } (array.isarray(text)) text=\"text[Math.floor(Math.random()\" * text.length)]; sessionstorage.setitem(\"waifu-text\", priority); $(\"#waifu-tips\").stop().html(text).fadeto(200, 1); => {\n                sessionStorage.removeItem(\"waifu-text\");\n                $(\"#waifu-tips\").fadeTo(1000, 0);\n            }, timeout);\n        }\n    }\n\n    function initModel() {\n        var modelId = localStorage.getItem(\"modelId\"),\n            modelTexturesId = localStorage.getItem(\"modelTexturesId\");\n        if (modelId == null) {\n            //首次访问加载 指定模型 的 指定材质\n            var modelId = 2, //模型 ID\n                modelTexturesId = 39; //材质 ID\n        }\n        loadModel(modelId, modelTexturesId);\n\n        demoWaifuPath = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/waifu-tips.json\";\n        $.getJSON(\"https://www.wqh4u.cn/live2d-widget/waifu-tips.json\", function (result) {\n            $.each(result.mouseover, function (index, tips) {\n                $(document).on(\"mouseover\", tips.selector, function () {\n                    var text = Array.isArray(tips.text) ? tips.text[Math.floor(Math.random() * tips.text.length)] : tips.text;\n                    text = text.replace(\"{text}\", $(this).text());\n                    showMessage(text, 4000, 8);\n                });\n            });\n            $.each(result.click, function (index, tips) {\n                $(document).on(\"click\", tips.selector, function () {\n                    var text = Array.isArray(tips.text) ? tips.text[Math.floor(Math.random() * tips.text.length)] : tips.text;\n                    text = text.replace(\"{text}\", $(this).text());\n                    showMessage(text, 4000, 8);\n                });\n            });\n            $.each(result.seasons, function (index, tips) {\n                var now = new Date(),\n                    after = tips.date.split(\"-\")[0],\n                    before = tips.date.split(\"-\")[1] || after;\n                if ((after.split(\"/\")[0] <= 1 now.getmonth() + && <=\"before.split(\"/\")[0])\" (after.split(\" \")[1] now.getdate() { var text=\"Array.isArray(tips.text)\" ? tips.text[math.floor(math.random() * tips.text.length)] : tips.text; now.getfullyear()); showmessage(text, 7000, true); messagearray.push(text); } }); initmodel(); function loadmodel(modelid, modeltexturesid) localstorage.setitem(\"modelid\", modelid); if (modeltexturesid=\"==\" undefined) modeltexturesid=\"0;\" localstorage.setitem(\"modeltexturesid\", modeltexturesid); loadlive2d(\"live2d\", `${apipath} get ?id=\"${modelId}-${modelTexturesId}`,\" console.log(`live2d 模型 ${modelid}-${modeltexturesid} 加载完成`)); loadrandmodel() modelid=\"localStorage.getItem(\"modelId\"),\" 可选 \"rand\"(随机), \"switch\"(顺序) $.ajax({ cache: false, url: rand_textures datatype: \"json\", success: (result) (result.textures[\"id\"]=\"=\" || 0)) showmessage(\"我还没有其他衣服呢！大坏蛋快给人家增添衣服！\", 4000, 10); else showmessage(\"我的新衣服好看嘛？嘻嘻～只要你觉得好看就好哦～\", result.textures[\"id\"]); loadothermodel() switch loadmodel(result.model[\"id\"]); showmessage(result.model[\"message\"], initwidget(waifupath=\"/waifu-tips.json\" , apipath ) (screen.width return; $(\"body\").append(`<div id=\"waifu-toggle\" style=\"margin-left: -100px;\"><span>看板娘</span>`);\n    $(\"#waifu-toggle\").hover(() => {\n        $(\"#waifu-toggle\").animate({\"margin-left\": -30}, 500);\n    }, () => {\n        $(\"#waifu-toggle\").animate({\"margin-left\": -50}, 500);\n    }).click(() => {\n        $(\"#waifu-toggle\").animate({\"margin-left\": -100}, 1000, () => {\n            $(\"#waifu-toggle\").hide();\n        });\n        if ($(\"#waifu-toggle\").attr(\"first-time\")) {\n            loadWidget(waifuPath, apiPath);\n            $(\"#waifu-toggle\").attr(\"first-time\", false);\n        } else {\n            localStorage.removeItem(\"waifu-display\");\n            $(\"#waifu\").show().animate({bottom: 0}, 3000);\n        }\n    });\n    if (localStorage.getItem(\"waifu-display\") && new Date().getTime() - localStorage.getItem(\"waifu-display\") </=></=></=></=></=></=></=></=></=>"},{"_content":"{\n  \"mouseover\": [\n    {\n      \"selector\": \"#waifu #live2d\",\n      \"text\": [\n        \"干嘛呢你，変態，快把手拿开！\",\n        \"你要干嘛呀？変態！\",\n        \"非礼呀！救命！\",\n        \"这样的话，只能让 Euphoria 使用武力了！\",\n        \"我要生气了哦！変態！\",\n        \"不要动手动脚的！\",\n        \"真…真的是不知羞耻！変態！\",\n        \"変態！ロリコン！痴漢！\",\n        \"啊啊啊啊是幺幺零嘛！这里有个人一直在摸我！\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-comment\",\n      \"text\": [\n        \"猜猜我要说些什么？\",\n        \"我从 Euphoria 那里听到了不少人生经验。\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-paper-plane\",\n      \"text\": [\n        \"要不要来玩飞机大战？\",\n        \"怎么，你想来和我玩个游戏？哼哼~\",\n        \"呼哈！化身小飞机！\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-user-circle\",\n      \"text\": [\n        \"你是不是不爱人家了呀，呜呜呜～\",\n        \"虽...虽然我知道我很烦，但是不要离开我呀嘤嘤嘤嘤嘤嘤！\",\n        \"你真的不要人家了嘛(委屈脸)...\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-street-view\",\n      \"text\": [\n        \"喜欢 COSPLAY 吗？\",\n        \"这次猜猜人家要扮演什么呢？\",\n        \"换衣服咯！\",\n        \"运气好了就能看到人家好看的衣服了呢\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-camera-retro\",\n      \"text\": [\n        \"你要给我拍照呀？一二三～嘿嘿嘿～\",\n        \"和人家合个影嘛！\",\n        \"哼！虽说拍照片人家也不是不喜欢的啦~\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-info-circle\",\n      \"text\": [\n        \"想要知道更多关于我的事么？\",\n        \"这里记录着我搬家的历史呢。\",\n        \"不要不要不要点进去哦~\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-times\",\n      \"text\": [\n        \"呜呜 QAQ 后会有期……\",\n        \"呜哇哇哇哇哇哇！！不要抛弃我呀……\",\n        \"哼，你会后悔的！\",\n        \"哼！活该单身！\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-home\",\n      \"text\": [\n        \"点击前往首页，想回到上一页可以使用浏览器的后退功能哦。\",\n        \"点它就可以回到首页啦！\",\n        \"回首页看看吧。\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-about\",\n      \"text\": [\n        \"你想知道我家主人是谁吗？\",\n        \"这里有一些关于我家主人的秘密哦，要不要看看呢？\",\n        \"发现主人出没地点！\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-tags\",\n      \"text\": [\n        \"点击就可以看文章的标签啦！\",\n        \"点击来查看所有标签哦。\",\n        \"快看看这里都有什么呢！\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-categories\",\n      \"text\": [\n        \"文章都分类好啦～\",\n        \"点击来查看文章分类哦。\",\n        \"快看看这里都有什么呢！\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-archives\",\n      \"text\": [\n        \"翻页比较麻烦吗，那就来看看文章归档吧。\",\n        \"文章目录都整理在这里啦！\",\n        \"快看看这里都有什么呢？\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-friends\",\n      \"text\": [\n        \"这是我的朋友们哦ヾ(◍°∇°◍)ﾉﾞ\",\n        \"要去大佬们的家看看吗？\",\n        \"要去拜访一下我的朋友们吗？\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-search\",\n      \"text\": [\n        \"找不到想看的内容？搜索看看吧！\",\n        \"在找什么东西呢，需要帮忙吗？\"\n      ]\n    },\n    {\n      \"selector\": \".site-author\",\n      \"text\": [\n        \"我家主人好看吗？\",\n        \"这是我家主人(*´∇｀*)\"\n      ]\n    },\n    {\n      \"selector\": \".site-state\",\n      \"text\": [\n        \"这是文章的统计信息～\",\n        \"要不要点进去看看？\"\n      ]\n    },\n    {\n      \"selector\": \".feed-link a\",\n      \"text\": [\n        \"这里可以使用 RSS 订阅呢！\",\n        \"利用 feed 订阅器，就能快速知道博客有没有更新了呢。\"\n      ]\n    },\n    {\n      \"selector\": \".cc-opacity, .post-copyright-author\",\n      \"text\": [\n        \"要记得规范转载哦。\",\n        \"所有文章均采用 CC BY-NC-SA 4.0 许可协议～\",\n        \"转载前要先注意下文章的版权协议呢。\"\n      ]\n    },\n    {\n      \"selector\": \".links-of-author\",\n      \"text\": [\n        \"这里是主人的常驻地址哦。\",\n        \"这里有主人的联系方式！\"\n      ]\n    },\n    {\n      \"selector\": \"#qrcode\",\n      \"text\": [\n        \"手机扫一下就能继续看，很方便呢～\",\n        \"扫一扫，打开新世界的大门！\"\n      ]\n    },\n    {\n      \"selector\": \".fancybox img, img.medium-zoom-image\",\n      \"text\": [\n        \"点击图片可以放大呢！\"\n      ]\n    },\n    {\n      \"selector\": \".highlight-wrap, .gist\",\n      \"text\": [\n        \"代码可以直接点击复制哟。\",\n        \"GitHub！我是新手！\"\n      ]\n    },\n    {\n      \"selector\": \".container a[href^='http'], .nav-link .nav-text\",\n      \"text\": [\n        \"要去看看 <span style=\\\"color:#0099cc;\\\">{text}</span> 么？\",\n        \"去 <span style=\\\"color:#0099cc;\\\">{text}</span> 逛逛吧。\",\n        \"到 <span style=\\\"color:#0099cc;\\\">{text}</span> 看看吧。\"\n      ]\n    },\n    {\n      \"selector\": \"a[href^='mailto']\",\n      \"text\": [\n        \"邮件我会及时回复的！\",\n        \"点击就可以发送邮件啦～\"\n      ]\n    },\n    {\n      \"selector\": \"a[href^='/tags/']\",\n      \"text\": [\n        \"要去看看 <span style=\\\"color:#0099cc;\\\">{text}</span> 标签么？\",\n        \"点它可以查看此标签下的所有文章哟！\"\n      ]\n    },\n    {\n      \"selector\": \"a[href^='/categories/']\",\n      \"text\": [\n        \"要去看看 <span style=\\\"color:#0099cc;\\\">{text}</span> 分类么？\",\n        \"点它可以查看此分类下的所有文章哟！\"\n      ]\n    },\n    {\n      \"selector\": \".post-title-link\",\n      \"text\": [\n        \"要看看 <span style=\\\"color:#0099cc;\\\">{text}</span> 这篇文章吗？\"\n      ]\n    },\n    {\n      \"selector\": \"a[rel='contents']\",\n      \"text\": [\n        \"点击来阅读全文哦。\"\n      ]\n    },\n    {\n      \"selector\": \"a[itemprop='discussionUrl']\",\n      \"text\": [\n        \"要去看看评论吗？\"\n      ]\n    },\n    {\n      \"selector\": \".back-to-top\",\n      \"text\": [\n        \"点它就可以回到顶部啦！\",\n        \"又回到最初的起点～\",\n        \"要回到开始的地方么？\"\n      ]\n    },\n    {\n      \"selector\": \"#rewardButton\",\n      \"text\": [\n        \"我是不是棒棒哒～快给我点赞吧！\",\n        \"要打赏我嘛？好期待啊～\",\n        \"主人最近在吃土呢，很辛苦的样子，给他一些钱钱吧～\"\n      ]\n    },\n    {\n      \"selector\": \"#wechat\",\n      \"text\": [\n        \"这是主人的微信二维码～\"\n      ]\n    },\n    {\n      \"selector\": \"#alipay\",\n      \"text\": [\n        \"这是主人的支付宝哦！\"\n      ]\n    },\n    {\n      \"selector\": \"#bitcoin\",\n      \"text\": [\n        \"这是主人的比特币账号！\"\n      ]\n    },\n    {\n      \"selector\": \"#needsharebutton-postbottom .btn\",\n      \"text\": [\n        \"好东西要让更多人知道才行哦。\",\n        \"觉得文章有帮助的话，可以分享给更多需要的朋友呢。\"\n      ]\n    },\n    {\n      \"selector\": \".need-share-button_weibo\",\n      \"text\": [\n        \"微博？来分享一波喵！\"\n      ]\n    },\n    {\n      \"selector\": \".need-share-button_wechat\",\n      \"text\": [\n        \"分享到微信吧！\"\n      ]\n    },\n    {\n      \"selector\": \".need-share-button_douban\",\n      \"text\": [\n        \"分享到豆瓣好像也不错！\"\n      ]\n    },\n    {\n      \"selector\": \".need-share-button_qqzone\",\n      \"text\": [\n        \"QQ空间，一键转发，耶～\"\n      ]\n    },\n    {\n      \"selector\": \".need-share-button_twitter\",\n      \"text\": [\n        \"Twitter？好像是不存在的东西？\"\n      ]\n    },\n    {\n      \"selector\": \".need-share-button_facebook\",\n      \"text\": [\n        \"emmm…FB好像也是不存在的东西？\"\n      ]\n    },\n    {\n      \"selector\": \".post-nav-next\",\n      \"text\": [\n        \"来看看下一篇文章吧。\",\n        \"点它可以看下一篇文章哦！\",\n        \"要翻到下一篇文章吗？\"\n      ]\n    },\n    {\n      \"selector\": \".post-nav-prev\",\n      \"text\": [\n        \"来看看上一篇文章吧。\",\n        \"点它可以看上一篇文章哦！\",\n        \"要翻到上一篇文章吗？\"\n      ]\n    },\n    {\n      \"selector\": \".extend.next\",\n      \"text\": [\n        \"去下一页看看吧。\",\n        \"点它可以前进哦！\",\n        \"要翻到下一页吗？\"\n      ]\n    },\n    {\n      \"selector\": \".extend.prev\",\n      \"text\": [\n        \"去上一页看看吧。\",\n        \"点它可以后退哦！\",\n        \"要翻到上一页吗？\"\n      ]\n    },\n    {\n      \"selector\": \"input.vnick\",\n      \"text\": [\n        \"该怎么称呼你呢？\",\n        \"留下你的尊姓大名！\"\n      ]\n    },\n    {\n      \"selector\": \".vmail\",\n      \"text\": [\n        \"留下你的邮箱，不然就是无头像人士了！\",\n        \"记得设置好 Gravatar 头像哦！\",\n        \"为了方便通知你最新消息，一定要留下邮箱！\"\n      ]\n    },\n    {\n      \"selector\": \".vlink\",\n      \"text\": [\n        \"快快告诉我你的家在哪里，好让我去参观参观！\"\n      ]\n    },\n    {\n      \"selector\": \".veditor\",\n      \"text\": [\n        \"想要去评论些什么吗？\",\n        \"要说点什么吗？\",\n        \"觉得博客不错？快来留言和主人交流吧！\"\n      ]\n    },\n    {\n      \"selector\": \".vcontrol a\",\n      \"text\": [\n        \"你会不会熟练使用Markdown呀？\",\n        \"使用Markdown让评论更美观吧～\"\n      ]\n    },\n    {\n      \"selector\": \".vemoji-btn\",\n      \"text\": [\n        \"要插入一个萌萌哒的表情吗？\",\n        \"要来一发表情吗？\"\n      ]\n    },\n    {\n      \"selector\": \".vpreview-btn\",\n      \"text\": [\n        \"要预览一下你的发言吗？\",\n        \"快看看你的评论有多少负熵！\"\n      ]\n    },\n    {\n      \"selector\": \".vsubmit\",\n      \"text\": [\n        \"评论没有审核，要对自己的发言负责哦～\",\n        \"要提交了吗，请耐心等待回复哦～\"\n      ]\n    },\n    {\n      \"selector\": \".vcontent\",\n      \"text\": [\n        \"哇，快看看这个精彩评论！\",\n        \"如果有疑问，请尽快留言哦～\"\n      ]\n    }\n  ],\n  \"click\": [\n    {\n      \"selector\": \"#waifu #live2d\",\n      \"text\": [\n        \"我才不相信你是不小心碰到的！\",\n        \"萝莉控！！！走开啦！！！\",\n        \"再摸的话我可要报警了！⌇●﹏●⌇\",\n        \"110嘛？这里有个变态一直在摸我！把他抓走呀！\",\n        \"不要摸我了，我会告诉主人来打你的！\",\n        \"干嘛动我呀！小心我咬你！嗷~呜~\",\n        \"别摸我，有什么好摸的！\",\n        \"変態！ロリコン！痴漢！\"\n      ]\n    },\n    {\n      \"selector\": \".veditor\",\n      \"text\": [\n        \"要吐槽些什么呢？\",\n        \"一定要认真填写喵～\",\n        \"有什么想说的吗？\"\n      ]\n    },\n    {\n      \"selector\": \".vsubmit\",\n      \"text\": [\n        \"输入验证码就可以提交评论啦～\"\n      ]\n    }\n  ],\n  \"seasons\": [\n    {\n      \"date\": \"01/01\",\n      \"text\": \"<span style=\\\"color:#0099cc;\\\">元旦</span>了呢，新的一年又开始了，今年是{year}年～\"\n    },\n    {\n      \"date\": \"02/14\",\n      \"text\": \"又是一年<span style=\\\"color:#0099cc;\\\">情人节</span>，{year}年找到对象了嘛～\"\n    },\n    {\n      \"date\": \"03/08\",\n      \"text\": \"今天是<span style=\\\"color:#0099cc;\\\">妇女节</span>！\"\n    },\n    {\n      \"date\": \"03/12\",\n      \"text\": \"今天是<span style=\\\"color:#0099cc;\\\">植树节</span>，要保护环境呀！\"\n    },\n    {\n      \"date\": \"04/01\",\n      \"text\": \"悄悄告诉你一个秘密～<span style=\\\"background-color:#34495e;\\\">今天是愚人节，不要被骗了哦～</span>\"\n    },\n    {\n      \"date\": \"05/01\",\n      \"text\": \"今天是<span style=\\\"color:#0099cc;\\\">五一劳动节</span>，计划好假期去哪里了吗～\"\n    },\n    {\n      \"date\": \"06/01\",\n      \"text\": \"<span style=\\\"color:#0099cc;\\\">儿童节</span>了呢，快活的时光总是短暂，要是永远长不大该多好啊…\"\n    },\n    {\n      \"date\": \"06/10\",\n      \"text\": \"难道？今天是<span style=\\\"color:#0099cc;\\\">那位大人</span>降临的日子！\"\n    },\n    {\n      \"date\": \"07/08\",\n      \"text\": \"<span style=\\\"color:#0099cc;\\\">2018</span> 年是多久之前来着……1，2，3……有好多好多天呢！我到主人家这么久啦\"\n    },\n    {\n      \"date\": \"09/03\",\n      \"text\": \"<span style=\\\"color:#0099cc;\\\">中国人民抗日战争胜利纪念日</span>，铭记历史、缅怀先烈、珍爱和平、开创未来。\"\n    },\n    {\n      \"date\": \"09/10\",\n      \"text\": \"<span style=\\\"color:#0099cc;\\\">教师节</span>，在学校要给老师问声好呀～\"\n    },\n    {\n      \"date\": \"10/01\",\n      \"text\": \"<span style=\\\"color:#0099cc;\\\">国庆节</span>到了，为祖国母亲庆生！\"\n    },\n    {\n      \"date\": \"11/05-11/12\",\n      \"text\": \"今年的<span style=\\\"color:#0099cc;\\\">双十一</span>是和谁一起过的呢～\"\n    },\n    {\n      \"date\": \"12/20-12/31\",\n      \"text\": \"这几天是<span style=\\\"color:#0099cc;\\\">圣诞节</span>，主人肯定又去剁手买买买了～\"\n    }\n  ]\n}\n","source":"live2d-widget/waifu-tips.json","raw":"{\n  \"mouseover\": [\n    {\n      \"selector\": \"#waifu #live2d\",\n      \"text\": [\n        \"干嘛呢你，変態，快把手拿开！\",\n        \"你要干嘛呀？変態！\",\n        \"非礼呀！救命！\",\n        \"这样的话，只能让 Euphoria 使用武力了！\",\n        \"我要生气了哦！変態！\",\n        \"不要动手动脚的！\",\n        \"真…真的是不知羞耻！変態！\",\n        \"変態！ロリコン！痴漢！\",\n        \"啊啊啊啊是幺幺零嘛！这里有个人一直在摸我！\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-comment\",\n      \"text\": [\n        \"猜猜我要说些什么？\",\n        \"我从 Euphoria 那里听到了不少人生经验。\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-paper-plane\",\n      \"text\": [\n        \"要不要来玩飞机大战？\",\n        \"怎么，你想来和我玩个游戏？哼哼~\",\n        \"呼哈！化身小飞机！\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-user-circle\",\n      \"text\": [\n        \"你是不是不爱人家了呀，呜呜呜～\",\n        \"虽...虽然我知道我很烦，但是不要离开我呀嘤嘤嘤嘤嘤嘤！\",\n        \"你真的不要人家了嘛(委屈脸)...\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-street-view\",\n      \"text\": [\n        \"喜欢 COSPLAY 吗？\",\n        \"这次猜猜人家要扮演什么呢？\",\n        \"换衣服咯！\",\n        \"运气好了就能看到人家好看的衣服了呢\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-camera-retro\",\n      \"text\": [\n        \"你要给我拍照呀？一二三～嘿嘿嘿～\",\n        \"和人家合个影嘛！\",\n        \"哼！虽说拍照片人家也不是不喜欢的啦~\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-info-circle\",\n      \"text\": [\n        \"想要知道更多关于我的事么？\",\n        \"这里记录着我搬家的历史呢。\",\n        \"不要不要不要点进去哦~\"\n      ]\n    },\n    {\n      \"selector\": \"#waifu-tool .fa-times\",\n      \"text\": [\n        \"呜呜 QAQ 后会有期……\",\n        \"呜哇哇哇哇哇哇！！不要抛弃我呀……\",\n        \"哼，你会后悔的！\",\n        \"哼！活该单身！\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-home\",\n      \"text\": [\n        \"点击前往首页，想回到上一页可以使用浏览器的后退功能哦。\",\n        \"点它就可以回到首页啦！\",\n        \"回首页看看吧。\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-about\",\n      \"text\": [\n        \"你想知道我家主人是谁吗？\",\n        \"这里有一些关于我家主人的秘密哦，要不要看看呢？\",\n        \"发现主人出没地点！\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-tags\",\n      \"text\": [\n        \"点击就可以看文章的标签啦！\",\n        \"点击来查看所有标签哦。\",\n        \"快看看这里都有什么呢！\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-categories\",\n      \"text\": [\n        \"文章都分类好啦～\",\n        \"点击来查看文章分类哦。\",\n        \"快看看这里都有什么呢！\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-archives\",\n      \"text\": [\n        \"翻页比较麻烦吗，那就来看看文章归档吧。\",\n        \"文章目录都整理在这里啦！\",\n        \"快看看这里都有什么呢？\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-friends\",\n      \"text\": [\n        \"这是我的朋友们哦ヾ(◍°∇°◍)ﾉﾞ\",\n        \"要去大佬们的家看看吗？\",\n        \"要去拜访一下我的朋友们吗？\"\n      ]\n    },\n    {\n      \"selector\": \".menu-item-search\",\n      \"text\": [\n        \"找不到想看的内容？搜索看看吧！\",\n        \"在找什么东西呢，需要帮忙吗？\"\n      ]\n    },\n    {\n      \"selector\": \".site-author\",\n      \"text\": [\n        \"我家主人好看吗？\",\n        \"这是我家主人(*´∇｀*)\"\n      ]\n    },\n    {\n      \"selector\": \".site-state\",\n      \"text\": [\n        \"这是文章的统计信息～\",\n        \"要不要点进去看看？\"\n      ]\n    },\n    {\n      \"selector\": \".feed-link a\",\n      \"text\": [\n        \"这里可以使用 RSS 订阅呢！\",\n        \"利用 feed 订阅器，就能快速知道博客有没有更新了呢。\"\n      ]\n    },\n    {\n      \"selector\": \".cc-opacity, .post-copyright-author\",\n      \"text\": [\n        \"要记得规范转载哦。\",\n        \"所有文章均采用 CC BY-NC-SA 4.0 许可协议～\",\n        \"转载前要先注意下文章的版权协议呢。\"\n      ]\n    },\n    {\n      \"selector\": \".links-of-author\",\n      \"text\": [\n        \"这里是主人的常驻地址哦。\",\n        \"这里有主人的联系方式！\"\n      ]\n    },\n    {\n      \"selector\": \"#qrcode\",\n      \"text\": [\n        \"手机扫一下就能继续看，很方便呢～\",\n        \"扫一扫，打开新世界的大门！\"\n      ]\n    },\n    {\n      \"selector\": \".fancybox img, img.medium-zoom-image\",\n      \"text\": [\n        \"点击图片可以放大呢！\"\n      ]\n    },\n    {\n      \"selector\": \".highlight-wrap, .gist\",\n      \"text\": [\n        \"代码可以直接点击复制哟。\",\n        \"GitHub！我是新手！\"\n      ]\n    },\n    {\n      \"selector\": \".container a[href^='http'], .nav-link .nav-text\",\n      \"text\": [\n        \"要去看看 <span style=\\\"color:#0099cc;\\\">{text}</span> 么？\",\n        \"去 <span style=\\\"color:#0099cc;\\\">{text}</span> 逛逛吧。\",\n        \"到 <span style=\\\"color:#0099cc;\\\">{text}</span> 看看吧。\"\n      ]\n    },\n    {\n      \"selector\": \"a[href^='mailto']\",\n      \"text\": [\n        \"邮件我会及时回复的！\",\n        \"点击就可以发送邮件啦～\"\n      ]\n    },\n    {\n      \"selector\": \"a[href^='/tags/']\",\n      \"text\": [\n        \"要去看看 <span style=\\\"color:#0099cc;\\\">{text}</span> 标签么？\",\n        \"点它可以查看此标签下的所有文章哟！\"\n      ]\n    },\n    {\n      \"selector\": \"a[href^='/categories/']\",\n      \"text\": [\n        \"要去看看 <span style=\\\"color:#0099cc;\\\">{text}</span> 分类么？\",\n        \"点它可以查看此分类下的所有文章哟！\"\n      ]\n    },\n    {\n      \"selector\": \".post-title-link\",\n      \"text\": [\n        \"要看看 <span style=\\\"color:#0099cc;\\\">{text}</span> 这篇文章吗？\"\n      ]\n    },\n    {\n      \"selector\": \"a[rel='contents']\",\n      \"text\": [\n        \"点击来阅读全文哦。\"\n      ]\n    },\n    {\n      \"selector\": \"a[itemprop='discussionUrl']\",\n      \"text\": [\n        \"要去看看评论吗？\"\n      ]\n    },\n    {\n      \"selector\": \".back-to-top\",\n      \"text\": [\n        \"点它就可以回到顶部啦！\",\n        \"又回到最初的起点～\",\n        \"要回到开始的地方么？\"\n      ]\n    },\n    {\n      \"selector\": \"#rewardButton\",\n      \"text\": [\n        \"我是不是棒棒哒～快给我点赞吧！\",\n        \"要打赏我嘛？好期待啊～\",\n        \"主人最近在吃土呢，很辛苦的样子，给他一些钱钱吧～\"\n      ]\n    },\n    {\n      \"selector\": \"#wechat\",\n      \"text\": [\n        \"这是主人的微信二维码～\"\n      ]\n    },\n    {\n      \"selector\": \"#alipay\",\n      \"text\": [\n        \"这是主人的支付宝哦！\"\n      ]\n    },\n    {\n      \"selector\": \"#bitcoin\",\n      \"text\": [\n        \"这是主人的比特币账号！\"\n      ]\n    },\n    {\n      \"selector\": \"#needsharebutton-postbottom .btn\",\n      \"text\": [\n        \"好东西要让更多人知道才行哦。\",\n        \"觉得文章有帮助的话，可以分享给更多需要的朋友呢。\"\n      ]\n    },\n    {\n      \"selector\": \".need-share-button_weibo\",\n      \"text\": [\n        \"微博？来分享一波喵！\"\n      ]\n    },\n    {\n      \"selector\": \".need-share-button_wechat\",\n      \"text\": [\n        \"分享到微信吧！\"\n      ]\n    },\n    {\n      \"selector\": \".need-share-button_douban\",\n      \"text\": [\n        \"分享到豆瓣好像也不错！\"\n      ]\n    },\n    {\n      \"selector\": \".need-share-button_qqzone\",\n      \"text\": [\n        \"QQ空间，一键转发，耶～\"\n      ]\n    },\n    {\n      \"selector\": \".need-share-button_twitter\",\n      \"text\": [\n        \"Twitter？好像是不存在的东西？\"\n      ]\n    },\n    {\n      \"selector\": \".need-share-button_facebook\",\n      \"text\": [\n        \"emmm…FB好像也是不存在的东西？\"\n      ]\n    },\n    {\n      \"selector\": \".post-nav-next\",\n      \"text\": [\n        \"来看看下一篇文章吧。\",\n        \"点它可以看下一篇文章哦！\",\n        \"要翻到下一篇文章吗？\"\n      ]\n    },\n    {\n      \"selector\": \".post-nav-prev\",\n      \"text\": [\n        \"来看看上一篇文章吧。\",\n        \"点它可以看上一篇文章哦！\",\n        \"要翻到上一篇文章吗？\"\n      ]\n    },\n    {\n      \"selector\": \".extend.next\",\n      \"text\": [\n        \"去下一页看看吧。\",\n        \"点它可以前进哦！\",\n        \"要翻到下一页吗？\"\n      ]\n    },\n    {\n      \"selector\": \".extend.prev\",\n      \"text\": [\n        \"去上一页看看吧。\",\n        \"点它可以后退哦！\",\n        \"要翻到上一页吗？\"\n      ]\n    },\n    {\n      \"selector\": \"input.vnick\",\n      \"text\": [\n        \"该怎么称呼你呢？\",\n        \"留下你的尊姓大名！\"\n      ]\n    },\n    {\n      \"selector\": \".vmail\",\n      \"text\": [\n        \"留下你的邮箱，不然就是无头像人士了！\",\n        \"记得设置好 Gravatar 头像哦！\",\n        \"为了方便通知你最新消息，一定要留下邮箱！\"\n      ]\n    },\n    {\n      \"selector\": \".vlink\",\n      \"text\": [\n        \"快快告诉我你的家在哪里，好让我去参观参观！\"\n      ]\n    },\n    {\n      \"selector\": \".veditor\",\n      \"text\": [\n        \"想要去评论些什么吗？\",\n        \"要说点什么吗？\",\n        \"觉得博客不错？快来留言和主人交流吧！\"\n      ]\n    },\n    {\n      \"selector\": \".vcontrol a\",\n      \"text\": [\n        \"你会不会熟练使用Markdown呀？\",\n        \"使用Markdown让评论更美观吧～\"\n      ]\n    },\n    {\n      \"selector\": \".vemoji-btn\",\n      \"text\": [\n        \"要插入一个萌萌哒的表情吗？\",\n        \"要来一发表情吗？\"\n      ]\n    },\n    {\n      \"selector\": \".vpreview-btn\",\n      \"text\": [\n        \"要预览一下你的发言吗？\",\n        \"快看看你的评论有多少负熵！\"\n      ]\n    },\n    {\n      \"selector\": \".vsubmit\",\n      \"text\": [\n        \"评论没有审核，要对自己的发言负责哦～\",\n        \"要提交了吗，请耐心等待回复哦～\"\n      ]\n    },\n    {\n      \"selector\": \".vcontent\",\n      \"text\": [\n        \"哇，快看看这个精彩评论！\",\n        \"如果有疑问，请尽快留言哦～\"\n      ]\n    }\n  ],\n  \"click\": [\n    {\n      \"selector\": \"#waifu #live2d\",\n      \"text\": [\n        \"我才不相信你是不小心碰到的！\",\n        \"萝莉控！！！走开啦！！！\",\n        \"再摸的话我可要报警了！⌇●﹏●⌇\",\n        \"110嘛？这里有个变态一直在摸我！把他抓走呀！\",\n        \"不要摸我了，我会告诉主人来打你的！\",\n        \"干嘛动我呀！小心我咬你！嗷~呜~\",\n        \"别摸我，有什么好摸的！\",\n        \"変態！ロリコン！痴漢！\"\n      ]\n    },\n    {\n      \"selector\": \".veditor\",\n      \"text\": [\n        \"要吐槽些什么呢？\",\n        \"一定要认真填写喵～\",\n        \"有什么想说的吗？\"\n      ]\n    },\n    {\n      \"selector\": \".vsubmit\",\n      \"text\": [\n        \"输入验证码就可以提交评论啦～\"\n      ]\n    }\n  ],\n  \"seasons\": [\n    {\n      \"date\": \"01/01\",\n      \"text\": \"<span style=\\\"color:#0099cc;\\\">元旦</span>了呢，新的一年又开始了，今年是{year}年～\"\n    },\n    {\n      \"date\": \"02/14\",\n      \"text\": \"又是一年<span style=\\\"color:#0099cc;\\\">情人节</span>，{year}年找到对象了嘛～\"\n    },\n    {\n      \"date\": \"03/08\",\n      \"text\": \"今天是<span style=\\\"color:#0099cc;\\\">妇女节</span>！\"\n    },\n    {\n      \"date\": \"03/12\",\n      \"text\": \"今天是<span style=\\\"color:#0099cc;\\\">植树节</span>，要保护环境呀！\"\n    },\n    {\n      \"date\": \"04/01\",\n      \"text\": \"悄悄告诉你一个秘密～<span style=\\\"background-color:#34495e;\\\">今天是愚人节，不要被骗了哦～</span>\"\n    },\n    {\n      \"date\": \"05/01\",\n      \"text\": \"今天是<span style=\\\"color:#0099cc;\\\">五一劳动节</span>，计划好假期去哪里了吗～\"\n    },\n    {\n      \"date\": \"06/01\",\n      \"text\": \"<span style=\\\"color:#0099cc;\\\">儿童节</span>了呢，快活的时光总是短暂，要是永远长不大该多好啊…\"\n    },\n    {\n      \"date\": \"06/10\",\n      \"text\": \"难道？今天是<span style=\\\"color:#0099cc;\\\">那位大人</span>降临的日子！\"\n    },\n    {\n      \"date\": \"07/08\",\n      \"text\": \"<span style=\\\"color:#0099cc;\\\">2018</span> 年是多久之前来着……1，2，3……有好多好多天呢！我到主人家这么久啦\"\n    },\n    {\n      \"date\": \"09/03\",\n      \"text\": \"<span style=\\\"color:#0099cc;\\\">中国人民抗日战争胜利纪念日</span>，铭记历史、缅怀先烈、珍爱和平、开创未来。\"\n    },\n    {\n      \"date\": \"09/10\",\n      \"text\": \"<span style=\\\"color:#0099cc;\\\">教师节</span>，在学校要给老师问声好呀～\"\n    },\n    {\n      \"date\": \"10/01\",\n      \"text\": \"<span style=\\\"color:#0099cc;\\\">国庆节</span>到了，为祖国母亲庆生！\"\n    },\n    {\n      \"date\": \"11/05-11/12\",\n      \"text\": \"今年的<span style=\\\"color:#0099cc;\\\">双十一</span>是和谁一起过的呢～\"\n    },\n    {\n      \"date\": \"12/20-12/31\",\n      \"text\": \"这几天是<span style=\\\"color:#0099cc;\\\">圣诞节</span>，主人肯定又去剁手买买买了～\"\n    }\n  ]\n}\n","date":"2020-01-14T19:50:19.782Z","updated":"2020-01-14T19:50:19.782Z","path":"live2d-widget/waifu-tips.json","layout":"false","title":"","comments":1,"_id":"ck5obqn5h000f2lwj9clw49ti","content":"{\"mouseover\":[{\"selector\":\"#waifu #live2d\",\"text\":[\"干嘛呢你，変態，快把手拿开！\",\"你要干嘛呀？変態！\",\"非礼呀！救命！\",\"这样的话，只能让 Euphoria 使用武力了！\",\"我要生气了哦！変態！\",\"不要动手动脚的！\",\"真…真的是不知羞耻！変態！\",\"変態！ロリコン！痴漢！\",\"啊啊啊啊是幺幺零嘛！这里有个人一直在摸我！\"]},{\"selector\":\"#waifu-tool .fa-comment\",\"text\":[\"猜猜我要说些什么？\",\"我从 Euphoria 那里听到了不少人生经验。\"]},{\"selector\":\"#waifu-tool .fa-paper-plane\",\"text\":[\"要不要来玩飞机大战？\",\"怎么，你想来和我玩个游戏？哼哼~\",\"呼哈！化身小飞机！\"]},{\"selector\":\"#waifu-tool .fa-user-circle\",\"text\":[\"你是不是不爱人家了呀，呜呜呜～\",\"虽...虽然我知道我很烦，但是不要离开我呀嘤嘤嘤嘤嘤嘤！\",\"你真的不要人家了嘛(委屈脸)...\"]},{\"selector\":\"#waifu-tool .fa-street-view\",\"text\":[\"喜欢 COSPLAY 吗？\",\"这次猜猜人家要扮演什么呢？\",\"换衣服咯！\",\"运气好了就能看到人家好看的衣服了呢\"]},{\"selector\":\"#waifu-tool .fa-camera-retro\",\"text\":[\"你要给我拍照呀？一二三～嘿嘿嘿～\",\"和人家合个影嘛！\",\"哼！虽说拍照片人家也不是不喜欢的啦~\"]},{\"selector\":\"#waifu-tool .fa-info-circle\",\"text\":[\"想要知道更多关于我的事么？\",\"这里记录着我搬家的历史呢。\",\"不要不要不要点进去哦~\"]},{\"selector\":\"#waifu-tool .fa-times\",\"text\":[\"呜呜 QAQ 后会有期……\",\"呜哇哇哇哇哇哇！！不要抛弃我呀……\",\"哼，你会后悔的！\",\"哼！活该单身！\"]},{\"selector\":\".menu-item-home\",\"text\":[\"点击前往首页，想回到上一页可以使用浏览器的后退功能哦。\",\"点它就可以回到首页啦！\",\"回首页看看吧。\"]},{\"selector\":\".menu-item-about\",\"text\":[\"你想知道我家主人是谁吗？\",\"这里有一些关于我家主人的秘密哦，要不要看看呢？\",\"发现主人出没地点！\"]},{\"selector\":\".menu-item-tags\",\"text\":[\"点击就可以看文章的标签啦！\",\"点击来查看所有标签哦。\",\"快看看这里都有什么呢！\"]},{\"selector\":\".menu-item-categories\",\"text\":[\"文章都分类好啦～\",\"点击来查看文章分类哦。\",\"快看看这里都有什么呢！\"]},{\"selector\":\".menu-item-archives\",\"text\":[\"翻页比较麻烦吗，那就来看看文章归档吧。\",\"文章目录都整理在这里啦！\",\"快看看这里都有什么呢？\"]},{\"selector\":\".menu-item-friends\",\"text\":[\"这是我的朋友们哦ヾ(◍°∇°◍)ﾉﾞ\",\"要去大佬们的家看看吗？\",\"要去拜访一下我的朋友们吗？\"]},{\"selector\":\".menu-item-search\",\"text\":[\"找不到想看的内容？搜索看看吧！\",\"在找什么东西呢，需要帮忙吗？\"]},{\"selector\":\".site-author\",\"text\":[\"我家主人好看吗？\",\"这是我家主人(*´∇｀*)\"]},{\"selector\":\".site-state\",\"text\":[\"这是文章的统计信息～\",\"要不要点进去看看？\"]},{\"selector\":\".feed-link a\",\"text\":[\"这里可以使用 RSS 订阅呢！\",\"利用 feed 订阅器，就能快速知道博客有没有更新了呢。\"]},{\"selector\":\".cc-opacity, .post-copyright-author\",\"text\":[\"要记得规范转载哦。\",\"所有文章均采用 CC BY-NC-SA 4.0 许可协议～\",\"转载前要先注意下文章的版权协议呢。\"]},{\"selector\":\".links-of-author\",\"text\":[\"这里是主人的常驻地址哦。\",\"这里有主人的联系方式！\"]},{\"selector\":\"#qrcode\",\"text\":[\"手机扫一下就能继续看，很方便呢～\",\"扫一扫，打开新世界的大门！\"]},{\"selector\":\".fancybox img, img.medium-zoom-image\",\"text\":[\"点击图片可以放大呢！\"]},{\"selector\":\".highlight-wrap, .gist\",\"text\":[\"代码可以直接点击复制哟。\",\"GitHub！我是新手！\"]},{\"selector\":\".container a[href^='http'], .nav-link .nav-text\",\"text\":[\"要去看看 <span style=\"\\\"color:#0099cc;\\\"\">{text}</span> 么？\",\"去 <span style=\"\\\"color:#0099cc;\\\"\">{text}</span> 逛逛吧。\",\"到 <span style=\"\\\"color:#0099cc;\\\"\">{text}</span> 看看吧。\"]},{\"selector\":\"a[href^='mailto']\",\"text\":[\"邮件我会及时回复的！\",\"点击就可以发送邮件啦～\"]},{\"selector\":\"a[href^='/tags/']\",\"text\":[\"要去看看 <span style=\"\\\"color:#0099cc;\\\"\">{text}</span> 标签么？\",\"点它可以查看此标签下的所有文章哟！\"]},{\"selector\":\"a[href^='/categories/']\",\"text\":[\"要去看看 <span style=\"\\\"color:#0099cc;\\\"\">{text}</span> 分类么？\",\"点它可以查看此分类下的所有文章哟！\"]},{\"selector\":\".post-title-link\",\"text\":[\"要看看 <span style=\"\\\"color:#0099cc;\\\"\">{text}</span> 这篇文章吗？\"]},{\"selector\":\"a[rel='contents']\",\"text\":[\"点击来阅读全文哦。\"]},{\"selector\":\"a[itemprop='discussionUrl']\",\"text\":[\"要去看看评论吗？\"]},{\"selector\":\".back-to-top\",\"text\":[\"点它就可以回到顶部啦！\",\"又回到最初的起点～\",\"要回到开始的地方么？\"]},{\"selector\":\"#rewardButton\",\"text\":[\"我是不是棒棒哒～快给我点赞吧！\",\"要打赏我嘛？好期待啊～\",\"主人最近在吃土呢，很辛苦的样子，给他一些钱钱吧～\"]},{\"selector\":\"#wechat\",\"text\":[\"这是主人的微信二维码～\"]},{\"selector\":\"#alipay\",\"text\":[\"这是主人的支付宝哦！\"]},{\"selector\":\"#bitcoin\",\"text\":[\"这是主人的比特币账号！\"]},{\"selector\":\"#needsharebutton-postbottom .btn\",\"text\":[\"好东西要让更多人知道才行哦。\",\"觉得文章有帮助的话，可以分享给更多需要的朋友呢。\"]},{\"selector\":\".need-share-button_weibo\",\"text\":[\"微博？来分享一波喵！\"]},{\"selector\":\".need-share-button_wechat\",\"text\":[\"分享到微信吧！\"]},{\"selector\":\".need-share-button_douban\",\"text\":[\"分享到豆瓣好像也不错！\"]},{\"selector\":\".need-share-button_qqzone\",\"text\":[\"QQ空间，一键转发，耶～\"]},{\"selector\":\".need-share-button_twitter\",\"text\":[\"Twitter？好像是不存在的东西？\"]},{\"selector\":\".need-share-button_facebook\",\"text\":[\"emmm…FB好像也是不存在的东西？\"]},{\"selector\":\".post-nav-next\",\"text\":[\"来看看下一篇文章吧。\",\"点它可以看下一篇文章哦！\",\"要翻到下一篇文章吗？\"]},{\"selector\":\".post-nav-prev\",\"text\":[\"来看看上一篇文章吧。\",\"点它可以看上一篇文章哦！\",\"要翻到上一篇文章吗？\"]},{\"selector\":\".extend.next\",\"text\":[\"去下一页看看吧。\",\"点它可以前进哦！\",\"要翻到下一页吗？\"]},{\"selector\":\".extend.prev\",\"text\":[\"去上一页看看吧。\",\"点它可以后退哦！\",\"要翻到上一页吗？\"]},{\"selector\":\"input.vnick\",\"text\":[\"该怎么称呼你呢？\",\"留下你的尊姓大名！\"]},{\"selector\":\".vmail\",\"text\":[\"留下你的邮箱，不然就是无头像人士了！\",\"记得设置好 Gravatar 头像哦！\",\"为了方便通知你最新消息，一定要留下邮箱！\"]},{\"selector\":\".vlink\",\"text\":[\"快快告诉我你的家在哪里，好让我去参观参观！\"]},{\"selector\":\".veditor\",\"text\":[\"想要去评论些什么吗？\",\"要说点什么吗？\",\"觉得博客不错？快来留言和主人交流吧！\"]},{\"selector\":\".vcontrol a\",\"text\":[\"你会不会熟练使用Markdown呀？\",\"使用Markdown让评论更美观吧～\"]},{\"selector\":\".vemoji-btn\",\"text\":[\"要插入一个萌萌哒的表情吗？\",\"要来一发表情吗？\"]},{\"selector\":\".vpreview-btn\",\"text\":[\"要预览一下你的发言吗？\",\"快看看你的评论有多少负熵！\"]},{\"selector\":\".vsubmit\",\"text\":[\"评论没有审核，要对自己的发言负责哦～\",\"要提交了吗，请耐心等待回复哦～\"]},{\"selector\":\".vcontent\",\"text\":[\"哇，快看看这个精彩评论！\",\"如果有疑问，请尽快留言哦～\"]}],\"click\":[{\"selector\":\"#waifu #live2d\",\"text\":[\"我才不相信你是不小心碰到的！\",\"萝莉控！！！走开啦！！！\",\"再摸的话我可要报警了！⌇●﹏●⌇\",\"110嘛？这里有个变态一直在摸我！把他抓走呀！\",\"不要摸我了，我会告诉主人来打你的！\",\"干嘛动我呀！小心我咬你！嗷~呜~\",\"别摸我，有什么好摸的！\",\"変態！ロリコン！痴漢！\"]},{\"selector\":\".veditor\",\"text\":[\"要吐槽些什么呢？\",\"一定要认真填写喵～\",\"有什么想说的吗？\"]},{\"selector\":\".vsubmit\",\"text\":[\"输入验证码就可以提交评论啦～\"]}],\"seasons\":[{\"date\":\"01/01\",\"text\":\"<span style=\"\\\"color:#0099cc;\\\"\">元旦</span>了呢，新的一年又开始了，今年是{year}年～\"},{\"date\":\"02/14\",\"text\":\"又是一年<span style=\"\\\"color:#0099cc;\\\"\">情人节</span>，{year}年找到对象了嘛～\"},{\"date\":\"03/08\",\"text\":\"今天是<span style=\"\\\"color:#0099cc;\\\"\">妇女节</span>！\"},{\"date\":\"03/12\",\"text\":\"今天是<span style=\"\\\"color:#0099cc;\\\"\">植树节</span>，要保护环境呀！\"},{\"date\":\"04/01\",\"text\":\"悄悄告诉你一个秘密～<span style=\"\\\"background-color:#34495e;\\\"\">今天是愚人节，不要被骗了哦～</span>\"},{\"date\":\"05/01\",\"text\":\"今天是<span style=\"\\\"color:#0099cc;\\\"\">五一劳动节</span>，计划好假期去哪里了吗～\"},{\"date\":\"06/01\",\"text\":\"<span style=\"\\\"color:#0099cc;\\\"\">儿童节</span>了呢，快活的时光总是短暂，要是永远长不大该多好啊…\"},{\"date\":\"06/10\",\"text\":\"难道？今天是<span style=\"\\\"color:#0099cc;\\\"\">那位大人</span>降临的日子！\"},{\"date\":\"07/08\",\"text\":\"<span style=\"\\\"color:#0099cc;\\\"\">2018</span> 年是多久之前来着……1，2，3……有好多好多天呢！我到主人家这么久啦\"},{\"date\":\"09/03\",\"text\":\"<span style=\"\\\"color:#0099cc;\\\"\">中国人民抗日战争胜利纪念日</span>，铭记历史、缅怀先烈、珍爱和平、开创未来。\"},{\"date\":\"09/10\",\"text\":\"<span style=\"\\\"color:#0099cc;\\\"\">教师节</span>，在学校要给老师问声好呀～\"},{\"date\":\"10/01\",\"text\":\"<span style=\"\\\"color:#0099cc;\\\"\">国庆节</span>到了，为祖国母亲庆生！\"},{\"date\":\"11/05-11/12\",\"text\":\"今年的<span style=\"\\\"color:#0099cc;\\\"\">双十一</span>是和谁一起过的呢～\"},{\"date\":\"12/20-12/31\",\"text\":\"这几天是<span style=\"\\\"color:#0099cc;\\\"\">圣诞节</span>，主人肯定又去剁手买买买了～\"}]}","site":{"data":{}},"length":5400,"excerpt":"","more":"{\"mouseover\":[{\"selector\":\"#waifu #live2d\",\"text\":[\"干嘛呢你，変態，快把手拿开！\",\"你要干嘛呀？変態！\",\"非礼呀！救命！\",\"这样的话，只能让 Euphoria 使用武力了！\",\"我要生气了哦！変態！\",\"不要动手动脚的！\",\"真…真的是不知羞耻！変態！\",\"変態！ロリコン！痴漢！\",\"啊啊啊啊是幺幺零嘛！这里有个人一直在摸我！\"]},{\"selector\":\"#waifu-tool .fa-comment\",\"text\":[\"猜猜我要说些什么？\",\"我从 Euphoria 那里听到了不少人生经验。\"]},{\"selector\":\"#waifu-tool .fa-paper-plane\",\"text\":[\"要不要来玩飞机大战？\",\"怎么，你想来和我玩个游戏？哼哼~\",\"呼哈！化身小飞机！\"]},{\"selector\":\"#waifu-tool .fa-user-circle\",\"text\":[\"你是不是不爱人家了呀，呜呜呜～\",\"虽...虽然我知道我很烦，但是不要离开我呀嘤嘤嘤嘤嘤嘤！\",\"你真的不要人家了嘛(委屈脸)...\"]},{\"selector\":\"#waifu-tool .fa-street-view\",\"text\":[\"喜欢 COSPLAY 吗？\",\"这次猜猜人家要扮演什么呢？\",\"换衣服咯！\",\"运气好了就能看到人家好看的衣服了呢\"]},{\"selector\":\"#waifu-tool .fa-camera-retro\",\"text\":[\"你要给我拍照呀？一二三～嘿嘿嘿～\",\"和人家合个影嘛！\",\"哼！虽说拍照片人家也不是不喜欢的啦~\"]},{\"selector\":\"#waifu-tool .fa-info-circle\",\"text\":[\"想要知道更多关于我的事么？\",\"这里记录着我搬家的历史呢。\",\"不要不要不要点进去哦~\"]},{\"selector\":\"#waifu-tool .fa-times\",\"text\":[\"呜呜 QAQ 后会有期……\",\"呜哇哇哇哇哇哇！！不要抛弃我呀……\",\"哼，你会后悔的！\",\"哼！活该单身！\"]},{\"selector\":\".menu-item-home\",\"text\":[\"点击前往首页，想回到上一页可以使用浏览器的后退功能哦。\",\"点它就可以回到首页啦！\",\"回首页看看吧。\"]},{\"selector\":\".menu-item-about\",\"text\":[\"你想知道我家主人是谁吗？\",\"这里有一些关于我家主人的秘密哦，要不要看看呢？\",\"发现主人出没地点！\"]},{\"selector\":\".menu-item-tags\",\"text\":[\"点击就可以看文章的标签啦！\",\"点击来查看所有标签哦。\",\"快看看这里都有什么呢！\"]},{\"selector\":\".menu-item-categories\",\"text\":[\"文章都分类好啦～\",\"点击来查看文章分类哦。\",\"快看看这里都有什么呢！\"]},{\"selector\":\".menu-item-archives\",\"text\":[\"翻页比较麻烦吗，那就来看看文章归档吧。\",\"文章目录都整理在这里啦！\",\"快看看这里都有什么呢？\"]},{\"selector\":\".menu-item-friends\",\"text\":[\"这是我的朋友们哦ヾ(◍°∇°◍)ﾉﾞ\",\"要去大佬们的家看看吗？\",\"要去拜访一下我的朋友们吗？\"]},{\"selector\":\".menu-item-search\",\"text\":[\"找不到想看的内容？搜索看看吧！\",\"在找什么东西呢，需要帮忙吗？\"]},{\"selector\":\".site-author\",\"text\":[\"我家主人好看吗？\",\"这是我家主人(*´∇｀*)\"]},{\"selector\":\".site-state\",\"text\":[\"这是文章的统计信息～\",\"要不要点进去看看？\"]},{\"selector\":\".feed-link a\",\"text\":[\"这里可以使用 RSS 订阅呢！\",\"利用 feed 订阅器，就能快速知道博客有没有更新了呢。\"]},{\"selector\":\".cc-opacity, .post-copyright-author\",\"text\":[\"要记得规范转载哦。\",\"所有文章均采用 CC BY-NC-SA 4.0 许可协议～\",\"转载前要先注意下文章的版权协议呢。\"]},{\"selector\":\".links-of-author\",\"text\":[\"这里是主人的常驻地址哦。\",\"这里有主人的联系方式！\"]},{\"selector\":\"#qrcode\",\"text\":[\"手机扫一下就能继续看，很方便呢～\",\"扫一扫，打开新世界的大门！\"]},{\"selector\":\".fancybox img, img.medium-zoom-image\",\"text\":[\"点击图片可以放大呢！\"]},{\"selector\":\".highlight-wrap, .gist\",\"text\":[\"代码可以直接点击复制哟。\",\"GitHub！我是新手！\"]},{\"selector\":\".container a[href^='http'], .nav-link .nav-text\",\"text\":[\"要去看看 <span style=\"\\\"color:#0099cc;\\\"\">{text}</span> 么？\",\"去 <span style=\"\\\"color:#0099cc;\\\"\">{text}</span> 逛逛吧。\",\"到 <span style=\"\\\"color:#0099cc;\\\"\">{text}</span> 看看吧。\"]},{\"selector\":\"a[href^='mailto']\",\"text\":[\"邮件我会及时回复的！\",\"点击就可以发送邮件啦～\"]},{\"selector\":\"a[href^='/tags/']\",\"text\":[\"要去看看 <span style=\"\\\"color:#0099cc;\\\"\">{text}</span> 标签么？\",\"点它可以查看此标签下的所有文章哟！\"]},{\"selector\":\"a[href^='/categories/']\",\"text\":[\"要去看看 <span style=\"\\\"color:#0099cc;\\\"\">{text}</span> 分类么？\",\"点它可以查看此分类下的所有文章哟！\"]},{\"selector\":\".post-title-link\",\"text\":[\"要看看 <span style=\"\\\"color:#0099cc;\\\"\">{text}</span> 这篇文章吗？\"]},{\"selector\":\"a[rel='contents']\",\"text\":[\"点击来阅读全文哦。\"]},{\"selector\":\"a[itemprop='discussionUrl']\",\"text\":[\"要去看看评论吗？\"]},{\"selector\":\".back-to-top\",\"text\":[\"点它就可以回到顶部啦！\",\"又回到最初的起点～\",\"要回到开始的地方么？\"]},{\"selector\":\"#rewardButton\",\"text\":[\"我是不是棒棒哒～快给我点赞吧！\",\"要打赏我嘛？好期待啊～\",\"主人最近在吃土呢，很辛苦的样子，给他一些钱钱吧～\"]},{\"selector\":\"#wechat\",\"text\":[\"这是主人的微信二维码～\"]},{\"selector\":\"#alipay\",\"text\":[\"这是主人的支付宝哦！\"]},{\"selector\":\"#bitcoin\",\"text\":[\"这是主人的比特币账号！\"]},{\"selector\":\"#needsharebutton-postbottom .btn\",\"text\":[\"好东西要让更多人知道才行哦。\",\"觉得文章有帮助的话，可以分享给更多需要的朋友呢。\"]},{\"selector\":\".need-share-button_weibo\",\"text\":[\"微博？来分享一波喵！\"]},{\"selector\":\".need-share-button_wechat\",\"text\":[\"分享到微信吧！\"]},{\"selector\":\".need-share-button_douban\",\"text\":[\"分享到豆瓣好像也不错！\"]},{\"selector\":\".need-share-button_qqzone\",\"text\":[\"QQ空间，一键转发，耶～\"]},{\"selector\":\".need-share-button_twitter\",\"text\":[\"Twitter？好像是不存在的东西？\"]},{\"selector\":\".need-share-button_facebook\",\"text\":[\"emmm…FB好像也是不存在的东西？\"]},{\"selector\":\".post-nav-next\",\"text\":[\"来看看下一篇文章吧。\",\"点它可以看下一篇文章哦！\",\"要翻到下一篇文章吗？\"]},{\"selector\":\".post-nav-prev\",\"text\":[\"来看看上一篇文章吧。\",\"点它可以看上一篇文章哦！\",\"要翻到上一篇文章吗？\"]},{\"selector\":\".extend.next\",\"text\":[\"去下一页看看吧。\",\"点它可以前进哦！\",\"要翻到下一页吗？\"]},{\"selector\":\".extend.prev\",\"text\":[\"去上一页看看吧。\",\"点它可以后退哦！\",\"要翻到上一页吗？\"]},{\"selector\":\"input.vnick\",\"text\":[\"该怎么称呼你呢？\",\"留下你的尊姓大名！\"]},{\"selector\":\".vmail\",\"text\":[\"留下你的邮箱，不然就是无头像人士了！\",\"记得设置好 Gravatar 头像哦！\",\"为了方便通知你最新消息，一定要留下邮箱！\"]},{\"selector\":\".vlink\",\"text\":[\"快快告诉我你的家在哪里，好让我去参观参观！\"]},{\"selector\":\".veditor\",\"text\":[\"想要去评论些什么吗？\",\"要说点什么吗？\",\"觉得博客不错？快来留言和主人交流吧！\"]},{\"selector\":\".vcontrol a\",\"text\":[\"你会不会熟练使用Markdown呀？\",\"使用Markdown让评论更美观吧～\"]},{\"selector\":\".vemoji-btn\",\"text\":[\"要插入一个萌萌哒的表情吗？\",\"要来一发表情吗？\"]},{\"selector\":\".vpreview-btn\",\"text\":[\"要预览一下你的发言吗？\",\"快看看你的评论有多少负熵！\"]},{\"selector\":\".vsubmit\",\"text\":[\"评论没有审核，要对自己的发言负责哦～\",\"要提交了吗，请耐心等待回复哦～\"]},{\"selector\":\".vcontent\",\"text\":[\"哇，快看看这个精彩评论！\",\"如果有疑问，请尽快留言哦～\"]}],\"click\":[{\"selector\":\"#waifu #live2d\",\"text\":[\"我才不相信你是不小心碰到的！\",\"萝莉控！！！走开啦！！！\",\"再摸的话我可要报警了！⌇●﹏●⌇\",\"110嘛？这里有个变态一直在摸我！把他抓走呀！\",\"不要摸我了，我会告诉主人来打你的！\",\"干嘛动我呀！小心我咬你！嗷~呜~\",\"别摸我，有什么好摸的！\",\"変態！ロリコン！痴漢！\"]},{\"selector\":\".veditor\",\"text\":[\"要吐槽些什么呢？\",\"一定要认真填写喵～\",\"有什么想说的吗？\"]},{\"selector\":\".vsubmit\",\"text\":[\"输入验证码就可以提交评论啦～\"]}],\"seasons\":[{\"date\":\"01/01\",\"text\":\"<span style=\"\\\"color:#0099cc;\\\"\">元旦</span>了呢，新的一年又开始了，今年是{year}年～\"},{\"date\":\"02/14\",\"text\":\"又是一年<span style=\"\\\"color:#0099cc;\\\"\">情人节</span>，{year}年找到对象了嘛～\"},{\"date\":\"03/08\",\"text\":\"今天是<span style=\"\\\"color:#0099cc;\\\"\">妇女节</span>！\"},{\"date\":\"03/12\",\"text\":\"今天是<span style=\"\\\"color:#0099cc;\\\"\">植树节</span>，要保护环境呀！\"},{\"date\":\"04/01\",\"text\":\"悄悄告诉你一个秘密～<span style=\"\\\"background-color:#34495e;\\\"\">今天是愚人节，不要被骗了哦～</span>\"},{\"date\":\"05/01\",\"text\":\"今天是<span style=\"\\\"color:#0099cc;\\\"\">五一劳动节</span>，计划好假期去哪里了吗～\"},{\"date\":\"06/01\",\"text\":\"<span style=\"\\\"color:#0099cc;\\\"\">儿童节</span>了呢，快活的时光总是短暂，要是永远长不大该多好啊…\"},{\"date\":\"06/10\",\"text\":\"难道？今天是<span style=\"\\\"color:#0099cc;\\\"\">那位大人</span>降临的日子！\"},{\"date\":\"07/08\",\"text\":\"<span style=\"\\\"color:#0099cc;\\\"\">2018</span> 年是多久之前来着……1，2，3……有好多好多天呢！我到主人家这么久啦\"},{\"date\":\"09/03\",\"text\":\"<span style=\"\\\"color:#0099cc;\\\"\">中国人民抗日战争胜利纪念日</span>，铭记历史、缅怀先烈、珍爱和平、开创未来。\"},{\"date\":\"09/10\",\"text\":\"<span style=\"\\\"color:#0099cc;\\\"\">教师节</span>，在学校要给老师问声好呀～\"},{\"date\":\"10/01\",\"text\":\"<span style=\"\\\"color:#0099cc;\\\"\">国庆节</span>到了，为祖国母亲庆生！\"},{\"date\":\"11/05-11/12\",\"text\":\"今年的<span style=\"\\\"color:#0099cc;\\\"\">双十一</span>是和谁一起过的呢～\"},{\"date\":\"12/20-12/31\",\"text\":\"这几天是<span style=\"\\\"color:#0099cc;\\\"\">圣诞节</span>，主人肯定又去剁手买买买了～\"}]}"},{"_content":"#waifu-toggle {\n\tposition: fixed;\n\twriting-mode: vertical-rl;\n\tbottom: 66px;\n\tleft: 9px;\n\tbackground-color: #fa0;\n\tcolor: #fff;\n\tborder-radius: 5px;\n\tpadding: 5px 2px 5px 5px;\n\tfont-size: 12px;\n\twidth: 60px;\n\tcursor: pointer;\n\t-webkit-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n}\n#waifu {\n\tposition: fixed;\n\tbottom: -1000px;\n\tright: 0;\n\tz-index: 1;\n\tline-height: 0;\n\ttransition: transform .3s ease-in-out;\n\ttransform: translateY(3px);\n}\n#waifu:hover {\n\ttransform: translateY(0);\n}\n@media (max-width: 768px) {\n\t#waifu {\n\t\tdisplay: none;\n\t}\n}\n#waifu-tips {\n\topacity: 0;\n\twidth: 250px;\n\tmin-height: 70px;\n\tmargin: -30px 20px;\n\tpadding: 5px 10px;\n\tborder: 1px solid rgba(224, 186, 140, 0.92);\n\tborder-radius: 12px;\n\tbackground-color: rgba(236, 217, 188, 0.9);\n\tbox-shadow: 0 3px 15px 2px rgba(191, 158, 118, 0.25);\n\tfont-size: 14px;\n\tline-height: 24px;\n\tword-break: break-all;\n\ttext-overflow: ellipsis;\n\toverflow: hidden;\n\tposition: absolute;\n\tanimation: shake 50s ease-in-out 5s infinite;\n\t-webkit-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n}\n#waifu #live2d {\n\tposition: relative;\n\tcursor: grab;\n\tcursor: -webkit-grab;\n\tcursor: -o-grab;\n\tcursor: -ms-grab;\n}\n#waifu #live2d:active {\n\tcursor: grabbing;\n\tcursor: -webkit-grabbing;\n\tcursor: -o-grabbing;\n\tcursor: -ms-grabbing;\n}\n#waifu-tool {\n\tcolor: #e8e8e8;\n\ttext-shadow: black 1px 1px 1px;\n\ttop: 70px;\n\tleft: -10px;\n\tposition: absolute;\n\topacity: 0;\n\ttransition: opacity 1s;\n}\n#waifu:hover #waifu-tool {\n\topacity: 1;\n}\n#waifu-tool span {\n\tdisplay: block;\n\tcursor: pointer;\n\tline-height: 30px;\n\ttext-align: center;\n\tcolor: #e8e8e8;\n\ttransition: color .3s;\n}\n#waifu-tool span:hover {\n\tcolor: #0684bd;/* #34495e */\n}\n@keyframes shake {\n\t2% {\n\t\ttransform: translate(0.5px, -1.5px) rotate(-0.5deg);\n\t}\n\t4% {\n\t\ttransform: translate(0.5px, 1.5px) rotate(1.5deg);\n\t}\n\t6% {\n\t\ttransform: translate(1.5px, 1.5px) rotate(1.5deg);\n\t}\n\t8% {\n\t\ttransform: translate(2.5px, 1.5px) rotate(0.5deg);\n\t}\n\t10% {\n\t\ttransform: translate(0.5px, 2.5px) rotate(0.5deg);\n\t}\n\t12% {\n\t\ttransform: translate(1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t14% {\n\t\ttransform: translate(0.5px, 0.5px) rotate(0.5deg);\n\t}\n\t16% {\n\t\ttransform: translate(-1.5px, -0.5px) rotate(1.5deg);\n\t}\n\t18% {\n\t\ttransform: translate(0.5px, 0.5px) rotate(1.5deg);\n\t}\n\t20% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(1.5deg);\n\t}\n\t22% {\n\t\ttransform: translate(0.5px, -1.5px) rotate(1.5deg);\n\t}\n\t24% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(-0.5deg);\n\t}\n\t26% {\n\t\ttransform: translate(1.5px, 0.5px) rotate(1.5deg);\n\t}\n\t28% {\n\t\ttransform: translate(-0.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t30% {\n\t\ttransform: translate(1.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t32% {\n\t\ttransform: translate(2.5px, -1.5px) rotate(1.5deg);\n\t}\n\t34% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(-0.5deg);\n\t}\n\t36% {\n\t\ttransform: translate(0.5px, -1.5px) rotate(0.5deg);\n\t}\n\t38% {\n\t\ttransform: translate(2.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t40% {\n\t\ttransform: translate(-0.5px, 2.5px) rotate(0.5deg);\n\t}\n\t42% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(0.5deg);\n\t}\n\t44% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t46% {\n\t\ttransform: translate(1.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t48% {\n\t\ttransform: translate(2.5px, -0.5px) rotate(0.5deg);\n\t}\n\t50% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t52% {\n\t\ttransform: translate(-0.5px, 1.5px) rotate(0.5deg);\n\t}\n\t54% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t56% {\n\t\ttransform: translate(0.5px, 2.5px) rotate(1.5deg);\n\t}\n\t58% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(0.5deg);\n\t}\n\t60% {\n\t\ttransform: translate(2.5px, -1.5px) rotate(1.5deg);\n\t}\n\t62% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(1.5deg);\n\t}\n\t64% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(1.5deg);\n\t}\n\t66% {\n\t\ttransform: translate(0.5px, 2.5px) rotate(1.5deg);\n\t}\n\t68% {\n\t\ttransform: translate(2.5px, -1.5px) rotate(1.5deg);\n\t}\n\t70% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(0.5deg);\n\t}\n\t72% {\n\t\ttransform: translate(-0.5px, -1.5px) rotate(1.5deg);\n\t}\n\t74% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(1.5deg);\n\t}\n\t76% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(1.5deg);\n\t}\n\t78% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(0.5deg);\n\t}\n\t80% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(-0.5deg);\n\t}\n\t82% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(-0.5deg);\n\t}\n\t84% {\n\t\ttransform: translate(-0.5px, 0.5px) rotate(1.5deg);\n\t}\n\t86% {\n\t\ttransform: translate(2.5px, 1.5px) rotate(0.5deg);\n\t}\n\t88% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(1.5deg);\n\t}\n\t90% {\n\t\ttransform: translate(-1.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t92% {\n\t\ttransform: translate(-1.5px, -1.5px) rotate(1.5deg);\n\t}\n\t94% {\n\t\ttransform: translate(0.5px, 0.5px) rotate(-0.5deg);\n\t}\n\t96% {\n\t\ttransform: translate(2.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t98% {\n\t\ttransform: translate(-1.5px, -1.5px) rotate(-0.5deg);\n\t}\n\t0%, 100% {\n\t\ttransform: translate(0, 0) rotate(0deg);\n\t}\n}\n","source":"live2d-widget/waifu.css","raw":"#waifu-toggle {\n\tposition: fixed;\n\twriting-mode: vertical-rl;\n\tbottom: 66px;\n\tleft: 9px;\n\tbackground-color: #fa0;\n\tcolor: #fff;\n\tborder-radius: 5px;\n\tpadding: 5px 2px 5px 5px;\n\tfont-size: 12px;\n\twidth: 60px;\n\tcursor: pointer;\n\t-webkit-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n}\n#waifu {\n\tposition: fixed;\n\tbottom: -1000px;\n\tright: 0;\n\tz-index: 1;\n\tline-height: 0;\n\ttransition: transform .3s ease-in-out;\n\ttransform: translateY(3px);\n}\n#waifu:hover {\n\ttransform: translateY(0);\n}\n@media (max-width: 768px) {\n\t#waifu {\n\t\tdisplay: none;\n\t}\n}\n#waifu-tips {\n\topacity: 0;\n\twidth: 250px;\n\tmin-height: 70px;\n\tmargin: -30px 20px;\n\tpadding: 5px 10px;\n\tborder: 1px solid rgba(224, 186, 140, 0.92);\n\tborder-radius: 12px;\n\tbackground-color: rgba(236, 217, 188, 0.9);\n\tbox-shadow: 0 3px 15px 2px rgba(191, 158, 118, 0.25);\n\tfont-size: 14px;\n\tline-height: 24px;\n\tword-break: break-all;\n\ttext-overflow: ellipsis;\n\toverflow: hidden;\n\tposition: absolute;\n\tanimation: shake 50s ease-in-out 5s infinite;\n\t-webkit-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n}\n#waifu #live2d {\n\tposition: relative;\n\tcursor: grab;\n\tcursor: -webkit-grab;\n\tcursor: -o-grab;\n\tcursor: -ms-grab;\n}\n#waifu #live2d:active {\n\tcursor: grabbing;\n\tcursor: -webkit-grabbing;\n\tcursor: -o-grabbing;\n\tcursor: -ms-grabbing;\n}\n#waifu-tool {\n\tcolor: #e8e8e8;\n\ttext-shadow: black 1px 1px 1px;\n\ttop: 70px;\n\tleft: -10px;\n\tposition: absolute;\n\topacity: 0;\n\ttransition: opacity 1s;\n}\n#waifu:hover #waifu-tool {\n\topacity: 1;\n}\n#waifu-tool span {\n\tdisplay: block;\n\tcursor: pointer;\n\tline-height: 30px;\n\ttext-align: center;\n\tcolor: #e8e8e8;\n\ttransition: color .3s;\n}\n#waifu-tool span:hover {\n\tcolor: #0684bd;/* #34495e */\n}\n@keyframes shake {\n\t2% {\n\t\ttransform: translate(0.5px, -1.5px) rotate(-0.5deg);\n\t}\n\t4% {\n\t\ttransform: translate(0.5px, 1.5px) rotate(1.5deg);\n\t}\n\t6% {\n\t\ttransform: translate(1.5px, 1.5px) rotate(1.5deg);\n\t}\n\t8% {\n\t\ttransform: translate(2.5px, 1.5px) rotate(0.5deg);\n\t}\n\t10% {\n\t\ttransform: translate(0.5px, 2.5px) rotate(0.5deg);\n\t}\n\t12% {\n\t\ttransform: translate(1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t14% {\n\t\ttransform: translate(0.5px, 0.5px) rotate(0.5deg);\n\t}\n\t16% {\n\t\ttransform: translate(-1.5px, -0.5px) rotate(1.5deg);\n\t}\n\t18% {\n\t\ttransform: translate(0.5px, 0.5px) rotate(1.5deg);\n\t}\n\t20% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(1.5deg);\n\t}\n\t22% {\n\t\ttransform: translate(0.5px, -1.5px) rotate(1.5deg);\n\t}\n\t24% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(-0.5deg);\n\t}\n\t26% {\n\t\ttransform: translate(1.5px, 0.5px) rotate(1.5deg);\n\t}\n\t28% {\n\t\ttransform: translate(-0.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t30% {\n\t\ttransform: translate(1.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t32% {\n\t\ttransform: translate(2.5px, -1.5px) rotate(1.5deg);\n\t}\n\t34% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(-0.5deg);\n\t}\n\t36% {\n\t\ttransform: translate(0.5px, -1.5px) rotate(0.5deg);\n\t}\n\t38% {\n\t\ttransform: translate(2.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t40% {\n\t\ttransform: translate(-0.5px, 2.5px) rotate(0.5deg);\n\t}\n\t42% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(0.5deg);\n\t}\n\t44% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t46% {\n\t\ttransform: translate(1.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t48% {\n\t\ttransform: translate(2.5px, -0.5px) rotate(0.5deg);\n\t}\n\t50% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t52% {\n\t\ttransform: translate(-0.5px, 1.5px) rotate(0.5deg);\n\t}\n\t54% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t56% {\n\t\ttransform: translate(0.5px, 2.5px) rotate(1.5deg);\n\t}\n\t58% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(0.5deg);\n\t}\n\t60% {\n\t\ttransform: translate(2.5px, -1.5px) rotate(1.5deg);\n\t}\n\t62% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(1.5deg);\n\t}\n\t64% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(1.5deg);\n\t}\n\t66% {\n\t\ttransform: translate(0.5px, 2.5px) rotate(1.5deg);\n\t}\n\t68% {\n\t\ttransform: translate(2.5px, -1.5px) rotate(1.5deg);\n\t}\n\t70% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(0.5deg);\n\t}\n\t72% {\n\t\ttransform: translate(-0.5px, -1.5px) rotate(1.5deg);\n\t}\n\t74% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(1.5deg);\n\t}\n\t76% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(1.5deg);\n\t}\n\t78% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(0.5deg);\n\t}\n\t80% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(-0.5deg);\n\t}\n\t82% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(-0.5deg);\n\t}\n\t84% {\n\t\ttransform: translate(-0.5px, 0.5px) rotate(1.5deg);\n\t}\n\t86% {\n\t\ttransform: translate(2.5px, 1.5px) rotate(0.5deg);\n\t}\n\t88% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(1.5deg);\n\t}\n\t90% {\n\t\ttransform: translate(-1.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t92% {\n\t\ttransform: translate(-1.5px, -1.5px) rotate(1.5deg);\n\t}\n\t94% {\n\t\ttransform: translate(0.5px, 0.5px) rotate(-0.5deg);\n\t}\n\t96% {\n\t\ttransform: translate(2.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t98% {\n\t\ttransform: translate(-1.5px, -1.5px) rotate(-0.5deg);\n\t}\n\t0%, 100% {\n\t\ttransform: translate(0, 0) rotate(0deg);\n\t}\n}\n","date":"2020-01-19T16:00:54.565Z","updated":"2020-01-19T16:00:54.565Z","path":"live2d-widget/waifu.css","layout":"false","title":"","comments":1,"_id":"ck5obqn5j000h2lwj0fp0epn8","content":"#waifu-toggle {\n\tposition: fixed;\n\twriting-mode: vertical-rl;\n\tbottom: 66px;\n\tleft: 9px;\n\tbackground-color: #fa0;\n\tcolor: #fff;\n\tborder-radius: 5px;\n\tpadding: 5px 2px 5px 5px;\n\tfont-size: 12px;\n\twidth: 60px;\n\tcursor: pointer;\n\t-webkit-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n}\n#waifu {\n\tposition: fixed;\n\tbottom: -1000px;\n\tright: 0;\n\tz-index: 1;\n\tline-height: 0;\n\ttransition: transform .3s ease-in-out;\n\ttransform: translateY(3px);\n}\n#waifu:hover {\n\ttransform: translateY(0);\n}\n@media (max-width: 768px) {\n\t#waifu {\n\t\tdisplay: none;\n\t}\n}\n#waifu-tips {\n\topacity: 0;\n\twidth: 250px;\n\tmin-height: 70px;\n\tmargin: -30px 20px;\n\tpadding: 5px 10px;\n\tborder: 1px solid rgba(224, 186, 140, 0.92);\n\tborder-radius: 12px;\n\tbackground-color: rgba(236, 217, 188, 0.9);\n\tbox-shadow: 0 3px 15px 2px rgba(191, 158, 118, 0.25);\n\tfont-size: 14px;\n\tline-height: 24px;\n\tword-break: break-all;\n\ttext-overflow: ellipsis;\n\toverflow: hidden;\n\tposition: absolute;\n\tanimation: shake 50s ease-in-out 5s infinite;\n\t-webkit-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n}\n#waifu #live2d {\n\tposition: relative;\n\tcursor: grab;\n\tcursor: -webkit-grab;\n\tcursor: -o-grab;\n\tcursor: -ms-grab;\n}\n#waifu #live2d:active {\n\tcursor: grabbing;\n\tcursor: -webkit-grabbing;\n\tcursor: -o-grabbing;\n\tcursor: -ms-grabbing;\n}\n#waifu-tool {\n\tcolor: #e8e8e8;\n\ttext-shadow: black 1px 1px 1px;\n\ttop: 70px;\n\tleft: -10px;\n\tposition: absolute;\n\topacity: 0;\n\ttransition: opacity 1s;\n}\n#waifu:hover #waifu-tool {\n\topacity: 1;\n}\n#waifu-tool span {\n\tdisplay: block;\n\tcursor: pointer;\n\tline-height: 30px;\n\ttext-align: center;\n\tcolor: #e8e8e8;\n\ttransition: color .3s;\n}\n#waifu-tool span:hover {\n\tcolor: #0684bd;/* #34495e */\n}\n@keyframes shake {\n\t2% {\n\t\ttransform: translate(0.5px, -1.5px) rotate(-0.5deg);\n\t}\n\t4% {\n\t\ttransform: translate(0.5px, 1.5px) rotate(1.5deg);\n\t}\n\t6% {\n\t\ttransform: translate(1.5px, 1.5px) rotate(1.5deg);\n\t}\n\t8% {\n\t\ttransform: translate(2.5px, 1.5px) rotate(0.5deg);\n\t}\n\t10% {\n\t\ttransform: translate(0.5px, 2.5px) rotate(0.5deg);\n\t}\n\t12% {\n\t\ttransform: translate(1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t14% {\n\t\ttransform: translate(0.5px, 0.5px) rotate(0.5deg);\n\t}\n\t16% {\n\t\ttransform: translate(-1.5px, -0.5px) rotate(1.5deg);\n\t}\n\t18% {\n\t\ttransform: translate(0.5px, 0.5px) rotate(1.5deg);\n\t}\n\t20% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(1.5deg);\n\t}\n\t22% {\n\t\ttransform: translate(0.5px, -1.5px) rotate(1.5deg);\n\t}\n\t24% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(-0.5deg);\n\t}\n\t26% {\n\t\ttransform: translate(1.5px, 0.5px) rotate(1.5deg);\n\t}\n\t28% {\n\t\ttransform: translate(-0.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t30% {\n\t\ttransform: translate(1.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t32% {\n\t\ttransform: translate(2.5px, -1.5px) rotate(1.5deg);\n\t}\n\t34% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(-0.5deg);\n\t}\n\t36% {\n\t\ttransform: translate(0.5px, -1.5px) rotate(0.5deg);\n\t}\n\t38% {\n\t\ttransform: translate(2.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t40% {\n\t\ttransform: translate(-0.5px, 2.5px) rotate(0.5deg);\n\t}\n\t42% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(0.5deg);\n\t}\n\t44% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t46% {\n\t\ttransform: translate(1.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t48% {\n\t\ttransform: translate(2.5px, -0.5px) rotate(0.5deg);\n\t}\n\t50% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t52% {\n\t\ttransform: translate(-0.5px, 1.5px) rotate(0.5deg);\n\t}\n\t54% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t56% {\n\t\ttransform: translate(0.5px, 2.5px) rotate(1.5deg);\n\t}\n\t58% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(0.5deg);\n\t}\n\t60% {\n\t\ttransform: translate(2.5px, -1.5px) rotate(1.5deg);\n\t}\n\t62% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(1.5deg);\n\t}\n\t64% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(1.5deg);\n\t}\n\t66% {\n\t\ttransform: translate(0.5px, 2.5px) rotate(1.5deg);\n\t}\n\t68% {\n\t\ttransform: translate(2.5px, -1.5px) rotate(1.5deg);\n\t}\n\t70% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(0.5deg);\n\t}\n\t72% {\n\t\ttransform: translate(-0.5px, -1.5px) rotate(1.5deg);\n\t}\n\t74% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(1.5deg);\n\t}\n\t76% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(1.5deg);\n\t}\n\t78% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(0.5deg);\n\t}\n\t80% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(-0.5deg);\n\t}\n\t82% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(-0.5deg);\n\t}\n\t84% {\n\t\ttransform: translate(-0.5px, 0.5px) rotate(1.5deg);\n\t}\n\t86% {\n\t\ttransform: translate(2.5px, 1.5px) rotate(0.5deg);\n\t}\n\t88% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(1.5deg);\n\t}\n\t90% {\n\t\ttransform: translate(-1.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t92% {\n\t\ttransform: translate(-1.5px, -1.5px) rotate(1.5deg);\n\t}\n\t94% {\n\t\ttransform: translate(0.5px, 0.5px) rotate(-0.5deg);\n\t}\n\t96% {\n\t\ttransform: translate(2.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t98% {\n\t\ttransform: translate(-1.5px, -1.5px) rotate(-0.5deg);\n\t}\n\t0%, 100% {\n\t\ttransform: translate(0, 0) rotate(0deg);\n\t}\n}\n","site":{"data":{}},"length":4126,"excerpt":"","more":"#waifu-toggle {\n\tposition: fixed;\n\twriting-mode: vertical-rl;\n\tbottom: 66px;\n\tleft: 9px;\n\tbackground-color: #fa0;\n\tcolor: #fff;\n\tborder-radius: 5px;\n\tpadding: 5px 2px 5px 5px;\n\tfont-size: 12px;\n\twidth: 60px;\n\tcursor: pointer;\n\t-webkit-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n}\n#waifu {\n\tposition: fixed;\n\tbottom: -1000px;\n\tright: 0;\n\tz-index: 1;\n\tline-height: 0;\n\ttransition: transform .3s ease-in-out;\n\ttransform: translateY(3px);\n}\n#waifu:hover {\n\ttransform: translateY(0);\n}\n@media (max-width: 768px) {\n\t#waifu {\n\t\tdisplay: none;\n\t}\n}\n#waifu-tips {\n\topacity: 0;\n\twidth: 250px;\n\tmin-height: 70px;\n\tmargin: -30px 20px;\n\tpadding: 5px 10px;\n\tborder: 1px solid rgba(224, 186, 140, 0.92);\n\tborder-radius: 12px;\n\tbackground-color: rgba(236, 217, 188, 0.9);\n\tbox-shadow: 0 3px 15px 2px rgba(191, 158, 118, 0.25);\n\tfont-size: 14px;\n\tline-height: 24px;\n\tword-break: break-all;\n\ttext-overflow: ellipsis;\n\toverflow: hidden;\n\tposition: absolute;\n\tanimation: shake 50s ease-in-out 5s infinite;\n\t-webkit-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;\n}\n#waifu #live2d {\n\tposition: relative;\n\tcursor: grab;\n\tcursor: -webkit-grab;\n\tcursor: -o-grab;\n\tcursor: -ms-grab;\n}\n#waifu #live2d:active {\n\tcursor: grabbing;\n\tcursor: -webkit-grabbing;\n\tcursor: -o-grabbing;\n\tcursor: -ms-grabbing;\n}\n#waifu-tool {\n\tcolor: #e8e8e8;\n\ttext-shadow: black 1px 1px 1px;\n\ttop: 70px;\n\tleft: -10px;\n\tposition: absolute;\n\topacity: 0;\n\ttransition: opacity 1s;\n}\n#waifu:hover #waifu-tool {\n\topacity: 1;\n}\n#waifu-tool span {\n\tdisplay: block;\n\tcursor: pointer;\n\tline-height: 30px;\n\ttext-align: center;\n\tcolor: #e8e8e8;\n\ttransition: color .3s;\n}\n#waifu-tool span:hover {\n\tcolor: #0684bd;/* #34495e */\n}\n@keyframes shake {\n\t2% {\n\t\ttransform: translate(0.5px, -1.5px) rotate(-0.5deg);\n\t}\n\t4% {\n\t\ttransform: translate(0.5px, 1.5px) rotate(1.5deg);\n\t}\n\t6% {\n\t\ttransform: translate(1.5px, 1.5px) rotate(1.5deg);\n\t}\n\t8% {\n\t\ttransform: translate(2.5px, 1.5px) rotate(0.5deg);\n\t}\n\t10% {\n\t\ttransform: translate(0.5px, 2.5px) rotate(0.5deg);\n\t}\n\t12% {\n\t\ttransform: translate(1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t14% {\n\t\ttransform: translate(0.5px, 0.5px) rotate(0.5deg);\n\t}\n\t16% {\n\t\ttransform: translate(-1.5px, -0.5px) rotate(1.5deg);\n\t}\n\t18% {\n\t\ttransform: translate(0.5px, 0.5px) rotate(1.5deg);\n\t}\n\t20% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(1.5deg);\n\t}\n\t22% {\n\t\ttransform: translate(0.5px, -1.5px) rotate(1.5deg);\n\t}\n\t24% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(-0.5deg);\n\t}\n\t26% {\n\t\ttransform: translate(1.5px, 0.5px) rotate(1.5deg);\n\t}\n\t28% {\n\t\ttransform: translate(-0.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t30% {\n\t\ttransform: translate(1.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t32% {\n\t\ttransform: translate(2.5px, -1.5px) rotate(1.5deg);\n\t}\n\t34% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(-0.5deg);\n\t}\n\t36% {\n\t\ttransform: translate(0.5px, -1.5px) rotate(0.5deg);\n\t}\n\t38% {\n\t\ttransform: translate(2.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t40% {\n\t\ttransform: translate(-0.5px, 2.5px) rotate(0.5deg);\n\t}\n\t42% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(0.5deg);\n\t}\n\t44% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t46% {\n\t\ttransform: translate(1.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t48% {\n\t\ttransform: translate(2.5px, -0.5px) rotate(0.5deg);\n\t}\n\t50% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t52% {\n\t\ttransform: translate(-0.5px, 1.5px) rotate(0.5deg);\n\t}\n\t54% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(0.5deg);\n\t}\n\t56% {\n\t\ttransform: translate(0.5px, 2.5px) rotate(1.5deg);\n\t}\n\t58% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(0.5deg);\n\t}\n\t60% {\n\t\ttransform: translate(2.5px, -1.5px) rotate(1.5deg);\n\t}\n\t62% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(1.5deg);\n\t}\n\t64% {\n\t\ttransform: translate(-1.5px, 1.5px) rotate(1.5deg);\n\t}\n\t66% {\n\t\ttransform: translate(0.5px, 2.5px) rotate(1.5deg);\n\t}\n\t68% {\n\t\ttransform: translate(2.5px, -1.5px) rotate(1.5deg);\n\t}\n\t70% {\n\t\ttransform: translate(2.5px, 2.5px) rotate(0.5deg);\n\t}\n\t72% {\n\t\ttransform: translate(-0.5px, -1.5px) rotate(1.5deg);\n\t}\n\t74% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(1.5deg);\n\t}\n\t76% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(1.5deg);\n\t}\n\t78% {\n\t\ttransform: translate(-1.5px, 2.5px) rotate(0.5deg);\n\t}\n\t80% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(-0.5deg);\n\t}\n\t82% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(-0.5deg);\n\t}\n\t84% {\n\t\ttransform: translate(-0.5px, 0.5px) rotate(1.5deg);\n\t}\n\t86% {\n\t\ttransform: translate(2.5px, 1.5px) rotate(0.5deg);\n\t}\n\t88% {\n\t\ttransform: translate(-1.5px, 0.5px) rotate(1.5deg);\n\t}\n\t90% {\n\t\ttransform: translate(-1.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t92% {\n\t\ttransform: translate(-1.5px, -1.5px) rotate(1.5deg);\n\t}\n\t94% {\n\t\ttransform: translate(0.5px, 0.5px) rotate(-0.5deg);\n\t}\n\t96% {\n\t\ttransform: translate(2.5px, -0.5px) rotate(-0.5deg);\n\t}\n\t98% {\n\t\ttransform: translate(-1.5px, -1.5px) rotate(-0.5deg);\n\t}\n\t0%, 100% {\n\t\ttransform: translate(0, 0) rotate(0deg);\n\t}\n}\n"},{"title":"tags","date":"2020-01-14T17:33:13.000Z","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2020-01-15 01:33:13\ntype: \"tags\"\n---\n","updated":"2020-01-14T17:33:32.490Z","path":"tags/index.html","comments":1,"layout":"page","_id":"ck5obqn5v000l2lwj1d9nbkiy","content":"","site":{"data":{}},"length":0,"excerpt":"","more":""},{"_content":"!function(t){function i(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}var e={};i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},i.p=\"\",i(i.s=4)}([function(t,i,e){\"use strict\";function r(){this.live2DModel=null,this.modelMatrix=null,this.eyeBlink=null,this.physics=null,this.pose=null,this.debugMode=!1,this.initialized=!1,this.updating=!1,this.alpha=1,this.accAlpha=0,this.lipSync=!1,this.lipSyncValue=0,this.accelX=0,this.accelY=0,this.accelZ=0,this.dragX=0,this.dragY=0,this.startTimeMSec=null,this.mainMotionManager=new h,this.expressionManager=new h,this.motions={},this.expressions={},this.isTexLoaded=!1}function o(){AMotion.prototype.constructor.call(this),this.paramList=new Array}function n(){this.id=\"\",this.type=-1,this.value=null}function s(){this.nextBlinkTime=null,this.stateStartTime=null,this.blinkIntervalMsec=null,this.eyeState=g.STATE_FIRST,this.blinkIntervalMsec=4e3,this.closingMotionMsec=100,this.closedMotionMsec=50,this.openingMotionMsec=150,this.closeIfZero=!0,this.eyeID_L=\"PARAM_EYE_L_OPEN\",this.eyeID_R=\"PARAM_EYE_R_OPEN\"}function _(){this.tr=new Float32Array(16),this.identity()}function a(t,i){_.prototype.constructor.call(this),this.width=t,this.height=i}function h(){MotionQueueManager.prototype.constructor.call(this),this.currentPriority=null,this.reservePriority=null,this.super=MotionQueueManager.prototype}function l(){this.physicsList=new Array,this.startTimeMSec=UtSystem.getUserTimeMSec()}function $(){this.lastTime=0,this.lastModel=null,this.partsGroups=new Array}function u(t){this.paramIndex=-1,this.partsIndex=-1,this.link=null,this.id=t}function p(){this.EPSILON=.01,this.faceTargetX=0,this.faceTargetY=0,this.faceX=0,this.faceY=0,this.faceVX=0,this.faceVY=0,this.lastTimeSec=0}function f(){_.prototype.constructor.call(this),this.screenLeft=null,this.screenRight=null,this.screenTop=null,this.screenBottom=null,this.maxLeft=null,this.maxRight=null,this.maxTop=null,this.maxBottom=null,this.max=Number.MAX_VALUE,this.min=0}function c(){}var d=0;r.prototype.getModelMatrix=function(){return this.modelMatrix},r.prototype.setAlpha=function(t){t>.999&&(t=1),t<.001&&(t=0),this.alpha=t},r.prototype.getalpha=function(){return this.alpha},r.prototype.isinitialized=\"function(){return\" this.initialized},r.prototype.setinitialized=\"function(t){this.initialized=t},r.prototype.isUpdating=function(){return\" this.updating},r.prototype.setupdating=\"function(t){this.updating=t},r.prototype.getLive2DModel=function(){return\" this.live2dmodel},r.prototype.setlipsync=\"function(t){this.lipSync=t},r.prototype.setLipSyncValue=function(t){this.lipSyncValue=t},r.prototype.setAccel=function(t,i,e){this.accelX=t,this.accelY=i,this.accelZ=e},r.prototype.setDrag=function(t,i){this.dragX=t,this.dragY=i},r.prototype.getMainMotionManager=function(){return\" this.mainmotionmanager},r.prototype.getexpressionmanager=\"function(){return\" this.expressionmanager},r.prototype.loadmodeldata=\"function(t,i){var\" e=\"c.getPlatformManager();this.debugMode&&e.log(\"Load\" model : \"+t);var r=\"this;e.loadLive2DModel(t,function(t){if(r.live2DModel=t,r.live2DModel.saveParam(),0!=Live2D.getError())return\" void console.error(\"error failed to loadmodeldata().\");r.modelmatrix=\"new\" a(r.live2dmodel.getcanvaswidth(),r.live2dmodel.getcanvasheight()),r.modelmatrix.setwidth(2),r.modelmatrix.setcenterposition(0,0),i(r.live2dmodel)})},r.prototype.loadtexture=\"function(t,i,e){d++;var\" texture \"+i);var o=\"this;r.loadTexture(this.live2DModel,t,i,function(){d--,0==d&&(o.isTexLoaded=!0),\"function\"==typeof\" e&&e()})},r.prototype.loadmotion=\"function(t,i,e){var\" motion expression n=\"this;r.loadBytes(i,function(i){null!=t&&(n.expressions[t]=o.loadJson(i)),\"function\"==typeof\" e&&e()})},r.prototype.loadpose=\"function(t,i){var\" pose i&&i()})}catch(t){console.warn(t)}},r.prototype.loadphysics=\"function(t){var\" i=\"c.getPlatformManager();this.debugMode&&i.log(\"Load\" physics l=\"o[h],$=o[h+1];l<n&&(n=l),l\">s&&(s=l),$<_&&(_=$),$>a&&(a=$)}var u=this.modelMatrix.invertTransformX(i),p=this.modelMatrix.invertTransformY(e);return n<=u&&u<=s&&_<=p&&p<=a},r.prototype.hittestsimplecustom=function(t,i,e,r){return null!=\"=this.live2DModel&&(e\">=t[0]&&e<=i[0]&&r<=t[1]&&r>=i[1])},o.prototype=new AMotion,o.EXPRESSION_DEFAULT=\"DEFAULT\",o.TYPE_SET=0,o.TYPE_ADD=1,o.TYPE_MULT=2,o.loadJson=function(t){var i=new o,e=c.getPlatformManager(),r=e.jsonParseFromBytes(t);if(i.setFadeIn(parseInt(r.fade_in)>0?parseInt(r.fade_in):1e3),i.setFadeOut(parseInt(r.fade_out)>0?parseInt(r.fade_out):1e3),null==r.params)return i;var s=r.params,_=s.length;i.paramList=[];for(var a=0;a<_;a++){var h=\"s[a],l=h.id.toString(),$=parseFloat(h.val),u=o.TYPE_ADD,p=null!=h.calc?h.calc.toString():\"add\";if((u=\"add\"===p?o.TYPE_ADD:\"mult\"===p?o.TYPE_MULT:\"set\"===p?o.TYPE_SET:o.TYPE_ADD)==o.TYPE_ADD){var\" f=\"null==h.def?0:parseFloat(h.def);$-=f}else\" if(u=\"=o.TYPE_MULT){var\" d=\"new\" n;d.id=\"l,d.type=u,d.value=$,i.paramList.push(d)}return\" i},o.prototype.updateparamexe=\"function(t,i,e,r){for(var\" n=\"this.paramList.length-1;n\">=0;--n){var s=this.paramList[n];s.type==o.TYPE_ADD?t.addToParamFloat(s.id,s.value,e):s.type==o.TYPE_MULT?t.multParamFloat(s.id,s.value,e):s.type==o.TYPE_SET&&t.setParamFloat(s.id,s.value,e)}},s.prototype.calcNextBlink=function(){return UtSystem.getUserTimeMSec()+Math.random()*(2*this.blinkIntervalMsec-1)},s.prototype.setInterval=function(t){this.blinkIntervalMsec=t},s.prototype.setEyeMotion=function(t,i,e){this.closingMotionMsec=t,this.closedMotionMsec=i,this.openingMotionMsec=e},s.prototype.updateParam=function(t){var i,e=UtSystem.getUserTimeMSec(),r=0;switch(this.eyeState){case g.STATE_CLOSING:r=(e-this.stateStartTime)/this.closingMotionMsec,r>=1&&(r=1,this.eyeState=g.STATE_CLOSED,this.stateStartTime=e),i=1-r;break;case g.STATE_CLOSED:r=(e-this.stateStartTime)/this.closedMotionMsec,r>=1&&(this.eyeState=g.STATE_OPENING,this.stateStartTime=e),i=0;break;case g.STATE_OPENING:r=(e-this.stateStartTime)/this.openingMotionMsec,r>=1&&(r=1,this.eyeState=g.STATE_INTERVAL,this.nextBlinkTime=this.calcNextBlink()),i=r;break;case g.STATE_INTERVAL:this.nextBlinkTime<e&&(this.eyestate=g.state_closing,this.statestarttime=e),i=1;break;case g.state_first:default:this.eyestate=\"g.STATE_INTERVAL,this.nextBlinkTime=this.calcNextBlink(),i=1}this.closeIfZero||(i=-i),t.setParamFloat(this.eyeID_L,i),t.setParamFloat(this.eyeID_R,i)};var\" g=\"function(){};g.STATE_FIRST=\"STATE_FIRST\",g.STATE_INTERVAL=\"STATE_INTERVAL\",g.STATE_CLOSING=\"STATE_CLOSING\",g.STATE_CLOSED=\"STATE_CLOSED\",g.STATE_OPENING=\"STATE_OPENING\",_.mul=function(t,i,e){var\" r,o,n,s=\"[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<4;r++)for(o=0;o<4;o++)for(n=0;n<4;n++)s[r+4*o]+=t[r+4*n]*i[n+4*o];for(r=0;r<16;r++)e[r]=s[r]},_.prototype.identity=function(){for(var\" t=\"0;t<16;t++)this.tr[t]=t%5==0?1:0},_.prototype.getArray=function(){return\" this.tr},_.prototype.getcopymatrix=\"function(){return\" new float32array(this.tr)},_.prototype.setmatrix=\"function(t){if(null!=this.tr&&this.tr.length==this.tr.length)for(var\" i=\"0;i<16;i++)this.tr[i]=t[i]},_.prototype.getScaleX=function(){return\" this.tr[0]},_.prototype.getscaley=\"function(){return\" this.tr[5]},_.prototype.transformx=\"function(t){return\" this.tr[0]*t+this.tr[12]},_.prototype.transformy=\"function(t){return\" this.tr[5]*t+this.tr[13]},_.prototype.inverttransformx=\"function(t){return(t-this.tr[12])/this.tr[0]},_.prototype.invertTransformY=function(t){return(t-this.tr[13])/this.tr[5]},_.prototype.multTranslate=function(t,i){var\" e=\"[1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1];_.mul(e,this.tr,this.tr)},_.prototype.translate=function(t,i){this.tr[12]=t,this.tr[13]=i},_.prototype.translateX=function(t){this.tr[12]=t},_.prototype.translateY=function(t){this.tr[13]=t},_.prototype.multScale=function(t,i){var\" _,a.prototype.setposition=\"function(t,i){this.translate(t,i)},a.prototype.setCenterPosition=function(t,i){var\" motionqueuemanager,h.prototype.getcurrentpriority=\"function(){return\" this.currentpriority},h.prototype.getreservepriority=\"function(){return\" this.reservepriority},h.prototype.reservemotion=\"function(t){return!(this.reservePriority\">=t)&&(!(this.currentPriority>=t)&&(this.reservePriority=t,!0))},h.prototype.setReservePriority=function(t){this.reservePriority=t},h.prototype.updateParam=function(t){var i=MotionQueueManager.prototype.updateParam.call(this,t);return this.isFinished()&&(this.currentPriority=0),i},h.prototype.startMotionPrio=function(t,i){return i==this.reservePriority&&(this.reservePriority=0),this.currentPriority=i,this.startMotion(t,!1)},l.load=function(t){for(var i=new l,e=c.getPlatformManager(),r=e.jsonParseFromBytes(t),o=r.physics_hair,n=o.length,s=0;s<n;s++){var _=\"o[s],a=new\" physicshair,h=\"_.setup,$=parseFloat(h.length),u=parseFloat(h.regist),p=parseFloat(h.mass);a.setup($,u,p);for(var\" f=\"_.src,d=f.length,g=0;g<d;g++){var\" y=\"f[g],m=y.id,T=PhysicsHair.Src.SRC_TO_X,P=y.ptype;\"x\"===P?T=PhysicsHair.Src.SRC_TO_X:\"y\"===P?T=PhysicsHair.Src.SRC_TO_Y:\"angle\"===P?T=PhysicsHair.Src.SRC_TO_G_ANGLE:UtDebug.error(\"live2d\",\"Invalid\" parameter:physicshair.src\");var s=\"parseFloat(y.scale),v=parseFloat(y.weight);a.addSrcParam(T,m,S,v)}for(var\" l=\"_.targets,M=L.length,g=0;g<M;g++){var\" e=\"L[g],m=E.id,T=PhysicsHair.Target.TARGET_FROM_ANGLE,P=E.ptype;\"angle\"===P?T=PhysicsHair.Target.TARGET_FROM_ANGLE:\"angle_v\"===P?T=PhysicsHair.Target.TARGET_FROM_ANGLE_V:UtDebug.error(\"live2d\",\"Invalid\" parameter:physicshair.target\");var i},l.prototype.updateparam=\"function(t){for(var\" i=\"UtSystem.getUserTimeMSec()-this.startTimeMSec,e=0;e<this.physicsList.length;e++)this.physicsList[e].update(t,i)},$.load=function(t){for(var\" $,e=\"c.getPlatformManager(),r=e.jsonParseFromBytes(t),o=r.parts_visible,n=o.length,s=0;s<n;s++){for(var\" array,p=\"0;p<h;p++){var\" u(f.id);if(l[p]=\"d,null!=f.link){var\" g=\"f.link,y=g.length;d.link=new\" array;for(var m=\"0;m<y;m++){var\" t=\"new\" u(g[m]);d.link.push(t)}}}i.partsgroups.push(l)}return i},$.prototype.updateparam=\"function(t){if(null!=t){t!=this.lastModel&&this.initParam(t),this.lastModel=t;var\" r=\"0;r<this.partsGroups.length;r++)this.normalizePartsOpacityGroup(t,this.partsGroups[r],e),this.copyOpacityOtherParts(t,this.partsGroups[r])}},$.prototype.initParam=function(t){if(null!=t)for(var\" o=\"e[r].partsIndex,n=e[r].paramIndex;if(!(o<0)){var\">=0)break;r=n,o=t.getPartsOpacity(s),o+=e/.5,o>1&&(o=1)}}r<0&&(r=0,o=1);for(var n=\"0;n<i.length;n++){var\" s=\"i[n].partsIndex;if(!(s<0))if(r==n)t.setPartsOpacity(s,o);else{var\" a,h=\"t.getPartsOpacity(s);a=o<.5?-.5*o/.5+1:.5*(1-o)/.5;var\" l=\"(1-a)*(1-o);l\">.15&&(a=1-.15/(1-o)),h>a&&(h=a),t.setPartsOpacity(s,h)}}},$.prototype.copyOpacityOtherParts=function(t,i){for(var e=0;e<i.length;e++){var r=\"i[e];if(null!=r.link&&!(r.partsIndex<0))for(var\" o=\"t.getPartsOpacity(r.partsIndex),n=0;n<r.link.length;n++){var\" s=\"r.link[n];s.partsIndex<0||t.setPartsOpacity(s.partsIndex,o)}}},u.prototype.initIndex=function(t){this.paramIndex=t.getParamIndex(\"VISIBLE:\"+this.id),this.partsIndex=t.getPartsDataIndex(PartsDataID.getID(this.id)),t.setParamFloat(this.paramIndex,1)},p.FRAME_RATE=30,p.prototype.setPoint=function(t,i){this.faceTargetX=t,this.faceTargetY=i},p.prototype.getX=function(){return\" this.facex},p.prototype.gety=\"function(){return\" this.facey},p.prototype.update=\"function(){var\" t=\"40/7.5/p.FRAME_RATE;if(0==this.lastTimeSec)return\" void(this.lasttimesec=\"UtSystem.getUserTimeMSec());var\" i=\"UtSystem.getUserTimeMSec(),e=(i-this.lastTimeSec)*p.FRAME_RATE/1e3;this.lastTimeSec=i;var\" _=\"Math.sqrt(n*n+s*s),a=t*n/_,h=t*s/_,l=a-this.faceVX,$=h-this.faceVY,u=Math.sqrt(l*l+$*$);(u<-o||u\">o)&&(l*=o/u,$*=o/u,u=o),this.faceVX+=l,this.faceVY+=$;var f=.5*(Math.sqrt(o*o+16*o*_-8*o*_)-o),c=Math.sqrt(this.faceVX*this.faceVX+this.faceVY*this.faceVY);c>f&&(this.faceVX*=f/c,this.faceVY*=f/c),this.faceX+=this.faceVX,this.faceY+=this.faceVY}},f.prototype=new _,f.prototype.getMaxScale=function(){return this.max},f.prototype.getMinScale=function(){return this.min},f.prototype.setMaxScale=function(t){this.max=t},f.prototype.setMinScale=function(t){this.min=t},f.prototype.isMaxScale=function(){return this.getScaleX()==this.max},f.prototype.isMinScale=function(){return this.getScaleX()==this.min},f.prototype.adjustTranslate=function(t,i){this.tr[0]*this.maxLeft+(this.tr[12]+t)>this.screenLeft&&(t=this.screenLeft-this.tr[0]*this.maxLeft-this.tr[12]),this.tr[0]*this.maxRight+(this.tr[12]+t)<this.screenright&&(t=this.screenright-this.tr[0]*this.maxright-this.tr[12]),this.tr[5]*this.maxtop+(this.tr[13]+i)<this.screentop&&(i=this.screentop-this.tr[5]*this.maxtop-this.tr[13]),this.tr[5]*this.maxbottom+(this.tr[13]+i)>this.screenBottom&&(i=this.screenBottom-this.tr[5]*this.maxBottom-this.tr[13]);var e=[1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1];_.mul(e,this.tr,this.tr)},f.prototype.adjustScale=function(t,i,e){var r=e*this.tr[0];r<this.min?this.tr[0]>0&&(e=this.min/this.tr[0]):r>this.max&&this.tr[0]>0&&(e=this.max/this.tr[0]);var o=[1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1],n=[e,0,0,0,0,e,0,0,0,0,1,0,0,0,0,1],s=[1,0,0,0,0,1,0,0,0,0,1,0,-t,-i,0,1];_.mul(s,this.tr,this.tr),_.mul(n,this.tr,this.tr),_.mul(o,this.tr,this.tr)},f.prototype.setScreenRect=function(t,i,e,r){this.screenLeft=t,this.screenRight=i,this.screenTop=r,this.screenBottom=e},f.prototype.setMaxScreenRect=function(t,i,e,r){this.maxLeft=t,this.maxRight=i,this.maxTop=r,this.maxBottom=e},f.prototype.getScreenLeft=function(){return this.screenLeft},f.prototype.getScreenRight=function(){return this.screenRight},f.prototype.getScreenBottom=function(){return this.screenBottom},f.prototype.getScreenTop=function(){return this.screenTop},f.prototype.getMaxLeft=function(){return this.maxLeft},f.prototype.getMaxRight=function(){return this.maxRight},f.prototype.getMaxBottom=function(){return this.maxBottom},f.prototype.getMaxTop=function(){return this.maxTop},c.platformManager=null,c.getPlatformManager=function(){return c.platformManager},c.setPlatformManager=function(t){c.platformManager=t},t.exports={L2DTargetPoint:p,Live2DFramework:c,L2DViewMatrix:f,L2DPose:$,L2DPartsParam:u,L2DPhysics:l,L2DMotionManager:h,L2DModelMatrix:a,L2DMatrix44:_,EYE_STATE:g,L2DEyeBlink:s,L2DExpressionParam:n,L2DExpressionMotion:o,L2DBaseModel:r}},function(t,i,e){\"use strict\";var r={DEBUG_LOG:!1,DEBUG_MOUSE_LOG:!1,DEBUG_DRAW_HIT_AREA:!1,DEBUG_DRAW_ALPHA_MODEL:!1,VIEW_MAX_SCALE:2,VIEW_MIN_SCALE:.8,VIEW_LOGICAL_LEFT:-1,VIEW_LOGICAL_RIGHT:1,VIEW_LOGICAL_MAX_LEFT:-2,VIEW_LOGICAL_MAX_RIGHT:2,VIEW_LOGICAL_MAX_BOTTOM:-2,VIEW_LOGICAL_MAX_TOP:2,PRIORITY_NONE:0,PRIORITY_IDLE:1,PRIORITY_SLEEPY:2,PRIORITY_NORMAL:3,PRIORITY_FORCE:4,MOTION_GROUP_IDLE:\"idle\",MOTION_GROUP_SLEEPY:\"sleepy\",MOTION_GROUP_TAP_BODY:\"tap_body\",MOTION_GROUP_FLICK_HEAD:\"flick_head\",MOTION_GROUP_PINCH_IN:\"pinch_in\",MOTION_GROUP_PINCH_OUT:\"pinch_out\",MOTION_GROUP_SHAKE:\"shake\",HIT_AREA_HEAD:\"head\",HIT_AREA_BODY:\"body\"};t.exports=r},function(t,i,e){\"use strict\";function r(t){n=t}function o(){return n}Object.defineProperty(i,\"__esModule\",{value:!0}),i.setContext=r,i.getContext=o;var n=void 0},function(t,i,e){\"use strict\";function r(){}r.matrixStack=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.depth=0,r.currentMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.tmp=new Array(16),r.reset=function(){this.depth=0},r.loadIdentity=function(){for(var t=0;t<16;t++)this.currentmatrix[t]=t%5==0?1:0},r.push=function(){var t=\"(this.depth,16*(this.depth+1));this.matrixStack.length<t+16&&(this.matrixStack.length=t+16);for(var\" i=\"0;i<16;i++)this.matrixStack[t+i]=this.currentMatrix[i];this.depth++},r.pop=function(){--this.depth<0&&(myError(\"Invalid\" matrix stack.\"),this.depth=\"0);for(var\" this.currentmatrix},r.multmatrix=\"function(t){var\" i,e,r;for(i=\"0;i<16;i++)this.tmp[i]=0;for(i=0;i<4;i++)for(e=0;e<4;e++)for(r=0;r<4;r++)this.tmp[i+4*e]+=this.currentMatrix[i+4*r]*t[r+4*e];for(i=0;i<16;i++)this.currentMatrix[i]=this.tmp[i]},t.exports=r},function(t,i,e){t.exports=e(5)},function(t,i,e){\"use\" strict\";function r(t){return t&&t.__esmodule?t:{default:t}}function o(t){c=\"document.getElementById(t),C.addEventListener&&(window.addEventListener(\"click\",g),window.addEventListener(\"mousedown\",g),window.addEventListener(\"mousemove\",g),window.addEventListener(\"mouseup\",g),document.addEventListener(\"mouseout\",g),window.addEventListener(\"touchstart\",y),window.addEventListener(\"touchend\",y),window.addEventListener(\"touchmove\",y))}function\" n(t){var m.l2dtargetpoint;var r=\"e/i,o=w.default.VIEW_LOGICAL_LEFT,n=w.default.VIEW_LOGICAL_RIGHT,_=-r,h=r;if(window.Live2D.captureFrame=!1,B=new\" m.l2dviewmatrix,b.setscreenrect(o,n,_,h),b.setmaxscreenrect(w.default.view_logical_max_left,w.default.view_logical_max_right,w.default.view_logical_max_bottom,w.default.view_logical_max_top),b.setmaxscale(w.default.view_max_scale),b.setminscale(w.default.view_min_scale),u=\"new\" m.l2dmatrix44,u.multscale(1,i e),g=\"new\" m.l2dmatrix44,g.multtranslate(-i 2,-e 2),g.multscale(2 i,-2 i),f=\"v(),(0,D.setContext)(F),!F)return\" console.error(\"failed to create webgl context.\"),void(window.webglrenderingcontext&&console.error(\"your browser don't support webgl, check https: get.webgl.org for futher information.\"));window.live2d.setgl(f),f.clearcolor(0,0,0,0),a(t),s()}function s(){b||(b=\"!0,function\" t(){_();var e=\"document.createElement(\"a\");document.body.appendChild(e),e.setAttribute(\"type\",\"hidden\"),e.href=C.toDataURL(),e.download=window.Live2D.captureName||\"live2d.png\",e.click()}i(t,C)}())}function\" _(){o.default.reset(),o.default.loadidentity(),n.update(),r.setdrag(n.getx(),n.gety()),f.clear(f.color_buffer_bit),o.default.multmatrix(u.getarray()),o.default.multmatrix(b.getarray()),o.default.push();for(var a(t){r.reloadflg=\"!0,R.count++,R.changeModel(F,t)}function\" h(t,i){return t.x*i.x+t.y*i.y}function l(t,i){var $(t,i,e){function r(t,i){return 180*math.acos(h({x:0,y:1},l(t,i))) math.pi}if(i.x<e.left+e.width&&i.y<e.top+e.height&&i.x>e.left&&i.y>e.top)return i;var o=t.x-i.x,n=t.y-i.y,s=r(o,n);i.x<t.x&&(s=360-s);var 0=\"==e?.5:e,o(t),n(i)}e(6);var\" _=\"360-r(e.left-t.x,-1*(e.top-t.y)),a=360-r(e.left-t.x,-1*(e.top+e.height-t.y)),$=r(e.left+e.width-t.x,-1*(e.top-t.y)),u=r(e.left+e.width-t.x,-1*(e.top+e.height-t.y)),p=n/o,f={};if(s<$){var\" c=\"e.top-t.y,d=c/p;f={y:t.y+c,x:t.x+d}}else\" if(s<u){var g=\"e.left+e.width-t.x,y=g*p;f={y:t.y+y,x:t.x+g}}else\" if(s<a){var m=\"e.top+e.height-t.y,T=m/p;f={y:t.y+m,x:t.x+T}}else\" if(s<_){var p=\"t.x-e.left,S=P*p;f={y:t.y-S,x:t.x-P}}else{var\" v=\"e.top-t.y,L=v/p;f={y:t.y+v,x:t.x+L}}return\" f}function u(t){y=\"!0;var\" i=\"C.getBoundingClientRect(),e=P(t.clientX-i.left),r=S(t.clientY-i.top),o=$({x:i.left+i.width/2,y:i.top+i.height*X},{x:t.clientX,y:t.clientY},i),n=m(o.x-i.left),s=T(o.y-i.top);w.default.DEBUG_MOUSE_LOG&&console.log(\"onMouseMove\" device( x:\"+t.clientx+\" y:\"+t.clienty+\" ) view( x:\"+n+\" y:\"+s+\")\"),k=\"e,V=r,N.setPoint(n,s)}function\" p(t){y=\"!0;var\" f(t){var y:\"+s+\")\"),y&&(k=\"e,V=r,N.setPoint(n,s))}function\" c(){y&&(y=\"!1),N.setPoint(0,0)}function\" d(){w.default.debug_log&&console.log(\"set session storage.\"),sessionstorage.setitem(\"sleepy\",\"1\")}function g(t){if(\"mousewheel\"=\"=t.type);else\" if(\"mousedown\"=\"=t.type)p(t);else\" if(\"mousemove\"=\"=t.type){var\" if(\"mouseup\"=\"=t.type){if(\"button\"in\" t&&0!=\"t.button)return}else\" if(\"mouseout\"=\"=t.type){w.default.DEBUG_LOG&&console.log(\"Mouse\" out window.\"),c();var e=\"sessionStorage.getItem(\"SleepyTimer\");window.clearTimeout(e),e=window.setTimeout(d,5e4),sessionStorage.setItem(\"SleepyTimer\",e)}}function\" y(t){var m(t){var b.inverttransformx(i)}function t(t){var b.inverttransformy(i)}function p(t){return g.transformx(t)}function s(t){return g.transformy(t)}function v(){for(var t=\"[\"webgl\",\"experimental-webgl\",\"webkit-3d\",\"moz-webgl\"],i=0;i<t.length;i++)try{var\" e}catch(t){}return null}function l(t,i,e){x=\"void\" a.default),b=\"!1,F=null,C=null,N=null,B=null,U=null,G=null,Y=!1,k=0,V=0,X=.5;window.loadlive2d=L},function(t,i,e){\"use\" strict\";(function(t){!function(){function i(){at||(this._$mt=\"null,this._$5S=null,this._$NP=0,i._$42++,this._$5S=new\" y(this))}function e(t){if(!at){this.clipcontextlist=\"new\" array,this.glcontext=\"t.gl,this.dp_webgl=t,this.curFrameNo=0,this.firstError_clipInNotUpdate=!0,this.colorBuffer=0,this.isInitGLFBFunc=!1,this.tmpBoundsOnModel=new\" s,at.glcontext.length>at.frameBuffers.length&&(this.curFrameNo=this.getMaskRenderTexture()),this.tmpModelToViewMatrix=new R,this.tmpMatrix2=new R,this.tmpMatrixForMask=new R,this.tmpMatrixForDraw=new R,this.CHANNEL_COLORS=new Array;var i=new A;i=new A,i.r=0,i.g=0,i.b=0,i.a=1,this.CHANNEL_COLORS.push(i),i=new A,i.r=1,i.g=0,i.b=0,i.a=0,this.CHANNEL_COLORS.push(i),i=new A,i.r=0,i.g=1,i.b=0,i.a=0,this.CHANNEL_COLORS.push(i),i=new A,i.r=0,i.g=0,i.b=1,i.a=0,this.CHANNEL_COLORS.push(i);for(var e=0;e<this.channel_colors.length;e++)this.dp_webgl.setchannelflagascolor(e,this.channel_colors[e])}}function r(t,i,e){this.clipidlist=\"new\" array,this.clipidlist=\"e,this.clippingMaskDrawIndexList=new\" array;for(var r=\"0;r<e.length;r++)this.clippingMaskDrawIndexList.push(i.getDrawDataIndex(e[r]));this.clippedDrawContextList=new\" array,this.isusing=\"!0,this.layoutChannelNo=0,this.layoutBounds=new\" s,this.allclippeddrawrect=\"new\" s,this.matrixformask=\"new\" float32array(16),this.matrixfordraw=\"new\" float32array(16),this.owner=\"t}function\" o(t,i){this._$gp=\"t,this.drawDataIndex=i}function\" n(){at||(this.color=\"null)}function\" s(){at||(this._$dp=\"null,this._$eo=null,this._$V0=null,this._$dP=1e3,this._$eo=1e3,this._$V0=1,this._$a0())}function\" _(){}function a(){this._$r=\"null,this._$0S=null}function\" h(){at||(this.x=\"null,this.y=null,this.width=null,this.height=null)}function\" l(t){at||et.prototype.constructor.call(this,t)}function $(){}function u(t){at||et.prototype.constructor.call(this,t)}function p(){at||(this._$vo=\"null,this._$F2=null,this._$ao=400,this._$1S=400,p._$42++)}function\" f(){at||(this.p1=\"new\" c,this.p2=\"new\" c,this._$fo=\"0,this._$Db=0,this._$L2=0,this._$M2=0,this._$ks=0,this._$9b=0,this._$iP=0,this._$iT=0,this._$lL=new\" array,this._$qp=\"new\" array,this.setup(.3,.5,.1))}function c(){this._$p=\"1,this.x=0,this.y=0,this.vx=0,this.vy=0,this.ax=0,this.ay=0,this.fx=0,this.fy=0,this._$s0=0,this._$70=0,this._$7L=0,this._$HL=0}function\" d(t,i,e){this._$wl=\"null,this.scale=null,this._$V0=null,this._$wL=t,this.scale=i,this._$V0=e}function\" g(t,i,e,r){d.prototype.constructor.call(this,i,e,r),this._$tl=\"null,this._$tL=t}function\" y(t,i,e){this._$wl=\"null,this.scale=null,this._$V0=null,this._$wL=t,this.scale=i,this._$V0=e}function\" t(t,i,e,r){y.prototype.constructor.call(this,i,e,r),this._$yp=\"null,this._$YP=t}function\" p(){at||(this._$fl=\"0,this._$gL=0,this._$B0=1,this._$z0=1,this._$qT=0,this.reflectX=!1,this.reflectY=!1)}function\" s(){at||(this.x=\"null,this.y=null,this.width=null,this.height=null)}function\" v(){}function l(){at||(this.x=\"null,this.y=null)}function\" m(){at||(this._$gp=\"null,this._$dr=null,this._$GS=null,this._$qb=null,this._$Lb=null,this._$mS=null,this.clipID=null,this.clipIDList=new\" array)}function e(){at||(this._$eb=\"E._$ps,this._$lT=1,this._$C0=1,this._$tT=1,this._$WL=1,this.culling=!1,this.matrix4x4=new\" float32array(16),this.premultipliedalpha=\"!1,this.anisotropy=0,this.clippingProcess=E.CLIPPING_PROCESS_NONE,this.clipBufPre_clipContextMask=null,this.clipBufPre_clipContextDraw=null,this.CHANNEL_COLORS=new\" a(){at||(this.a=\"1,this.r=1,this.g=1,this.b=1,this.scale=1,this._$ho=1,this.blendMode=at.L2D_COLOR_BLEND_MODE_MULT)}function\" i(){at||(this._$kp=\"null,this._$dr=null,this._$Ai=!0,this._$mS=null)}function\" w(){}function x(){at||(this._$vp=\"0,this._$wL=null,this._$GP=null,this._$8o=x._$ds,this._$2r=-1,this._$O2=0,this._$ri=0)}function\" o(){}function d(){at||(this._$ob=\"null)}function\" r(){this.m=\"new\" float32array(16),this.identity()}function b(t){at||et.prototype.constructor.call(this,t)}function f(){at||(this._$7=\"1,this._$f=0,this._$H=0,this._$g=1,this._$k=0,this._$w=0,this._$hi=STATE_IDENTITY,this._$Z=_$pS)}function\" c(){at||(s.prototype.constructor.call(this),this.motions=\"new\" array,this._$7r=\"null,this._$7r=C._$Co++,this._$D0=30,this._$yT=0,this._$E=!0,this.loopFadeIn=!0,this._$AS=-1,_$a0())}function\" n(){this._$p=\"new\" float32array(100),this.size=\"0}function\" b(){this._$4p=\"null,this._$I0=null,this._$RP=null}function\" u(){}function g(){}function y(t){at||(this._$qt=\"!0,this._$co=-1,this._$qo=0,this._$pb=new\" array(y._$is),this._$_2=\"new\" float32array(y._$is),this._$vr=\"new\" float32array(y._$is),this._$rr=\"new\" float32array(y._$is),this._$or=\"new\" float32array(y._$is),this._$fs=\"new\" float32array(y._$is),this._$js=\"new\" array(y._$is),this._$3s=\"new\" array,this._$as=\"new\" array,this._$bo=\"null,this._$F2=new\" array,this._$db=\"new\" array,this._$8b=\"new\" array,this._$hr=\"new\" array,this._$ws=\"null,this._$Vs=null,this._$Er=null,this._$Es=new\" int16array(u._$qb),this._$zp=\"new\" float32array(2*u._$1r),this._$ri=\"t,this._$b0=Y._$HP++,this.clipManager=null,this.dp_webgl=null)}function\" k(){}function v(){at||(this._$12=\"null,this._$bb=null,this._$_L=null,this._$jo=null,this._$iL=null,this._$0L=null,this._$Br=null,this._$Dr=null,this._$Cb=null,this._$mr=null,this._$_L=wt.STATE_FIRST,this._$Br=4e3,this._$Dr=100,this._$Cb=50,this._$mr=150,this._$jo=!0,this._$iL=\"PARAM_EYE_L_OPEN\",this._$0L=\"PARAM_EYE_R_OPEN\")}function\" x(){at||(e.prototype.constructor.call(this),this._$sb=\"new\" int32array(x._$as),this._$u2=\"new\" array,this.transform=\"null,this.gl=null,null==X._$NT&&(X._$NT=X._$9r(256),X._$vS=X._$9r(256),X._$no=X._$vb(256)))}function\" z(){at||(i.prototype.constructor.call(this),this._$gs=\"null,this._$Y0=null)}function\" h(t){_t.prototype.constructor.call(this,t),this._$8r=\"I._$ur,this._$Yr=null,this._$Wr=null}function\" w(){at||(m.prototype.constructor.call(this),this._$gp=\"null,this._$dr=null,this._$GS=null,this._$qb=null,this._$Lb=null,this._$mS=null)}function\" j(){at||(this._$nl=\"null,this._$3S=null,this._$aS=null,j._$42++)}function\" q(){at||(i.prototype.constructor.call(this),this._$zo=\"new\" x)}function j(){at||(s.prototype.constructor.call(this),this.motions=\"new\" array,this._$o2=\"null,this._$7r=J._$Co++,this._$D0=30,this._$yT=0,this._$E=!1,this.loopFadeIn=!0,this._$rr=-1,this._$eP=0)}function\" q(t,i){return string.fromcharcode(t.getuint8(i))}function z(){at||(i.prototype.constructor.call(this),this._$o=\"0,this._$A=0,this._$GS=null,this._$Eo=null)}function\" k(t){_t.prototype.constructor.call(this,t),this._$8r=\"I._$ur,this._$Cr=null,this._$hr=null}function\" tt(){at||(this.visible=\"!0,this._$g0=!1,this._$NL=null,this._$3S=null,this._$aS=null,tt._$42++)}function\" it(t){this._$vs=\"null,this._$e0=null,this._$e0=t}function\" et(t){at||(this.id=\"t)}function\" rt(){}function ot(){at||(this._$4s=\"null)}function\" nt(t,i){this.canvas=\"t,this.context=i,this.viewport=new\" array(0,0,t.width,t.height),this._$6r=\"1,this._$xP=0,this._$3r=1,this._$uP=0,this._$Qo=-1,this.cacheImages={}}function\" st(){at||(this._$tt=\"null,this._$LT=null,this._$FS=null,this._$wL=null)}function\" _t(t){at||(this._$e0=\"null,this._$IP=null,this._$JS=!1,this._$AT=!0,this._$e0=t,this.totalScale=1,this._$7s=1,this.totalOpacity=1)}function\" at(){}function ht(){}function lt(t){at||(this._$ib=\"t)}function\" $t(){at||(w.prototype.constructor.call(this),this._$lp=\"-1,this._$d0=0,this._$Yo=0,this._$JP=null,this._$5P=null,this._$BP=null,this._$Eo=null,this._$Qi=null,this._$6s=$t._$ms,this.culling=!0,this.gl_cacheImage=null,this.instanceNo=$t._$42++)}function\" ut(t){mt.prototype.constructor.call(this,t),this._$8r=\"W._$ur,this._$Cr=null,this._$hr=null}function\" pt(){at||(this.x=\"null,this.y=null)}function\" ft(t){at||(i.prototype.constructor.call(this),this.drawparamwebgl=\"new\" mt(t),this.drawparamwebgl.setgl(at.getgl(t)))}function ct(){at||(this.motions=\"null,this._$eb=!1,this.motions=new\" dt(){this._$w0=\"null,this._$AT=!0,this._$9L=!1,this._$z2=-1,this._$bs=-1,this._$Do=-1,this._$sr=null,this._$sr=dt._$Gs++}function\" gt(){this.m=\"new\" array(1,0,0,0,1,0,0,0,1)}function yt(t){at||et.prototype.constructor.call(this,t)}function mt(t){at||(e.prototype.constructor.call(this),this.textures=\"new\" tt(t,i,e){return null=\"=i&&(i=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,e,t.DYNAMIC_DRAW),i}function\" pt(t,i,e){return st(t){at||(this._$p=\"new\" int8array(8),this._$r0=\"new\" dataview(this._$p.buffer),this._$3i=\"new\" int8array(1e3),this._$hl=\"0,this._$v0=0,this._$S2=0,this._$Ko=new\" array,this._$t=\"t,this._$F=0)}function\" vt(){}function lt(){}function mt(t){at||(this._$e0=\"null,this._$IP=null,this._$Us=null,this._$7s=null,this._$IS=[!1],this._$VS=null,this._$AT=!0,this.baseOpacity=1,this.clipBufPre_clipContext=null,this._$e0=t)}function\" et(){}var at=\"!0;i._$0s=1,i._$4s=2,i._$42=0,i._$62=function(t,e){try{if(e\" instanceof arraybuffer&&(e=\"new\" dataview(e)),!(e dataview))throw new lt(\"_$ss#loadmodel(b) b _$x be dataview or arraybuffer\");var r,o=\"new\" st(e),n=\"o._$ST(),s=o._$ST(),a=o._$ST();if(109!=n||111!=s||99!=a)throw\" lt(\"_$gi _$c _$li , _$q0 _$p0.\");if(r=\"o._$ST(),o._$gr(r),r\">G._$T7){t._$NP|=i._$4s;throw new lt(\"_$gi _$C _$li , _$n0 _$_ version _$li ( SDK : \"+G._$T7+\" < _$f0 : \"+r+\" )@_$SS#loadModel()\\n\")}var h=o._$nP();if(r>=G._$s7){var l=o._$9T(),$=o._$9T();if(-30584!=l||-30584!=$)throw t._$NP|=i._$0s,new lt(\"_$gi _$C _$li , _$0 _$6 _$Ui.\")}t._$KS(h);var u=t.getModelContext();u.setDrawParam(t.getDrawParam()),u.init()}catch(t){_._$Rb(t)}},i.prototype._$KS=function(t){this._$MT=t},i.prototype.getModelImpl=function(){return null==this._$MT&&(this._$MT=new p,this._$MT._$zP()),this._$MT},i.prototype.getCanvasWidth=function(){return null==this._$MT?0:this._$MT.getCanvasWidth()},i.prototype.getCanvasHeight=function(){return null==this._$MT?0:this._$MT.getCanvasHeight()},i.prototype.getParamFloat=function(t){return\"number\"!=typeof t&&(t=this._$5S.getParamIndex(u.getID(t))),this._$5S.getParamFloat(t)},i.prototype.setParamFloat=function(t,i,e){\"number\"!=typeof t&&(t=this._$5S.getParamIndex(u.getID(t))),arguments.length<3&&(e=1),this._$5s.setparamfloat(t,this._$5s.getparamfloat(t)*(1-e)+i*e)},i.prototype.addtoparamfloat=function(t,i,e){\"number\"!=typeof t&&(t=\"this._$5S.getParamIndex(u.getID(t))),arguments.length<3&&(e=1),this._$5S.setParamFloat(t,this._$5S.getParamFloat(t)+i*e)},i.prototype.multParamFloat=function(t,i,e){\"number\"!=typeof\" this._$5s.getparamindex(u.getid(t))},i.prototype.loadparam=\"function(){this._$5S.loadParam()},i.prototype.saveParam=function(){this._$5S.saveParam()},i.prototype.init=function(){this._$5S.init()},i.prototype.update=function(){this._$5S.update()},i.prototype._$Rs=function(){return\" _._$li(\"_$60 _$pt _$rs()\"),-1},i.prototype._$ds=\"function(t){_._$li(\"_$60\" _$ss#_$ds() \\n\")},i.prototype._$k2=\"function(){},i.prototype.draw=function(){},i.prototype.getModelContext=function(){return\" this._$5s},i.prototype._$s2=\"function(){return\" this._$np},i.prototype._$p7=\"function(t,i,e,r){var\" o=\"-1,n=0,s=this;if(0!=e)if(1==t.length){var\" _=\"t[0],a=0!=s.getParamFloat(_),h=i[0],l=s.getPartsOpacity(h),$=e/r;a?(l+=$)\">1&&(l=1):(l-=$)<0&&(l=0),s.setpartsopacity(h,l)}else{for(var u=\"0;u<t.length;u++){var\" _=\"t[u],p=0!=s.getParamFloat(_);if(p){if(o\">=0)break;o=u;var h=i[u];n=s.getPartsOpacity(h),n+=e/r,n>1&&(n=1)}}o<0&&(console.log(\"no _$wi _$q0 _$u default[%s]\",t[0]),o=\"0,n=1,s.loadParam(),s.setParamFloat(t[o],n),s.saveParam());for(var\" u=\"0;u<t.length;u++){var\" h=\"i[u];if(o==u)s.setPartsOpacity(h,n);else{var\" f,c=\"s.getPartsOpacity(h);f=n<.5?-.5*n/.5+1:.5*(1-n)/.5;var\" d=\"(1-f)*(1-n);d\">.15&&(f=1-.15/(1-n)),c>f&&(c=f),s.setPartsOpacity(h,c)}}}else for(var u=0;u<t.length;u++){var _=\"t[u],h=i[u],p=0!=s.getParamFloat(_);s.setPartsOpacity(h,p?1:0)}},i.prototype.setPartsOpacity=function(t,i){\"number\"!=typeof\" t&&(t=\"this._$5S.getPartsDataIndex(l.getID(t))),this._$5S.setPartsOpacity(t,i)},i.prototype.getPartsDataIndex=function(t){return\" t instanceof l||(t=\"l.getID(t)),this._$5S.getPartsDataIndex(t)},i.prototype.getPartsOpacity=function(t){return\"number\"!=typeof\" this._$5s.getdrawdataindex(b.getid(t))},i.prototype.getdrawdata=\"function(t){return\" this._$5s.getdrawdata(t)},i.prototype.gettransformedpoints=\"function(t){var\" i=\"this._$5S._$C2(t);return\" ut?i.gettransformedpoints():null},i.prototype.getindexarray=\"function(t){if(t<0||t\">=this._$5S._$aS.length)return null;var i=this._$5S._$aS[t];return null!=i&&i.getType()==W._$wb&&i instanceof $t?i.getIndexArray():null},e.CHANNEL_COUNT=4,e.RENDER_TEXTURE_USE_MIPMAP=!1,e.NOT_USED_FRAME=-100,e.prototype._$L7=function(){if(this.tmpModelToViewMatrix&&(this.tmpModelToViewMatrix=null),this.tmpMatrix2&&(this.tmpMatrix2=null),this.tmpMatrixForMask&&(this.tmpMatrixForMask=null),this.tmpMatrixForDraw&&(this.tmpMatrixForDraw=null),this.tmpBoundsOnModel&&(this.tmpBoundsOnModel=null),this.CHANNEL_COLORS){for(var t=this.CHANNEL_COLORS.length-1;t>=0;--t)this.CHANNEL_COLORS.splice(t,1);this.CHANNEL_COLORS=[]}this.releaseShader()},e.prototype.releaseShader=function(){for(var t=at.frameBuffers.length,i=0;i<t;i++)this.gl.deleteframebuffer(at.framebuffers[i].framebuffer);at.framebuffers=[],at.glcontext=[]},e.prototype.init=function(t,i,e){for(var o=\"0;o<i.length;o++){var\" n=\"i[o].getClipIDList();if(null!=n){var\" s=\"this.findSameClip(n);null==s&&(s=new\" r(this,t,n),this.clipcontextlist.push(s));var _=\"i[o].getDrawDataID(),a=t.getDrawDataIndex(_);s.addClippedDrawData(_,a);e[o].clipBufPre_clipContext=s}}},e.prototype.getMaskRenderTexture=function(){var\" t=\"null;return\" e=\"0,r=0;r<this.clipContextList.length;r++){var\">0){var n=i.gl.getParameter(i.gl.FRAMEBUFFER_BINDING),s=new Array(4);s[0]=0,s[1]=0,s[2]=i.gl.canvas.width,s[3]=i.gl.canvas.height,i.gl.viewport(0,0,at.clippingMaskBufferSize,at.clippingMaskBufferSize),this.setupLayoutBounds(e),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,at.frameBuffers[this.curFrameNo].framebuffer),i.gl.clearColor(0,0,0,0),i.gl.clear(i.gl.COLOR_BUFFER_BIT);for(var r=0;r<this.clipcontextlist.length;r++){var o=\"this.clipContextList[r],_=o.allClippedDrawRect,a=(o.layoutChannelNo,o.layoutBounds);this.tmpBoundsOnModel._$jL(_),this.tmpBoundsOnModel.expand(.05*_.width,.05*_.height);var\" h=\"a.width/this.tmpBoundsOnModel.width,l=a.height/this.tmpBoundsOnModel.height;this.tmpMatrix2.identity(),this.tmpMatrix2.translate(-1,-1,0),this.tmpMatrix2.scale(2,2,1),this.tmpMatrix2.translate(a.x,a.y,0),this.tmpMatrix2.scale(h,l,1),this.tmpMatrix2.translate(-this.tmpBoundsOnModel.x,-this.tmpBoundsOnModel.y,0),this.tmpMatrixForMask.setMatrix(this.tmpMatrix2.m),this.tmpMatrix2.identity(),this.tmpMatrix2.translate(a.x,a.y,0),this.tmpMatrix2.scale(h,l,1),this.tmpMatrix2.translate(-this.tmpBoundsOnModel.x,-this.tmpBoundsOnModel.y,0),this.tmpMatrixForDraw.setMatrix(this.tmpMatrix2.m);for(var\" $=\"this.tmpMatrixForMask.getArray(),u=0;u<16;u++)o.matrixForMask[u]=$[u];for(var\" p=\"this.tmpMatrixForDraw.getArray(),u=0;u<16;u++)o.matrixForDraw[u]=p[u];for(var\" f=\"o.clippingMaskDrawIndexList.length,c=0;c<f;c++){var\" d=\"o.clippingMaskDrawIndexList[c],g=t.getDrawData(d),y=t._$C2(d);i.setClipBufPre_clipContextForMask(o),g.draw(i,t,y)}}i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,n),i.setClipBufPre_clipContextForMask(null),i.gl.viewport(s[0],s[1],s[2],s[3])}},e.prototype.getColorBuffer=function(){return\" this.colorbuffer},e.prototype.findsameclip=\"function(t){for(var\" i=\"0;i<this.clipContextList.length;i++){var\" e=\"this.clipContextList[i],r=e.clipIDList.length;if(r==t.length){for(var\" s=\"e.clipIDList[n],_=0;_<r;_++)if(t[_]==s){o++;break}if(o==r)return\" e}}return null},e.prototype.calcclippeddrawtotalbounds=\"function(t,i){for(var\">r?e:r,n=o,s=o,_=0,a=0,h=i.clippedDrawContextList.length,l=0;l<h;l++){var $=\"i.clippedDrawContextList[l],u=$.drawDataIndex,p=t._$C2(u);if(p._$yo()){for(var\" f=\"p.getTransformedPoints(),c=f.length,d=[],g=[],y=0,m=U._$i2;m<c;m+=U._$No)d[y]=f[m],g[y]=f[m+1],y++;var\" t=\"Math.min.apply(null,d),P=Math.min.apply(null,g),S=Math.max.apply(null,d),v=Math.max.apply(null,g);T<n&&(n=T),P<s&&(s=P),S\">_&&(_=S),v>a&&(a=v)}}if(n==o)i.allClippedDrawRect.x=0,i.allClippedDrawRect.y=0,i.allClippedDrawRect.width=0,i.allClippedDrawRect.height=0,i.isUsing=!1;else{var L=_-n,M=a-s;i.allClippedDrawRect.x=n,i.allClippedDrawRect.y=s,i.allClippedDrawRect.width=L,i.allClippedDrawRect.height=M,i.isUsing=!0}},e.prototype.setupLayoutBounds=function(t){var i=t/e.CHANNEL_COUNT,r=t%e.CHANNEL_COUNT;i=~~i,r=~~r;for(var o=0,n=0;n<e.channel_count;n++){var s=\"i+(n<r?1:0);if(0==s);else\" if(1=\"=s){var\" a=\"this.clipContextList[o++];a.layoutChannelNo=n,a.layoutBounds.x=0,a.layoutBounds.y=0,a.layoutBounds.width=1,a.layoutBounds.height=1}else\" if(2=\"=s)for(var\" h=\"0;h<s;h++){var\" l=\"h%2,$=0;l=~~l;var\" if(s<=\"4)for(var\" _._$li(\"_$6 _$0p mask count : %d\",s)}},r.prototype.addclippeddrawdata=\"function(t,i){var\" e=\"new\" o(t,i);this.clippeddrawcontextlist.push(e)},s._$jt=\"function(t,i,e){var\" r=\"t/i,o=e/i,n=o,s=1-(1-o)*(1-o),_=1-(1-n)*(1-n),a=1/3*(1-o)*s+(n*(2/3)+1/3*(1-n))*(1-s),h=(n+2/3*(1-n))*_+(o*(1/3)+2/3*(1-o))*(1-_),l=1-3*h+3*a-0,$=3*h-6*a+0,u=3*a-0;if(r<=0)return\" 0;if(r>=1)return 1;var p=r,f=p*p;return l*(p*f)+$*f+u*p+0},s.prototype._$a0=function(){},s.prototype.setFadeIn=function(t){this._$dP=t},s.prototype.setFadeOut=function(t){this._$eo=t},s.prototype._$pT=function(t){this._$V0=t},s.prototype.getFadeOut=function(){return this._$eo},s.prototype._$4T=function(){return this._$eo},s.prototype._$mT=function(){return this._$V0},s.prototype.getDurationMSec=function(){return-1},s.prototype.getLoopDurationMSec=function(){return-1},s.prototype.updateParam=function(t,i){if(i._$AT&&!i._$9L){var e=w.getUserTimeMSec();if(i._$z2<0){i._$z2=e,i._$bs=e;var r=\"this.getDurationMSec();i._$Do<0&&(i._$Do=r<=0?-1:i._$z2+r)}var\" o=\"this._$V0;o=o*(0==this._$dP?1:ht._$r2((e-i._$bs)/this._$dP))*(0==this._$eo||i._$Do<0?1:ht._$r2((i._$Do-e)/this._$eo)),0<=o&&o<=1||console.log(\"###\" assert!! ### \"),this.updateparamexe(t,e,o,i),i._$do>0&&i._$Do<e&&(i._$9l=!0)}},s.prototype.updateparamexe=function(t,i,e,r){},_._$8s=0,_._$ft=new object,_.start=\"function(t){var\" i=\"_._$fT[t];null==i&&(i=new\" a,i._$r=\"t,_._$fT[t]=i),i._$0S=w.getSystemTimeMSec()},_.dump=function(t){var\" e=\"w.getSystemTimeMSec(),r=e-i._$0S;return\" console.log(t+\" : \"+r+\"ms\"),r}return-1},_.end=\"function(t){var\" w.getsystemtimemsec()-i._$0s}return-1},_._$li=\"function(t,i){console.log(\"_$li\" \"+t+\"\\n\",i)},_._$ji=\"function(t,i){console.log(t,i)},_._$dL=function(t,i){console.log(t,i),console.log(\"\\n\")},_._$KL=function(t,i){for(var\">0?console.log(\"\\n\"):e%8==0&&e>0&&console.log(\"  \"),console.log(\"%02X \",255&t[e]);console.log(\"\\n\")},_._$nr=function(t,i,e){console.log(\"%s\\n\",t);for(var r=i.length,o=0;o<r;++o)console.log(\"%5d\",i[o]),console.log(\"%s\\n\",e),console.log(\",\");console.log(\"\\n\")},_._$rb=function(t){console.log(\"dump exception : \"+t),console.log(\"stack :: \"+t.stack)},h.prototype._$8p=\"function(){return.5*(this.x+this.x+this.width)},h.prototype._$6P=function(){return.5*(this.y+this.y+this.height)},h.prototype._$EL=function(){return\" this.x+this.width},h.prototype._$5t=\"function(){return\" this.y+this.height},h.prototype._$jl=\"function(t,i,e,r){this.x=t,this.y=i,this.width=e,this.height=r},h.prototype._$jL=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},l.prototype=new\" et,l._$tp=\"new\" object,l._$27=\"function(){l._$tP.clear()},l.getID=function(t){var\" i=\"l._$tP[t];return\" null=\"=i&&(i=new\" l(t),l._$tp[t]=\"i),i},l.prototype._$3s=function(){return\" new l},u.prototype=\"new\" et,u._$tp=\"new\" object,u._$27=\"function(){u._$tP.clear()},u.getID=function(t){var\" u(t),u._$tp[t]=\"i),i},u.prototype._$3s=function(){return\" u},p._$42=\"0,p.prototype._$zP=function(){null==this._$vo&&(this._$vo=new\" ot),null=\"=this._$F2&&(this._$F2=new\" array)},p.prototype.getcanvaswidth=\"function(){return\" this._$ao},p.prototype.getcanvasheight=\"function(){return\" this._$1s},p.prototype._$f0=\"function(t){this._$vo=t._$nP(),this._$F2=t._$nP(),this._$ao=t._$6L(),this._$1S=t._$6L()},p.prototype._$6S=function(t){this._$F2.push(t)},p.prototype._$Xr=function(){return\" this._$f2},p.prototype._$e2=\"function(){return\" this._$vo},f.prototype.setup=\"function(t,i,e){this._$ks=this._$Yb(),this.p2._$xT(),3==arguments.length&&(this._$Fo=t,this._$L2=i,this.p1._$p=e,this.p2._$p=e,this.p2.y=t,this.setup())},f.prototype.getPhysicsPoint1=function(){return\" this.p1},f.prototype.getphysicspoint2=\"function(){return\" this.p2},f.prototype._$qr=\"function(){return\" this._$db},f.prototype._$pr=\"function(t){this._$Db=t},f.prototype._$5r=function(){return\" this._$m2},f.prototype._$cs=\"function(){return\" this._$9b},f.prototype._$yb=\"function(){return-180*Math.atan2(this.p1.x-this.p2.x,-(this.p1.y-this.p2.y))/Math.PI},f.prototype.addSrcParam=function(t,i,e,r){var\" o=\"new\" g(t,i,e,r);this._$ll.push(o)},f.prototype.addtargetparam=\"function(t,i,e,r){var\" t(t,i,e,r);this._$qp.push(o)},f.prototype.update=\"function(t,i){if(0==this._$iP)return\" this._$ip=\"this._$iT=i,void(this._$Fo=Math.sqrt((this.p1.x-this.p2.x)*(this.p1.x-this.p2.x)+(this.p1.y-this.p2.y)*(this.p1.y-this.p2.y)));var\" e=\"(i-this._$iT)/1e3;if(0!=e){for(var\" r=\"this._$lL.length-1;r\">=0;--r){this._$lL[r]._$oP(t,this)}this._$oo(t,e),this._$M2=this._$Yb(),this._$9b=(this._$M2-this._$ks)/e,this._$ks=this._$M2}for(var r=this._$qP.length-1;r>=0;--r){this._$qP[r]._$YS(t,this)}this._$iT=i},f.prototype._$oo=function(t,i){i<.033&&(i=.033);var e=\"1/i;this.p1.vx=(this.p1.x-this.p1._$s0)*e,this.p1.vy=(this.p1.y-this.p1._$70)*e,this.p1.ax=(this.p1.vx-this.p1._$7L)*e,this.p1.ay=(this.p1.vy-this.p1._$HL)*e,this.p1.fx=this.p1.ax*this.p1._$p,this.p1.fy=this.p1.ay*this.p1._$p,this.p1._$xT();var\" r,o,n=\"-Math.atan2(this.p1.y-this.p2.y,this.p1.x-this.p2.x),s=Math.cos(n),_=Math.sin(n),a=9.8*this.p2._$p,h=this._$Db*Lt._$bS,l=a*Math.cos(n-h);r=l*_,o=l*s;var\" $=\"-this.p1.fx*_*_,u=-this.p1.fy*_*s,p=-this.p2.vx*this._$L2,f=-this.p2.vy*this._$L2;this.p2.fx=r+$+p,this.p2.fy=o+u+f,this.p2.ax=this.p2.fx/this.p2._$p,this.p2.ay=this.p2.fy/this.p2._$p,this.p2.vx+=this.p2.ax*i,this.p2.vy+=this.p2.ay*i,this.p2.x+=this.p2.vx*i,this.p2.y+=this.p2.vy*i;var\" c=\"Math.sqrt((this.p1.x-this.p2.x)*(this.p1.x-this.p2.x)+(this.p1.y-this.p2.y)*(this.p1.y-this.p2.y));this.p2.x=this.p1.x+this._$Fo*(this.p2.x-this.p1.x)/c,this.p2.y=this.p1.y+this._$Fo*(this.p2.y-this.p1.y)/c,this.p2.vx=(this.p2.x-this.p2._$s0)*e,this.p2.vy=(this.p2.y-this.p2._$70)*e,this.p2._$xT()},c.prototype._$xT=function(){this._$s0=this.x,this._$70=this.y,this._$7L=this.vx,this._$HL=this.vy},d.prototype._$oP=function(t,i){},g.prototype=new\" d,g.prototype._$op=\"function(t,i){var\" f.src.src_to_x:r.x=\"r.x+(e-r.x)*this._$V0;break;case\" f.src.src_to_y:r.y=\"r.y+(e-r.y)*this._$V0;break;case\" f.src.src_to_g_angle:var o=\"i._$qr();o+=(e-o)*this._$V0,i._$pr(o)}},y.prototype._$YS=function(t,i){},T.prototype=new\" y,t.prototype._$ys=\"function(t,i){switch(this._$YP){default:case\" f.target.target_from_angle:t.setparamfloat(this._$wl,this.scale*i._$5r(),this._$v0);break;case f.target.target_from_angle_v:t.setparamfloat(this._$wl,this.scale*i._$cs(),this._$v0)}},f.src=\"function(){},f.Src.SRC_TO_X=\"SRC_TO_X\",f.Src.SRC_TO_Y=\"SRC_TO_Y\",f.Src.SRC_TO_G_ANGLE=\"SRC_TO_G_ANGLE\",f.Target=function(){},f.Target.TARGET_FROM_ANGLE=\"TARGET_FROM_ANGLE\",f.Target.TARGET_FROM_ANGLE_V=\"TARGET_FROM_ANGLE_V\",P.prototype.init=function(t){this._$fL=t._$fL,this._$gL=t._$gL,this._$B0=t._$B0,this._$z0=t._$z0,this._$qT=t._$qT,this.reflectX=t.reflectX,this.reflectY=t.reflectY},P.prototype._$F0=function(t){this._$fL=t._$_T(),this._$gL=t._$_T(),this._$B0=t._$_T(),this._$z0=t._$_T(),this._$qT=t._$_T(),t.getFormatVersion()\">=G.LIVE2D_FORMAT_VERSION_V2_10_SDK2&&(this.reflectX=t._$po(),this.reflectY=t._$po())},P.prototype._$e=function(){};var It=function(){};It._$ni=function(t,i,e,r,o,n,s,_,a){var h=s*n-_*o;if(0==h)return null;var l,$=((t-e)*n-(i-r)*o)/h;return l=0!=o?(t-e-$*s)/o:(i-r-$*_)/n,isNaN(l)&&(l=(t-e-$*s)/o,isNaN(l)&&(l=(i-r-$*_)/n),isNaN(l)&&(console.log(\"a is NaN @UtVector#_$ni() \"),console.log(\"v1x : \"+o),console.log(\"v1x != 0 ? \"+(0!=o)))),null==a?new Array(l,$):(a[0]=l,a[1]=$,a)},S.prototype._$8P=function(){return this.x+.5*this.width},S.prototype._$6P=function(){return this.y+.5*this.height},S.prototype._$EL=function(){return this.x+this.width},S.prototype._$5T=function(){return this.y+this.height},S.prototype._$jL=function(t,i,e,r){this.x=t,this.y=i,this.width=e,this.height=r},S.prototype._$jL=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},S.prototype.contains=function(t,i){return this.x<=this.x&&this.y<=this.y&&this.x<=this.x+this.width&&this.y<=this.y+this.height},s.prototype.expand=function(t,i){this.x-=t,this.y-=i,this.width+=2*t,this.height+=2*i},v._$z2=function(t,i,e,r){var o=\"i._$Q2(t,e),n=t._$vs(),s=t._$Tr();if(i._$zr(n,s,o),o<=0)return\" r[n[0]];if(1=\"=o){var\" _=\"r[n[0]],a=r[n[1]],h=s[0];return\" _+(a-_)*h|0}if(2=\"=o){var\" p+(f-p)*u|0}if(3=\"=o){var\" c=\"r[n[0]],d=r[n[1]],g=r[n[2]],y=r[n[3]],m=r[n[4]],T=r[n[5]],P=r[n[6]],S=r[n[7]],h=s[0],u=s[1],v=s[2],_=c+(d-c)*h|0,a=g+(y-g)*h|0,l=m+(T-m)*h|0,$=P+(S-P)*h|0,p=_+(a-_)*u|0,f=l+($-l)*u|0;return\" p+(f-p)*v|0}if(4=\"=o){var\" l=\"r[n[0]],M=r[n[1]],E=r[n[2]],A=r[n[3]],I=r[n[4]],w=r[n[5]],x=r[n[6]],O=r[n[7]],D=r[n[8]],R=r[n[9]],b=r[n[10]],F=r[n[11]],C=r[n[12]],N=r[n[13]],B=r[n[14]],U=r[n[15]],h=s[0],u=s[1],v=s[2],G=s[3],c=L+(M-L)*h|0,d=E+(A-E)*h|0,g=I+(w-I)*h|0,y=x+(O-x)*h|0,m=D+(R-D)*h|0,T=b+(F-b)*h|0,P=C+(N-C)*h|0,S=B+(U-B)*h|0,_=c+(d-c)*u|0,a=g+(y-g)*u|0,l=m+(T-m)*u|0,$=P+(S-P)*u|0,p=_+(a-_)*v|0,f=l+($-l)*v|0;return\" p+(f-p)*g|0}for(var y=\"1<<o,k=new\" float32array(y),v=\"0;V<Y;V++){for(var\" x=\"V,z=1,H=0;H<o;H++)z*=X%2==0?1-s[H]:s[H],X/=2;k[V]=z}for(var\" w=\"new\" float32array(y),j=\"0;j<Y;j++)W[j]=r[n[j]];for(var\" q=\"0,j=0;j<Y;j++)q+=k[j]*W[j];return\" q+.5|0},v._$br=\"function(t,i,e,r){var\" _+(a-_)*h}if(2=\"=o){var\" p=\"r[n[0]],f=r[n[1]],c=r[n[2]],d=r[n[3]],g=r[n[4]],y=r[n[5]],m=r[n[6]],T=r[n[7]],h=s[0],u=s[1],P=s[2];return(1-P)*((1-u)*(p+(f-p)*h)+u*(c+(d-c)*h))+P*((1-u)*(g+(y-g)*h)+u*(m+(T-m)*h))}if(4==o){var\" s=\"r[n[0]],v=r[n[1]],L=r[n[2]],M=r[n[3]],E=r[n[4]],A=r[n[5]],I=r[n[6]],w=r[n[7]],x=r[n[8]],O=r[n[9]],D=r[n[10]],R=r[n[11]],b=r[n[12]],F=r[n[13]],C=r[n[14]],N=r[n[15]],h=s[0],u=s[1],P=s[2],B=s[3];return(1-B)*((1-P)*((1-u)*(S+(v-S)*h)+u*(L+(M-L)*h))+P*((1-u)*(E+(A-E)*h)+u*(I+(w-I)*h)))+B*((1-P)*((1-u)*(x+(O-x)*h)+u*(D+(R-D)*h))+P*((1-u)*(b+(F-b)*h)+u*(C+(N-C)*h)))}for(var\" u=\"1<<o,G=new\" float32array(u),y=\"0;Y<U;Y++){for(var\" k=\"Y,V=1,X=0;X<o;X++)V*=k%2==0?1-s[X]:s[X],k/=2;G[Y]=V}for(var\" z=\"new\" float32array(u),h=\"0;H<U;H++)z[H]=r[n[H]];for(var\" w},v._$vr=\"function(t,i,e,r,o,n,s,_){var\" a=\"i._$Q2(t,e),h=t._$vs(),l=t._$Tr();i._$zr(h,l,a);var\" $=\"2*r,u=s;if(a<=0){var\" for(var if(1=\"=a)for(var\" f=\"o[h[0]],d=o[h[1]],g=l[0],y=1-g,c=0;c<$;)n[u]=f[c]*y+d[c]*g,++c,n[u+1]=f[c]*y+d[c]*g,++c,u+=_;else\" if(2=\"=a)for(var\" if(3=\"=a)for(var\" if(4=\"=a)for(var\" h=\"o[h[0]],W=o[h[1]],j=o[h[2]],q=o[h[3]],J=o[h[4]],Q=o[h[5]],Z=o[h[6]],K=o[h[7]],tt=o[h[8]],it=o[h[9]],et=o[h[10]],rt=o[h[11]],ot=o[h[12]],nt=o[h[13]],st=o[h[14]],_t=o[h[15]],g=l[0],P=l[1],C=l[2],at=l[3],y=1-g,S=1-P,N=1-C,ht=1-at,lt=ht*N*S*y,$t=ht*N*S*g,ut=ht*N*P*y,pt=ht*N*P*g,ft=ht*C*S*y,ct=ht*C*S*g,dt=ht*C*P*y,gt=ht*C*P*g,yt=at*N*S*y,mt=at*N*S*g,Tt=at*N*P*y,Pt=at*N*P*g,St=at*C*S*y,vt=at*C*S*g,Lt=at*C*P*y,Mt=at*C*P*g,c=0;c<$;)n[u]=lt*H[c]+$t*W[c]+ut*j[c]+pt*q[c]+ft*J[c]+ct*Q[c]+dt*Z[c]+gt*K[c]+yt*tt[c]+mt*it[c]+Tt*et[c]+Pt*rt[c]+St*ot[c]+vt*nt[c]+Lt*st[c]+Mt*_t[c],++c,n[u+1]=lt*H[c]+$t*W[c]+ut*j[c]+pt*q[c]+ft*J[c]+ct*Q[c]+dt*Z[c]+gt*K[c]+yt*tt[c]+mt*it[c]+Tt*et[c]+Pt*rt[c]+St*ot[c]+vt*nt[c]+Lt*st[c]+Mt*_t[c],++c,u+=_;else{for(var\" et=\"1<<a,At=new\" float32array(et),it=\"0;It<Et;It++){for(var\" wt=\"It,xt=1,Ot=0;Ot<a;Ot++)xt*=wt%2==0?1-l[Ot]:l[Ot],wt/=2;At[It]=xt}for(var\" dt=\"new\" float32array(et),rt=\"0;Rt<Et;Rt++)Dt[Rt]=o[h[Rt]];for(var\" bt=\"0,Ft=0,Ct=c+1,Rt=0;Rt<Et;Rt++)bt+=At[Rt]*Dt[Rt][c],Ft+=At[Rt]*Dt[Rt][Ct];c+=2,n[u]=bt,n[u+1]=Ft,u+=_}}},L.prototype._$HT=function(t,i){this.x=t,this.y=i},L.prototype._$HT=function(t){this.x=t.x,this.y=t.y},M._$ur=-2,M._$ES=500,M._$wb=2,M._$8S=3,M._$52=M._$ES,M._$R2=M._$ES,M._$or=function(){return\" m._$52},m._$pr=\"function(){return\" m._$r2},m.prototype.convertclipidforv2_11=\"function(t){var\" i=\"[];return\" null=\"=t?null:0==t.length?null:/,/.test(t)?i=t.id.split(\",\"):(i.push(t.id),i)},M.prototype._$F0=function(t){this._$gP=t._$nP(),this._$dr=t._$nP(),this._$GS=t._$nP(),this._$qb=t._$6L(),this._$Lb=t._$cS(),this._$mS=t._$Tb(),t.getFormatVersion()\">=G._$T7?(this.clipID=t._$nP(),this.clipIDList=this.convertClipIDForV2_11(this.clipID)):this.clipIDList=[],this._$MS(this._$Lb)},M.prototype.getClipIDList=function(){return this.clipIDList},M.prototype.init=function(t){},M.prototype._$Nr=function(t,i){if(i._$IS[0]=!1,i._$Us=v._$Z2(t,this._$GS,i._$IS,this._$Lb),at._$Zs);else if(i._$IS[0])return;i._$7s=v._$br(t,this._$GS,i._$IS,this._$mS)},M.prototype._$2b=function(t,i){},M.prototype.getDrawDataID=function(){return this._$gP},M.prototype._$j2=function(t){this._$gP=t},M.prototype.getOpacity=function(t,i){return i._$7s},M.prototype._$zS=function(t,i){return i._$Us},M.prototype._$MS=function(t){for(var i=t.length-1;i>=0;--i){var e=t[i];e<m._$52?m._$52=e:e>M._$R2&&(M._$R2=e)}},M.prototype.getTargetBaseDataID=function(){return this._$dr},M.prototype._$gs=function(t){this._$dr=t},M.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},M.prototype.preDraw=function(t,i,e){},M.prototype.draw=function(t,i,e){},M.prototype.getType=function(){},M.prototype._$B2=function(t,i,e){},E._$ps=32,E.CLIPPING_PROCESS_NONE=0,E.CLIPPING_PROCESS_OVERWRITE_ALPHA=1,E.CLIPPING_PROCESS_MULTIPLY_ALPHA=2,E.CLIPPING_PROCESS_DRAW=3,E.CLIPPING_PROCESS_CLEAR_ALPHA=4,E.prototype.setChannelFlagAsColor=function(t,i){this.CHANNEL_COLORS[t]=i},E.prototype.getChannelFlagAsColor=function(t){return this.CHANNEL_COLORS[t]},E.prototype._$ZT=function(){},E.prototype._$Uo=function(t,i,e,r,o,n,s){},E.prototype._$Rs=function(){return-1},E.prototype._$Ds=function(t){},E.prototype.setBaseColor=function(t,i,e,r){t<0?t=0:t>1&&(t=1),i<0?i=0:i>1&&(i=1),e<0?e=0:e>1&&(e=1),r<0?r=0:r>1&&(r=1),this._$lT=t,this._$C0=i,this._$tT=e,this._$WL=r},E.prototype._$WP=function(t){this.culling=t},E.prototype.setMatrix=function(t){for(var i=0;i<16;i++)this.matrix4x4[i]=t[i]},e.prototype._$it=function(){return this.matrix4x4},e.prototype.setpremultipliedalpha=\"function(t){this.premultipliedAlpha=t},E.prototype.isPremultipliedAlpha=function(){return\" this.premultipliedalpha},e.prototype.setanisotropy=\"function(t){this.anisotropy=t},E.prototype.getAnisotropy=function(){return\" this.anisotropy},e.prototype.getclippingprocess=\"function(){return\" this.clippingprocess},e.prototype.setclippingprocess=\"function(t){this.clippingProcess=t},E.prototype.setClipBufPre_clipContextForMask=function(t){this.clipBufPre_clipContextMask=t},E.prototype.getClipBufPre_clipContextMask=function(){return\" this.clipbufpre_clipcontextmask},e.prototype.setclipbufpre_clipcontextfordraw=\"function(t){this.clipBufPre_clipContextDraw=t},E.prototype.getClipBufPre_clipContextDraw=function(){return\" this.clipbufpre_clipcontextdraw},i._$ur=\"-2,I._$c2=1,I._$_b=2,I.prototype._$F0=function(t){this._$kP=t._$nP(),this._$dr=t._$nP()},I.prototype.readV2_opacity=function(t){t.getFormatVersion()\">=G.LIVE2D_FORMAT_VERSION_V2_10_SDK2&&(this._$mS=t._$Tb())},I.prototype.init=function(t){},I.prototype._$Nr=function(t,i){},I.prototype.interpolateOpacity=function(t,i,e,r){null==this._$mS?e.setInterpolatedOpacity(1):e.setInterpolatedOpacity(v._$br(t,i,r,this._$mS))},I.prototype._$2b=function(t,i){},I.prototype._$nb=function(t,i,e,r,o,n,s){},I.prototype.getType=function(){},I.prototype._$gs=function(t){this._$dr=t},I.prototype._$a2=function(t){this._$kP=t},I.prototype.getTargetBaseDataID=function(){return this._$dr},I.prototype.getBaseDataID=function(){return this._$kP},I.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},w._$W2=0,w._$CS=w._$W2,w._$Mo=function(){return!0},w._$XP=function(t){try{for(var i=getTimeMSec();getTimeMSec()-i<t;);}catch(t){t._$rb()}},w.getusertimemsec=function(){return w._$cs=\"=w._$W2?w.getSystemTimeMSec():w._$CS},w.setUserTimeMSec=function(t){w._$CS=t},w.updateUserTimeMSec=function(){return\" date).gettime()},w.getsystemtimemsec=\"function(){return(new\" date).gettime()},w._$q=\"function(t){},w._$jT=function(t,i,e,r,o){for(var\" n=\"0;n<o;n++)e[r+n]=t[i+n]},x._$ds=-2,x.prototype._$F0=function(t){this._$wL=t._$nP(),this._$VP=t._$6L(),this._$GP=t._$nP()},x.prototype.getParamIndex=function(t){return\" this._$2r!=\"t&&(this._$8o=x._$ds),this._$8o},x.prototype._$Pb=function(t,i){this._$8o=t,this._$2r=i},x.prototype.getParamID=function(){return\" this._$wl},x.prototype._$yp=\"function(t){this._$wL=t},x.prototype._$N2=function(){return\" this._$vp},x.prototype._$d2=\"function(){return\" this._$gp},x.prototype._$t2=\"function(t,i){this._$VP=t,this._$GP=i},x.prototype._$Lr=function(){return\" this._$o2},x.prototype._$wr=\"function(t){this._$O2=t},x.prototype._$SL=function(){return\" this._$ri},x.prototype._$al=\"function(t){this._$ri=t},O.startsWith=function(t,i,e){var\" r=\"i+e.length;if(r\">=t.length)return!1;for(var o=i;o<r;o++)if(o.getchar(t,o)!=e.charat(o-i))return!1;return!0},o.getchar=function(t,i){return string.fromcharcode(t.getuint8(i))},o.createstring=\"function(t,i,e){for(var\" r=\"new\" arraybuffer(2*e),o=\"new\" uint16array(r),n=\"0;n<e;n++)o[n]=t.getUint8(i+n);return\" string.fromcharcode.apply(null,o)},o._$ls=\"function(t,i,e,r){t\" instanceof arraybuffer&&(t=\"new\" dataview(t));var o=\"e,n=!1,s=!1,_=0,a=O.getChar(t,o);\"-\"==a&&(n=!0,o++);for(var\" h=\"!1;o<i;o++){switch(a=O.getChar(t,o)){case\"0\":_*=10;break;case\"1\":_=10*_+1;break;case\"2\":_=10*_+2;break;case\"3\":_=10*_+3;break;case\"4\":_=10*_+4;break;case\"5\":_=10*_+5;break;case\"6\":_=10*_+6;break;case\"7\":_=10*_+7;break;case\"8\":_=10*_+8;break;case\"9\":_=10*_+9;break;case\".\":s=!0,o++,h=!0;break;default:h=!0}if(h)break}if(s)for(var\" l=\".1,$=!1;o<i;o++){switch(a=O.getChar(t,o)){case\"0\":break;case\"1\":_+=1*l;break;case\"2\":_+=2*l;break;case\"3\":_+=3*l;break;case\"4\":_+=4*l;break;case\"5\":_+=5*l;break;case\"6\":_+=6*l;break;case\"7\":_+=7*l;break;case\"8\":_+=8*l;break;case\"9\":_+=9*l;break;default:$=!0}if(l*=.1,$)break}return\" n&&(_=\"-_),r[0]=o,_},D.prototype._$zP=function(){this._$Ob=new\" array},d.prototype._$f0=\"function(t){this._$Ob=t._$nP()},D.prototype._$Ur=function(t){if(t._$WS())return!0;for(var\" i=\"t._$v2(),e=this._$Ob.length-1;e\">=0;--e){var r=this._$Ob[e].getParamIndex(i);if(r==x._$ds&&(r=t.getParamIndex(this._$Ob[e].getParamID())),t._$Xb(r))return!0}return!1},D.prototype._$Q2=function(t,i){for(var e,r,o=this._$Ob.length,n=t._$v2(),s=0,_=0;_<o;_++){var 23242 a=\"this._$Ob[_];if(e=a.getParamIndex(n),e==x._$ds&&(e=t.getParamIndex(a.getParamID()),a._$Pb(e,n)),e<0)throw\" new exception(\"err : \"+a.getparamid());var h=\"e<0?0:t.getParamFloat(e);r=a._$N2();var\" l,$,u=\"a._$d2(),p=-1,f=0;if(r<1);else\" if(1=\"=r)l=u[0],l-U._$J<h&&h<l+U._$J?(p=0,f=0):(p=0,i[0]=!0);else\" if(l=\"u[0],h<l-U._$J)p=0,i[0]=!0;else\" if(h<l+u._$j)p=\"0;else{for(var\" c=\"!1,d=1;d<r;++d){if($=u[d],h<$+U._$J){$-U._$J<h?p=d:(p=d-1,f=(h-l)/($-l),s++),c=!0;break}l=$}c||(p=r-1,f=0,i[0]=!0)}a._$wr(p),a._$AL(f)}return\" s},d.prototype._$zr=\"function(t,i,e){var\" r=\"1<<e;r+1\">U._$Qb&&console.log(\"err 23245\\n\");for(var o=this._$Ob.length,n=1,s=1,_=0,a=0;a<r;++a)t[a]=0;for(var h=\"0;h<o;++h){var\" l=\"this._$Ob[h];if(0==l._$SL()){var\" $=\"l._$Lr()*n;if($<0&&at._$3T)throw\" new exception(\"err 23246\");for(var a=\"0;a<r;++a)t[a]+=$}else{for(var\" r=\"new\" float32array(i),o=\"0;o<i;++o)r[o]=e[o];var\" n=\"new\" x;n._$yp(t),n._$t2(i,r),this._$ob.push(n)},d.prototype._$j2=\"function(t){for(var\" i=\"t,e=this._$Ob.length,r=0;r<e;++r){var\" o=\"this._$Ob[r],n=o._$N2(),s=i%o._$N2(),_=o._$d2()[s];console.log(\"%s[%d]=%7.2f\" \",o.getparamid(),s,_),i =n}console.log(\"\\n\")},d.prototype.getparamcount=\"function(){return\" this._$ob.length},d.prototype._$zs=\"function(){return\" this._$ob},r.prototype.identity=\"function(){for(var\" t=\"0;t<16;t++)this.m[t]=t%5==0?1:0},R.prototype.getArray=function(){return\" this.m},r.prototype.getcopymatrix=\"function(){return\" float32array(this.m)},r.prototype.setmatrix=\"function(t){if(null!=t&&16==t.length)for(var\" null=\"=i?null:(this==i?this.mult_safe(this.m,t.m,i.m,e):this.mult_fast(this.m,t.m,i.m,e),i)},R.prototype.mult_safe=function(t,i,e,r){if(t==e){var\" array(16);this.mult_fast(t,i,o,r);for(var>=0;--n)e[n]=o[n]}else this.mult_fast(t,i,e,r)},R.prototype.mult_fast=function(t,i,e,r){r?(e[0]=t[0]*i[0]+t[4]*i[1]+t[8]*i[2],e[4]=t[0]*i[4]+t[4]*i[5]+t[8]*i[6],e[8]=t[0]*i[8]+t[4]*i[9]+t[8]*i[10],e[12]=t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12],e[1]=t[1]*i[0]+t[5]*i[1]+t[9]*i[2],e[5]=t[1]*i[4]+t[5]*i[5]+t[9]*i[6],e[9]=t[1]*i[8]+t[5]*i[9]+t[9]*i[10],e[13]=t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13],e[2]=t[2]*i[0]+t[6]*i[1]+t[10]*i[2],e[6]=t[2]*i[4]+t[6]*i[5]+t[10]*i[6],e[10]=t[2]*i[8]+t[6]*i[9]+t[10]*i[10],e[14]=t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14],e[3]=e[7]=e[11]=0,e[15]=1):(e[0]=t[0]*i[0]+t[4]*i[1]+t[8]*i[2]+t[12]*i[3],e[4]=t[0]*i[4]+t[4]*i[5]+t[8]*i[6]+t[12]*i[7],e[8]=t[0]*i[8]+t[4]*i[9]+t[8]*i[10]+t[12]*i[11],e[12]=t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12]*i[15],e[1]=t[1]*i[0]+t[5]*i[1]+t[9]*i[2]+t[13]*i[3],e[5]=t[1]*i[4]+t[5]*i[5]+t[9]*i[6]+t[13]*i[7],e[9]=t[1]*i[8]+t[5]*i[9]+t[9]*i[10]+t[13]*i[11],e[13]=t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13]*i[15],e[2]=t[2]*i[0]+t[6]*i[1]+t[10]*i[2]+t[14]*i[3],e[6]=t[2]*i[4]+t[6]*i[5]+t[10]*i[6]+t[14]*i[7],e[10]=t[2]*i[8]+t[6]*i[9]+t[10]*i[10]+t[14]*i[11],e[14]=t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14]*i[15],e[3]=t[3]*i[0]+t[7]*i[1]+t[11]*i[2]+t[15]*i[3],e[7]=t[3]*i[4]+t[7]*i[5]+t[11]*i[6]+t[15]*i[7],e[11]=t[3]*i[8]+t[7]*i[9]+t[11]*i[10]+t[15]*i[11],e[15]=t[3]*i[12]+t[7]*i[13]+t[11]*i[14]+t[15]*i[15])},R.prototype.translate=function(t,i,e){this.m[12]=this.m[0]*t+this.m[4]*i+this.m[8]*e+this.m[12],this.m[13]=this.m[1]*t+this.m[5]*i+this.m[9]*e+this.m[13],this.m[14]=this.m[2]*t+this.m[6]*i+this.m[10]*e+this.m[14],this.m[15]=this.m[3]*t+this.m[7]*i+this.m[11]*e+this.m[15]},R.prototype.scale=function(t,i,e){this.m[0]*=t,this.m[4]*=i,this.m[8]*=e,this.m[1]*=t,this.m[5]*=i,this.m[9]*=e,this.m[2]*=t,this.m[6]*=i,this.m[10]*=e,this.m[3]*=t,this.m[7]*=i,this.m[11]*=e},R.prototype.rotateX=function(t){var i=Lt.fcos(t),e=Lt._$9(t),r=this.m[4];this.m[4]=r*i+this.m[8]*e,this.m[8]=r*-e+this.m[8]*i,r=this.m[5],this.m[5]=r*i+this.m[9]*e,this.m[9]=r*-e+this.m[9]*i,r=this.m[6],this.m[6]=r*i+this.m[10]*e,this.m[10]=r*-e+this.m[10]*i,r=this.m[7],this.m[7]=r*i+this.m[11]*e,this.m[11]=r*-e+this.m[11]*i},R.prototype.rotateY=function(t){var i=Lt.fcos(t),e=Lt._$9(t),r=this.m[0];this.m[0]=r*i+this.m[8]*-e,this.m[8]=r*e+this.m[8]*i,r=this.m[1],this.m[1]=r*i+this.m[9]*-e,this.m[9]=r*e+this.m[9]*i,r=m[2],this.m[2]=r*i+this.m[10]*-e,this.m[10]=r*e+this.m[10]*i,r=m[3],this.m[3]=r*i+this.m[11]*-e,this.m[11]=r*e+this.m[11]*i},R.prototype.rotateZ=function(t){var i=Lt.fcos(t),e=Lt._$9(t),r=this.m[0];this.m[0]=r*i+this.m[4]*e,this.m[4]=r*-e+this.m[4]*i,r=this.m[1],this.m[1]=r*i+this.m[5]*e,this.m[5]=r*-e+this.m[5]*i,r=this.m[2],this.m[2]=r*i+this.m[6]*e,this.m[6]=r*-e+this.m[6]*i,r=this.m[3],this.m[3]=r*i+this.m[7]*e,this.m[7]=r*-e+this.m[7]*i},b.prototype=new et,b._$tP=new Object,b._$27=function(){b._$tP.clear()},b.getID=function(t){var i=b._$tP[t];return null==i&&(i=new b(t),b._$tP[t]=i),i},b.prototype._$3s=function(){return new b},F._$kS=-1,F._$pS=0,F._$hb=1,F.STATE_IDENTITY=0,F._$gb=1,F._$fo=2,F._$go=4,F.prototype.transform=function(t,i,e){var r,o,n,s,_,a,h=0,l=0;switch(this._$hi){default:return;case F._$go|F._$fo|F._$gb:for(r=this._$7,o=this._$H,n=this._$k,s=this._$f,_=this._$g,a=this._$w;--e>=0;){var $=t[h++],u=t[h++];i[l++]=r*$+o*u+n,i[l++]=s*$+_*u+a}return;case F._$go|F._$fo:for(r=this._$7,o=this._$H,s=this._$f,_=this._$g;--e>=0;){var $=t[h++],u=t[h++];i[l++]=r*$+o*u,i[l++]=s*$+_*u}return;case F._$go|F._$gb:for(o=this._$H,n=this._$k,s=this._$f,a=this._$w;--e>=0;){var $=t[h++];i[l++]=o*t[h++]+n,i[l++]=s*$+a}return;case F._$go:for(o=this._$H,s=this._$f;--e>=0;){var $=t[h++];i[l++]=o*t[h++],i[l++]=s*$}return;case F._$fo|F._$gb:for(r=this._$7,n=this._$k,_=this._$g,a=this._$w;--e>=0;)i[l++]=r*t[h++]+n,i[l++]=_*t[h++]+a;return;case F._$fo:for(r=this._$7,_=this._$g;--e>=0;)i[l++]=r*t[h++],i[l++]=_*t[h++];return;case F._$gb:for(n=this._$k,a=this._$w;--e>=0;)i[l++]=t[h++]+n,i[l++]=t[h++]+a;return;case F.STATE_IDENTITY:return void(t==i&&h==l||w._$jT(t,h,i,l,2*e))}},F.prototype.update=function(){0==this._$H&&0==this._$f?1==this._$7&&1==this._$g?0==this._$k&&0==this._$w?(this._$hi=F.STATE_IDENTITY,this._$Z=F._$pS):(this._$hi=F._$gb,this._$Z=F._$hb):0==this._$k&&0==this._$w?(this._$hi=F._$fo,this._$Z=F._$kS):(this._$hi=F._$fo|F._$gb,this._$Z=F._$kS):0==this._$7&&0==this._$g?0==this._$k&&0==this._$w?(this._$hi=F._$go,this._$Z=F._$kS):(this._$hi=F._$go|F._$gb,this._$Z=F._$kS):0==this._$k&&0==this._$w?(this._$hi=F._$go|F._$fo,this._$Z=F._$kS):(this._$hi=F._$go|F._$fo|F._$gb,this._$Z=F._$kS)},F.prototype._$RT=function(t){this._$IT(t);var i=t[0],e=t[2],r=t[1],o=t[3],n=Math.sqrt(i*i+r*r),s=i*o-e*r;0==n?at._$so&&console.log(\"affine._$RT() / rt==0\"):(t[0]=n,t[1]=s/n,t[2]=(r*o+i*e)/s,t[3]=Math.atan2(r,i))},F.prototype._$ho=function(t,i,e,r){var o=new Float32Array(6),n=new Float32Array(6);t._$RT(o),i._$RT(n);var s=new Float32Array(6);s[0]=o[0]+(n[0]-o[0])*e,s[1]=o[1]+(n[1]-o[1])*e,s[2]=o[2]+(n[2]-o[2])*e,s[3]=o[3]+(n[3]-o[3])*e,s[4]=o[4]+(n[4]-o[4])*e,s[5]=o[5]+(n[5]-o[5])*e,r._$CT(s)},F.prototype._$CT=function(t){var i=Math.cos(t[3]),e=Math.sin(t[3]);this._$7=t[0]*i,this._$f=t[0]*e,this._$H=t[1]*(t[2]*i-e),this._$g=t[1]*(t[2]*e+i),this._$k=t[4],this._$w=t[5],this.update()},F.prototype._$IT=function(t){t[0]=this._$7,t[1]=this._$f,t[2]=this._$H,t[3]=this._$g,t[4]=this._$k,t[5]=this._$w},C.prototype=new s,C._$cs=\"VISIBLE:\",C._$ar=\"LAYOUT:\",C._$Co=0,C._$D2=[],C._$1T=1,C.loadMotion=function(t){var i=new C,e=[0],r=t.length;i._$yT=0;for(var o=0;o<r;++o){var n=\"255&t[o];if(\"\\n\"!=n&&\"\\r\"!=n)if(\"#\"!=n)if(\"$\"!=n){if(\"a\"<=n&&n<=\"z\"||\"A\"<=n&&n<=\"Z\"||\"_\"==n){for(var\" s=\"o,_=-1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\"=\"==n){_=o;break}if(_\">=0){var a=new B;O.startsWith(t,s,C._$cs)?(a._$RP=B._$hs,a._$4P=new String(t,s,_-s)):O.startsWith(t,s,C._$ar)?(a._$4P=new String(t,s+7,_-s-7),O.startsWith(t,s+7,\"ANCHOR_X\")?a._$RP=B._$xs:O.startsWith(t,s+7,\"ANCHOR_Y\")?a._$RP=B._$us:O.startsWith(t,s+7,\"SCALE_X\")?a._$RP=B._$qs:O.startsWith(t,s+7,\"SCALE_Y\")?a._$RP=B._$Ys:O.startsWith(t,s+7,\"X\")?a._$RP=B._$ws:O.startsWith(t,s+7,\"Y\")&&(a._$RP=B._$Ns)):(a._$RP=B._$Fr,a._$4P=new String(t,s,_-s)),i.motions.push(a);var h=0;for(C._$D2.clear(),o=_+1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\"\\t\"!=n){var\" l=\"O._$LS(t,r,o,e);if(e[0]\">0){C._$D2.push(l),h++;var $=e[0];if($<o){console.log(\"_$n0 _$hi . @live2dmotion loadmotion()\\n\");break}o=\"$}}a._$I0=C._$D2._$BL(),h\">i._$yT&&(i._$yT=h)}}}else{for(var s=o,_=-1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\"=\"==n){_=o;break}var u=\"!1;if(_\">=0)for(_==s+4&&\"f\"==t[s+1]&&\"p\"==t[s+2]&&\"s\"==t[s+3]&&(u=!0),o=_+1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\"\\t\"!=n){var\" l=\"O._$LS(t,r,o,e);e[0]\">0&&u&&5<l&&l<121&&(i._$d0=l),o=e[0]}for(;o<r&&(\"\\n\"!=t[o]&&\"\\r\"!=t[o]);++o);}else for(;o<r&&(\"\\n\"!=\"t[o]&&\"\\r\"!=t[o]);++o);}return\" i._$as=\"1e3*i._$yT/i._$D0|0,i},C.prototype.getDurationMSec=function(){return\" this._$as},c.prototype.dump=\"function(){for(var\" t=\"0;t<this.motions.length;t++){var\" i=\"this.motions[t];console.log(\"_$wL[%s]\" [%d]. \",i._$4p,i._$i0.length);for(var e=\"0;e<i._$I0.length&&e<10;e++)console.log(\"%5.2f\" ,\",i._$i0[e]);console.log(\"\\n\")}},c.prototype.updateparamexe=\"function(t,i,e,r){for(var\" o=\"i-r._$z2,n=o*this._$D0/1e3,s=0|n,_=n-s,a=0;a<this.motions.length;a++){var\" h=\"this.motions[a],l=h._$I0.length,$=h._$4P;if(h._$RP==B._$hs){var\" u=\"h._$I0[s\">=l?l-1:s];t.setParamFloat($,u)}else if(B._$ws<=h._$rp&&h._$rp<=b._$ys);else{var p=\"t.getParamFloat($),f=h._$I0[s\">=l?l-1:s],c=h._$I0[s+1>=l?l-1:s+1],d=f+(c-f)*_,g=p+(d-p)*e;t.setParamFloat($,g)}}s>=this._$yT&&(this._$E?(r._$z2=i,this.loopFadeIn&&(r._$bs=i)):r._$9L=!0)},C.prototype._$r0=function(){return this._$E},C.prototype._$aL=function(t){this._$E=t},C.prototype.isLoopFadeIn=function(){return this.loopFadeIn},C.prototype.setLoopFadeIn=function(t){this.loopFadeIn=t},N.prototype.clear=function(){this.size=0},N.prototype.add=function(t){if(this._$P.length<=this.size){var i=\"new\" float32array(2*this.size);w._$jt(this._$p,0,i,0,this.size),this._$p=\"i}this._$P[this.size++]=t},N.prototype._$BL=function(){var\" t=\"new\" float32array(this.size);return w._$jt(this._$p,0,t,0,this.size),t},b._$fr=\"0,B._$hs=1,B._$ws=100,B._$Ns=101,B._$xs=102,B._$us=103,B._$qs=104,B._$Ys=105,U._$Ms=1,U._$Qs=2,U._$i2=0,U._$No=2,U._$do=U._$Ms,U._$Ls=!0,U._$1r=5,U._$Qb=65,U._$J=1e-4,U._$FT=.001,U._$Ss=3,G._$o7=6,G._$S7=7,G._$s7=8,G._$77=9,G.LIVE2D_FORMAT_VERSION_V2_10_SDK2=10,G.LIVE2D_FORMAT_VERSION_V2_11_SDK2_1=11,G._$T7=G.LIVE2D_FORMAT_VERSION_V2_11_SDK2_1,G._$Is=-2004318072,G._$h0=0,G._$4L=23,G._$7P=33,G._$uT=function(t){console.log(\"_$bo\" :: _$6 _$mo _$e0 : %d\\n\",t)},g._$9o=\"function(t){if(t<40)return\" g._$ut(t),null;if(t<50)return g._$ut(t),null;if(t<60)return g._$ut(t),null;if(t<100)switch(t){case 65:return new z;case 66:return d;case 67:return x;case 68:return 69:return p;case 70:return $t;default:return g._$ut(t),null}else if(t<150)switch(t){case 131:return st;case 133:return tt;case 136:return 137:return ot;case 142:return j}return g._$ut(t),null},y._$hp=\"0,Y._$_0=!0;Y._$V2=-1,Y._$W0=-1,Y._$jr=!1,Y._$ZS=!0,Y._$tr=-1e6,Y._$lr=1e6,Y._$is=32,Y._$e=!1,Y.prototype.getDrawDataIndex=function(t){for(var\">=0;--i)if(null!=this._$aS[i]&&this._$aS[i].getDrawDataID()==t)return i;return-1},Y.prototype.getDrawData=function(t){if(t instanceof b){if(null==this._$Bo){this._$Bo=new Object;for(var i=this._$aS.length,e=0;e<i;e++){var r=\"this._$aS[e],o=r.getDrawDataID();null!=o&&(this._$Bo[o]=r)}}return\" this._$bo[id]}return t<this._$as.length?this._$as[t]:null},y.prototype.release=\"function(){this._$3S.clear(),this._$aS.clear(),this._$F2.clear(),null!=this._$Bo&&this._$Bo.clear(),this._$db.clear(),this._$8b.clear(),this._$Hr.clear()},Y.prototype.init=function(){this._$co++,this._$F2.length\">0&&this.release();for(var t=this._$Ri.getModelImpl(),i=t._$Xr(),r=i.length,o=new Array,n=new Array,s=0;s<r;++s){var _=\"i[s];this._$F2.push(_),this._$Hr.push(_.init(this));for(var\" a=\"_.getBaseData(),h=a.length,l=0;l<h;++l)o.push(a[l]);for(var\" l=\"0;l<h;++l){var\" $=\"a[l].init(this);$._$l2(s),n.push($)}for(var\" u=\"_.getDrawData(),p=u.length,l=0;l<p;++l){var\" f=\"u[l],c=f.init(this);c._$IP=s,this._$aS.push(f),this._$8b.push(c)}}for(var\" d=\"o.length,g=yt._$2o();;){for(var\" y=\"!1,s=0;s<d;++s){var\" m=\"o[s];if(null!=m){var\" t=\"m.getTargetBaseDataID();(null==T||T==g||this.getBaseDataIndex(T)\">=0)&&(this._$3S.push(m),this._$db.push(n[s]),o[s]=null,y=!0)}}if(!y)break}var P=t._$E2();if(null!=P){var S=P._$1s();if(null!=S)for(var v=S.length,s=0;s<v;++s){var l=\"S[s];null!=L&&this._$02(L.getParamID(),L.getDefaultValue(),L.getMinValue(),L.getMaxValue())}}this.clipManager=new\" e(this.dp_webgl),this.clipmanager.init(this,this._$as,this._$8b),this._$qt=\"!0},Y.prototype.update=function(){Y._$e&&_.start(\"_$zL\");for(var\" t=\"this._$_2.length,i=0;i<t;i++)this._$_2[i]!=this._$vr[i]&&(this._$Js[i]=Y._$ZS,this._$vr[i]=this._$_2[i]);var\" e=\"this._$3S.length,r=this._$aS.length,o=W._$or(),n=W._$Pr(),s=n-o+1;(null==this._$Ws||this._$Ws.length<s)&&(this._$Ws=new\" int16array(s),this._$vs=\"new\" int16array(s));for(var i=\"0;i<s;i++)this._$Ws[i]=Y._$V2,this._$Vs[i]=Y._$V2;(null==this._$Er||this._$Er.length<r)&&(this._$Er=new\" int16array(r));for(var a=\"null,h=0;h<e;++h){var\" u=\"null,p=0;p<r;++p){var\" f=\"this._$aS[p],c=this._$8b[p];try{if(f._$Nr(this,c),c._$u2())continue;f._$2b(this,c);var\" d,g=\"Math.floor(f._$zS(this,c)-o);try{d=this._$Vs[g]}catch(t){console.log(\"_$li\" :: %s \\t\\t\\t\\t@@_$fs\\n\",t.tostring(),f.getdrawdataid().tostring()),g=\"Math.floor(f._$zS(this,c)-o);continue}d==Y._$V2?this._$Ws[g]=p:this._$Er[d]=p,this._$Vs[g]=p}catch(t){null==u&&(u=t,at._$sT(at._$H7))}}null!=u&&Y._$_0&&_._$Rb(u),Y._$e&&_.dump(\"_$DL\"),Y._$e&&_.start(\"_$eL\");for(var\">=0;i--)this._$Js[i]=Y._$jr;return this._$QT=!1,Y._$e&&_.dump(\"_$eL\"),!1},Y.prototype.preDraw=function(t){null!=this.clipManager&&(t._$ZT(),this.clipManager.setupClip(this,t))},Y.prototype.draw=function(t){if(null==this._$Ws)return void _._$li(\"call _$Ri.update() before _$Ri.draw() \");var i=this._$Ws.length;t._$ZT();for(var e=0;e<i;++e){var r=\"this._$Ws[e];if(r!=Y._$V2)for(;;){var\" o=\"this._$aS[r],n=this._$8b[r];if(n._$yo()){var\" s=\"n._$IP,a=this._$Hr[s];n._$VS=a.getPartsOpacity(),o.draw(t,this,n)}var\" h=\"this._$Er[r];if(h<=r||h==Y._$W0)break;r=h}}},Y.prototype.getParamIndex=function(t){for(var\" i=\"this._$pb.length-1;i\">=0;--i)if(this._$pb[i]==t)return i;return this._$02(t,0,Y._$tr,Y._$lr)},Y.prototype._$BS=function(t){return this.getBaseDataIndex(t)},Y.prototype.getBaseDataIndex=function(t){for(var i=this._$3S.length-1;i>=0;--i)if(null!=this._$3S[i]&&this._$3S[i].getBaseDataID()==t)return i;return-1},Y.prototype._$UT=function(t,i){var e=new Float32Array(i);return w._$jT(t,0,e,0,t.length),e},Y.prototype._$02=function(t,i,e,r){if(this._$qo>=this._$pb.length){var o=this._$pb.length,n=new Array(2*o);w._$jT(this._$pb,0,n,0,o),this._$pb=n,this._$_2=this._$UT(this._$_2,2*o),this._$vr=this._$UT(this._$vr,2*o),this._$Rr=this._$UT(this._$Rr,2*o),this._$Or=this._$UT(this._$Or,2*o);var s=new Array;w._$jT(this._$Js,0,s,0,o),this._$Js=s}return this._$pb[this._$qo]=t,this._$_2[this._$qo]=i,this._$vr[this._$qo]=i,this._$Rr[this._$qo]=e,this._$Or[this._$qo]=r,this._$Js[this._$qo]=Y._$ZS,this._$qo++},Y.prototype._$Zo=function(t,i){this._$3S[t]=i},Y.prototype.setParamFloat=function(t,i){i<this._$rr[t]&&(i=this._$rr[t]),i>this._$Or[t]&&(i=this._$Or[t]),this._$_2[t]=i},Y.prototype.loadParam=function(){var t=this._$_2.length;t>this._$fs.length&&(t=this._$fs.length),w._$jT(this._$fs,0,this._$_2,0,t)},Y.prototype.saveParam=function(){var t=this._$_2.length;t>this._$fs.length&&(this._$fs=new Float32Array(t)),w._$jT(this._$_2,0,this._$fs,0,t)},Y.prototype._$v2=function(){return this._$co},Y.prototype._$WS=function(){return this._$QT},Y.prototype._$Xb=function(t){return this._$Js[t]==Y._$ZS},Y.prototype._$vs=function(){return this._$Es},Y.prototype._$Tr=function(){return this._$ZP},Y.prototype.getBaseData=function(t){return this._$3S[t]},Y.prototype.getParamFloat=function(t){return this._$_2[t]},Y.prototype.getParamMax=function(t){return this._$Or[t]},Y.prototype.getParamMin=function(t){return this._$Rr[t]},Y.prototype.setPartsOpacity=function(t,i){this._$Hr[t].setPartsOpacity(i)},Y.prototype.getPartsOpacity=function(t){return this._$Hr[t].getPartsOpacity()},Y.prototype.getPartsDataIndex=function(t){for(var i=this._$F2.length-1;i>=0;--i)if(null!=this._$F2[i]&&this._$F2[i]._$p2()==t)return i;return-1},Y.prototype._$q2=function(t){return this._$db[t]},Y.prototype._$C2=function(t){return this._$8b[t]},Y.prototype._$Bb=function(t){return this._$Hr[t]},Y.prototype._$5s=function(t,i){for(var e=this._$Ws.length,r=t,o=0;o<e;++o){var n=\"this._$Ws[o];if(n!=Y._$V2)for(;;){var\" s=\"this._$8b[n];s._$yo()&&(s._$GT()._$B2(this,s,r),r+=i);var\" _=\"this._$Er[n];if(_<=n||_==Y._$W0)break;n=_}}},Y.prototype.setDrawParam=function(t){this.dp_webgl=t},Y.prototype.getDrawParam=function(){return\" this.dp_webgl},k._$0t=\"function(t){return\" k._$0t(new _$5(t))},k._$0t=\"function(t){if(!t.exists())throw\" new _$ls(t._$3b());for(var i,e=\"t.length(),r=new\" int8array(e),o=\"new\" _$xs(new _$kb(t),8192),n=\"0;(i=o.read(r,n,e-n))\">0;)n+=i;return r},k._$C=function(t){var i=null,e=null;try{i=t instanceof Array?t:new _$Xs(t,8192),e=new _$js;for(var r,o=new Int8Array(1e3);(r=i.read(o))>0;)e.write(o,0,r);return e._$TS()}finally{null!=t&&t.close(),null!=e&&(e.flush(),e.close())}},V.prototype._$T2=function(){return w.getUserTimeMSec()+Math._$10()*(2*this._$Br-1)},V.prototype._$uo=function(t){this._$Br=t},V.prototype._$QS=function(t,i,e){this._$Dr=t,this._$Cb=i,this._$mr=e},V.prototype._$7T=function(t){var i,e=w.getUserTimeMSec(),r=0;switch(this._$_L){case STATE_CLOSING:r=(e-this._$bb)/this._$Dr,r>=1&&(r=1,this._$_L=wt.STATE_CLOSED,this._$bb=e),i=1-r;break;case STATE_CLOSED:r=(e-this._$bb)/this._$Cb,r>=1&&(this._$_L=wt.STATE_OPENING,this._$bb=e),i=0;break;case STATE_OPENING:r=(e-this._$bb)/this._$mr,r>=1&&(r=1,this._$_L=wt.STATE_INTERVAL,this._$12=this._$T2()),i=r;break;case STATE_INTERVAL:this._$12<e&&(this._$_l=wt.state_closing,this._$bb=e),i=1;break;case state_first:default:this._$_l=\"wt.STATE_INTERVAL,this._$12=this._$T2(),i=1}this._$jo||(i=-i),t.setParamFloat(this._$iL,i),t.setParamFloat(this._$0L,i)};var\" wt=\"function(){};wt.STATE_FIRST=\"STATE_FIRST\",wt.STATE_INTERVAL=\"STATE_INTERVAL\",wt.STATE_CLOSING=\"STATE_CLOSING\",wt.STATE_CLOSED=\"STATE_CLOSED\",wt.STATE_OPENING=\"STATE_OPENING\",X.prototype=new\" e,x._$as=\"32,X._$Gr=!1,X._$NT=null,X._$vS=null,X._$no=null,X._$9r=function(t){return\" new float32array(t)},x._$vb=\"function(t){return\" int16array(t)},x._$cr=\"function(t,i){return\" null=\"=t||t._$yL()<i.length?(t=X._$9r(2*i.length),t.put(i),t._$oT(0)):(t.clear(),t.put(i),t._$oT(0)),t},X._$mb=function(t,i){return\" x._$gr},x._$as=\"function(t){X._$Gr=t},X.prototype.setGL=function(t){this.gl=t},X.prototype.setTransform=function(t){this.transform=t},X.prototype._$ZT=function(){},X.prototype._$Uo=function(t,i,e,r,o,n,s,_){if(!(n<.01)){var\" a=\"this._$U2[t],h=n\">.9?at.EXPAND_W:0;this.gl.drawElements(a,e,r,o,n,h,this.transform,_)}},X.prototype._$Rs=function(){throw new Error(\"_$Rs\")},X.prototype._$Ds=function(t){throw new Error(\"_$Ds\")},X.prototype._$K2=function(){for(var t=0;t<this._$sb.length;t++){0!=this._$sb[t]&&(this.gl._$sr(1,this._$sb,t),this._$sb[t]=0)}},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$sb[t]=i},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$u2[t]=i},x.prototype._$ns=function(t){var i=\"Math.max(2*this._$sb.length,t+1+10),e=new\" int32array(i);w._$jt(this._$sb,0,e,0,this._$sb.length),this._$sb=\"e;var\" r=\"new\" array;w._$jt(this._$u2,0,r,0,this._$u2.length),this._$u2=\"r},z.prototype=new\" i,z._$xo=\"new\" float32array(2),z._$io=\"new\" float32array(2),z._$0o=\"new\" float32array(2),z._$lo=\"new\" float32array(2),z._$to=\"new\" float32array(2),z._$po=\"new\" float32array(2),z._$gt=\"new\" array,z.prototype._$zp=\"function(){this._$GS=new\" d,this._$gs._$zp(),this._$y0=\"new\" array},z.prototype.gettype=\"function(){return\" i._$c2},z.prototype._$f0=\"function(t){I.prototype._$F0.call(this,t),this._$GS=t._$nP(),this._$Y0=t._$nP(),I.prototype.readV2_opacity.call(this,t)},z.prototype.init=function(t){var\" h(this);return i._$yr=\"new\" p,this._$32()&&(i._$wr=\"new\" p),i},z.prototype._$nr=\"function(t,i){this!=i._$GT()&&console.log(\"###\" assert!! ### \");var e=\"i;if(this._$GS._$Ur(t)){var\" o=\"this._$GS._$Q2(t,r);i._$Ib(r[0]),this.interpolateOpacity(t,this._$GS,i,r);var\" n=\"t._$vs(),s=t._$Tr();if(this._$GS._$zr(n,s,o),o<=0){var\" _=\"this._$Y0[n[0]];e._$Yr.init(_)}else\" if(1=\"=o){var\" if(2=\"=o){var\" if(3=\"=o){var\" c=\"this._$Y0[n[0]],d=this._$Y0[n[1]],g=this._$Y0[n[2]],y=this._$Y0[n[3]],m=this._$Y0[n[4]],T=this._$Y0[n[5]],P=this._$Y0[n[6]],S=this._$Y0[n[7]],h=s[0],u=s[1],v=s[2],p=c._$fL+(d._$fL-c._$fL)*h,f=g._$fL+(y._$fL-g._$fL)*h,L=m._$fL+(T._$fL-m._$fL)*h,M=P._$fL+(S._$fL-P._$fL)*h;e._$Yr._$fL=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$gL+(d._$gL-c._$gL)*h,f=g._$gL+(y._$gL-g._$gL)*h,L=m._$gL+(T._$gL-m._$gL)*h,M=P._$gL+(S._$gL-P._$gL)*h,e._$Yr._$gL=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$B0+(d._$B0-c._$B0)*h,f=g._$B0+(y._$B0-g._$B0)*h,L=m._$B0+(T._$B0-m._$B0)*h,M=P._$B0+(S._$B0-P._$B0)*h,e._$Yr._$B0=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$z0+(d._$z0-c._$z0)*h,f=g._$z0+(y._$z0-g._$z0)*h,L=m._$z0+(T._$z0-m._$z0)*h,M=P._$z0+(S._$z0-P._$z0)*h,e._$Yr._$z0=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$qT+(d._$qT-c._$qT)*h,f=g._$qT+(y._$qT-g._$qT)*h,L=m._$qT+(T._$qT-m._$qT)*h,M=P._$qT+(S._$qT-P._$qT)*h,e._$Yr._$qT=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u)}else\" if(4=\"=o){var\" j=\"0|Math.pow(2,o),q=new\" float32array(j),j=\"0;J<j;J++){for(var\" q=\"J,Z=1,K=0;K<o;K++)Z*=Q%2==0?1-s[K]:s[K],Q/=2;q[J]=Z}for(var\" tt=\"new\" array,it=\"0;it<j;it++)tt[it]=this._$Y0[n[it]];for(var\" et=\"0,rt=0,ot=0,nt=0,st=0,it=0;it<j;it++)et+=q[it]*tt[it]._$fL,rt+=q[it]*tt[it]._$gL,ot+=q[it]*tt[it]._$B0,nt+=q[it]*tt[it]._$z0,st+=q[it]*tt[it]._$qT;e._$Yr._$fL=et,e._$Yr._$gL=rt,e._$Yr._$B0=ot,e._$Yr._$z0=nt,e._$Yr._$qT=st}var\" _$0p _$g :: %s\",r),e._$hs(!1);else{var a=\"z._$io;a[0]=0,a[1]=-.1;n._$GT().getType()==I._$c2?a[1]=-10:a[1]=-.1;var\" h=\"z._$0o;this._$Jr(t,o,n,s,a,h);var\" l=\"Lt._$92(a,h);o._$nb(t,n,s,s,1,0,2),e._$Wr._$fL=s[0],e._$Wr._$gL=s[1],e._$Wr._$B0=e._$Yr._$B0,e._$Wr._$z0=e._$Yr._$z0,e._$Wr._$qT=e._$Yr._$qT-l*Lt._$NS;var\" $=\"n.getTotalScale();e.setTotalScale_notForClient($*e._$Wr._$B0);var\" u=\"n.getTotalOpacity();e.setTotalOpacity(u*e.getInterpolatedOpacity()),e._$Wr.reflectX=e._$Yr.reflectX,e._$Wr.reflectY=e._$Yr.reflectY,e._$hS(n._$yo())}else\" e._$hs(!1)}}else e.settotalscale_notforclient(e._$yr._$b0),e.settotalopacity(e.getinterpolatedopacity())},z.prototype._$nb=\"function(t,i,e,r,o,n,s){this!=i._$GT()&&console.log(\"###\" \");for(var _,a,h=\"i,l=null!=h._$Wr?h._$Wr:h._$Yr,$=Math.sin(Lt._$bS*l._$qT),u=Math.cos(Lt._$bS*l._$qT),p=h.getTotalScale(),f=l.reflectX?-1:1,c=l.reflectY?-1:1,d=u*p*f,g=-$*p*c,y=$*p*f,m=u*p*c,T=l._$fL,P=l._$gL,S=o*s,v=n;v<S;v+=s)_=e[v],a=e[v+1],r[v]=d*_+g*a+T,r[v+1]=y*_+m*a+P},z.prototype._$Jr=function(t,i,e,r,o,n){i!=e._$GT()&&console.log(\"###\" s=\"z._$Lo;z._$Lo[0]=r[0],z._$Lo[1]=r[1],i._$nb(t,e,s,s,1,0,2);for(var\" n[0]=\"_[0],void(n[1]=_[1]);if(a[0]=r[0]-h*o[0],a[1]=r[1]-h*o[1],i._$nb(t,e,a,_,1,0,2),_[0]-=s[0],_[1]-=s[1],0!=_[0]||0!=_[1])return\" _[0]=\"-_[0],_[0]=-_[0],n[0]=_[0],void(n[1]=_[1]);h*=.1}at._$so&&console.log(\"_$L0\" to transform _$sp\\n\")},h.prototype=\"new\" _t,w.prototype=\"new\" m,w._$ur=\"-2,W._$ES=500,W._$wb=2,W._$8S=3,W._$os=4,W._$52=W._$ES,W._$R2=W._$ES,W._$Sb=function(t){for(var\">=0;--i){var e=t[i];e<w._$52?w._$52=e:e>W._$R2&&(W._$R2=e)}},W._$or=function(){return W._$52},W._$Pr=function(){return W._$R2},W.prototype._$F0=function(t){this._$gP=t._$nP(),this._$dr=t._$nP(),this._$GS=t._$nP(),this._$qb=t._$6L(),this._$Lb=t._$cS(),this._$mS=t._$Tb(),t.getFormatVersion()>=G._$T7?(this.clipID=t._$nP(),this.clipIDList=this.convertClipIDForV2_11(this.clipID)):this.clipIDList=null,W._$Sb(this._$Lb)},W.prototype.getClipIDList=function(){return this.clipIDList},W.prototype._$Nr=function(t,i){if(i._$IS[0]=!1,i._$Us=v._$Z2(t,this._$GS,i._$IS,this._$Lb),at._$Zs);else if(i._$IS[0])return;i._$7s=v._$br(t,this._$GS,i._$IS,this._$mS)},W.prototype._$2b=function(t){},W.prototype.getDrawDataID=function(){return this._$gP},W.prototype._$j2=function(t){this._$gP=t},W.prototype.getOpacity=function(t,i){return i._$7s},W.prototype._$zS=function(t,i){return i._$Us},W.prototype.getTargetBaseDataID=function(){return this._$dr},W.prototype._$gs=function(t){this._$dr=t},W.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},W.prototype.getType=function(){},j._$42=0,j.prototype._$1b=function(){return this._$3S},j.prototype.getDrawDataList=function(){return this._$aS},j.prototype._$F0=function(t){this._$NL=t._$nP(),this._$aS=t._$nP(),this._$3S=t._$nP()},j.prototype._$kr=function(t){t._$Zo(this._$3S),t._$xo(this._$aS),this._$3S=null,this._$aS=null},q.prototype=new i,q.loadModel=function(t){var e=new q;return i._$62(e,t),e},q.loadModel=function(t){var e=new q;return i._$62(e,t),e},q._$to=function(){return new q},q._$er=function(t){var i=new _$5(\"../_$_r/_$t0/_$Ri/_$_P._$d\");if(0==i.exists())throw new _$ls(\"_$t0 _$_ _$6 _$Ui :: \"+i._$PL());for(var e=[\"../_$_r/_$t0/_$Ri/_$_P.512/_$CP._$1\",\"../_$_r/_$t0/_$Ri/_$_P.512/_$vP._$1\",\"../_$_r/_$t0/_$Ri/_$_P.512/_$EP._$1\",\"../_$_r/_$t0/_$Ri/_$_P.512/_$pP._$1\"],r=q.loadModel(i._$3b()),o=0;o<e.length;o++){var n=\"new\" _$5(e[o]);if(0=\"=n.exists())throw\" new _$ls(\"_$t0 _$_ _$6 _$ui :: \"+n._$pl());r.settexture(o,_$nl._$_o(t,n._$3b()))}return r},q.prototype.setgl=\"function(t){this._$zo.setGL(t)},q.prototype.setTransform=function(t){this._$zo.setTransform(t)},q.prototype.draw=function(){this._$5S.draw(this._$zo)},q.prototype._$K2=function(){this._$zo._$K2()},q.prototype.setTexture=function(t,i){null==this._$zo&&_._$li(\"_$Yi\" for qt _$ki _$xs() is _$ui!!\"),this._$zo.settexture(t,i)},q.prototype.settexture=\"function(t,i){null==this._$zo&&_._$li(\"_$Yi\" _$ui!!\"),this._$zo.settexture(t,i)},q.prototype._$rs=\"function(){return\" this._$zo._$rs()},q.prototype._$ds=\"function(t){this._$zo._$Ds(t)},q.prototype.getDrawParam=function(){return\" this._$zo},j.prototype=\"new\" s,j._$cs=\"VISIBLE:\" ,j._$ar=\"LAYOUT:\" ,j.mtn_prefix_fadein=\"FADEIN:\" ,j.mtn_prefix_fadeout=\"FADEOUT:\" ,j._$co=\"0,J._$1T=1,J.loadMotion=function(t){var\" i=\"k._$C(t);return\" j.loadmotion(i)},j.loadmotion=\"function(t){t\" instanceof arraybuffer&&(t=\"new\" dataview(t));var j,e=\"[0],r=t.byteLength;i._$yT=0;for(var\" o=\"0;o<r;++o){var\" _=\"o,a=-1;o<r&&(\"\\r\"!=(n=Q(t,o))&&\"\\n\"!=n);++o)if(\"=\"==n){a=o;break}if(a\">=0){var h=new B;O.startsWith(t,_,J._$cs)?(h._$RP=B._$hs,h._$4P=O.createString(t,_,a-_)):O.startsWith(t,_,J._$ar)?(h._$4P=O.createString(t,_+7,a-_-7),O.startsWith(t,_+7,\"ANCHOR_X\")?h._$RP=B._$xs:O.startsWith(t,_+7,\"ANCHOR_Y\")?h._$RP=B._$us:O.startsWith(t,_+7,\"SCALE_X\")?h._$RP=B._$qs:O.startsWith(t,_+7,\"SCALE_Y\")?h._$RP=B._$Ys:O.startsWith(t,_+7,\"X\")?h._$RP=B._$ws:O.startsWith(t,_+7,\"Y\")&&(h._$RP=B._$Ns)):(h._$RP=B._$Fr,h._$4P=O.createString(t,_,a-_)),i.motions.push(h);var l=0,$=[];for(o=a+1;o<r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\"\\t\"!=n){var\" u=\"O._$LS(t,r,o,e);if(e[0]\">0){$.push(u),l++;var p=e[0];if(p<o){console.log(\"_$n0 _$hi . @live2dmotion loadmotion()\\n\");break}o=\"p-1}}h._$I0=new\" float32array($),l>i._$yT&&(i._$yT=l)}}}else{for(var _=o,a=-1;o<r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\"=\"==n){a=o;break}var f=\"!1;if(a\">=0)for(a==_+4&&\"f\"==Q(t,_+1)&&\"p\"==Q(t,_+2)&&\"s\"==Q(t,_+3)&&(f=!0),o=a+1;o<r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\"\\t\"!=n){var\" u=\"O._$LS(t,r,o,e);e[0]\">0&&f&&5<u&&u<121&&(i._$d0=u),o=e[0]}for(;o<r&&(\"\\n\"!=q(t,o)&&\"\\r\"!=q(t,o));++o);}else for(;o<r&&(\"\\n\"!=\"Q(t,o)&&\"\\r\"!=Q(t,o));++o);}return\" i._$rr=\"1e3*i._$yT/i._$D0|0,i},J.prototype.getDurationMSec=function(){return\" this._$e?-1:this._$rr},j.prototype.getloopdurationmsec=\"function(){return\" this._$rr},j.prototype.dump=\"function(){for(var\" t=\"0;t<this.motions.length;t++){var\" i=\"this.motions[t];console.log(\"_$wL[%s]\" [%d]. \",i._$4p,i._$i0.length);for(var e=\"0;e<i._$I0.length&&e<10;e++)console.log(\"%5.2f\" ,\",i._$i0[e]);console.log(\"\\n\")}},j.prototype.updateparamexe=\"function(t,i,e,r){for(var\" o=\"i-r._$z2,n=o*this._$D0/1e3,s=0|n,_=n-s,a=0;a<this.motions.length;a++){var\" h=\"this.motions[a],l=h._$I0.length,$=h._$4P;if(h._$RP==B._$hs){var\" u=\"h._$I0[s\">=l?l-1:s];t.setParamFloat($,u)}else if(B._$ws<=h._$rp&&h._$rp<=b._$ys);else{var p,f=\"t.getParamIndex($),c=t.getModelContext(),d=c.getParamMax(f),g=c.getParamMin(f),y=.4*(d-g),m=c.getParamFloat(f),T=h._$I0[s\">=l?l-1:s],P=h._$I0[s+1>=l?l-1:s+1];p=T<p&&p-t>y||T>P&&T-P>y?T:T+(P-T)*_;var S=m+(p-m)*e;t.setParamFloat($,S)}}s>=this._$yT&&(this._$E?(r._$z2=i,this.loopFadeIn&&(r._$bs=i)):r._$9L=!0),this._$eP=e},J.prototype._$r0=function(){return this._$E},J.prototype._$aL=function(t){this._$E=t},J.prototype._$S0=function(){return this._$D0},J.prototype._$U0=function(t){this._$D0=t},J.prototype.isLoopFadeIn=function(){return this.loopFadeIn},J.prototype.setLoopFadeIn=function(t){this.loopFadeIn=t},N.prototype.clear=function(){this.size=0},N.prototype.add=function(t){if(this._$P.length<=this.size){var i=\"new\" float32array(2*this.size);w._$jt(this._$p,0,i,0,this.size),this._$p=\"i}this._$P[this.size++]=t},N.prototype._$BL=function(){var\" t=\"new\" float32array(this.size);return w._$jt(this._$p,0,t,0,this.size),t},b._$fr=\"0,B._$hs=1,B._$ws=100,B._$Ns=101,B._$xs=102,B._$us=103,B._$qs=104,B._$Ys=105,Z.prototype=new\" i,z._$gt=\"new\" array,z.prototype._$zp=\"function(){this._$GS=new\" d,this._$gs._$zp()},z.prototype._$f0=\"function(t){I.prototype._$F0.call(this,t),this._$A=t._$6L(),this._$o=t._$6L(),this._$GS=t._$nP(),this._$Eo=t._$nP(),I.prototype.readV2_opacity.call(this,t)},Z.prototype.init=function(t){var\" k(this),e=\"(this._$o+1)*(this._$A+1);return\" null!=\"i._$Cr&&(i._$Cr=null),i._$Cr=new\" float32array(2*e),null!=\"i._$hr&&(i._$hr=null),this._$32()?i._$hr=new\" float32array(2*e):i._$hr=\"null,i},Z.prototype._$Nr=function(t,i){var\" e=\"i;if(this._$GS._$Ur(t)){var\" r=\"this._$VT(),o=Z._$gT;o[0]=!1,v._$Vr(t,this._$GS,o,r,this._$Eo,e._$Cr,0,2),i._$Ib(o[0]),this.interpolateOpacity(t,this._$GS,i,o)}},Z.prototype._$2b=function(t,i){var\" _$0p _$g :: %s\",r),e._$hs(!1);else{var o=\"t.getBaseData(e._$8r),n=t._$q2(e._$8r);if(null!=o&&n._$yo()){var\" s=\"n.getTotalScale();e.setTotalScale_notForClient(s);var\" a=\"n.getTotalOpacity();e.setTotalOpacity(a*e.getInterpolatedOpacity()),o._$nb(t,n,e._$Cr,e._$hr,this._$VT(),0,2),e._$hS(!0)}else\" e._$hs(!1)}}else e.settotalopacity(e.getinterpolatedopacity())},z.prototype._$nb=\"function(t,i,e,r,o,n,s){var\" _=\"i,a=null!=_._$hr?_._$hr:_._$Cr;Z.transformPoints_sdk2(e,r,o,n,s,a,this._$o,this._$A)},Z.transformPoints_sdk2=function(i,e,r,o,n,s,_,a){for(var\" h,l,$,u=\"r*n,p=0,f=0,c=0,d=0,g=0,y=0,m=!1,T=o;T<u;T+=n){var\" p,s,v,l;if(v=\"i[T],L=i[T+1],P=v*_,S=L*a,P<0||S<0||_<=P||a<=S){var\" m=\"_+1;if(!m){m=!0,p=.25*(s[2*(0+0*M)]+s[2*(_+0*M)]+s[2*(0+a*M)]+s[2*(_+a*M)]),f=.25*(s[2*(0+0*M)+1]+s[2*(_+0*M)+1]+s[2*(0+a*M)+1]+s[2*(_+a*M)+1]);var\" x=\"s[2*(0+0*M)],O=s[2*(0+0*M)+1],D=p-2*c,R=f-2*d,b=p-2*g,F=f-2*y,C=p-2*c-2*g,N=f-2*d-2*y,B=.5*(v-\" -2),u=\".5*(L-\" -2);b+u<=\"1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l>=1){var b=s[2*(0+a*M)],F=s[2*(0+a*M)+1],C=p-2*c+1*g,N=f-2*d+1*y,x=p+3*g,O=f+3*y,D=p-2*c+3*g,R=f-2*d+3*y,B=.5*(v- -2),U=.5*(L-1);B+U<=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var g=\"0|S;G==a&&(G=a-1);var\" b=\".5*(v-\" -2),u=\"S-G,Y=G/a,k=(G+1)/a,b=s[2*(0+G*M)],F=s[2*(0+G*M)+1],x=s[2*(0+(G+1)*M)],O=s[2*(0+(G+1)*M)+1],C=p-2*c+Y*g,N=f-2*d+Y*y,D=p-2*c+k*g,R=f-2*d+k*y;B+U<=1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(1<=\"v)if(L<=0){var\" d=\"s[2*(_+0*M)],R=s[2*(_+0*M)+1],x=p+3*c,O=f+3*d,C=p+1*c-2*g,N=f+1*d-2*y,b=p+3*c-2*g,F=f+3*d-2*y,B=.5*(v-1),U=.5*(L-\" -2);b+u<=\"1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l>=1){var C=s[2*(_+a*M)],N=s[2*(_+a*M)+1],b=p+3*c+1*g,F=f+3*d+1*y,D=p+1*c+3*g,R=f+1*d+3*y,x=p+3*c+3*g,O=f+3*d+3*y,B=.5*(v-1),U=.5*(L-1);B+U<=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var g=\"0|S;G==a&&(G=a-1);var\" b=\".5*(v-1),U=S-G,Y=G/a,k=(G+1)/a,C=s[2*(_+G*M)],N=s[2*(_+G*M)+1],D=s[2*(_+(G+1)*M)],R=s[2*(_+(G+1)*M)+1],b=p+3*c+Y*g,F=f+3*d+Y*y,x=p+3*c+k*g,O=f+3*d+k*y;B+U<=1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l<=\"0){var\" v=\"0|P;V==_&&(V=_-1);var\" -2),x=\"V/_,z=(V+1)/_,D=s[2*(V+0*M)],R=s[2*(V+0*M)+1],x=s[2*(V+1+0*M)],O=s[2*(V+1+0*M)+1],C=p+X*c-2*g,N=f+X*d-2*y,b=p+z*c-2*g,F=f+z*d-2*y;B+U<=1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l>=1){var V=0|P;V==_&&(V=_-1);var B=P-V,U=.5*(L-1),X=V/_,z=(V+1)/_,C=s[2*(V+a*M)],N=s[2*(V+a*M)+1],b=s[2*(V+1+a*M)],F=s[2*(V+1+a*M)+1],D=p+X*c+3*g,R=f+X*d+3*y,x=p+z*c+3*g,O=f+z*d+3*y;B+U<=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else t.err.printf(\"_$li calc : %.4f , %.4f\\t\\t\\t\\t\\t@@bdboxgrid\\n\",v,l);else e[t]=\"p+v*c+L*g,e[T+1]=f+v*d+L*y}else\" l=\"P-(0|P),$=S-(0|S),h=2*((0|P)+(0|S)*(_+1)),l+$<1?(e[T]=s[h]*(1-l-$)+s[h+2]*l+s[h+2*(_+1)]*$,e[T+1]=s[h+1]*(1-l-$)+s[h+3]*l+s[h+2*(_+1)+1]*$):(e[T]=s[h+2*(_+1)+2]*(l-1+$)+s[h+2*(_+1)]*(1-l)+s[h+2]*(1-$),e[T+1]=s[h+2*(_+1)+3]*(l-1+$)+s[h+2*(_+1)+1]*(1-l)+s[h+3]*(1-$))}},Z.prototype.transformPoints_sdk1=function(t,i,e,r,o,n,s){for(var\" _,a,h,l,$,u,p,f=\"i,c=this._$o,d=this._$A,g=o*s,y=null!=f._$hr?f._$hr:f._$Cr,m=n;m<g;m+=s)at._$ts?(_=e[m],a=e[m+1],_<0?_=0:_\">1&&(_=1),a<0?a=0:a>1&&(a=1),_*=c,a*=d,h=0|_,l=0|a,h>c-1&&(h=c-1),l>d-1&&(l=d-1),u=_-h,p=a-l,$=2*(h+l*(c+1))):(_=e[m]*c,a=e[m+1]*d,u=_-(0|_),p=a-(0|a),$=2*((0|_)+(0|a)*(c+1))),u+p<1?(r[m]=y[$]*(1-u-p)+y[$+2]*u+y[$+2*(c+1)]*p,r[m+1]=y[$+1]*(1-u-p)+y[$+3]*u+y[$+2*(c+1)+1]*p):(r[m]=y[$+2*(c+1)+2]*(u-1+p)+y[$+2*(c+1)]*(1-u)+y[$+2]*(1-p),r[m+1]=y[$+2*(c+1)+3]*(u-1+p)+y[$+2*(c+1)+1]*(1-u)+y[$+3]*(1-p))},z.prototype._$vt=function(){return(this._$o+1)*(this._$a+1)},z.prototype.gettype=function(){return i._$_b},k.prototype=\"new\" _t,tt._$42=\"0,tt.prototype._$zP=function(){this._$3S=new\" array,this._$as=\"new\" array},tt.prototype._$f0=\"function(t){this._$g0=t._$8L(),this.visible=t._$8L(),this._$NL=t._$nP(),this._$3S=t._$nP(),this._$aS=t._$nP()},tt.prototype.init=function(t){var\" i=\"new\" it(this);return i.setpartsopacity(this.isvisible()?1:0),i},tt.prototype._$6o=\"function(t){if(null==this._$3S)throw\" new error(\"_$3s _$6 _$wo@_$6o\");this._$3s.push(t)},tt.prototype._$3o=\"function(t){if(null==this._$aS)throw\" error(\"_$as _$wo@_$3o\");this._$as.push(t)},tt.prototype._$zo=\"function(t){this._$3S=t},tt.prototype._$xo=function(t){this._$aS=t},tt.prototype.isVisible=function(){return\" this.visible},tt.prototype._$ul=\"function(){return\" this._$g0},tt.prototype._$kp=\"function(t){this.visible=t},tt.prototype._$ET=function(t){this._$g0=t},tt.prototype.getBaseData=function(){return\" this._$3s},tt.prototype.getdrawdata=\"function(){return\" this._$as},tt.prototype._$p2=\"function(){return\" this._$nl},tt.prototype._$ob=\"function(t){this._$NL=t},tt.prototype.getPartsID=function(){return\" this._$nl},tt.prototype._$mp=\"function(t){this._$NL=t},it.prototype=new\" $,it.prototype.getpartsopacity=\"function(){return\" this._$vs},it.prototype.setpartsopacity=\"function(t){this._$VS=t},et._$L7=function(){u._$27(),yt._$27(),b._$27(),l._$27()},et.prototype.toString=function(){return\" this.id},rt.prototype._$f0=\"function(t){},ot.prototype._$1s=function(){return\" this._$4s},ot.prototype._$zp=\"function(){this._$4S=new\" array},ot.prototype._$f0=\"function(t){this._$4S=t._$nP()},ot.prototype._$Ks=function(t){this._$4S.push(t)},nt.tr=new\" gt,nt._$50=\"new\" gt,nt._$ti=\"new\" array(0,0),nt._$pi=\"new\" array(0,0),nt._$b=\"new\" array(0,0),nt.prototype._$lp=\"function(t,i,e,r){this.viewport=new\" array(t,i,e,r)},nt.prototype._$bl=\"function(){this.context.save();var\" t=\"this.viewport;null!=t&&(this.context.beginPath(),this.context._$Li(t[0],t[1],t[2],t[3]),this.context.clip())},nt.prototype._$ei=function(){this.context.restore()},nt.prototype.drawElements=function(t,i,e,r,o,n,s,a){try{o!=this._$Qo&&(this._$Qo=o,this.context.globalAlpha=o);for(var\" h=\"i.length,l=t.width,$=t.height,u=this.context,p=this._$xP,f=this._$uP,c=this._$6r,d=this._$3r,g=nt.tr,y=nt._$Ti,m=nt._$Pi,T=nt._$B,P=0;P<h;P+=3){u.save();var\" s=\"i[P],v=i[P+1],L=i[P+2],M=p+c*e[2*S],E=f+d*e[2*S+1],A=p+c*e[2*v],I=f+d*e[2*v+1],w=p+c*e[2*L],x=f+d*e[2*L+1];s&&(s._$PS(M,E,T),M=T[0],E=T[1],s._$PS(A,I,T),A=T[0],I=T[1],s._$PS(w,x,T),w=T[0],x=T[1]);var\" o=\"l*r[2*S],D=$-$*r[2*S+1],R=l*r[2*v],b=$-$*r[2*v+1],F=l*r[2*L],C=$-$*r[2*L+1],N=Math.atan2(b-D,R-O),B=Math.atan2(I-E,A-M),U=A-M,G=I-E,Y=Math.sqrt(U*U+G*G),k=R-O,V=b-D,X=Math.sqrt(k*k+V*V),z=Y/X;It._$ni(F,C,O,D,R-O,b-D,-(b-D),R-O,y),It._$ni(w,x,M,E,A-M,I-E,-(I-E),A-M,m);var\" it=\"a._$e0;if(it.gl_cacheImage=it.gl_cacheImage||{},!it.gl_cacheImage[P]){var\" et=\"nt.createCanvas(K-Q,tt-Z);at.DEBUG_DATA.LDGL_CANVAS_MB=at.DEBUG_DATA.LDGL_CANVAS_MB||0,at.DEBUG_DATA.LDGL_CANVAS_MB+=(K-Q)*(tt-Z)*4;var\" rt=\"et.getContext(\"2d\");rt.translate(-Q,-Z),nt.clip(rt,g,n,Y,O,D,R,b,F,C,M,E,A,I,w,x),rt.drawImage(t,0,0),it.gl_cacheImage[P]={cacheCanvas:et,cacheContext:rt}}u.drawImage(it.gl_cacheImage[P].cacheCanvas,Q,Z)}else\" at.ignore_clip||nt.clip(u,g,n,y,o,d,r,b,f,c,m,e,a,i,w,x),at.use_adjust_translation&&(w=\"0,j=l,q=0,J=$),u.drawImage(t,W,q,j-W,J-q,W,q,j-W,J-q);u.restore()}}catch(t){_._$Rb(t)}},nt.clip=function(t,i,e,r,o,n,s,_,a,h,l,$,u,p,f,c){e\">.02?nt.expandClip(t,i,e,r,l,$,u,p,f,c):nt.clipWithTransform(t,null,o,n,s,_,a,h)},nt.expandClip=function(t,i,e,r,o,n,s,_,a,h){var l=s-o,$=_-n,u=a-o,p=h-n,f=l*p-$*u>0?e:-e,c=-$,d=l,g=a-s,y=h-_,m=-y,T=g,P=Math.sqrt(g*g+y*y),S=-p,v=u,L=Math.sqrt(u*u+p*p),M=o-f*c/r,E=n-f*d/r,A=s-f*c/r,I=_-f*d/r,w=s-f*m/P,x=_-f*T/P,O=a-f*m/P,D=h-f*T/P,R=o+f*S/L,b=n+f*v/L,F=a+f*S/L,C=h+f*v/L,N=nt._$50;return null!=i._$P2(N)&&(nt.clipWithTransform(t,N,M,E,A,I,w,x,O,D,F,C,R,b),!0)},nt.clipWithTransform=function(t,i,e,r,o,n,s,a){if(arguments.length<7)return void _._$li(\"err : @ldgl.clip()\");if(!(arguments[1]instanceof gt))return a[0] is _$6 ldtransform @ldgl.clip()\");var h=\"nt._$B,l=i,$=arguments;if(t.beginPath(),l){l._$PS($[2],$[3],h),t.moveTo(h[0],h[1]);for(var\" u=\"4;u<$.length;u+=2)l._$PS($[u],$[u+1],h),t.lineTo(h[0],h[1])}else{t.moveTo($[2],$[3]);for(var\" e=\"document.createElement(\"canvas\");return\" e.setattribute(\"width\",t),e.setattribute(\"height\",i),e||_._$li(\"err \"+e),e},nt.dumpvalues=\"function(){for(var\" t ,i=\"0;i<arguments.length;i++)t+=\"[\"+i+\"]=\" \"+arguments[i].tofixed(3)+\" , \";console.log(t)},st.prototype._$f0=\"function(t){this._$TT=t._$_T(),this._$LT=t._$_T(),this._$FS=t._$_T(),this._$wL=t._$nP()},st.prototype.getMinValue=function(){return\" this._$tt},st.prototype.getmaxvalue=\"function(){return\" this._$lt},st.prototype.getdefaultvalue=\"function(){return\" this._$fs},st.prototype.getparamid=\"function(){return\" this._$wl},_t.prototype._$yo=\"function(){return\" this._$at&&!this._$js},_t.prototype._$hs=\"function(t){this._$AT=t},_t.prototype._$GT=function(){return\" this._$e0},_t.prototype._$l2=\"function(t){this._$IP=t},_t.prototype.getPartsIndex=function(){return\" this._$ip},_t.prototype._$x2=\"function(){return\" this._$js},_t.prototype._$ib=\"function(t){this._$JS=t},_t.prototype.getTotalScale=function(){return\" this.totalscale},_t.prototype.settotalscale_notforclient=\"function(t){this.totalScale=t},_t.prototype.getInterpolatedOpacity=function(){return\" this._$7s},_t.prototype.setinterpolatedopacity=\"function(t){this._$7s=t},_t.prototype.getTotalOpacity=function(t){return\" this.totalopacity},_t.prototype.settotalopacity=\"function(t){this.totalOpacity=t},at._$2s=\"2.1.00_1\",at._$Kr=201001e3,at._$sP=!0,at._$so=!0,at._$cb=!1,at._$3T=!0,at._$Ts=!0,at._$fb=!0,at._$ts=!0,at.L2D_DEFORMER_EXTEND=!0,at._$Wb=!1;at._$yr=!1,at._$Zs=!1,at.L2D_NO_ERROR=0,at._$i7=1e3,at._$9s=1001,at._$es=1100,at._$r7=2e3,at._$07=2001,at._$b7=2002,at._$H7=4e3,at.L2D_COLOR_BLEND_MODE_MULT=0,at.L2D_COLOR_BLEND_MODE_ADD=1,at.L2D_COLOR_BLEND_MODE_INTERPOLATE=2,at._$6b=!0,at._$cT=0,at.clippingMaskBufferSize=256,at.glContext=new\" array,at.framebuffers=\"new\" array,at.ftexture=\"new\" array,at.ignore_clip=\"!1,at.IGNORE_EXPAND=!1,at.EXPAND_W=2,at.USE_ADJUST_TRANSLATION=!0,at.USE_CANVAS_TRANSFORM=!0,at.USE_CACHED_POLYGON_IMAGE=!1,at.DEBUG_DATA={},at.PROFILE_IOS_SPEED={PROFILE_NAME:\"iOS\" speed\",use_adjust_translation:!0,use_cached_polygon_image:!0,expand_w:4},at.profile_ios_quality=\"{PROFILE_NAME:\"iOS\" hiq\",use_adjust_translation:!0,use_cached_polygon_image:!1,expand_w:2},at.profile_ios_default=\"at.PROFILE_IOS_QUALITY,at.PROFILE_ANDROID={PROFILE_NAME:\"Android\",USE_ADJUST_TRANSLATION:!1,USE_CACHED_POLYGON_IMAGE:!1,EXPAND_W:2},at.PROFILE_DESKTOP={PROFILE_NAME:\"Desktop\",USE_ADJUST_TRANSLATION:!1,USE_CACHED_POLYGON_IMAGE:!1,EXPAND_W:2},at.initProfile=function(){Et.isIOS()?at.setupProfile(at.PROFILE_IOS_DEFAULT):Et.isAndroid()?at.setupProfile(at.PROFILE_ANDROID):at.setupProfile(at.PROFILE_DESKTOP)},at.setupProfile=function(t,i){if(\"number\"==typeof\" t)switch(t){case 9901:t=\"at.PROFILE_IOS_SPEED;break;case\" 9902:t=\"at.PROFILE_IOS_QUALITY;break;case\" 9903:t=\"at.PROFILE_IOS_DEFAULT;break;case\" 9904:t=\"at.PROFILE_ANDROID;break;case\" 9905:t=\"at.PROFILE_DESKTOP;break;default:alert(\"profile\" _$ui \"+t)}arguments.length<2&&(i=\"!0),i&&console.log(\"profile\" \"+t.profile_name);for(var in t)at[e]=\"t[e],i&&console.log(\"\" [\"+e+\"]=\"+t[e])},at.init=function(){if(at._$6b){console.log(\" live2d %s\",at._$2s),at._$6b=\"!1;!0,at.initProfile()}},at.getVersionStr=function(){return\" at._$2s},at.getversionno=\"function(){return\" at._$kr},at._$st=\"function(t){at._$cT=t},at.getError=function(){var\" at._$ct=\"0,t},at.dispose=function(){at.glContext=[],at.frameBuffers=[],at.fTexture=[]},at.setGL=function(t,i){var\" at.glcontext[t]},at.setclippingmaskbuffersize=\"function(t){at.clippingMaskBufferSize=t},at.getClippingMaskBufferSize=function(){return\" at.clippingmaskbuffersize},at.deletebuffer=\"function(t){at.getGL(t).deleteFramebuffer(at.frameBuffers[t].framebuffer),delete\" at.framebuffers[t],delete at.glcontext[t]},ht._$r2=\"function(t){return\" t<0?0:t>1?1:.5-.5*Math.cos(t*Lt.PI_F)},lt._$fr=-1,lt.prototype.toString=function(){return this._$ib},$t.prototype=new W,$t._$42=0,$t._$Os=30,$t._$ms=0,$t._$ns=1,$t._$_s=2,$t._$gT=new Array,$t.prototype._$_S=function(t){this._$LP=t},$t.prototype.getTextureNo=function(){return this._$LP},$t.prototype._$ZL=function(){return this._$Qi},$t.prototype._$H2=function(){return this._$JP},$t.prototype.getNumPoints=function(){return this._$d0},$t.prototype.getType=function(){return W._$wb},$t.prototype._$B2=function(t,i,e){var r=i,o=null!=r._$hr?r._$hr:r._$Cr;switch(U._$do){default:case U._$Ms:throw new Error(\"_$L _$ro \");case U._$Qs:for(var n=this._$d0-1;n>=0;--n)o[n*U._$No+4]=e}},$t.prototype._$zP=function(){this._$GS=new D,this._$GS._$zP()},$t.prototype._$F0=function(t){W.prototype._$F0.call(this,t),this._$LP=t._$6L(),this._$d0=t._$6L(),this._$Yo=t._$6L();var i=t._$nP();this._$BP=new Int16Array(3*this._$Yo);for(var e=3*this._$Yo-1;e>=0;--e)this._$BP[e]=i[e];if(this._$Eo=t._$nP(),this._$Qi=t._$nP(),t.getFormatVersion()>=G._$s7){if(this._$JP=t._$6L(),0!=this._$JP){if(0!=(1&this._$JP)){var r=t._$6L();null==this._$5P&&(this._$5P=new Object),this._$5P._$Hb=parseInt(r)}0!=(this._$JP&$t._$Os)?this._$6s=(this._$JP&$t._$Os)>>1:this._$6s=$t._$ms,0!=(32&this._$JP)&&(this.culling=!1)}}else this._$JP=0},$t.prototype.init=function(t){var i=new ut(this),e=this._$d0*U._$No,r=this._$32();switch(null!=i._$Cr&&(i._$Cr=null),i._$Cr=new Float32Array(e),null!=i._$hr&&(i._$hr=null),i._$hr=r?new Float32Array(e):null,U._$do){default:case U._$Ms:if(U._$Ls)for(var o=this._$d0-1;o>=0;--o){var n=o<<1;this._$qi[n+1]=1-this._$qi[n+1]}break;case u._$qs:for(var o=\"this._$d0-1;o\">=0;--o){var n=o<<1,s=o*u._$no,_=this._$qi[n],a=this._$qi[n+1];i._$cr[s]=_,i._$cr[s+1]=a,i._$cr[s+4]=0,r&&(i._$hr[s]=_,i._$hr[s+1]=a,i._$hr[s+4]=0)}}return i},$t.prototype._$nr=\"function(t,i){var\" e=\"i;if(this!=e._$GT()&&console.log(\"###\" assert!! ### \"),this._$gs._$ur(t)&&(w.prototype._$nr.call(this,t,e),!e._$is[0])){var r=\"$t._$gT;r[0]=!1,v._$Vr(t,this._$GS,r,this._$d0,this._$Eo,e._$Cr,U._$i2,U._$No)}},$t.prototype._$2b=function(t,i){try{this!=i._$GT()&&console.log(\"###\" \");var o=\"this.getTargetBaseDataID();if(r._$8r==W._$ur&&(r._$8r=t.getBaseDataIndex(o)),r._$8r<0)at._$so&&_._$li(\"_$L\" _$0p _$g :: %s\",o);else{var n=\"t.getBaseData(r._$8r),s=t._$q2(r._$8r);null==n||s._$x2()?r._$AT=!1:(n._$nb(t,s,r._$Cr,r._$hr,this._$d0,U._$i2,U._$No),r._$AT=!0),r.baseOpacity=s.getTotalOpacity()}}}catch(t){throw\" t}},$t.prototype.draw=\"function(t,i,e){if(this!=e._$GT()&&console.log(\"###\" \"),!e._$is[0]){var _$yi( %d ) , _$d0( _$yo( \\n\",this._$lp,this._$d0,this._$yo),console.log(\" _$oi _$di=\"{\" \");for(var t=\"0;t<this._$BP.length;t++)console.log(\"%5d\" ,\",this._$bp[t]);console.log(\"\\n _$5i _$30\");for(var _$30[%d]=\",t);for(var i=this._$Eo[t],e=0;e<i.length;e++)console.log(\" %6.2f, \",i[e])}console.log(\"\\n\")},$t.prototype._$72=\"function(t){return\" null=\"=this._$5P?null:this._$5P[t]},$t.prototype.getIndexArray=function(){return\" this._$bp},ut.prototype=\"new\" mt,ut.prototype.gettransformedpoints=\"function(){return\" null!=\"this._$hr?this._$hr:this._$Cr},pt.prototype._$HT=function(t){this.x=t.x,this.y=t.y},pt.prototype._$HT=function(t,i){this.x=t,this.y=i},ft.prototype=new\" i,ft.loadmodel=\"function(t){var\" ft;return i._$62(e,t),e},ft.loadmodel=\"function(t,e){var\" ft(r);return i._$62(o,t),o},ft._$to=\"function(){return\" new ft},ft._$er=\"function(t){var\" i=\"new\" _$5(\".. _$_r _$t0 _$ri _$_p._$d\");if(0=\"=i.exists())throw\" _$ls(\"_$t0 _$_ _$6 _$ui \"+i._$pl());for(var _$5(e[o]);if(0=\"=n.exists())throw\" \"+n._$pl());r.settexture(o,_$nl._$_o(t,n._$3b()))}return r},ft.prototype.setgl=\"function(t){at.setGL(t)},ft.prototype.setTransform=function(t){this.drawParamWebGL.setTransform(t)},ft.prototype.update=function(){this._$5S.update(),this._$5S.preDraw(this.drawParamWebGL)},ft.prototype.draw=function(){this._$5S.draw(this.drawParamWebGL)},ft.prototype._$K2=function(){this.drawParamWebGL._$K2()},ft.prototype.setTexture=function(t,i){null==this.drawParamWebGL&&_._$li(\"_$Yi\" for qt _$ki _$xs() is _$ui!!\"),this.drawparamwebgl.settexture(t,i)},ft.prototype.settexture=\"function(t,i){null==this.drawParamWebGL&&_._$li(\"_$Yi\" _$ui!!\"),this.drawparamwebgl.settexture(t,i)},ft.prototype._$rs=\"function(){return\" this.drawparamwebgl._$rs()},ft.prototype._$ds=\"function(t){this.drawParamWebGL._$Ds(t)},ft.prototype.getDrawParam=function(){return\" this.drawparamwebgl},ft.prototype.setmatrix=\"function(t){this.drawParamWebGL.setMatrix(t)},ft.prototype.setPremultipliedAlpha=function(t){this.drawParamWebGL.setPremultipliedAlpha(t)},ft.prototype.isPremultipliedAlpha=function(){return\" this.drawparamwebgl.ispremultipliedalpha()},ft.prototype.setanisotropy=\"function(t){this.drawParamWebGL.setAnisotropy(t)},ft.prototype.getAnisotropy=function(){return\" this.drawparamwebgl.getanisotropy()},ct.prototype._$tb=\"function(){return\" this.motions},ct.prototype.startmotion=\"function(t,i){for(var\">startMotion() / start _$K _$3 (m%d)\\n\",r,e._$sr));if(null==t)return-1;e=new dt,e._$w0=t,this.motions.push(e);var n=e._$sr;return this._$eb&&_._$Ji(\"MotionQueueManager[size:%2d]->startMotion() / new _$w0 (m%d)\\n\",r,n),n},ct.prototype.updateParam=function(t){try{for(var i=!1,e=0;e<this.motions.length;e++){var r=\"this.motions[e];if(null!=r){var\" o=\"r._$w0;null!=o?(o.updateParam(t,r),i=!0,r.isFinished()&&(this._$eb&&_._$Ji(\"MotionQueueManager[size:%2d]-\">updateParam() / _$T0 _$w0 (m%d)\\n\",this.motions.length-1,r._$sr),this.motions.splice(e,1),e--)):(this.motions=this.motions.splice(e,1),e--)}else this.motions.splice(e,1),e--}return i}catch(t){return _._$li(t),!0}},ct.prototype.isFinished=function(t){if(arguments.length>=1){for(var i=0;i<this.motions.length;i++){var e=\"this.motions[i];if(null!=e&&(e._$sr==t&&!e.isFinished()))return!1}return!0}for(var\" i=\"0;i<this.motions.length;i++){var\" this.motions.splice(i,1),i--}else this.motions.splice(i,1),i--}return!0},ct.prototype.stopallmotions=\"function(){for(var\" t=\"0;t<this.motions.length;t++){var\" this.motions.splice(t,1),t--}},ct.prototype._$zr=\"function(t){this._$eb=t},ct.prototype._$e=function(){console.log(\"--\" _$r --\\n\");for(var :: %s\\n\",this.motions.length,e.tostring())}},dt._$gs=\"0,dt.prototype.isFinished=function(){return\" this._$9l},dt.prototype._$qs=\"function(t){var\" this._$sr},gt.prototype.setcontext=\"function(t){var\" ,i=\"0;i<9;i++)t+=this.m[i].toFixed(2)+\"\" ,\";return t+=\" }\" },gt.prototype.identity=\"function(){var\" array(0,0));var r=\"this.m;return\" e[0]=\"r[0]*t+r[3]*i+r[6],e[1]=r[1]*t+r[4]*i+r[7],e},gt.prototype._$P2=function(t){t||(t=new\" gt);var null;var u=\"1/$;return\" t.m[0]=\"u*(s*l-h*_),t.m[1]=u*(h*o-r*l),t.m[2]=u*(r*_-s*o),t.m[3]=u*(a*_-n*l),t.m[4]=u*(e*l-a*o),t.m[5]=u*(n*o-e*_),t.m[6]=u*(n*h-a*s),t.m[7]=u*(a*r-e*h),t.m[8]=u*(e*s-n*r),t},gt.prototype.transform=function(t,i,e){null==e&&(e=new\" et,yt._$et=\"null,yt._$tP=new\" object,yt._$2o=\"function(){return\" null=\"=yt._$eT&&(yt._$eT=yt.getID(\"DST_BASE\")),yt._$eT},yt._$27=function(){yt._$tP.clear(),yt._$eT=null},yt.getID=function(t){var\" yt(t),yt._$tp[t]=\"i),i},yt.prototype._$3s=function(){return\" new yt},mt.prototype=\"new\" e,mt._$9r=\"function(t){return\" float32array(t)},mt._$vb=\"function(t){return\" int16array(t)},mt._$cr=\"function(t,i){return\" this._$gr},mt._$as=\"function(t){this._$Gr=t},mt.prototype.getGL=function(){return\" this.gl},mt.prototype.setgl=\"function(t){this.gl=t},mt.prototype.setTransform=function(t){this.transform=t},mt.prototype._$ZT=function(){var\" a=\"(n\">.9&&at.EXPAND_W,this.gl);if(null==this.gl)throw new Error(\"gl is null\");var h=1*this._$C0*n,l=1*this._$tT*n,$=1*this._$WL*n,u=this._$lT*n;if(null!=this.clipBufPre_clipContextMask){a.frontFace(a.CCW),a.useProgram(this.shaderProgram),this._$vS=Tt(a,this._$vS,r),this._$no=Pt(a,this._$no,e),a.enableVertexAttribArray(this.a_position_Loc),a.vertexAttribPointer(this.a_position_Loc,2,a.FLOAT,!1,0,0),this._$NT=Tt(a,this._$NT,o),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.textures[t]),a.uniform1i(this.s_texture0_Loc,1),a.enableVertexAttribArray(this.a_texCoord_Loc),a.vertexAttribPointer(this.a_texCoord_Loc,2,a.FLOAT,!1,0,0),a.uniformMatrix4fv(this.u_matrix_Loc,!1,this.getClipBufPre_clipContextMask().matrixForMask);var p=this.getClipBufPre_clipContextMask().layoutChannelNo,f=this.getChannelFlagAsColor(p);a.uniform4f(this.u_channelFlag,f.r,f.g,f.b,f.a);var c=this.getClipBufPre_clipContextMask().layoutBounds;a.uniform4f(this.u_baseColor_Loc,2*c.x-1,2*c.y-1,2*c._$EL()-1,2*c._$5T()-1),a.uniform1i(this.u_maskFlag_Loc,!0)}else if(null!=this.getClipBufPre_clipContextDraw()){a.useProgram(this.shaderProgramOff),this._$vS=Tt(a,this._$vS,r),this._$no=Pt(a,this._$no,e),a.enableVertexAttribArray(this.a_position_Loc_Off),a.vertexAttribPointer(this.a_position_Loc_Off,2,a.FLOAT,!1,0,0),this._$NT=Tt(a,this._$NT,o),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.textures[t]),a.uniform1i(this.s_texture0_Loc_Off,1),a.enableVertexAttribArray(this.a_texCoord_Loc_Off),a.vertexAttribPointer(this.a_texCoord_Loc_Off,2,a.FLOAT,!1,0,0),a.uniformMatrix4fv(this.u_clipMatrix_Loc_Off,!1,this.getClipBufPre_clipContextDraw().matrixForDraw),a.uniformMatrix4fv(this.u_matrix_Loc_Off,!1,this.matrix4x4),a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,at.fTexture[this.glno]),a.uniform1i(this.s_texture1_Loc_Off,2);var p=this.getClipBufPre_clipContextDraw().layoutChannelNo,f=this.getChannelFlagAsColor(p);a.uniform4f(this.u_channelFlag_Loc_Off,f.r,f.g,f.b,f.a),a.uniform4f(this.u_baseColor_Loc_Off,h,l,$,u)}else a.useProgram(this.shaderProgram),this._$vS=Tt(a,this._$vS,r),this._$no=Pt(a,this._$no,e),a.enableVertexAttribArray(this.a_position_Loc),a.vertexAttribPointer(this.a_position_Loc,2,a.FLOAT,!1,0,0),this._$NT=Tt(a,this._$NT,o),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.textures[t]),a.uniform1i(this.s_texture0_Loc,1),a.enableVertexAttribArray(this.a_texCoord_Loc),a.vertexAttribPointer(this.a_texCoord_Loc,2,a.FLOAT,!1,0,0),a.uniformMatrix4fv(this.u_matrix_Loc,!1,this.matrix4x4),a.uniform4f(this.u_baseColor_Loc,h,l,$,u),a.uniform1i(this.u_maskFlag_Loc,!1);this.culling?this.gl.enable(a.CULL_FACE):this.gl.disable(a.CULL_FACE),this.gl.enable(a.BLEND);var d,g,y,m;if(null!=this.clipBufPre_clipContextMask)d=a.ONE,g=a.ONE_MINUS_SRC_ALPHA,y=a.ONE,m=a.ONE_MINUS_SRC_ALPHA;else switch(s){case $t._$ms:d=a.ONE,g=a.ONE_MINUS_SRC_ALPHA,y=a.ONE,m=a.ONE_MINUS_SRC_ALPHA;break;case $t._$ns:d=a.ONE,g=a.ONE,y=a.ZERO,m=a.ONE;break;case $t._$_s:d=a.DST_COLOR,g=a.ONE_MINUS_SRC_ALPHA,y=a.ZERO,m=a.ONE}a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(d,g,y,m),this.anisotropyExt&&a.texParameteri(a.TEXTURE_2D,this.anisotropyExt.TEXTURE_MAX_ANISOTROPY_EXT,this.maxAnisotropy);var T=e.length;a.drawElements(a.TRIANGLES,T,a.UNSIGNED_SHORT,0),a.bindTexture(a.TEXTURE_2D,null)}},mt.prototype._$Rs=function(){throw new Error(\"_$Rs\")},mt.prototype._$Ds=function(t){throw new Error(\"_$Ds\")},mt.prototype._$K2=function(){for(var t=0;t<this.textures.length;t++){0!=this.textures[t]&&(this.gl._$k2(1,this.textures,t),this.textures[t]=null)}},mt.prototype.settexture=function(t,i){this.textures[t]=i},mt.prototype.initshader=function(){var t=\"this.gl;this.loadShaders2(),this.a_position_Loc=t.getAttribLocation(this.shaderProgram,\"a_position\"),this.a_texCoord_Loc=t.getAttribLocation(this.shaderProgram,\"a_texCoord\"),this.u_matrix_Loc=t.getUniformLocation(this.shaderProgram,\"u_mvpMatrix\"),this.s_texture0_Loc=t.getUniformLocation(this.shaderProgram,\"s_texture0\"),this.u_channelFlag=t.getUniformLocation(this.shaderProgram,\"u_channelFlag\"),this.u_baseColor_Loc=t.getUniformLocation(this.shaderProgram,\"u_baseColor\"),this.u_maskFlag_Loc=t.getUniformLocation(this.shaderProgram,\"u_maskFlag\"),this.a_position_Loc_Off=t.getAttribLocation(this.shaderProgramOff,\"a_position\"),this.a_texCoord_Loc_Off=t.getAttribLocation(this.shaderProgramOff,\"a_texCoord\"),this.u_matrix_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_mvpMatrix\"),this.u_clipMatrix_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_ClipMatrix\"),this.s_texture0_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"s_texture0\"),this.s_texture1_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"s_texture1\"),this.u_channelFlag_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_channelFlag\"),this.u_baseColor_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_baseColor\")},mt.prototype.disposeShader=function(){var\" e=\"this.gl,r=i,o=e.createShader(t);if(null==o)return\" _._$ji(\"_$l0 to create shader\"),null;if(e.shadersource(o,r),e.compileshader(o),!e.getshaderparameter(o,e.compile_status)){var n=\"e.getShaderInfoLog(o);return\" compile shader : \"+n),e.deleteshader(o),null}return o},mt.prototype.loadshaders2=\"function(){var\" vec4 a_position;attribute vec2 a_texcoord;varying v_texcoord;varying v_clippos;uniform mat4 u_mvpmatrix;void main(){ gl_position=\"u_mvpMatrix\" * a_position; v_clippos=\"u_mvpMatrix\" v_texcoord=\"a_texCoord;}\"),!this.vertShader)return\" _._$ji(\"vertex _$li!\"),!1;if(this.vertshaderoff=\"this.compileShader(t.VERTEX_SHADER,\"attribute\" u_mvpmatrix;uniform u_clipmatrix;void ;}\"),!this.vertshaderoff)return _._$ji(\"offvertex _$li!\"),!1;if(this.fragshader=\"this.compileShader(t.FRAGMENT_SHADER,\"precision\" mediump float;varying sampler2d s_texture0;uniform u_channelflag;uniform u_basecolor;uniform bool u_maskflag;void smpcolor; if(u_maskflag){ float isinside=\"step(u_baseColor.x,\" v_clippos.x v_clippos.w) step(u_basecolor.y, v_clippos.y step(v_clippos.x v_clippos.w, u_basecolor.z) step(v_clippos.y u_basecolor.w); smpcolor=\"u_channelFlag\" texture2d(s_texture0 , v_texcoord).a isinside; }else{ v_texcoord) u_basecolor; } gl_fragcolor=\"smpColor;}\"),!this.fragShader)return\" _._$ji(\"fragment _$li!\"),!1;if(this.fragshaderoff=\"this.compileShader(t.FRAGMENT_SHADER,\"precision\" ;varying s_texture1;uniform u_basecolor ;void col_formask=\"texture2D(s_texture0,\" clipmask=\"texture2D(s_texture1,\" v_clippos.xy u_channelflag; maskval=\"clipMask.r\" + clipmask.g clipmask.b clipmask.a; maskval; _._$ji(\"offfragment _$li!\"),!1;if(t.attachshader(this.shaderprogram,this.vertshader),t.attachshader(this.shaderprogram,this.fragshader),t.attachshader(this.shaderprogramoff,this.vertshaderoff),t.attachshader(this.shaderprogramoff,this.fragshaderoff),t.linkprogram(this.shaderprogram),t.linkprogram(this.shaderprogramoff),!t.getprogramparameter(this.shaderprogram,t.link_status)){var i=\"t.getProgramInfoLog(this.shaderProgram);return\" link program: \"+i),this.vertshader&&(t.deleteshader(this.vertshader),this.vertshader=\"0),this.fragShader&&(t.deleteShader(this.fragShader),this.fragShader=0),this.shaderProgram&&(t.deleteProgram(this.shaderProgram),this.shaderProgram=0),this.vertShaderOff&&(t.deleteShader(this.vertShaderOff),this.vertShaderOff=0),this.fragShaderOff&&(t.deleteShader(this.fragShaderOff),this.fragShaderOff=0),this.shaderProgramOff&&(t.deleteProgram(this.shaderProgramOff),this.shaderProgramOff=0),!1}return!0},mt.prototype.createFramebuffer=function(){var\" r=\"t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,i,i),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,r);var\" o=\"t.createTexture();return\" t.bindtexture(t.texture_2d,o),t.teximage2d(t.texture_2d,0,t.rgba,i,i,0,t.rgba,t.unsigned_byte,null),t.texparameteri(t.texture_2d,t.texture_min_filter,t.linear),t.texparameteri(t.texture_2d,t.texture_mag_filter,t.linear),t.texparameteri(t.texture_2d,t.texture_wrap_s,t.clamp_to_edge),t.texparameteri(t.texture_2d,t.texture_wrap_t,t.clamp_to_edge),t.framebuffertexture2d(t.framebuffer,t.color_attachment0,t.texture_2d,o,0),t.bindtexture(t.texture_2d,null),t.bindrenderbuffer(t.renderbuffer,null),t.bindframebuffer(t.framebuffer,null),at.ftexture[this.glno]=\"o,{framebuffer:e,renderbuffer:r,texture:at.fTexture[this.glno]}},St.prototype._$fP=function(){var\" t,i,e,r=\"this._$ST();if(0==(128&r))return\" 255&r;if(0=\"=(128&(t=this._$ST())))return(127&r)<<7|127&t;if(0==(128&(i=this._$ST())))return(127&r)<<14|(127&t)<<7|255&i;if(0==(128&(e=this._$ST())))return(127&r)<<21|(127&t)<<14|(127&i)<<7|255&e;throw\" new lt(\"_$l _$0p _\")},st.prototype.getformatversion=\"function(){return\" this._$s2},st.prototype._$gr=\"function(t){this._$S2=t},St.prototype._$3L=function(){return\" this._$fp()},st.prototype._$mp=\"function(){return\" this._$zt(),this._$f+=\"8,this._$T.getFloat64(this._$F-8)},St.prototype._$_T=function(){return\" this._$zt(),this._$t.getint8(this._$f++)},st.prototype._$9t=\"function(){return\" _$q read long\")},st.prototype._$po=\"function(){return\" this._$zt(),0!=\"this._$T.getInt8(this._$F++)};var\" xt=\"!0;St.prototype._$bT=function(){this._$zT();var\" arraybuffer(2*t);i=\"new\" uint16array(e);for(var string.fromcharcode.apply(null,i)}catch(t){xt=\"!1}try{var\" array;if(null=\"=i)for(var\" for(var string.fromcharcode.apply(null,o)}catch(t){console.log(\"read utf8 _$rt _$l0 !! \"+t)}},st.prototype._$cs=\"function(){this._$zT();for(var\" int32array(t),e=\"0;e<t;e++)i[e]=this._$T.getInt32(this._$F),this._$F+=4;return\" i},st.prototype._$tb=\"function(){this._$zT();for(var\" float32array(t),e=\"0;e<t;e++)i[e]=this._$T.getFloat32(this._$F),this._$F+=4;return\" i},st.prototype._$5b=\"function(){this._$zT();for(var\" float64array(t),e=\"0;e<t;e++)i[e]=this._$T.getFloat64(this._$F),this._$F+=8;return\" i},st.prototype._$np=\"function(){return\" this._$jb(-1)},st.prototype._$jb=\"function(t){if(this._$zT(),t<0&&(t=this._$3L()),t==G._$7P){var\" this._$ko[i];throw lt(\"_$sl _$4i @_$m0\")}var this._$ko.push(e),e},st.prototype._$4b=\"function(t){if(0==t)return\" null;if(50=\"=t){var\" e}if(51=\"=t){var\" e}if(134=\"=t){var\" e}if(60=\"=t){var\" e}if(t>=48){var r=G._$9o(t);return null!=r?(r._$F0(this),r):null}switch(t){case 1:return this._$bT();case 10:return new n(this._$6L(),!0);case 11:return new S(this._$mP(),this._$mP(),this._$mP(),this._$mP());case 12:return new S(this._$_T(),this._$_T(),this._$_T(),this._$_T());case 13:return new L(this._$mP(),this._$mP());case 14:return new L(this._$_T(),this._$_T());case 15:for(var o=this._$3L(),e=new Array(o),s=0;s<o;s++)e[s]=this._$np();return 0=\"=this._$hL?this._$v0=this._$ST():8==this._$hL&&(this._$v0=this._$ST(),this._$hL=0),1==(this._$v0\" e;case 17:var e=\"new\" f(this._$mp(),this._$mp(),this._$mp(),this._$mp(),this._$mp(),this._$mp());return 21:return new h(this._$6l(),this._$6l(),this._$6l(),this._$6l());case 22:return pt(this._$6l(),this._$6l());case 23:throw error(\"_$l _$ro \");case 16:case 25:return this._$cs();case 26:return this._$5b();case 27:return this._$tb();case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 18:case 19:case 20:case 24:case 28:throw lt(\"_$6 _$q : _$np() of 2-9 ,18,19,20,24,28 \"+t);default:throw no _$i \"+t)}},st.prototype._$8l=\"function(){return\">>7-this._$hL++&1)},St.prototype._$zT=function(){0!=this._$hL&&(this._$hL=0)},vt.prototype._$wP=function(t,i,e){for(var r=0;r<e;r++){for(var o=\"0;o<i;o++){var\" n=\"2*(o+r*i);console.log(\"(%\" 7.3f , % 7.3f) \",t[n],t[n+1])}console.log(\"\\n\")}console.log(\"\\n\")},lt._$2s=\"Math.PI/180,Lt._$bS=Math.PI/180,Lt._$wS=180/Math.PI,Lt._$NS=180/Math.PI,Lt.PI_F=Math.PI,Lt._$kT=[0,.012368,.024734,.037097,.049454,.061803,.074143,.086471,.098786,.111087,.12337,.135634,.147877,.160098,.172295,.184465,.196606,.208718,.220798,.232844,.244854,.256827,.268761,.280654,.292503,.304308,.316066,.327776,.339436,.351044,.362598,.374097,.385538,.396921,.408243,.419502,.430697,.441826,.452888,.463881,.474802,.485651,.496425,.507124,.517745,.528287,.538748,.549126,.559421,.56963,.579752,.589785,.599728,.609579,.619337,.629,.638567,.648036,.657406,.666676,.675843,.684908,.693867,.70272,.711466,.720103,.72863,.737045,.745348,.753536,.76161,.769566,.777405,.785125,.792725,.800204,.807561,.814793,.821901,.828884,.835739,.842467,.849066,.855535,.861873,.868079,.874153,.880093,.885898,.891567,.897101,.902497,.907754,.912873,.917853,.922692,.92739,.931946,.936359,.940629,.944755,.948737,.952574,.956265,.959809,.963207,.966457,.96956,.972514,.97532,.977976,.980482,.982839,.985045,.987101,.989006,.990759,.992361,.993811,.995109,.996254,.997248,.998088,.998776,.999312,.999694,.999924,1],Lt._$92=function(t,i){var\" e=\"Math.atan2(t[1],t[0]),r=Math.atan2(i[1],i[0]);return\" lt._$ts(e,r)},lt._$ts=\"function(t,i){for(var\">Math.PI;)e-=2*Math.PI;return e},Lt._$9=function(t){return Math.sin(t)},Lt.fcos=function(t){return Math.cos(t)},Mt.prototype._$u2=function(){return this._$IS[0]},Mt.prototype._$yo=function(){return this._$AT&&!this._$IS[0]},Mt.prototype._$GT=function(){return this._$e0},Et._$W2=0,Et.SYSTEM_INFO=null,Et.USER_AGENT=navigator.userAgent,Et.isIPhone=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isIPhone},Et.isIOS=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isIPhone||Et.SYSTEM_INFO._isIPad},Et.isAndroid=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isAndroid},Et.getOSVersion=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO.version},Et.getOS=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isIPhone||Et.SYSTEM_INFO._isIPad?\"iOS\":Et.SYSTEM_INFO._isAndroid?\"Android\":\"_$Q0 OS\"},Et.setup=function(){function t(t,i){for(var e=t.substring(i).split(/[ _,;\\.]/),r=0,o=0;o<=2&&!isnan(e[o]);o++){var n=\"parseInt(e[o]);if(n<0||n\">999){_._$li(\"err : \"+n+\" @UtHtml5.setup()\"),r=0;break}r+=n*Math.pow(1e3,2-o)}return r}var i,e=Et.USER_AGENT,r=Et.SYSTEM_INFO={userAgent:e};if((i=e.indexOf(\"iPhone OS \"))>=0)r.os=\"iPhone\",r._isIPhone=!0,r.version=t(e,i+\"iPhone OS \".length);else if((i=e.indexOf(\"iPad\"))>=0){if((i=e.indexOf(\"CPU OS\"))<0)return void _._$li(\" err : \"+e+\" @uthtml5.setup()\");r.os=\"iPad\" ,r._isipad=\"!0,r.version=t(e,i+\"CPU\" os \".length)}else(i=\"e.indexOf(\"Android\"))\">=0?(r.os=\"Android\",r._isAndroid=!0,r.version=t(e,i+\"Android \".length)):(r.os=\"-\",r.version=-1)},window.UtSystem=w,window.UtDebug=_,window.LDTransform=gt,window.LDGL=nt,window.Live2D=at,window.Live2DModelWebGL=ft,window.Live2DModelJS=q,window.Live2DMotion=J,window.MotionQueueManager=ct,window.PhysicsHair=f,window.AMotion=s,window.PartsDataID=l,window.DrawDataID=b,window.BaseDataID=yt,window.ParamID=u,at.init();var At=!1}()}).call(i,e(7))},function(t,i){t.exports={import:function(){throw new Error(\"System.import cannot be used indirectly\")}}},function(t,i,e){\"use strict\";function r(t){return t&&t.__esModule?t:{default:t}}function o(){this.models=[],this.count=-1,this.reloadFlg=!1,Live2D.init(),n.Live2DFramework.setPlatformManager(new _.default)}Object.defineProperty(i,\"__esModule\",{value:!0}),i.default=o;var n=e(0),s=e(9),_=r(s),a=e(10),h=r(a),l=e(1),$=r(l);o.prototype.createModel=function(){var t=new h.default;return this.models.push(t),t},o.prototype.changeModel=function(t,i){if(this.reloadFlg){this.reloadFlg=!1;this.releaseModel(0,t),this.createModel(),this.models[0].load(t,i)}},o.prototype.getModel=function(t){return t>=this.models.length?null:this.models[t]},o.prototype.releaseModel=function(t,i){this.models.length<=t||(this.models[t].release(i),delete this.models[t],this.models.splice(t,1))},o.prototype.nummodels=\"function(){return\" this.models.length},o.prototype.setdrag=\"function(t,i){for(var\" e=\"0;e<this.models.length;e++)this.models[e].setDrag(t,i)},o.prototype.maxScaleEvent=function(){$.default.DEBUG_LOG&&console.log(\"Max\" scale event.\");for(var t=\"0;t<this.models.length;t++)this.models[t].startRandomMotion($.default.MOTION_GROUP_PINCH_IN,$.default.PRIORITY_NORMAL)},o.prototype.minScaleEvent=function(){$.default.DEBUG_LOG&&console.log(\"Min\" view x:\"+t+\" y:\"+i);for(var face.\"),this.models[e].setrandomexpression()):this.models[e].hittest($.default.hit_area_body,t,i)?($.default.debug_log&&console.log(\"tap body. models[\"+e+\"]\"),this.models[e].startrandommotion($.default.motion_group_tap_body,$.default.priority_normal)):this.models[e].hittestcustom(\"head\",t,i)?($.default.debug_log&&console.log(\"tap face.\"),this.models[e].startrandommotion($.default.motion_group_flick_head,$.default.priority_normal)):this.models[e].hittestcustom(\"body\",t,i)&&($.default.debug_log&&console.log(\"tap models[\"+e+\"]\"),this.models[e].startrandommotion($.default.motion_group_tap_body,$.default.priority_normal));return!0}},function(t,i,e){\"use strict\";function r(){}object.defineproperty(i,\"__esmodule\",{value:!0}),i.default=\"r;var\" o=\"e(2);r.prototype.loadBytes=function(t,i){var\" xmlhttprequest;e.open(\"get\",t,!0),e.responsetype=\"arraybuffer\" ,e.onload=\"function(){switch(e.status){case\" 200:i(e.response);break;default:console.error(\"failed to load (\"+e.status+\") : \"+t)}},e.send(null)},r.prototype.loadstring=\"function(t){this.loadBytes(t,function(t){return\" t})},r.prototype.loadlive2dmodel=\"function(t,i){var\" n=\"new\" image;n.crossorigin=\"Anonymous\" ,n.src=\"e;n.onload=function(){var\" console.error(\"failed generate gl texture name.\"),-1;0=\"=t.isPremultipliedAlpha()&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D),t.setTexture(i,s),s=null,\"function\"==typeof\" r&&r()},n.onerror=\"function(){console.error(\"Failed\" image \"+e)}},r.prototype.jsonparsefrombytes=\"function(t){var\" i,e=\"new\" uint8array(t,0,3);return i=\"239==e[0]&&187==e[1]&&191==e[2]?String.fromCharCode.apply(null,new\" uint8array(t,3)):string.fromcharcode.apply(null,new uint8array(t)),json.parse(i)},r.prototype.log=\"function(t){}},function(t,i,e){\"use\" r(t){return t&&t.__esmodule?t:{default:t}}function o(){n.l2dbasemodel.prototype.constructor.call(this),this.modelhomedir ,this.modelsetting=\"null,this.tmpMatrix=[]}Object.defineProperty(i,\"__esModule\",{value:!0}),i.default=o;var\" n.l2dbasemodel,o.prototype.load=\"function(t,i,e){this.setUpdating(!0),this.setInitialized(!1),this.modelHomeDir=i.substring(0,i.lastIndexOf(\"/\")+1),this.modelSetting=new\" _.default;var r=\"this;this.modelSetting.loadModelSetting(i,function(){var\" var>0){r.expressions={};for(var t=0;t</=t||(this.models[t].release(i),delete></0)return></=2&&!isnan(e[o]);o++){var></e;r++){for(var></o;s++)e[s]=this._$np();return></this.textures.length;t++){0!=this.textures[t]&&(this.gl._$k2(1,this.textures,t),this.textures[t]=null)}},mt.prototype.settexture=function(t,i){this.textures[t]=i},mt.prototype.initshader=function(){var></this.motions.length;i++){var></this.motions.length;e++){var></1,s=o*u._$no,_=this._$qi[n],a=this._$qi[n+1];i._$cr[s]=_,i._$cr[s+1]=a,i._$cr[s+4]=0,r&&(i._$hr[s]=_,i._$hr[s+1]=a,i._$hr[s+4]=0)}}return></1;this._$qi[n+1]=1-this._$qi[n+1]}break;case></7)return></1?(r[m]=y[$]*(1-u-p)+y[$+2]*u+y[$+2*(c+1)]*p,r[m+1]=y[$+1]*(1-u-p)+y[$+3]*u+y[$+2*(c+1)+1]*p):(r[m]=y[$+2*(c+1)+2]*(u-1+p)+y[$+2*(c+1)]*(1-u)+y[$+2]*(1-p),r[m+1]=y[$+2*(c+1)+3]*(u-1+p)+y[$+2*(c+1)+1]*(1-u)+y[$+3]*(1-p))},z.prototype._$vt=function(){return(this._$o+1)*(this._$a+1)},z.prototype.gettype=function(){return></0?a=0:a></=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else></=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var></=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var></=this.size){var></p&&p-t></=h._$rp&&h._$rp<=b._$ys);else{var></u&&u<121&&(i._$d0=u),o=e[0]}for(;o<r&&(\"\\n\"!=q(t,o)&&\"\\r\"!=q(t,o));++o);}else></r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\"=\"==n){a=o;break}var></o){console.log(\"_$n0></r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></e.length;o++){var></w._$52?w._$52=e:e></this._$sb.length;t++){0!=this._$sb[t]&&(this.gl._$sr(1,this._$sb,t),this._$sb[t]=0)}},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$sb[t]=i},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$u2[t]=i},x.prototype._$ns=function(t){var></e&&(this._$_l=wt.state_closing,this._$bb=e),i=1;break;case></e;++o){var></this._$rr[t]&&(i=this._$rr[t]),i></i;++e){var></v;++s){var></r;++s){var></i;e++){var></=this.size){var></=h._$rp&&h._$rp<=b._$ys);else{var></l&&l<121&&(i._$d0=l),o=e[0]}for(;o<r&&(\"\\n\"!=t[o]&&\"\\r\"!=t[o]);++o);}else></r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\"=\"==n){_=o;break}var></o){console.log(\"_$n0></r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></r;++o){var></r;++a)t[a]=0;for(var></o;_++){var></r;o++)if(o.getchar(t,o)!=e.charat(o-i))return!1;return!0},o.getchar=function(t,i){return></t;);}catch(t){t._$rb()}},w.getusertimemsec=function(){return></16;i++)this.matrix4x4[i]=t[i]},e.prototype._$it=function(){return></0?r=0:r></0?e=0:e></0?i=0:i></0?t=0:t></m._$52?m._$52=e:e></=this.x&&this.y<=this.y&&this.x<=this.x+this.width&&this.y<=this.y+this.height},s.prototype.expand=function(t,i){this.x-=t,this.y-=i,this.width+=2*t,this.height+=2*i},v._$z2=function(t,i,e,r){var></.033&&(i=.033);var></r;++o)console.log(\"%5d\",i[o]),console.log(\"%s\\n\",e),console.log(\",\");console.log(\"\\n\")},_._$rb=function(t){console.log(\"dump></e&&(i._$9l=!0)}},s.prototype.updateparamexe=function(t,i,e,r){},_._$8s=0,_._$ft=new></0){i._$z2=e,i._$bs=e;var></e.channel_count;n++){var></h;l++){var></this.clipcontextlist.length;r++){var></t;i++)this.gl.deleteframebuffer(at.framebuffers[i].framebuffer);at.framebuffers=[],at.glcontext=[]},e.prototype.init=function(t,i,e){for(var></t.length;u++){var></0&&(console.log(\"no></0&&(l=0),s.setpartsopacity(h,l)}else{for(var></3&&(e=1),this._$5s.setparamfloat(t,this._$5s.getparamfloat(t)*(1-e)+i*e)},i.prototype.addtoparamfloat=function(t,i,e){\"number\"!=typeof></this.channel_colors.length;e++)this.dp_webgl.setchannelflagascolor(e,this.channel_colors[e])}}function></t.x&&(s=360-s);var></16;t++)this.currentmatrix[t]=t%5==0?1:0},r.push=function(){var></this.min?this.tr[0]></this.screenright&&(t=this.screenright-this.tr[0]*this.maxright-this.tr[12]),this.tr[5]*this.maxtop+(this.tr[13]+i)<this.screentop&&(i=this.screentop-this.tr[5]*this.maxtop-this.tr[13]),this.tr[5]*this.maxbottom+(this.tr[13]+i)></i.length;e++){var></0&&(r=0,o=1);for(var></n;s++){var></e&&(this.eyestate=g.state_closing,this.statestarttime=e),i=1;break;case></_;a++){var></=i[0]&&r<=t[1]&&r></=u&&u<=s&&_<=p&&p<=a},r.prototype.hittestsimplecustom=function(t,i,e,r){return></_&&(_=$),$></.001&&(t=0),this.alpha=t},r.prototype.getalpha=function(){return>","source":"live2d-widget/live2d.min.js","raw":"!function(t){function i(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}var e={};i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},i.p=\"\",i(i.s=4)}([function(t,i,e){\"use strict\";function r(){this.live2DModel=null,this.modelMatrix=null,this.eyeBlink=null,this.physics=null,this.pose=null,this.debugMode=!1,this.initialized=!1,this.updating=!1,this.alpha=1,this.accAlpha=0,this.lipSync=!1,this.lipSyncValue=0,this.accelX=0,this.accelY=0,this.accelZ=0,this.dragX=0,this.dragY=0,this.startTimeMSec=null,this.mainMotionManager=new h,this.expressionManager=new h,this.motions={},this.expressions={},this.isTexLoaded=!1}function o(){AMotion.prototype.constructor.call(this),this.paramList=new Array}function n(){this.id=\"\",this.type=-1,this.value=null}function s(){this.nextBlinkTime=null,this.stateStartTime=null,this.blinkIntervalMsec=null,this.eyeState=g.STATE_FIRST,this.blinkIntervalMsec=4e3,this.closingMotionMsec=100,this.closedMotionMsec=50,this.openingMotionMsec=150,this.closeIfZero=!0,this.eyeID_L=\"PARAM_EYE_L_OPEN\",this.eyeID_R=\"PARAM_EYE_R_OPEN\"}function _(){this.tr=new Float32Array(16),this.identity()}function a(t,i){_.prototype.constructor.call(this),this.width=t,this.height=i}function h(){MotionQueueManager.prototype.constructor.call(this),this.currentPriority=null,this.reservePriority=null,this.super=MotionQueueManager.prototype}function l(){this.physicsList=new Array,this.startTimeMSec=UtSystem.getUserTimeMSec()}function $(){this.lastTime=0,this.lastModel=null,this.partsGroups=new Array}function u(t){this.paramIndex=-1,this.partsIndex=-1,this.link=null,this.id=t}function p(){this.EPSILON=.01,this.faceTargetX=0,this.faceTargetY=0,this.faceX=0,this.faceY=0,this.faceVX=0,this.faceVY=0,this.lastTimeSec=0}function f(){_.prototype.constructor.call(this),this.screenLeft=null,this.screenRight=null,this.screenTop=null,this.screenBottom=null,this.maxLeft=null,this.maxRight=null,this.maxTop=null,this.maxBottom=null,this.max=Number.MAX_VALUE,this.min=0}function c(){}var d=0;r.prototype.getModelMatrix=function(){return this.modelMatrix},r.prototype.setAlpha=function(t){t>.999&&(t=1),t<.001&&(t=0),this.alpha=t},r.prototype.getalpha=function(){return this.alpha},r.prototype.isinitialized=\"function(){return\" this.initialized},r.prototype.setinitialized=\"function(t){this.initialized=t},r.prototype.isUpdating=function(){return\" this.updating},r.prototype.setupdating=\"function(t){this.updating=t},r.prototype.getLive2DModel=function(){return\" this.live2dmodel},r.prototype.setlipsync=\"function(t){this.lipSync=t},r.prototype.setLipSyncValue=function(t){this.lipSyncValue=t},r.prototype.setAccel=function(t,i,e){this.accelX=t,this.accelY=i,this.accelZ=e},r.prototype.setDrag=function(t,i){this.dragX=t,this.dragY=i},r.prototype.getMainMotionManager=function(){return\" this.mainmotionmanager},r.prototype.getexpressionmanager=\"function(){return\" this.expressionmanager},r.prototype.loadmodeldata=\"function(t,i){var\" e=\"c.getPlatformManager();this.debugMode&&e.log(\"Load\" model : \"+t);var r=\"this;e.loadLive2DModel(t,function(t){if(r.live2DModel=t,r.live2DModel.saveParam(),0!=Live2D.getError())return\" void console.error(\"error failed to loadmodeldata().\");r.modelmatrix=\"new\" a(r.live2dmodel.getcanvaswidth(),r.live2dmodel.getcanvasheight()),r.modelmatrix.setwidth(2),r.modelmatrix.setcenterposition(0,0),i(r.live2dmodel)})},r.prototype.loadtexture=\"function(t,i,e){d++;var\" texture \"+i);var o=\"this;r.loadTexture(this.live2DModel,t,i,function(){d--,0==d&&(o.isTexLoaded=!0),\"function\"==typeof\" e&&e()})},r.prototype.loadmotion=\"function(t,i,e){var\" motion expression n=\"this;r.loadBytes(i,function(i){null!=t&&(n.expressions[t]=o.loadJson(i)),\"function\"==typeof\" e&&e()})},r.prototype.loadpose=\"function(t,i){var\" pose i&&i()})}catch(t){console.warn(t)}},r.prototype.loadphysics=\"function(t){var\" i=\"c.getPlatformManager();this.debugMode&&i.log(\"Load\" physics l=\"o[h],$=o[h+1];l<n&&(n=l),l\">s&&(s=l),$<_&&(_=$),$>a&&(a=$)}var u=this.modelMatrix.invertTransformX(i),p=this.modelMatrix.invertTransformY(e);return n<=u&&u<=s&&_<=p&&p<=a},r.prototype.hittestsimplecustom=function(t,i,e,r){return null!=\"=this.live2DModel&&(e\">=t[0]&&e<=i[0]&&r<=t[1]&&r>=i[1])},o.prototype=new AMotion,o.EXPRESSION_DEFAULT=\"DEFAULT\",o.TYPE_SET=0,o.TYPE_ADD=1,o.TYPE_MULT=2,o.loadJson=function(t){var i=new o,e=c.getPlatformManager(),r=e.jsonParseFromBytes(t);if(i.setFadeIn(parseInt(r.fade_in)>0?parseInt(r.fade_in):1e3),i.setFadeOut(parseInt(r.fade_out)>0?parseInt(r.fade_out):1e3),null==r.params)return i;var s=r.params,_=s.length;i.paramList=[];for(var a=0;a<_;a++){var h=\"s[a],l=h.id.toString(),$=parseFloat(h.val),u=o.TYPE_ADD,p=null!=h.calc?h.calc.toString():\"add\";if((u=\"add\"===p?o.TYPE_ADD:\"mult\"===p?o.TYPE_MULT:\"set\"===p?o.TYPE_SET:o.TYPE_ADD)==o.TYPE_ADD){var\" f=\"null==h.def?0:parseFloat(h.def);$-=f}else\" if(u=\"=o.TYPE_MULT){var\" d=\"new\" n;d.id=\"l,d.type=u,d.value=$,i.paramList.push(d)}return\" i},o.prototype.updateparamexe=\"function(t,i,e,r){for(var\" n=\"this.paramList.length-1;n\">=0;--n){var s=this.paramList[n];s.type==o.TYPE_ADD?t.addToParamFloat(s.id,s.value,e):s.type==o.TYPE_MULT?t.multParamFloat(s.id,s.value,e):s.type==o.TYPE_SET&&t.setParamFloat(s.id,s.value,e)}},s.prototype.calcNextBlink=function(){return UtSystem.getUserTimeMSec()+Math.random()*(2*this.blinkIntervalMsec-1)},s.prototype.setInterval=function(t){this.blinkIntervalMsec=t},s.prototype.setEyeMotion=function(t,i,e){this.closingMotionMsec=t,this.closedMotionMsec=i,this.openingMotionMsec=e},s.prototype.updateParam=function(t){var i,e=UtSystem.getUserTimeMSec(),r=0;switch(this.eyeState){case g.STATE_CLOSING:r=(e-this.stateStartTime)/this.closingMotionMsec,r>=1&&(r=1,this.eyeState=g.STATE_CLOSED,this.stateStartTime=e),i=1-r;break;case g.STATE_CLOSED:r=(e-this.stateStartTime)/this.closedMotionMsec,r>=1&&(this.eyeState=g.STATE_OPENING,this.stateStartTime=e),i=0;break;case g.STATE_OPENING:r=(e-this.stateStartTime)/this.openingMotionMsec,r>=1&&(r=1,this.eyeState=g.STATE_INTERVAL,this.nextBlinkTime=this.calcNextBlink()),i=r;break;case g.STATE_INTERVAL:this.nextBlinkTime<e&&(this.eyestate=g.state_closing,this.statestarttime=e),i=1;break;case g.state_first:default:this.eyestate=\"g.STATE_INTERVAL,this.nextBlinkTime=this.calcNextBlink(),i=1}this.closeIfZero||(i=-i),t.setParamFloat(this.eyeID_L,i),t.setParamFloat(this.eyeID_R,i)};var\" g=\"function(){};g.STATE_FIRST=\"STATE_FIRST\",g.STATE_INTERVAL=\"STATE_INTERVAL\",g.STATE_CLOSING=\"STATE_CLOSING\",g.STATE_CLOSED=\"STATE_CLOSED\",g.STATE_OPENING=\"STATE_OPENING\",_.mul=function(t,i,e){var\" r,o,n,s=\"[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<4;r++)for(o=0;o<4;o++)for(n=0;n<4;n++)s[r+4*o]+=t[r+4*n]*i[n+4*o];for(r=0;r<16;r++)e[r]=s[r]},_.prototype.identity=function(){for(var\" t=\"0;t<16;t++)this.tr[t]=t%5==0?1:0},_.prototype.getArray=function(){return\" this.tr},_.prototype.getcopymatrix=\"function(){return\" new float32array(this.tr)},_.prototype.setmatrix=\"function(t){if(null!=this.tr&&this.tr.length==this.tr.length)for(var\" i=\"0;i<16;i++)this.tr[i]=t[i]},_.prototype.getScaleX=function(){return\" this.tr[0]},_.prototype.getscaley=\"function(){return\" this.tr[5]},_.prototype.transformx=\"function(t){return\" this.tr[0]*t+this.tr[12]},_.prototype.transformy=\"function(t){return\" this.tr[5]*t+this.tr[13]},_.prototype.inverttransformx=\"function(t){return(t-this.tr[12])/this.tr[0]},_.prototype.invertTransformY=function(t){return(t-this.tr[13])/this.tr[5]},_.prototype.multTranslate=function(t,i){var\" e=\"[1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1];_.mul(e,this.tr,this.tr)},_.prototype.translate=function(t,i){this.tr[12]=t,this.tr[13]=i},_.prototype.translateX=function(t){this.tr[12]=t},_.prototype.translateY=function(t){this.tr[13]=t},_.prototype.multScale=function(t,i){var\" _,a.prototype.setposition=\"function(t,i){this.translate(t,i)},a.prototype.setCenterPosition=function(t,i){var\" motionqueuemanager,h.prototype.getcurrentpriority=\"function(){return\" this.currentpriority},h.prototype.getreservepriority=\"function(){return\" this.reservepriority},h.prototype.reservemotion=\"function(t){return!(this.reservePriority\">=t)&&(!(this.currentPriority>=t)&&(this.reservePriority=t,!0))},h.prototype.setReservePriority=function(t){this.reservePriority=t},h.prototype.updateParam=function(t){var i=MotionQueueManager.prototype.updateParam.call(this,t);return this.isFinished()&&(this.currentPriority=0),i},h.prototype.startMotionPrio=function(t,i){return i==this.reservePriority&&(this.reservePriority=0),this.currentPriority=i,this.startMotion(t,!1)},l.load=function(t){for(var i=new l,e=c.getPlatformManager(),r=e.jsonParseFromBytes(t),o=r.physics_hair,n=o.length,s=0;s<n;s++){var _=\"o[s],a=new\" physicshair,h=\"_.setup,$=parseFloat(h.length),u=parseFloat(h.regist),p=parseFloat(h.mass);a.setup($,u,p);for(var\" f=\"_.src,d=f.length,g=0;g<d;g++){var\" y=\"f[g],m=y.id,T=PhysicsHair.Src.SRC_TO_X,P=y.ptype;\"x\"===P?T=PhysicsHair.Src.SRC_TO_X:\"y\"===P?T=PhysicsHair.Src.SRC_TO_Y:\"angle\"===P?T=PhysicsHair.Src.SRC_TO_G_ANGLE:UtDebug.error(\"live2d\",\"Invalid\" parameter:physicshair.src\");var s=\"parseFloat(y.scale),v=parseFloat(y.weight);a.addSrcParam(T,m,S,v)}for(var\" l=\"_.targets,M=L.length,g=0;g<M;g++){var\" e=\"L[g],m=E.id,T=PhysicsHair.Target.TARGET_FROM_ANGLE,P=E.ptype;\"angle\"===P?T=PhysicsHair.Target.TARGET_FROM_ANGLE:\"angle_v\"===P?T=PhysicsHair.Target.TARGET_FROM_ANGLE_V:UtDebug.error(\"live2d\",\"Invalid\" parameter:physicshair.target\");var i},l.prototype.updateparam=\"function(t){for(var\" i=\"UtSystem.getUserTimeMSec()-this.startTimeMSec,e=0;e<this.physicsList.length;e++)this.physicsList[e].update(t,i)},$.load=function(t){for(var\" $,e=\"c.getPlatformManager(),r=e.jsonParseFromBytes(t),o=r.parts_visible,n=o.length,s=0;s<n;s++){for(var\" array,p=\"0;p<h;p++){var\" u(f.id);if(l[p]=\"d,null!=f.link){var\" g=\"f.link,y=g.length;d.link=new\" array;for(var m=\"0;m<y;m++){var\" t=\"new\" u(g[m]);d.link.push(t)}}}i.partsgroups.push(l)}return i},$.prototype.updateparam=\"function(t){if(null!=t){t!=this.lastModel&&this.initParam(t),this.lastModel=t;var\" r=\"0;r<this.partsGroups.length;r++)this.normalizePartsOpacityGroup(t,this.partsGroups[r],e),this.copyOpacityOtherParts(t,this.partsGroups[r])}},$.prototype.initParam=function(t){if(null!=t)for(var\" o=\"e[r].partsIndex,n=e[r].paramIndex;if(!(o<0)){var\">=0)break;r=n,o=t.getPartsOpacity(s),o+=e/.5,o>1&&(o=1)}}r<0&&(r=0,o=1);for(var n=\"0;n<i.length;n++){var\" s=\"i[n].partsIndex;if(!(s<0))if(r==n)t.setPartsOpacity(s,o);else{var\" a,h=\"t.getPartsOpacity(s);a=o<.5?-.5*o/.5+1:.5*(1-o)/.5;var\" l=\"(1-a)*(1-o);l\">.15&&(a=1-.15/(1-o)),h>a&&(h=a),t.setPartsOpacity(s,h)}}},$.prototype.copyOpacityOtherParts=function(t,i){for(var e=0;e<i.length;e++){var r=\"i[e];if(null!=r.link&&!(r.partsIndex<0))for(var\" o=\"t.getPartsOpacity(r.partsIndex),n=0;n<r.link.length;n++){var\" s=\"r.link[n];s.partsIndex<0||t.setPartsOpacity(s.partsIndex,o)}}},u.prototype.initIndex=function(t){this.paramIndex=t.getParamIndex(\"VISIBLE:\"+this.id),this.partsIndex=t.getPartsDataIndex(PartsDataID.getID(this.id)),t.setParamFloat(this.paramIndex,1)},p.FRAME_RATE=30,p.prototype.setPoint=function(t,i){this.faceTargetX=t,this.faceTargetY=i},p.prototype.getX=function(){return\" this.facex},p.prototype.gety=\"function(){return\" this.facey},p.prototype.update=\"function(){var\" t=\"40/7.5/p.FRAME_RATE;if(0==this.lastTimeSec)return\" void(this.lasttimesec=\"UtSystem.getUserTimeMSec());var\" i=\"UtSystem.getUserTimeMSec(),e=(i-this.lastTimeSec)*p.FRAME_RATE/1e3;this.lastTimeSec=i;var\" _=\"Math.sqrt(n*n+s*s),a=t*n/_,h=t*s/_,l=a-this.faceVX,$=h-this.faceVY,u=Math.sqrt(l*l+$*$);(u<-o||u\">o)&&(l*=o/u,$*=o/u,u=o),this.faceVX+=l,this.faceVY+=$;var f=.5*(Math.sqrt(o*o+16*o*_-8*o*_)-o),c=Math.sqrt(this.faceVX*this.faceVX+this.faceVY*this.faceVY);c>f&&(this.faceVX*=f/c,this.faceVY*=f/c),this.faceX+=this.faceVX,this.faceY+=this.faceVY}},f.prototype=new _,f.prototype.getMaxScale=function(){return this.max},f.prototype.getMinScale=function(){return this.min},f.prototype.setMaxScale=function(t){this.max=t},f.prototype.setMinScale=function(t){this.min=t},f.prototype.isMaxScale=function(){return this.getScaleX()==this.max},f.prototype.isMinScale=function(){return this.getScaleX()==this.min},f.prototype.adjustTranslate=function(t,i){this.tr[0]*this.maxLeft+(this.tr[12]+t)>this.screenLeft&&(t=this.screenLeft-this.tr[0]*this.maxLeft-this.tr[12]),this.tr[0]*this.maxRight+(this.tr[12]+t)<this.screenright&&(t=this.screenright-this.tr[0]*this.maxright-this.tr[12]),this.tr[5]*this.maxtop+(this.tr[13]+i)<this.screentop&&(i=this.screentop-this.tr[5]*this.maxtop-this.tr[13]),this.tr[5]*this.maxbottom+(this.tr[13]+i)>this.screenBottom&&(i=this.screenBottom-this.tr[5]*this.maxBottom-this.tr[13]);var e=[1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1];_.mul(e,this.tr,this.tr)},f.prototype.adjustScale=function(t,i,e){var r=e*this.tr[0];r<this.min?this.tr[0]>0&&(e=this.min/this.tr[0]):r>this.max&&this.tr[0]>0&&(e=this.max/this.tr[0]);var o=[1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1],n=[e,0,0,0,0,e,0,0,0,0,1,0,0,0,0,1],s=[1,0,0,0,0,1,0,0,0,0,1,0,-t,-i,0,1];_.mul(s,this.tr,this.tr),_.mul(n,this.tr,this.tr),_.mul(o,this.tr,this.tr)},f.prototype.setScreenRect=function(t,i,e,r){this.screenLeft=t,this.screenRight=i,this.screenTop=r,this.screenBottom=e},f.prototype.setMaxScreenRect=function(t,i,e,r){this.maxLeft=t,this.maxRight=i,this.maxTop=r,this.maxBottom=e},f.prototype.getScreenLeft=function(){return this.screenLeft},f.prototype.getScreenRight=function(){return this.screenRight},f.prototype.getScreenBottom=function(){return this.screenBottom},f.prototype.getScreenTop=function(){return this.screenTop},f.prototype.getMaxLeft=function(){return this.maxLeft},f.prototype.getMaxRight=function(){return this.maxRight},f.prototype.getMaxBottom=function(){return this.maxBottom},f.prototype.getMaxTop=function(){return this.maxTop},c.platformManager=null,c.getPlatformManager=function(){return c.platformManager},c.setPlatformManager=function(t){c.platformManager=t},t.exports={L2DTargetPoint:p,Live2DFramework:c,L2DViewMatrix:f,L2DPose:$,L2DPartsParam:u,L2DPhysics:l,L2DMotionManager:h,L2DModelMatrix:a,L2DMatrix44:_,EYE_STATE:g,L2DEyeBlink:s,L2DExpressionParam:n,L2DExpressionMotion:o,L2DBaseModel:r}},function(t,i,e){\"use strict\";var r={DEBUG_LOG:!1,DEBUG_MOUSE_LOG:!1,DEBUG_DRAW_HIT_AREA:!1,DEBUG_DRAW_ALPHA_MODEL:!1,VIEW_MAX_SCALE:2,VIEW_MIN_SCALE:.8,VIEW_LOGICAL_LEFT:-1,VIEW_LOGICAL_RIGHT:1,VIEW_LOGICAL_MAX_LEFT:-2,VIEW_LOGICAL_MAX_RIGHT:2,VIEW_LOGICAL_MAX_BOTTOM:-2,VIEW_LOGICAL_MAX_TOP:2,PRIORITY_NONE:0,PRIORITY_IDLE:1,PRIORITY_SLEEPY:2,PRIORITY_NORMAL:3,PRIORITY_FORCE:4,MOTION_GROUP_IDLE:\"idle\",MOTION_GROUP_SLEEPY:\"sleepy\",MOTION_GROUP_TAP_BODY:\"tap_body\",MOTION_GROUP_FLICK_HEAD:\"flick_head\",MOTION_GROUP_PINCH_IN:\"pinch_in\",MOTION_GROUP_PINCH_OUT:\"pinch_out\",MOTION_GROUP_SHAKE:\"shake\",HIT_AREA_HEAD:\"head\",HIT_AREA_BODY:\"body\"};t.exports=r},function(t,i,e){\"use strict\";function r(t){n=t}function o(){return n}Object.defineProperty(i,\"__esModule\",{value:!0}),i.setContext=r,i.getContext=o;var n=void 0},function(t,i,e){\"use strict\";function r(){}r.matrixStack=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.depth=0,r.currentMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.tmp=new Array(16),r.reset=function(){this.depth=0},r.loadIdentity=function(){for(var t=0;t<16;t++)this.currentmatrix[t]=t%5==0?1:0},r.push=function(){var t=\"(this.depth,16*(this.depth+1));this.matrixStack.length<t+16&&(this.matrixStack.length=t+16);for(var\" i=\"0;i<16;i++)this.matrixStack[t+i]=this.currentMatrix[i];this.depth++},r.pop=function(){--this.depth<0&&(myError(\"Invalid\" matrix stack.\"),this.depth=\"0);for(var\" this.currentmatrix},r.multmatrix=\"function(t){var\" i,e,r;for(i=\"0;i<16;i++)this.tmp[i]=0;for(i=0;i<4;i++)for(e=0;e<4;e++)for(r=0;r<4;r++)this.tmp[i+4*e]+=this.currentMatrix[i+4*r]*t[r+4*e];for(i=0;i<16;i++)this.currentMatrix[i]=this.tmp[i]},t.exports=r},function(t,i,e){t.exports=e(5)},function(t,i,e){\"use\" strict\";function r(t){return t&&t.__esmodule?t:{default:t}}function o(t){c=\"document.getElementById(t),C.addEventListener&&(window.addEventListener(\"click\",g),window.addEventListener(\"mousedown\",g),window.addEventListener(\"mousemove\",g),window.addEventListener(\"mouseup\",g),document.addEventListener(\"mouseout\",g),window.addEventListener(\"touchstart\",y),window.addEventListener(\"touchend\",y),window.addEventListener(\"touchmove\",y))}function\" n(t){var m.l2dtargetpoint;var r=\"e/i,o=w.default.VIEW_LOGICAL_LEFT,n=w.default.VIEW_LOGICAL_RIGHT,_=-r,h=r;if(window.Live2D.captureFrame=!1,B=new\" m.l2dviewmatrix,b.setscreenrect(o,n,_,h),b.setmaxscreenrect(w.default.view_logical_max_left,w.default.view_logical_max_right,w.default.view_logical_max_bottom,w.default.view_logical_max_top),b.setmaxscale(w.default.view_max_scale),b.setminscale(w.default.view_min_scale),u=\"new\" m.l2dmatrix44,u.multscale(1,i e),g=\"new\" m.l2dmatrix44,g.multtranslate(-i 2,-e 2),g.multscale(2 i,-2 i),f=\"v(),(0,D.setContext)(F),!F)return\" console.error(\"failed to create webgl context.\"),void(window.webglrenderingcontext&&console.error(\"your browser don't support webgl, check https: get.webgl.org for futher information.\"));window.live2d.setgl(f),f.clearcolor(0,0,0,0),a(t),s()}function s(){b||(b=\"!0,function\" t(){_();var e=\"document.createElement(\"a\");document.body.appendChild(e),e.setAttribute(\"type\",\"hidden\"),e.href=C.toDataURL(),e.download=window.Live2D.captureName||\"live2d.png\",e.click()}i(t,C)}())}function\" _(){o.default.reset(),o.default.loadidentity(),n.update(),r.setdrag(n.getx(),n.gety()),f.clear(f.color_buffer_bit),o.default.multmatrix(u.getarray()),o.default.multmatrix(b.getarray()),o.default.push();for(var a(t){r.reloadflg=\"!0,R.count++,R.changeModel(F,t)}function\" h(t,i){return t.x*i.x+t.y*i.y}function l(t,i){var $(t,i,e){function r(t,i){return 180*math.acos(h({x:0,y:1},l(t,i))) math.pi}if(i.x<e.left+e.width&&i.y<e.top+e.height&&i.x>e.left&&i.y>e.top)return i;var o=t.x-i.x,n=t.y-i.y,s=r(o,n);i.x<t.x&&(s=360-s);var 0=\"==e?.5:e,o(t),n(i)}e(6);var\" _=\"360-r(e.left-t.x,-1*(e.top-t.y)),a=360-r(e.left-t.x,-1*(e.top+e.height-t.y)),$=r(e.left+e.width-t.x,-1*(e.top-t.y)),u=r(e.left+e.width-t.x,-1*(e.top+e.height-t.y)),p=n/o,f={};if(s<$){var\" c=\"e.top-t.y,d=c/p;f={y:t.y+c,x:t.x+d}}else\" if(s<u){var g=\"e.left+e.width-t.x,y=g*p;f={y:t.y+y,x:t.x+g}}else\" if(s<a){var m=\"e.top+e.height-t.y,T=m/p;f={y:t.y+m,x:t.x+T}}else\" if(s<_){var p=\"t.x-e.left,S=P*p;f={y:t.y-S,x:t.x-P}}else{var\" v=\"e.top-t.y,L=v/p;f={y:t.y+v,x:t.x+L}}return\" f}function u(t){y=\"!0;var\" i=\"C.getBoundingClientRect(),e=P(t.clientX-i.left),r=S(t.clientY-i.top),o=$({x:i.left+i.width/2,y:i.top+i.height*X},{x:t.clientX,y:t.clientY},i),n=m(o.x-i.left),s=T(o.y-i.top);w.default.DEBUG_MOUSE_LOG&&console.log(\"onMouseMove\" device( x:\"+t.clientx+\" y:\"+t.clienty+\" ) view( x:\"+n+\" y:\"+s+\")\"),k=\"e,V=r,N.setPoint(n,s)}function\" p(t){y=\"!0;var\" f(t){var y:\"+s+\")\"),y&&(k=\"e,V=r,N.setPoint(n,s))}function\" c(){y&&(y=\"!1),N.setPoint(0,0)}function\" d(){w.default.debug_log&&console.log(\"set session storage.\"),sessionstorage.setitem(\"sleepy\",\"1\")}function g(t){if(\"mousewheel\"=\"=t.type);else\" if(\"mousedown\"=\"=t.type)p(t);else\" if(\"mousemove\"=\"=t.type){var\" if(\"mouseup\"=\"=t.type){if(\"button\"in\" t&&0!=\"t.button)return}else\" if(\"mouseout\"=\"=t.type){w.default.DEBUG_LOG&&console.log(\"Mouse\" out window.\"),c();var e=\"sessionStorage.getItem(\"SleepyTimer\");window.clearTimeout(e),e=window.setTimeout(d,5e4),sessionStorage.setItem(\"SleepyTimer\",e)}}function\" y(t){var m(t){var b.inverttransformx(i)}function t(t){var b.inverttransformy(i)}function p(t){return g.transformx(t)}function s(t){return g.transformy(t)}function v(){for(var t=\"[\"webgl\",\"experimental-webgl\",\"webkit-3d\",\"moz-webgl\"],i=0;i<t.length;i++)try{var\" e}catch(t){}return null}function l(t,i,e){x=\"void\" a.default),b=\"!1,F=null,C=null,N=null,B=null,U=null,G=null,Y=!1,k=0,V=0,X=.5;window.loadlive2d=L},function(t,i,e){\"use\" strict\";(function(t){!function(){function i(){at||(this._$mt=\"null,this._$5S=null,this._$NP=0,i._$42++,this._$5S=new\" y(this))}function e(t){if(!at){this.clipcontextlist=\"new\" array,this.glcontext=\"t.gl,this.dp_webgl=t,this.curFrameNo=0,this.firstError_clipInNotUpdate=!0,this.colorBuffer=0,this.isInitGLFBFunc=!1,this.tmpBoundsOnModel=new\" s,at.glcontext.length>at.frameBuffers.length&&(this.curFrameNo=this.getMaskRenderTexture()),this.tmpModelToViewMatrix=new R,this.tmpMatrix2=new R,this.tmpMatrixForMask=new R,this.tmpMatrixForDraw=new R,this.CHANNEL_COLORS=new Array;var i=new A;i=new A,i.r=0,i.g=0,i.b=0,i.a=1,this.CHANNEL_COLORS.push(i),i=new A,i.r=1,i.g=0,i.b=0,i.a=0,this.CHANNEL_COLORS.push(i),i=new A,i.r=0,i.g=1,i.b=0,i.a=0,this.CHANNEL_COLORS.push(i),i=new A,i.r=0,i.g=0,i.b=1,i.a=0,this.CHANNEL_COLORS.push(i);for(var e=0;e<this.channel_colors.length;e++)this.dp_webgl.setchannelflagascolor(e,this.channel_colors[e])}}function r(t,i,e){this.clipidlist=\"new\" array,this.clipidlist=\"e,this.clippingMaskDrawIndexList=new\" array;for(var r=\"0;r<e.length;r++)this.clippingMaskDrawIndexList.push(i.getDrawDataIndex(e[r]));this.clippedDrawContextList=new\" array,this.isusing=\"!0,this.layoutChannelNo=0,this.layoutBounds=new\" s,this.allclippeddrawrect=\"new\" s,this.matrixformask=\"new\" float32array(16),this.matrixfordraw=\"new\" float32array(16),this.owner=\"t}function\" o(t,i){this._$gp=\"t,this.drawDataIndex=i}function\" n(){at||(this.color=\"null)}function\" s(){at||(this._$dp=\"null,this._$eo=null,this._$V0=null,this._$dP=1e3,this._$eo=1e3,this._$V0=1,this._$a0())}function\" _(){}function a(){this._$r=\"null,this._$0S=null}function\" h(){at||(this.x=\"null,this.y=null,this.width=null,this.height=null)}function\" l(t){at||et.prototype.constructor.call(this,t)}function $(){}function u(t){at||et.prototype.constructor.call(this,t)}function p(){at||(this._$vo=\"null,this._$F2=null,this._$ao=400,this._$1S=400,p._$42++)}function\" f(){at||(this.p1=\"new\" c,this.p2=\"new\" c,this._$fo=\"0,this._$Db=0,this._$L2=0,this._$M2=0,this._$ks=0,this._$9b=0,this._$iP=0,this._$iT=0,this._$lL=new\" array,this._$qp=\"new\" array,this.setup(.3,.5,.1))}function c(){this._$p=\"1,this.x=0,this.y=0,this.vx=0,this.vy=0,this.ax=0,this.ay=0,this.fx=0,this.fy=0,this._$s0=0,this._$70=0,this._$7L=0,this._$HL=0}function\" d(t,i,e){this._$wl=\"null,this.scale=null,this._$V0=null,this._$wL=t,this.scale=i,this._$V0=e}function\" g(t,i,e,r){d.prototype.constructor.call(this,i,e,r),this._$tl=\"null,this._$tL=t}function\" y(t,i,e){this._$wl=\"null,this.scale=null,this._$V0=null,this._$wL=t,this.scale=i,this._$V0=e}function\" t(t,i,e,r){y.prototype.constructor.call(this,i,e,r),this._$yp=\"null,this._$YP=t}function\" p(){at||(this._$fl=\"0,this._$gL=0,this._$B0=1,this._$z0=1,this._$qT=0,this.reflectX=!1,this.reflectY=!1)}function\" s(){at||(this.x=\"null,this.y=null,this.width=null,this.height=null)}function\" v(){}function l(){at||(this.x=\"null,this.y=null)}function\" m(){at||(this._$gp=\"null,this._$dr=null,this._$GS=null,this._$qb=null,this._$Lb=null,this._$mS=null,this.clipID=null,this.clipIDList=new\" array)}function e(){at||(this._$eb=\"E._$ps,this._$lT=1,this._$C0=1,this._$tT=1,this._$WL=1,this.culling=!1,this.matrix4x4=new\" float32array(16),this.premultipliedalpha=\"!1,this.anisotropy=0,this.clippingProcess=E.CLIPPING_PROCESS_NONE,this.clipBufPre_clipContextMask=null,this.clipBufPre_clipContextDraw=null,this.CHANNEL_COLORS=new\" a(){at||(this.a=\"1,this.r=1,this.g=1,this.b=1,this.scale=1,this._$ho=1,this.blendMode=at.L2D_COLOR_BLEND_MODE_MULT)}function\" i(){at||(this._$kp=\"null,this._$dr=null,this._$Ai=!0,this._$mS=null)}function\" w(){}function x(){at||(this._$vp=\"0,this._$wL=null,this._$GP=null,this._$8o=x._$ds,this._$2r=-1,this._$O2=0,this._$ri=0)}function\" o(){}function d(){at||(this._$ob=\"null)}function\" r(){this.m=\"new\" float32array(16),this.identity()}function b(t){at||et.prototype.constructor.call(this,t)}function f(){at||(this._$7=\"1,this._$f=0,this._$H=0,this._$g=1,this._$k=0,this._$w=0,this._$hi=STATE_IDENTITY,this._$Z=_$pS)}function\" c(){at||(s.prototype.constructor.call(this),this.motions=\"new\" array,this._$7r=\"null,this._$7r=C._$Co++,this._$D0=30,this._$yT=0,this._$E=!0,this.loopFadeIn=!0,this._$AS=-1,_$a0())}function\" n(){this._$p=\"new\" float32array(100),this.size=\"0}function\" b(){this._$4p=\"null,this._$I0=null,this._$RP=null}function\" u(){}function g(){}function y(t){at||(this._$qt=\"!0,this._$co=-1,this._$qo=0,this._$pb=new\" array(y._$is),this._$_2=\"new\" float32array(y._$is),this._$vr=\"new\" float32array(y._$is),this._$rr=\"new\" float32array(y._$is),this._$or=\"new\" float32array(y._$is),this._$fs=\"new\" float32array(y._$is),this._$js=\"new\" array(y._$is),this._$3s=\"new\" array,this._$as=\"new\" array,this._$bo=\"null,this._$F2=new\" array,this._$db=\"new\" array,this._$8b=\"new\" array,this._$hr=\"new\" array,this._$ws=\"null,this._$Vs=null,this._$Er=null,this._$Es=new\" int16array(u._$qb),this._$zp=\"new\" float32array(2*u._$1r),this._$ri=\"t,this._$b0=Y._$HP++,this.clipManager=null,this.dp_webgl=null)}function\" k(){}function v(){at||(this._$12=\"null,this._$bb=null,this._$_L=null,this._$jo=null,this._$iL=null,this._$0L=null,this._$Br=null,this._$Dr=null,this._$Cb=null,this._$mr=null,this._$_L=wt.STATE_FIRST,this._$Br=4e3,this._$Dr=100,this._$Cb=50,this._$mr=150,this._$jo=!0,this._$iL=\"PARAM_EYE_L_OPEN\",this._$0L=\"PARAM_EYE_R_OPEN\")}function\" x(){at||(e.prototype.constructor.call(this),this._$sb=\"new\" int32array(x._$as),this._$u2=\"new\" array,this.transform=\"null,this.gl=null,null==X._$NT&&(X._$NT=X._$9r(256),X._$vS=X._$9r(256),X._$no=X._$vb(256)))}function\" z(){at||(i.prototype.constructor.call(this),this._$gs=\"null,this._$Y0=null)}function\" h(t){_t.prototype.constructor.call(this,t),this._$8r=\"I._$ur,this._$Yr=null,this._$Wr=null}function\" w(){at||(m.prototype.constructor.call(this),this._$gp=\"null,this._$dr=null,this._$GS=null,this._$qb=null,this._$Lb=null,this._$mS=null)}function\" j(){at||(this._$nl=\"null,this._$3S=null,this._$aS=null,j._$42++)}function\" q(){at||(i.prototype.constructor.call(this),this._$zo=\"new\" x)}function j(){at||(s.prototype.constructor.call(this),this.motions=\"new\" array,this._$o2=\"null,this._$7r=J._$Co++,this._$D0=30,this._$yT=0,this._$E=!1,this.loopFadeIn=!0,this._$rr=-1,this._$eP=0)}function\" q(t,i){return string.fromcharcode(t.getuint8(i))}function z(){at||(i.prototype.constructor.call(this),this._$o=\"0,this._$A=0,this._$GS=null,this._$Eo=null)}function\" k(t){_t.prototype.constructor.call(this,t),this._$8r=\"I._$ur,this._$Cr=null,this._$hr=null}function\" tt(){at||(this.visible=\"!0,this._$g0=!1,this._$NL=null,this._$3S=null,this._$aS=null,tt._$42++)}function\" it(t){this._$vs=\"null,this._$e0=null,this._$e0=t}function\" et(t){at||(this.id=\"t)}function\" rt(){}function ot(){at||(this._$4s=\"null)}function\" nt(t,i){this.canvas=\"t,this.context=i,this.viewport=new\" array(0,0,t.width,t.height),this._$6r=\"1,this._$xP=0,this._$3r=1,this._$uP=0,this._$Qo=-1,this.cacheImages={}}function\" st(){at||(this._$tt=\"null,this._$LT=null,this._$FS=null,this._$wL=null)}function\" _t(t){at||(this._$e0=\"null,this._$IP=null,this._$JS=!1,this._$AT=!0,this._$e0=t,this.totalScale=1,this._$7s=1,this.totalOpacity=1)}function\" at(){}function ht(){}function lt(t){at||(this._$ib=\"t)}function\" $t(){at||(w.prototype.constructor.call(this),this._$lp=\"-1,this._$d0=0,this._$Yo=0,this._$JP=null,this._$5P=null,this._$BP=null,this._$Eo=null,this._$Qi=null,this._$6s=$t._$ms,this.culling=!0,this.gl_cacheImage=null,this.instanceNo=$t._$42++)}function\" ut(t){mt.prototype.constructor.call(this,t),this._$8r=\"W._$ur,this._$Cr=null,this._$hr=null}function\" pt(){at||(this.x=\"null,this.y=null)}function\" ft(t){at||(i.prototype.constructor.call(this),this.drawparamwebgl=\"new\" mt(t),this.drawparamwebgl.setgl(at.getgl(t)))}function ct(){at||(this.motions=\"null,this._$eb=!1,this.motions=new\" dt(){this._$w0=\"null,this._$AT=!0,this._$9L=!1,this._$z2=-1,this._$bs=-1,this._$Do=-1,this._$sr=null,this._$sr=dt._$Gs++}function\" gt(){this.m=\"new\" array(1,0,0,0,1,0,0,0,1)}function yt(t){at||et.prototype.constructor.call(this,t)}function mt(t){at||(e.prototype.constructor.call(this),this.textures=\"new\" tt(t,i,e){return null=\"=i&&(i=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,e,t.DYNAMIC_DRAW),i}function\" pt(t,i,e){return st(t){at||(this._$p=\"new\" int8array(8),this._$r0=\"new\" dataview(this._$p.buffer),this._$3i=\"new\" int8array(1e3),this._$hl=\"0,this._$v0=0,this._$S2=0,this._$Ko=new\" array,this._$t=\"t,this._$F=0)}function\" vt(){}function lt(){}function mt(t){at||(this._$e0=\"null,this._$IP=null,this._$Us=null,this._$7s=null,this._$IS=[!1],this._$VS=null,this._$AT=!0,this.baseOpacity=1,this.clipBufPre_clipContext=null,this._$e0=t)}function\" et(){}var at=\"!0;i._$0s=1,i._$4s=2,i._$42=0,i._$62=function(t,e){try{if(e\" instanceof arraybuffer&&(e=\"new\" dataview(e)),!(e dataview))throw new lt(\"_$ss#loadmodel(b) b _$x be dataview or arraybuffer\");var r,o=\"new\" st(e),n=\"o._$ST(),s=o._$ST(),a=o._$ST();if(109!=n||111!=s||99!=a)throw\" lt(\"_$gi _$c _$li , _$q0 _$p0.\");if(r=\"o._$ST(),o._$gr(r),r\">G._$T7){t._$NP|=i._$4s;throw new lt(\"_$gi _$C _$li , _$n0 _$_ version _$li ( SDK : \"+G._$T7+\" < _$f0 : \"+r+\" )@_$SS#loadModel()\\n\")}var h=o._$nP();if(r>=G._$s7){var l=o._$9T(),$=o._$9T();if(-30584!=l||-30584!=$)throw t._$NP|=i._$0s,new lt(\"_$gi _$C _$li , _$0 _$6 _$Ui.\")}t._$KS(h);var u=t.getModelContext();u.setDrawParam(t.getDrawParam()),u.init()}catch(t){_._$Rb(t)}},i.prototype._$KS=function(t){this._$MT=t},i.prototype.getModelImpl=function(){return null==this._$MT&&(this._$MT=new p,this._$MT._$zP()),this._$MT},i.prototype.getCanvasWidth=function(){return null==this._$MT?0:this._$MT.getCanvasWidth()},i.prototype.getCanvasHeight=function(){return null==this._$MT?0:this._$MT.getCanvasHeight()},i.prototype.getParamFloat=function(t){return\"number\"!=typeof t&&(t=this._$5S.getParamIndex(u.getID(t))),this._$5S.getParamFloat(t)},i.prototype.setParamFloat=function(t,i,e){\"number\"!=typeof t&&(t=this._$5S.getParamIndex(u.getID(t))),arguments.length<3&&(e=1),this._$5s.setparamfloat(t,this._$5s.getparamfloat(t)*(1-e)+i*e)},i.prototype.addtoparamfloat=function(t,i,e){\"number\"!=typeof t&&(t=\"this._$5S.getParamIndex(u.getID(t))),arguments.length<3&&(e=1),this._$5S.setParamFloat(t,this._$5S.getParamFloat(t)+i*e)},i.prototype.multParamFloat=function(t,i,e){\"number\"!=typeof\" this._$5s.getparamindex(u.getid(t))},i.prototype.loadparam=\"function(){this._$5S.loadParam()},i.prototype.saveParam=function(){this._$5S.saveParam()},i.prototype.init=function(){this._$5S.init()},i.prototype.update=function(){this._$5S.update()},i.prototype._$Rs=function(){return\" _._$li(\"_$60 _$pt _$rs()\"),-1},i.prototype._$ds=\"function(t){_._$li(\"_$60\" _$ss#_$ds() \\n\")},i.prototype._$k2=\"function(){},i.prototype.draw=function(){},i.prototype.getModelContext=function(){return\" this._$5s},i.prototype._$s2=\"function(){return\" this._$np},i.prototype._$p7=\"function(t,i,e,r){var\" o=\"-1,n=0,s=this;if(0!=e)if(1==t.length){var\" _=\"t[0],a=0!=s.getParamFloat(_),h=i[0],l=s.getPartsOpacity(h),$=e/r;a?(l+=$)\">1&&(l=1):(l-=$)<0&&(l=0),s.setpartsopacity(h,l)}else{for(var u=\"0;u<t.length;u++){var\" _=\"t[u],p=0!=s.getParamFloat(_);if(p){if(o\">=0)break;o=u;var h=i[u];n=s.getPartsOpacity(h),n+=e/r,n>1&&(n=1)}}o<0&&(console.log(\"no _$wi _$q0 _$u default[%s]\",t[0]),o=\"0,n=1,s.loadParam(),s.setParamFloat(t[o],n),s.saveParam());for(var\" u=\"0;u<t.length;u++){var\" h=\"i[u];if(o==u)s.setPartsOpacity(h,n);else{var\" f,c=\"s.getPartsOpacity(h);f=n<.5?-.5*n/.5+1:.5*(1-n)/.5;var\" d=\"(1-f)*(1-n);d\">.15&&(f=1-.15/(1-n)),c>f&&(c=f),s.setPartsOpacity(h,c)}}}else for(var u=0;u<t.length;u++){var _=\"t[u],h=i[u],p=0!=s.getParamFloat(_);s.setPartsOpacity(h,p?1:0)}},i.prototype.setPartsOpacity=function(t,i){\"number\"!=typeof\" t&&(t=\"this._$5S.getPartsDataIndex(l.getID(t))),this._$5S.setPartsOpacity(t,i)},i.prototype.getPartsDataIndex=function(t){return\" t instanceof l||(t=\"l.getID(t)),this._$5S.getPartsDataIndex(t)},i.prototype.getPartsOpacity=function(t){return\"number\"!=typeof\" this._$5s.getdrawdataindex(b.getid(t))},i.prototype.getdrawdata=\"function(t){return\" this._$5s.getdrawdata(t)},i.prototype.gettransformedpoints=\"function(t){var\" i=\"this._$5S._$C2(t);return\" ut?i.gettransformedpoints():null},i.prototype.getindexarray=\"function(t){if(t<0||t\">=this._$5S._$aS.length)return null;var i=this._$5S._$aS[t];return null!=i&&i.getType()==W._$wb&&i instanceof $t?i.getIndexArray():null},e.CHANNEL_COUNT=4,e.RENDER_TEXTURE_USE_MIPMAP=!1,e.NOT_USED_FRAME=-100,e.prototype._$L7=function(){if(this.tmpModelToViewMatrix&&(this.tmpModelToViewMatrix=null),this.tmpMatrix2&&(this.tmpMatrix2=null),this.tmpMatrixForMask&&(this.tmpMatrixForMask=null),this.tmpMatrixForDraw&&(this.tmpMatrixForDraw=null),this.tmpBoundsOnModel&&(this.tmpBoundsOnModel=null),this.CHANNEL_COLORS){for(var t=this.CHANNEL_COLORS.length-1;t>=0;--t)this.CHANNEL_COLORS.splice(t,1);this.CHANNEL_COLORS=[]}this.releaseShader()},e.prototype.releaseShader=function(){for(var t=at.frameBuffers.length,i=0;i<t;i++)this.gl.deleteframebuffer(at.framebuffers[i].framebuffer);at.framebuffers=[],at.glcontext=[]},e.prototype.init=function(t,i,e){for(var o=\"0;o<i.length;o++){var\" n=\"i[o].getClipIDList();if(null!=n){var\" s=\"this.findSameClip(n);null==s&&(s=new\" r(this,t,n),this.clipcontextlist.push(s));var _=\"i[o].getDrawDataID(),a=t.getDrawDataIndex(_);s.addClippedDrawData(_,a);e[o].clipBufPre_clipContext=s}}},e.prototype.getMaskRenderTexture=function(){var\" t=\"null;return\" e=\"0,r=0;r<this.clipContextList.length;r++){var\">0){var n=i.gl.getParameter(i.gl.FRAMEBUFFER_BINDING),s=new Array(4);s[0]=0,s[1]=0,s[2]=i.gl.canvas.width,s[3]=i.gl.canvas.height,i.gl.viewport(0,0,at.clippingMaskBufferSize,at.clippingMaskBufferSize),this.setupLayoutBounds(e),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,at.frameBuffers[this.curFrameNo].framebuffer),i.gl.clearColor(0,0,0,0),i.gl.clear(i.gl.COLOR_BUFFER_BIT);for(var r=0;r<this.clipcontextlist.length;r++){var o=\"this.clipContextList[r],_=o.allClippedDrawRect,a=(o.layoutChannelNo,o.layoutBounds);this.tmpBoundsOnModel._$jL(_),this.tmpBoundsOnModel.expand(.05*_.width,.05*_.height);var\" h=\"a.width/this.tmpBoundsOnModel.width,l=a.height/this.tmpBoundsOnModel.height;this.tmpMatrix2.identity(),this.tmpMatrix2.translate(-1,-1,0),this.tmpMatrix2.scale(2,2,1),this.tmpMatrix2.translate(a.x,a.y,0),this.tmpMatrix2.scale(h,l,1),this.tmpMatrix2.translate(-this.tmpBoundsOnModel.x,-this.tmpBoundsOnModel.y,0),this.tmpMatrixForMask.setMatrix(this.tmpMatrix2.m),this.tmpMatrix2.identity(),this.tmpMatrix2.translate(a.x,a.y,0),this.tmpMatrix2.scale(h,l,1),this.tmpMatrix2.translate(-this.tmpBoundsOnModel.x,-this.tmpBoundsOnModel.y,0),this.tmpMatrixForDraw.setMatrix(this.tmpMatrix2.m);for(var\" $=\"this.tmpMatrixForMask.getArray(),u=0;u<16;u++)o.matrixForMask[u]=$[u];for(var\" p=\"this.tmpMatrixForDraw.getArray(),u=0;u<16;u++)o.matrixForDraw[u]=p[u];for(var\" f=\"o.clippingMaskDrawIndexList.length,c=0;c<f;c++){var\" d=\"o.clippingMaskDrawIndexList[c],g=t.getDrawData(d),y=t._$C2(d);i.setClipBufPre_clipContextForMask(o),g.draw(i,t,y)}}i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,n),i.setClipBufPre_clipContextForMask(null),i.gl.viewport(s[0],s[1],s[2],s[3])}},e.prototype.getColorBuffer=function(){return\" this.colorbuffer},e.prototype.findsameclip=\"function(t){for(var\" i=\"0;i<this.clipContextList.length;i++){var\" e=\"this.clipContextList[i],r=e.clipIDList.length;if(r==t.length){for(var\" s=\"e.clipIDList[n],_=0;_<r;_++)if(t[_]==s){o++;break}if(o==r)return\" e}}return null},e.prototype.calcclippeddrawtotalbounds=\"function(t,i){for(var\">r?e:r,n=o,s=o,_=0,a=0,h=i.clippedDrawContextList.length,l=0;l<h;l++){var $=\"i.clippedDrawContextList[l],u=$.drawDataIndex,p=t._$C2(u);if(p._$yo()){for(var\" f=\"p.getTransformedPoints(),c=f.length,d=[],g=[],y=0,m=U._$i2;m<c;m+=U._$No)d[y]=f[m],g[y]=f[m+1],y++;var\" t=\"Math.min.apply(null,d),P=Math.min.apply(null,g),S=Math.max.apply(null,d),v=Math.max.apply(null,g);T<n&&(n=T),P<s&&(s=P),S\">_&&(_=S),v>a&&(a=v)}}if(n==o)i.allClippedDrawRect.x=0,i.allClippedDrawRect.y=0,i.allClippedDrawRect.width=0,i.allClippedDrawRect.height=0,i.isUsing=!1;else{var L=_-n,M=a-s;i.allClippedDrawRect.x=n,i.allClippedDrawRect.y=s,i.allClippedDrawRect.width=L,i.allClippedDrawRect.height=M,i.isUsing=!0}},e.prototype.setupLayoutBounds=function(t){var i=t/e.CHANNEL_COUNT,r=t%e.CHANNEL_COUNT;i=~~i,r=~~r;for(var o=0,n=0;n<e.channel_count;n++){var s=\"i+(n<r?1:0);if(0==s);else\" if(1=\"=s){var\" a=\"this.clipContextList[o++];a.layoutChannelNo=n,a.layoutBounds.x=0,a.layoutBounds.y=0,a.layoutBounds.width=1,a.layoutBounds.height=1}else\" if(2=\"=s)for(var\" h=\"0;h<s;h++){var\" l=\"h%2,$=0;l=~~l;var\" if(s<=\"4)for(var\" _._$li(\"_$6 _$0p mask count : %d\",s)}},r.prototype.addclippeddrawdata=\"function(t,i){var\" e=\"new\" o(t,i);this.clippeddrawcontextlist.push(e)},s._$jt=\"function(t,i,e){var\" r=\"t/i,o=e/i,n=o,s=1-(1-o)*(1-o),_=1-(1-n)*(1-n),a=1/3*(1-o)*s+(n*(2/3)+1/3*(1-n))*(1-s),h=(n+2/3*(1-n))*_+(o*(1/3)+2/3*(1-o))*(1-_),l=1-3*h+3*a-0,$=3*h-6*a+0,u=3*a-0;if(r<=0)return\" 0;if(r>=1)return 1;var p=r,f=p*p;return l*(p*f)+$*f+u*p+0},s.prototype._$a0=function(){},s.prototype.setFadeIn=function(t){this._$dP=t},s.prototype.setFadeOut=function(t){this._$eo=t},s.prototype._$pT=function(t){this._$V0=t},s.prototype.getFadeOut=function(){return this._$eo},s.prototype._$4T=function(){return this._$eo},s.prototype._$mT=function(){return this._$V0},s.prototype.getDurationMSec=function(){return-1},s.prototype.getLoopDurationMSec=function(){return-1},s.prototype.updateParam=function(t,i){if(i._$AT&&!i._$9L){var e=w.getUserTimeMSec();if(i._$z2<0){i._$z2=e,i._$bs=e;var r=\"this.getDurationMSec();i._$Do<0&&(i._$Do=r<=0?-1:i._$z2+r)}var\" o=\"this._$V0;o=o*(0==this._$dP?1:ht._$r2((e-i._$bs)/this._$dP))*(0==this._$eo||i._$Do<0?1:ht._$r2((i._$Do-e)/this._$eo)),0<=o&&o<=1||console.log(\"###\" assert!! ### \"),this.updateparamexe(t,e,o,i),i._$do>0&&i._$Do<e&&(i._$9l=!0)}},s.prototype.updateparamexe=function(t,i,e,r){},_._$8s=0,_._$ft=new object,_.start=\"function(t){var\" i=\"_._$fT[t];null==i&&(i=new\" a,i._$r=\"t,_._$fT[t]=i),i._$0S=w.getSystemTimeMSec()},_.dump=function(t){var\" e=\"w.getSystemTimeMSec(),r=e-i._$0S;return\" console.log(t+\" : \"+r+\"ms\"),r}return-1},_.end=\"function(t){var\" w.getsystemtimemsec()-i._$0s}return-1},_._$li=\"function(t,i){console.log(\"_$li\" \"+t+\"\\n\",i)},_._$ji=\"function(t,i){console.log(t,i)},_._$dL=function(t,i){console.log(t,i),console.log(\"\\n\")},_._$KL=function(t,i){for(var\">0?console.log(\"\\n\"):e%8==0&&e>0&&console.log(\"  \"),console.log(\"%02X \",255&t[e]);console.log(\"\\n\")},_._$nr=function(t,i,e){console.log(\"%s\\n\",t);for(var r=i.length,o=0;o<r;++o)console.log(\"%5d\",i[o]),console.log(\"%s\\n\",e),console.log(\",\");console.log(\"\\n\")},_._$rb=function(t){console.log(\"dump exception : \"+t),console.log(\"stack :: \"+t.stack)},h.prototype._$8p=\"function(){return.5*(this.x+this.x+this.width)},h.prototype._$6P=function(){return.5*(this.y+this.y+this.height)},h.prototype._$EL=function(){return\" this.x+this.width},h.prototype._$5t=\"function(){return\" this.y+this.height},h.prototype._$jl=\"function(t,i,e,r){this.x=t,this.y=i,this.width=e,this.height=r},h.prototype._$jL=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},l.prototype=new\" et,l._$tp=\"new\" object,l._$27=\"function(){l._$tP.clear()},l.getID=function(t){var\" i=\"l._$tP[t];return\" null=\"=i&&(i=new\" l(t),l._$tp[t]=\"i),i},l.prototype._$3s=function(){return\" new l},u.prototype=\"new\" et,u._$tp=\"new\" object,u._$27=\"function(){u._$tP.clear()},u.getID=function(t){var\" u(t),u._$tp[t]=\"i),i},u.prototype._$3s=function(){return\" u},p._$42=\"0,p.prototype._$zP=function(){null==this._$vo&&(this._$vo=new\" ot),null=\"=this._$F2&&(this._$F2=new\" array)},p.prototype.getcanvaswidth=\"function(){return\" this._$ao},p.prototype.getcanvasheight=\"function(){return\" this._$1s},p.prototype._$f0=\"function(t){this._$vo=t._$nP(),this._$F2=t._$nP(),this._$ao=t._$6L(),this._$1S=t._$6L()},p.prototype._$6S=function(t){this._$F2.push(t)},p.prototype._$Xr=function(){return\" this._$f2},p.prototype._$e2=\"function(){return\" this._$vo},f.prototype.setup=\"function(t,i,e){this._$ks=this._$Yb(),this.p2._$xT(),3==arguments.length&&(this._$Fo=t,this._$L2=i,this.p1._$p=e,this.p2._$p=e,this.p2.y=t,this.setup())},f.prototype.getPhysicsPoint1=function(){return\" this.p1},f.prototype.getphysicspoint2=\"function(){return\" this.p2},f.prototype._$qr=\"function(){return\" this._$db},f.prototype._$pr=\"function(t){this._$Db=t},f.prototype._$5r=function(){return\" this._$m2},f.prototype._$cs=\"function(){return\" this._$9b},f.prototype._$yb=\"function(){return-180*Math.atan2(this.p1.x-this.p2.x,-(this.p1.y-this.p2.y))/Math.PI},f.prototype.addSrcParam=function(t,i,e,r){var\" o=\"new\" g(t,i,e,r);this._$ll.push(o)},f.prototype.addtargetparam=\"function(t,i,e,r){var\" t(t,i,e,r);this._$qp.push(o)},f.prototype.update=\"function(t,i){if(0==this._$iP)return\" this._$ip=\"this._$iT=i,void(this._$Fo=Math.sqrt((this.p1.x-this.p2.x)*(this.p1.x-this.p2.x)+(this.p1.y-this.p2.y)*(this.p1.y-this.p2.y)));var\" e=\"(i-this._$iT)/1e3;if(0!=e){for(var\" r=\"this._$lL.length-1;r\">=0;--r){this._$lL[r]._$oP(t,this)}this._$oo(t,e),this._$M2=this._$Yb(),this._$9b=(this._$M2-this._$ks)/e,this._$ks=this._$M2}for(var r=this._$qP.length-1;r>=0;--r){this._$qP[r]._$YS(t,this)}this._$iT=i},f.prototype._$oo=function(t,i){i<.033&&(i=.033);var e=\"1/i;this.p1.vx=(this.p1.x-this.p1._$s0)*e,this.p1.vy=(this.p1.y-this.p1._$70)*e,this.p1.ax=(this.p1.vx-this.p1._$7L)*e,this.p1.ay=(this.p1.vy-this.p1._$HL)*e,this.p1.fx=this.p1.ax*this.p1._$p,this.p1.fy=this.p1.ay*this.p1._$p,this.p1._$xT();var\" r,o,n=\"-Math.atan2(this.p1.y-this.p2.y,this.p1.x-this.p2.x),s=Math.cos(n),_=Math.sin(n),a=9.8*this.p2._$p,h=this._$Db*Lt._$bS,l=a*Math.cos(n-h);r=l*_,o=l*s;var\" $=\"-this.p1.fx*_*_,u=-this.p1.fy*_*s,p=-this.p2.vx*this._$L2,f=-this.p2.vy*this._$L2;this.p2.fx=r+$+p,this.p2.fy=o+u+f,this.p2.ax=this.p2.fx/this.p2._$p,this.p2.ay=this.p2.fy/this.p2._$p,this.p2.vx+=this.p2.ax*i,this.p2.vy+=this.p2.ay*i,this.p2.x+=this.p2.vx*i,this.p2.y+=this.p2.vy*i;var\" c=\"Math.sqrt((this.p1.x-this.p2.x)*(this.p1.x-this.p2.x)+(this.p1.y-this.p2.y)*(this.p1.y-this.p2.y));this.p2.x=this.p1.x+this._$Fo*(this.p2.x-this.p1.x)/c,this.p2.y=this.p1.y+this._$Fo*(this.p2.y-this.p1.y)/c,this.p2.vx=(this.p2.x-this.p2._$s0)*e,this.p2.vy=(this.p2.y-this.p2._$70)*e,this.p2._$xT()},c.prototype._$xT=function(){this._$s0=this.x,this._$70=this.y,this._$7L=this.vx,this._$HL=this.vy},d.prototype._$oP=function(t,i){},g.prototype=new\" d,g.prototype._$op=\"function(t,i){var\" f.src.src_to_x:r.x=\"r.x+(e-r.x)*this._$V0;break;case\" f.src.src_to_y:r.y=\"r.y+(e-r.y)*this._$V0;break;case\" f.src.src_to_g_angle:var o=\"i._$qr();o+=(e-o)*this._$V0,i._$pr(o)}},y.prototype._$YS=function(t,i){},T.prototype=new\" y,t.prototype._$ys=\"function(t,i){switch(this._$YP){default:case\" f.target.target_from_angle:t.setparamfloat(this._$wl,this.scale*i._$5r(),this._$v0);break;case f.target.target_from_angle_v:t.setparamfloat(this._$wl,this.scale*i._$cs(),this._$v0)}},f.src=\"function(){},f.Src.SRC_TO_X=\"SRC_TO_X\",f.Src.SRC_TO_Y=\"SRC_TO_Y\",f.Src.SRC_TO_G_ANGLE=\"SRC_TO_G_ANGLE\",f.Target=function(){},f.Target.TARGET_FROM_ANGLE=\"TARGET_FROM_ANGLE\",f.Target.TARGET_FROM_ANGLE_V=\"TARGET_FROM_ANGLE_V\",P.prototype.init=function(t){this._$fL=t._$fL,this._$gL=t._$gL,this._$B0=t._$B0,this._$z0=t._$z0,this._$qT=t._$qT,this.reflectX=t.reflectX,this.reflectY=t.reflectY},P.prototype._$F0=function(t){this._$fL=t._$_T(),this._$gL=t._$_T(),this._$B0=t._$_T(),this._$z0=t._$_T(),this._$qT=t._$_T(),t.getFormatVersion()\">=G.LIVE2D_FORMAT_VERSION_V2_10_SDK2&&(this.reflectX=t._$po(),this.reflectY=t._$po())},P.prototype._$e=function(){};var It=function(){};It._$ni=function(t,i,e,r,o,n,s,_,a){var h=s*n-_*o;if(0==h)return null;var l,$=((t-e)*n-(i-r)*o)/h;return l=0!=o?(t-e-$*s)/o:(i-r-$*_)/n,isNaN(l)&&(l=(t-e-$*s)/o,isNaN(l)&&(l=(i-r-$*_)/n),isNaN(l)&&(console.log(\"a is NaN @UtVector#_$ni() \"),console.log(\"v1x : \"+o),console.log(\"v1x != 0 ? \"+(0!=o)))),null==a?new Array(l,$):(a[0]=l,a[1]=$,a)},S.prototype._$8P=function(){return this.x+.5*this.width},S.prototype._$6P=function(){return this.y+.5*this.height},S.prototype._$EL=function(){return this.x+this.width},S.prototype._$5T=function(){return this.y+this.height},S.prototype._$jL=function(t,i,e,r){this.x=t,this.y=i,this.width=e,this.height=r},S.prototype._$jL=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},S.prototype.contains=function(t,i){return this.x<=this.x&&this.y<=this.y&&this.x<=this.x+this.width&&this.y<=this.y+this.height},s.prototype.expand=function(t,i){this.x-=t,this.y-=i,this.width+=2*t,this.height+=2*i},v._$z2=function(t,i,e,r){var o=\"i._$Q2(t,e),n=t._$vs(),s=t._$Tr();if(i._$zr(n,s,o),o<=0)return\" r[n[0]];if(1=\"=o){var\" _=\"r[n[0]],a=r[n[1]],h=s[0];return\" _+(a-_)*h|0}if(2=\"=o){var\" p+(f-p)*u|0}if(3=\"=o){var\" c=\"r[n[0]],d=r[n[1]],g=r[n[2]],y=r[n[3]],m=r[n[4]],T=r[n[5]],P=r[n[6]],S=r[n[7]],h=s[0],u=s[1],v=s[2],_=c+(d-c)*h|0,a=g+(y-g)*h|0,l=m+(T-m)*h|0,$=P+(S-P)*h|0,p=_+(a-_)*u|0,f=l+($-l)*u|0;return\" p+(f-p)*v|0}if(4=\"=o){var\" l=\"r[n[0]],M=r[n[1]],E=r[n[2]],A=r[n[3]],I=r[n[4]],w=r[n[5]],x=r[n[6]],O=r[n[7]],D=r[n[8]],R=r[n[9]],b=r[n[10]],F=r[n[11]],C=r[n[12]],N=r[n[13]],B=r[n[14]],U=r[n[15]],h=s[0],u=s[1],v=s[2],G=s[3],c=L+(M-L)*h|0,d=E+(A-E)*h|0,g=I+(w-I)*h|0,y=x+(O-x)*h|0,m=D+(R-D)*h|0,T=b+(F-b)*h|0,P=C+(N-C)*h|0,S=B+(U-B)*h|0,_=c+(d-c)*u|0,a=g+(y-g)*u|0,l=m+(T-m)*u|0,$=P+(S-P)*u|0,p=_+(a-_)*v|0,f=l+($-l)*v|0;return\" p+(f-p)*g|0}for(var y=\"1<<o,k=new\" float32array(y),v=\"0;V<Y;V++){for(var\" x=\"V,z=1,H=0;H<o;H++)z*=X%2==0?1-s[H]:s[H],X/=2;k[V]=z}for(var\" w=\"new\" float32array(y),j=\"0;j<Y;j++)W[j]=r[n[j]];for(var\" q=\"0,j=0;j<Y;j++)q+=k[j]*W[j];return\" q+.5|0},v._$br=\"function(t,i,e,r){var\" _+(a-_)*h}if(2=\"=o){var\" p=\"r[n[0]],f=r[n[1]],c=r[n[2]],d=r[n[3]],g=r[n[4]],y=r[n[5]],m=r[n[6]],T=r[n[7]],h=s[0],u=s[1],P=s[2];return(1-P)*((1-u)*(p+(f-p)*h)+u*(c+(d-c)*h))+P*((1-u)*(g+(y-g)*h)+u*(m+(T-m)*h))}if(4==o){var\" s=\"r[n[0]],v=r[n[1]],L=r[n[2]],M=r[n[3]],E=r[n[4]],A=r[n[5]],I=r[n[6]],w=r[n[7]],x=r[n[8]],O=r[n[9]],D=r[n[10]],R=r[n[11]],b=r[n[12]],F=r[n[13]],C=r[n[14]],N=r[n[15]],h=s[0],u=s[1],P=s[2],B=s[3];return(1-B)*((1-P)*((1-u)*(S+(v-S)*h)+u*(L+(M-L)*h))+P*((1-u)*(E+(A-E)*h)+u*(I+(w-I)*h)))+B*((1-P)*((1-u)*(x+(O-x)*h)+u*(D+(R-D)*h))+P*((1-u)*(b+(F-b)*h)+u*(C+(N-C)*h)))}for(var\" u=\"1<<o,G=new\" float32array(u),y=\"0;Y<U;Y++){for(var\" k=\"Y,V=1,X=0;X<o;X++)V*=k%2==0?1-s[X]:s[X],k/=2;G[Y]=V}for(var\" z=\"new\" float32array(u),h=\"0;H<U;H++)z[H]=r[n[H]];for(var\" w},v._$vr=\"function(t,i,e,r,o,n,s,_){var\" a=\"i._$Q2(t,e),h=t._$vs(),l=t._$Tr();i._$zr(h,l,a);var\" $=\"2*r,u=s;if(a<=0){var\" for(var if(1=\"=a)for(var\" f=\"o[h[0]],d=o[h[1]],g=l[0],y=1-g,c=0;c<$;)n[u]=f[c]*y+d[c]*g,++c,n[u+1]=f[c]*y+d[c]*g,++c,u+=_;else\" if(2=\"=a)for(var\" if(3=\"=a)for(var\" if(4=\"=a)for(var\" h=\"o[h[0]],W=o[h[1]],j=o[h[2]],q=o[h[3]],J=o[h[4]],Q=o[h[5]],Z=o[h[6]],K=o[h[7]],tt=o[h[8]],it=o[h[9]],et=o[h[10]],rt=o[h[11]],ot=o[h[12]],nt=o[h[13]],st=o[h[14]],_t=o[h[15]],g=l[0],P=l[1],C=l[2],at=l[3],y=1-g,S=1-P,N=1-C,ht=1-at,lt=ht*N*S*y,$t=ht*N*S*g,ut=ht*N*P*y,pt=ht*N*P*g,ft=ht*C*S*y,ct=ht*C*S*g,dt=ht*C*P*y,gt=ht*C*P*g,yt=at*N*S*y,mt=at*N*S*g,Tt=at*N*P*y,Pt=at*N*P*g,St=at*C*S*y,vt=at*C*S*g,Lt=at*C*P*y,Mt=at*C*P*g,c=0;c<$;)n[u]=lt*H[c]+$t*W[c]+ut*j[c]+pt*q[c]+ft*J[c]+ct*Q[c]+dt*Z[c]+gt*K[c]+yt*tt[c]+mt*it[c]+Tt*et[c]+Pt*rt[c]+St*ot[c]+vt*nt[c]+Lt*st[c]+Mt*_t[c],++c,n[u+1]=lt*H[c]+$t*W[c]+ut*j[c]+pt*q[c]+ft*J[c]+ct*Q[c]+dt*Z[c]+gt*K[c]+yt*tt[c]+mt*it[c]+Tt*et[c]+Pt*rt[c]+St*ot[c]+vt*nt[c]+Lt*st[c]+Mt*_t[c],++c,u+=_;else{for(var\" et=\"1<<a,At=new\" float32array(et),it=\"0;It<Et;It++){for(var\" wt=\"It,xt=1,Ot=0;Ot<a;Ot++)xt*=wt%2==0?1-l[Ot]:l[Ot],wt/=2;At[It]=xt}for(var\" dt=\"new\" float32array(et),rt=\"0;Rt<Et;Rt++)Dt[Rt]=o[h[Rt]];for(var\" bt=\"0,Ft=0,Ct=c+1,Rt=0;Rt<Et;Rt++)bt+=At[Rt]*Dt[Rt][c],Ft+=At[Rt]*Dt[Rt][Ct];c+=2,n[u]=bt,n[u+1]=Ft,u+=_}}},L.prototype._$HT=function(t,i){this.x=t,this.y=i},L.prototype._$HT=function(t){this.x=t.x,this.y=t.y},M._$ur=-2,M._$ES=500,M._$wb=2,M._$8S=3,M._$52=M._$ES,M._$R2=M._$ES,M._$or=function(){return\" m._$52},m._$pr=\"function(){return\" m._$r2},m.prototype.convertclipidforv2_11=\"function(t){var\" i=\"[];return\" null=\"=t?null:0==t.length?null:/,/.test(t)?i=t.id.split(\",\"):(i.push(t.id),i)},M.prototype._$F0=function(t){this._$gP=t._$nP(),this._$dr=t._$nP(),this._$GS=t._$nP(),this._$qb=t._$6L(),this._$Lb=t._$cS(),this._$mS=t._$Tb(),t.getFormatVersion()\">=G._$T7?(this.clipID=t._$nP(),this.clipIDList=this.convertClipIDForV2_11(this.clipID)):this.clipIDList=[],this._$MS(this._$Lb)},M.prototype.getClipIDList=function(){return this.clipIDList},M.prototype.init=function(t){},M.prototype._$Nr=function(t,i){if(i._$IS[0]=!1,i._$Us=v._$Z2(t,this._$GS,i._$IS,this._$Lb),at._$Zs);else if(i._$IS[0])return;i._$7s=v._$br(t,this._$GS,i._$IS,this._$mS)},M.prototype._$2b=function(t,i){},M.prototype.getDrawDataID=function(){return this._$gP},M.prototype._$j2=function(t){this._$gP=t},M.prototype.getOpacity=function(t,i){return i._$7s},M.prototype._$zS=function(t,i){return i._$Us},M.prototype._$MS=function(t){for(var i=t.length-1;i>=0;--i){var e=t[i];e<m._$52?m._$52=e:e>M._$R2&&(M._$R2=e)}},M.prototype.getTargetBaseDataID=function(){return this._$dr},M.prototype._$gs=function(t){this._$dr=t},M.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},M.prototype.preDraw=function(t,i,e){},M.prototype.draw=function(t,i,e){},M.prototype.getType=function(){},M.prototype._$B2=function(t,i,e){},E._$ps=32,E.CLIPPING_PROCESS_NONE=0,E.CLIPPING_PROCESS_OVERWRITE_ALPHA=1,E.CLIPPING_PROCESS_MULTIPLY_ALPHA=2,E.CLIPPING_PROCESS_DRAW=3,E.CLIPPING_PROCESS_CLEAR_ALPHA=4,E.prototype.setChannelFlagAsColor=function(t,i){this.CHANNEL_COLORS[t]=i},E.prototype.getChannelFlagAsColor=function(t){return this.CHANNEL_COLORS[t]},E.prototype._$ZT=function(){},E.prototype._$Uo=function(t,i,e,r,o,n,s){},E.prototype._$Rs=function(){return-1},E.prototype._$Ds=function(t){},E.prototype.setBaseColor=function(t,i,e,r){t<0?t=0:t>1&&(t=1),i<0?i=0:i>1&&(i=1),e<0?e=0:e>1&&(e=1),r<0?r=0:r>1&&(r=1),this._$lT=t,this._$C0=i,this._$tT=e,this._$WL=r},E.prototype._$WP=function(t){this.culling=t},E.prototype.setMatrix=function(t){for(var i=0;i<16;i++)this.matrix4x4[i]=t[i]},e.prototype._$it=function(){return this.matrix4x4},e.prototype.setpremultipliedalpha=\"function(t){this.premultipliedAlpha=t},E.prototype.isPremultipliedAlpha=function(){return\" this.premultipliedalpha},e.prototype.setanisotropy=\"function(t){this.anisotropy=t},E.prototype.getAnisotropy=function(){return\" this.anisotropy},e.prototype.getclippingprocess=\"function(){return\" this.clippingprocess},e.prototype.setclippingprocess=\"function(t){this.clippingProcess=t},E.prototype.setClipBufPre_clipContextForMask=function(t){this.clipBufPre_clipContextMask=t},E.prototype.getClipBufPre_clipContextMask=function(){return\" this.clipbufpre_clipcontextmask},e.prototype.setclipbufpre_clipcontextfordraw=\"function(t){this.clipBufPre_clipContextDraw=t},E.prototype.getClipBufPre_clipContextDraw=function(){return\" this.clipbufpre_clipcontextdraw},i._$ur=\"-2,I._$c2=1,I._$_b=2,I.prototype._$F0=function(t){this._$kP=t._$nP(),this._$dr=t._$nP()},I.prototype.readV2_opacity=function(t){t.getFormatVersion()\">=G.LIVE2D_FORMAT_VERSION_V2_10_SDK2&&(this._$mS=t._$Tb())},I.prototype.init=function(t){},I.prototype._$Nr=function(t,i){},I.prototype.interpolateOpacity=function(t,i,e,r){null==this._$mS?e.setInterpolatedOpacity(1):e.setInterpolatedOpacity(v._$br(t,i,r,this._$mS))},I.prototype._$2b=function(t,i){},I.prototype._$nb=function(t,i,e,r,o,n,s){},I.prototype.getType=function(){},I.prototype._$gs=function(t){this._$dr=t},I.prototype._$a2=function(t){this._$kP=t},I.prototype.getTargetBaseDataID=function(){return this._$dr},I.prototype.getBaseDataID=function(){return this._$kP},I.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},w._$W2=0,w._$CS=w._$W2,w._$Mo=function(){return!0},w._$XP=function(t){try{for(var i=getTimeMSec();getTimeMSec()-i<t;);}catch(t){t._$rb()}},w.getusertimemsec=function(){return w._$cs=\"=w._$W2?w.getSystemTimeMSec():w._$CS},w.setUserTimeMSec=function(t){w._$CS=t},w.updateUserTimeMSec=function(){return\" date).gettime()},w.getsystemtimemsec=\"function(){return(new\" date).gettime()},w._$q=\"function(t){},w._$jT=function(t,i,e,r,o){for(var\" n=\"0;n<o;n++)e[r+n]=t[i+n]},x._$ds=-2,x.prototype._$F0=function(t){this._$wL=t._$nP(),this._$VP=t._$6L(),this._$GP=t._$nP()},x.prototype.getParamIndex=function(t){return\" this._$2r!=\"t&&(this._$8o=x._$ds),this._$8o},x.prototype._$Pb=function(t,i){this._$8o=t,this._$2r=i},x.prototype.getParamID=function(){return\" this._$wl},x.prototype._$yp=\"function(t){this._$wL=t},x.prototype._$N2=function(){return\" this._$vp},x.prototype._$d2=\"function(){return\" this._$gp},x.prototype._$t2=\"function(t,i){this._$VP=t,this._$GP=i},x.prototype._$Lr=function(){return\" this._$o2},x.prototype._$wr=\"function(t){this._$O2=t},x.prototype._$SL=function(){return\" this._$ri},x.prototype._$al=\"function(t){this._$ri=t},O.startsWith=function(t,i,e){var\" r=\"i+e.length;if(r\">=t.length)return!1;for(var o=i;o<r;o++)if(o.getchar(t,o)!=e.charat(o-i))return!1;return!0},o.getchar=function(t,i){return string.fromcharcode(t.getuint8(i))},o.createstring=\"function(t,i,e){for(var\" r=\"new\" arraybuffer(2*e),o=\"new\" uint16array(r),n=\"0;n<e;n++)o[n]=t.getUint8(i+n);return\" string.fromcharcode.apply(null,o)},o._$ls=\"function(t,i,e,r){t\" instanceof arraybuffer&&(t=\"new\" dataview(t));var o=\"e,n=!1,s=!1,_=0,a=O.getChar(t,o);\"-\"==a&&(n=!0,o++);for(var\" h=\"!1;o<i;o++){switch(a=O.getChar(t,o)){case\"0\":_*=10;break;case\"1\":_=10*_+1;break;case\"2\":_=10*_+2;break;case\"3\":_=10*_+3;break;case\"4\":_=10*_+4;break;case\"5\":_=10*_+5;break;case\"6\":_=10*_+6;break;case\"7\":_=10*_+7;break;case\"8\":_=10*_+8;break;case\"9\":_=10*_+9;break;case\".\":s=!0,o++,h=!0;break;default:h=!0}if(h)break}if(s)for(var\" l=\".1,$=!1;o<i;o++){switch(a=O.getChar(t,o)){case\"0\":break;case\"1\":_+=1*l;break;case\"2\":_+=2*l;break;case\"3\":_+=3*l;break;case\"4\":_+=4*l;break;case\"5\":_+=5*l;break;case\"6\":_+=6*l;break;case\"7\":_+=7*l;break;case\"8\":_+=8*l;break;case\"9\":_+=9*l;break;default:$=!0}if(l*=.1,$)break}return\" n&&(_=\"-_),r[0]=o,_},D.prototype._$zP=function(){this._$Ob=new\" array},d.prototype._$f0=\"function(t){this._$Ob=t._$nP()},D.prototype._$Ur=function(t){if(t._$WS())return!0;for(var\" i=\"t._$v2(),e=this._$Ob.length-1;e\">=0;--e){var r=this._$Ob[e].getParamIndex(i);if(r==x._$ds&&(r=t.getParamIndex(this._$Ob[e].getParamID())),t._$Xb(r))return!0}return!1},D.prototype._$Q2=function(t,i){for(var e,r,o=this._$Ob.length,n=t._$v2(),s=0,_=0;_<o;_++){var 23242 a=\"this._$Ob[_];if(e=a.getParamIndex(n),e==x._$ds&&(e=t.getParamIndex(a.getParamID()),a._$Pb(e,n)),e<0)throw\" new exception(\"err : \"+a.getparamid());var h=\"e<0?0:t.getParamFloat(e);r=a._$N2();var\" l,$,u=\"a._$d2(),p=-1,f=0;if(r<1);else\" if(1=\"=r)l=u[0],l-U._$J<h&&h<l+U._$J?(p=0,f=0):(p=0,i[0]=!0);else\" if(l=\"u[0],h<l-U._$J)p=0,i[0]=!0;else\" if(h<l+u._$j)p=\"0;else{for(var\" c=\"!1,d=1;d<r;++d){if($=u[d],h<$+U._$J){$-U._$J<h?p=d:(p=d-1,f=(h-l)/($-l),s++),c=!0;break}l=$}c||(p=r-1,f=0,i[0]=!0)}a._$wr(p),a._$AL(f)}return\" s},d.prototype._$zr=\"function(t,i,e){var\" r=\"1<<e;r+1\">U._$Qb&&console.log(\"err 23245\\n\");for(var o=this._$Ob.length,n=1,s=1,_=0,a=0;a<r;++a)t[a]=0;for(var h=\"0;h<o;++h){var\" l=\"this._$Ob[h];if(0==l._$SL()){var\" $=\"l._$Lr()*n;if($<0&&at._$3T)throw\" new exception(\"err 23246\");for(var a=\"0;a<r;++a)t[a]+=$}else{for(var\" r=\"new\" float32array(i),o=\"0;o<i;++o)r[o]=e[o];var\" n=\"new\" x;n._$yp(t),n._$t2(i,r),this._$ob.push(n)},d.prototype._$j2=\"function(t){for(var\" i=\"t,e=this._$Ob.length,r=0;r<e;++r){var\" o=\"this._$Ob[r],n=o._$N2(),s=i%o._$N2(),_=o._$d2()[s];console.log(\"%s[%d]=%7.2f\" \",o.getparamid(),s,_),i =n}console.log(\"\\n\")},d.prototype.getparamcount=\"function(){return\" this._$ob.length},d.prototype._$zs=\"function(){return\" this._$ob},r.prototype.identity=\"function(){for(var\" t=\"0;t<16;t++)this.m[t]=t%5==0?1:0},R.prototype.getArray=function(){return\" this.m},r.prototype.getcopymatrix=\"function(){return\" float32array(this.m)},r.prototype.setmatrix=\"function(t){if(null!=t&&16==t.length)for(var\" null=\"=i?null:(this==i?this.mult_safe(this.m,t.m,i.m,e):this.mult_fast(this.m,t.m,i.m,e),i)},R.prototype.mult_safe=function(t,i,e,r){if(t==e){var\" array(16);this.mult_fast(t,i,o,r);for(var>=0;--n)e[n]=o[n]}else this.mult_fast(t,i,e,r)},R.prototype.mult_fast=function(t,i,e,r){r?(e[0]=t[0]*i[0]+t[4]*i[1]+t[8]*i[2],e[4]=t[0]*i[4]+t[4]*i[5]+t[8]*i[6],e[8]=t[0]*i[8]+t[4]*i[9]+t[8]*i[10],e[12]=t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12],e[1]=t[1]*i[0]+t[5]*i[1]+t[9]*i[2],e[5]=t[1]*i[4]+t[5]*i[5]+t[9]*i[6],e[9]=t[1]*i[8]+t[5]*i[9]+t[9]*i[10],e[13]=t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13],e[2]=t[2]*i[0]+t[6]*i[1]+t[10]*i[2],e[6]=t[2]*i[4]+t[6]*i[5]+t[10]*i[6],e[10]=t[2]*i[8]+t[6]*i[9]+t[10]*i[10],e[14]=t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14],e[3]=e[7]=e[11]=0,e[15]=1):(e[0]=t[0]*i[0]+t[4]*i[1]+t[8]*i[2]+t[12]*i[3],e[4]=t[0]*i[4]+t[4]*i[5]+t[8]*i[6]+t[12]*i[7],e[8]=t[0]*i[8]+t[4]*i[9]+t[8]*i[10]+t[12]*i[11],e[12]=t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12]*i[15],e[1]=t[1]*i[0]+t[5]*i[1]+t[9]*i[2]+t[13]*i[3],e[5]=t[1]*i[4]+t[5]*i[5]+t[9]*i[6]+t[13]*i[7],e[9]=t[1]*i[8]+t[5]*i[9]+t[9]*i[10]+t[13]*i[11],e[13]=t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13]*i[15],e[2]=t[2]*i[0]+t[6]*i[1]+t[10]*i[2]+t[14]*i[3],e[6]=t[2]*i[4]+t[6]*i[5]+t[10]*i[6]+t[14]*i[7],e[10]=t[2]*i[8]+t[6]*i[9]+t[10]*i[10]+t[14]*i[11],e[14]=t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14]*i[15],e[3]=t[3]*i[0]+t[7]*i[1]+t[11]*i[2]+t[15]*i[3],e[7]=t[3]*i[4]+t[7]*i[5]+t[11]*i[6]+t[15]*i[7],e[11]=t[3]*i[8]+t[7]*i[9]+t[11]*i[10]+t[15]*i[11],e[15]=t[3]*i[12]+t[7]*i[13]+t[11]*i[14]+t[15]*i[15])},R.prototype.translate=function(t,i,e){this.m[12]=this.m[0]*t+this.m[4]*i+this.m[8]*e+this.m[12],this.m[13]=this.m[1]*t+this.m[5]*i+this.m[9]*e+this.m[13],this.m[14]=this.m[2]*t+this.m[6]*i+this.m[10]*e+this.m[14],this.m[15]=this.m[3]*t+this.m[7]*i+this.m[11]*e+this.m[15]},R.prototype.scale=function(t,i,e){this.m[0]*=t,this.m[4]*=i,this.m[8]*=e,this.m[1]*=t,this.m[5]*=i,this.m[9]*=e,this.m[2]*=t,this.m[6]*=i,this.m[10]*=e,this.m[3]*=t,this.m[7]*=i,this.m[11]*=e},R.prototype.rotateX=function(t){var i=Lt.fcos(t),e=Lt._$9(t),r=this.m[4];this.m[4]=r*i+this.m[8]*e,this.m[8]=r*-e+this.m[8]*i,r=this.m[5],this.m[5]=r*i+this.m[9]*e,this.m[9]=r*-e+this.m[9]*i,r=this.m[6],this.m[6]=r*i+this.m[10]*e,this.m[10]=r*-e+this.m[10]*i,r=this.m[7],this.m[7]=r*i+this.m[11]*e,this.m[11]=r*-e+this.m[11]*i},R.prototype.rotateY=function(t){var i=Lt.fcos(t),e=Lt._$9(t),r=this.m[0];this.m[0]=r*i+this.m[8]*-e,this.m[8]=r*e+this.m[8]*i,r=this.m[1],this.m[1]=r*i+this.m[9]*-e,this.m[9]=r*e+this.m[9]*i,r=m[2],this.m[2]=r*i+this.m[10]*-e,this.m[10]=r*e+this.m[10]*i,r=m[3],this.m[3]=r*i+this.m[11]*-e,this.m[11]=r*e+this.m[11]*i},R.prototype.rotateZ=function(t){var i=Lt.fcos(t),e=Lt._$9(t),r=this.m[0];this.m[0]=r*i+this.m[4]*e,this.m[4]=r*-e+this.m[4]*i,r=this.m[1],this.m[1]=r*i+this.m[5]*e,this.m[5]=r*-e+this.m[5]*i,r=this.m[2],this.m[2]=r*i+this.m[6]*e,this.m[6]=r*-e+this.m[6]*i,r=this.m[3],this.m[3]=r*i+this.m[7]*e,this.m[7]=r*-e+this.m[7]*i},b.prototype=new et,b._$tP=new Object,b._$27=function(){b._$tP.clear()},b.getID=function(t){var i=b._$tP[t];return null==i&&(i=new b(t),b._$tP[t]=i),i},b.prototype._$3s=function(){return new b},F._$kS=-1,F._$pS=0,F._$hb=1,F.STATE_IDENTITY=0,F._$gb=1,F._$fo=2,F._$go=4,F.prototype.transform=function(t,i,e){var r,o,n,s,_,a,h=0,l=0;switch(this._$hi){default:return;case F._$go|F._$fo|F._$gb:for(r=this._$7,o=this._$H,n=this._$k,s=this._$f,_=this._$g,a=this._$w;--e>=0;){var $=t[h++],u=t[h++];i[l++]=r*$+o*u+n,i[l++]=s*$+_*u+a}return;case F._$go|F._$fo:for(r=this._$7,o=this._$H,s=this._$f,_=this._$g;--e>=0;){var $=t[h++],u=t[h++];i[l++]=r*$+o*u,i[l++]=s*$+_*u}return;case F._$go|F._$gb:for(o=this._$H,n=this._$k,s=this._$f,a=this._$w;--e>=0;){var $=t[h++];i[l++]=o*t[h++]+n,i[l++]=s*$+a}return;case F._$go:for(o=this._$H,s=this._$f;--e>=0;){var $=t[h++];i[l++]=o*t[h++],i[l++]=s*$}return;case F._$fo|F._$gb:for(r=this._$7,n=this._$k,_=this._$g,a=this._$w;--e>=0;)i[l++]=r*t[h++]+n,i[l++]=_*t[h++]+a;return;case F._$fo:for(r=this._$7,_=this._$g;--e>=0;)i[l++]=r*t[h++],i[l++]=_*t[h++];return;case F._$gb:for(n=this._$k,a=this._$w;--e>=0;)i[l++]=t[h++]+n,i[l++]=t[h++]+a;return;case F.STATE_IDENTITY:return void(t==i&&h==l||w._$jT(t,h,i,l,2*e))}},F.prototype.update=function(){0==this._$H&&0==this._$f?1==this._$7&&1==this._$g?0==this._$k&&0==this._$w?(this._$hi=F.STATE_IDENTITY,this._$Z=F._$pS):(this._$hi=F._$gb,this._$Z=F._$hb):0==this._$k&&0==this._$w?(this._$hi=F._$fo,this._$Z=F._$kS):(this._$hi=F._$fo|F._$gb,this._$Z=F._$kS):0==this._$7&&0==this._$g?0==this._$k&&0==this._$w?(this._$hi=F._$go,this._$Z=F._$kS):(this._$hi=F._$go|F._$gb,this._$Z=F._$kS):0==this._$k&&0==this._$w?(this._$hi=F._$go|F._$fo,this._$Z=F._$kS):(this._$hi=F._$go|F._$fo|F._$gb,this._$Z=F._$kS)},F.prototype._$RT=function(t){this._$IT(t);var i=t[0],e=t[2],r=t[1],o=t[3],n=Math.sqrt(i*i+r*r),s=i*o-e*r;0==n?at._$so&&console.log(\"affine._$RT() / rt==0\"):(t[0]=n,t[1]=s/n,t[2]=(r*o+i*e)/s,t[3]=Math.atan2(r,i))},F.prototype._$ho=function(t,i,e,r){var o=new Float32Array(6),n=new Float32Array(6);t._$RT(o),i._$RT(n);var s=new Float32Array(6);s[0]=o[0]+(n[0]-o[0])*e,s[1]=o[1]+(n[1]-o[1])*e,s[2]=o[2]+(n[2]-o[2])*e,s[3]=o[3]+(n[3]-o[3])*e,s[4]=o[4]+(n[4]-o[4])*e,s[5]=o[5]+(n[5]-o[5])*e,r._$CT(s)},F.prototype._$CT=function(t){var i=Math.cos(t[3]),e=Math.sin(t[3]);this._$7=t[0]*i,this._$f=t[0]*e,this._$H=t[1]*(t[2]*i-e),this._$g=t[1]*(t[2]*e+i),this._$k=t[4],this._$w=t[5],this.update()},F.prototype._$IT=function(t){t[0]=this._$7,t[1]=this._$f,t[2]=this._$H,t[3]=this._$g,t[4]=this._$k,t[5]=this._$w},C.prototype=new s,C._$cs=\"VISIBLE:\",C._$ar=\"LAYOUT:\",C._$Co=0,C._$D2=[],C._$1T=1,C.loadMotion=function(t){var i=new C,e=[0],r=t.length;i._$yT=0;for(var o=0;o<r;++o){var n=\"255&t[o];if(\"\\n\"!=n&&\"\\r\"!=n)if(\"#\"!=n)if(\"$\"!=n){if(\"a\"<=n&&n<=\"z\"||\"A\"<=n&&n<=\"Z\"||\"_\"==n){for(var\" s=\"o,_=-1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\"=\"==n){_=o;break}if(_\">=0){var a=new B;O.startsWith(t,s,C._$cs)?(a._$RP=B._$hs,a._$4P=new String(t,s,_-s)):O.startsWith(t,s,C._$ar)?(a._$4P=new String(t,s+7,_-s-7),O.startsWith(t,s+7,\"ANCHOR_X\")?a._$RP=B._$xs:O.startsWith(t,s+7,\"ANCHOR_Y\")?a._$RP=B._$us:O.startsWith(t,s+7,\"SCALE_X\")?a._$RP=B._$qs:O.startsWith(t,s+7,\"SCALE_Y\")?a._$RP=B._$Ys:O.startsWith(t,s+7,\"X\")?a._$RP=B._$ws:O.startsWith(t,s+7,\"Y\")&&(a._$RP=B._$Ns)):(a._$RP=B._$Fr,a._$4P=new String(t,s,_-s)),i.motions.push(a);var h=0;for(C._$D2.clear(),o=_+1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\"\\t\"!=n){var\" l=\"O._$LS(t,r,o,e);if(e[0]\">0){C._$D2.push(l),h++;var $=e[0];if($<o){console.log(\"_$n0 _$hi . @live2dmotion loadmotion()\\n\");break}o=\"$}}a._$I0=C._$D2._$BL(),h\">i._$yT&&(i._$yT=h)}}}else{for(var s=o,_=-1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\"=\"==n){_=o;break}var u=\"!1;if(_\">=0)for(_==s+4&&\"f\"==t[s+1]&&\"p\"==t[s+2]&&\"s\"==t[s+3]&&(u=!0),o=_+1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\"\\t\"!=n){var\" l=\"O._$LS(t,r,o,e);e[0]\">0&&u&&5<l&&l<121&&(i._$d0=l),o=e[0]}for(;o<r&&(\"\\n\"!=t[o]&&\"\\r\"!=t[o]);++o);}else for(;o<r&&(\"\\n\"!=\"t[o]&&\"\\r\"!=t[o]);++o);}return\" i._$as=\"1e3*i._$yT/i._$D0|0,i},C.prototype.getDurationMSec=function(){return\" this._$as},c.prototype.dump=\"function(){for(var\" t=\"0;t<this.motions.length;t++){var\" i=\"this.motions[t];console.log(\"_$wL[%s]\" [%d]. \",i._$4p,i._$i0.length);for(var e=\"0;e<i._$I0.length&&e<10;e++)console.log(\"%5.2f\" ,\",i._$i0[e]);console.log(\"\\n\")}},c.prototype.updateparamexe=\"function(t,i,e,r){for(var\" o=\"i-r._$z2,n=o*this._$D0/1e3,s=0|n,_=n-s,a=0;a<this.motions.length;a++){var\" h=\"this.motions[a],l=h._$I0.length,$=h._$4P;if(h._$RP==B._$hs){var\" u=\"h._$I0[s\">=l?l-1:s];t.setParamFloat($,u)}else if(B._$ws<=h._$rp&&h._$rp<=b._$ys);else{var p=\"t.getParamFloat($),f=h._$I0[s\">=l?l-1:s],c=h._$I0[s+1>=l?l-1:s+1],d=f+(c-f)*_,g=p+(d-p)*e;t.setParamFloat($,g)}}s>=this._$yT&&(this._$E?(r._$z2=i,this.loopFadeIn&&(r._$bs=i)):r._$9L=!0)},C.prototype._$r0=function(){return this._$E},C.prototype._$aL=function(t){this._$E=t},C.prototype.isLoopFadeIn=function(){return this.loopFadeIn},C.prototype.setLoopFadeIn=function(t){this.loopFadeIn=t},N.prototype.clear=function(){this.size=0},N.prototype.add=function(t){if(this._$P.length<=this.size){var i=\"new\" float32array(2*this.size);w._$jt(this._$p,0,i,0,this.size),this._$p=\"i}this._$P[this.size++]=t},N.prototype._$BL=function(){var\" t=\"new\" float32array(this.size);return w._$jt(this._$p,0,t,0,this.size),t},b._$fr=\"0,B._$hs=1,B._$ws=100,B._$Ns=101,B._$xs=102,B._$us=103,B._$qs=104,B._$Ys=105,U._$Ms=1,U._$Qs=2,U._$i2=0,U._$No=2,U._$do=U._$Ms,U._$Ls=!0,U._$1r=5,U._$Qb=65,U._$J=1e-4,U._$FT=.001,U._$Ss=3,G._$o7=6,G._$S7=7,G._$s7=8,G._$77=9,G.LIVE2D_FORMAT_VERSION_V2_10_SDK2=10,G.LIVE2D_FORMAT_VERSION_V2_11_SDK2_1=11,G._$T7=G.LIVE2D_FORMAT_VERSION_V2_11_SDK2_1,G._$Is=-2004318072,G._$h0=0,G._$4L=23,G._$7P=33,G._$uT=function(t){console.log(\"_$bo\" :: _$6 _$mo _$e0 : %d\\n\",t)},g._$9o=\"function(t){if(t<40)return\" g._$ut(t),null;if(t<50)return g._$ut(t),null;if(t<60)return g._$ut(t),null;if(t<100)switch(t){case 65:return new z;case 66:return d;case 67:return x;case 68:return 69:return p;case 70:return $t;default:return g._$ut(t),null}else if(t<150)switch(t){case 131:return st;case 133:return tt;case 136:return 137:return ot;case 142:return j}return g._$ut(t),null},y._$hp=\"0,Y._$_0=!0;Y._$V2=-1,Y._$W0=-1,Y._$jr=!1,Y._$ZS=!0,Y._$tr=-1e6,Y._$lr=1e6,Y._$is=32,Y._$e=!1,Y.prototype.getDrawDataIndex=function(t){for(var\">=0;--i)if(null!=this._$aS[i]&&this._$aS[i].getDrawDataID()==t)return i;return-1},Y.prototype.getDrawData=function(t){if(t instanceof b){if(null==this._$Bo){this._$Bo=new Object;for(var i=this._$aS.length,e=0;e<i;e++){var r=\"this._$aS[e],o=r.getDrawDataID();null!=o&&(this._$Bo[o]=r)}}return\" this._$bo[id]}return t<this._$as.length?this._$as[t]:null},y.prototype.release=\"function(){this._$3S.clear(),this._$aS.clear(),this._$F2.clear(),null!=this._$Bo&&this._$Bo.clear(),this._$db.clear(),this._$8b.clear(),this._$Hr.clear()},Y.prototype.init=function(){this._$co++,this._$F2.length\">0&&this.release();for(var t=this._$Ri.getModelImpl(),i=t._$Xr(),r=i.length,o=new Array,n=new Array,s=0;s<r;++s){var _=\"i[s];this._$F2.push(_),this._$Hr.push(_.init(this));for(var\" a=\"_.getBaseData(),h=a.length,l=0;l<h;++l)o.push(a[l]);for(var\" l=\"0;l<h;++l){var\" $=\"a[l].init(this);$._$l2(s),n.push($)}for(var\" u=\"_.getDrawData(),p=u.length,l=0;l<p;++l){var\" f=\"u[l],c=f.init(this);c._$IP=s,this._$aS.push(f),this._$8b.push(c)}}for(var\" d=\"o.length,g=yt._$2o();;){for(var\" y=\"!1,s=0;s<d;++s){var\" m=\"o[s];if(null!=m){var\" t=\"m.getTargetBaseDataID();(null==T||T==g||this.getBaseDataIndex(T)\">=0)&&(this._$3S.push(m),this._$db.push(n[s]),o[s]=null,y=!0)}}if(!y)break}var P=t._$E2();if(null!=P){var S=P._$1s();if(null!=S)for(var v=S.length,s=0;s<v;++s){var l=\"S[s];null!=L&&this._$02(L.getParamID(),L.getDefaultValue(),L.getMinValue(),L.getMaxValue())}}this.clipManager=new\" e(this.dp_webgl),this.clipmanager.init(this,this._$as,this._$8b),this._$qt=\"!0},Y.prototype.update=function(){Y._$e&&_.start(\"_$zL\");for(var\" t=\"this._$_2.length,i=0;i<t;i++)this._$_2[i]!=this._$vr[i]&&(this._$Js[i]=Y._$ZS,this._$vr[i]=this._$_2[i]);var\" e=\"this._$3S.length,r=this._$aS.length,o=W._$or(),n=W._$Pr(),s=n-o+1;(null==this._$Ws||this._$Ws.length<s)&&(this._$Ws=new\" int16array(s),this._$vs=\"new\" int16array(s));for(var i=\"0;i<s;i++)this._$Ws[i]=Y._$V2,this._$Vs[i]=Y._$V2;(null==this._$Er||this._$Er.length<r)&&(this._$Er=new\" int16array(r));for(var a=\"null,h=0;h<e;++h){var\" u=\"null,p=0;p<r;++p){var\" f=\"this._$aS[p],c=this._$8b[p];try{if(f._$Nr(this,c),c._$u2())continue;f._$2b(this,c);var\" d,g=\"Math.floor(f._$zS(this,c)-o);try{d=this._$Vs[g]}catch(t){console.log(\"_$li\" :: %s \\t\\t\\t\\t@@_$fs\\n\",t.tostring(),f.getdrawdataid().tostring()),g=\"Math.floor(f._$zS(this,c)-o);continue}d==Y._$V2?this._$Ws[g]=p:this._$Er[d]=p,this._$Vs[g]=p}catch(t){null==u&&(u=t,at._$sT(at._$H7))}}null!=u&&Y._$_0&&_._$Rb(u),Y._$e&&_.dump(\"_$DL\"),Y._$e&&_.start(\"_$eL\");for(var\">=0;i--)this._$Js[i]=Y._$jr;return this._$QT=!1,Y._$e&&_.dump(\"_$eL\"),!1},Y.prototype.preDraw=function(t){null!=this.clipManager&&(t._$ZT(),this.clipManager.setupClip(this,t))},Y.prototype.draw=function(t){if(null==this._$Ws)return void _._$li(\"call _$Ri.update() before _$Ri.draw() \");var i=this._$Ws.length;t._$ZT();for(var e=0;e<i;++e){var r=\"this._$Ws[e];if(r!=Y._$V2)for(;;){var\" o=\"this._$aS[r],n=this._$8b[r];if(n._$yo()){var\" s=\"n._$IP,a=this._$Hr[s];n._$VS=a.getPartsOpacity(),o.draw(t,this,n)}var\" h=\"this._$Er[r];if(h<=r||h==Y._$W0)break;r=h}}},Y.prototype.getParamIndex=function(t){for(var\" i=\"this._$pb.length-1;i\">=0;--i)if(this._$pb[i]==t)return i;return this._$02(t,0,Y._$tr,Y._$lr)},Y.prototype._$BS=function(t){return this.getBaseDataIndex(t)},Y.prototype.getBaseDataIndex=function(t){for(var i=this._$3S.length-1;i>=0;--i)if(null!=this._$3S[i]&&this._$3S[i].getBaseDataID()==t)return i;return-1},Y.prototype._$UT=function(t,i){var e=new Float32Array(i);return w._$jT(t,0,e,0,t.length),e},Y.prototype._$02=function(t,i,e,r){if(this._$qo>=this._$pb.length){var o=this._$pb.length,n=new Array(2*o);w._$jT(this._$pb,0,n,0,o),this._$pb=n,this._$_2=this._$UT(this._$_2,2*o),this._$vr=this._$UT(this._$vr,2*o),this._$Rr=this._$UT(this._$Rr,2*o),this._$Or=this._$UT(this._$Or,2*o);var s=new Array;w._$jT(this._$Js,0,s,0,o),this._$Js=s}return this._$pb[this._$qo]=t,this._$_2[this._$qo]=i,this._$vr[this._$qo]=i,this._$Rr[this._$qo]=e,this._$Or[this._$qo]=r,this._$Js[this._$qo]=Y._$ZS,this._$qo++},Y.prototype._$Zo=function(t,i){this._$3S[t]=i},Y.prototype.setParamFloat=function(t,i){i<this._$rr[t]&&(i=this._$rr[t]),i>this._$Or[t]&&(i=this._$Or[t]),this._$_2[t]=i},Y.prototype.loadParam=function(){var t=this._$_2.length;t>this._$fs.length&&(t=this._$fs.length),w._$jT(this._$fs,0,this._$_2,0,t)},Y.prototype.saveParam=function(){var t=this._$_2.length;t>this._$fs.length&&(this._$fs=new Float32Array(t)),w._$jT(this._$_2,0,this._$fs,0,t)},Y.prototype._$v2=function(){return this._$co},Y.prototype._$WS=function(){return this._$QT},Y.prototype._$Xb=function(t){return this._$Js[t]==Y._$ZS},Y.prototype._$vs=function(){return this._$Es},Y.prototype._$Tr=function(){return this._$ZP},Y.prototype.getBaseData=function(t){return this._$3S[t]},Y.prototype.getParamFloat=function(t){return this._$_2[t]},Y.prototype.getParamMax=function(t){return this._$Or[t]},Y.prototype.getParamMin=function(t){return this._$Rr[t]},Y.prototype.setPartsOpacity=function(t,i){this._$Hr[t].setPartsOpacity(i)},Y.prototype.getPartsOpacity=function(t){return this._$Hr[t].getPartsOpacity()},Y.prototype.getPartsDataIndex=function(t){for(var i=this._$F2.length-1;i>=0;--i)if(null!=this._$F2[i]&&this._$F2[i]._$p2()==t)return i;return-1},Y.prototype._$q2=function(t){return this._$db[t]},Y.prototype._$C2=function(t){return this._$8b[t]},Y.prototype._$Bb=function(t){return this._$Hr[t]},Y.prototype._$5s=function(t,i){for(var e=this._$Ws.length,r=t,o=0;o<e;++o){var n=\"this._$Ws[o];if(n!=Y._$V2)for(;;){var\" s=\"this._$8b[n];s._$yo()&&(s._$GT()._$B2(this,s,r),r+=i);var\" _=\"this._$Er[n];if(_<=n||_==Y._$W0)break;n=_}}},Y.prototype.setDrawParam=function(t){this.dp_webgl=t},Y.prototype.getDrawParam=function(){return\" this.dp_webgl},k._$0t=\"function(t){return\" k._$0t(new _$5(t))},k._$0t=\"function(t){if(!t.exists())throw\" new _$ls(t._$3b());for(var i,e=\"t.length(),r=new\" int8array(e),o=\"new\" _$xs(new _$kb(t),8192),n=\"0;(i=o.read(r,n,e-n))\">0;)n+=i;return r},k._$C=function(t){var i=null,e=null;try{i=t instanceof Array?t:new _$Xs(t,8192),e=new _$js;for(var r,o=new Int8Array(1e3);(r=i.read(o))>0;)e.write(o,0,r);return e._$TS()}finally{null!=t&&t.close(),null!=e&&(e.flush(),e.close())}},V.prototype._$T2=function(){return w.getUserTimeMSec()+Math._$10()*(2*this._$Br-1)},V.prototype._$uo=function(t){this._$Br=t},V.prototype._$QS=function(t,i,e){this._$Dr=t,this._$Cb=i,this._$mr=e},V.prototype._$7T=function(t){var i,e=w.getUserTimeMSec(),r=0;switch(this._$_L){case STATE_CLOSING:r=(e-this._$bb)/this._$Dr,r>=1&&(r=1,this._$_L=wt.STATE_CLOSED,this._$bb=e),i=1-r;break;case STATE_CLOSED:r=(e-this._$bb)/this._$Cb,r>=1&&(this._$_L=wt.STATE_OPENING,this._$bb=e),i=0;break;case STATE_OPENING:r=(e-this._$bb)/this._$mr,r>=1&&(r=1,this._$_L=wt.STATE_INTERVAL,this._$12=this._$T2()),i=r;break;case STATE_INTERVAL:this._$12<e&&(this._$_l=wt.state_closing,this._$bb=e),i=1;break;case state_first:default:this._$_l=\"wt.STATE_INTERVAL,this._$12=this._$T2(),i=1}this._$jo||(i=-i),t.setParamFloat(this._$iL,i),t.setParamFloat(this._$0L,i)};var\" wt=\"function(){};wt.STATE_FIRST=\"STATE_FIRST\",wt.STATE_INTERVAL=\"STATE_INTERVAL\",wt.STATE_CLOSING=\"STATE_CLOSING\",wt.STATE_CLOSED=\"STATE_CLOSED\",wt.STATE_OPENING=\"STATE_OPENING\",X.prototype=new\" e,x._$as=\"32,X._$Gr=!1,X._$NT=null,X._$vS=null,X._$no=null,X._$9r=function(t){return\" new float32array(t)},x._$vb=\"function(t){return\" int16array(t)},x._$cr=\"function(t,i){return\" null=\"=t||t._$yL()<i.length?(t=X._$9r(2*i.length),t.put(i),t._$oT(0)):(t.clear(),t.put(i),t._$oT(0)),t},X._$mb=function(t,i){return\" x._$gr},x._$as=\"function(t){X._$Gr=t},X.prototype.setGL=function(t){this.gl=t},X.prototype.setTransform=function(t){this.transform=t},X.prototype._$ZT=function(){},X.prototype._$Uo=function(t,i,e,r,o,n,s,_){if(!(n<.01)){var\" a=\"this._$U2[t],h=n\">.9?at.EXPAND_W:0;this.gl.drawElements(a,e,r,o,n,h,this.transform,_)}},X.prototype._$Rs=function(){throw new Error(\"_$Rs\")},X.prototype._$Ds=function(t){throw new Error(\"_$Ds\")},X.prototype._$K2=function(){for(var t=0;t<this._$sb.length;t++){0!=this._$sb[t]&&(this.gl._$sr(1,this._$sb,t),this._$sb[t]=0)}},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$sb[t]=i},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$u2[t]=i},x.prototype._$ns=function(t){var i=\"Math.max(2*this._$sb.length,t+1+10),e=new\" int32array(i);w._$jt(this._$sb,0,e,0,this._$sb.length),this._$sb=\"e;var\" r=\"new\" array;w._$jt(this._$u2,0,r,0,this._$u2.length),this._$u2=\"r},z.prototype=new\" i,z._$xo=\"new\" float32array(2),z._$io=\"new\" float32array(2),z._$0o=\"new\" float32array(2),z._$lo=\"new\" float32array(2),z._$to=\"new\" float32array(2),z._$po=\"new\" float32array(2),z._$gt=\"new\" array,z.prototype._$zp=\"function(){this._$GS=new\" d,this._$gs._$zp(),this._$y0=\"new\" array},z.prototype.gettype=\"function(){return\" i._$c2},z.prototype._$f0=\"function(t){I.prototype._$F0.call(this,t),this._$GS=t._$nP(),this._$Y0=t._$nP(),I.prototype.readV2_opacity.call(this,t)},z.prototype.init=function(t){var\" h(this);return i._$yr=\"new\" p,this._$32()&&(i._$wr=\"new\" p),i},z.prototype._$nr=\"function(t,i){this!=i._$GT()&&console.log(\"###\" assert!! ### \");var e=\"i;if(this._$GS._$Ur(t)){var\" o=\"this._$GS._$Q2(t,r);i._$Ib(r[0]),this.interpolateOpacity(t,this._$GS,i,r);var\" n=\"t._$vs(),s=t._$Tr();if(this._$GS._$zr(n,s,o),o<=0){var\" _=\"this._$Y0[n[0]];e._$Yr.init(_)}else\" if(1=\"=o){var\" if(2=\"=o){var\" if(3=\"=o){var\" c=\"this._$Y0[n[0]],d=this._$Y0[n[1]],g=this._$Y0[n[2]],y=this._$Y0[n[3]],m=this._$Y0[n[4]],T=this._$Y0[n[5]],P=this._$Y0[n[6]],S=this._$Y0[n[7]],h=s[0],u=s[1],v=s[2],p=c._$fL+(d._$fL-c._$fL)*h,f=g._$fL+(y._$fL-g._$fL)*h,L=m._$fL+(T._$fL-m._$fL)*h,M=P._$fL+(S._$fL-P._$fL)*h;e._$Yr._$fL=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$gL+(d._$gL-c._$gL)*h,f=g._$gL+(y._$gL-g._$gL)*h,L=m._$gL+(T._$gL-m._$gL)*h,M=P._$gL+(S._$gL-P._$gL)*h,e._$Yr._$gL=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$B0+(d._$B0-c._$B0)*h,f=g._$B0+(y._$B0-g._$B0)*h,L=m._$B0+(T._$B0-m._$B0)*h,M=P._$B0+(S._$B0-P._$B0)*h,e._$Yr._$B0=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$z0+(d._$z0-c._$z0)*h,f=g._$z0+(y._$z0-g._$z0)*h,L=m._$z0+(T._$z0-m._$z0)*h,M=P._$z0+(S._$z0-P._$z0)*h,e._$Yr._$z0=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$qT+(d._$qT-c._$qT)*h,f=g._$qT+(y._$qT-g._$qT)*h,L=m._$qT+(T._$qT-m._$qT)*h,M=P._$qT+(S._$qT-P._$qT)*h,e._$Yr._$qT=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u)}else\" if(4=\"=o){var\" j=\"0|Math.pow(2,o),q=new\" float32array(j),j=\"0;J<j;J++){for(var\" q=\"J,Z=1,K=0;K<o;K++)Z*=Q%2==0?1-s[K]:s[K],Q/=2;q[J]=Z}for(var\" tt=\"new\" array,it=\"0;it<j;it++)tt[it]=this._$Y0[n[it]];for(var\" et=\"0,rt=0,ot=0,nt=0,st=0,it=0;it<j;it++)et+=q[it]*tt[it]._$fL,rt+=q[it]*tt[it]._$gL,ot+=q[it]*tt[it]._$B0,nt+=q[it]*tt[it]._$z0,st+=q[it]*tt[it]._$qT;e._$Yr._$fL=et,e._$Yr._$gL=rt,e._$Yr._$B0=ot,e._$Yr._$z0=nt,e._$Yr._$qT=st}var\" _$0p _$g :: %s\",r),e._$hs(!1);else{var a=\"z._$io;a[0]=0,a[1]=-.1;n._$GT().getType()==I._$c2?a[1]=-10:a[1]=-.1;var\" h=\"z._$0o;this._$Jr(t,o,n,s,a,h);var\" l=\"Lt._$92(a,h);o._$nb(t,n,s,s,1,0,2),e._$Wr._$fL=s[0],e._$Wr._$gL=s[1],e._$Wr._$B0=e._$Yr._$B0,e._$Wr._$z0=e._$Yr._$z0,e._$Wr._$qT=e._$Yr._$qT-l*Lt._$NS;var\" $=\"n.getTotalScale();e.setTotalScale_notForClient($*e._$Wr._$B0);var\" u=\"n.getTotalOpacity();e.setTotalOpacity(u*e.getInterpolatedOpacity()),e._$Wr.reflectX=e._$Yr.reflectX,e._$Wr.reflectY=e._$Yr.reflectY,e._$hS(n._$yo())}else\" e._$hs(!1)}}else e.settotalscale_notforclient(e._$yr._$b0),e.settotalopacity(e.getinterpolatedopacity())},z.prototype._$nb=\"function(t,i,e,r,o,n,s){this!=i._$GT()&&console.log(\"###\" \");for(var _,a,h=\"i,l=null!=h._$Wr?h._$Wr:h._$Yr,$=Math.sin(Lt._$bS*l._$qT),u=Math.cos(Lt._$bS*l._$qT),p=h.getTotalScale(),f=l.reflectX?-1:1,c=l.reflectY?-1:1,d=u*p*f,g=-$*p*c,y=$*p*f,m=u*p*c,T=l._$fL,P=l._$gL,S=o*s,v=n;v<S;v+=s)_=e[v],a=e[v+1],r[v]=d*_+g*a+T,r[v+1]=y*_+m*a+P},z.prototype._$Jr=function(t,i,e,r,o,n){i!=e._$GT()&&console.log(\"###\" s=\"z._$Lo;z._$Lo[0]=r[0],z._$Lo[1]=r[1],i._$nb(t,e,s,s,1,0,2);for(var\" n[0]=\"_[0],void(n[1]=_[1]);if(a[0]=r[0]-h*o[0],a[1]=r[1]-h*o[1],i._$nb(t,e,a,_,1,0,2),_[0]-=s[0],_[1]-=s[1],0!=_[0]||0!=_[1])return\" _[0]=\"-_[0],_[0]=-_[0],n[0]=_[0],void(n[1]=_[1]);h*=.1}at._$so&&console.log(\"_$L0\" to transform _$sp\\n\")},h.prototype=\"new\" _t,w.prototype=\"new\" m,w._$ur=\"-2,W._$ES=500,W._$wb=2,W._$8S=3,W._$os=4,W._$52=W._$ES,W._$R2=W._$ES,W._$Sb=function(t){for(var\">=0;--i){var e=t[i];e<w._$52?w._$52=e:e>W._$R2&&(W._$R2=e)}},W._$or=function(){return W._$52},W._$Pr=function(){return W._$R2},W.prototype._$F0=function(t){this._$gP=t._$nP(),this._$dr=t._$nP(),this._$GS=t._$nP(),this._$qb=t._$6L(),this._$Lb=t._$cS(),this._$mS=t._$Tb(),t.getFormatVersion()>=G._$T7?(this.clipID=t._$nP(),this.clipIDList=this.convertClipIDForV2_11(this.clipID)):this.clipIDList=null,W._$Sb(this._$Lb)},W.prototype.getClipIDList=function(){return this.clipIDList},W.prototype._$Nr=function(t,i){if(i._$IS[0]=!1,i._$Us=v._$Z2(t,this._$GS,i._$IS,this._$Lb),at._$Zs);else if(i._$IS[0])return;i._$7s=v._$br(t,this._$GS,i._$IS,this._$mS)},W.prototype._$2b=function(t){},W.prototype.getDrawDataID=function(){return this._$gP},W.prototype._$j2=function(t){this._$gP=t},W.prototype.getOpacity=function(t,i){return i._$7s},W.prototype._$zS=function(t,i){return i._$Us},W.prototype.getTargetBaseDataID=function(){return this._$dr},W.prototype._$gs=function(t){this._$dr=t},W.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},W.prototype.getType=function(){},j._$42=0,j.prototype._$1b=function(){return this._$3S},j.prototype.getDrawDataList=function(){return this._$aS},j.prototype._$F0=function(t){this._$NL=t._$nP(),this._$aS=t._$nP(),this._$3S=t._$nP()},j.prototype._$kr=function(t){t._$Zo(this._$3S),t._$xo(this._$aS),this._$3S=null,this._$aS=null},q.prototype=new i,q.loadModel=function(t){var e=new q;return i._$62(e,t),e},q.loadModel=function(t){var e=new q;return i._$62(e,t),e},q._$to=function(){return new q},q._$er=function(t){var i=new _$5(\"../_$_r/_$t0/_$Ri/_$_P._$d\");if(0==i.exists())throw new _$ls(\"_$t0 _$_ _$6 _$Ui :: \"+i._$PL());for(var e=[\"../_$_r/_$t0/_$Ri/_$_P.512/_$CP._$1\",\"../_$_r/_$t0/_$Ri/_$_P.512/_$vP._$1\",\"../_$_r/_$t0/_$Ri/_$_P.512/_$EP._$1\",\"../_$_r/_$t0/_$Ri/_$_P.512/_$pP._$1\"],r=q.loadModel(i._$3b()),o=0;o<e.length;o++){var n=\"new\" _$5(e[o]);if(0=\"=n.exists())throw\" new _$ls(\"_$t0 _$_ _$6 _$ui :: \"+n._$pl());r.settexture(o,_$nl._$_o(t,n._$3b()))}return r},q.prototype.setgl=\"function(t){this._$zo.setGL(t)},q.prototype.setTransform=function(t){this._$zo.setTransform(t)},q.prototype.draw=function(){this._$5S.draw(this._$zo)},q.prototype._$K2=function(){this._$zo._$K2()},q.prototype.setTexture=function(t,i){null==this._$zo&&_._$li(\"_$Yi\" for qt _$ki _$xs() is _$ui!!\"),this._$zo.settexture(t,i)},q.prototype.settexture=\"function(t,i){null==this._$zo&&_._$li(\"_$Yi\" _$ui!!\"),this._$zo.settexture(t,i)},q.prototype._$rs=\"function(){return\" this._$zo._$rs()},q.prototype._$ds=\"function(t){this._$zo._$Ds(t)},q.prototype.getDrawParam=function(){return\" this._$zo},j.prototype=\"new\" s,j._$cs=\"VISIBLE:\" ,j._$ar=\"LAYOUT:\" ,j.mtn_prefix_fadein=\"FADEIN:\" ,j.mtn_prefix_fadeout=\"FADEOUT:\" ,j._$co=\"0,J._$1T=1,J.loadMotion=function(t){var\" i=\"k._$C(t);return\" j.loadmotion(i)},j.loadmotion=\"function(t){t\" instanceof arraybuffer&&(t=\"new\" dataview(t));var j,e=\"[0],r=t.byteLength;i._$yT=0;for(var\" o=\"0;o<r;++o){var\" _=\"o,a=-1;o<r&&(\"\\r\"!=(n=Q(t,o))&&\"\\n\"!=n);++o)if(\"=\"==n){a=o;break}if(a\">=0){var h=new B;O.startsWith(t,_,J._$cs)?(h._$RP=B._$hs,h._$4P=O.createString(t,_,a-_)):O.startsWith(t,_,J._$ar)?(h._$4P=O.createString(t,_+7,a-_-7),O.startsWith(t,_+7,\"ANCHOR_X\")?h._$RP=B._$xs:O.startsWith(t,_+7,\"ANCHOR_Y\")?h._$RP=B._$us:O.startsWith(t,_+7,\"SCALE_X\")?h._$RP=B._$qs:O.startsWith(t,_+7,\"SCALE_Y\")?h._$RP=B._$Ys:O.startsWith(t,_+7,\"X\")?h._$RP=B._$ws:O.startsWith(t,_+7,\"Y\")&&(h._$RP=B._$Ns)):(h._$RP=B._$Fr,h._$4P=O.createString(t,_,a-_)),i.motions.push(h);var l=0,$=[];for(o=a+1;o<r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\"\\t\"!=n){var\" u=\"O._$LS(t,r,o,e);if(e[0]\">0){$.push(u),l++;var p=e[0];if(p<o){console.log(\"_$n0 _$hi . @live2dmotion loadmotion()\\n\");break}o=\"p-1}}h._$I0=new\" float32array($),l>i._$yT&&(i._$yT=l)}}}else{for(var _=o,a=-1;o<r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\"=\"==n){a=o;break}var f=\"!1;if(a\">=0)for(a==_+4&&\"f\"==Q(t,_+1)&&\"p\"==Q(t,_+2)&&\"s\"==Q(t,_+3)&&(f=!0),o=a+1;o<r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\"\\t\"!=n){var\" u=\"O._$LS(t,r,o,e);e[0]\">0&&f&&5<u&&u<121&&(i._$d0=u),o=e[0]}for(;o<r&&(\"\\n\"!=q(t,o)&&\"\\r\"!=q(t,o));++o);}else for(;o<r&&(\"\\n\"!=\"Q(t,o)&&\"\\r\"!=Q(t,o));++o);}return\" i._$rr=\"1e3*i._$yT/i._$D0|0,i},J.prototype.getDurationMSec=function(){return\" this._$e?-1:this._$rr},j.prototype.getloopdurationmsec=\"function(){return\" this._$rr},j.prototype.dump=\"function(){for(var\" t=\"0;t<this.motions.length;t++){var\" i=\"this.motions[t];console.log(\"_$wL[%s]\" [%d]. \",i._$4p,i._$i0.length);for(var e=\"0;e<i._$I0.length&&e<10;e++)console.log(\"%5.2f\" ,\",i._$i0[e]);console.log(\"\\n\")}},j.prototype.updateparamexe=\"function(t,i,e,r){for(var\" o=\"i-r._$z2,n=o*this._$D0/1e3,s=0|n,_=n-s,a=0;a<this.motions.length;a++){var\" h=\"this.motions[a],l=h._$I0.length,$=h._$4P;if(h._$RP==B._$hs){var\" u=\"h._$I0[s\">=l?l-1:s];t.setParamFloat($,u)}else if(B._$ws<=h._$rp&&h._$rp<=b._$ys);else{var p,f=\"t.getParamIndex($),c=t.getModelContext(),d=c.getParamMax(f),g=c.getParamMin(f),y=.4*(d-g),m=c.getParamFloat(f),T=h._$I0[s\">=l?l-1:s],P=h._$I0[s+1>=l?l-1:s+1];p=T<p&&p-t>y||T>P&&T-P>y?T:T+(P-T)*_;var S=m+(p-m)*e;t.setParamFloat($,S)}}s>=this._$yT&&(this._$E?(r._$z2=i,this.loopFadeIn&&(r._$bs=i)):r._$9L=!0),this._$eP=e},J.prototype._$r0=function(){return this._$E},J.prototype._$aL=function(t){this._$E=t},J.prototype._$S0=function(){return this._$D0},J.prototype._$U0=function(t){this._$D0=t},J.prototype.isLoopFadeIn=function(){return this.loopFadeIn},J.prototype.setLoopFadeIn=function(t){this.loopFadeIn=t},N.prototype.clear=function(){this.size=0},N.prototype.add=function(t){if(this._$P.length<=this.size){var i=\"new\" float32array(2*this.size);w._$jt(this._$p,0,i,0,this.size),this._$p=\"i}this._$P[this.size++]=t},N.prototype._$BL=function(){var\" t=\"new\" float32array(this.size);return w._$jt(this._$p,0,t,0,this.size),t},b._$fr=\"0,B._$hs=1,B._$ws=100,B._$Ns=101,B._$xs=102,B._$us=103,B._$qs=104,B._$Ys=105,Z.prototype=new\" i,z._$gt=\"new\" array,z.prototype._$zp=\"function(){this._$GS=new\" d,this._$gs._$zp()},z.prototype._$f0=\"function(t){I.prototype._$F0.call(this,t),this._$A=t._$6L(),this._$o=t._$6L(),this._$GS=t._$nP(),this._$Eo=t._$nP(),I.prototype.readV2_opacity.call(this,t)},Z.prototype.init=function(t){var\" k(this),e=\"(this._$o+1)*(this._$A+1);return\" null!=\"i._$Cr&&(i._$Cr=null),i._$Cr=new\" float32array(2*e),null!=\"i._$hr&&(i._$hr=null),this._$32()?i._$hr=new\" float32array(2*e):i._$hr=\"null,i},Z.prototype._$Nr=function(t,i){var\" e=\"i;if(this._$GS._$Ur(t)){var\" r=\"this._$VT(),o=Z._$gT;o[0]=!1,v._$Vr(t,this._$GS,o,r,this._$Eo,e._$Cr,0,2),i._$Ib(o[0]),this.interpolateOpacity(t,this._$GS,i,o)}},Z.prototype._$2b=function(t,i){var\" _$0p _$g :: %s\",r),e._$hs(!1);else{var o=\"t.getBaseData(e._$8r),n=t._$q2(e._$8r);if(null!=o&&n._$yo()){var\" s=\"n.getTotalScale();e.setTotalScale_notForClient(s);var\" a=\"n.getTotalOpacity();e.setTotalOpacity(a*e.getInterpolatedOpacity()),o._$nb(t,n,e._$Cr,e._$hr,this._$VT(),0,2),e._$hS(!0)}else\" e._$hs(!1)}}else e.settotalopacity(e.getinterpolatedopacity())},z.prototype._$nb=\"function(t,i,e,r,o,n,s){var\" _=\"i,a=null!=_._$hr?_._$hr:_._$Cr;Z.transformPoints_sdk2(e,r,o,n,s,a,this._$o,this._$A)},Z.transformPoints_sdk2=function(i,e,r,o,n,s,_,a){for(var\" h,l,$,u=\"r*n,p=0,f=0,c=0,d=0,g=0,y=0,m=!1,T=o;T<u;T+=n){var\" p,s,v,l;if(v=\"i[T],L=i[T+1],P=v*_,S=L*a,P<0||S<0||_<=P||a<=S){var\" m=\"_+1;if(!m){m=!0,p=.25*(s[2*(0+0*M)]+s[2*(_+0*M)]+s[2*(0+a*M)]+s[2*(_+a*M)]),f=.25*(s[2*(0+0*M)+1]+s[2*(_+0*M)+1]+s[2*(0+a*M)+1]+s[2*(_+a*M)+1]);var\" x=\"s[2*(0+0*M)],O=s[2*(0+0*M)+1],D=p-2*c,R=f-2*d,b=p-2*g,F=f-2*y,C=p-2*c-2*g,N=f-2*d-2*y,B=.5*(v-\" -2),u=\".5*(L-\" -2);b+u<=\"1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l>=1){var b=s[2*(0+a*M)],F=s[2*(0+a*M)+1],C=p-2*c+1*g,N=f-2*d+1*y,x=p+3*g,O=f+3*y,D=p-2*c+3*g,R=f-2*d+3*y,B=.5*(v- -2),U=.5*(L-1);B+U<=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var g=\"0|S;G==a&&(G=a-1);var\" b=\".5*(v-\" -2),u=\"S-G,Y=G/a,k=(G+1)/a,b=s[2*(0+G*M)],F=s[2*(0+G*M)+1],x=s[2*(0+(G+1)*M)],O=s[2*(0+(G+1)*M)+1],C=p-2*c+Y*g,N=f-2*d+Y*y,D=p-2*c+k*g,R=f-2*d+k*y;B+U<=1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(1<=\"v)if(L<=0){var\" d=\"s[2*(_+0*M)],R=s[2*(_+0*M)+1],x=p+3*c,O=f+3*d,C=p+1*c-2*g,N=f+1*d-2*y,b=p+3*c-2*g,F=f+3*d-2*y,B=.5*(v-1),U=.5*(L-\" -2);b+u<=\"1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l>=1){var C=s[2*(_+a*M)],N=s[2*(_+a*M)+1],b=p+3*c+1*g,F=f+3*d+1*y,D=p+1*c+3*g,R=f+1*d+3*y,x=p+3*c+3*g,O=f+3*d+3*y,B=.5*(v-1),U=.5*(L-1);B+U<=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var g=\"0|S;G==a&&(G=a-1);var\" b=\".5*(v-1),U=S-G,Y=G/a,k=(G+1)/a,C=s[2*(_+G*M)],N=s[2*(_+G*M)+1],D=s[2*(_+(G+1)*M)],R=s[2*(_+(G+1)*M)+1],b=p+3*c+Y*g,F=f+3*d+Y*y,x=p+3*c+k*g,O=f+3*d+k*y;B+U<=1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l<=\"0){var\" v=\"0|P;V==_&&(V=_-1);var\" -2),x=\"V/_,z=(V+1)/_,D=s[2*(V+0*M)],R=s[2*(V+0*M)+1],x=s[2*(V+1+0*M)],O=s[2*(V+1+0*M)+1],C=p+X*c-2*g,N=f+X*d-2*y,b=p+z*c-2*g,F=f+z*d-2*y;B+U<=1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l>=1){var V=0|P;V==_&&(V=_-1);var B=P-V,U=.5*(L-1),X=V/_,z=(V+1)/_,C=s[2*(V+a*M)],N=s[2*(V+a*M)+1],b=s[2*(V+1+a*M)],F=s[2*(V+1+a*M)+1],D=p+X*c+3*g,R=f+X*d+3*y,x=p+z*c+3*g,O=f+z*d+3*y;B+U<=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else t.err.printf(\"_$li calc : %.4f , %.4f\\t\\t\\t\\t\\t@@bdboxgrid\\n\",v,l);else e[t]=\"p+v*c+L*g,e[T+1]=f+v*d+L*y}else\" l=\"P-(0|P),$=S-(0|S),h=2*((0|P)+(0|S)*(_+1)),l+$<1?(e[T]=s[h]*(1-l-$)+s[h+2]*l+s[h+2*(_+1)]*$,e[T+1]=s[h+1]*(1-l-$)+s[h+3]*l+s[h+2*(_+1)+1]*$):(e[T]=s[h+2*(_+1)+2]*(l-1+$)+s[h+2*(_+1)]*(1-l)+s[h+2]*(1-$),e[T+1]=s[h+2*(_+1)+3]*(l-1+$)+s[h+2*(_+1)+1]*(1-l)+s[h+3]*(1-$))}},Z.prototype.transformPoints_sdk1=function(t,i,e,r,o,n,s){for(var\" _,a,h,l,$,u,p,f=\"i,c=this._$o,d=this._$A,g=o*s,y=null!=f._$hr?f._$hr:f._$Cr,m=n;m<g;m+=s)at._$ts?(_=e[m],a=e[m+1],_<0?_=0:_\">1&&(_=1),a<0?a=0:a>1&&(a=1),_*=c,a*=d,h=0|_,l=0|a,h>c-1&&(h=c-1),l>d-1&&(l=d-1),u=_-h,p=a-l,$=2*(h+l*(c+1))):(_=e[m]*c,a=e[m+1]*d,u=_-(0|_),p=a-(0|a),$=2*((0|_)+(0|a)*(c+1))),u+p<1?(r[m]=y[$]*(1-u-p)+y[$+2]*u+y[$+2*(c+1)]*p,r[m+1]=y[$+1]*(1-u-p)+y[$+3]*u+y[$+2*(c+1)+1]*p):(r[m]=y[$+2*(c+1)+2]*(u-1+p)+y[$+2*(c+1)]*(1-u)+y[$+2]*(1-p),r[m+1]=y[$+2*(c+1)+3]*(u-1+p)+y[$+2*(c+1)+1]*(1-u)+y[$+3]*(1-p))},z.prototype._$vt=function(){return(this._$o+1)*(this._$a+1)},z.prototype.gettype=function(){return i._$_b},k.prototype=\"new\" _t,tt._$42=\"0,tt.prototype._$zP=function(){this._$3S=new\" array,this._$as=\"new\" array},tt.prototype._$f0=\"function(t){this._$g0=t._$8L(),this.visible=t._$8L(),this._$NL=t._$nP(),this._$3S=t._$nP(),this._$aS=t._$nP()},tt.prototype.init=function(t){var\" i=\"new\" it(this);return i.setpartsopacity(this.isvisible()?1:0),i},tt.prototype._$6o=\"function(t){if(null==this._$3S)throw\" new error(\"_$3s _$6 _$wo@_$6o\");this._$3s.push(t)},tt.prototype._$3o=\"function(t){if(null==this._$aS)throw\" error(\"_$as _$wo@_$3o\");this._$as.push(t)},tt.prototype._$zo=\"function(t){this._$3S=t},tt.prototype._$xo=function(t){this._$aS=t},tt.prototype.isVisible=function(){return\" this.visible},tt.prototype._$ul=\"function(){return\" this._$g0},tt.prototype._$kp=\"function(t){this.visible=t},tt.prototype._$ET=function(t){this._$g0=t},tt.prototype.getBaseData=function(){return\" this._$3s},tt.prototype.getdrawdata=\"function(){return\" this._$as},tt.prototype._$p2=\"function(){return\" this._$nl},tt.prototype._$ob=\"function(t){this._$NL=t},tt.prototype.getPartsID=function(){return\" this._$nl},tt.prototype._$mp=\"function(t){this._$NL=t},it.prototype=new\" $,it.prototype.getpartsopacity=\"function(){return\" this._$vs},it.prototype.setpartsopacity=\"function(t){this._$VS=t},et._$L7=function(){u._$27(),yt._$27(),b._$27(),l._$27()},et.prototype.toString=function(){return\" this.id},rt.prototype._$f0=\"function(t){},ot.prototype._$1s=function(){return\" this._$4s},ot.prototype._$zp=\"function(){this._$4S=new\" array},ot.prototype._$f0=\"function(t){this._$4S=t._$nP()},ot.prototype._$Ks=function(t){this._$4S.push(t)},nt.tr=new\" gt,nt._$50=\"new\" gt,nt._$ti=\"new\" array(0,0),nt._$pi=\"new\" array(0,0),nt._$b=\"new\" array(0,0),nt.prototype._$lp=\"function(t,i,e,r){this.viewport=new\" array(t,i,e,r)},nt.prototype._$bl=\"function(){this.context.save();var\" t=\"this.viewport;null!=t&&(this.context.beginPath(),this.context._$Li(t[0],t[1],t[2],t[3]),this.context.clip())},nt.prototype._$ei=function(){this.context.restore()},nt.prototype.drawElements=function(t,i,e,r,o,n,s,a){try{o!=this._$Qo&&(this._$Qo=o,this.context.globalAlpha=o);for(var\" h=\"i.length,l=t.width,$=t.height,u=this.context,p=this._$xP,f=this._$uP,c=this._$6r,d=this._$3r,g=nt.tr,y=nt._$Ti,m=nt._$Pi,T=nt._$B,P=0;P<h;P+=3){u.save();var\" s=\"i[P],v=i[P+1],L=i[P+2],M=p+c*e[2*S],E=f+d*e[2*S+1],A=p+c*e[2*v],I=f+d*e[2*v+1],w=p+c*e[2*L],x=f+d*e[2*L+1];s&&(s._$PS(M,E,T),M=T[0],E=T[1],s._$PS(A,I,T),A=T[0],I=T[1],s._$PS(w,x,T),w=T[0],x=T[1]);var\" o=\"l*r[2*S],D=$-$*r[2*S+1],R=l*r[2*v],b=$-$*r[2*v+1],F=l*r[2*L],C=$-$*r[2*L+1],N=Math.atan2(b-D,R-O),B=Math.atan2(I-E,A-M),U=A-M,G=I-E,Y=Math.sqrt(U*U+G*G),k=R-O,V=b-D,X=Math.sqrt(k*k+V*V),z=Y/X;It._$ni(F,C,O,D,R-O,b-D,-(b-D),R-O,y),It._$ni(w,x,M,E,A-M,I-E,-(I-E),A-M,m);var\" it=\"a._$e0;if(it.gl_cacheImage=it.gl_cacheImage||{},!it.gl_cacheImage[P]){var\" et=\"nt.createCanvas(K-Q,tt-Z);at.DEBUG_DATA.LDGL_CANVAS_MB=at.DEBUG_DATA.LDGL_CANVAS_MB||0,at.DEBUG_DATA.LDGL_CANVAS_MB+=(K-Q)*(tt-Z)*4;var\" rt=\"et.getContext(\"2d\");rt.translate(-Q,-Z),nt.clip(rt,g,n,Y,O,D,R,b,F,C,M,E,A,I,w,x),rt.drawImage(t,0,0),it.gl_cacheImage[P]={cacheCanvas:et,cacheContext:rt}}u.drawImage(it.gl_cacheImage[P].cacheCanvas,Q,Z)}else\" at.ignore_clip||nt.clip(u,g,n,y,o,d,r,b,f,c,m,e,a,i,w,x),at.use_adjust_translation&&(w=\"0,j=l,q=0,J=$),u.drawImage(t,W,q,j-W,J-q,W,q,j-W,J-q);u.restore()}}catch(t){_._$Rb(t)}},nt.clip=function(t,i,e,r,o,n,s,_,a,h,l,$,u,p,f,c){e\">.02?nt.expandClip(t,i,e,r,l,$,u,p,f,c):nt.clipWithTransform(t,null,o,n,s,_,a,h)},nt.expandClip=function(t,i,e,r,o,n,s,_,a,h){var l=s-o,$=_-n,u=a-o,p=h-n,f=l*p-$*u>0?e:-e,c=-$,d=l,g=a-s,y=h-_,m=-y,T=g,P=Math.sqrt(g*g+y*y),S=-p,v=u,L=Math.sqrt(u*u+p*p),M=o-f*c/r,E=n-f*d/r,A=s-f*c/r,I=_-f*d/r,w=s-f*m/P,x=_-f*T/P,O=a-f*m/P,D=h-f*T/P,R=o+f*S/L,b=n+f*v/L,F=a+f*S/L,C=h+f*v/L,N=nt._$50;return null!=i._$P2(N)&&(nt.clipWithTransform(t,N,M,E,A,I,w,x,O,D,F,C,R,b),!0)},nt.clipWithTransform=function(t,i,e,r,o,n,s,a){if(arguments.length<7)return void _._$li(\"err : @ldgl.clip()\");if(!(arguments[1]instanceof gt))return a[0] is _$6 ldtransform @ldgl.clip()\");var h=\"nt._$B,l=i,$=arguments;if(t.beginPath(),l){l._$PS($[2],$[3],h),t.moveTo(h[0],h[1]);for(var\" u=\"4;u<$.length;u+=2)l._$PS($[u],$[u+1],h),t.lineTo(h[0],h[1])}else{t.moveTo($[2],$[3]);for(var\" e=\"document.createElement(\"canvas\");return\" e.setattribute(\"width\",t),e.setattribute(\"height\",i),e||_._$li(\"err \"+e),e},nt.dumpvalues=\"function(){for(var\" t ,i=\"0;i<arguments.length;i++)t+=\"[\"+i+\"]=\" \"+arguments[i].tofixed(3)+\" , \";console.log(t)},st.prototype._$f0=\"function(t){this._$TT=t._$_T(),this._$LT=t._$_T(),this._$FS=t._$_T(),this._$wL=t._$nP()},st.prototype.getMinValue=function(){return\" this._$tt},st.prototype.getmaxvalue=\"function(){return\" this._$lt},st.prototype.getdefaultvalue=\"function(){return\" this._$fs},st.prototype.getparamid=\"function(){return\" this._$wl},_t.prototype._$yo=\"function(){return\" this._$at&&!this._$js},_t.prototype._$hs=\"function(t){this._$AT=t},_t.prototype._$GT=function(){return\" this._$e0},_t.prototype._$l2=\"function(t){this._$IP=t},_t.prototype.getPartsIndex=function(){return\" this._$ip},_t.prototype._$x2=\"function(){return\" this._$js},_t.prototype._$ib=\"function(t){this._$JS=t},_t.prototype.getTotalScale=function(){return\" this.totalscale},_t.prototype.settotalscale_notforclient=\"function(t){this.totalScale=t},_t.prototype.getInterpolatedOpacity=function(){return\" this._$7s},_t.prototype.setinterpolatedopacity=\"function(t){this._$7s=t},_t.prototype.getTotalOpacity=function(t){return\" this.totalopacity},_t.prototype.settotalopacity=\"function(t){this.totalOpacity=t},at._$2s=\"2.1.00_1\",at._$Kr=201001e3,at._$sP=!0,at._$so=!0,at._$cb=!1,at._$3T=!0,at._$Ts=!0,at._$fb=!0,at._$ts=!0,at.L2D_DEFORMER_EXTEND=!0,at._$Wb=!1;at._$yr=!1,at._$Zs=!1,at.L2D_NO_ERROR=0,at._$i7=1e3,at._$9s=1001,at._$es=1100,at._$r7=2e3,at._$07=2001,at._$b7=2002,at._$H7=4e3,at.L2D_COLOR_BLEND_MODE_MULT=0,at.L2D_COLOR_BLEND_MODE_ADD=1,at.L2D_COLOR_BLEND_MODE_INTERPOLATE=2,at._$6b=!0,at._$cT=0,at.clippingMaskBufferSize=256,at.glContext=new\" array,at.framebuffers=\"new\" array,at.ftexture=\"new\" array,at.ignore_clip=\"!1,at.IGNORE_EXPAND=!1,at.EXPAND_W=2,at.USE_ADJUST_TRANSLATION=!0,at.USE_CANVAS_TRANSFORM=!0,at.USE_CACHED_POLYGON_IMAGE=!1,at.DEBUG_DATA={},at.PROFILE_IOS_SPEED={PROFILE_NAME:\"iOS\" speed\",use_adjust_translation:!0,use_cached_polygon_image:!0,expand_w:4},at.profile_ios_quality=\"{PROFILE_NAME:\"iOS\" hiq\",use_adjust_translation:!0,use_cached_polygon_image:!1,expand_w:2},at.profile_ios_default=\"at.PROFILE_IOS_QUALITY,at.PROFILE_ANDROID={PROFILE_NAME:\"Android\",USE_ADJUST_TRANSLATION:!1,USE_CACHED_POLYGON_IMAGE:!1,EXPAND_W:2},at.PROFILE_DESKTOP={PROFILE_NAME:\"Desktop\",USE_ADJUST_TRANSLATION:!1,USE_CACHED_POLYGON_IMAGE:!1,EXPAND_W:2},at.initProfile=function(){Et.isIOS()?at.setupProfile(at.PROFILE_IOS_DEFAULT):Et.isAndroid()?at.setupProfile(at.PROFILE_ANDROID):at.setupProfile(at.PROFILE_DESKTOP)},at.setupProfile=function(t,i){if(\"number\"==typeof\" t)switch(t){case 9901:t=\"at.PROFILE_IOS_SPEED;break;case\" 9902:t=\"at.PROFILE_IOS_QUALITY;break;case\" 9903:t=\"at.PROFILE_IOS_DEFAULT;break;case\" 9904:t=\"at.PROFILE_ANDROID;break;case\" 9905:t=\"at.PROFILE_DESKTOP;break;default:alert(\"profile\" _$ui \"+t)}arguments.length<2&&(i=\"!0),i&&console.log(\"profile\" \"+t.profile_name);for(var in t)at[e]=\"t[e],i&&console.log(\"\" [\"+e+\"]=\"+t[e])},at.init=function(){if(at._$6b){console.log(\" live2d %s\",at._$2s),at._$6b=\"!1;!0,at.initProfile()}},at.getVersionStr=function(){return\" at._$2s},at.getversionno=\"function(){return\" at._$kr},at._$st=\"function(t){at._$cT=t},at.getError=function(){var\" at._$ct=\"0,t},at.dispose=function(){at.glContext=[],at.frameBuffers=[],at.fTexture=[]},at.setGL=function(t,i){var\" at.glcontext[t]},at.setclippingmaskbuffersize=\"function(t){at.clippingMaskBufferSize=t},at.getClippingMaskBufferSize=function(){return\" at.clippingmaskbuffersize},at.deletebuffer=\"function(t){at.getGL(t).deleteFramebuffer(at.frameBuffers[t].framebuffer),delete\" at.framebuffers[t],delete at.glcontext[t]},ht._$r2=\"function(t){return\" t<0?0:t>1?1:.5-.5*Math.cos(t*Lt.PI_F)},lt._$fr=-1,lt.prototype.toString=function(){return this._$ib},$t.prototype=new W,$t._$42=0,$t._$Os=30,$t._$ms=0,$t._$ns=1,$t._$_s=2,$t._$gT=new Array,$t.prototype._$_S=function(t){this._$LP=t},$t.prototype.getTextureNo=function(){return this._$LP},$t.prototype._$ZL=function(){return this._$Qi},$t.prototype._$H2=function(){return this._$JP},$t.prototype.getNumPoints=function(){return this._$d0},$t.prototype.getType=function(){return W._$wb},$t.prototype._$B2=function(t,i,e){var r=i,o=null!=r._$hr?r._$hr:r._$Cr;switch(U._$do){default:case U._$Ms:throw new Error(\"_$L _$ro \");case U._$Qs:for(var n=this._$d0-1;n>=0;--n)o[n*U._$No+4]=e}},$t.prototype._$zP=function(){this._$GS=new D,this._$GS._$zP()},$t.prototype._$F0=function(t){W.prototype._$F0.call(this,t),this._$LP=t._$6L(),this._$d0=t._$6L(),this._$Yo=t._$6L();var i=t._$nP();this._$BP=new Int16Array(3*this._$Yo);for(var e=3*this._$Yo-1;e>=0;--e)this._$BP[e]=i[e];if(this._$Eo=t._$nP(),this._$Qi=t._$nP(),t.getFormatVersion()>=G._$s7){if(this._$JP=t._$6L(),0!=this._$JP){if(0!=(1&this._$JP)){var r=t._$6L();null==this._$5P&&(this._$5P=new Object),this._$5P._$Hb=parseInt(r)}0!=(this._$JP&$t._$Os)?this._$6s=(this._$JP&$t._$Os)>>1:this._$6s=$t._$ms,0!=(32&this._$JP)&&(this.culling=!1)}}else this._$JP=0},$t.prototype.init=function(t){var i=new ut(this),e=this._$d0*U._$No,r=this._$32();switch(null!=i._$Cr&&(i._$Cr=null),i._$Cr=new Float32Array(e),null!=i._$hr&&(i._$hr=null),i._$hr=r?new Float32Array(e):null,U._$do){default:case U._$Ms:if(U._$Ls)for(var o=this._$d0-1;o>=0;--o){var n=o<<1;this._$qi[n+1]=1-this._$qi[n+1]}break;case u._$qs:for(var o=\"this._$d0-1;o\">=0;--o){var n=o<<1,s=o*u._$no,_=this._$qi[n],a=this._$qi[n+1];i._$cr[s]=_,i._$cr[s+1]=a,i._$cr[s+4]=0,r&&(i._$hr[s]=_,i._$hr[s+1]=a,i._$hr[s+4]=0)}}return i},$t.prototype._$nr=\"function(t,i){var\" e=\"i;if(this!=e._$GT()&&console.log(\"###\" assert!! ### \"),this._$gs._$ur(t)&&(w.prototype._$nr.call(this,t,e),!e._$is[0])){var r=\"$t._$gT;r[0]=!1,v._$Vr(t,this._$GS,r,this._$d0,this._$Eo,e._$Cr,U._$i2,U._$No)}},$t.prototype._$2b=function(t,i){try{this!=i._$GT()&&console.log(\"###\" \");var o=\"this.getTargetBaseDataID();if(r._$8r==W._$ur&&(r._$8r=t.getBaseDataIndex(o)),r._$8r<0)at._$so&&_._$li(\"_$L\" _$0p _$g :: %s\",o);else{var n=\"t.getBaseData(r._$8r),s=t._$q2(r._$8r);null==n||s._$x2()?r._$AT=!1:(n._$nb(t,s,r._$Cr,r._$hr,this._$d0,U._$i2,U._$No),r._$AT=!0),r.baseOpacity=s.getTotalOpacity()}}}catch(t){throw\" t}},$t.prototype.draw=\"function(t,i,e){if(this!=e._$GT()&&console.log(\"###\" \"),!e._$is[0]){var _$yi( %d ) , _$d0( _$yo( \\n\",this._$lp,this._$d0,this._$yo),console.log(\" _$oi _$di=\"{\" \");for(var t=\"0;t<this._$BP.length;t++)console.log(\"%5d\" ,\",this._$bp[t]);console.log(\"\\n _$5i _$30\");for(var _$30[%d]=\",t);for(var i=this._$Eo[t],e=0;e<i.length;e++)console.log(\" %6.2f, \",i[e])}console.log(\"\\n\")},$t.prototype._$72=\"function(t){return\" null=\"=this._$5P?null:this._$5P[t]},$t.prototype.getIndexArray=function(){return\" this._$bp},ut.prototype=\"new\" mt,ut.prototype.gettransformedpoints=\"function(){return\" null!=\"this._$hr?this._$hr:this._$Cr},pt.prototype._$HT=function(t){this.x=t.x,this.y=t.y},pt.prototype._$HT=function(t,i){this.x=t,this.y=i},ft.prototype=new\" i,ft.loadmodel=\"function(t){var\" ft;return i._$62(e,t),e},ft.loadmodel=\"function(t,e){var\" ft(r);return i._$62(o,t),o},ft._$to=\"function(){return\" new ft},ft._$er=\"function(t){var\" i=\"new\" _$5(\".. _$_r _$t0 _$ri _$_p._$d\");if(0=\"=i.exists())throw\" _$ls(\"_$t0 _$_ _$6 _$ui \"+i._$pl());for(var _$5(e[o]);if(0=\"=n.exists())throw\" \"+n._$pl());r.settexture(o,_$nl._$_o(t,n._$3b()))}return r},ft.prototype.setgl=\"function(t){at.setGL(t)},ft.prototype.setTransform=function(t){this.drawParamWebGL.setTransform(t)},ft.prototype.update=function(){this._$5S.update(),this._$5S.preDraw(this.drawParamWebGL)},ft.prototype.draw=function(){this._$5S.draw(this.drawParamWebGL)},ft.prototype._$K2=function(){this.drawParamWebGL._$K2()},ft.prototype.setTexture=function(t,i){null==this.drawParamWebGL&&_._$li(\"_$Yi\" for qt _$ki _$xs() is _$ui!!\"),this.drawparamwebgl.settexture(t,i)},ft.prototype.settexture=\"function(t,i){null==this.drawParamWebGL&&_._$li(\"_$Yi\" _$ui!!\"),this.drawparamwebgl.settexture(t,i)},ft.prototype._$rs=\"function(){return\" this.drawparamwebgl._$rs()},ft.prototype._$ds=\"function(t){this.drawParamWebGL._$Ds(t)},ft.prototype.getDrawParam=function(){return\" this.drawparamwebgl},ft.prototype.setmatrix=\"function(t){this.drawParamWebGL.setMatrix(t)},ft.prototype.setPremultipliedAlpha=function(t){this.drawParamWebGL.setPremultipliedAlpha(t)},ft.prototype.isPremultipliedAlpha=function(){return\" this.drawparamwebgl.ispremultipliedalpha()},ft.prototype.setanisotropy=\"function(t){this.drawParamWebGL.setAnisotropy(t)},ft.prototype.getAnisotropy=function(){return\" this.drawparamwebgl.getanisotropy()},ct.prototype._$tb=\"function(){return\" this.motions},ct.prototype.startmotion=\"function(t,i){for(var\">startMotion() / start _$K _$3 (m%d)\\n\",r,e._$sr));if(null==t)return-1;e=new dt,e._$w0=t,this.motions.push(e);var n=e._$sr;return this._$eb&&_._$Ji(\"MotionQueueManager[size:%2d]->startMotion() / new _$w0 (m%d)\\n\",r,n),n},ct.prototype.updateParam=function(t){try{for(var i=!1,e=0;e<this.motions.length;e++){var r=\"this.motions[e];if(null!=r){var\" o=\"r._$w0;null!=o?(o.updateParam(t,r),i=!0,r.isFinished()&&(this._$eb&&_._$Ji(\"MotionQueueManager[size:%2d]-\">updateParam() / _$T0 _$w0 (m%d)\\n\",this.motions.length-1,r._$sr),this.motions.splice(e,1),e--)):(this.motions=this.motions.splice(e,1),e--)}else this.motions.splice(e,1),e--}return i}catch(t){return _._$li(t),!0}},ct.prototype.isFinished=function(t){if(arguments.length>=1){for(var i=0;i<this.motions.length;i++){var e=\"this.motions[i];if(null!=e&&(e._$sr==t&&!e.isFinished()))return!1}return!0}for(var\" i=\"0;i<this.motions.length;i++){var\" this.motions.splice(i,1),i--}else this.motions.splice(i,1),i--}return!0},ct.prototype.stopallmotions=\"function(){for(var\" t=\"0;t<this.motions.length;t++){var\" this.motions.splice(t,1),t--}},ct.prototype._$zr=\"function(t){this._$eb=t},ct.prototype._$e=function(){console.log(\"--\" _$r --\\n\");for(var :: %s\\n\",this.motions.length,e.tostring())}},dt._$gs=\"0,dt.prototype.isFinished=function(){return\" this._$9l},dt.prototype._$qs=\"function(t){var\" this._$sr},gt.prototype.setcontext=\"function(t){var\" ,i=\"0;i<9;i++)t+=this.m[i].toFixed(2)+\"\" ,\";return t+=\" }\" },gt.prototype.identity=\"function(){var\" array(0,0));var r=\"this.m;return\" e[0]=\"r[0]*t+r[3]*i+r[6],e[1]=r[1]*t+r[4]*i+r[7],e},gt.prototype._$P2=function(t){t||(t=new\" gt);var null;var u=\"1/$;return\" t.m[0]=\"u*(s*l-h*_),t.m[1]=u*(h*o-r*l),t.m[2]=u*(r*_-s*o),t.m[3]=u*(a*_-n*l),t.m[4]=u*(e*l-a*o),t.m[5]=u*(n*o-e*_),t.m[6]=u*(n*h-a*s),t.m[7]=u*(a*r-e*h),t.m[8]=u*(e*s-n*r),t},gt.prototype.transform=function(t,i,e){null==e&&(e=new\" et,yt._$et=\"null,yt._$tP=new\" object,yt._$2o=\"function(){return\" null=\"=yt._$eT&&(yt._$eT=yt.getID(\"DST_BASE\")),yt._$eT},yt._$27=function(){yt._$tP.clear(),yt._$eT=null},yt.getID=function(t){var\" yt(t),yt._$tp[t]=\"i),i},yt.prototype._$3s=function(){return\" new yt},mt.prototype=\"new\" e,mt._$9r=\"function(t){return\" float32array(t)},mt._$vb=\"function(t){return\" int16array(t)},mt._$cr=\"function(t,i){return\" this._$gr},mt._$as=\"function(t){this._$Gr=t},mt.prototype.getGL=function(){return\" this.gl},mt.prototype.setgl=\"function(t){this.gl=t},mt.prototype.setTransform=function(t){this.transform=t},mt.prototype._$ZT=function(){var\" a=\"(n\">.9&&at.EXPAND_W,this.gl);if(null==this.gl)throw new Error(\"gl is null\");var h=1*this._$C0*n,l=1*this._$tT*n,$=1*this._$WL*n,u=this._$lT*n;if(null!=this.clipBufPre_clipContextMask){a.frontFace(a.CCW),a.useProgram(this.shaderProgram),this._$vS=Tt(a,this._$vS,r),this._$no=Pt(a,this._$no,e),a.enableVertexAttribArray(this.a_position_Loc),a.vertexAttribPointer(this.a_position_Loc,2,a.FLOAT,!1,0,0),this._$NT=Tt(a,this._$NT,o),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.textures[t]),a.uniform1i(this.s_texture0_Loc,1),a.enableVertexAttribArray(this.a_texCoord_Loc),a.vertexAttribPointer(this.a_texCoord_Loc,2,a.FLOAT,!1,0,0),a.uniformMatrix4fv(this.u_matrix_Loc,!1,this.getClipBufPre_clipContextMask().matrixForMask);var p=this.getClipBufPre_clipContextMask().layoutChannelNo,f=this.getChannelFlagAsColor(p);a.uniform4f(this.u_channelFlag,f.r,f.g,f.b,f.a);var c=this.getClipBufPre_clipContextMask().layoutBounds;a.uniform4f(this.u_baseColor_Loc,2*c.x-1,2*c.y-1,2*c._$EL()-1,2*c._$5T()-1),a.uniform1i(this.u_maskFlag_Loc,!0)}else if(null!=this.getClipBufPre_clipContextDraw()){a.useProgram(this.shaderProgramOff),this._$vS=Tt(a,this._$vS,r),this._$no=Pt(a,this._$no,e),a.enableVertexAttribArray(this.a_position_Loc_Off),a.vertexAttribPointer(this.a_position_Loc_Off,2,a.FLOAT,!1,0,0),this._$NT=Tt(a,this._$NT,o),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.textures[t]),a.uniform1i(this.s_texture0_Loc_Off,1),a.enableVertexAttribArray(this.a_texCoord_Loc_Off),a.vertexAttribPointer(this.a_texCoord_Loc_Off,2,a.FLOAT,!1,0,0),a.uniformMatrix4fv(this.u_clipMatrix_Loc_Off,!1,this.getClipBufPre_clipContextDraw().matrixForDraw),a.uniformMatrix4fv(this.u_matrix_Loc_Off,!1,this.matrix4x4),a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,at.fTexture[this.glno]),a.uniform1i(this.s_texture1_Loc_Off,2);var p=this.getClipBufPre_clipContextDraw().layoutChannelNo,f=this.getChannelFlagAsColor(p);a.uniform4f(this.u_channelFlag_Loc_Off,f.r,f.g,f.b,f.a),a.uniform4f(this.u_baseColor_Loc_Off,h,l,$,u)}else a.useProgram(this.shaderProgram),this._$vS=Tt(a,this._$vS,r),this._$no=Pt(a,this._$no,e),a.enableVertexAttribArray(this.a_position_Loc),a.vertexAttribPointer(this.a_position_Loc,2,a.FLOAT,!1,0,0),this._$NT=Tt(a,this._$NT,o),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.textures[t]),a.uniform1i(this.s_texture0_Loc,1),a.enableVertexAttribArray(this.a_texCoord_Loc),a.vertexAttribPointer(this.a_texCoord_Loc,2,a.FLOAT,!1,0,0),a.uniformMatrix4fv(this.u_matrix_Loc,!1,this.matrix4x4),a.uniform4f(this.u_baseColor_Loc,h,l,$,u),a.uniform1i(this.u_maskFlag_Loc,!1);this.culling?this.gl.enable(a.CULL_FACE):this.gl.disable(a.CULL_FACE),this.gl.enable(a.BLEND);var d,g,y,m;if(null!=this.clipBufPre_clipContextMask)d=a.ONE,g=a.ONE_MINUS_SRC_ALPHA,y=a.ONE,m=a.ONE_MINUS_SRC_ALPHA;else switch(s){case $t._$ms:d=a.ONE,g=a.ONE_MINUS_SRC_ALPHA,y=a.ONE,m=a.ONE_MINUS_SRC_ALPHA;break;case $t._$ns:d=a.ONE,g=a.ONE,y=a.ZERO,m=a.ONE;break;case $t._$_s:d=a.DST_COLOR,g=a.ONE_MINUS_SRC_ALPHA,y=a.ZERO,m=a.ONE}a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(d,g,y,m),this.anisotropyExt&&a.texParameteri(a.TEXTURE_2D,this.anisotropyExt.TEXTURE_MAX_ANISOTROPY_EXT,this.maxAnisotropy);var T=e.length;a.drawElements(a.TRIANGLES,T,a.UNSIGNED_SHORT,0),a.bindTexture(a.TEXTURE_2D,null)}},mt.prototype._$Rs=function(){throw new Error(\"_$Rs\")},mt.prototype._$Ds=function(t){throw new Error(\"_$Ds\")},mt.prototype._$K2=function(){for(var t=0;t<this.textures.length;t++){0!=this.textures[t]&&(this.gl._$k2(1,this.textures,t),this.textures[t]=null)}},mt.prototype.settexture=function(t,i){this.textures[t]=i},mt.prototype.initshader=function(){var t=\"this.gl;this.loadShaders2(),this.a_position_Loc=t.getAttribLocation(this.shaderProgram,\"a_position\"),this.a_texCoord_Loc=t.getAttribLocation(this.shaderProgram,\"a_texCoord\"),this.u_matrix_Loc=t.getUniformLocation(this.shaderProgram,\"u_mvpMatrix\"),this.s_texture0_Loc=t.getUniformLocation(this.shaderProgram,\"s_texture0\"),this.u_channelFlag=t.getUniformLocation(this.shaderProgram,\"u_channelFlag\"),this.u_baseColor_Loc=t.getUniformLocation(this.shaderProgram,\"u_baseColor\"),this.u_maskFlag_Loc=t.getUniformLocation(this.shaderProgram,\"u_maskFlag\"),this.a_position_Loc_Off=t.getAttribLocation(this.shaderProgramOff,\"a_position\"),this.a_texCoord_Loc_Off=t.getAttribLocation(this.shaderProgramOff,\"a_texCoord\"),this.u_matrix_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_mvpMatrix\"),this.u_clipMatrix_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_ClipMatrix\"),this.s_texture0_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"s_texture0\"),this.s_texture1_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"s_texture1\"),this.u_channelFlag_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_channelFlag\"),this.u_baseColor_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_baseColor\")},mt.prototype.disposeShader=function(){var\" e=\"this.gl,r=i,o=e.createShader(t);if(null==o)return\" _._$ji(\"_$l0 to create shader\"),null;if(e.shadersource(o,r),e.compileshader(o),!e.getshaderparameter(o,e.compile_status)){var n=\"e.getShaderInfoLog(o);return\" compile shader : \"+n),e.deleteshader(o),null}return o},mt.prototype.loadshaders2=\"function(){var\" vec4 a_position;attribute vec2 a_texcoord;varying v_texcoord;varying v_clippos;uniform mat4 u_mvpmatrix;void main(){ gl_position=\"u_mvpMatrix\" * a_position; v_clippos=\"u_mvpMatrix\" v_texcoord=\"a_texCoord;}\"),!this.vertShader)return\" _._$ji(\"vertex _$li!\"),!1;if(this.vertshaderoff=\"this.compileShader(t.VERTEX_SHADER,\"attribute\" u_mvpmatrix;uniform u_clipmatrix;void ;}\"),!this.vertshaderoff)return _._$ji(\"offvertex _$li!\"),!1;if(this.fragshader=\"this.compileShader(t.FRAGMENT_SHADER,\"precision\" mediump float;varying sampler2d s_texture0;uniform u_channelflag;uniform u_basecolor;uniform bool u_maskflag;void smpcolor; if(u_maskflag){ float isinside=\"step(u_baseColor.x,\" v_clippos.x v_clippos.w) step(u_basecolor.y, v_clippos.y step(v_clippos.x v_clippos.w, u_basecolor.z) step(v_clippos.y u_basecolor.w); smpcolor=\"u_channelFlag\" texture2d(s_texture0 , v_texcoord).a isinside; }else{ v_texcoord) u_basecolor; } gl_fragcolor=\"smpColor;}\"),!this.fragShader)return\" _._$ji(\"fragment _$li!\"),!1;if(this.fragshaderoff=\"this.compileShader(t.FRAGMENT_SHADER,\"precision\" ;varying s_texture1;uniform u_basecolor ;void col_formask=\"texture2D(s_texture0,\" clipmask=\"texture2D(s_texture1,\" v_clippos.xy u_channelflag; maskval=\"clipMask.r\" + clipmask.g clipmask.b clipmask.a; maskval; _._$ji(\"offfragment _$li!\"),!1;if(t.attachshader(this.shaderprogram,this.vertshader),t.attachshader(this.shaderprogram,this.fragshader),t.attachshader(this.shaderprogramoff,this.vertshaderoff),t.attachshader(this.shaderprogramoff,this.fragshaderoff),t.linkprogram(this.shaderprogram),t.linkprogram(this.shaderprogramoff),!t.getprogramparameter(this.shaderprogram,t.link_status)){var i=\"t.getProgramInfoLog(this.shaderProgram);return\" link program: \"+i),this.vertshader&&(t.deleteshader(this.vertshader),this.vertshader=\"0),this.fragShader&&(t.deleteShader(this.fragShader),this.fragShader=0),this.shaderProgram&&(t.deleteProgram(this.shaderProgram),this.shaderProgram=0),this.vertShaderOff&&(t.deleteShader(this.vertShaderOff),this.vertShaderOff=0),this.fragShaderOff&&(t.deleteShader(this.fragShaderOff),this.fragShaderOff=0),this.shaderProgramOff&&(t.deleteProgram(this.shaderProgramOff),this.shaderProgramOff=0),!1}return!0},mt.prototype.createFramebuffer=function(){var\" r=\"t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,i,i),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,r);var\" o=\"t.createTexture();return\" t.bindtexture(t.texture_2d,o),t.teximage2d(t.texture_2d,0,t.rgba,i,i,0,t.rgba,t.unsigned_byte,null),t.texparameteri(t.texture_2d,t.texture_min_filter,t.linear),t.texparameteri(t.texture_2d,t.texture_mag_filter,t.linear),t.texparameteri(t.texture_2d,t.texture_wrap_s,t.clamp_to_edge),t.texparameteri(t.texture_2d,t.texture_wrap_t,t.clamp_to_edge),t.framebuffertexture2d(t.framebuffer,t.color_attachment0,t.texture_2d,o,0),t.bindtexture(t.texture_2d,null),t.bindrenderbuffer(t.renderbuffer,null),t.bindframebuffer(t.framebuffer,null),at.ftexture[this.glno]=\"o,{framebuffer:e,renderbuffer:r,texture:at.fTexture[this.glno]}},St.prototype._$fP=function(){var\" t,i,e,r=\"this._$ST();if(0==(128&r))return\" 255&r;if(0=\"=(128&(t=this._$ST())))return(127&r)<<7|127&t;if(0==(128&(i=this._$ST())))return(127&r)<<14|(127&t)<<7|255&i;if(0==(128&(e=this._$ST())))return(127&r)<<21|(127&t)<<14|(127&i)<<7|255&e;throw\" new lt(\"_$l _$0p _\")},st.prototype.getformatversion=\"function(){return\" this._$s2},st.prototype._$gr=\"function(t){this._$S2=t},St.prototype._$3L=function(){return\" this._$fp()},st.prototype._$mp=\"function(){return\" this._$zt(),this._$f+=\"8,this._$T.getFloat64(this._$F-8)},St.prototype._$_T=function(){return\" this._$zt(),this._$t.getint8(this._$f++)},st.prototype._$9t=\"function(){return\" _$q read long\")},st.prototype._$po=\"function(){return\" this._$zt(),0!=\"this._$T.getInt8(this._$F++)};var\" xt=\"!0;St.prototype._$bT=function(){this._$zT();var\" arraybuffer(2*t);i=\"new\" uint16array(e);for(var string.fromcharcode.apply(null,i)}catch(t){xt=\"!1}try{var\" array;if(null=\"=i)for(var\" for(var string.fromcharcode.apply(null,o)}catch(t){console.log(\"read utf8 _$rt _$l0 !! \"+t)}},st.prototype._$cs=\"function(){this._$zT();for(var\" int32array(t),e=\"0;e<t;e++)i[e]=this._$T.getInt32(this._$F),this._$F+=4;return\" i},st.prototype._$tb=\"function(){this._$zT();for(var\" float32array(t),e=\"0;e<t;e++)i[e]=this._$T.getFloat32(this._$F),this._$F+=4;return\" i},st.prototype._$5b=\"function(){this._$zT();for(var\" float64array(t),e=\"0;e<t;e++)i[e]=this._$T.getFloat64(this._$F),this._$F+=8;return\" i},st.prototype._$np=\"function(){return\" this._$jb(-1)},st.prototype._$jb=\"function(t){if(this._$zT(),t<0&&(t=this._$3L()),t==G._$7P){var\" this._$ko[i];throw lt(\"_$sl _$4i @_$m0\")}var this._$ko.push(e),e},st.prototype._$4b=\"function(t){if(0==t)return\" null;if(50=\"=t){var\" e}if(51=\"=t){var\" e}if(134=\"=t){var\" e}if(60=\"=t){var\" e}if(t>=48){var r=G._$9o(t);return null!=r?(r._$F0(this),r):null}switch(t){case 1:return this._$bT();case 10:return new n(this._$6L(),!0);case 11:return new S(this._$mP(),this._$mP(),this._$mP(),this._$mP());case 12:return new S(this._$_T(),this._$_T(),this._$_T(),this._$_T());case 13:return new L(this._$mP(),this._$mP());case 14:return new L(this._$_T(),this._$_T());case 15:for(var o=this._$3L(),e=new Array(o),s=0;s<o;s++)e[s]=this._$np();return 0=\"=this._$hL?this._$v0=this._$ST():8==this._$hL&&(this._$v0=this._$ST(),this._$hL=0),1==(this._$v0\" e;case 17:var e=\"new\" f(this._$mp(),this._$mp(),this._$mp(),this._$mp(),this._$mp(),this._$mp());return 21:return new h(this._$6l(),this._$6l(),this._$6l(),this._$6l());case 22:return pt(this._$6l(),this._$6l());case 23:throw error(\"_$l _$ro \");case 16:case 25:return this._$cs();case 26:return this._$5b();case 27:return this._$tb();case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 18:case 19:case 20:case 24:case 28:throw lt(\"_$6 _$q : _$np() of 2-9 ,18,19,20,24,28 \"+t);default:throw no _$i \"+t)}},st.prototype._$8l=\"function(){return\">>7-this._$hL++&1)},St.prototype._$zT=function(){0!=this._$hL&&(this._$hL=0)},vt.prototype._$wP=function(t,i,e){for(var r=0;r<e;r++){for(var o=\"0;o<i;o++){var\" n=\"2*(o+r*i);console.log(\"(%\" 7.3f , % 7.3f) \",t[n],t[n+1])}console.log(\"\\n\")}console.log(\"\\n\")},lt._$2s=\"Math.PI/180,Lt._$bS=Math.PI/180,Lt._$wS=180/Math.PI,Lt._$NS=180/Math.PI,Lt.PI_F=Math.PI,Lt._$kT=[0,.012368,.024734,.037097,.049454,.061803,.074143,.086471,.098786,.111087,.12337,.135634,.147877,.160098,.172295,.184465,.196606,.208718,.220798,.232844,.244854,.256827,.268761,.280654,.292503,.304308,.316066,.327776,.339436,.351044,.362598,.374097,.385538,.396921,.408243,.419502,.430697,.441826,.452888,.463881,.474802,.485651,.496425,.507124,.517745,.528287,.538748,.549126,.559421,.56963,.579752,.589785,.599728,.609579,.619337,.629,.638567,.648036,.657406,.666676,.675843,.684908,.693867,.70272,.711466,.720103,.72863,.737045,.745348,.753536,.76161,.769566,.777405,.785125,.792725,.800204,.807561,.814793,.821901,.828884,.835739,.842467,.849066,.855535,.861873,.868079,.874153,.880093,.885898,.891567,.897101,.902497,.907754,.912873,.917853,.922692,.92739,.931946,.936359,.940629,.944755,.948737,.952574,.956265,.959809,.963207,.966457,.96956,.972514,.97532,.977976,.980482,.982839,.985045,.987101,.989006,.990759,.992361,.993811,.995109,.996254,.997248,.998088,.998776,.999312,.999694,.999924,1],Lt._$92=function(t,i){var\" e=\"Math.atan2(t[1],t[0]),r=Math.atan2(i[1],i[0]);return\" lt._$ts(e,r)},lt._$ts=\"function(t,i){for(var\">Math.PI;)e-=2*Math.PI;return e},Lt._$9=function(t){return Math.sin(t)},Lt.fcos=function(t){return Math.cos(t)},Mt.prototype._$u2=function(){return this._$IS[0]},Mt.prototype._$yo=function(){return this._$AT&&!this._$IS[0]},Mt.prototype._$GT=function(){return this._$e0},Et._$W2=0,Et.SYSTEM_INFO=null,Et.USER_AGENT=navigator.userAgent,Et.isIPhone=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isIPhone},Et.isIOS=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isIPhone||Et.SYSTEM_INFO._isIPad},Et.isAndroid=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isAndroid},Et.getOSVersion=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO.version},Et.getOS=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isIPhone||Et.SYSTEM_INFO._isIPad?\"iOS\":Et.SYSTEM_INFO._isAndroid?\"Android\":\"_$Q0 OS\"},Et.setup=function(){function t(t,i){for(var e=t.substring(i).split(/[ _,;\\.]/),r=0,o=0;o<=2&&!isnan(e[o]);o++){var n=\"parseInt(e[o]);if(n<0||n\">999){_._$li(\"err : \"+n+\" @UtHtml5.setup()\"),r=0;break}r+=n*Math.pow(1e3,2-o)}return r}var i,e=Et.USER_AGENT,r=Et.SYSTEM_INFO={userAgent:e};if((i=e.indexOf(\"iPhone OS \"))>=0)r.os=\"iPhone\",r._isIPhone=!0,r.version=t(e,i+\"iPhone OS \".length);else if((i=e.indexOf(\"iPad\"))>=0){if((i=e.indexOf(\"CPU OS\"))<0)return void _._$li(\" err : \"+e+\" @uthtml5.setup()\");r.os=\"iPad\" ,r._isipad=\"!0,r.version=t(e,i+\"CPU\" os \".length)}else(i=\"e.indexOf(\"Android\"))\">=0?(r.os=\"Android\",r._isAndroid=!0,r.version=t(e,i+\"Android \".length)):(r.os=\"-\",r.version=-1)},window.UtSystem=w,window.UtDebug=_,window.LDTransform=gt,window.LDGL=nt,window.Live2D=at,window.Live2DModelWebGL=ft,window.Live2DModelJS=q,window.Live2DMotion=J,window.MotionQueueManager=ct,window.PhysicsHair=f,window.AMotion=s,window.PartsDataID=l,window.DrawDataID=b,window.BaseDataID=yt,window.ParamID=u,at.init();var At=!1}()}).call(i,e(7))},function(t,i){t.exports={import:function(){throw new Error(\"System.import cannot be used indirectly\")}}},function(t,i,e){\"use strict\";function r(t){return t&&t.__esModule?t:{default:t}}function o(){this.models=[],this.count=-1,this.reloadFlg=!1,Live2D.init(),n.Live2DFramework.setPlatformManager(new _.default)}Object.defineProperty(i,\"__esModule\",{value:!0}),i.default=o;var n=e(0),s=e(9),_=r(s),a=e(10),h=r(a),l=e(1),$=r(l);o.prototype.createModel=function(){var t=new h.default;return this.models.push(t),t},o.prototype.changeModel=function(t,i){if(this.reloadFlg){this.reloadFlg=!1;this.releaseModel(0,t),this.createModel(),this.models[0].load(t,i)}},o.prototype.getModel=function(t){return t>=this.models.length?null:this.models[t]},o.prototype.releaseModel=function(t,i){this.models.length<=t||(this.models[t].release(i),delete this.models[t],this.models.splice(t,1))},o.prototype.nummodels=\"function(){return\" this.models.length},o.prototype.setdrag=\"function(t,i){for(var\" e=\"0;e<this.models.length;e++)this.models[e].setDrag(t,i)},o.prototype.maxScaleEvent=function(){$.default.DEBUG_LOG&&console.log(\"Max\" scale event.\");for(var t=\"0;t<this.models.length;t++)this.models[t].startRandomMotion($.default.MOTION_GROUP_PINCH_IN,$.default.PRIORITY_NORMAL)},o.prototype.minScaleEvent=function(){$.default.DEBUG_LOG&&console.log(\"Min\" view x:\"+t+\" y:\"+i);for(var face.\"),this.models[e].setrandomexpression()):this.models[e].hittest($.default.hit_area_body,t,i)?($.default.debug_log&&console.log(\"tap body. models[\"+e+\"]\"),this.models[e].startrandommotion($.default.motion_group_tap_body,$.default.priority_normal)):this.models[e].hittestcustom(\"head\",t,i)?($.default.debug_log&&console.log(\"tap face.\"),this.models[e].startrandommotion($.default.motion_group_flick_head,$.default.priority_normal)):this.models[e].hittestcustom(\"body\",t,i)&&($.default.debug_log&&console.log(\"tap models[\"+e+\"]\"),this.models[e].startrandommotion($.default.motion_group_tap_body,$.default.priority_normal));return!0}},function(t,i,e){\"use strict\";function r(){}object.defineproperty(i,\"__esmodule\",{value:!0}),i.default=\"r;var\" o=\"e(2);r.prototype.loadBytes=function(t,i){var\" xmlhttprequest;e.open(\"get\",t,!0),e.responsetype=\"arraybuffer\" ,e.onload=\"function(){switch(e.status){case\" 200:i(e.response);break;default:console.error(\"failed to load (\"+e.status+\") : \"+t)}},e.send(null)},r.prototype.loadstring=\"function(t){this.loadBytes(t,function(t){return\" t})},r.prototype.loadlive2dmodel=\"function(t,i){var\" n=\"new\" image;n.crossorigin=\"Anonymous\" ,n.src=\"e;n.onload=function(){var\" console.error(\"failed generate gl texture name.\"),-1;0=\"=t.isPremultipliedAlpha()&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D),t.setTexture(i,s),s=null,\"function\"==typeof\" r&&r()},n.onerror=\"function(){console.error(\"Failed\" image \"+e)}},r.prototype.jsonparsefrombytes=\"function(t){var\" i,e=\"new\" uint8array(t,0,3);return i=\"239==e[0]&&187==e[1]&&191==e[2]?String.fromCharCode.apply(null,new\" uint8array(t,3)):string.fromcharcode.apply(null,new uint8array(t)),json.parse(i)},r.prototype.log=\"function(t){}},function(t,i,e){\"use\" r(t){return t&&t.__esmodule?t:{default:t}}function o(){n.l2dbasemodel.prototype.constructor.call(this),this.modelhomedir ,this.modelsetting=\"null,this.tmpMatrix=[]}Object.defineProperty(i,\"__esModule\",{value:!0}),i.default=o;var\" n.l2dbasemodel,o.prototype.load=\"function(t,i,e){this.setUpdating(!0),this.setInitialized(!1),this.modelHomeDir=i.substring(0,i.lastIndexOf(\"/\")+1),this.modelSetting=new\" _.default;var r=\"this;this.modelSetting.loadModelSetting(i,function(){var\" var>0){r.expressions={};for(var t=0;t</=t||(this.models[t].release(i),delete></0)return></=2&&!isnan(e[o]);o++){var></e;r++){for(var></o;s++)e[s]=this._$np();return></this.textures.length;t++){0!=this.textures[t]&&(this.gl._$k2(1,this.textures,t),this.textures[t]=null)}},mt.prototype.settexture=function(t,i){this.textures[t]=i},mt.prototype.initshader=function(){var></this.motions.length;i++){var></this.motions.length;e++){var></1,s=o*u._$no,_=this._$qi[n],a=this._$qi[n+1];i._$cr[s]=_,i._$cr[s+1]=a,i._$cr[s+4]=0,r&&(i._$hr[s]=_,i._$hr[s+1]=a,i._$hr[s+4]=0)}}return></1;this._$qi[n+1]=1-this._$qi[n+1]}break;case></7)return></1?(r[m]=y[$]*(1-u-p)+y[$+2]*u+y[$+2*(c+1)]*p,r[m+1]=y[$+1]*(1-u-p)+y[$+3]*u+y[$+2*(c+1)+1]*p):(r[m]=y[$+2*(c+1)+2]*(u-1+p)+y[$+2*(c+1)]*(1-u)+y[$+2]*(1-p),r[m+1]=y[$+2*(c+1)+3]*(u-1+p)+y[$+2*(c+1)+1]*(1-u)+y[$+3]*(1-p))},z.prototype._$vt=function(){return(this._$o+1)*(this._$a+1)},z.prototype.gettype=function(){return></0?a=0:a></=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else></=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var></=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var></=this.size){var></p&&p-t></=h._$rp&&h._$rp<=b._$ys);else{var></u&&u<121&&(i._$d0=u),o=e[0]}for(;o<r&&(\"\\n\"!=q(t,o)&&\"\\r\"!=q(t,o));++o);}else></r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\"=\"==n){a=o;break}var></o){console.log(\"_$n0></r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></e.length;o++){var></w._$52?w._$52=e:e></this._$sb.length;t++){0!=this._$sb[t]&&(this.gl._$sr(1,this._$sb,t),this._$sb[t]=0)}},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$sb[t]=i},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$u2[t]=i},x.prototype._$ns=function(t){var></e&&(this._$_l=wt.state_closing,this._$bb=e),i=1;break;case></e;++o){var></this._$rr[t]&&(i=this._$rr[t]),i></i;++e){var></v;++s){var></r;++s){var></i;e++){var></=this.size){var></=h._$rp&&h._$rp<=b._$ys);else{var></l&&l<121&&(i._$d0=l),o=e[0]}for(;o<r&&(\"\\n\"!=t[o]&&\"\\r\"!=t[o]);++o);}else></r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\"=\"==n){_=o;break}var></o){console.log(\"_$n0></r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></r;++o){var></r;++a)t[a]=0;for(var></o;_++){var></r;o++)if(o.getchar(t,o)!=e.charat(o-i))return!1;return!0},o.getchar=function(t,i){return></t;);}catch(t){t._$rb()}},w.getusertimemsec=function(){return></16;i++)this.matrix4x4[i]=t[i]},e.prototype._$it=function(){return></0?r=0:r></0?e=0:e></0?i=0:i></0?t=0:t></m._$52?m._$52=e:e></=this.x&&this.y<=this.y&&this.x<=this.x+this.width&&this.y<=this.y+this.height},s.prototype.expand=function(t,i){this.x-=t,this.y-=i,this.width+=2*t,this.height+=2*i},v._$z2=function(t,i,e,r){var></.033&&(i=.033);var></r;++o)console.log(\"%5d\",i[o]),console.log(\"%s\\n\",e),console.log(\",\");console.log(\"\\n\")},_._$rb=function(t){console.log(\"dump></e&&(i._$9l=!0)}},s.prototype.updateparamexe=function(t,i,e,r){},_._$8s=0,_._$ft=new></0){i._$z2=e,i._$bs=e;var></e.channel_count;n++){var></h;l++){var></this.clipcontextlist.length;r++){var></t;i++)this.gl.deleteframebuffer(at.framebuffers[i].framebuffer);at.framebuffers=[],at.glcontext=[]},e.prototype.init=function(t,i,e){for(var></t.length;u++){var></0&&(console.log(\"no></0&&(l=0),s.setpartsopacity(h,l)}else{for(var></3&&(e=1),this._$5s.setparamfloat(t,this._$5s.getparamfloat(t)*(1-e)+i*e)},i.prototype.addtoparamfloat=function(t,i,e){\"number\"!=typeof></this.channel_colors.length;e++)this.dp_webgl.setchannelflagascolor(e,this.channel_colors[e])}}function></t.x&&(s=360-s);var></16;t++)this.currentmatrix[t]=t%5==0?1:0},r.push=function(){var></this.min?this.tr[0]></this.screenright&&(t=this.screenright-this.tr[0]*this.maxright-this.tr[12]),this.tr[5]*this.maxtop+(this.tr[13]+i)<this.screentop&&(i=this.screentop-this.tr[5]*this.maxtop-this.tr[13]),this.tr[5]*this.maxbottom+(this.tr[13]+i)></i.length;e++){var></0&&(r=0,o=1);for(var></n;s++){var></e&&(this.eyestate=g.state_closing,this.statestarttime=e),i=1;break;case></_;a++){var></=i[0]&&r<=t[1]&&r></=u&&u<=s&&_<=p&&p<=a},r.prototype.hittestsimplecustom=function(t,i,e,r){return></_&&(_=$),$></.001&&(t=0),this.alpha=t},r.prototype.getalpha=function(){return>","date":"2020-01-14T19:50:19.358Z","updated":"2020-01-14T19:50:19.354Z","path":"live2d-widget/live2d.min.js","layout":"false","title":"","comments":1,"_id":"ck5obqnbv006h2lwjdaiuboit","content":"!function(t){function i(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}var e={};i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},i.p=\"\",i(i.s=4)}([function(t,i,e){\"use strict\";function r(){this.live2DModel=null,this.modelMatrix=null,this.eyeBlink=null,this.physics=null,this.pose=null,this.debugMode=!1,this.initialized=!1,this.updating=!1,this.alpha=1,this.accAlpha=0,this.lipSync=!1,this.lipSyncValue=0,this.accelX=0,this.accelY=0,this.accelZ=0,this.dragX=0,this.dragY=0,this.startTimeMSec=null,this.mainMotionManager=new h,this.expressionManager=new h,this.motions={},this.expressions={},this.isTexLoaded=!1}function o(){AMotion.prototype.constructor.call(this),this.paramList=new Array}function n(){this.id=\"\",this.type=-1,this.value=null}function s(){this.nextBlinkTime=null,this.stateStartTime=null,this.blinkIntervalMsec=null,this.eyeState=g.STATE_FIRST,this.blinkIntervalMsec=4e3,this.closingMotionMsec=100,this.closedMotionMsec=50,this.openingMotionMsec=150,this.closeIfZero=!0,this.eyeID_L=\"PARAM_EYE_L_OPEN\",this.eyeID_R=\"PARAM_EYE_R_OPEN\"}function _(){this.tr=new Float32Array(16),this.identity()}function a(t,i){_.prototype.constructor.call(this),this.width=t,this.height=i}function h(){MotionQueueManager.prototype.constructor.call(this),this.currentPriority=null,this.reservePriority=null,this.super=MotionQueueManager.prototype}function l(){this.physicsList=new Array,this.startTimeMSec=UtSystem.getUserTimeMSec()}function $(){this.lastTime=0,this.lastModel=null,this.partsGroups=new Array}function u(t){this.paramIndex=-1,this.partsIndex=-1,this.link=null,this.id=t}function p(){this.EPSILON=.01,this.faceTargetX=0,this.faceTargetY=0,this.faceX=0,this.faceY=0,this.faceVX=0,this.faceVY=0,this.lastTimeSec=0}function f(){_.prototype.constructor.call(this),this.screenLeft=null,this.screenRight=null,this.screenTop=null,this.screenBottom=null,this.maxLeft=null,this.maxRight=null,this.maxTop=null,this.maxBottom=null,this.max=Number.MAX_VALUE,this.min=0}function c(){}var d=0;r.prototype.getModelMatrix=function(){return this.modelMatrix},r.prototype.setAlpha=function(t){t>.999&&(t=1),t<.001&&(t=0),this.alpha=t},r.prototype.getalpha=function(){return this.alpha},r.prototype.isinitialized=\"function(){return\" this.initialized},r.prototype.setinitialized=\"function(t){this.initialized=t},r.prototype.isUpdating=function(){return\" this.updating},r.prototype.setupdating=\"function(t){this.updating=t},r.prototype.getLive2DModel=function(){return\" this.live2dmodel},r.prototype.setlipsync=\"function(t){this.lipSync=t},r.prototype.setLipSyncValue=function(t){this.lipSyncValue=t},r.prototype.setAccel=function(t,i,e){this.accelX=t,this.accelY=i,this.accelZ=e},r.prototype.setDrag=function(t,i){this.dragX=t,this.dragY=i},r.prototype.getMainMotionManager=function(){return\" this.mainmotionmanager},r.prototype.getexpressionmanager=\"function(){return\" this.expressionmanager},r.prototype.loadmodeldata=\"function(t,i){var\" e=\"c.getPlatformManager();this.debugMode&&e.log(\" load\" model : \"+t);var r=\"this;e.loadLive2DModel(t,function(t){if(r.live2DModel=t,r.live2DModel.saveParam(),0!=Live2D.getError())return\" void console.error(\"error failed to loadmodeldata().\");r.modelmatrix=\"new\" a(r.live2dmodel.getcanvaswidth(),r.live2dmodel.getcanvasheight()),r.modelmatrix.setwidth(2),r.modelmatrix.setcenterposition(0,0),i(r.live2dmodel)})},r.prototype.loadtexture=\"function(t,i,e){d++;var\" texture \"+i);var o=\"this;r.loadTexture(this.live2DModel,t,i,function(){d--,0==d&&(o.isTexLoaded=!0),\" function\"=\"=typeof\"\" e&&e()})},r.prototype.loadmotion=\"function(t,i,e){var\" motion expression n=\"this;r.loadBytes(i,function(i){null!=t&&(n.expressions[t]=o.loadJson(i)),\" e&&e()})},r.prototype.loadpose=\"function(t,i){var\" pose i&&i()})}catch(t){console.warn(t)}},r.prototype.loadphysics=\"function(t){var\" i=\"c.getPlatformManager();this.debugMode&&i.log(\" physics l=\"o[h],$=o[h+1];l<n&&(n=l),l\">s&&(s=l),$<_&&(_=$),$>a&&(a=$)}var u=this.modelMatrix.invertTransformX(i),p=this.modelMatrix.invertTransformY(e);return n<=u&&u<=s&&_<=p&&p<=a},r.prototype.hittestsimplecustom=function(t,i,e,r){return null!=\"=this.live2DModel&&(e\">=t[0]&&e<=i[0]&&r<=t[1]&&r>=i[1])},o.prototype=new AMotion,o.EXPRESSION_DEFAULT=\"DEFAULT\",o.TYPE_SET=0,o.TYPE_ADD=1,o.TYPE_MULT=2,o.loadJson=function(t){var i=new o,e=c.getPlatformManager(),r=e.jsonParseFromBytes(t);if(i.setFadeIn(parseInt(r.fade_in)>0?parseInt(r.fade_in):1e3),i.setFadeOut(parseInt(r.fade_out)>0?parseInt(r.fade_out):1e3),null==r.params)return i;var s=r.params,_=s.length;i.paramList=[];for(var a=0;a<_;a++){var h=\"s[a],l=h.id.toString(),$=parseFloat(h.val),u=o.TYPE_ADD,p=null!=h.calc?h.calc.toString():\" add\";if((u=\"add\" ==\"=p?o.TYPE_ADD:\"mult\"===p?o.TYPE_MULT:\"set\"===p?o.TYPE_SET:o.TYPE_ADD)==o.TYPE_ADD){var\"\" f=\"null==h.def?0:parseFloat(h.def);$-=f}else\" if(u=\"=o.TYPE_MULT){var\" d=\"new\" n;d.id=\"l,d.type=u,d.value=$,i.paramList.push(d)}return\" i},o.prototype.updateparamexe=\"function(t,i,e,r){for(var\" n=\"this.paramList.length-1;n\">=0;--n){var s=this.paramList[n];s.type==o.TYPE_ADD?t.addToParamFloat(s.id,s.value,e):s.type==o.TYPE_MULT?t.multParamFloat(s.id,s.value,e):s.type==o.TYPE_SET&&t.setParamFloat(s.id,s.value,e)}},s.prototype.calcNextBlink=function(){return UtSystem.getUserTimeMSec()+Math.random()*(2*this.blinkIntervalMsec-1)},s.prototype.setInterval=function(t){this.blinkIntervalMsec=t},s.prototype.setEyeMotion=function(t,i,e){this.closingMotionMsec=t,this.closedMotionMsec=i,this.openingMotionMsec=e},s.prototype.updateParam=function(t){var i,e=UtSystem.getUserTimeMSec(),r=0;switch(this.eyeState){case g.STATE_CLOSING:r=(e-this.stateStartTime)/this.closingMotionMsec,r>=1&&(r=1,this.eyeState=g.STATE_CLOSED,this.stateStartTime=e),i=1-r;break;case g.STATE_CLOSED:r=(e-this.stateStartTime)/this.closedMotionMsec,r>=1&&(this.eyeState=g.STATE_OPENING,this.stateStartTime=e),i=0;break;case g.STATE_OPENING:r=(e-this.stateStartTime)/this.openingMotionMsec,r>=1&&(r=1,this.eyeState=g.STATE_INTERVAL,this.nextBlinkTime=this.calcNextBlink()),i=r;break;case g.STATE_INTERVAL:this.nextBlinkTime<e&&(this.eyestate=g.state_closing,this.statestarttime=e),i=1;break;case g.state_first:default:this.eyestate=\"g.STATE_INTERVAL,this.nextBlinkTime=this.calcNextBlink(),i=1}this.closeIfZero||(i=-i),t.setParamFloat(this.eyeID_L,i),t.setParamFloat(this.eyeID_R,i)};var\" g=\"function(){};g.STATE_FIRST=\" state_first\",g.state_interval=\"STATE_INTERVAL\" ,g.state_closing=\"STATE_CLOSING\" ,g.state_closed=\"STATE_CLOSED\" ,g.state_opening=\"STATE_OPENING\" ,_.mul=\"function(t,i,e){var\"\" r,o,n,s=\"[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<4;r++)for(o=0;o<4;o++)for(n=0;n<4;n++)s[r+4*o]+=t[r+4*n]*i[n+4*o];for(r=0;r<16;r++)e[r]=s[r]},_.prototype.identity=function(){for(var\" t=\"0;t<16;t++)this.tr[t]=t%5==0?1:0},_.prototype.getArray=function(){return\" this.tr},_.prototype.getcopymatrix=\"function(){return\" new float32array(this.tr)},_.prototype.setmatrix=\"function(t){if(null!=this.tr&&this.tr.length==this.tr.length)for(var\" i=\"0;i<16;i++)this.tr[i]=t[i]},_.prototype.getScaleX=function(){return\" this.tr[0]},_.prototype.getscaley=\"function(){return\" this.tr[5]},_.prototype.transformx=\"function(t){return\" this.tr[0]*t+this.tr[12]},_.prototype.transformy=\"function(t){return\" this.tr[5]*t+this.tr[13]},_.prototype.inverttransformx=\"function(t){return(t-this.tr[12])/this.tr[0]},_.prototype.invertTransformY=function(t){return(t-this.tr[13])/this.tr[5]},_.prototype.multTranslate=function(t,i){var\" e=\"[1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1];_.mul(e,this.tr,this.tr)},_.prototype.translate=function(t,i){this.tr[12]=t,this.tr[13]=i},_.prototype.translateX=function(t){this.tr[12]=t},_.prototype.translateY=function(t){this.tr[13]=t},_.prototype.multScale=function(t,i){var\" _,a.prototype.setposition=\"function(t,i){this.translate(t,i)},a.prototype.setCenterPosition=function(t,i){var\" motionqueuemanager,h.prototype.getcurrentpriority=\"function(){return\" this.currentpriority},h.prototype.getreservepriority=\"function(){return\" this.reservepriority},h.prototype.reservemotion=\"function(t){return!(this.reservePriority\">=t)&&(!(this.currentPriority>=t)&&(this.reservePriority=t,!0))},h.prototype.setReservePriority=function(t){this.reservePriority=t},h.prototype.updateParam=function(t){var i=MotionQueueManager.prototype.updateParam.call(this,t);return this.isFinished()&&(this.currentPriority=0),i},h.prototype.startMotionPrio=function(t,i){return i==this.reservePriority&&(this.reservePriority=0),this.currentPriority=i,this.startMotion(t,!1)},l.load=function(t){for(var i=new l,e=c.getPlatformManager(),r=e.jsonParseFromBytes(t),o=r.physics_hair,n=o.length,s=0;s<n;s++){var _=\"o[s],a=new\" physicshair,h=\"_.setup,$=parseFloat(h.length),u=parseFloat(h.regist),p=parseFloat(h.mass);a.setup($,u,p);for(var\" f=\"_.src,d=f.length,g=0;g<d;g++){var\" y=\"f[g],m=y.id,T=PhysicsHair.Src.SRC_TO_X,P=y.ptype;\" x\"=\"==P?T=PhysicsHair.Src.SRC_TO_X:\"y\"===P?T=PhysicsHair.Src.SRC_TO_Y:\"angle\"===P?T=PhysicsHair.Src.SRC_TO_G_ANGLE:UtDebug.error(\"live2d\",\"Invalid\"\" parameter:physicshair.src\");var s=\"parseFloat(y.scale),v=parseFloat(y.weight);a.addSrcParam(T,m,S,v)}for(var\" l=\"_.targets,M=L.length,g=0;g<M;g++){var\" e=\"L[g],m=E.id,T=PhysicsHair.Target.TARGET_FROM_ANGLE,P=E.ptype;\" angle\"=\"==P?T=PhysicsHair.Target.TARGET_FROM_ANGLE:\"angle_v\"===P?T=PhysicsHair.Target.TARGET_FROM_ANGLE_V:UtDebug.error(\"live2d\",\"Invalid\"\" parameter:physicshair.target\");var i},l.prototype.updateparam=\"function(t){for(var\" i=\"UtSystem.getUserTimeMSec()-this.startTimeMSec,e=0;e<this.physicsList.length;e++)this.physicsList[e].update(t,i)},$.load=function(t){for(var\" $,e=\"c.getPlatformManager(),r=e.jsonParseFromBytes(t),o=r.parts_visible,n=o.length,s=0;s<n;s++){for(var\" array,p=\"0;p<h;p++){var\" u(f.id);if(l[p]=\"d,null!=f.link){var\" g=\"f.link,y=g.length;d.link=new\" array;for(var m=\"0;m<y;m++){var\" t=\"new\" u(g[m]);d.link.push(t)}}}i.partsgroups.push(l)}return i},$.prototype.updateparam=\"function(t){if(null!=t){t!=this.lastModel&&this.initParam(t),this.lastModel=t;var\" r=\"0;r<this.partsGroups.length;r++)this.normalizePartsOpacityGroup(t,this.partsGroups[r],e),this.copyOpacityOtherParts(t,this.partsGroups[r])}},$.prototype.initParam=function(t){if(null!=t)for(var\" o=\"e[r].partsIndex,n=e[r].paramIndex;if(!(o<0)){var\">=0)break;r=n,o=t.getPartsOpacity(s),o+=e/.5,o>1&&(o=1)}}r<0&&(r=0,o=1);for(var n=\"0;n<i.length;n++){var\" s=\"i[n].partsIndex;if(!(s<0))if(r==n)t.setPartsOpacity(s,o);else{var\" a,h=\"t.getPartsOpacity(s);a=o<.5?-.5*o/.5+1:.5*(1-o)/.5;var\" l=\"(1-a)*(1-o);l\">.15&&(a=1-.15/(1-o)),h>a&&(h=a),t.setPartsOpacity(s,h)}}},$.prototype.copyOpacityOtherParts=function(t,i){for(var e=0;e<i.length;e++){var r=\"i[e];if(null!=r.link&&!(r.partsIndex<0))for(var\" o=\"t.getPartsOpacity(r.partsIndex),n=0;n<r.link.length;n++){var\" s=\"r.link[n];s.partsIndex<0||t.setPartsOpacity(s.partsIndex,o)}}},u.prototype.initIndex=function(t){this.paramIndex=t.getParamIndex(\" visible:\"+this.id),this.partsindex=\"t.getPartsDataIndex(PartsDataID.getID(this.id)),t.setParamFloat(this.paramIndex,1)},p.FRAME_RATE=30,p.prototype.setPoint=function(t,i){this.faceTargetX=t,this.faceTargetY=i},p.prototype.getX=function(){return\"\" this.facex},p.prototype.gety=\"function(){return\" this.facey},p.prototype.update=\"function(){var\" t=\"40/7.5/p.FRAME_RATE;if(0==this.lastTimeSec)return\" void(this.lasttimesec=\"UtSystem.getUserTimeMSec());var\" i=\"UtSystem.getUserTimeMSec(),e=(i-this.lastTimeSec)*p.FRAME_RATE/1e3;this.lastTimeSec=i;var\" _=\"Math.sqrt(n*n+s*s),a=t*n/_,h=t*s/_,l=a-this.faceVX,$=h-this.faceVY,u=Math.sqrt(l*l+$*$);(u<-o||u\">o)&&(l*=o/u,$*=o/u,u=o),this.faceVX+=l,this.faceVY+=$;var f=.5*(Math.sqrt(o*o+16*o*_-8*o*_)-o),c=Math.sqrt(this.faceVX*this.faceVX+this.faceVY*this.faceVY);c>f&&(this.faceVX*=f/c,this.faceVY*=f/c),this.faceX+=this.faceVX,this.faceY+=this.faceVY}},f.prototype=new _,f.prototype.getMaxScale=function(){return this.max},f.prototype.getMinScale=function(){return this.min},f.prototype.setMaxScale=function(t){this.max=t},f.prototype.setMinScale=function(t){this.min=t},f.prototype.isMaxScale=function(){return this.getScaleX()==this.max},f.prototype.isMinScale=function(){return this.getScaleX()==this.min},f.prototype.adjustTranslate=function(t,i){this.tr[0]*this.maxLeft+(this.tr[12]+t)>this.screenLeft&&(t=this.screenLeft-this.tr[0]*this.maxLeft-this.tr[12]),this.tr[0]*this.maxRight+(this.tr[12]+t)<this.screenright&&(t=this.screenright-this.tr[0]*this.maxright-this.tr[12]),this.tr[5]*this.maxtop+(this.tr[13]+i)<this.screentop&&(i=this.screentop-this.tr[5]*this.maxtop-this.tr[13]),this.tr[5]*this.maxbottom+(this.tr[13]+i)>this.screenBottom&&(i=this.screenBottom-this.tr[5]*this.maxBottom-this.tr[13]);var e=[1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1];_.mul(e,this.tr,this.tr)},f.prototype.adjustScale=function(t,i,e){var r=e*this.tr[0];r<this.min?this.tr[0]>0&&(e=this.min/this.tr[0]):r>this.max&&this.tr[0]>0&&(e=this.max/this.tr[0]);var o=[1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1],n=[e,0,0,0,0,e,0,0,0,0,1,0,0,0,0,1],s=[1,0,0,0,0,1,0,0,0,0,1,0,-t,-i,0,1];_.mul(s,this.tr,this.tr),_.mul(n,this.tr,this.tr),_.mul(o,this.tr,this.tr)},f.prototype.setScreenRect=function(t,i,e,r){this.screenLeft=t,this.screenRight=i,this.screenTop=r,this.screenBottom=e},f.prototype.setMaxScreenRect=function(t,i,e,r){this.maxLeft=t,this.maxRight=i,this.maxTop=r,this.maxBottom=e},f.prototype.getScreenLeft=function(){return this.screenLeft},f.prototype.getScreenRight=function(){return this.screenRight},f.prototype.getScreenBottom=function(){return this.screenBottom},f.prototype.getScreenTop=function(){return this.screenTop},f.prototype.getMaxLeft=function(){return this.maxLeft},f.prototype.getMaxRight=function(){return this.maxRight},f.prototype.getMaxBottom=function(){return this.maxBottom},f.prototype.getMaxTop=function(){return this.maxTop},c.platformManager=null,c.getPlatformManager=function(){return c.platformManager},c.setPlatformManager=function(t){c.platformManager=t},t.exports={L2DTargetPoint:p,Live2DFramework:c,L2DViewMatrix:f,L2DPose:$,L2DPartsParam:u,L2DPhysics:l,L2DMotionManager:h,L2DModelMatrix:a,L2DMatrix44:_,EYE_STATE:g,L2DEyeBlink:s,L2DExpressionParam:n,L2DExpressionMotion:o,L2DBaseModel:r}},function(t,i,e){\"use strict\";var r={DEBUG_LOG:!1,DEBUG_MOUSE_LOG:!1,DEBUG_DRAW_HIT_AREA:!1,DEBUG_DRAW_ALPHA_MODEL:!1,VIEW_MAX_SCALE:2,VIEW_MIN_SCALE:.8,VIEW_LOGICAL_LEFT:-1,VIEW_LOGICAL_RIGHT:1,VIEW_LOGICAL_MAX_LEFT:-2,VIEW_LOGICAL_MAX_RIGHT:2,VIEW_LOGICAL_MAX_BOTTOM:-2,VIEW_LOGICAL_MAX_TOP:2,PRIORITY_NONE:0,PRIORITY_IDLE:1,PRIORITY_SLEEPY:2,PRIORITY_NORMAL:3,PRIORITY_FORCE:4,MOTION_GROUP_IDLE:\"idle\",MOTION_GROUP_SLEEPY:\"sleepy\",MOTION_GROUP_TAP_BODY:\"tap_body\",MOTION_GROUP_FLICK_HEAD:\"flick_head\",MOTION_GROUP_PINCH_IN:\"pinch_in\",MOTION_GROUP_PINCH_OUT:\"pinch_out\",MOTION_GROUP_SHAKE:\"shake\",HIT_AREA_HEAD:\"head\",HIT_AREA_BODY:\"body\"};t.exports=r},function(t,i,e){\"use strict\";function r(t){n=t}function o(){return n}Object.defineProperty(i,\"__esModule\",{value:!0}),i.setContext=r,i.getContext=o;var n=void 0},function(t,i,e){\"use strict\";function r(){}r.matrixStack=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.depth=0,r.currentMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.tmp=new Array(16),r.reset=function(){this.depth=0},r.loadIdentity=function(){for(var t=0;t<16;t++)this.currentmatrix[t]=t%5==0?1:0},r.push=function(){var t=\"(this.depth,16*(this.depth+1));this.matrixStack.length<t+16&&(this.matrixStack.length=t+16);for(var\" i=\"0;i<16;i++)this.matrixStack[t+i]=this.currentMatrix[i];this.depth++},r.pop=function(){--this.depth<0&&(myError(\" invalid\" matrix stack.\"),this.depth=\"0);for(var\" this.currentmatrix},r.multmatrix=\"function(t){var\" i,e,r;for(i=\"0;i<16;i++)this.tmp[i]=0;for(i=0;i<4;i++)for(e=0;e<4;e++)for(r=0;r<4;r++)this.tmp[i+4*e]+=this.currentMatrix[i+4*r]*t[r+4*e];for(i=0;i<16;i++)this.currentMatrix[i]=this.tmp[i]},t.exports=r},function(t,i,e){t.exports=e(5)},function(t,i,e){\" use\" strict\";function r(t){return t&&t.__esmodule?t:{default:t}}function o(t){c=\"document.getElementById(t),C.addEventListener&&(window.addEventListener(\" click\",g),window.addeventlistener(\"mousedown\",g),window.addeventlistener(\"mousemove\",g),window.addeventlistener(\"mouseup\",g),document.addeventlistener(\"mouseout\",g),window.addeventlistener(\"touchstart\",y),window.addeventlistener(\"touchend\",y),window.addeventlistener(\"touchmove\",y))}function\" n(t){var m.l2dtargetpoint;var r=\"e/i,o=w.default.VIEW_LOGICAL_LEFT,n=w.default.VIEW_LOGICAL_RIGHT,_=-r,h=r;if(window.Live2D.captureFrame=!1,B=new\" m.l2dviewmatrix,b.setscreenrect(o,n,_,h),b.setmaxscreenrect(w.default.view_logical_max_left,w.default.view_logical_max_right,w.default.view_logical_max_bottom,w.default.view_logical_max_top),b.setmaxscale(w.default.view_max_scale),b.setminscale(w.default.view_min_scale),u=\"new\" m.l2dmatrix44,u.multscale(1,i e),g=\"new\" m.l2dmatrix44,g.multtranslate(-i 2,-e 2),g.multscale(2 i,-2 i),f=\"v(),(0,D.setContext)(F),!F)return\" console.error(\"failed to create webgl context.\"),void(window.webglrenderingcontext&&console.error(\"your browser don't support webgl, check https: get.webgl.org for futher information.\"));window.live2d.setgl(f),f.clearcolor(0,0,0,0),a(t),s()}function s(){b||(b=\"!0,function\" t(){_();var e=\"document.createElement(\" a\");document.body.appendchild(e),e.setattribute(\"type\",\"hidden\"),e.href=\"C.toDataURL(),e.download=window.Live2D.captureName||\"live2d.png\",e.click()}i(t,C)}())}function\"\" _(){o.default.reset(),o.default.loadidentity(),n.update(),r.setdrag(n.getx(),n.gety()),f.clear(f.color_buffer_bit),o.default.multmatrix(u.getarray()),o.default.multmatrix(b.getarray()),o.default.push();for(var a(t){r.reloadflg=\"!0,R.count++,R.changeModel(F,t)}function\" h(t,i){return t.x*i.x+t.y*i.y}function l(t,i){var $(t,i,e){function r(t,i){return 180*math.acos(h({x:0,y:1},l(t,i))) math.pi}if(i.x<e.left+e.width&&i.y<e.top+e.height&&i.x>e.left&&i.y>e.top)return i;var o=t.x-i.x,n=t.y-i.y,s=r(o,n);i.x<t.x&&(s=360-s);var 0=\"==e?.5:e,o(t),n(i)}e(6);var\" _=\"360-r(e.left-t.x,-1*(e.top-t.y)),a=360-r(e.left-t.x,-1*(e.top+e.height-t.y)),$=r(e.left+e.width-t.x,-1*(e.top-t.y)),u=r(e.left+e.width-t.x,-1*(e.top+e.height-t.y)),p=n/o,f={};if(s<$){var\" c=\"e.top-t.y,d=c/p;f={y:t.y+c,x:t.x+d}}else\" if(s<u){var g=\"e.left+e.width-t.x,y=g*p;f={y:t.y+y,x:t.x+g}}else\" if(s<a){var m=\"e.top+e.height-t.y,T=m/p;f={y:t.y+m,x:t.x+T}}else\" if(s<_){var p=\"t.x-e.left,S=P*p;f={y:t.y-S,x:t.x-P}}else{var\" v=\"e.top-t.y,L=v/p;f={y:t.y+v,x:t.x+L}}return\" f}function u(t){y=\"!0;var\" i=\"C.getBoundingClientRect(),e=P(t.clientX-i.left),r=S(t.clientY-i.top),o=$({x:i.left+i.width/2,y:i.top+i.height*X},{x:t.clientX,y:t.clientY},i),n=m(o.x-i.left),s=T(o.y-i.top);w.default.DEBUG_MOUSE_LOG&&console.log(\" onmousemove\" device( x:\"+t.clientx+\" y:\"+t.clienty+\" ) view( x:\"+n+\" y:\"+s+\")\"),k=\"e,V=r,N.setPoint(n,s)}function\" p(t){y=\"!0;var\" f(t){var y:\"+s+\")\"),y&&(k=\"e,V=r,N.setPoint(n,s))}function\" c(){y&&(y=\"!1),N.setPoint(0,0)}function\" d(){w.default.debug_log&&console.log(\"set session storage.\"),sessionstorage.setitem(\"sleepy\",\"1\")}function g(t){if(\"mousewheel\"=\"=t.type);else\" if(\"mousedown\"=\"=t.type)p(t);else\" if(\"mousemove\"=\"=t.type){var\" if(\"mouseup\"=\"=t.type){if(\" button\"in\" t&&0!=\"t.button)return}else\" if(\"mouseout\"=\"=t.type){w.default.DEBUG_LOG&&console.log(\" mouse\" out window.\"),c();var e=\"sessionStorage.getItem(\" sleepytimer\");window.cleartimeout(e),e=\"window.setTimeout(d,5e4),sessionStorage.setItem(\"SleepyTimer\",e)}}function\"\" y(t){var m(t){var b.inverttransformx(i)}function t(t){var b.inverttransformy(i)}function p(t){return g.transformx(t)}function s(t){return g.transformy(t)}function v(){for(var t=\"[\" webgl\",\"experimental-webgl\",\"webkit-3d\",\"moz-webgl\"],i=\"0;i<t.length;i++)try{var\"\" e}catch(t){}return null}function l(t,i,e){x=\"void\" a.default),b=\"!1,F=null,C=null,N=null,B=null,U=null,G=null,Y=!1,k=0,V=0,X=.5;window.loadlive2d=L},function(t,i,e){\" use\" strict\";(function(t){!function(){function i(){at||(this._$mt=\"null,this._$5S=null,this._$NP=0,i._$42++,this._$5S=new\" y(this))}function e(t){if(!at){this.clipcontextlist=\"new\" array,this.glcontext=\"t.gl,this.dp_webgl=t,this.curFrameNo=0,this.firstError_clipInNotUpdate=!0,this.colorBuffer=0,this.isInitGLFBFunc=!1,this.tmpBoundsOnModel=new\" s,at.glcontext.length>at.frameBuffers.length&&(this.curFrameNo=this.getMaskRenderTexture()),this.tmpModelToViewMatrix=new R,this.tmpMatrix2=new R,this.tmpMatrixForMask=new R,this.tmpMatrixForDraw=new R,this.CHANNEL_COLORS=new Array;var i=new A;i=new A,i.r=0,i.g=0,i.b=0,i.a=1,this.CHANNEL_COLORS.push(i),i=new A,i.r=1,i.g=0,i.b=0,i.a=0,this.CHANNEL_COLORS.push(i),i=new A,i.r=0,i.g=1,i.b=0,i.a=0,this.CHANNEL_COLORS.push(i),i=new A,i.r=0,i.g=0,i.b=1,i.a=0,this.CHANNEL_COLORS.push(i);for(var e=0;e<this.channel_colors.length;e++)this.dp_webgl.setchannelflagascolor(e,this.channel_colors[e])}}function r(t,i,e){this.clipidlist=\"new\" array,this.clipidlist=\"e,this.clippingMaskDrawIndexList=new\" array;for(var r=\"0;r<e.length;r++)this.clippingMaskDrawIndexList.push(i.getDrawDataIndex(e[r]));this.clippedDrawContextList=new\" array,this.isusing=\"!0,this.layoutChannelNo=0,this.layoutBounds=new\" s,this.allclippeddrawrect=\"new\" s,this.matrixformask=\"new\" float32array(16),this.matrixfordraw=\"new\" float32array(16),this.owner=\"t}function\" o(t,i){this._$gp=\"t,this.drawDataIndex=i}function\" n(){at||(this.color=\"null)}function\" s(){at||(this._$dp=\"null,this._$eo=null,this._$V0=null,this._$dP=1e3,this._$eo=1e3,this._$V0=1,this._$a0())}function\" _(){}function a(){this._$r=\"null,this._$0S=null}function\" h(){at||(this.x=\"null,this.y=null,this.width=null,this.height=null)}function\" l(t){at||et.prototype.constructor.call(this,t)}function $(){}function u(t){at||et.prototype.constructor.call(this,t)}function p(){at||(this._$vo=\"null,this._$F2=null,this._$ao=400,this._$1S=400,p._$42++)}function\" f(){at||(this.p1=\"new\" c,this.p2=\"new\" c,this._$fo=\"0,this._$Db=0,this._$L2=0,this._$M2=0,this._$ks=0,this._$9b=0,this._$iP=0,this._$iT=0,this._$lL=new\" array,this._$qp=\"new\" array,this.setup(.3,.5,.1))}function c(){this._$p=\"1,this.x=0,this.y=0,this.vx=0,this.vy=0,this.ax=0,this.ay=0,this.fx=0,this.fy=0,this._$s0=0,this._$70=0,this._$7L=0,this._$HL=0}function\" d(t,i,e){this._$wl=\"null,this.scale=null,this._$V0=null,this._$wL=t,this.scale=i,this._$V0=e}function\" g(t,i,e,r){d.prototype.constructor.call(this,i,e,r),this._$tl=\"null,this._$tL=t}function\" y(t,i,e){this._$wl=\"null,this.scale=null,this._$V0=null,this._$wL=t,this.scale=i,this._$V0=e}function\" t(t,i,e,r){y.prototype.constructor.call(this,i,e,r),this._$yp=\"null,this._$YP=t}function\" p(){at||(this._$fl=\"0,this._$gL=0,this._$B0=1,this._$z0=1,this._$qT=0,this.reflectX=!1,this.reflectY=!1)}function\" s(){at||(this.x=\"null,this.y=null,this.width=null,this.height=null)}function\" v(){}function l(){at||(this.x=\"null,this.y=null)}function\" m(){at||(this._$gp=\"null,this._$dr=null,this._$GS=null,this._$qb=null,this._$Lb=null,this._$mS=null,this.clipID=null,this.clipIDList=new\" array)}function e(){at||(this._$eb=\"E._$ps,this._$lT=1,this._$C0=1,this._$tT=1,this._$WL=1,this.culling=!1,this.matrix4x4=new\" float32array(16),this.premultipliedalpha=\"!1,this.anisotropy=0,this.clippingProcess=E.CLIPPING_PROCESS_NONE,this.clipBufPre_clipContextMask=null,this.clipBufPre_clipContextDraw=null,this.CHANNEL_COLORS=new\" a(){at||(this.a=\"1,this.r=1,this.g=1,this.b=1,this.scale=1,this._$ho=1,this.blendMode=at.L2D_COLOR_BLEND_MODE_MULT)}function\" i(){at||(this._$kp=\"null,this._$dr=null,this._$Ai=!0,this._$mS=null)}function\" w(){}function x(){at||(this._$vp=\"0,this._$wL=null,this._$GP=null,this._$8o=x._$ds,this._$2r=-1,this._$O2=0,this._$ri=0)}function\" o(){}function d(){at||(this._$ob=\"null)}function\" r(){this.m=\"new\" float32array(16),this.identity()}function b(t){at||et.prototype.constructor.call(this,t)}function f(){at||(this._$7=\"1,this._$f=0,this._$H=0,this._$g=1,this._$k=0,this._$w=0,this._$hi=STATE_IDENTITY,this._$Z=_$pS)}function\" c(){at||(s.prototype.constructor.call(this),this.motions=\"new\" array,this._$7r=\"null,this._$7r=C._$Co++,this._$D0=30,this._$yT=0,this._$E=!0,this.loopFadeIn=!0,this._$AS=-1,_$a0())}function\" n(){this._$p=\"new\" float32array(100),this.size=\"0}function\" b(){this._$4p=\"null,this._$I0=null,this._$RP=null}function\" u(){}function g(){}function y(t){at||(this._$qt=\"!0,this._$co=-1,this._$qo=0,this._$pb=new\" array(y._$is),this._$_2=\"new\" float32array(y._$is),this._$vr=\"new\" float32array(y._$is),this._$rr=\"new\" float32array(y._$is),this._$or=\"new\" float32array(y._$is),this._$fs=\"new\" float32array(y._$is),this._$js=\"new\" array(y._$is),this._$3s=\"new\" array,this._$as=\"new\" array,this._$bo=\"null,this._$F2=new\" array,this._$db=\"new\" array,this._$8b=\"new\" array,this._$hr=\"new\" array,this._$ws=\"null,this._$Vs=null,this._$Er=null,this._$Es=new\" int16array(u._$qb),this._$zp=\"new\" float32array(2*u._$1r),this._$ri=\"t,this._$b0=Y._$HP++,this.clipManager=null,this.dp_webgl=null)}function\" k(){}function v(){at||(this._$12=\"null,this._$bb=null,this._$_L=null,this._$jo=null,this._$iL=null,this._$0L=null,this._$Br=null,this._$Dr=null,this._$Cb=null,this._$mr=null,this._$_L=wt.STATE_FIRST,this._$Br=4e3,this._$Dr=100,this._$Cb=50,this._$mr=150,this._$jo=!0,this._$iL=\" param_eye_l_open\",this._$0l=\"PARAM_EYE_R_OPEN\" )}function\" x(){at||(e.prototype.constructor.call(this),this._$sb=\"new\" int32array(x._$as),this._$u2=\"new\" array,this.transform=\"null,this.gl=null,null==X._$NT&&(X._$NT=X._$9r(256),X._$vS=X._$9r(256),X._$no=X._$vb(256)))}function\" z(){at||(i.prototype.constructor.call(this),this._$gs=\"null,this._$Y0=null)}function\" h(t){_t.prototype.constructor.call(this,t),this._$8r=\"I._$ur,this._$Yr=null,this._$Wr=null}function\" w(){at||(m.prototype.constructor.call(this),this._$gp=\"null,this._$dr=null,this._$GS=null,this._$qb=null,this._$Lb=null,this._$mS=null)}function\" j(){at||(this._$nl=\"null,this._$3S=null,this._$aS=null,j._$42++)}function\" q(){at||(i.prototype.constructor.call(this),this._$zo=\"new\" x)}function j(){at||(s.prototype.constructor.call(this),this.motions=\"new\" array,this._$o2=\"null,this._$7r=J._$Co++,this._$D0=30,this._$yT=0,this._$E=!1,this.loopFadeIn=!0,this._$rr=-1,this._$eP=0)}function\" q(t,i){return string.fromcharcode(t.getuint8(i))}function z(){at||(i.prototype.constructor.call(this),this._$o=\"0,this._$A=0,this._$GS=null,this._$Eo=null)}function\" k(t){_t.prototype.constructor.call(this,t),this._$8r=\"I._$ur,this._$Cr=null,this._$hr=null}function\" tt(){at||(this.visible=\"!0,this._$g0=!1,this._$NL=null,this._$3S=null,this._$aS=null,tt._$42++)}function\" it(t){this._$vs=\"null,this._$e0=null,this._$e0=t}function\" et(t){at||(this.id=\"t)}function\" rt(){}function ot(){at||(this._$4s=\"null)}function\" nt(t,i){this.canvas=\"t,this.context=i,this.viewport=new\" array(0,0,t.width,t.height),this._$6r=\"1,this._$xP=0,this._$3r=1,this._$uP=0,this._$Qo=-1,this.cacheImages={}}function\" st(){at||(this._$tt=\"null,this._$LT=null,this._$FS=null,this._$wL=null)}function\" _t(t){at||(this._$e0=\"null,this._$IP=null,this._$JS=!1,this._$AT=!0,this._$e0=t,this.totalScale=1,this._$7s=1,this.totalOpacity=1)}function\" at(){}function ht(){}function lt(t){at||(this._$ib=\"t)}function\" $t(){at||(w.prototype.constructor.call(this),this._$lp=\"-1,this._$d0=0,this._$Yo=0,this._$JP=null,this._$5P=null,this._$BP=null,this._$Eo=null,this._$Qi=null,this._$6s=$t._$ms,this.culling=!0,this.gl_cacheImage=null,this.instanceNo=$t._$42++)}function\" ut(t){mt.prototype.constructor.call(this,t),this._$8r=\"W._$ur,this._$Cr=null,this._$hr=null}function\" pt(){at||(this.x=\"null,this.y=null)}function\" ft(t){at||(i.prototype.constructor.call(this),this.drawparamwebgl=\"new\" mt(t),this.drawparamwebgl.setgl(at.getgl(t)))}function ct(){at||(this.motions=\"null,this._$eb=!1,this.motions=new\" dt(){this._$w0=\"null,this._$AT=!0,this._$9L=!1,this._$z2=-1,this._$bs=-1,this._$Do=-1,this._$sr=null,this._$sr=dt._$Gs++}function\" gt(){this.m=\"new\" array(1,0,0,0,1,0,0,0,1)}function yt(t){at||et.prototype.constructor.call(this,t)}function mt(t){at||(e.prototype.constructor.call(this),this.textures=\"new\" tt(t,i,e){return null=\"=i&&(i=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,e,t.DYNAMIC_DRAW),i}function\" pt(t,i,e){return st(t){at||(this._$p=\"new\" int8array(8),this._$r0=\"new\" dataview(this._$p.buffer),this._$3i=\"new\" int8array(1e3),this._$hl=\"0,this._$v0=0,this._$S2=0,this._$Ko=new\" array,this._$t=\"t,this._$F=0)}function\" vt(){}function lt(){}function mt(t){at||(this._$e0=\"null,this._$IP=null,this._$Us=null,this._$7s=null,this._$IS=[!1],this._$VS=null,this._$AT=!0,this.baseOpacity=1,this.clipBufPre_clipContext=null,this._$e0=t)}function\" et(){}var at=\"!0;i._$0s=1,i._$4s=2,i._$42=0,i._$62=function(t,e){try{if(e\" instanceof arraybuffer&&(e=\"new\" dataview(e)),!(e dataview))throw new lt(\"_$ss#loadmodel(b) b _$x be dataview or arraybuffer\");var r,o=\"new\" st(e),n=\"o._$ST(),s=o._$ST(),a=o._$ST();if(109!=n||111!=s||99!=a)throw\" lt(\"_$gi _$c _$li , _$q0 _$p0.\");if(r=\"o._$ST(),o._$gr(r),r\">G._$T7){t._$NP|=i._$4s;throw new lt(\"_$gi _$C _$li , _$n0 _$_ version _$li ( SDK : \"+G._$T7+\" < _$f0 : \"+r+\" )@_$SS#loadModel()\\n\")}var h=o._$nP();if(r>=G._$s7){var l=o._$9T(),$=o._$9T();if(-30584!=l||-30584!=$)throw t._$NP|=i._$0s,new lt(\"_$gi _$C _$li , _$0 _$6 _$Ui.\")}t._$KS(h);var u=t.getModelContext();u.setDrawParam(t.getDrawParam()),u.init()}catch(t){_._$Rb(t)}},i.prototype._$KS=function(t){this._$MT=t},i.prototype.getModelImpl=function(){return null==this._$MT&&(this._$MT=new p,this._$MT._$zP()),this._$MT},i.prototype.getCanvasWidth=function(){return null==this._$MT?0:this._$MT.getCanvasWidth()},i.prototype.getCanvasHeight=function(){return null==this._$MT?0:this._$MT.getCanvasHeight()},i.prototype.getParamFloat=function(t){return\"number\"!=typeof t&&(t=this._$5S.getParamIndex(u.getID(t))),this._$5S.getParamFloat(t)},i.prototype.setParamFloat=function(t,i,e){\"number\"!=typeof t&&(t=this._$5S.getParamIndex(u.getID(t))),arguments.length<3&&(e=1),this._$5s.setparamfloat(t,this._$5s.getparamfloat(t)*(1-e)+i*e)},i.prototype.addtoparamfloat=function(t,i,e){\"number\"!=typeof t&&(t=\"this._$5S.getParamIndex(u.getID(t))),arguments.length<3&&(e=1),this._$5S.setParamFloat(t,this._$5S.getParamFloat(t)+i*e)},i.prototype.multParamFloat=function(t,i,e){\" number\"!=\"typeof\"\" this._$5s.getparamindex(u.getid(t))},i.prototype.loadparam=\"function(){this._$5S.loadParam()},i.prototype.saveParam=function(){this._$5S.saveParam()},i.prototype.init=function(){this._$5S.init()},i.prototype.update=function(){this._$5S.update()},i.prototype._$Rs=function(){return\" _._$li(\"_$60 _$pt _$rs()\"),-1},i.prototype._$ds=\"function(t){_._$li(\" _$60\" _$ss#_$ds() \\n\")},i.prototype._$k2=\"function(){},i.prototype.draw=function(){},i.prototype.getModelContext=function(){return\" this._$5s},i.prototype._$s2=\"function(){return\" this._$np},i.prototype._$p7=\"function(t,i,e,r){var\" o=\"-1,n=0,s=this;if(0!=e)if(1==t.length){var\" _=\"t[0],a=0!=s.getParamFloat(_),h=i[0],l=s.getPartsOpacity(h),$=e/r;a?(l+=$)\">1&&(l=1):(l-=$)<0&&(l=0),s.setpartsopacity(h,l)}else{for(var u=\"0;u<t.length;u++){var\" _=\"t[u],p=0!=s.getParamFloat(_);if(p){if(o\">=0)break;o=u;var h=i[u];n=s.getPartsOpacity(h),n+=e/r,n>1&&(n=1)}}o<0&&(console.log(\"no _$wi _$q0 _$u default[%s]\",t[0]),o=\"0,n=1,s.loadParam(),s.setParamFloat(t[o],n),s.saveParam());for(var\" u=\"0;u<t.length;u++){var\" h=\"i[u];if(o==u)s.setPartsOpacity(h,n);else{var\" f,c=\"s.getPartsOpacity(h);f=n<.5?-.5*n/.5+1:.5*(1-n)/.5;var\" d=\"(1-f)*(1-n);d\">.15&&(f=1-.15/(1-n)),c>f&&(c=f),s.setPartsOpacity(h,c)}}}else for(var u=0;u<t.length;u++){var _=\"t[u],h=i[u],p=0!=s.getParamFloat(_);s.setPartsOpacity(h,p?1:0)}},i.prototype.setPartsOpacity=function(t,i){\" number\"!=\"typeof\"\" t&&(t=\"this._$5S.getPartsDataIndex(l.getID(t))),this._$5S.setPartsOpacity(t,i)},i.prototype.getPartsDataIndex=function(t){return\" t instanceof l||(t=\"l.getID(t)),this._$5S.getPartsDataIndex(t)},i.prototype.getPartsOpacity=function(t){return\" this._$5s.getdrawdataindex(b.getid(t))},i.prototype.getdrawdata=\"function(t){return\" this._$5s.getdrawdata(t)},i.prototype.gettransformedpoints=\"function(t){var\" i=\"this._$5S._$C2(t);return\" ut?i.gettransformedpoints():null},i.prototype.getindexarray=\"function(t){if(t<0||t\">=this._$5S._$aS.length)return null;var i=this._$5S._$aS[t];return null!=i&&i.getType()==W._$wb&&i instanceof $t?i.getIndexArray():null},e.CHANNEL_COUNT=4,e.RENDER_TEXTURE_USE_MIPMAP=!1,e.NOT_USED_FRAME=-100,e.prototype._$L7=function(){if(this.tmpModelToViewMatrix&&(this.tmpModelToViewMatrix=null),this.tmpMatrix2&&(this.tmpMatrix2=null),this.tmpMatrixForMask&&(this.tmpMatrixForMask=null),this.tmpMatrixForDraw&&(this.tmpMatrixForDraw=null),this.tmpBoundsOnModel&&(this.tmpBoundsOnModel=null),this.CHANNEL_COLORS){for(var t=this.CHANNEL_COLORS.length-1;t>=0;--t)this.CHANNEL_COLORS.splice(t,1);this.CHANNEL_COLORS=[]}this.releaseShader()},e.prototype.releaseShader=function(){for(var t=at.frameBuffers.length,i=0;i<t;i++)this.gl.deleteframebuffer(at.framebuffers[i].framebuffer);at.framebuffers=[],at.glcontext=[]},e.prototype.init=function(t,i,e){for(var o=\"0;o<i.length;o++){var\" n=\"i[o].getClipIDList();if(null!=n){var\" s=\"this.findSameClip(n);null==s&&(s=new\" r(this,t,n),this.clipcontextlist.push(s));var _=\"i[o].getDrawDataID(),a=t.getDrawDataIndex(_);s.addClippedDrawData(_,a);e[o].clipBufPre_clipContext=s}}},e.prototype.getMaskRenderTexture=function(){var\" t=\"null;return\" e=\"0,r=0;r<this.clipContextList.length;r++){var\">0){var n=i.gl.getParameter(i.gl.FRAMEBUFFER_BINDING),s=new Array(4);s[0]=0,s[1]=0,s[2]=i.gl.canvas.width,s[3]=i.gl.canvas.height,i.gl.viewport(0,0,at.clippingMaskBufferSize,at.clippingMaskBufferSize),this.setupLayoutBounds(e),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,at.frameBuffers[this.curFrameNo].framebuffer),i.gl.clearColor(0,0,0,0),i.gl.clear(i.gl.COLOR_BUFFER_BIT);for(var r=0;r<this.clipcontextlist.length;r++){var o=\"this.clipContextList[r],_=o.allClippedDrawRect,a=(o.layoutChannelNo,o.layoutBounds);this.tmpBoundsOnModel._$jL(_),this.tmpBoundsOnModel.expand(.05*_.width,.05*_.height);var\" h=\"a.width/this.tmpBoundsOnModel.width,l=a.height/this.tmpBoundsOnModel.height;this.tmpMatrix2.identity(),this.tmpMatrix2.translate(-1,-1,0),this.tmpMatrix2.scale(2,2,1),this.tmpMatrix2.translate(a.x,a.y,0),this.tmpMatrix2.scale(h,l,1),this.tmpMatrix2.translate(-this.tmpBoundsOnModel.x,-this.tmpBoundsOnModel.y,0),this.tmpMatrixForMask.setMatrix(this.tmpMatrix2.m),this.tmpMatrix2.identity(),this.tmpMatrix2.translate(a.x,a.y,0),this.tmpMatrix2.scale(h,l,1),this.tmpMatrix2.translate(-this.tmpBoundsOnModel.x,-this.tmpBoundsOnModel.y,0),this.tmpMatrixForDraw.setMatrix(this.tmpMatrix2.m);for(var\" $=\"this.tmpMatrixForMask.getArray(),u=0;u<16;u++)o.matrixForMask[u]=$[u];for(var\" p=\"this.tmpMatrixForDraw.getArray(),u=0;u<16;u++)o.matrixForDraw[u]=p[u];for(var\" f=\"o.clippingMaskDrawIndexList.length,c=0;c<f;c++){var\" d=\"o.clippingMaskDrawIndexList[c],g=t.getDrawData(d),y=t._$C2(d);i.setClipBufPre_clipContextForMask(o),g.draw(i,t,y)}}i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,n),i.setClipBufPre_clipContextForMask(null),i.gl.viewport(s[0],s[1],s[2],s[3])}},e.prototype.getColorBuffer=function(){return\" this.colorbuffer},e.prototype.findsameclip=\"function(t){for(var\" i=\"0;i<this.clipContextList.length;i++){var\" e=\"this.clipContextList[i],r=e.clipIDList.length;if(r==t.length){for(var\" s=\"e.clipIDList[n],_=0;_<r;_++)if(t[_]==s){o++;break}if(o==r)return\" e}}return null},e.prototype.calcclippeddrawtotalbounds=\"function(t,i){for(var\">r?e:r,n=o,s=o,_=0,a=0,h=i.clippedDrawContextList.length,l=0;l<h;l++){var $=\"i.clippedDrawContextList[l],u=$.drawDataIndex,p=t._$C2(u);if(p._$yo()){for(var\" f=\"p.getTransformedPoints(),c=f.length,d=[],g=[],y=0,m=U._$i2;m<c;m+=U._$No)d[y]=f[m],g[y]=f[m+1],y++;var\" t=\"Math.min.apply(null,d),P=Math.min.apply(null,g),S=Math.max.apply(null,d),v=Math.max.apply(null,g);T<n&&(n=T),P<s&&(s=P),S\">_&&(_=S),v>a&&(a=v)}}if(n==o)i.allClippedDrawRect.x=0,i.allClippedDrawRect.y=0,i.allClippedDrawRect.width=0,i.allClippedDrawRect.height=0,i.isUsing=!1;else{var L=_-n,M=a-s;i.allClippedDrawRect.x=n,i.allClippedDrawRect.y=s,i.allClippedDrawRect.width=L,i.allClippedDrawRect.height=M,i.isUsing=!0}},e.prototype.setupLayoutBounds=function(t){var i=t/e.CHANNEL_COUNT,r=t%e.CHANNEL_COUNT;i=~~i,r=~~r;for(var o=0,n=0;n<e.channel_count;n++){var s=\"i+(n<r?1:0);if(0==s);else\" if(1=\"=s){var\" a=\"this.clipContextList[o++];a.layoutChannelNo=n,a.layoutBounds.x=0,a.layoutBounds.y=0,a.layoutBounds.width=1,a.layoutBounds.height=1}else\" if(2=\"=s)for(var\" h=\"0;h<s;h++){var\" l=\"h%2,$=0;l=~~l;var\" if(s<=\"4)for(var\" _._$li(\"_$6 _$0p mask count : %d\",s)}},r.prototype.addclippeddrawdata=\"function(t,i){var\" e=\"new\" o(t,i);this.clippeddrawcontextlist.push(e)},s._$jt=\"function(t,i,e){var\" r=\"t/i,o=e/i,n=o,s=1-(1-o)*(1-o),_=1-(1-n)*(1-n),a=1/3*(1-o)*s+(n*(2/3)+1/3*(1-n))*(1-s),h=(n+2/3*(1-n))*_+(o*(1/3)+2/3*(1-o))*(1-_),l=1-3*h+3*a-0,$=3*h-6*a+0,u=3*a-0;if(r<=0)return\" 0;if(r>=1)return 1;var p=r,f=p*p;return l*(p*f)+$*f+u*p+0},s.prototype._$a0=function(){},s.prototype.setFadeIn=function(t){this._$dP=t},s.prototype.setFadeOut=function(t){this._$eo=t},s.prototype._$pT=function(t){this._$V0=t},s.prototype.getFadeOut=function(){return this._$eo},s.prototype._$4T=function(){return this._$eo},s.prototype._$mT=function(){return this._$V0},s.prototype.getDurationMSec=function(){return-1},s.prototype.getLoopDurationMSec=function(){return-1},s.prototype.updateParam=function(t,i){if(i._$AT&&!i._$9L){var e=w.getUserTimeMSec();if(i._$z2<0){i._$z2=e,i._$bs=e;var r=\"this.getDurationMSec();i._$Do<0&&(i._$Do=r<=0?-1:i._$z2+r)}var\" o=\"this._$V0;o=o*(0==this._$dP?1:ht._$r2((e-i._$bs)/this._$dP))*(0==this._$eo||i._$Do<0?1:ht._$r2((i._$Do-e)/this._$eo)),0<=o&&o<=1||console.log(\" ###\" assert!! ### \"),this.updateparamexe(t,e,o,i),i._$do>0&&i._$Do<e&&(i._$9l=!0)}},s.prototype.updateparamexe=function(t,i,e,r){},_._$8s=0,_._$ft=new object,_.start=\"function(t){var\" i=\"_._$fT[t];null==i&&(i=new\" a,i._$r=\"t,_._$fT[t]=i),i._$0S=w.getSystemTimeMSec()},_.dump=function(t){var\" e=\"w.getSystemTimeMSec(),r=e-i._$0S;return\" console.log(t+\" : \"+r+\"ms\"),r}return-1},_.end=\"function(t){var\" w.getsystemtimemsec()-i._$0s}return-1},_._$li=\"function(t,i){console.log(\" _$li\" \"+t+\"\\n\",i)},_._$ji=\"function(t,i){console.log(t,i)},_._$dL=function(t,i){console.log(t,i),console.log(\" \\n\")},_._$kl=\"function(t,i){for(var\"\">0?console.log(\"\\n\"):e%8==0&&e>0&&console.log(\"  \"),console.log(\"%02X \",255&t[e]);console.log(\"\\n\")},_._$nr=function(t,i,e){console.log(\"%s\\n\",t);for(var r=i.length,o=0;o<r;++o)console.log(\"%5d\",i[o]),console.log(\"%s\\n\",e),console.log(\",\");console.log(\"\\n\")},_._$rb=function(t){console.log(\"dump exception : \"+t),console.log(\"stack :: \"+t.stack)},h.prototype._$8p=\"function(){return.5*(this.x+this.x+this.width)},h.prototype._$6P=function(){return.5*(this.y+this.y+this.height)},h.prototype._$EL=function(){return\" this.x+this.width},h.prototype._$5t=\"function(){return\" this.y+this.height},h.prototype._$jl=\"function(t,i,e,r){this.x=t,this.y=i,this.width=e,this.height=r},h.prototype._$jL=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},l.prototype=new\" et,l._$tp=\"new\" object,l._$27=\"function(){l._$tP.clear()},l.getID=function(t){var\" i=\"l._$tP[t];return\" null=\"=i&&(i=new\" l(t),l._$tp[t]=\"i),i},l.prototype._$3s=function(){return\" new l},u.prototype=\"new\" et,u._$tp=\"new\" object,u._$27=\"function(){u._$tP.clear()},u.getID=function(t){var\" u(t),u._$tp[t]=\"i),i},u.prototype._$3s=function(){return\" u},p._$42=\"0,p.prototype._$zP=function(){null==this._$vo&&(this._$vo=new\" ot),null=\"=this._$F2&&(this._$F2=new\" array)},p.prototype.getcanvaswidth=\"function(){return\" this._$ao},p.prototype.getcanvasheight=\"function(){return\" this._$1s},p.prototype._$f0=\"function(t){this._$vo=t._$nP(),this._$F2=t._$nP(),this._$ao=t._$6L(),this._$1S=t._$6L()},p.prototype._$6S=function(t){this._$F2.push(t)},p.prototype._$Xr=function(){return\" this._$f2},p.prototype._$e2=\"function(){return\" this._$vo},f.prototype.setup=\"function(t,i,e){this._$ks=this._$Yb(),this.p2._$xT(),3==arguments.length&&(this._$Fo=t,this._$L2=i,this.p1._$p=e,this.p2._$p=e,this.p2.y=t,this.setup())},f.prototype.getPhysicsPoint1=function(){return\" this.p1},f.prototype.getphysicspoint2=\"function(){return\" this.p2},f.prototype._$qr=\"function(){return\" this._$db},f.prototype._$pr=\"function(t){this._$Db=t},f.prototype._$5r=function(){return\" this._$m2},f.prototype._$cs=\"function(){return\" this._$9b},f.prototype._$yb=\"function(){return-180*Math.atan2(this.p1.x-this.p2.x,-(this.p1.y-this.p2.y))/Math.PI},f.prototype.addSrcParam=function(t,i,e,r){var\" o=\"new\" g(t,i,e,r);this._$ll.push(o)},f.prototype.addtargetparam=\"function(t,i,e,r){var\" t(t,i,e,r);this._$qp.push(o)},f.prototype.update=\"function(t,i){if(0==this._$iP)return\" this._$ip=\"this._$iT=i,void(this._$Fo=Math.sqrt((this.p1.x-this.p2.x)*(this.p1.x-this.p2.x)+(this.p1.y-this.p2.y)*(this.p1.y-this.p2.y)));var\" e=\"(i-this._$iT)/1e3;if(0!=e){for(var\" r=\"this._$lL.length-1;r\">=0;--r){this._$lL[r]._$oP(t,this)}this._$oo(t,e),this._$M2=this._$Yb(),this._$9b=(this._$M2-this._$ks)/e,this._$ks=this._$M2}for(var r=this._$qP.length-1;r>=0;--r){this._$qP[r]._$YS(t,this)}this._$iT=i},f.prototype._$oo=function(t,i){i<.033&&(i=.033);var e=\"1/i;this.p1.vx=(this.p1.x-this.p1._$s0)*e,this.p1.vy=(this.p1.y-this.p1._$70)*e,this.p1.ax=(this.p1.vx-this.p1._$7L)*e,this.p1.ay=(this.p1.vy-this.p1._$HL)*e,this.p1.fx=this.p1.ax*this.p1._$p,this.p1.fy=this.p1.ay*this.p1._$p,this.p1._$xT();var\" r,o,n=\"-Math.atan2(this.p1.y-this.p2.y,this.p1.x-this.p2.x),s=Math.cos(n),_=Math.sin(n),a=9.8*this.p2._$p,h=this._$Db*Lt._$bS,l=a*Math.cos(n-h);r=l*_,o=l*s;var\" $=\"-this.p1.fx*_*_,u=-this.p1.fy*_*s,p=-this.p2.vx*this._$L2,f=-this.p2.vy*this._$L2;this.p2.fx=r+$+p,this.p2.fy=o+u+f,this.p2.ax=this.p2.fx/this.p2._$p,this.p2.ay=this.p2.fy/this.p2._$p,this.p2.vx+=this.p2.ax*i,this.p2.vy+=this.p2.ay*i,this.p2.x+=this.p2.vx*i,this.p2.y+=this.p2.vy*i;var\" c=\"Math.sqrt((this.p1.x-this.p2.x)*(this.p1.x-this.p2.x)+(this.p1.y-this.p2.y)*(this.p1.y-this.p2.y));this.p2.x=this.p1.x+this._$Fo*(this.p2.x-this.p1.x)/c,this.p2.y=this.p1.y+this._$Fo*(this.p2.y-this.p1.y)/c,this.p2.vx=(this.p2.x-this.p2._$s0)*e,this.p2.vy=(this.p2.y-this.p2._$70)*e,this.p2._$xT()},c.prototype._$xT=function(){this._$s0=this.x,this._$70=this.y,this._$7L=this.vx,this._$HL=this.vy},d.prototype._$oP=function(t,i){},g.prototype=new\" d,g.prototype._$op=\"function(t,i){var\" f.src.src_to_x:r.x=\"r.x+(e-r.x)*this._$V0;break;case\" f.src.src_to_y:r.y=\"r.y+(e-r.y)*this._$V0;break;case\" f.src.src_to_g_angle:var o=\"i._$qr();o+=(e-o)*this._$V0,i._$pr(o)}},y.prototype._$YS=function(t,i){},T.prototype=new\" y,t.prototype._$ys=\"function(t,i){switch(this._$YP){default:case\" f.target.target_from_angle:t.setparamfloat(this._$wl,this.scale*i._$5r(),this._$v0);break;case f.target.target_from_angle_v:t.setparamfloat(this._$wl,this.scale*i._$cs(),this._$v0)}},f.src=\"function(){},f.Src.SRC_TO_X=\" src_to_x\",f.src.src_to_y=\"SRC_TO_Y\" ,f.src.src_to_g_angle=\"SRC_TO_G_ANGLE\" ,f.target=\"function(){},f.Target.TARGET_FROM_ANGLE=\"TARGET_FROM_ANGLE\",f.Target.TARGET_FROM_ANGLE_V=\"TARGET_FROM_ANGLE_V\",P.prototype.init=function(t){this._$fL=t._$fL,this._$gL=t._$gL,this._$B0=t._$B0,this._$z0=t._$z0,this._$qT=t._$qT,this.reflectX=t.reflectX,this.reflectY=t.reflectY},P.prototype._$F0=function(t){this._$fL=t._$_T(),this._$gL=t._$_T(),this._$B0=t._$_T(),this._$z0=t._$_T(),this._$qT=t._$_T(),t.getFormatVersion()\"\">=G.LIVE2D_FORMAT_VERSION_V2_10_SDK2&&(this.reflectX=t._$po(),this.reflectY=t._$po())},P.prototype._$e=function(){};var It=function(){};It._$ni=function(t,i,e,r,o,n,s,_,a){var h=s*n-_*o;if(0==h)return null;var l,$=((t-e)*n-(i-r)*o)/h;return l=0!=o?(t-e-$*s)/o:(i-r-$*_)/n,isNaN(l)&&(l=(t-e-$*s)/o,isNaN(l)&&(l=(i-r-$*_)/n),isNaN(l)&&(console.log(\"a is NaN @UtVector#_$ni() \"),console.log(\"v1x : \"+o),console.log(\"v1x != 0 ? \"+(0!=o)))),null==a?new Array(l,$):(a[0]=l,a[1]=$,a)},S.prototype._$8P=function(){return this.x+.5*this.width},S.prototype._$6P=function(){return this.y+.5*this.height},S.prototype._$EL=function(){return this.x+this.width},S.prototype._$5T=function(){return this.y+this.height},S.prototype._$jL=function(t,i,e,r){this.x=t,this.y=i,this.width=e,this.height=r},S.prototype._$jL=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},S.prototype.contains=function(t,i){return this.x<=this.x&&this.y<=this.y&&this.x<=this.x+this.width&&this.y<=this.y+this.height},s.prototype.expand=function(t,i){this.x-=t,this.y-=i,this.width+=2*t,this.height+=2*i},v._$z2=function(t,i,e,r){var o=\"i._$Q2(t,e),n=t._$vs(),s=t._$Tr();if(i._$zr(n,s,o),o<=0)return\" r[n[0]];if(1=\"=o){var\" _=\"r[n[0]],a=r[n[1]],h=s[0];return\" _+(a-_)*h|0}if(2=\"=o){var\" p+(f-p)*u|0}if(3=\"=o){var\" c=\"r[n[0]],d=r[n[1]],g=r[n[2]],y=r[n[3]],m=r[n[4]],T=r[n[5]],P=r[n[6]],S=r[n[7]],h=s[0],u=s[1],v=s[2],_=c+(d-c)*h|0,a=g+(y-g)*h|0,l=m+(T-m)*h|0,$=P+(S-P)*h|0,p=_+(a-_)*u|0,f=l+($-l)*u|0;return\" p+(f-p)*v|0}if(4=\"=o){var\" l=\"r[n[0]],M=r[n[1]],E=r[n[2]],A=r[n[3]],I=r[n[4]],w=r[n[5]],x=r[n[6]],O=r[n[7]],D=r[n[8]],R=r[n[9]],b=r[n[10]],F=r[n[11]],C=r[n[12]],N=r[n[13]],B=r[n[14]],U=r[n[15]],h=s[0],u=s[1],v=s[2],G=s[3],c=L+(M-L)*h|0,d=E+(A-E)*h|0,g=I+(w-I)*h|0,y=x+(O-x)*h|0,m=D+(R-D)*h|0,T=b+(F-b)*h|0,P=C+(N-C)*h|0,S=B+(U-B)*h|0,_=c+(d-c)*u|0,a=g+(y-g)*u|0,l=m+(T-m)*u|0,$=P+(S-P)*u|0,p=_+(a-_)*v|0,f=l+($-l)*v|0;return\" p+(f-p)*g|0}for(var y=\"1<<o,k=new\" float32array(y),v=\"0;V<Y;V++){for(var\" x=\"V,z=1,H=0;H<o;H++)z*=X%2==0?1-s[H]:s[H],X/=2;k[V]=z}for(var\" w=\"new\" float32array(y),j=\"0;j<Y;j++)W[j]=r[n[j]];for(var\" q=\"0,j=0;j<Y;j++)q+=k[j]*W[j];return\" q+.5|0},v._$br=\"function(t,i,e,r){var\" _+(a-_)*h}if(2=\"=o){var\" p=\"r[n[0]],f=r[n[1]],c=r[n[2]],d=r[n[3]],g=r[n[4]],y=r[n[5]],m=r[n[6]],T=r[n[7]],h=s[0],u=s[1],P=s[2];return(1-P)*((1-u)*(p+(f-p)*h)+u*(c+(d-c)*h))+P*((1-u)*(g+(y-g)*h)+u*(m+(T-m)*h))}if(4==o){var\" s=\"r[n[0]],v=r[n[1]],L=r[n[2]],M=r[n[3]],E=r[n[4]],A=r[n[5]],I=r[n[6]],w=r[n[7]],x=r[n[8]],O=r[n[9]],D=r[n[10]],R=r[n[11]],b=r[n[12]],F=r[n[13]],C=r[n[14]],N=r[n[15]],h=s[0],u=s[1],P=s[2],B=s[3];return(1-B)*((1-P)*((1-u)*(S+(v-S)*h)+u*(L+(M-L)*h))+P*((1-u)*(E+(A-E)*h)+u*(I+(w-I)*h)))+B*((1-P)*((1-u)*(x+(O-x)*h)+u*(D+(R-D)*h))+P*((1-u)*(b+(F-b)*h)+u*(C+(N-C)*h)))}for(var\" u=\"1<<o,G=new\" float32array(u),y=\"0;Y<U;Y++){for(var\" k=\"Y,V=1,X=0;X<o;X++)V*=k%2==0?1-s[X]:s[X],k/=2;G[Y]=V}for(var\" z=\"new\" float32array(u),h=\"0;H<U;H++)z[H]=r[n[H]];for(var\" w},v._$vr=\"function(t,i,e,r,o,n,s,_){var\" a=\"i._$Q2(t,e),h=t._$vs(),l=t._$Tr();i._$zr(h,l,a);var\" $=\"2*r,u=s;if(a<=0){var\" for(var if(1=\"=a)for(var\" f=\"o[h[0]],d=o[h[1]],g=l[0],y=1-g,c=0;c<$;)n[u]=f[c]*y+d[c]*g,++c,n[u+1]=f[c]*y+d[c]*g,++c,u+=_;else\" if(2=\"=a)for(var\" if(3=\"=a)for(var\" if(4=\"=a)for(var\" h=\"o[h[0]],W=o[h[1]],j=o[h[2]],q=o[h[3]],J=o[h[4]],Q=o[h[5]],Z=o[h[6]],K=o[h[7]],tt=o[h[8]],it=o[h[9]],et=o[h[10]],rt=o[h[11]],ot=o[h[12]],nt=o[h[13]],st=o[h[14]],_t=o[h[15]],g=l[0],P=l[1],C=l[2],at=l[3],y=1-g,S=1-P,N=1-C,ht=1-at,lt=ht*N*S*y,$t=ht*N*S*g,ut=ht*N*P*y,pt=ht*N*P*g,ft=ht*C*S*y,ct=ht*C*S*g,dt=ht*C*P*y,gt=ht*C*P*g,yt=at*N*S*y,mt=at*N*S*g,Tt=at*N*P*y,Pt=at*N*P*g,St=at*C*S*y,vt=at*C*S*g,Lt=at*C*P*y,Mt=at*C*P*g,c=0;c<$;)n[u]=lt*H[c]+$t*W[c]+ut*j[c]+pt*q[c]+ft*J[c]+ct*Q[c]+dt*Z[c]+gt*K[c]+yt*tt[c]+mt*it[c]+Tt*et[c]+Pt*rt[c]+St*ot[c]+vt*nt[c]+Lt*st[c]+Mt*_t[c],++c,n[u+1]=lt*H[c]+$t*W[c]+ut*j[c]+pt*q[c]+ft*J[c]+ct*Q[c]+dt*Z[c]+gt*K[c]+yt*tt[c]+mt*it[c]+Tt*et[c]+Pt*rt[c]+St*ot[c]+vt*nt[c]+Lt*st[c]+Mt*_t[c],++c,u+=_;else{for(var\" et=\"1<<a,At=new\" float32array(et),it=\"0;It<Et;It++){for(var\" wt=\"It,xt=1,Ot=0;Ot<a;Ot++)xt*=wt%2==0?1-l[Ot]:l[Ot],wt/=2;At[It]=xt}for(var\" dt=\"new\" float32array(et),rt=\"0;Rt<Et;Rt++)Dt[Rt]=o[h[Rt]];for(var\" bt=\"0,Ft=0,Ct=c+1,Rt=0;Rt<Et;Rt++)bt+=At[Rt]*Dt[Rt][c],Ft+=At[Rt]*Dt[Rt][Ct];c+=2,n[u]=bt,n[u+1]=Ft,u+=_}}},L.prototype._$HT=function(t,i){this.x=t,this.y=i},L.prototype._$HT=function(t){this.x=t.x,this.y=t.y},M._$ur=-2,M._$ES=500,M._$wb=2,M._$8S=3,M._$52=M._$ES,M._$R2=M._$ES,M._$or=function(){return\" m._$52},m._$pr=\"function(){return\" m._$r2},m.prototype.convertclipidforv2_11=\"function(t){var\" i=\"[];return\" null=\"=t?null:0==t.length?null:/,/.test(t)?i=t.id.split(\" ,\"):(i.push(t.id),i)},m.prototype._$f0=\"function(t){this._$gP=t._$nP(),this._$dr=t._$nP(),this._$GS=t._$nP(),this._$qb=t._$6L(),this._$Lb=t._$cS(),this._$mS=t._$Tb(),t.getFormatVersion()\"\">=G._$T7?(this.clipID=t._$nP(),this.clipIDList=this.convertClipIDForV2_11(this.clipID)):this.clipIDList=[],this._$MS(this._$Lb)},M.prototype.getClipIDList=function(){return this.clipIDList},M.prototype.init=function(t){},M.prototype._$Nr=function(t,i){if(i._$IS[0]=!1,i._$Us=v._$Z2(t,this._$GS,i._$IS,this._$Lb),at._$Zs);else if(i._$IS[0])return;i._$7s=v._$br(t,this._$GS,i._$IS,this._$mS)},M.prototype._$2b=function(t,i){},M.prototype.getDrawDataID=function(){return this._$gP},M.prototype._$j2=function(t){this._$gP=t},M.prototype.getOpacity=function(t,i){return i._$7s},M.prototype._$zS=function(t,i){return i._$Us},M.prototype._$MS=function(t){for(var i=t.length-1;i>=0;--i){var e=t[i];e<m._$52?m._$52=e:e>M._$R2&&(M._$R2=e)}},M.prototype.getTargetBaseDataID=function(){return this._$dr},M.prototype._$gs=function(t){this._$dr=t},M.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},M.prototype.preDraw=function(t,i,e){},M.prototype.draw=function(t,i,e){},M.prototype.getType=function(){},M.prototype._$B2=function(t,i,e){},E._$ps=32,E.CLIPPING_PROCESS_NONE=0,E.CLIPPING_PROCESS_OVERWRITE_ALPHA=1,E.CLIPPING_PROCESS_MULTIPLY_ALPHA=2,E.CLIPPING_PROCESS_DRAW=3,E.CLIPPING_PROCESS_CLEAR_ALPHA=4,E.prototype.setChannelFlagAsColor=function(t,i){this.CHANNEL_COLORS[t]=i},E.prototype.getChannelFlagAsColor=function(t){return this.CHANNEL_COLORS[t]},E.prototype._$ZT=function(){},E.prototype._$Uo=function(t,i,e,r,o,n,s){},E.prototype._$Rs=function(){return-1},E.prototype._$Ds=function(t){},E.prototype.setBaseColor=function(t,i,e,r){t<0?t=0:t>1&&(t=1),i<0?i=0:i>1&&(i=1),e<0?e=0:e>1&&(e=1),r<0?r=0:r>1&&(r=1),this._$lT=t,this._$C0=i,this._$tT=e,this._$WL=r},E.prototype._$WP=function(t){this.culling=t},E.prototype.setMatrix=function(t){for(var i=0;i<16;i++)this.matrix4x4[i]=t[i]},e.prototype._$it=function(){return this.matrix4x4},e.prototype.setpremultipliedalpha=\"function(t){this.premultipliedAlpha=t},E.prototype.isPremultipliedAlpha=function(){return\" this.premultipliedalpha},e.prototype.setanisotropy=\"function(t){this.anisotropy=t},E.prototype.getAnisotropy=function(){return\" this.anisotropy},e.prototype.getclippingprocess=\"function(){return\" this.clippingprocess},e.prototype.setclippingprocess=\"function(t){this.clippingProcess=t},E.prototype.setClipBufPre_clipContextForMask=function(t){this.clipBufPre_clipContextMask=t},E.prototype.getClipBufPre_clipContextMask=function(){return\" this.clipbufpre_clipcontextmask},e.prototype.setclipbufpre_clipcontextfordraw=\"function(t){this.clipBufPre_clipContextDraw=t},E.prototype.getClipBufPre_clipContextDraw=function(){return\" this.clipbufpre_clipcontextdraw},i._$ur=\"-2,I._$c2=1,I._$_b=2,I.prototype._$F0=function(t){this._$kP=t._$nP(),this._$dr=t._$nP()},I.prototype.readV2_opacity=function(t){t.getFormatVersion()\">=G.LIVE2D_FORMAT_VERSION_V2_10_SDK2&&(this._$mS=t._$Tb())},I.prototype.init=function(t){},I.prototype._$Nr=function(t,i){},I.prototype.interpolateOpacity=function(t,i,e,r){null==this._$mS?e.setInterpolatedOpacity(1):e.setInterpolatedOpacity(v._$br(t,i,r,this._$mS))},I.prototype._$2b=function(t,i){},I.prototype._$nb=function(t,i,e,r,o,n,s){},I.prototype.getType=function(){},I.prototype._$gs=function(t){this._$dr=t},I.prototype._$a2=function(t){this._$kP=t},I.prototype.getTargetBaseDataID=function(){return this._$dr},I.prototype.getBaseDataID=function(){return this._$kP},I.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},w._$W2=0,w._$CS=w._$W2,w._$Mo=function(){return!0},w._$XP=function(t){try{for(var i=getTimeMSec();getTimeMSec()-i<t;);}catch(t){t._$rb()}},w.getusertimemsec=function(){return w._$cs=\"=w._$W2?w.getSystemTimeMSec():w._$CS},w.setUserTimeMSec=function(t){w._$CS=t},w.updateUserTimeMSec=function(){return\" date).gettime()},w.getsystemtimemsec=\"function(){return(new\" date).gettime()},w._$q=\"function(t){},w._$jT=function(t,i,e,r,o){for(var\" n=\"0;n<o;n++)e[r+n]=t[i+n]},x._$ds=-2,x.prototype._$F0=function(t){this._$wL=t._$nP(),this._$VP=t._$6L(),this._$GP=t._$nP()},x.prototype.getParamIndex=function(t){return\" this._$2r!=\"t&&(this._$8o=x._$ds),this._$8o},x.prototype._$Pb=function(t,i){this._$8o=t,this._$2r=i},x.prototype.getParamID=function(){return\" this._$wl},x.prototype._$yp=\"function(t){this._$wL=t},x.prototype._$N2=function(){return\" this._$vp},x.prototype._$d2=\"function(){return\" this._$gp},x.prototype._$t2=\"function(t,i){this._$VP=t,this._$GP=i},x.prototype._$Lr=function(){return\" this._$o2},x.prototype._$wr=\"function(t){this._$O2=t},x.prototype._$SL=function(){return\" this._$ri},x.prototype._$al=\"function(t){this._$ri=t},O.startsWith=function(t,i,e){var\" r=\"i+e.length;if(r\">=t.length)return!1;for(var o=i;o<r;o++)if(o.getchar(t,o)!=e.charat(o-i))return!1;return!0},o.getchar=function(t,i){return string.fromcharcode(t.getuint8(i))},o.createstring=\"function(t,i,e){for(var\" r=\"new\" arraybuffer(2*e),o=\"new\" uint16array(r),n=\"0;n<e;n++)o[n]=t.getUint8(i+n);return\" string.fromcharcode.apply(null,o)},o._$ls=\"function(t,i,e,r){t\" instanceof arraybuffer&&(t=\"new\" dataview(t));var o=\"e,n=!1,s=!1,_=0,a=O.getChar(t,o);\" -\"=\"=a&&(n=!0,o++);for(var\"\" h=\"!1;o<i;o++){switch(a=O.getChar(t,o)){case\" 0\":_*=\"10;break;case\"1\":_=10*_+1;break;case\"2\":_=10*_+2;break;case\"3\":_=10*_+3;break;case\"4\":_=10*_+4;break;case\"5\":_=10*_+5;break;case\"6\":_=10*_+6;break;case\"7\":_=10*_+7;break;case\"8\":_=10*_+8;break;case\"9\":_=10*_+9;break;case\".\":s=!0,o++,h=!0;break;default:h=!0}if(h)break}if(s)for(var\"\" l=\".1,$=!1;o<i;o++){switch(a=O.getChar(t,o)){case\" 0\":break;case\"1\":_+=\"1*l;break;case\"2\":_+=2*l;break;case\"3\":_+=3*l;break;case\"4\":_+=4*l;break;case\"5\":_+=5*l;break;case\"6\":_+=6*l;break;case\"7\":_+=7*l;break;case\"8\":_+=8*l;break;case\"9\":_+=9*l;break;default:$=!0}if(l*=.1,$)break}return\"\" n&&(_=\"-_),r[0]=o,_},D.prototype._$zP=function(){this._$Ob=new\" array},d.prototype._$f0=\"function(t){this._$Ob=t._$nP()},D.prototype._$Ur=function(t){if(t._$WS())return!0;for(var\" i=\"t._$v2(),e=this._$Ob.length-1;e\">=0;--e){var r=this._$Ob[e].getParamIndex(i);if(r==x._$ds&&(r=t.getParamIndex(this._$Ob[e].getParamID())),t._$Xb(r))return!0}return!1},D.prototype._$Q2=function(t,i){for(var e,r,o=this._$Ob.length,n=t._$v2(),s=0,_=0;_<o;_++){var 23242 a=\"this._$Ob[_];if(e=a.getParamIndex(n),e==x._$ds&&(e=t.getParamIndex(a.getParamID()),a._$Pb(e,n)),e<0)throw\" new exception(\"err : \"+a.getparamid());var h=\"e<0?0:t.getParamFloat(e);r=a._$N2();var\" l,$,u=\"a._$d2(),p=-1,f=0;if(r<1);else\" if(1=\"=r)l=u[0],l-U._$J<h&&h<l+U._$J?(p=0,f=0):(p=0,i[0]=!0);else\" if(l=\"u[0],h<l-U._$J)p=0,i[0]=!0;else\" if(h<l+u._$j)p=\"0;else{for(var\" c=\"!1,d=1;d<r;++d){if($=u[d],h<$+U._$J){$-U._$J<h?p=d:(p=d-1,f=(h-l)/($-l),s++),c=!0;break}l=$}c||(p=r-1,f=0,i[0]=!0)}a._$wr(p),a._$AL(f)}return\" s},d.prototype._$zr=\"function(t,i,e){var\" r=\"1<<e;r+1\">U._$Qb&&console.log(\"err 23245\\n\");for(var o=this._$Ob.length,n=1,s=1,_=0,a=0;a<r;++a)t[a]=0;for(var h=\"0;h<o;++h){var\" l=\"this._$Ob[h];if(0==l._$SL()){var\" $=\"l._$Lr()*n;if($<0&&at._$3T)throw\" new exception(\"err 23246\");for(var a=\"0;a<r;++a)t[a]+=$}else{for(var\" r=\"new\" float32array(i),o=\"0;o<i;++o)r[o]=e[o];var\" n=\"new\" x;n._$yp(t),n._$t2(i,r),this._$ob.push(n)},d.prototype._$j2=\"function(t){for(var\" i=\"t,e=this._$Ob.length,r=0;r<e;++r){var\" o=\"this._$Ob[r],n=o._$N2(),s=i%o._$N2(),_=o._$d2()[s];console.log(\" %s[%d]=\"%7.2f\"\" \",o.getparamid(),s,_),i=\"n}console.log(\"\\n\")},d.prototype.getparamcount=\"function(){return\"\" this._$ob.length},d.prototype._$zs=\"function(){return\" this._$ob},r.prototype.identity=\"function(){for(var\" t=\"0;t<16;t++)this.m[t]=t%5==0?1:0},R.prototype.getArray=function(){return\" this.m},r.prototype.getcopymatrix=\"function(){return\" float32array(this.m)},r.prototype.setmatrix=\"function(t){if(null!=t&&16==t.length)for(var\" null=\"=i?null:(this==i?this.mult_safe(this.m,t.m,i.m,e):this.mult_fast(this.m,t.m,i.m,e),i)},R.prototype.mult_safe=function(t,i,e,r){if(t==e){var\" array(16);this.mult_fast(t,i,o,r);for(var>=0;--n)e[n]=o[n]}else this.mult_fast(t,i,e,r)},R.prototype.mult_fast=function(t,i,e,r){r?(e[0]=t[0]*i[0]+t[4]*i[1]+t[8]*i[2],e[4]=t[0]*i[4]+t[4]*i[5]+t[8]*i[6],e[8]=t[0]*i[8]+t[4]*i[9]+t[8]*i[10],e[12]=t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12],e[1]=t[1]*i[0]+t[5]*i[1]+t[9]*i[2],e[5]=t[1]*i[4]+t[5]*i[5]+t[9]*i[6],e[9]=t[1]*i[8]+t[5]*i[9]+t[9]*i[10],e[13]=t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13],e[2]=t[2]*i[0]+t[6]*i[1]+t[10]*i[2],e[6]=t[2]*i[4]+t[6]*i[5]+t[10]*i[6],e[10]=t[2]*i[8]+t[6]*i[9]+t[10]*i[10],e[14]=t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14],e[3]=e[7]=e[11]=0,e[15]=1):(e[0]=t[0]*i[0]+t[4]*i[1]+t[8]*i[2]+t[12]*i[3],e[4]=t[0]*i[4]+t[4]*i[5]+t[8]*i[6]+t[12]*i[7],e[8]=t[0]*i[8]+t[4]*i[9]+t[8]*i[10]+t[12]*i[11],e[12]=t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12]*i[15],e[1]=t[1]*i[0]+t[5]*i[1]+t[9]*i[2]+t[13]*i[3],e[5]=t[1]*i[4]+t[5]*i[5]+t[9]*i[6]+t[13]*i[7],e[9]=t[1]*i[8]+t[5]*i[9]+t[9]*i[10]+t[13]*i[11],e[13]=t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13]*i[15],e[2]=t[2]*i[0]+t[6]*i[1]+t[10]*i[2]+t[14]*i[3],e[6]=t[2]*i[4]+t[6]*i[5]+t[10]*i[6]+t[14]*i[7],e[10]=t[2]*i[8]+t[6]*i[9]+t[10]*i[10]+t[14]*i[11],e[14]=t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14]*i[15],e[3]=t[3]*i[0]+t[7]*i[1]+t[11]*i[2]+t[15]*i[3],e[7]=t[3]*i[4]+t[7]*i[5]+t[11]*i[6]+t[15]*i[7],e[11]=t[3]*i[8]+t[7]*i[9]+t[11]*i[10]+t[15]*i[11],e[15]=t[3]*i[12]+t[7]*i[13]+t[11]*i[14]+t[15]*i[15])},R.prototype.translate=function(t,i,e){this.m[12]=this.m[0]*t+this.m[4]*i+this.m[8]*e+this.m[12],this.m[13]=this.m[1]*t+this.m[5]*i+this.m[9]*e+this.m[13],this.m[14]=this.m[2]*t+this.m[6]*i+this.m[10]*e+this.m[14],this.m[15]=this.m[3]*t+this.m[7]*i+this.m[11]*e+this.m[15]},R.prototype.scale=function(t,i,e){this.m[0]*=t,this.m[4]*=i,this.m[8]*=e,this.m[1]*=t,this.m[5]*=i,this.m[9]*=e,this.m[2]*=t,this.m[6]*=i,this.m[10]*=e,this.m[3]*=t,this.m[7]*=i,this.m[11]*=e},R.prototype.rotateX=function(t){var i=Lt.fcos(t),e=Lt._$9(t),r=this.m[4];this.m[4]=r*i+this.m[8]*e,this.m[8]=r*-e+this.m[8]*i,r=this.m[5],this.m[5]=r*i+this.m[9]*e,this.m[9]=r*-e+this.m[9]*i,r=this.m[6],this.m[6]=r*i+this.m[10]*e,this.m[10]=r*-e+this.m[10]*i,r=this.m[7],this.m[7]=r*i+this.m[11]*e,this.m[11]=r*-e+this.m[11]*i},R.prototype.rotateY=function(t){var i=Lt.fcos(t),e=Lt._$9(t),r=this.m[0];this.m[0]=r*i+this.m[8]*-e,this.m[8]=r*e+this.m[8]*i,r=this.m[1],this.m[1]=r*i+this.m[9]*-e,this.m[9]=r*e+this.m[9]*i,r=m[2],this.m[2]=r*i+this.m[10]*-e,this.m[10]=r*e+this.m[10]*i,r=m[3],this.m[3]=r*i+this.m[11]*-e,this.m[11]=r*e+this.m[11]*i},R.prototype.rotateZ=function(t){var i=Lt.fcos(t),e=Lt._$9(t),r=this.m[0];this.m[0]=r*i+this.m[4]*e,this.m[4]=r*-e+this.m[4]*i,r=this.m[1],this.m[1]=r*i+this.m[5]*e,this.m[5]=r*-e+this.m[5]*i,r=this.m[2],this.m[2]=r*i+this.m[6]*e,this.m[6]=r*-e+this.m[6]*i,r=this.m[3],this.m[3]=r*i+this.m[7]*e,this.m[7]=r*-e+this.m[7]*i},b.prototype=new et,b._$tP=new Object,b._$27=function(){b._$tP.clear()},b.getID=function(t){var i=b._$tP[t];return null==i&&(i=new b(t),b._$tP[t]=i),i},b.prototype._$3s=function(){return new b},F._$kS=-1,F._$pS=0,F._$hb=1,F.STATE_IDENTITY=0,F._$gb=1,F._$fo=2,F._$go=4,F.prototype.transform=function(t,i,e){var r,o,n,s,_,a,h=0,l=0;switch(this._$hi){default:return;case F._$go|F._$fo|F._$gb:for(r=this._$7,o=this._$H,n=this._$k,s=this._$f,_=this._$g,a=this._$w;--e>=0;){var $=t[h++],u=t[h++];i[l++]=r*$+o*u+n,i[l++]=s*$+_*u+a}return;case F._$go|F._$fo:for(r=this._$7,o=this._$H,s=this._$f,_=this._$g;--e>=0;){var $=t[h++],u=t[h++];i[l++]=r*$+o*u,i[l++]=s*$+_*u}return;case F._$go|F._$gb:for(o=this._$H,n=this._$k,s=this._$f,a=this._$w;--e>=0;){var $=t[h++];i[l++]=o*t[h++]+n,i[l++]=s*$+a}return;case F._$go:for(o=this._$H,s=this._$f;--e>=0;){var $=t[h++];i[l++]=o*t[h++],i[l++]=s*$}return;case F._$fo|F._$gb:for(r=this._$7,n=this._$k,_=this._$g,a=this._$w;--e>=0;)i[l++]=r*t[h++]+n,i[l++]=_*t[h++]+a;return;case F._$fo:for(r=this._$7,_=this._$g;--e>=0;)i[l++]=r*t[h++],i[l++]=_*t[h++];return;case F._$gb:for(n=this._$k,a=this._$w;--e>=0;)i[l++]=t[h++]+n,i[l++]=t[h++]+a;return;case F.STATE_IDENTITY:return void(t==i&&h==l||w._$jT(t,h,i,l,2*e))}},F.prototype.update=function(){0==this._$H&&0==this._$f?1==this._$7&&1==this._$g?0==this._$k&&0==this._$w?(this._$hi=F.STATE_IDENTITY,this._$Z=F._$pS):(this._$hi=F._$gb,this._$Z=F._$hb):0==this._$k&&0==this._$w?(this._$hi=F._$fo,this._$Z=F._$kS):(this._$hi=F._$fo|F._$gb,this._$Z=F._$kS):0==this._$7&&0==this._$g?0==this._$k&&0==this._$w?(this._$hi=F._$go,this._$Z=F._$kS):(this._$hi=F._$go|F._$gb,this._$Z=F._$kS):0==this._$k&&0==this._$w?(this._$hi=F._$go|F._$fo,this._$Z=F._$kS):(this._$hi=F._$go|F._$fo|F._$gb,this._$Z=F._$kS)},F.prototype._$RT=function(t){this._$IT(t);var i=t[0],e=t[2],r=t[1],o=t[3],n=Math.sqrt(i*i+r*r),s=i*o-e*r;0==n?at._$so&&console.log(\"affine._$RT() / rt==0\"):(t[0]=n,t[1]=s/n,t[2]=(r*o+i*e)/s,t[3]=Math.atan2(r,i))},F.prototype._$ho=function(t,i,e,r){var o=new Float32Array(6),n=new Float32Array(6);t._$RT(o),i._$RT(n);var s=new Float32Array(6);s[0]=o[0]+(n[0]-o[0])*e,s[1]=o[1]+(n[1]-o[1])*e,s[2]=o[2]+(n[2]-o[2])*e,s[3]=o[3]+(n[3]-o[3])*e,s[4]=o[4]+(n[4]-o[4])*e,s[5]=o[5]+(n[5]-o[5])*e,r._$CT(s)},F.prototype._$CT=function(t){var i=Math.cos(t[3]),e=Math.sin(t[3]);this._$7=t[0]*i,this._$f=t[0]*e,this._$H=t[1]*(t[2]*i-e),this._$g=t[1]*(t[2]*e+i),this._$k=t[4],this._$w=t[5],this.update()},F.prototype._$IT=function(t){t[0]=this._$7,t[1]=this._$f,t[2]=this._$H,t[3]=this._$g,t[4]=this._$k,t[5]=this._$w},C.prototype=new s,C._$cs=\"VISIBLE:\",C._$ar=\"LAYOUT:\",C._$Co=0,C._$D2=[],C._$1T=1,C.loadMotion=function(t){var i=new C,e=[0],r=t.length;i._$yT=0;for(var o=0;o<r;++o){var n=\"255&t[o];if(\" \\n\"!=\"n&&\"\\r\"!=n)if(\"#\"!=n)if(\"$\"!=n){if(\"a\"<=n&&n<=\"z\"||\"A\"<=n&&n<=\"Z\"||\"_\"==n){for(var\"\" s=\"o,_=-1;o<r&&(\" \\r\"!=\"(n=255&t[o])&&\"\\n\"!=n);++o)if(\"=\"==n){_=o;break}if(_\"\">=0){var a=new B;O.startsWith(t,s,C._$cs)?(a._$RP=B._$hs,a._$4P=new String(t,s,_-s)):O.startsWith(t,s,C._$ar)?(a._$4P=new String(t,s+7,_-s-7),O.startsWith(t,s+7,\"ANCHOR_X\")?a._$RP=B._$xs:O.startsWith(t,s+7,\"ANCHOR_Y\")?a._$RP=B._$us:O.startsWith(t,s+7,\"SCALE_X\")?a._$RP=B._$qs:O.startsWith(t,s+7,\"SCALE_Y\")?a._$RP=B._$Ys:O.startsWith(t,s+7,\"X\")?a._$RP=B._$ws:O.startsWith(t,s+7,\"Y\")&&(a._$RP=B._$Ns)):(a._$RP=B._$Fr,a._$4P=new String(t,s,_-s)),i.motions.push(a);var h=0;for(C._$D2.clear(),o=_+1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\" \\t\"!=\"n){var\"\" l=\"O._$LS(t,r,o,e);if(e[0]\">0){C._$D2.push(l),h++;var $=e[0];if($<o){console.log(\"_$n0 _$hi . @live2dmotion loadmotion()\\n\");break}o=\"$}}a._$I0=C._$D2._$BL(),h\">i._$yT&&(i._$yT=h)}}}else{for(var s=o,_=-1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\"=\"==n){_=o;break}var u=\"!1;if(_\">=0)for(_==s+4&&\"f\"==t[s+1]&&\"p\"==t[s+2]&&\"s\"==t[s+3]&&(u=!0),o=_+1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\" \\t\"!=\"n){var\"\" l=\"O._$LS(t,r,o,e);e[0]\">0&&u&&5<l&&l<121&&(i._$d0=l),o=e[0]}for(;o<r&&(\"\\n\"!=t[o]&&\"\\r\"!=t[o]);++o);}else for(;o<r&&(\"\\n\"!=\"t[o]&&\" \\r\"!=\"t[o]);++o);}return\"\" i._$as=\"1e3*i._$yT/i._$D0|0,i},C.prototype.getDurationMSec=function(){return\" this._$as},c.prototype.dump=\"function(){for(var\" t=\"0;t<this.motions.length;t++){var\" i=\"this.motions[t];console.log(\" _$wl[%s]\" [%d]. \",i._$4p,i._$i0.length);for(var e=\"0;e<i._$I0.length&&e<10;e++)console.log(\" %5.2f\" ,\",i._$i0[e]);console.log(\"\\n\")}},c.prototype.updateparamexe=\"function(t,i,e,r){for(var\" o=\"i-r._$z2,n=o*this._$D0/1e3,s=0|n,_=n-s,a=0;a<this.motions.length;a++){var\" h=\"this.motions[a],l=h._$I0.length,$=h._$4P;if(h._$RP==B._$hs){var\" u=\"h._$I0[s\">=l?l-1:s];t.setParamFloat($,u)}else if(B._$ws<=h._$rp&&h._$rp<=b._$ys);else{var p=\"t.getParamFloat($),f=h._$I0[s\">=l?l-1:s],c=h._$I0[s+1>=l?l-1:s+1],d=f+(c-f)*_,g=p+(d-p)*e;t.setParamFloat($,g)}}s>=this._$yT&&(this._$E?(r._$z2=i,this.loopFadeIn&&(r._$bs=i)):r._$9L=!0)},C.prototype._$r0=function(){return this._$E},C.prototype._$aL=function(t){this._$E=t},C.prototype.isLoopFadeIn=function(){return this.loopFadeIn},C.prototype.setLoopFadeIn=function(t){this.loopFadeIn=t},N.prototype.clear=function(){this.size=0},N.prototype.add=function(t){if(this._$P.length<=this.size){var i=\"new\" float32array(2*this.size);w._$jt(this._$p,0,i,0,this.size),this._$p=\"i}this._$P[this.size++]=t},N.prototype._$BL=function(){var\" t=\"new\" float32array(this.size);return w._$jt(this._$p,0,t,0,this.size),t},b._$fr=\"0,B._$hs=1,B._$ws=100,B._$Ns=101,B._$xs=102,B._$us=103,B._$qs=104,B._$Ys=105,U._$Ms=1,U._$Qs=2,U._$i2=0,U._$No=2,U._$do=U._$Ms,U._$Ls=!0,U._$1r=5,U._$Qb=65,U._$J=1e-4,U._$FT=.001,U._$Ss=3,G._$o7=6,G._$S7=7,G._$s7=8,G._$77=9,G.LIVE2D_FORMAT_VERSION_V2_10_SDK2=10,G.LIVE2D_FORMAT_VERSION_V2_11_SDK2_1=11,G._$T7=G.LIVE2D_FORMAT_VERSION_V2_11_SDK2_1,G._$Is=-2004318072,G._$h0=0,G._$4L=23,G._$7P=33,G._$uT=function(t){console.log(\" _$bo\" :: _$6 _$mo _$e0 : %d\\n\",t)},g._$9o=\"function(t){if(t<40)return\" g._$ut(t),null;if(t<50)return g._$ut(t),null;if(t<60)return g._$ut(t),null;if(t<100)switch(t){case 65:return new z;case 66:return d;case 67:return x;case 68:return 69:return p;case 70:return $t;default:return g._$ut(t),null}else if(t<150)switch(t){case 131:return st;case 133:return tt;case 136:return 137:return ot;case 142:return j}return g._$ut(t),null},y._$hp=\"0,Y._$_0=!0;Y._$V2=-1,Y._$W0=-1,Y._$jr=!1,Y._$ZS=!0,Y._$tr=-1e6,Y._$lr=1e6,Y._$is=32,Y._$e=!1,Y.prototype.getDrawDataIndex=function(t){for(var\">=0;--i)if(null!=this._$aS[i]&&this._$aS[i].getDrawDataID()==t)return i;return-1},Y.prototype.getDrawData=function(t){if(t instanceof b){if(null==this._$Bo){this._$Bo=new Object;for(var i=this._$aS.length,e=0;e<i;e++){var r=\"this._$aS[e],o=r.getDrawDataID();null!=o&&(this._$Bo[o]=r)}}return\" this._$bo[id]}return t<this._$as.length?this._$as[t]:null},y.prototype.release=\"function(){this._$3S.clear(),this._$aS.clear(),this._$F2.clear(),null!=this._$Bo&&this._$Bo.clear(),this._$db.clear(),this._$8b.clear(),this._$Hr.clear()},Y.prototype.init=function(){this._$co++,this._$F2.length\">0&&this.release();for(var t=this._$Ri.getModelImpl(),i=t._$Xr(),r=i.length,o=new Array,n=new Array,s=0;s<r;++s){var _=\"i[s];this._$F2.push(_),this._$Hr.push(_.init(this));for(var\" a=\"_.getBaseData(),h=a.length,l=0;l<h;++l)o.push(a[l]);for(var\" l=\"0;l<h;++l){var\" $=\"a[l].init(this);$._$l2(s),n.push($)}for(var\" u=\"_.getDrawData(),p=u.length,l=0;l<p;++l){var\" f=\"u[l],c=f.init(this);c._$IP=s,this._$aS.push(f),this._$8b.push(c)}}for(var\" d=\"o.length,g=yt._$2o();;){for(var\" y=\"!1,s=0;s<d;++s){var\" m=\"o[s];if(null!=m){var\" t=\"m.getTargetBaseDataID();(null==T||T==g||this.getBaseDataIndex(T)\">=0)&&(this._$3S.push(m),this._$db.push(n[s]),o[s]=null,y=!0)}}if(!y)break}var P=t._$E2();if(null!=P){var S=P._$1s();if(null!=S)for(var v=S.length,s=0;s<v;++s){var l=\"S[s];null!=L&&this._$02(L.getParamID(),L.getDefaultValue(),L.getMinValue(),L.getMaxValue())}}this.clipManager=new\" e(this.dp_webgl),this.clipmanager.init(this,this._$as,this._$8b),this._$qt=\"!0},Y.prototype.update=function(){Y._$e&&_.start(\" _$zl\");for(var\" t=\"this._$_2.length,i=0;i<t;i++)this._$_2[i]!=this._$vr[i]&&(this._$Js[i]=Y._$ZS,this._$vr[i]=this._$_2[i]);var\" e=\"this._$3S.length,r=this._$aS.length,o=W._$or(),n=W._$Pr(),s=n-o+1;(null==this._$Ws||this._$Ws.length<s)&&(this._$Ws=new\" int16array(s),this._$vs=\"new\" int16array(s));for(var i=\"0;i<s;i++)this._$Ws[i]=Y._$V2,this._$Vs[i]=Y._$V2;(null==this._$Er||this._$Er.length<r)&&(this._$Er=new\" int16array(r));for(var a=\"null,h=0;h<e;++h){var\" u=\"null,p=0;p<r;++p){var\" f=\"this._$aS[p],c=this._$8b[p];try{if(f._$Nr(this,c),c._$u2())continue;f._$2b(this,c);var\" d,g=\"Math.floor(f._$zS(this,c)-o);try{d=this._$Vs[g]}catch(t){console.log(\" _$li\" :: %s \\t\\t\\t\\t@@_$fs\\n\",t.tostring(),f.getdrawdataid().tostring()),g=\"Math.floor(f._$zS(this,c)-o);continue}d==Y._$V2?this._$Ws[g]=p:this._$Er[d]=p,this._$Vs[g]=p}catch(t){null==u&&(u=t,at._$sT(at._$H7))}}null!=u&&Y._$_0&&_._$Rb(u),Y._$e&&_.dump(\" _$dl\"),y._$e&&_.start(\"_$el\");for(var\">=0;i--)this._$Js[i]=Y._$jr;return this._$QT=!1,Y._$e&&_.dump(\"_$eL\"),!1},Y.prototype.preDraw=function(t){null!=this.clipManager&&(t._$ZT(),this.clipManager.setupClip(this,t))},Y.prototype.draw=function(t){if(null==this._$Ws)return void _._$li(\"call _$Ri.update() before _$Ri.draw() \");var i=this._$Ws.length;t._$ZT();for(var e=0;e<i;++e){var r=\"this._$Ws[e];if(r!=Y._$V2)for(;;){var\" o=\"this._$aS[r],n=this._$8b[r];if(n._$yo()){var\" s=\"n._$IP,a=this._$Hr[s];n._$VS=a.getPartsOpacity(),o.draw(t,this,n)}var\" h=\"this._$Er[r];if(h<=r||h==Y._$W0)break;r=h}}},Y.prototype.getParamIndex=function(t){for(var\" i=\"this._$pb.length-1;i\">=0;--i)if(this._$pb[i]==t)return i;return this._$02(t,0,Y._$tr,Y._$lr)},Y.prototype._$BS=function(t){return this.getBaseDataIndex(t)},Y.prototype.getBaseDataIndex=function(t){for(var i=this._$3S.length-1;i>=0;--i)if(null!=this._$3S[i]&&this._$3S[i].getBaseDataID()==t)return i;return-1},Y.prototype._$UT=function(t,i){var e=new Float32Array(i);return w._$jT(t,0,e,0,t.length),e},Y.prototype._$02=function(t,i,e,r){if(this._$qo>=this._$pb.length){var o=this._$pb.length,n=new Array(2*o);w._$jT(this._$pb,0,n,0,o),this._$pb=n,this._$_2=this._$UT(this._$_2,2*o),this._$vr=this._$UT(this._$vr,2*o),this._$Rr=this._$UT(this._$Rr,2*o),this._$Or=this._$UT(this._$Or,2*o);var s=new Array;w._$jT(this._$Js,0,s,0,o),this._$Js=s}return this._$pb[this._$qo]=t,this._$_2[this._$qo]=i,this._$vr[this._$qo]=i,this._$Rr[this._$qo]=e,this._$Or[this._$qo]=r,this._$Js[this._$qo]=Y._$ZS,this._$qo++},Y.prototype._$Zo=function(t,i){this._$3S[t]=i},Y.prototype.setParamFloat=function(t,i){i<this._$rr[t]&&(i=this._$rr[t]),i>this._$Or[t]&&(i=this._$Or[t]),this._$_2[t]=i},Y.prototype.loadParam=function(){var t=this._$_2.length;t>this._$fs.length&&(t=this._$fs.length),w._$jT(this._$fs,0,this._$_2,0,t)},Y.prototype.saveParam=function(){var t=this._$_2.length;t>this._$fs.length&&(this._$fs=new Float32Array(t)),w._$jT(this._$_2,0,this._$fs,0,t)},Y.prototype._$v2=function(){return this._$co},Y.prototype._$WS=function(){return this._$QT},Y.prototype._$Xb=function(t){return this._$Js[t]==Y._$ZS},Y.prototype._$vs=function(){return this._$Es},Y.prototype._$Tr=function(){return this._$ZP},Y.prototype.getBaseData=function(t){return this._$3S[t]},Y.prototype.getParamFloat=function(t){return this._$_2[t]},Y.prototype.getParamMax=function(t){return this._$Or[t]},Y.prototype.getParamMin=function(t){return this._$Rr[t]},Y.prototype.setPartsOpacity=function(t,i){this._$Hr[t].setPartsOpacity(i)},Y.prototype.getPartsOpacity=function(t){return this._$Hr[t].getPartsOpacity()},Y.prototype.getPartsDataIndex=function(t){for(var i=this._$F2.length-1;i>=0;--i)if(null!=this._$F2[i]&&this._$F2[i]._$p2()==t)return i;return-1},Y.prototype._$q2=function(t){return this._$db[t]},Y.prototype._$C2=function(t){return this._$8b[t]},Y.prototype._$Bb=function(t){return this._$Hr[t]},Y.prototype._$5s=function(t,i){for(var e=this._$Ws.length,r=t,o=0;o<e;++o){var n=\"this._$Ws[o];if(n!=Y._$V2)for(;;){var\" s=\"this._$8b[n];s._$yo()&&(s._$GT()._$B2(this,s,r),r+=i);var\" _=\"this._$Er[n];if(_<=n||_==Y._$W0)break;n=_}}},Y.prototype.setDrawParam=function(t){this.dp_webgl=t},Y.prototype.getDrawParam=function(){return\" this.dp_webgl},k._$0t=\"function(t){return\" k._$0t(new _$5(t))},k._$0t=\"function(t){if(!t.exists())throw\" new _$ls(t._$3b());for(var i,e=\"t.length(),r=new\" int8array(e),o=\"new\" _$xs(new _$kb(t),8192),n=\"0;(i=o.read(r,n,e-n))\">0;)n+=i;return r},k._$C=function(t){var i=null,e=null;try{i=t instanceof Array?t:new _$Xs(t,8192),e=new _$js;for(var r,o=new Int8Array(1e3);(r=i.read(o))>0;)e.write(o,0,r);return e._$TS()}finally{null!=t&&t.close(),null!=e&&(e.flush(),e.close())}},V.prototype._$T2=function(){return w.getUserTimeMSec()+Math._$10()*(2*this._$Br-1)},V.prototype._$uo=function(t){this._$Br=t},V.prototype._$QS=function(t,i,e){this._$Dr=t,this._$Cb=i,this._$mr=e},V.prototype._$7T=function(t){var i,e=w.getUserTimeMSec(),r=0;switch(this._$_L){case STATE_CLOSING:r=(e-this._$bb)/this._$Dr,r>=1&&(r=1,this._$_L=wt.STATE_CLOSED,this._$bb=e),i=1-r;break;case STATE_CLOSED:r=(e-this._$bb)/this._$Cb,r>=1&&(this._$_L=wt.STATE_OPENING,this._$bb=e),i=0;break;case STATE_OPENING:r=(e-this._$bb)/this._$mr,r>=1&&(r=1,this._$_L=wt.STATE_INTERVAL,this._$12=this._$T2()),i=r;break;case STATE_INTERVAL:this._$12<e&&(this._$_l=wt.state_closing,this._$bb=e),i=1;break;case state_first:default:this._$_l=\"wt.STATE_INTERVAL,this._$12=this._$T2(),i=1}this._$jo||(i=-i),t.setParamFloat(this._$iL,i),t.setParamFloat(this._$0L,i)};var\" wt=\"function(){};wt.STATE_FIRST=\" state_first\",wt.state_interval=\"STATE_INTERVAL\" ,wt.state_closing=\"STATE_CLOSING\" ,wt.state_closed=\"STATE_CLOSED\" ,wt.state_opening=\"STATE_OPENING\" ,x.prototype=\"new\"\" e,x._$as=\"32,X._$Gr=!1,X._$NT=null,X._$vS=null,X._$no=null,X._$9r=function(t){return\" new float32array(t)},x._$vb=\"function(t){return\" int16array(t)},x._$cr=\"function(t,i){return\" null=\"=t||t._$yL()<i.length?(t=X._$9r(2*i.length),t.put(i),t._$oT(0)):(t.clear(),t.put(i),t._$oT(0)),t},X._$mb=function(t,i){return\" x._$gr},x._$as=\"function(t){X._$Gr=t},X.prototype.setGL=function(t){this.gl=t},X.prototype.setTransform=function(t){this.transform=t},X.prototype._$ZT=function(){},X.prototype._$Uo=function(t,i,e,r,o,n,s,_){if(!(n<.01)){var\" a=\"this._$U2[t],h=n\">.9?at.EXPAND_W:0;this.gl.drawElements(a,e,r,o,n,h,this.transform,_)}},X.prototype._$Rs=function(){throw new Error(\"_$Rs\")},X.prototype._$Ds=function(t){throw new Error(\"_$Ds\")},X.prototype._$K2=function(){for(var t=0;t<this._$sb.length;t++){0!=this._$sb[t]&&(this.gl._$sr(1,this._$sb,t),this._$sb[t]=0)}},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$sb[t]=i},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$u2[t]=i},x.prototype._$ns=function(t){var i=\"Math.max(2*this._$sb.length,t+1+10),e=new\" int32array(i);w._$jt(this._$sb,0,e,0,this._$sb.length),this._$sb=\"e;var\" r=\"new\" array;w._$jt(this._$u2,0,r,0,this._$u2.length),this._$u2=\"r},z.prototype=new\" i,z._$xo=\"new\" float32array(2),z._$io=\"new\" float32array(2),z._$0o=\"new\" float32array(2),z._$lo=\"new\" float32array(2),z._$to=\"new\" float32array(2),z._$po=\"new\" float32array(2),z._$gt=\"new\" array,z.prototype._$zp=\"function(){this._$GS=new\" d,this._$gs._$zp(),this._$y0=\"new\" array},z.prototype.gettype=\"function(){return\" i._$c2},z.prototype._$f0=\"function(t){I.prototype._$F0.call(this,t),this._$GS=t._$nP(),this._$Y0=t._$nP(),I.prototype.readV2_opacity.call(this,t)},z.prototype.init=function(t){var\" h(this);return i._$yr=\"new\" p,this._$32()&&(i._$wr=\"new\" p),i},z.prototype._$nr=\"function(t,i){this!=i._$GT()&&console.log(\" ###\" assert!! ### \");var e=\"i;if(this._$GS._$Ur(t)){var\" o=\"this._$GS._$Q2(t,r);i._$Ib(r[0]),this.interpolateOpacity(t,this._$GS,i,r);var\" n=\"t._$vs(),s=t._$Tr();if(this._$GS._$zr(n,s,o),o<=0){var\" _=\"this._$Y0[n[0]];e._$Yr.init(_)}else\" if(1=\"=o){var\" if(2=\"=o){var\" if(3=\"=o){var\" c=\"this._$Y0[n[0]],d=this._$Y0[n[1]],g=this._$Y0[n[2]],y=this._$Y0[n[3]],m=this._$Y0[n[4]],T=this._$Y0[n[5]],P=this._$Y0[n[6]],S=this._$Y0[n[7]],h=s[0],u=s[1],v=s[2],p=c._$fL+(d._$fL-c._$fL)*h,f=g._$fL+(y._$fL-g._$fL)*h,L=m._$fL+(T._$fL-m._$fL)*h,M=P._$fL+(S._$fL-P._$fL)*h;e._$Yr._$fL=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$gL+(d._$gL-c._$gL)*h,f=g._$gL+(y._$gL-g._$gL)*h,L=m._$gL+(T._$gL-m._$gL)*h,M=P._$gL+(S._$gL-P._$gL)*h,e._$Yr._$gL=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$B0+(d._$B0-c._$B0)*h,f=g._$B0+(y._$B0-g._$B0)*h,L=m._$B0+(T._$B0-m._$B0)*h,M=P._$B0+(S._$B0-P._$B0)*h,e._$Yr._$B0=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$z0+(d._$z0-c._$z0)*h,f=g._$z0+(y._$z0-g._$z0)*h,L=m._$z0+(T._$z0-m._$z0)*h,M=P._$z0+(S._$z0-P._$z0)*h,e._$Yr._$z0=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$qT+(d._$qT-c._$qT)*h,f=g._$qT+(y._$qT-g._$qT)*h,L=m._$qT+(T._$qT-m._$qT)*h,M=P._$qT+(S._$qT-P._$qT)*h,e._$Yr._$qT=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u)}else\" if(4=\"=o){var\" j=\"0|Math.pow(2,o),q=new\" float32array(j),j=\"0;J<j;J++){for(var\" q=\"J,Z=1,K=0;K<o;K++)Z*=Q%2==0?1-s[K]:s[K],Q/=2;q[J]=Z}for(var\" tt=\"new\" array,it=\"0;it<j;it++)tt[it]=this._$Y0[n[it]];for(var\" et=\"0,rt=0,ot=0,nt=0,st=0,it=0;it<j;it++)et+=q[it]*tt[it]._$fL,rt+=q[it]*tt[it]._$gL,ot+=q[it]*tt[it]._$B0,nt+=q[it]*tt[it]._$z0,st+=q[it]*tt[it]._$qT;e._$Yr._$fL=et,e._$Yr._$gL=rt,e._$Yr._$B0=ot,e._$Yr._$z0=nt,e._$Yr._$qT=st}var\" _$0p _$g :: %s\",r),e._$hs(!1);else{var a=\"z._$io;a[0]=0,a[1]=-.1;n._$GT().getType()==I._$c2?a[1]=-10:a[1]=-.1;var\" h=\"z._$0o;this._$Jr(t,o,n,s,a,h);var\" l=\"Lt._$92(a,h);o._$nb(t,n,s,s,1,0,2),e._$Wr._$fL=s[0],e._$Wr._$gL=s[1],e._$Wr._$B0=e._$Yr._$B0,e._$Wr._$z0=e._$Yr._$z0,e._$Wr._$qT=e._$Yr._$qT-l*Lt._$NS;var\" $=\"n.getTotalScale();e.setTotalScale_notForClient($*e._$Wr._$B0);var\" u=\"n.getTotalOpacity();e.setTotalOpacity(u*e.getInterpolatedOpacity()),e._$Wr.reflectX=e._$Yr.reflectX,e._$Wr.reflectY=e._$Yr.reflectY,e._$hS(n._$yo())}else\" e._$hs(!1)}}else e.settotalscale_notforclient(e._$yr._$b0),e.settotalopacity(e.getinterpolatedopacity())},z.prototype._$nb=\"function(t,i,e,r,o,n,s){this!=i._$GT()&&console.log(\" \");for(var _,a,h=\"i,l=null!=h._$Wr?h._$Wr:h._$Yr,$=Math.sin(Lt._$bS*l._$qT),u=Math.cos(Lt._$bS*l._$qT),p=h.getTotalScale(),f=l.reflectX?-1:1,c=l.reflectY?-1:1,d=u*p*f,g=-$*p*c,y=$*p*f,m=u*p*c,T=l._$fL,P=l._$gL,S=o*s,v=n;v<S;v+=s)_=e[v],a=e[v+1],r[v]=d*_+g*a+T,r[v+1]=y*_+m*a+P},z.prototype._$Jr=function(t,i,e,r,o,n){i!=e._$GT()&&console.log(\" s=\"z._$Lo;z._$Lo[0]=r[0],z._$Lo[1]=r[1],i._$nb(t,e,s,s,1,0,2);for(var\" n[0]=\"_[0],void(n[1]=_[1]);if(a[0]=r[0]-h*o[0],a[1]=r[1]-h*o[1],i._$nb(t,e,a,_,1,0,2),_[0]-=s[0],_[1]-=s[1],0!=_[0]||0!=_[1])return\" _[0]=\"-_[0],_[0]=-_[0],n[0]=_[0],void(n[1]=_[1]);h*=.1}at._$so&&console.log(\" _$l0\" to transform _$sp\\n\")},h.prototype=\"new\" _t,w.prototype=\"new\" m,w._$ur=\"-2,W._$ES=500,W._$wb=2,W._$8S=3,W._$os=4,W._$52=W._$ES,W._$R2=W._$ES,W._$Sb=function(t){for(var\">=0;--i){var e=t[i];e<w._$52?w._$52=e:e>W._$R2&&(W._$R2=e)}},W._$or=function(){return W._$52},W._$Pr=function(){return W._$R2},W.prototype._$F0=function(t){this._$gP=t._$nP(),this._$dr=t._$nP(),this._$GS=t._$nP(),this._$qb=t._$6L(),this._$Lb=t._$cS(),this._$mS=t._$Tb(),t.getFormatVersion()>=G._$T7?(this.clipID=t._$nP(),this.clipIDList=this.convertClipIDForV2_11(this.clipID)):this.clipIDList=null,W._$Sb(this._$Lb)},W.prototype.getClipIDList=function(){return this.clipIDList},W.prototype._$Nr=function(t,i){if(i._$IS[0]=!1,i._$Us=v._$Z2(t,this._$GS,i._$IS,this._$Lb),at._$Zs);else if(i._$IS[0])return;i._$7s=v._$br(t,this._$GS,i._$IS,this._$mS)},W.prototype._$2b=function(t){},W.prototype.getDrawDataID=function(){return this._$gP},W.prototype._$j2=function(t){this._$gP=t},W.prototype.getOpacity=function(t,i){return i._$7s},W.prototype._$zS=function(t,i){return i._$Us},W.prototype.getTargetBaseDataID=function(){return this._$dr},W.prototype._$gs=function(t){this._$dr=t},W.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},W.prototype.getType=function(){},j._$42=0,j.prototype._$1b=function(){return this._$3S},j.prototype.getDrawDataList=function(){return this._$aS},j.prototype._$F0=function(t){this._$NL=t._$nP(),this._$aS=t._$nP(),this._$3S=t._$nP()},j.prototype._$kr=function(t){t._$Zo(this._$3S),t._$xo(this._$aS),this._$3S=null,this._$aS=null},q.prototype=new i,q.loadModel=function(t){var e=new q;return i._$62(e,t),e},q.loadModel=function(t){var e=new q;return i._$62(e,t),e},q._$to=function(){return new q},q._$er=function(t){var i=new _$5(\"../_$_r/_$t0/_$Ri/_$_P._$d\");if(0==i.exists())throw new _$ls(\"_$t0 _$_ _$6 _$Ui :: \"+i._$PL());for(var e=[\"../_$_r/_$t0/_$Ri/_$_P.512/_$CP._$1\",\"../_$_r/_$t0/_$Ri/_$_P.512/_$vP._$1\",\"../_$_r/_$t0/_$Ri/_$_P.512/_$EP._$1\",\"../_$_r/_$t0/_$Ri/_$_P.512/_$pP._$1\"],r=q.loadModel(i._$3b()),o=0;o<e.length;o++){var n=\"new\" _$5(e[o]);if(0=\"=n.exists())throw\" new _$ls(\"_$t0 _$_ _$6 _$ui :: \"+n._$pl());r.settexture(o,_$nl._$_o(t,n._$3b()))}return r},q.prototype.setgl=\"function(t){this._$zo.setGL(t)},q.prototype.setTransform=function(t){this._$zo.setTransform(t)},q.prototype.draw=function(){this._$5S.draw(this._$zo)},q.prototype._$K2=function(){this._$zo._$K2()},q.prototype.setTexture=function(t,i){null==this._$zo&&_._$li(\" _$yi\" for qt _$ki _$xs() is _$ui!!\"),this._$zo.settexture(t,i)},q.prototype.settexture=\"function(t,i){null==this._$zo&&_._$li(\" _$ui!!\"),this._$zo.settexture(t,i)},q.prototype._$rs=\"function(){return\" this._$zo._$rs()},q.prototype._$ds=\"function(t){this._$zo._$Ds(t)},q.prototype.getDrawParam=function(){return\" this._$zo},j.prototype=\"new\" s,j._$cs=\"VISIBLE:\" ,j._$ar=\"LAYOUT:\" ,j.mtn_prefix_fadein=\"FADEIN:\" ,j.mtn_prefix_fadeout=\"FADEOUT:\" ,j._$co=\"0,J._$1T=1,J.loadMotion=function(t){var\" i=\"k._$C(t);return\" j.loadmotion(i)},j.loadmotion=\"function(t){t\" instanceof arraybuffer&&(t=\"new\" dataview(t));var j,e=\"[0],r=t.byteLength;i._$yT=0;for(var\" o=\"0;o<r;++o){var\" _=\"o,a=-1;o<r&&(\" \\r\"!=\"(n=Q(t,o))&&\"\\n\"!=n);++o)if(\"=\"==n){a=o;break}if(a\"\">=0){var h=new B;O.startsWith(t,_,J._$cs)?(h._$RP=B._$hs,h._$4P=O.createString(t,_,a-_)):O.startsWith(t,_,J._$ar)?(h._$4P=O.createString(t,_+7,a-_-7),O.startsWith(t,_+7,\"ANCHOR_X\")?h._$RP=B._$xs:O.startsWith(t,_+7,\"ANCHOR_Y\")?h._$RP=B._$us:O.startsWith(t,_+7,\"SCALE_X\")?h._$RP=B._$qs:O.startsWith(t,_+7,\"SCALE_Y\")?h._$RP=B._$Ys:O.startsWith(t,_+7,\"X\")?h._$RP=B._$ws:O.startsWith(t,_+7,\"Y\")&&(h._$RP=B._$Ns)):(h._$RP=B._$Fr,h._$4P=O.createString(t,_,a-_)),i.motions.push(h);var l=0,$=[];for(o=a+1;o<r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\" \\t\"!=\"n){var\"\" u=\"O._$LS(t,r,o,e);if(e[0]\">0){$.push(u),l++;var p=e[0];if(p<o){console.log(\"_$n0 _$hi . @live2dmotion loadmotion()\\n\");break}o=\"p-1}}h._$I0=new\" float32array($),l>i._$yT&&(i._$yT=l)}}}else{for(var _=o,a=-1;o<r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\"=\"==n){a=o;break}var f=\"!1;if(a\">=0)for(a==_+4&&\"f\"==Q(t,_+1)&&\"p\"==Q(t,_+2)&&\"s\"==Q(t,_+3)&&(f=!0),o=a+1;o<r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\" \\t\"!=\"n){var\"\" u=\"O._$LS(t,r,o,e);e[0]\">0&&f&&5<u&&u<121&&(i._$d0=u),o=e[0]}for(;o<r&&(\"\\n\"!=q(t,o)&&\"\\r\"!=q(t,o));++o);}else for(;o<r&&(\"\\n\"!=\"Q(t,o)&&\" \\r\"!=\"Q(t,o));++o);}return\"\" i._$rr=\"1e3*i._$yT/i._$D0|0,i},J.prototype.getDurationMSec=function(){return\" this._$e?-1:this._$rr},j.prototype.getloopdurationmsec=\"function(){return\" this._$rr},j.prototype.dump=\"function(){for(var\" t=\"0;t<this.motions.length;t++){var\" i=\"this.motions[t];console.log(\" _$wl[%s]\" [%d]. \",i._$4p,i._$i0.length);for(var e=\"0;e<i._$I0.length&&e<10;e++)console.log(\" %5.2f\" ,\",i._$i0[e]);console.log(\"\\n\")}},j.prototype.updateparamexe=\"function(t,i,e,r){for(var\" o=\"i-r._$z2,n=o*this._$D0/1e3,s=0|n,_=n-s,a=0;a<this.motions.length;a++){var\" h=\"this.motions[a],l=h._$I0.length,$=h._$4P;if(h._$RP==B._$hs){var\" u=\"h._$I0[s\">=l?l-1:s];t.setParamFloat($,u)}else if(B._$ws<=h._$rp&&h._$rp<=b._$ys);else{var p,f=\"t.getParamIndex($),c=t.getModelContext(),d=c.getParamMax(f),g=c.getParamMin(f),y=.4*(d-g),m=c.getParamFloat(f),T=h._$I0[s\">=l?l-1:s],P=h._$I0[s+1>=l?l-1:s+1];p=T<p&&p-t>y||T>P&&T-P>y?T:T+(P-T)*_;var S=m+(p-m)*e;t.setParamFloat($,S)}}s>=this._$yT&&(this._$E?(r._$z2=i,this.loopFadeIn&&(r._$bs=i)):r._$9L=!0),this._$eP=e},J.prototype._$r0=function(){return this._$E},J.prototype._$aL=function(t){this._$E=t},J.prototype._$S0=function(){return this._$D0},J.prototype._$U0=function(t){this._$D0=t},J.prototype.isLoopFadeIn=function(){return this.loopFadeIn},J.prototype.setLoopFadeIn=function(t){this.loopFadeIn=t},N.prototype.clear=function(){this.size=0},N.prototype.add=function(t){if(this._$P.length<=this.size){var i=\"new\" float32array(2*this.size);w._$jt(this._$p,0,i,0,this.size),this._$p=\"i}this._$P[this.size++]=t},N.prototype._$BL=function(){var\" t=\"new\" float32array(this.size);return w._$jt(this._$p,0,t,0,this.size),t},b._$fr=\"0,B._$hs=1,B._$ws=100,B._$Ns=101,B._$xs=102,B._$us=103,B._$qs=104,B._$Ys=105,Z.prototype=new\" i,z._$gt=\"new\" array,z.prototype._$zp=\"function(){this._$GS=new\" d,this._$gs._$zp()},z.prototype._$f0=\"function(t){I.prototype._$F0.call(this,t),this._$A=t._$6L(),this._$o=t._$6L(),this._$GS=t._$nP(),this._$Eo=t._$nP(),I.prototype.readV2_opacity.call(this,t)},Z.prototype.init=function(t){var\" k(this),e=\"(this._$o+1)*(this._$A+1);return\" null!=\"i._$Cr&&(i._$Cr=null),i._$Cr=new\" float32array(2*e),null!=\"i._$hr&&(i._$hr=null),this._$32()?i._$hr=new\" float32array(2*e):i._$hr=\"null,i},Z.prototype._$Nr=function(t,i){var\" e=\"i;if(this._$GS._$Ur(t)){var\" r=\"this._$VT(),o=Z._$gT;o[0]=!1,v._$Vr(t,this._$GS,o,r,this._$Eo,e._$Cr,0,2),i._$Ib(o[0]),this.interpolateOpacity(t,this._$GS,i,o)}},Z.prototype._$2b=function(t,i){var\" _$0p _$g :: %s\",r),e._$hs(!1);else{var o=\"t.getBaseData(e._$8r),n=t._$q2(e._$8r);if(null!=o&&n._$yo()){var\" s=\"n.getTotalScale();e.setTotalScale_notForClient(s);var\" a=\"n.getTotalOpacity();e.setTotalOpacity(a*e.getInterpolatedOpacity()),o._$nb(t,n,e._$Cr,e._$hr,this._$VT(),0,2),e._$hS(!0)}else\" e._$hs(!1)}}else e.settotalopacity(e.getinterpolatedopacity())},z.prototype._$nb=\"function(t,i,e,r,o,n,s){var\" _=\"i,a=null!=_._$hr?_._$hr:_._$Cr;Z.transformPoints_sdk2(e,r,o,n,s,a,this._$o,this._$A)},Z.transformPoints_sdk2=function(i,e,r,o,n,s,_,a){for(var\" h,l,$,u=\"r*n,p=0,f=0,c=0,d=0,g=0,y=0,m=!1,T=o;T<u;T+=n){var\" p,s,v,l;if(v=\"i[T],L=i[T+1],P=v*_,S=L*a,P<0||S<0||_<=P||a<=S){var\" m=\"_+1;if(!m){m=!0,p=.25*(s[2*(0+0*M)]+s[2*(_+0*M)]+s[2*(0+a*M)]+s[2*(_+a*M)]),f=.25*(s[2*(0+0*M)+1]+s[2*(_+0*M)+1]+s[2*(0+a*M)+1]+s[2*(_+a*M)+1]);var\" x=\"s[2*(0+0*M)],O=s[2*(0+0*M)+1],D=p-2*c,R=f-2*d,b=p-2*g,F=f-2*y,C=p-2*c-2*g,N=f-2*d-2*y,B=.5*(v-\" -2),u=\".5*(L-\" -2);b+u<=\"1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l>=1){var b=s[2*(0+a*M)],F=s[2*(0+a*M)+1],C=p-2*c+1*g,N=f-2*d+1*y,x=p+3*g,O=f+3*y,D=p-2*c+3*g,R=f-2*d+3*y,B=.5*(v- -2),U=.5*(L-1);B+U<=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var g=\"0|S;G==a&&(G=a-1);var\" b=\".5*(v-\" -2),u=\"S-G,Y=G/a,k=(G+1)/a,b=s[2*(0+G*M)],F=s[2*(0+G*M)+1],x=s[2*(0+(G+1)*M)],O=s[2*(0+(G+1)*M)+1],C=p-2*c+Y*g,N=f-2*d+Y*y,D=p-2*c+k*g,R=f-2*d+k*y;B+U<=1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(1<=\"v)if(L<=0){var\" d=\"s[2*(_+0*M)],R=s[2*(_+0*M)+1],x=p+3*c,O=f+3*d,C=p+1*c-2*g,N=f+1*d-2*y,b=p+3*c-2*g,F=f+3*d-2*y,B=.5*(v-1),U=.5*(L-\" -2);b+u<=\"1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l>=1){var C=s[2*(_+a*M)],N=s[2*(_+a*M)+1],b=p+3*c+1*g,F=f+3*d+1*y,D=p+1*c+3*g,R=f+1*d+3*y,x=p+3*c+3*g,O=f+3*d+3*y,B=.5*(v-1),U=.5*(L-1);B+U<=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var g=\"0|S;G==a&&(G=a-1);var\" b=\".5*(v-1),U=S-G,Y=G/a,k=(G+1)/a,C=s[2*(_+G*M)],N=s[2*(_+G*M)+1],D=s[2*(_+(G+1)*M)],R=s[2*(_+(G+1)*M)+1],b=p+3*c+Y*g,F=f+3*d+Y*y,x=p+3*c+k*g,O=f+3*d+k*y;B+U<=1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l<=\"0){var\" v=\"0|P;V==_&&(V=_-1);var\" -2),x=\"V/_,z=(V+1)/_,D=s[2*(V+0*M)],R=s[2*(V+0*M)+1],x=s[2*(V+1+0*M)],O=s[2*(V+1+0*M)+1],C=p+X*c-2*g,N=f+X*d-2*y,b=p+z*c-2*g,F=f+z*d-2*y;B+U<=1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l>=1){var V=0|P;V==_&&(V=_-1);var B=P-V,U=.5*(L-1),X=V/_,z=(V+1)/_,C=s[2*(V+a*M)],N=s[2*(V+a*M)+1],b=s[2*(V+1+a*M)],F=s[2*(V+1+a*M)+1],D=p+X*c+3*g,R=f+X*d+3*y,x=p+z*c+3*g,O=f+z*d+3*y;B+U<=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else t.err.printf(\"_$li calc : %.4f , %.4f\\t\\t\\t\\t\\t@@bdboxgrid\\n\",v,l);else e[t]=\"p+v*c+L*g,e[T+1]=f+v*d+L*y}else\" l=\"P-(0|P),$=S-(0|S),h=2*((0|P)+(0|S)*(_+1)),l+$<1?(e[T]=s[h]*(1-l-$)+s[h+2]*l+s[h+2*(_+1)]*$,e[T+1]=s[h+1]*(1-l-$)+s[h+3]*l+s[h+2*(_+1)+1]*$):(e[T]=s[h+2*(_+1)+2]*(l-1+$)+s[h+2*(_+1)]*(1-l)+s[h+2]*(1-$),e[T+1]=s[h+2*(_+1)+3]*(l-1+$)+s[h+2*(_+1)+1]*(1-l)+s[h+3]*(1-$))}},Z.prototype.transformPoints_sdk1=function(t,i,e,r,o,n,s){for(var\" _,a,h,l,$,u,p,f=\"i,c=this._$o,d=this._$A,g=o*s,y=null!=f._$hr?f._$hr:f._$Cr,m=n;m<g;m+=s)at._$ts?(_=e[m],a=e[m+1],_<0?_=0:_\">1&&(_=1),a<0?a=0:a>1&&(a=1),_*=c,a*=d,h=0|_,l=0|a,h>c-1&&(h=c-1),l>d-1&&(l=d-1),u=_-h,p=a-l,$=2*(h+l*(c+1))):(_=e[m]*c,a=e[m+1]*d,u=_-(0|_),p=a-(0|a),$=2*((0|_)+(0|a)*(c+1))),u+p<1?(r[m]=y[$]*(1-u-p)+y[$+2]*u+y[$+2*(c+1)]*p,r[m+1]=y[$+1]*(1-u-p)+y[$+3]*u+y[$+2*(c+1)+1]*p):(r[m]=y[$+2*(c+1)+2]*(u-1+p)+y[$+2*(c+1)]*(1-u)+y[$+2]*(1-p),r[m+1]=y[$+2*(c+1)+3]*(u-1+p)+y[$+2*(c+1)+1]*(1-u)+y[$+3]*(1-p))},z.prototype._$vt=function(){return(this._$o+1)*(this._$a+1)},z.prototype.gettype=function(){return i._$_b},k.prototype=\"new\" _t,tt._$42=\"0,tt.prototype._$zP=function(){this._$3S=new\" array,this._$as=\"new\" array},tt.prototype._$f0=\"function(t){this._$g0=t._$8L(),this.visible=t._$8L(),this._$NL=t._$nP(),this._$3S=t._$nP(),this._$aS=t._$nP()},tt.prototype.init=function(t){var\" i=\"new\" it(this);return i.setpartsopacity(this.isvisible()?1:0),i},tt.prototype._$6o=\"function(t){if(null==this._$3S)throw\" new error(\"_$3s _$6 _$wo@_$6o\");this._$3s.push(t)},tt.prototype._$3o=\"function(t){if(null==this._$aS)throw\" error(\"_$as _$wo@_$3o\");this._$as.push(t)},tt.prototype._$zo=\"function(t){this._$3S=t},tt.prototype._$xo=function(t){this._$aS=t},tt.prototype.isVisible=function(){return\" this.visible},tt.prototype._$ul=\"function(){return\" this._$g0},tt.prototype._$kp=\"function(t){this.visible=t},tt.prototype._$ET=function(t){this._$g0=t},tt.prototype.getBaseData=function(){return\" this._$3s},tt.prototype.getdrawdata=\"function(){return\" this._$as},tt.prototype._$p2=\"function(){return\" this._$nl},tt.prototype._$ob=\"function(t){this._$NL=t},tt.prototype.getPartsID=function(){return\" this._$nl},tt.prototype._$mp=\"function(t){this._$NL=t},it.prototype=new\" $,it.prototype.getpartsopacity=\"function(){return\" this._$vs},it.prototype.setpartsopacity=\"function(t){this._$VS=t},et._$L7=function(){u._$27(),yt._$27(),b._$27(),l._$27()},et.prototype.toString=function(){return\" this.id},rt.prototype._$f0=\"function(t){},ot.prototype._$1s=function(){return\" this._$4s},ot.prototype._$zp=\"function(){this._$4S=new\" array},ot.prototype._$f0=\"function(t){this._$4S=t._$nP()},ot.prototype._$Ks=function(t){this._$4S.push(t)},nt.tr=new\" gt,nt._$50=\"new\" gt,nt._$ti=\"new\" array(0,0),nt._$pi=\"new\" array(0,0),nt._$b=\"new\" array(0,0),nt.prototype._$lp=\"function(t,i,e,r){this.viewport=new\" array(t,i,e,r)},nt.prototype._$bl=\"function(){this.context.save();var\" t=\"this.viewport;null!=t&&(this.context.beginPath(),this.context._$Li(t[0],t[1],t[2],t[3]),this.context.clip())},nt.prototype._$ei=function(){this.context.restore()},nt.prototype.drawElements=function(t,i,e,r,o,n,s,a){try{o!=this._$Qo&&(this._$Qo=o,this.context.globalAlpha=o);for(var\" h=\"i.length,l=t.width,$=t.height,u=this.context,p=this._$xP,f=this._$uP,c=this._$6r,d=this._$3r,g=nt.tr,y=nt._$Ti,m=nt._$Pi,T=nt._$B,P=0;P<h;P+=3){u.save();var\" s=\"i[P],v=i[P+1],L=i[P+2],M=p+c*e[2*S],E=f+d*e[2*S+1],A=p+c*e[2*v],I=f+d*e[2*v+1],w=p+c*e[2*L],x=f+d*e[2*L+1];s&&(s._$PS(M,E,T),M=T[0],E=T[1],s._$PS(A,I,T),A=T[0],I=T[1],s._$PS(w,x,T),w=T[0],x=T[1]);var\" o=\"l*r[2*S],D=$-$*r[2*S+1],R=l*r[2*v],b=$-$*r[2*v+1],F=l*r[2*L],C=$-$*r[2*L+1],N=Math.atan2(b-D,R-O),B=Math.atan2(I-E,A-M),U=A-M,G=I-E,Y=Math.sqrt(U*U+G*G),k=R-O,V=b-D,X=Math.sqrt(k*k+V*V),z=Y/X;It._$ni(F,C,O,D,R-O,b-D,-(b-D),R-O,y),It._$ni(w,x,M,E,A-M,I-E,-(I-E),A-M,m);var\" it=\"a._$e0;if(it.gl_cacheImage=it.gl_cacheImage||{},!it.gl_cacheImage[P]){var\" et=\"nt.createCanvas(K-Q,tt-Z);at.DEBUG_DATA.LDGL_CANVAS_MB=at.DEBUG_DATA.LDGL_CANVAS_MB||0,at.DEBUG_DATA.LDGL_CANVAS_MB+=(K-Q)*(tt-Z)*4;var\" rt=\"et.getContext(\" 2d\");rt.translate(-q,-z),nt.clip(rt,g,n,y,o,d,r,b,f,c,m,e,a,i,w,x),rt.drawimage(t,0,0),it.gl_cacheimage[p]=\"{cacheCanvas:et,cacheContext:rt}}u.drawImage(it.gl_cacheImage[P].cacheCanvas,Q,Z)}else\"\" at.ignore_clip||nt.clip(u,g,n,y,o,d,r,b,f,c,m,e,a,i,w,x),at.use_adjust_translation&&(w=\"0,j=l,q=0,J=$),u.drawImage(t,W,q,j-W,J-q,W,q,j-W,J-q);u.restore()}}catch(t){_._$Rb(t)}},nt.clip=function(t,i,e,r,o,n,s,_,a,h,l,$,u,p,f,c){e\">.02?nt.expandClip(t,i,e,r,l,$,u,p,f,c):nt.clipWithTransform(t,null,o,n,s,_,a,h)},nt.expandClip=function(t,i,e,r,o,n,s,_,a,h){var l=s-o,$=_-n,u=a-o,p=h-n,f=l*p-$*u>0?e:-e,c=-$,d=l,g=a-s,y=h-_,m=-y,T=g,P=Math.sqrt(g*g+y*y),S=-p,v=u,L=Math.sqrt(u*u+p*p),M=o-f*c/r,E=n-f*d/r,A=s-f*c/r,I=_-f*d/r,w=s-f*m/P,x=_-f*T/P,O=a-f*m/P,D=h-f*T/P,R=o+f*S/L,b=n+f*v/L,F=a+f*S/L,C=h+f*v/L,N=nt._$50;return null!=i._$P2(N)&&(nt.clipWithTransform(t,N,M,E,A,I,w,x,O,D,F,C,R,b),!0)},nt.clipWithTransform=function(t,i,e,r,o,n,s,a){if(arguments.length<7)return void _._$li(\"err : @ldgl.clip()\");if(!(arguments[1]instanceof gt))return a[0] is _$6 ldtransform @ldgl.clip()\");var h=\"nt._$B,l=i,$=arguments;if(t.beginPath(),l){l._$PS($[2],$[3],h),t.moveTo(h[0],h[1]);for(var\" u=\"4;u<$.length;u+=2)l._$PS($[u],$[u+1],h),t.lineTo(h[0],h[1])}else{t.moveTo($[2],$[3]);for(var\" e=\"document.createElement(\" canvas\");return\" e.setattribute(\"width\",t),e.setattribute(\"height\",i),e||_._$li(\"err \"+e),e},nt.dumpvalues=\"function(){for(var\" t ,i=\"0;i<arguments.length;i++)t+=\" [\"+i+\"]=\" \" +arguments[i].tofixed(3)+\" , \";console.log(t)},st.prototype._$f0=\"function(t){this._$TT=t._$_T(),this._$LT=t._$_T(),this._$FS=t._$_T(),this._$wL=t._$nP()},st.prototype.getMinValue=function(){return\" this._$tt},st.prototype.getmaxvalue=\"function(){return\" this._$lt},st.prototype.getdefaultvalue=\"function(){return\" this._$fs},st.prototype.getparamid=\"function(){return\" this._$wl},_t.prototype._$yo=\"function(){return\" this._$at&&!this._$js},_t.prototype._$hs=\"function(t){this._$AT=t},_t.prototype._$GT=function(){return\" this._$e0},_t.prototype._$l2=\"function(t){this._$IP=t},_t.prototype.getPartsIndex=function(){return\" this._$ip},_t.prototype._$x2=\"function(){return\" this._$js},_t.prototype._$ib=\"function(t){this._$JS=t},_t.prototype.getTotalScale=function(){return\" this.totalscale},_t.prototype.settotalscale_notforclient=\"function(t){this.totalScale=t},_t.prototype.getInterpolatedOpacity=function(){return\" this._$7s},_t.prototype.setinterpolatedopacity=\"function(t){this._$7s=t},_t.prototype.getTotalOpacity=function(t){return\" this.totalopacity},_t.prototype.settotalopacity=\"function(t){this.totalOpacity=t},at._$2s=\" 2.1.00_1\",at._$kr=\"201001e3,at._$sP=!0,at._$so=!0,at._$cb=!1,at._$3T=!0,at._$Ts=!0,at._$fb=!0,at._$ts=!0,at.L2D_DEFORMER_EXTEND=!0,at._$Wb=!1;at._$yr=!1,at._$Zs=!1,at.L2D_NO_ERROR=0,at._$i7=1e3,at._$9s=1001,at._$es=1100,at._$r7=2e3,at._$07=2001,at._$b7=2002,at._$H7=4e3,at.L2D_COLOR_BLEND_MODE_MULT=0,at.L2D_COLOR_BLEND_MODE_ADD=1,at.L2D_COLOR_BLEND_MODE_INTERPOLATE=2,at._$6b=!0,at._$cT=0,at.clippingMaskBufferSize=256,at.glContext=new\"\" array,at.framebuffers=\"new\" array,at.ftexture=\"new\" array,at.ignore_clip=\"!1,at.IGNORE_EXPAND=!1,at.EXPAND_W=2,at.USE_ADJUST_TRANSLATION=!0,at.USE_CANVAS_TRANSFORM=!0,at.USE_CACHED_POLYGON_IMAGE=!1,at.DEBUG_DATA={},at.PROFILE_IOS_SPEED={PROFILE_NAME:\" ios\" speed\",use_adjust_translation:!0,use_cached_polygon_image:!0,expand_w:4},at.profile_ios_quality=\"{PROFILE_NAME:\" hiq\",use_adjust_translation:!0,use_cached_polygon_image:!1,expand_w:2},at.profile_ios_default=\"at.PROFILE_IOS_QUALITY,at.PROFILE_ANDROID={PROFILE_NAME:\" android\",use_adjust_translation:!1,use_cached_polygon_image:!1,expand_w:2},at.profile_desktop=\"{PROFILE_NAME:\"Desktop\",USE_ADJUST_TRANSLATION:!1,USE_CACHED_POLYGON_IMAGE:!1,EXPAND_W:2},at.initProfile=function(){Et.isIOS()?at.setupProfile(at.PROFILE_IOS_DEFAULT):Et.isAndroid()?at.setupProfile(at.PROFILE_ANDROID):at.setupProfile(at.PROFILE_DESKTOP)},at.setupProfile=function(t,i){if(\"number\"==typeof\"\" t)switch(t){case 9901:t=\"at.PROFILE_IOS_SPEED;break;case\" 9902:t=\"at.PROFILE_IOS_QUALITY;break;case\" 9903:t=\"at.PROFILE_IOS_DEFAULT;break;case\" 9904:t=\"at.PROFILE_ANDROID;break;case\" 9905:t=\"at.PROFILE_DESKTOP;break;default:alert(\" profile\" _$ui \"+t)}arguments.length<2&&(i=\"!0),i&&console.log(\" \"+t.profile_name);for(var in t)at[e]=\"t[e],i&&console.log(\" \" [\"+e+\"]=\"+t[e])},at.init=function(){if(at._$6b){console.log(\" live2d %s\",at._$2s),at._$6b=\"!1;!0,at.initProfile()}},at.getVersionStr=function(){return\" at._$2s},at.getversionno=\"function(){return\" at._$kr},at._$st=\"function(t){at._$cT=t},at.getError=function(){var\" at._$ct=\"0,t},at.dispose=function(){at.glContext=[],at.frameBuffers=[],at.fTexture=[]},at.setGL=function(t,i){var\" at.glcontext[t]},at.setclippingmaskbuffersize=\"function(t){at.clippingMaskBufferSize=t},at.getClippingMaskBufferSize=function(){return\" at.clippingmaskbuffersize},at.deletebuffer=\"function(t){at.getGL(t).deleteFramebuffer(at.frameBuffers[t].framebuffer),delete\" at.framebuffers[t],delete at.glcontext[t]},ht._$r2=\"function(t){return\" t<0?0:t>1?1:.5-.5*Math.cos(t*Lt.PI_F)},lt._$fr=-1,lt.prototype.toString=function(){return this._$ib},$t.prototype=new W,$t._$42=0,$t._$Os=30,$t._$ms=0,$t._$ns=1,$t._$_s=2,$t._$gT=new Array,$t.prototype._$_S=function(t){this._$LP=t},$t.prototype.getTextureNo=function(){return this._$LP},$t.prototype._$ZL=function(){return this._$Qi},$t.prototype._$H2=function(){return this._$JP},$t.prototype.getNumPoints=function(){return this._$d0},$t.prototype.getType=function(){return W._$wb},$t.prototype._$B2=function(t,i,e){var r=i,o=null!=r._$hr?r._$hr:r._$Cr;switch(U._$do){default:case U._$Ms:throw new Error(\"_$L _$ro \");case U._$Qs:for(var n=this._$d0-1;n>=0;--n)o[n*U._$No+4]=e}},$t.prototype._$zP=function(){this._$GS=new D,this._$GS._$zP()},$t.prototype._$F0=function(t){W.prototype._$F0.call(this,t),this._$LP=t._$6L(),this._$d0=t._$6L(),this._$Yo=t._$6L();var i=t._$nP();this._$BP=new Int16Array(3*this._$Yo);for(var e=3*this._$Yo-1;e>=0;--e)this._$BP[e]=i[e];if(this._$Eo=t._$nP(),this._$Qi=t._$nP(),t.getFormatVersion()>=G._$s7){if(this._$JP=t._$6L(),0!=this._$JP){if(0!=(1&this._$JP)){var r=t._$6L();null==this._$5P&&(this._$5P=new Object),this._$5P._$Hb=parseInt(r)}0!=(this._$JP&$t._$Os)?this._$6s=(this._$JP&$t._$Os)>>1:this._$6s=$t._$ms,0!=(32&this._$JP)&&(this.culling=!1)}}else this._$JP=0},$t.prototype.init=function(t){var i=new ut(this),e=this._$d0*U._$No,r=this._$32();switch(null!=i._$Cr&&(i._$Cr=null),i._$Cr=new Float32Array(e),null!=i._$hr&&(i._$hr=null),i._$hr=r?new Float32Array(e):null,U._$do){default:case U._$Ms:if(U._$Ls)for(var o=this._$d0-1;o>=0;--o){var n=o<<1;this._$qi[n+1]=1-this._$qi[n+1]}break;case u._$qs:for(var o=\"this._$d0-1;o\">=0;--o){var n=o<<1,s=o*u._$no,_=this._$qi[n],a=this._$qi[n+1];i._$cr[s]=_,i._$cr[s+1]=a,i._$cr[s+4]=0,r&&(i._$hr[s]=_,i._$hr[s+1]=a,i._$hr[s+4]=0)}}return i},$t.prototype._$nr=\"function(t,i){var\" e=\"i;if(this!=e._$GT()&&console.log(\" ###\" assert!! ### \"),this._$gs._$ur(t)&&(w.prototype._$nr.call(this,t,e),!e._$is[0])){var r=\"$t._$gT;r[0]=!1,v._$Vr(t,this._$GS,r,this._$d0,this._$Eo,e._$Cr,U._$i2,U._$No)}},$t.prototype._$2b=function(t,i){try{this!=i._$GT()&&console.log(\" \");var o=\"this.getTargetBaseDataID();if(r._$8r==W._$ur&&(r._$8r=t.getBaseDataIndex(o)),r._$8r<0)at._$so&&_._$li(\" _$l\" _$0p _$g :: %s\",o);else{var n=\"t.getBaseData(r._$8r),s=t._$q2(r._$8r);null==n||s._$x2()?r._$AT=!1:(n._$nb(t,s,r._$Cr,r._$hr,this._$d0,U._$i2,U._$No),r._$AT=!0),r.baseOpacity=s.getTotalOpacity()}}}catch(t){throw\" t}},$t.prototype.draw=\"function(t,i,e){if(this!=e._$GT()&&console.log(\" \"),!e._$is[0]){var _$yi( %d ) , _$d0( _$yo( \\n\",this._$lp,this._$d0,this._$yo),console.log(\" _$oi _$di=\"{\" \");for(var t=\"0;t<this._$BP.length;t++)console.log(\" %5d\" ,\",this._$bp[t]);console.log(\"\\n _$5i _$30\");for(var _$30[%d]=\",t);for(var i=this._$Eo[t],e=0;e<i.length;e++)console.log(\" %6.2f, \",i[e])}console.log(\"\\n\")},$t.prototype._$72=\"function(t){return\" null=\"=this._$5P?null:this._$5P[t]},$t.prototype.getIndexArray=function(){return\" this._$bp},ut.prototype=\"new\" mt,ut.prototype.gettransformedpoints=\"function(){return\" null!=\"this._$hr?this._$hr:this._$Cr},pt.prototype._$HT=function(t){this.x=t.x,this.y=t.y},pt.prototype._$HT=function(t,i){this.x=t,this.y=i},ft.prototype=new\" i,ft.loadmodel=\"function(t){var\" ft;return i._$62(e,t),e},ft.loadmodel=\"function(t,e){var\" ft(r);return i._$62(o,t),o},ft._$to=\"function(){return\" new ft},ft._$er=\"function(t){var\" i=\"new\" _$5(\".. _$_r _$t0 _$ri _$_p._$d\");if(0=\"=i.exists())throw\" _$ls(\"_$t0 _$_ _$6 _$ui \"+i._$pl());for(var _$5(e[o]);if(0=\"=n.exists())throw\" \"+n._$pl());r.settexture(o,_$nl._$_o(t,n._$3b()))}return r},ft.prototype.setgl=\"function(t){at.setGL(t)},ft.prototype.setTransform=function(t){this.drawParamWebGL.setTransform(t)},ft.prototype.update=function(){this._$5S.update(),this._$5S.preDraw(this.drawParamWebGL)},ft.prototype.draw=function(){this._$5S.draw(this.drawParamWebGL)},ft.prototype._$K2=function(){this.drawParamWebGL._$K2()},ft.prototype.setTexture=function(t,i){null==this.drawParamWebGL&&_._$li(\" _$yi\" for qt _$ki _$xs() is _$ui!!\"),this.drawparamwebgl.settexture(t,i)},ft.prototype.settexture=\"function(t,i){null==this.drawParamWebGL&&_._$li(\" _$ui!!\"),this.drawparamwebgl.settexture(t,i)},ft.prototype._$rs=\"function(){return\" this.drawparamwebgl._$rs()},ft.prototype._$ds=\"function(t){this.drawParamWebGL._$Ds(t)},ft.prototype.getDrawParam=function(){return\" this.drawparamwebgl},ft.prototype.setmatrix=\"function(t){this.drawParamWebGL.setMatrix(t)},ft.prototype.setPremultipliedAlpha=function(t){this.drawParamWebGL.setPremultipliedAlpha(t)},ft.prototype.isPremultipliedAlpha=function(){return\" this.drawparamwebgl.ispremultipliedalpha()},ft.prototype.setanisotropy=\"function(t){this.drawParamWebGL.setAnisotropy(t)},ft.prototype.getAnisotropy=function(){return\" this.drawparamwebgl.getanisotropy()},ct.prototype._$tb=\"function(){return\" this.motions},ct.prototype.startmotion=\"function(t,i){for(var\">startMotion() / start _$K _$3 (m%d)\\n\",r,e._$sr));if(null==t)return-1;e=new dt,e._$w0=t,this.motions.push(e);var n=e._$sr;return this._$eb&&_._$Ji(\"MotionQueueManager[size:%2d]->startMotion() / new _$w0 (m%d)\\n\",r,n),n},ct.prototype.updateParam=function(t){try{for(var i=!1,e=0;e<this.motions.length;e++){var r=\"this.motions[e];if(null!=r){var\" o=\"r._$w0;null!=o?(o.updateParam(t,r),i=!0,r.isFinished()&&(this._$eb&&_._$Ji(\" motionqueuemanager[size:%2d]-\">updateParam() / _$T0 _$w0 (m%d)\\n\",this.motions.length-1,r._$sr),this.motions.splice(e,1),e--)):(this.motions=this.motions.splice(e,1),e--)}else this.motions.splice(e,1),e--}return i}catch(t){return _._$li(t),!0}},ct.prototype.isFinished=function(t){if(arguments.length>=1){for(var i=0;i<this.motions.length;i++){var e=\"this.motions[i];if(null!=e&&(e._$sr==t&&!e.isFinished()))return!1}return!0}for(var\" i=\"0;i<this.motions.length;i++){var\" this.motions.splice(i,1),i--}else this.motions.splice(i,1),i--}return!0},ct.prototype.stopallmotions=\"function(){for(var\" t=\"0;t<this.motions.length;t++){var\" this.motions.splice(t,1),t--}},ct.prototype._$zr=\"function(t){this._$eb=t},ct.prototype._$e=function(){console.log(\" --\" _$r --\\n\");for(var :: %s\\n\",this.motions.length,e.tostring())}},dt._$gs=\"0,dt.prototype.isFinished=function(){return\" this._$9l},dt.prototype._$qs=\"function(t){var\" this._$sr},gt.prototype.setcontext=\"function(t){var\" ,i=\"0;i<9;i++)t+=this.m[i].toFixed(2)+\" \" ,\";return t+=\" }\" },gt.prototype.identity=\"function(){var\" array(0,0));var r=\"this.m;return\" e[0]=\"r[0]*t+r[3]*i+r[6],e[1]=r[1]*t+r[4]*i+r[7],e},gt.prototype._$P2=function(t){t||(t=new\" gt);var null;var u=\"1/$;return\" t.m[0]=\"u*(s*l-h*_),t.m[1]=u*(h*o-r*l),t.m[2]=u*(r*_-s*o),t.m[3]=u*(a*_-n*l),t.m[4]=u*(e*l-a*o),t.m[5]=u*(n*o-e*_),t.m[6]=u*(n*h-a*s),t.m[7]=u*(a*r-e*h),t.m[8]=u*(e*s-n*r),t},gt.prototype.transform=function(t,i,e){null==e&&(e=new\" et,yt._$et=\"null,yt._$tP=new\" object,yt._$2o=\"function(){return\" null=\"=yt._$eT&&(yt._$eT=yt.getID(\" dst_base\")),yt._$et},yt._$27=\"function(){yt._$tP.clear(),yt._$eT=null},yt.getID=function(t){var\"\" yt(t),yt._$tp[t]=\"i),i},yt.prototype._$3s=function(){return\" new yt},mt.prototype=\"new\" e,mt._$9r=\"function(t){return\" float32array(t)},mt._$vb=\"function(t){return\" int16array(t)},mt._$cr=\"function(t,i){return\" this._$gr},mt._$as=\"function(t){this._$Gr=t},mt.prototype.getGL=function(){return\" this.gl},mt.prototype.setgl=\"function(t){this.gl=t},mt.prototype.setTransform=function(t){this.transform=t},mt.prototype._$ZT=function(){var\" a=\"(n\">.9&&at.EXPAND_W,this.gl);if(null==this.gl)throw new Error(\"gl is null\");var h=1*this._$C0*n,l=1*this._$tT*n,$=1*this._$WL*n,u=this._$lT*n;if(null!=this.clipBufPre_clipContextMask){a.frontFace(a.CCW),a.useProgram(this.shaderProgram),this._$vS=Tt(a,this._$vS,r),this._$no=Pt(a,this._$no,e),a.enableVertexAttribArray(this.a_position_Loc),a.vertexAttribPointer(this.a_position_Loc,2,a.FLOAT,!1,0,0),this._$NT=Tt(a,this._$NT,o),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.textures[t]),a.uniform1i(this.s_texture0_Loc,1),a.enableVertexAttribArray(this.a_texCoord_Loc),a.vertexAttribPointer(this.a_texCoord_Loc,2,a.FLOAT,!1,0,0),a.uniformMatrix4fv(this.u_matrix_Loc,!1,this.getClipBufPre_clipContextMask().matrixForMask);var p=this.getClipBufPre_clipContextMask().layoutChannelNo,f=this.getChannelFlagAsColor(p);a.uniform4f(this.u_channelFlag,f.r,f.g,f.b,f.a);var c=this.getClipBufPre_clipContextMask().layoutBounds;a.uniform4f(this.u_baseColor_Loc,2*c.x-1,2*c.y-1,2*c._$EL()-1,2*c._$5T()-1),a.uniform1i(this.u_maskFlag_Loc,!0)}else if(null!=this.getClipBufPre_clipContextDraw()){a.useProgram(this.shaderProgramOff),this._$vS=Tt(a,this._$vS,r),this._$no=Pt(a,this._$no,e),a.enableVertexAttribArray(this.a_position_Loc_Off),a.vertexAttribPointer(this.a_position_Loc_Off,2,a.FLOAT,!1,0,0),this._$NT=Tt(a,this._$NT,o),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.textures[t]),a.uniform1i(this.s_texture0_Loc_Off,1),a.enableVertexAttribArray(this.a_texCoord_Loc_Off),a.vertexAttribPointer(this.a_texCoord_Loc_Off,2,a.FLOAT,!1,0,0),a.uniformMatrix4fv(this.u_clipMatrix_Loc_Off,!1,this.getClipBufPre_clipContextDraw().matrixForDraw),a.uniformMatrix4fv(this.u_matrix_Loc_Off,!1,this.matrix4x4),a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,at.fTexture[this.glno]),a.uniform1i(this.s_texture1_Loc_Off,2);var p=this.getClipBufPre_clipContextDraw().layoutChannelNo,f=this.getChannelFlagAsColor(p);a.uniform4f(this.u_channelFlag_Loc_Off,f.r,f.g,f.b,f.a),a.uniform4f(this.u_baseColor_Loc_Off,h,l,$,u)}else a.useProgram(this.shaderProgram),this._$vS=Tt(a,this._$vS,r),this._$no=Pt(a,this._$no,e),a.enableVertexAttribArray(this.a_position_Loc),a.vertexAttribPointer(this.a_position_Loc,2,a.FLOAT,!1,0,0),this._$NT=Tt(a,this._$NT,o),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.textures[t]),a.uniform1i(this.s_texture0_Loc,1),a.enableVertexAttribArray(this.a_texCoord_Loc),a.vertexAttribPointer(this.a_texCoord_Loc,2,a.FLOAT,!1,0,0),a.uniformMatrix4fv(this.u_matrix_Loc,!1,this.matrix4x4),a.uniform4f(this.u_baseColor_Loc,h,l,$,u),a.uniform1i(this.u_maskFlag_Loc,!1);this.culling?this.gl.enable(a.CULL_FACE):this.gl.disable(a.CULL_FACE),this.gl.enable(a.BLEND);var d,g,y,m;if(null!=this.clipBufPre_clipContextMask)d=a.ONE,g=a.ONE_MINUS_SRC_ALPHA,y=a.ONE,m=a.ONE_MINUS_SRC_ALPHA;else switch(s){case $t._$ms:d=a.ONE,g=a.ONE_MINUS_SRC_ALPHA,y=a.ONE,m=a.ONE_MINUS_SRC_ALPHA;break;case $t._$ns:d=a.ONE,g=a.ONE,y=a.ZERO,m=a.ONE;break;case $t._$_s:d=a.DST_COLOR,g=a.ONE_MINUS_SRC_ALPHA,y=a.ZERO,m=a.ONE}a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(d,g,y,m),this.anisotropyExt&&a.texParameteri(a.TEXTURE_2D,this.anisotropyExt.TEXTURE_MAX_ANISOTROPY_EXT,this.maxAnisotropy);var T=e.length;a.drawElements(a.TRIANGLES,T,a.UNSIGNED_SHORT,0),a.bindTexture(a.TEXTURE_2D,null)}},mt.prototype._$Rs=function(){throw new Error(\"_$Rs\")},mt.prototype._$Ds=function(t){throw new Error(\"_$Ds\")},mt.prototype._$K2=function(){for(var t=0;t<this.textures.length;t++){0!=this.textures[t]&&(this.gl._$k2(1,this.textures,t),this.textures[t]=null)}},mt.prototype.settexture=function(t,i){this.textures[t]=i},mt.prototype.initshader=function(){var t=\"this.gl;this.loadShaders2(),this.a_position_Loc=t.getAttribLocation(this.shaderProgram,\" a_position\"),this.a_texcoord_loc=\"t.getAttribLocation(this.shaderProgram,\"a_texCoord\"),this.u_matrix_Loc=t.getUniformLocation(this.shaderProgram,\"u_mvpMatrix\"),this.s_texture0_Loc=t.getUniformLocation(this.shaderProgram,\"s_texture0\"),this.u_channelFlag=t.getUniformLocation(this.shaderProgram,\"u_channelFlag\"),this.u_baseColor_Loc=t.getUniformLocation(this.shaderProgram,\"u_baseColor\"),this.u_maskFlag_Loc=t.getUniformLocation(this.shaderProgram,\"u_maskFlag\"),this.a_position_Loc_Off=t.getAttribLocation(this.shaderProgramOff,\"a_position\"),this.a_texCoord_Loc_Off=t.getAttribLocation(this.shaderProgramOff,\"a_texCoord\"),this.u_matrix_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_mvpMatrix\"),this.u_clipMatrix_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_ClipMatrix\"),this.s_texture0_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"s_texture0\"),this.s_texture1_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"s_texture1\"),this.u_channelFlag_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_channelFlag\"),this.u_baseColor_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_baseColor\")},mt.prototype.disposeShader=function(){var\"\" e=\"this.gl,r=i,o=e.createShader(t);if(null==o)return\" _._$ji(\"_$l0 to create shader\"),null;if(e.shadersource(o,r),e.compileshader(o),!e.getshaderparameter(o,e.compile_status)){var n=\"e.getShaderInfoLog(o);return\" compile shader : \"+n),e.deleteshader(o),null}return o},mt.prototype.loadshaders2=\"function(){var\" vec4 a_position;attribute vec2 a_texcoord;varying v_texcoord;varying v_clippos;uniform mat4 u_mvpmatrix;void main(){ gl_position=\"u_mvpMatrix\" * a_position; v_clippos=\"u_mvpMatrix\" v_texcoord=\"a_texCoord;}\" ),!this.vertshader)return\" _._$ji(\"vertex _$li!\"),!1;if(this.vertshaderoff=\"this.compileShader(t.VERTEX_SHADER,\" attribute\" u_mvpmatrix;uniform u_clipmatrix;void ;}\"),!this.vertshaderoff)return _._$ji(\"offvertex _$li!\"),!1;if(this.fragshader=\"this.compileShader(t.FRAGMENT_SHADER,\" precision\" mediump float;varying sampler2d s_texture0;uniform u_channelflag;uniform u_basecolor;uniform bool u_maskflag;void smpcolor; if(u_maskflag){ float isinside=\"step(u_baseColor.x,\" v_clippos.x v_clippos.w) step(u_basecolor.y, v_clippos.y step(v_clippos.x v_clippos.w, u_basecolor.z) step(v_clippos.y u_basecolor.w); smpcolor=\"u_channelFlag\" texture2d(s_texture0 , v_texcoord).a isinside; }else{ v_texcoord) u_basecolor; } gl_fragcolor=\"smpColor;}\" ),!this.fragshader)return\" _._$ji(\"fragment _$li!\"),!1;if(this.fragshaderoff=\"this.compileShader(t.FRAGMENT_SHADER,\" ;varying s_texture1;uniform u_basecolor ;void col_formask=\"texture2D(s_texture0,\" clipmask=\"texture2D(s_texture1,\" v_clippos.xy u_channelflag; maskval=\"clipMask.r\" + clipmask.g clipmask.b clipmask.a; maskval; _._$ji(\"offfragment _$li!\"),!1;if(t.attachshader(this.shaderprogram,this.vertshader),t.attachshader(this.shaderprogram,this.fragshader),t.attachshader(this.shaderprogramoff,this.vertshaderoff),t.attachshader(this.shaderprogramoff,this.fragshaderoff),t.linkprogram(this.shaderprogram),t.linkprogram(this.shaderprogramoff),!t.getprogramparameter(this.shaderprogram,t.link_status)){var i=\"t.getProgramInfoLog(this.shaderProgram);return\" link program: \"+i),this.vertshader&&(t.deleteshader(this.vertshader),this.vertshader=\"0),this.fragShader&&(t.deleteShader(this.fragShader),this.fragShader=0),this.shaderProgram&&(t.deleteProgram(this.shaderProgram),this.shaderProgram=0),this.vertShaderOff&&(t.deleteShader(this.vertShaderOff),this.vertShaderOff=0),this.fragShaderOff&&(t.deleteShader(this.fragShaderOff),this.fragShaderOff=0),this.shaderProgramOff&&(t.deleteProgram(this.shaderProgramOff),this.shaderProgramOff=0),!1}return!0},mt.prototype.createFramebuffer=function(){var\" r=\"t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,i,i),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,r);var\" o=\"t.createTexture();return\" t.bindtexture(t.texture_2d,o),t.teximage2d(t.texture_2d,0,t.rgba,i,i,0,t.rgba,t.unsigned_byte,null),t.texparameteri(t.texture_2d,t.texture_min_filter,t.linear),t.texparameteri(t.texture_2d,t.texture_mag_filter,t.linear),t.texparameteri(t.texture_2d,t.texture_wrap_s,t.clamp_to_edge),t.texparameteri(t.texture_2d,t.texture_wrap_t,t.clamp_to_edge),t.framebuffertexture2d(t.framebuffer,t.color_attachment0,t.texture_2d,o,0),t.bindtexture(t.texture_2d,null),t.bindrenderbuffer(t.renderbuffer,null),t.bindframebuffer(t.framebuffer,null),at.ftexture[this.glno]=\"o,{framebuffer:e,renderbuffer:r,texture:at.fTexture[this.glno]}},St.prototype._$fP=function(){var\" t,i,e,r=\"this._$ST();if(0==(128&r))return\" 255&r;if(0=\"=(128&(t=this._$ST())))return(127&r)<<7|127&t;if(0==(128&(i=this._$ST())))return(127&r)<<14|(127&t)<<7|255&i;if(0==(128&(e=this._$ST())))return(127&r)<<21|(127&t)<<14|(127&i)<<7|255&e;throw\" new lt(\"_$l _$0p _\")},st.prototype.getformatversion=\"function(){return\" this._$s2},st.prototype._$gr=\"function(t){this._$S2=t},St.prototype._$3L=function(){return\" this._$fp()},st.prototype._$mp=\"function(){return\" this._$zt(),this._$f+=\"8,this._$T.getFloat64(this._$F-8)},St.prototype._$_T=function(){return\" this._$zt(),this._$t.getint8(this._$f++)},st.prototype._$9t=\"function(){return\" _$q read long\")},st.prototype._$po=\"function(){return\" this._$zt(),0!=\"this._$T.getInt8(this._$F++)};var\" xt=\"!0;St.prototype._$bT=function(){this._$zT();var\" arraybuffer(2*t);i=\"new\" uint16array(e);for(var string.fromcharcode.apply(null,i)}catch(t){xt=\"!1}try{var\" array;if(null=\"=i)for(var\" for(var string.fromcharcode.apply(null,o)}catch(t){console.log(\"read utf8 _$rt _$l0 !! \"+t)}},st.prototype._$cs=\"function(){this._$zT();for(var\" int32array(t),e=\"0;e<t;e++)i[e]=this._$T.getInt32(this._$F),this._$F+=4;return\" i},st.prototype._$tb=\"function(){this._$zT();for(var\" float32array(t),e=\"0;e<t;e++)i[e]=this._$T.getFloat32(this._$F),this._$F+=4;return\" i},st.prototype._$5b=\"function(){this._$zT();for(var\" float64array(t),e=\"0;e<t;e++)i[e]=this._$T.getFloat64(this._$F),this._$F+=8;return\" i},st.prototype._$np=\"function(){return\" this._$jb(-1)},st.prototype._$jb=\"function(t){if(this._$zT(),t<0&&(t=this._$3L()),t==G._$7P){var\" this._$ko[i];throw lt(\"_$sl _$4i @_$m0\")}var this._$ko.push(e),e},st.prototype._$4b=\"function(t){if(0==t)return\" null;if(50=\"=t){var\" e}if(51=\"=t){var\" e}if(134=\"=t){var\" e}if(60=\"=t){var\" e}if(t>=48){var r=G._$9o(t);return null!=r?(r._$F0(this),r):null}switch(t){case 1:return this._$bT();case 10:return new n(this._$6L(),!0);case 11:return new S(this._$mP(),this._$mP(),this._$mP(),this._$mP());case 12:return new S(this._$_T(),this._$_T(),this._$_T(),this._$_T());case 13:return new L(this._$mP(),this._$mP());case 14:return new L(this._$_T(),this._$_T());case 15:for(var o=this._$3L(),e=new Array(o),s=0;s<o;s++)e[s]=this._$np();return 0=\"=this._$hL?this._$v0=this._$ST():8==this._$hL&&(this._$v0=this._$ST(),this._$hL=0),1==(this._$v0\" e;case 17:var e=\"new\" f(this._$mp(),this._$mp(),this._$mp(),this._$mp(),this._$mp(),this._$mp());return 21:return new h(this._$6l(),this._$6l(),this._$6l(),this._$6l());case 22:return pt(this._$6l(),this._$6l());case 23:throw error(\"_$l _$ro \");case 16:case 25:return this._$cs();case 26:return this._$5b();case 27:return this._$tb();case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 18:case 19:case 20:case 24:case 28:throw lt(\"_$6 _$q : _$np() of 2-9 ,18,19,20,24,28 \"+t);default:throw no _$i \"+t)}},st.prototype._$8l=\"function(){return\">>7-this._$hL++&1)},St.prototype._$zT=function(){0!=this._$hL&&(this._$hL=0)},vt.prototype._$wP=function(t,i,e){for(var r=0;r<e;r++){for(var o=\"0;o<i;o++){var\" n=\"2*(o+r*i);console.log(\" (%\" 7.3f , % 7.3f) \",t[n],t[n+1])}console.log(\"\\n\")}console.log(\"\\n\")},lt._$2s=\"Math.PI/180,Lt._$bS=Math.PI/180,Lt._$wS=180/Math.PI,Lt._$NS=180/Math.PI,Lt.PI_F=Math.PI,Lt._$kT=[0,.012368,.024734,.037097,.049454,.061803,.074143,.086471,.098786,.111087,.12337,.135634,.147877,.160098,.172295,.184465,.196606,.208718,.220798,.232844,.244854,.256827,.268761,.280654,.292503,.304308,.316066,.327776,.339436,.351044,.362598,.374097,.385538,.396921,.408243,.419502,.430697,.441826,.452888,.463881,.474802,.485651,.496425,.507124,.517745,.528287,.538748,.549126,.559421,.56963,.579752,.589785,.599728,.609579,.619337,.629,.638567,.648036,.657406,.666676,.675843,.684908,.693867,.70272,.711466,.720103,.72863,.737045,.745348,.753536,.76161,.769566,.777405,.785125,.792725,.800204,.807561,.814793,.821901,.828884,.835739,.842467,.849066,.855535,.861873,.868079,.874153,.880093,.885898,.891567,.897101,.902497,.907754,.912873,.917853,.922692,.92739,.931946,.936359,.940629,.944755,.948737,.952574,.956265,.959809,.963207,.966457,.96956,.972514,.97532,.977976,.980482,.982839,.985045,.987101,.989006,.990759,.992361,.993811,.995109,.996254,.997248,.998088,.998776,.999312,.999694,.999924,1],Lt._$92=function(t,i){var\" e=\"Math.atan2(t[1],t[0]),r=Math.atan2(i[1],i[0]);return\" lt._$ts(e,r)},lt._$ts=\"function(t,i){for(var\">Math.PI;)e-=2*Math.PI;return e},Lt._$9=function(t){return Math.sin(t)},Lt.fcos=function(t){return Math.cos(t)},Mt.prototype._$u2=function(){return this._$IS[0]},Mt.prototype._$yo=function(){return this._$AT&&!this._$IS[0]},Mt.prototype._$GT=function(){return this._$e0},Et._$W2=0,Et.SYSTEM_INFO=null,Et.USER_AGENT=navigator.userAgent,Et.isIPhone=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isIPhone},Et.isIOS=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isIPhone||Et.SYSTEM_INFO._isIPad},Et.isAndroid=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isAndroid},Et.getOSVersion=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO.version},Et.getOS=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isIPhone||Et.SYSTEM_INFO._isIPad?\"iOS\":Et.SYSTEM_INFO._isAndroid?\"Android\":\"_$Q0 OS\"},Et.setup=function(){function t(t,i){for(var e=t.substring(i).split(/[ _,;\\.]/),r=0,o=0;o<=2&&!isnan(e[o]);o++){var n=\"parseInt(e[o]);if(n<0||n\">999){_._$li(\"err : \"+n+\" @UtHtml5.setup()\"),r=0;break}r+=n*Math.pow(1e3,2-o)}return r}var i,e=Et.USER_AGENT,r=Et.SYSTEM_INFO={userAgent:e};if((i=e.indexOf(\"iPhone OS \"))>=0)r.os=\"iPhone\",r._isIPhone=!0,r.version=t(e,i+\"iPhone OS \".length);else if((i=e.indexOf(\"iPad\"))>=0){if((i=e.indexOf(\"CPU OS\"))<0)return void _._$li(\" err : \"+e+\" @uthtml5.setup()\");r.os=\"iPad\" ,r._isipad=\"!0,r.version=t(e,i+\" cpu\" os \".length)}else(i=\"e.indexOf(\" android\"))\">=0?(r.os=\"Android\",r._isAndroid=!0,r.version=t(e,i+\"Android \".length)):(r.os=\"-\",r.version=-1)},window.UtSystem=w,window.UtDebug=_,window.LDTransform=gt,window.LDGL=nt,window.Live2D=at,window.Live2DModelWebGL=ft,window.Live2DModelJS=q,window.Live2DMotion=J,window.MotionQueueManager=ct,window.PhysicsHair=f,window.AMotion=s,window.PartsDataID=l,window.DrawDataID=b,window.BaseDataID=yt,window.ParamID=u,at.init();var At=!1}()}).call(i,e(7))},function(t,i){t.exports={import:function(){throw new Error(\"System.import cannot be used indirectly\")}}},function(t,i,e){\"use strict\";function r(t){return t&&t.__esModule?t:{default:t}}function o(){this.models=[],this.count=-1,this.reloadFlg=!1,Live2D.init(),n.Live2DFramework.setPlatformManager(new _.default)}Object.defineProperty(i,\"__esModule\",{value:!0}),i.default=o;var n=e(0),s=e(9),_=r(s),a=e(10),h=r(a),l=e(1),$=r(l);o.prototype.createModel=function(){var t=new h.default;return this.models.push(t),t},o.prototype.changeModel=function(t,i){if(this.reloadFlg){this.reloadFlg=!1;this.releaseModel(0,t),this.createModel(),this.models[0].load(t,i)}},o.prototype.getModel=function(t){return t>=this.models.length?null:this.models[t]},o.prototype.releaseModel=function(t,i){this.models.length<=t||(this.models[t].release(i),delete this.models[t],this.models.splice(t,1))},o.prototype.nummodels=\"function(){return\" this.models.length},o.prototype.setdrag=\"function(t,i){for(var\" e=\"0;e<this.models.length;e++)this.models[e].setDrag(t,i)},o.prototype.maxScaleEvent=function(){$.default.DEBUG_LOG&&console.log(\" max\" scale event.\");for(var t=\"0;t<this.models.length;t++)this.models[t].startRandomMotion($.default.MOTION_GROUP_PINCH_IN,$.default.PRIORITY_NORMAL)},o.prototype.minScaleEvent=function(){$.default.DEBUG_LOG&&console.log(\" min\" view x:\"+t+\" y:\"+i);for(var face.\"),this.models[e].setrandomexpression()):this.models[e].hittest($.default.hit_area_body,t,i)?($.default.debug_log&&console.log(\"tap body. models[\"+e+\"]\"),this.models[e].startrandommotion($.default.motion_group_tap_body,$.default.priority_normal)):this.models[e].hittestcustom(\"head\",t,i)?($.default.debug_log&&console.log(\"tap face.\"),this.models[e].startrandommotion($.default.motion_group_flick_head,$.default.priority_normal)):this.models[e].hittestcustom(\"body\",t,i)&&($.default.debug_log&&console.log(\"tap models[\"+e+\"]\"),this.models[e].startrandommotion($.default.motion_group_tap_body,$.default.priority_normal));return!0}},function(t,i,e){\"use strict\";function r(){}object.defineproperty(i,\"__esmodule\",{value:!0}),i.default=\"r;var\" o=\"e(2);r.prototype.loadBytes=function(t,i){var\" xmlhttprequest;e.open(\"get\",t,!0),e.responsetype=\"arraybuffer\" ,e.onload=\"function(){switch(e.status){case\" 200:i(e.response);break;default:console.error(\"failed to load (\"+e.status+\") : \"+t)}},e.send(null)},r.prototype.loadstring=\"function(t){this.loadBytes(t,function(t){return\" t})},r.prototype.loadlive2dmodel=\"function(t,i){var\" n=\"new\" image;n.crossorigin=\"Anonymous\" ,n.src=\"e;n.onload=function(){var\" console.error(\"failed generate gl texture name.\"),-1;0=\"=t.isPremultipliedAlpha()&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D),t.setTexture(i,s),s=null,\" function\"=\"=typeof\"\" r&&r()},n.onerror=\"function(){console.error(\" failed\" image \"+e)}},r.prototype.jsonparsefrombytes=\"function(t){var\" i,e=\"new\" uint8array(t,0,3);return i=\"239==e[0]&&187==e[1]&&191==e[2]?String.fromCharCode.apply(null,new\" uint8array(t,3)):string.fromcharcode.apply(null,new uint8array(t)),json.parse(i)},r.prototype.log=\"function(t){}},function(t,i,e){\" use\" r(t){return t&&t.__esmodule?t:{default:t}}function o(){n.l2dbasemodel.prototype.constructor.call(this),this.modelhomedir ,this.modelsetting=\"null,this.tmpMatrix=[]}Object.defineProperty(i,\" __esmodule\",{value:!0}),i.default=\"o;var\"\" n.l2dbasemodel,o.prototype.load=\"function(t,i,e){this.setUpdating(!0),this.setInitialized(!1),this.modelHomeDir=i.substring(0,i.lastIndexOf(\" \")+1),this.modelsetting=\"new\"\" _.default;var r=\"this;this.modelSetting.loadModelSetting(i,function(){var\" var>0){r.expressions={};for(var t=0;t</=t||(this.models[t].release(i),delete></0)return></=2&&!isnan(e[o]);o++){var></e;r++){for(var></o;s++)e[s]=this._$np();return></this.textures.length;t++){0!=this.textures[t]&&(this.gl._$k2(1,this.textures,t),this.textures[t]=null)}},mt.prototype.settexture=function(t,i){this.textures[t]=i},mt.prototype.initshader=function(){var></this.motions.length;i++){var></this.motions.length;e++){var></1,s=o*u._$no,_=this._$qi[n],a=this._$qi[n+1];i._$cr[s]=_,i._$cr[s+1]=a,i._$cr[s+4]=0,r&&(i._$hr[s]=_,i._$hr[s+1]=a,i._$hr[s+4]=0)}}return></1;this._$qi[n+1]=1-this._$qi[n+1]}break;case></7)return></1?(r[m]=y[$]*(1-u-p)+y[$+2]*u+y[$+2*(c+1)]*p,r[m+1]=y[$+1]*(1-u-p)+y[$+3]*u+y[$+2*(c+1)+1]*p):(r[m]=y[$+2*(c+1)+2]*(u-1+p)+y[$+2*(c+1)]*(1-u)+y[$+2]*(1-p),r[m+1]=y[$+2*(c+1)+3]*(u-1+p)+y[$+2*(c+1)+1]*(1-u)+y[$+3]*(1-p))},z.prototype._$vt=function(){return(this._$o+1)*(this._$a+1)},z.prototype.gettype=function(){return></0?a=0:a></=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else></=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var></=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var></=this.size){var></p&&p-t></=h._$rp&&h._$rp<=b._$ys);else{var></u&&u<121&&(i._$d0=u),o=e[0]}for(;o<r&&(\"\\n\"!=q(t,o)&&\"\\r\"!=q(t,o));++o);}else></r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\"=\"==n){a=o;break}var></o){console.log(\"_$n0></r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></e.length;o++){var></w._$52?w._$52=e:e></this._$sb.length;t++){0!=this._$sb[t]&&(this.gl._$sr(1,this._$sb,t),this._$sb[t]=0)}},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$sb[t]=i},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$u2[t]=i},x.prototype._$ns=function(t){var></e&&(this._$_l=wt.state_closing,this._$bb=e),i=1;break;case></e;++o){var></this._$rr[t]&&(i=this._$rr[t]),i></i;++e){var></v;++s){var></r;++s){var></i;e++){var></=this.size){var></=h._$rp&&h._$rp<=b._$ys);else{var></l&&l<121&&(i._$d0=l),o=e[0]}for(;o<r&&(\"\\n\"!=t[o]&&\"\\r\"!=t[o]);++o);}else></r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\"=\"==n){_=o;break}var></o){console.log(\"_$n0></r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></r;++o){var></r;++a)t[a]=0;for(var></o;_++){var></r;o++)if(o.getchar(t,o)!=e.charat(o-i))return!1;return!0},o.getchar=function(t,i){return></t;);}catch(t){t._$rb()}},w.getusertimemsec=function(){return></16;i++)this.matrix4x4[i]=t[i]},e.prototype._$it=function(){return></0?r=0:r></0?e=0:e></0?i=0:i></0?t=0:t></m._$52?m._$52=e:e></=this.x&&this.y<=this.y&&this.x<=this.x+this.width&&this.y<=this.y+this.height},s.prototype.expand=function(t,i){this.x-=t,this.y-=i,this.width+=2*t,this.height+=2*i},v._$z2=function(t,i,e,r){var></.033&&(i=.033);var></r;++o)console.log(\"%5d\",i[o]),console.log(\"%s\\n\",e),console.log(\",\");console.log(\"\\n\")},_._$rb=function(t){console.log(\"dump></e&&(i._$9l=!0)}},s.prototype.updateparamexe=function(t,i,e,r){},_._$8s=0,_._$ft=new></0){i._$z2=e,i._$bs=e;var></e.channel_count;n++){var></h;l++){var></this.clipcontextlist.length;r++){var></t;i++)this.gl.deleteframebuffer(at.framebuffers[i].framebuffer);at.framebuffers=[],at.glcontext=[]},e.prototype.init=function(t,i,e){for(var></t.length;u++){var></0&&(console.log(\"no></0&&(l=0),s.setpartsopacity(h,l)}else{for(var></3&&(e=1),this._$5s.setparamfloat(t,this._$5s.getparamfloat(t)*(1-e)+i*e)},i.prototype.addtoparamfloat=function(t,i,e){\"number\"!=typeof></this.channel_colors.length;e++)this.dp_webgl.setchannelflagascolor(e,this.channel_colors[e])}}function></t.x&&(s=360-s);var></16;t++)this.currentmatrix[t]=t%5==0?1:0},r.push=function(){var></this.min?this.tr[0]></this.screenright&&(t=this.screenright-this.tr[0]*this.maxright-this.tr[12]),this.tr[5]*this.maxtop+(this.tr[13]+i)<this.screentop&&(i=this.screentop-this.tr[5]*this.maxtop-this.tr[13]),this.tr[5]*this.maxbottom+(this.tr[13]+i)></i.length;e++){var></0&&(r=0,o=1);for(var></n;s++){var></e&&(this.eyestate=g.state_closing,this.statestarttime=e),i=1;break;case></_;a++){var></=i[0]&&r<=t[1]&&r></=u&&u<=s&&_<=p&&p<=a},r.prototype.hittestsimplecustom=function(t,i,e,r){return></_&&(_=$),$></.001&&(t=0),this.alpha=t},r.prototype.getalpha=function(){return>","site":{"data":{}},"length":6616,"excerpt":"","more":"!function(t){function i(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,i),o.l=!0,o.exports}var e={};i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},i.p=\"\",i(i.s=4)}([function(t,i,e){\"use strict\";function r(){this.live2DModel=null,this.modelMatrix=null,this.eyeBlink=null,this.physics=null,this.pose=null,this.debugMode=!1,this.initialized=!1,this.updating=!1,this.alpha=1,this.accAlpha=0,this.lipSync=!1,this.lipSyncValue=0,this.accelX=0,this.accelY=0,this.accelZ=0,this.dragX=0,this.dragY=0,this.startTimeMSec=null,this.mainMotionManager=new h,this.expressionManager=new h,this.motions={},this.expressions={},this.isTexLoaded=!1}function o(){AMotion.prototype.constructor.call(this),this.paramList=new Array}function n(){this.id=\"\",this.type=-1,this.value=null}function s(){this.nextBlinkTime=null,this.stateStartTime=null,this.blinkIntervalMsec=null,this.eyeState=g.STATE_FIRST,this.blinkIntervalMsec=4e3,this.closingMotionMsec=100,this.closedMotionMsec=50,this.openingMotionMsec=150,this.closeIfZero=!0,this.eyeID_L=\"PARAM_EYE_L_OPEN\",this.eyeID_R=\"PARAM_EYE_R_OPEN\"}function _(){this.tr=new Float32Array(16),this.identity()}function a(t,i){_.prototype.constructor.call(this),this.width=t,this.height=i}function h(){MotionQueueManager.prototype.constructor.call(this),this.currentPriority=null,this.reservePriority=null,this.super=MotionQueueManager.prototype}function l(){this.physicsList=new Array,this.startTimeMSec=UtSystem.getUserTimeMSec()}function $(){this.lastTime=0,this.lastModel=null,this.partsGroups=new Array}function u(t){this.paramIndex=-1,this.partsIndex=-1,this.link=null,this.id=t}function p(){this.EPSILON=.01,this.faceTargetX=0,this.faceTargetY=0,this.faceX=0,this.faceY=0,this.faceVX=0,this.faceVY=0,this.lastTimeSec=0}function f(){_.prototype.constructor.call(this),this.screenLeft=null,this.screenRight=null,this.screenTop=null,this.screenBottom=null,this.maxLeft=null,this.maxRight=null,this.maxTop=null,this.maxBottom=null,this.max=Number.MAX_VALUE,this.min=0}function c(){}var d=0;r.prototype.getModelMatrix=function(){return this.modelMatrix},r.prototype.setAlpha=function(t){t>.999&&(t=1),t<.001&&(t=0),this.alpha=t},r.prototype.getalpha=function(){return this.alpha},r.prototype.isinitialized=\"function(){return\" this.initialized},r.prototype.setinitialized=\"function(t){this.initialized=t},r.prototype.isUpdating=function(){return\" this.updating},r.prototype.setupdating=\"function(t){this.updating=t},r.prototype.getLive2DModel=function(){return\" this.live2dmodel},r.prototype.setlipsync=\"function(t){this.lipSync=t},r.prototype.setLipSyncValue=function(t){this.lipSyncValue=t},r.prototype.setAccel=function(t,i,e){this.accelX=t,this.accelY=i,this.accelZ=e},r.prototype.setDrag=function(t,i){this.dragX=t,this.dragY=i},r.prototype.getMainMotionManager=function(){return\" this.mainmotionmanager},r.prototype.getexpressionmanager=\"function(){return\" this.expressionmanager},r.prototype.loadmodeldata=\"function(t,i){var\" e=\"c.getPlatformManager();this.debugMode&&e.log(\" load\" model : \"+t);var r=\"this;e.loadLive2DModel(t,function(t){if(r.live2DModel=t,r.live2DModel.saveParam(),0!=Live2D.getError())return\" void console.error(\"error failed to loadmodeldata().\");r.modelmatrix=\"new\" a(r.live2dmodel.getcanvaswidth(),r.live2dmodel.getcanvasheight()),r.modelmatrix.setwidth(2),r.modelmatrix.setcenterposition(0,0),i(r.live2dmodel)})},r.prototype.loadtexture=\"function(t,i,e){d++;var\" texture \"+i);var o=\"this;r.loadTexture(this.live2DModel,t,i,function(){d--,0==d&&(o.isTexLoaded=!0),\" function\"=\"=typeof\"\" e&&e()})},r.prototype.loadmotion=\"function(t,i,e){var\" motion expression n=\"this;r.loadBytes(i,function(i){null!=t&&(n.expressions[t]=o.loadJson(i)),\" e&&e()})},r.prototype.loadpose=\"function(t,i){var\" pose i&&i()})}catch(t){console.warn(t)}},r.prototype.loadphysics=\"function(t){var\" i=\"c.getPlatformManager();this.debugMode&&i.log(\" physics l=\"o[h],$=o[h+1];l<n&&(n=l),l\">s&&(s=l),$<_&&(_=$),$>a&&(a=$)}var u=this.modelMatrix.invertTransformX(i),p=this.modelMatrix.invertTransformY(e);return n<=u&&u<=s&&_<=p&&p<=a},r.prototype.hittestsimplecustom=function(t,i,e,r){return null!=\"=this.live2DModel&&(e\">=t[0]&&e<=i[0]&&r<=t[1]&&r>=i[1])},o.prototype=new AMotion,o.EXPRESSION_DEFAULT=\"DEFAULT\",o.TYPE_SET=0,o.TYPE_ADD=1,o.TYPE_MULT=2,o.loadJson=function(t){var i=new o,e=c.getPlatformManager(),r=e.jsonParseFromBytes(t);if(i.setFadeIn(parseInt(r.fade_in)>0?parseInt(r.fade_in):1e3),i.setFadeOut(parseInt(r.fade_out)>0?parseInt(r.fade_out):1e3),null==r.params)return i;var s=r.params,_=s.length;i.paramList=[];for(var a=0;a<_;a++){var h=\"s[a],l=h.id.toString(),$=parseFloat(h.val),u=o.TYPE_ADD,p=null!=h.calc?h.calc.toString():\" add\";if((u=\"add\" ==\"=p?o.TYPE_ADD:\"mult\"===p?o.TYPE_MULT:\"set\"===p?o.TYPE_SET:o.TYPE_ADD)==o.TYPE_ADD){var\"\" f=\"null==h.def?0:parseFloat(h.def);$-=f}else\" if(u=\"=o.TYPE_MULT){var\" d=\"new\" n;d.id=\"l,d.type=u,d.value=$,i.paramList.push(d)}return\" i},o.prototype.updateparamexe=\"function(t,i,e,r){for(var\" n=\"this.paramList.length-1;n\">=0;--n){var s=this.paramList[n];s.type==o.TYPE_ADD?t.addToParamFloat(s.id,s.value,e):s.type==o.TYPE_MULT?t.multParamFloat(s.id,s.value,e):s.type==o.TYPE_SET&&t.setParamFloat(s.id,s.value,e)}},s.prototype.calcNextBlink=function(){return UtSystem.getUserTimeMSec()+Math.random()*(2*this.blinkIntervalMsec-1)},s.prototype.setInterval=function(t){this.blinkIntervalMsec=t},s.prototype.setEyeMotion=function(t,i,e){this.closingMotionMsec=t,this.closedMotionMsec=i,this.openingMotionMsec=e},s.prototype.updateParam=function(t){var i,e=UtSystem.getUserTimeMSec(),r=0;switch(this.eyeState){case g.STATE_CLOSING:r=(e-this.stateStartTime)/this.closingMotionMsec,r>=1&&(r=1,this.eyeState=g.STATE_CLOSED,this.stateStartTime=e),i=1-r;break;case g.STATE_CLOSED:r=(e-this.stateStartTime)/this.closedMotionMsec,r>=1&&(this.eyeState=g.STATE_OPENING,this.stateStartTime=e),i=0;break;case g.STATE_OPENING:r=(e-this.stateStartTime)/this.openingMotionMsec,r>=1&&(r=1,this.eyeState=g.STATE_INTERVAL,this.nextBlinkTime=this.calcNextBlink()),i=r;break;case g.STATE_INTERVAL:this.nextBlinkTime<e&&(this.eyestate=g.state_closing,this.statestarttime=e),i=1;break;case g.state_first:default:this.eyestate=\"g.STATE_INTERVAL,this.nextBlinkTime=this.calcNextBlink(),i=1}this.closeIfZero||(i=-i),t.setParamFloat(this.eyeID_L,i),t.setParamFloat(this.eyeID_R,i)};var\" g=\"function(){};g.STATE_FIRST=\" state_first\",g.state_interval=\"STATE_INTERVAL\" ,g.state_closing=\"STATE_CLOSING\" ,g.state_closed=\"STATE_CLOSED\" ,g.state_opening=\"STATE_OPENING\" ,_.mul=\"function(t,i,e){var\"\" r,o,n,s=\"[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<4;r++)for(o=0;o<4;o++)for(n=0;n<4;n++)s[r+4*o]+=t[r+4*n]*i[n+4*o];for(r=0;r<16;r++)e[r]=s[r]},_.prototype.identity=function(){for(var\" t=\"0;t<16;t++)this.tr[t]=t%5==0?1:0},_.prototype.getArray=function(){return\" this.tr},_.prototype.getcopymatrix=\"function(){return\" new float32array(this.tr)},_.prototype.setmatrix=\"function(t){if(null!=this.tr&&this.tr.length==this.tr.length)for(var\" i=\"0;i<16;i++)this.tr[i]=t[i]},_.prototype.getScaleX=function(){return\" this.tr[0]},_.prototype.getscaley=\"function(){return\" this.tr[5]},_.prototype.transformx=\"function(t){return\" this.tr[0]*t+this.tr[12]},_.prototype.transformy=\"function(t){return\" this.tr[5]*t+this.tr[13]},_.prototype.inverttransformx=\"function(t){return(t-this.tr[12])/this.tr[0]},_.prototype.invertTransformY=function(t){return(t-this.tr[13])/this.tr[5]},_.prototype.multTranslate=function(t,i){var\" e=\"[1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1];_.mul(e,this.tr,this.tr)},_.prototype.translate=function(t,i){this.tr[12]=t,this.tr[13]=i},_.prototype.translateX=function(t){this.tr[12]=t},_.prototype.translateY=function(t){this.tr[13]=t},_.prototype.multScale=function(t,i){var\" _,a.prototype.setposition=\"function(t,i){this.translate(t,i)},a.prototype.setCenterPosition=function(t,i){var\" motionqueuemanager,h.prototype.getcurrentpriority=\"function(){return\" this.currentpriority},h.prototype.getreservepriority=\"function(){return\" this.reservepriority},h.prototype.reservemotion=\"function(t){return!(this.reservePriority\">=t)&&(!(this.currentPriority>=t)&&(this.reservePriority=t,!0))},h.prototype.setReservePriority=function(t){this.reservePriority=t},h.prototype.updateParam=function(t){var i=MotionQueueManager.prototype.updateParam.call(this,t);return this.isFinished()&&(this.currentPriority=0),i},h.prototype.startMotionPrio=function(t,i){return i==this.reservePriority&&(this.reservePriority=0),this.currentPriority=i,this.startMotion(t,!1)},l.load=function(t){for(var i=new l,e=c.getPlatformManager(),r=e.jsonParseFromBytes(t),o=r.physics_hair,n=o.length,s=0;s<n;s++){var _=\"o[s],a=new\" physicshair,h=\"_.setup,$=parseFloat(h.length),u=parseFloat(h.regist),p=parseFloat(h.mass);a.setup($,u,p);for(var\" f=\"_.src,d=f.length,g=0;g<d;g++){var\" y=\"f[g],m=y.id,T=PhysicsHair.Src.SRC_TO_X,P=y.ptype;\" x\"=\"==P?T=PhysicsHair.Src.SRC_TO_X:\"y\"===P?T=PhysicsHair.Src.SRC_TO_Y:\"angle\"===P?T=PhysicsHair.Src.SRC_TO_G_ANGLE:UtDebug.error(\"live2d\",\"Invalid\"\" parameter:physicshair.src\");var s=\"parseFloat(y.scale),v=parseFloat(y.weight);a.addSrcParam(T,m,S,v)}for(var\" l=\"_.targets,M=L.length,g=0;g<M;g++){var\" e=\"L[g],m=E.id,T=PhysicsHair.Target.TARGET_FROM_ANGLE,P=E.ptype;\" angle\"=\"==P?T=PhysicsHair.Target.TARGET_FROM_ANGLE:\"angle_v\"===P?T=PhysicsHair.Target.TARGET_FROM_ANGLE_V:UtDebug.error(\"live2d\",\"Invalid\"\" parameter:physicshair.target\");var i},l.prototype.updateparam=\"function(t){for(var\" i=\"UtSystem.getUserTimeMSec()-this.startTimeMSec,e=0;e<this.physicsList.length;e++)this.physicsList[e].update(t,i)},$.load=function(t){for(var\" $,e=\"c.getPlatformManager(),r=e.jsonParseFromBytes(t),o=r.parts_visible,n=o.length,s=0;s<n;s++){for(var\" array,p=\"0;p<h;p++){var\" u(f.id);if(l[p]=\"d,null!=f.link){var\" g=\"f.link,y=g.length;d.link=new\" array;for(var m=\"0;m<y;m++){var\" t=\"new\" u(g[m]);d.link.push(t)}}}i.partsgroups.push(l)}return i},$.prototype.updateparam=\"function(t){if(null!=t){t!=this.lastModel&&this.initParam(t),this.lastModel=t;var\" r=\"0;r<this.partsGroups.length;r++)this.normalizePartsOpacityGroup(t,this.partsGroups[r],e),this.copyOpacityOtherParts(t,this.partsGroups[r])}},$.prototype.initParam=function(t){if(null!=t)for(var\" o=\"e[r].partsIndex,n=e[r].paramIndex;if(!(o<0)){var\">=0)break;r=n,o=t.getPartsOpacity(s),o+=e/.5,o>1&&(o=1)}}r<0&&(r=0,o=1);for(var n=\"0;n<i.length;n++){var\" s=\"i[n].partsIndex;if(!(s<0))if(r==n)t.setPartsOpacity(s,o);else{var\" a,h=\"t.getPartsOpacity(s);a=o<.5?-.5*o/.5+1:.5*(1-o)/.5;var\" l=\"(1-a)*(1-o);l\">.15&&(a=1-.15/(1-o)),h>a&&(h=a),t.setPartsOpacity(s,h)}}},$.prototype.copyOpacityOtherParts=function(t,i){for(var e=0;e<i.length;e++){var r=\"i[e];if(null!=r.link&&!(r.partsIndex<0))for(var\" o=\"t.getPartsOpacity(r.partsIndex),n=0;n<r.link.length;n++){var\" s=\"r.link[n];s.partsIndex<0||t.setPartsOpacity(s.partsIndex,o)}}},u.prototype.initIndex=function(t){this.paramIndex=t.getParamIndex(\" visible:\"+this.id),this.partsindex=\"t.getPartsDataIndex(PartsDataID.getID(this.id)),t.setParamFloat(this.paramIndex,1)},p.FRAME_RATE=30,p.prototype.setPoint=function(t,i){this.faceTargetX=t,this.faceTargetY=i},p.prototype.getX=function(){return\"\" this.facex},p.prototype.gety=\"function(){return\" this.facey},p.prototype.update=\"function(){var\" t=\"40/7.5/p.FRAME_RATE;if(0==this.lastTimeSec)return\" void(this.lasttimesec=\"UtSystem.getUserTimeMSec());var\" i=\"UtSystem.getUserTimeMSec(),e=(i-this.lastTimeSec)*p.FRAME_RATE/1e3;this.lastTimeSec=i;var\" _=\"Math.sqrt(n*n+s*s),a=t*n/_,h=t*s/_,l=a-this.faceVX,$=h-this.faceVY,u=Math.sqrt(l*l+$*$);(u<-o||u\">o)&&(l*=o/u,$*=o/u,u=o),this.faceVX+=l,this.faceVY+=$;var f=.5*(Math.sqrt(o*o+16*o*_-8*o*_)-o),c=Math.sqrt(this.faceVX*this.faceVX+this.faceVY*this.faceVY);c>f&&(this.faceVX*=f/c,this.faceVY*=f/c),this.faceX+=this.faceVX,this.faceY+=this.faceVY}},f.prototype=new _,f.prototype.getMaxScale=function(){return this.max},f.prototype.getMinScale=function(){return this.min},f.prototype.setMaxScale=function(t){this.max=t},f.prototype.setMinScale=function(t){this.min=t},f.prototype.isMaxScale=function(){return this.getScaleX()==this.max},f.prototype.isMinScale=function(){return this.getScaleX()==this.min},f.prototype.adjustTranslate=function(t,i){this.tr[0]*this.maxLeft+(this.tr[12]+t)>this.screenLeft&&(t=this.screenLeft-this.tr[0]*this.maxLeft-this.tr[12]),this.tr[0]*this.maxRight+(this.tr[12]+t)<this.screenright&&(t=this.screenright-this.tr[0]*this.maxright-this.tr[12]),this.tr[5]*this.maxtop+(this.tr[13]+i)<this.screentop&&(i=this.screentop-this.tr[5]*this.maxtop-this.tr[13]),this.tr[5]*this.maxbottom+(this.tr[13]+i)>this.screenBottom&&(i=this.screenBottom-this.tr[5]*this.maxBottom-this.tr[13]);var e=[1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1];_.mul(e,this.tr,this.tr)},f.prototype.adjustScale=function(t,i,e){var r=e*this.tr[0];r<this.min?this.tr[0]>0&&(e=this.min/this.tr[0]):r>this.max&&this.tr[0]>0&&(e=this.max/this.tr[0]);var o=[1,0,0,0,0,1,0,0,0,0,1,0,t,i,0,1],n=[e,0,0,0,0,e,0,0,0,0,1,0,0,0,0,1],s=[1,0,0,0,0,1,0,0,0,0,1,0,-t,-i,0,1];_.mul(s,this.tr,this.tr),_.mul(n,this.tr,this.tr),_.mul(o,this.tr,this.tr)},f.prototype.setScreenRect=function(t,i,e,r){this.screenLeft=t,this.screenRight=i,this.screenTop=r,this.screenBottom=e},f.prototype.setMaxScreenRect=function(t,i,e,r){this.maxLeft=t,this.maxRight=i,this.maxTop=r,this.maxBottom=e},f.prototype.getScreenLeft=function(){return this.screenLeft},f.prototype.getScreenRight=function(){return this.screenRight},f.prototype.getScreenBottom=function(){return this.screenBottom},f.prototype.getScreenTop=function(){return this.screenTop},f.prototype.getMaxLeft=function(){return this.maxLeft},f.prototype.getMaxRight=function(){return this.maxRight},f.prototype.getMaxBottom=function(){return this.maxBottom},f.prototype.getMaxTop=function(){return this.maxTop},c.platformManager=null,c.getPlatformManager=function(){return c.platformManager},c.setPlatformManager=function(t){c.platformManager=t},t.exports={L2DTargetPoint:p,Live2DFramework:c,L2DViewMatrix:f,L2DPose:$,L2DPartsParam:u,L2DPhysics:l,L2DMotionManager:h,L2DModelMatrix:a,L2DMatrix44:_,EYE_STATE:g,L2DEyeBlink:s,L2DExpressionParam:n,L2DExpressionMotion:o,L2DBaseModel:r}},function(t,i,e){\"use strict\";var r={DEBUG_LOG:!1,DEBUG_MOUSE_LOG:!1,DEBUG_DRAW_HIT_AREA:!1,DEBUG_DRAW_ALPHA_MODEL:!1,VIEW_MAX_SCALE:2,VIEW_MIN_SCALE:.8,VIEW_LOGICAL_LEFT:-1,VIEW_LOGICAL_RIGHT:1,VIEW_LOGICAL_MAX_LEFT:-2,VIEW_LOGICAL_MAX_RIGHT:2,VIEW_LOGICAL_MAX_BOTTOM:-2,VIEW_LOGICAL_MAX_TOP:2,PRIORITY_NONE:0,PRIORITY_IDLE:1,PRIORITY_SLEEPY:2,PRIORITY_NORMAL:3,PRIORITY_FORCE:4,MOTION_GROUP_IDLE:\"idle\",MOTION_GROUP_SLEEPY:\"sleepy\",MOTION_GROUP_TAP_BODY:\"tap_body\",MOTION_GROUP_FLICK_HEAD:\"flick_head\",MOTION_GROUP_PINCH_IN:\"pinch_in\",MOTION_GROUP_PINCH_OUT:\"pinch_out\",MOTION_GROUP_SHAKE:\"shake\",HIT_AREA_HEAD:\"head\",HIT_AREA_BODY:\"body\"};t.exports=r},function(t,i,e){\"use strict\";function r(t){n=t}function o(){return n}Object.defineProperty(i,\"__esModule\",{value:!0}),i.setContext=r,i.getContext=o;var n=void 0},function(t,i,e){\"use strict\";function r(){}r.matrixStack=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.depth=0,r.currentMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.tmp=new Array(16),r.reset=function(){this.depth=0},r.loadIdentity=function(){for(var t=0;t<16;t++)this.currentmatrix[t]=t%5==0?1:0},r.push=function(){var t=\"(this.depth,16*(this.depth+1));this.matrixStack.length<t+16&&(this.matrixStack.length=t+16);for(var\" i=\"0;i<16;i++)this.matrixStack[t+i]=this.currentMatrix[i];this.depth++},r.pop=function(){--this.depth<0&&(myError(\" invalid\" matrix stack.\"),this.depth=\"0);for(var\" this.currentmatrix},r.multmatrix=\"function(t){var\" i,e,r;for(i=\"0;i<16;i++)this.tmp[i]=0;for(i=0;i<4;i++)for(e=0;e<4;e++)for(r=0;r<4;r++)this.tmp[i+4*e]+=this.currentMatrix[i+4*r]*t[r+4*e];for(i=0;i<16;i++)this.currentMatrix[i]=this.tmp[i]},t.exports=r},function(t,i,e){t.exports=e(5)},function(t,i,e){\" use\" strict\";function r(t){return t&&t.__esmodule?t:{default:t}}function o(t){c=\"document.getElementById(t),C.addEventListener&&(window.addEventListener(\" click\",g),window.addeventlistener(\"mousedown\",g),window.addeventlistener(\"mousemove\",g),window.addeventlistener(\"mouseup\",g),document.addeventlistener(\"mouseout\",g),window.addeventlistener(\"touchstart\",y),window.addeventlistener(\"touchend\",y),window.addeventlistener(\"touchmove\",y))}function\" n(t){var m.l2dtargetpoint;var r=\"e/i,o=w.default.VIEW_LOGICAL_LEFT,n=w.default.VIEW_LOGICAL_RIGHT,_=-r,h=r;if(window.Live2D.captureFrame=!1,B=new\" m.l2dviewmatrix,b.setscreenrect(o,n,_,h),b.setmaxscreenrect(w.default.view_logical_max_left,w.default.view_logical_max_right,w.default.view_logical_max_bottom,w.default.view_logical_max_top),b.setmaxscale(w.default.view_max_scale),b.setminscale(w.default.view_min_scale),u=\"new\" m.l2dmatrix44,u.multscale(1,i e),g=\"new\" m.l2dmatrix44,g.multtranslate(-i 2,-e 2),g.multscale(2 i,-2 i),f=\"v(),(0,D.setContext)(F),!F)return\" console.error(\"failed to create webgl context.\"),void(window.webglrenderingcontext&&console.error(\"your browser don't support webgl, check https: get.webgl.org for futher information.\"));window.live2d.setgl(f),f.clearcolor(0,0,0,0),a(t),s()}function s(){b||(b=\"!0,function\" t(){_();var e=\"document.createElement(\" a\");document.body.appendchild(e),e.setattribute(\"type\",\"hidden\"),e.href=\"C.toDataURL(),e.download=window.Live2D.captureName||\"live2d.png\",e.click()}i(t,C)}())}function\"\" _(){o.default.reset(),o.default.loadidentity(),n.update(),r.setdrag(n.getx(),n.gety()),f.clear(f.color_buffer_bit),o.default.multmatrix(u.getarray()),o.default.multmatrix(b.getarray()),o.default.push();for(var a(t){r.reloadflg=\"!0,R.count++,R.changeModel(F,t)}function\" h(t,i){return t.x*i.x+t.y*i.y}function l(t,i){var $(t,i,e){function r(t,i){return 180*math.acos(h({x:0,y:1},l(t,i))) math.pi}if(i.x<e.left+e.width&&i.y<e.top+e.height&&i.x>e.left&&i.y>e.top)return i;var o=t.x-i.x,n=t.y-i.y,s=r(o,n);i.x<t.x&&(s=360-s);var 0=\"==e?.5:e,o(t),n(i)}e(6);var\" _=\"360-r(e.left-t.x,-1*(e.top-t.y)),a=360-r(e.left-t.x,-1*(e.top+e.height-t.y)),$=r(e.left+e.width-t.x,-1*(e.top-t.y)),u=r(e.left+e.width-t.x,-1*(e.top+e.height-t.y)),p=n/o,f={};if(s<$){var\" c=\"e.top-t.y,d=c/p;f={y:t.y+c,x:t.x+d}}else\" if(s<u){var g=\"e.left+e.width-t.x,y=g*p;f={y:t.y+y,x:t.x+g}}else\" if(s<a){var m=\"e.top+e.height-t.y,T=m/p;f={y:t.y+m,x:t.x+T}}else\" if(s<_){var p=\"t.x-e.left,S=P*p;f={y:t.y-S,x:t.x-P}}else{var\" v=\"e.top-t.y,L=v/p;f={y:t.y+v,x:t.x+L}}return\" f}function u(t){y=\"!0;var\" i=\"C.getBoundingClientRect(),e=P(t.clientX-i.left),r=S(t.clientY-i.top),o=$({x:i.left+i.width/2,y:i.top+i.height*X},{x:t.clientX,y:t.clientY},i),n=m(o.x-i.left),s=T(o.y-i.top);w.default.DEBUG_MOUSE_LOG&&console.log(\" onmousemove\" device( x:\"+t.clientx+\" y:\"+t.clienty+\" ) view( x:\"+n+\" y:\"+s+\")\"),k=\"e,V=r,N.setPoint(n,s)}function\" p(t){y=\"!0;var\" f(t){var y:\"+s+\")\"),y&&(k=\"e,V=r,N.setPoint(n,s))}function\" c(){y&&(y=\"!1),N.setPoint(0,0)}function\" d(){w.default.debug_log&&console.log(\"set session storage.\"),sessionstorage.setitem(\"sleepy\",\"1\")}function g(t){if(\"mousewheel\"=\"=t.type);else\" if(\"mousedown\"=\"=t.type)p(t);else\" if(\"mousemove\"=\"=t.type){var\" if(\"mouseup\"=\"=t.type){if(\" button\"in\" t&&0!=\"t.button)return}else\" if(\"mouseout\"=\"=t.type){w.default.DEBUG_LOG&&console.log(\" mouse\" out window.\"),c();var e=\"sessionStorage.getItem(\" sleepytimer\");window.cleartimeout(e),e=\"window.setTimeout(d,5e4),sessionStorage.setItem(\"SleepyTimer\",e)}}function\"\" y(t){var m(t){var b.inverttransformx(i)}function t(t){var b.inverttransformy(i)}function p(t){return g.transformx(t)}function s(t){return g.transformy(t)}function v(){for(var t=\"[\" webgl\",\"experimental-webgl\",\"webkit-3d\",\"moz-webgl\"],i=\"0;i<t.length;i++)try{var\"\" e}catch(t){}return null}function l(t,i,e){x=\"void\" a.default),b=\"!1,F=null,C=null,N=null,B=null,U=null,G=null,Y=!1,k=0,V=0,X=.5;window.loadlive2d=L},function(t,i,e){\" use\" strict\";(function(t){!function(){function i(){at||(this._$mt=\"null,this._$5S=null,this._$NP=0,i._$42++,this._$5S=new\" y(this))}function e(t){if(!at){this.clipcontextlist=\"new\" array,this.glcontext=\"t.gl,this.dp_webgl=t,this.curFrameNo=0,this.firstError_clipInNotUpdate=!0,this.colorBuffer=0,this.isInitGLFBFunc=!1,this.tmpBoundsOnModel=new\" s,at.glcontext.length>at.frameBuffers.length&&(this.curFrameNo=this.getMaskRenderTexture()),this.tmpModelToViewMatrix=new R,this.tmpMatrix2=new R,this.tmpMatrixForMask=new R,this.tmpMatrixForDraw=new R,this.CHANNEL_COLORS=new Array;var i=new A;i=new A,i.r=0,i.g=0,i.b=0,i.a=1,this.CHANNEL_COLORS.push(i),i=new A,i.r=1,i.g=0,i.b=0,i.a=0,this.CHANNEL_COLORS.push(i),i=new A,i.r=0,i.g=1,i.b=0,i.a=0,this.CHANNEL_COLORS.push(i),i=new A,i.r=0,i.g=0,i.b=1,i.a=0,this.CHANNEL_COLORS.push(i);for(var e=0;e<this.channel_colors.length;e++)this.dp_webgl.setchannelflagascolor(e,this.channel_colors[e])}}function r(t,i,e){this.clipidlist=\"new\" array,this.clipidlist=\"e,this.clippingMaskDrawIndexList=new\" array;for(var r=\"0;r<e.length;r++)this.clippingMaskDrawIndexList.push(i.getDrawDataIndex(e[r]));this.clippedDrawContextList=new\" array,this.isusing=\"!0,this.layoutChannelNo=0,this.layoutBounds=new\" s,this.allclippeddrawrect=\"new\" s,this.matrixformask=\"new\" float32array(16),this.matrixfordraw=\"new\" float32array(16),this.owner=\"t}function\" o(t,i){this._$gp=\"t,this.drawDataIndex=i}function\" n(){at||(this.color=\"null)}function\" s(){at||(this._$dp=\"null,this._$eo=null,this._$V0=null,this._$dP=1e3,this._$eo=1e3,this._$V0=1,this._$a0())}function\" _(){}function a(){this._$r=\"null,this._$0S=null}function\" h(){at||(this.x=\"null,this.y=null,this.width=null,this.height=null)}function\" l(t){at||et.prototype.constructor.call(this,t)}function $(){}function u(t){at||et.prototype.constructor.call(this,t)}function p(){at||(this._$vo=\"null,this._$F2=null,this._$ao=400,this._$1S=400,p._$42++)}function\" f(){at||(this.p1=\"new\" c,this.p2=\"new\" c,this._$fo=\"0,this._$Db=0,this._$L2=0,this._$M2=0,this._$ks=0,this._$9b=0,this._$iP=0,this._$iT=0,this._$lL=new\" array,this._$qp=\"new\" array,this.setup(.3,.5,.1))}function c(){this._$p=\"1,this.x=0,this.y=0,this.vx=0,this.vy=0,this.ax=0,this.ay=0,this.fx=0,this.fy=0,this._$s0=0,this._$70=0,this._$7L=0,this._$HL=0}function\" d(t,i,e){this._$wl=\"null,this.scale=null,this._$V0=null,this._$wL=t,this.scale=i,this._$V0=e}function\" g(t,i,e,r){d.prototype.constructor.call(this,i,e,r),this._$tl=\"null,this._$tL=t}function\" y(t,i,e){this._$wl=\"null,this.scale=null,this._$V0=null,this._$wL=t,this.scale=i,this._$V0=e}function\" t(t,i,e,r){y.prototype.constructor.call(this,i,e,r),this._$yp=\"null,this._$YP=t}function\" p(){at||(this._$fl=\"0,this._$gL=0,this._$B0=1,this._$z0=1,this._$qT=0,this.reflectX=!1,this.reflectY=!1)}function\" s(){at||(this.x=\"null,this.y=null,this.width=null,this.height=null)}function\" v(){}function l(){at||(this.x=\"null,this.y=null)}function\" m(){at||(this._$gp=\"null,this._$dr=null,this._$GS=null,this._$qb=null,this._$Lb=null,this._$mS=null,this.clipID=null,this.clipIDList=new\" array)}function e(){at||(this._$eb=\"E._$ps,this._$lT=1,this._$C0=1,this._$tT=1,this._$WL=1,this.culling=!1,this.matrix4x4=new\" float32array(16),this.premultipliedalpha=\"!1,this.anisotropy=0,this.clippingProcess=E.CLIPPING_PROCESS_NONE,this.clipBufPre_clipContextMask=null,this.clipBufPre_clipContextDraw=null,this.CHANNEL_COLORS=new\" a(){at||(this.a=\"1,this.r=1,this.g=1,this.b=1,this.scale=1,this._$ho=1,this.blendMode=at.L2D_COLOR_BLEND_MODE_MULT)}function\" i(){at||(this._$kp=\"null,this._$dr=null,this._$Ai=!0,this._$mS=null)}function\" w(){}function x(){at||(this._$vp=\"0,this._$wL=null,this._$GP=null,this._$8o=x._$ds,this._$2r=-1,this._$O2=0,this._$ri=0)}function\" o(){}function d(){at||(this._$ob=\"null)}function\" r(){this.m=\"new\" float32array(16),this.identity()}function b(t){at||et.prototype.constructor.call(this,t)}function f(){at||(this._$7=\"1,this._$f=0,this._$H=0,this._$g=1,this._$k=0,this._$w=0,this._$hi=STATE_IDENTITY,this._$Z=_$pS)}function\" c(){at||(s.prototype.constructor.call(this),this.motions=\"new\" array,this._$7r=\"null,this._$7r=C._$Co++,this._$D0=30,this._$yT=0,this._$E=!0,this.loopFadeIn=!0,this._$AS=-1,_$a0())}function\" n(){this._$p=\"new\" float32array(100),this.size=\"0}function\" b(){this._$4p=\"null,this._$I0=null,this._$RP=null}function\" u(){}function g(){}function y(t){at||(this._$qt=\"!0,this._$co=-1,this._$qo=0,this._$pb=new\" array(y._$is),this._$_2=\"new\" float32array(y._$is),this._$vr=\"new\" float32array(y._$is),this._$rr=\"new\" float32array(y._$is),this._$or=\"new\" float32array(y._$is),this._$fs=\"new\" float32array(y._$is),this._$js=\"new\" array(y._$is),this._$3s=\"new\" array,this._$as=\"new\" array,this._$bo=\"null,this._$F2=new\" array,this._$db=\"new\" array,this._$8b=\"new\" array,this._$hr=\"new\" array,this._$ws=\"null,this._$Vs=null,this._$Er=null,this._$Es=new\" int16array(u._$qb),this._$zp=\"new\" float32array(2*u._$1r),this._$ri=\"t,this._$b0=Y._$HP++,this.clipManager=null,this.dp_webgl=null)}function\" k(){}function v(){at||(this._$12=\"null,this._$bb=null,this._$_L=null,this._$jo=null,this._$iL=null,this._$0L=null,this._$Br=null,this._$Dr=null,this._$Cb=null,this._$mr=null,this._$_L=wt.STATE_FIRST,this._$Br=4e3,this._$Dr=100,this._$Cb=50,this._$mr=150,this._$jo=!0,this._$iL=\" param_eye_l_open\",this._$0l=\"PARAM_EYE_R_OPEN\" )}function\" x(){at||(e.prototype.constructor.call(this),this._$sb=\"new\" int32array(x._$as),this._$u2=\"new\" array,this.transform=\"null,this.gl=null,null==X._$NT&&(X._$NT=X._$9r(256),X._$vS=X._$9r(256),X._$no=X._$vb(256)))}function\" z(){at||(i.prototype.constructor.call(this),this._$gs=\"null,this._$Y0=null)}function\" h(t){_t.prototype.constructor.call(this,t),this._$8r=\"I._$ur,this._$Yr=null,this._$Wr=null}function\" w(){at||(m.prototype.constructor.call(this),this._$gp=\"null,this._$dr=null,this._$GS=null,this._$qb=null,this._$Lb=null,this._$mS=null)}function\" j(){at||(this._$nl=\"null,this._$3S=null,this._$aS=null,j._$42++)}function\" q(){at||(i.prototype.constructor.call(this),this._$zo=\"new\" x)}function j(){at||(s.prototype.constructor.call(this),this.motions=\"new\" array,this._$o2=\"null,this._$7r=J._$Co++,this._$D0=30,this._$yT=0,this._$E=!1,this.loopFadeIn=!0,this._$rr=-1,this._$eP=0)}function\" q(t,i){return string.fromcharcode(t.getuint8(i))}function z(){at||(i.prototype.constructor.call(this),this._$o=\"0,this._$A=0,this._$GS=null,this._$Eo=null)}function\" k(t){_t.prototype.constructor.call(this,t),this._$8r=\"I._$ur,this._$Cr=null,this._$hr=null}function\" tt(){at||(this.visible=\"!0,this._$g0=!1,this._$NL=null,this._$3S=null,this._$aS=null,tt._$42++)}function\" it(t){this._$vs=\"null,this._$e0=null,this._$e0=t}function\" et(t){at||(this.id=\"t)}function\" rt(){}function ot(){at||(this._$4s=\"null)}function\" nt(t,i){this.canvas=\"t,this.context=i,this.viewport=new\" array(0,0,t.width,t.height),this._$6r=\"1,this._$xP=0,this._$3r=1,this._$uP=0,this._$Qo=-1,this.cacheImages={}}function\" st(){at||(this._$tt=\"null,this._$LT=null,this._$FS=null,this._$wL=null)}function\" _t(t){at||(this._$e0=\"null,this._$IP=null,this._$JS=!1,this._$AT=!0,this._$e0=t,this.totalScale=1,this._$7s=1,this.totalOpacity=1)}function\" at(){}function ht(){}function lt(t){at||(this._$ib=\"t)}function\" $t(){at||(w.prototype.constructor.call(this),this._$lp=\"-1,this._$d0=0,this._$Yo=0,this._$JP=null,this._$5P=null,this._$BP=null,this._$Eo=null,this._$Qi=null,this._$6s=$t._$ms,this.culling=!0,this.gl_cacheImage=null,this.instanceNo=$t._$42++)}function\" ut(t){mt.prototype.constructor.call(this,t),this._$8r=\"W._$ur,this._$Cr=null,this._$hr=null}function\" pt(){at||(this.x=\"null,this.y=null)}function\" ft(t){at||(i.prototype.constructor.call(this),this.drawparamwebgl=\"new\" mt(t),this.drawparamwebgl.setgl(at.getgl(t)))}function ct(){at||(this.motions=\"null,this._$eb=!1,this.motions=new\" dt(){this._$w0=\"null,this._$AT=!0,this._$9L=!1,this._$z2=-1,this._$bs=-1,this._$Do=-1,this._$sr=null,this._$sr=dt._$Gs++}function\" gt(){this.m=\"new\" array(1,0,0,0,1,0,0,0,1)}function yt(t){at||et.prototype.constructor.call(this,t)}function mt(t){at||(e.prototype.constructor.call(this),this.textures=\"new\" tt(t,i,e){return null=\"=i&&(i=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,e,t.DYNAMIC_DRAW),i}function\" pt(t,i,e){return st(t){at||(this._$p=\"new\" int8array(8),this._$r0=\"new\" dataview(this._$p.buffer),this._$3i=\"new\" int8array(1e3),this._$hl=\"0,this._$v0=0,this._$S2=0,this._$Ko=new\" array,this._$t=\"t,this._$F=0)}function\" vt(){}function lt(){}function mt(t){at||(this._$e0=\"null,this._$IP=null,this._$Us=null,this._$7s=null,this._$IS=[!1],this._$VS=null,this._$AT=!0,this.baseOpacity=1,this.clipBufPre_clipContext=null,this._$e0=t)}function\" et(){}var at=\"!0;i._$0s=1,i._$4s=2,i._$42=0,i._$62=function(t,e){try{if(e\" instanceof arraybuffer&&(e=\"new\" dataview(e)),!(e dataview))throw new lt(\"_$ss#loadmodel(b) b _$x be dataview or arraybuffer\");var r,o=\"new\" st(e),n=\"o._$ST(),s=o._$ST(),a=o._$ST();if(109!=n||111!=s||99!=a)throw\" lt(\"_$gi _$c _$li , _$q0 _$p0.\");if(r=\"o._$ST(),o._$gr(r),r\">G._$T7){t._$NP|=i._$4s;throw new lt(\"_$gi _$C _$li , _$n0 _$_ version _$li ( SDK : \"+G._$T7+\" < _$f0 : \"+r+\" )@_$SS#loadModel()\\n\")}var h=o._$nP();if(r>=G._$s7){var l=o._$9T(),$=o._$9T();if(-30584!=l||-30584!=$)throw t._$NP|=i._$0s,new lt(\"_$gi _$C _$li , _$0 _$6 _$Ui.\")}t._$KS(h);var u=t.getModelContext();u.setDrawParam(t.getDrawParam()),u.init()}catch(t){_._$Rb(t)}},i.prototype._$KS=function(t){this._$MT=t},i.prototype.getModelImpl=function(){return null==this._$MT&&(this._$MT=new p,this._$MT._$zP()),this._$MT},i.prototype.getCanvasWidth=function(){return null==this._$MT?0:this._$MT.getCanvasWidth()},i.prototype.getCanvasHeight=function(){return null==this._$MT?0:this._$MT.getCanvasHeight()},i.prototype.getParamFloat=function(t){return\"number\"!=typeof t&&(t=this._$5S.getParamIndex(u.getID(t))),this._$5S.getParamFloat(t)},i.prototype.setParamFloat=function(t,i,e){\"number\"!=typeof t&&(t=this._$5S.getParamIndex(u.getID(t))),arguments.length<3&&(e=1),this._$5s.setparamfloat(t,this._$5s.getparamfloat(t)*(1-e)+i*e)},i.prototype.addtoparamfloat=function(t,i,e){\"number\"!=typeof t&&(t=\"this._$5S.getParamIndex(u.getID(t))),arguments.length<3&&(e=1),this._$5S.setParamFloat(t,this._$5S.getParamFloat(t)+i*e)},i.prototype.multParamFloat=function(t,i,e){\" number\"!=\"typeof\"\" this._$5s.getparamindex(u.getid(t))},i.prototype.loadparam=\"function(){this._$5S.loadParam()},i.prototype.saveParam=function(){this._$5S.saveParam()},i.prototype.init=function(){this._$5S.init()},i.prototype.update=function(){this._$5S.update()},i.prototype._$Rs=function(){return\" _._$li(\"_$60 _$pt _$rs()\"),-1},i.prototype._$ds=\"function(t){_._$li(\" _$60\" _$ss#_$ds() \\n\")},i.prototype._$k2=\"function(){},i.prototype.draw=function(){},i.prototype.getModelContext=function(){return\" this._$5s},i.prototype._$s2=\"function(){return\" this._$np},i.prototype._$p7=\"function(t,i,e,r){var\" o=\"-1,n=0,s=this;if(0!=e)if(1==t.length){var\" _=\"t[0],a=0!=s.getParamFloat(_),h=i[0],l=s.getPartsOpacity(h),$=e/r;a?(l+=$)\">1&&(l=1):(l-=$)<0&&(l=0),s.setpartsopacity(h,l)}else{for(var u=\"0;u<t.length;u++){var\" _=\"t[u],p=0!=s.getParamFloat(_);if(p){if(o\">=0)break;o=u;var h=i[u];n=s.getPartsOpacity(h),n+=e/r,n>1&&(n=1)}}o<0&&(console.log(\"no _$wi _$q0 _$u default[%s]\",t[0]),o=\"0,n=1,s.loadParam(),s.setParamFloat(t[o],n),s.saveParam());for(var\" u=\"0;u<t.length;u++){var\" h=\"i[u];if(o==u)s.setPartsOpacity(h,n);else{var\" f,c=\"s.getPartsOpacity(h);f=n<.5?-.5*n/.5+1:.5*(1-n)/.5;var\" d=\"(1-f)*(1-n);d\">.15&&(f=1-.15/(1-n)),c>f&&(c=f),s.setPartsOpacity(h,c)}}}else for(var u=0;u<t.length;u++){var _=\"t[u],h=i[u],p=0!=s.getParamFloat(_);s.setPartsOpacity(h,p?1:0)}},i.prototype.setPartsOpacity=function(t,i){\" number\"!=\"typeof\"\" t&&(t=\"this._$5S.getPartsDataIndex(l.getID(t))),this._$5S.setPartsOpacity(t,i)},i.prototype.getPartsDataIndex=function(t){return\" t instanceof l||(t=\"l.getID(t)),this._$5S.getPartsDataIndex(t)},i.prototype.getPartsOpacity=function(t){return\" this._$5s.getdrawdataindex(b.getid(t))},i.prototype.getdrawdata=\"function(t){return\" this._$5s.getdrawdata(t)},i.prototype.gettransformedpoints=\"function(t){var\" i=\"this._$5S._$C2(t);return\" ut?i.gettransformedpoints():null},i.prototype.getindexarray=\"function(t){if(t<0||t\">=this._$5S._$aS.length)return null;var i=this._$5S._$aS[t];return null!=i&&i.getType()==W._$wb&&i instanceof $t?i.getIndexArray():null},e.CHANNEL_COUNT=4,e.RENDER_TEXTURE_USE_MIPMAP=!1,e.NOT_USED_FRAME=-100,e.prototype._$L7=function(){if(this.tmpModelToViewMatrix&&(this.tmpModelToViewMatrix=null),this.tmpMatrix2&&(this.tmpMatrix2=null),this.tmpMatrixForMask&&(this.tmpMatrixForMask=null),this.tmpMatrixForDraw&&(this.tmpMatrixForDraw=null),this.tmpBoundsOnModel&&(this.tmpBoundsOnModel=null),this.CHANNEL_COLORS){for(var t=this.CHANNEL_COLORS.length-1;t>=0;--t)this.CHANNEL_COLORS.splice(t,1);this.CHANNEL_COLORS=[]}this.releaseShader()},e.prototype.releaseShader=function(){for(var t=at.frameBuffers.length,i=0;i<t;i++)this.gl.deleteframebuffer(at.framebuffers[i].framebuffer);at.framebuffers=[],at.glcontext=[]},e.prototype.init=function(t,i,e){for(var o=\"0;o<i.length;o++){var\" n=\"i[o].getClipIDList();if(null!=n){var\" s=\"this.findSameClip(n);null==s&&(s=new\" r(this,t,n),this.clipcontextlist.push(s));var _=\"i[o].getDrawDataID(),a=t.getDrawDataIndex(_);s.addClippedDrawData(_,a);e[o].clipBufPre_clipContext=s}}},e.prototype.getMaskRenderTexture=function(){var\" t=\"null;return\" e=\"0,r=0;r<this.clipContextList.length;r++){var\">0){var n=i.gl.getParameter(i.gl.FRAMEBUFFER_BINDING),s=new Array(4);s[0]=0,s[1]=0,s[2]=i.gl.canvas.width,s[3]=i.gl.canvas.height,i.gl.viewport(0,0,at.clippingMaskBufferSize,at.clippingMaskBufferSize),this.setupLayoutBounds(e),i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,at.frameBuffers[this.curFrameNo].framebuffer),i.gl.clearColor(0,0,0,0),i.gl.clear(i.gl.COLOR_BUFFER_BIT);for(var r=0;r<this.clipcontextlist.length;r++){var o=\"this.clipContextList[r],_=o.allClippedDrawRect,a=(o.layoutChannelNo,o.layoutBounds);this.tmpBoundsOnModel._$jL(_),this.tmpBoundsOnModel.expand(.05*_.width,.05*_.height);var\" h=\"a.width/this.tmpBoundsOnModel.width,l=a.height/this.tmpBoundsOnModel.height;this.tmpMatrix2.identity(),this.tmpMatrix2.translate(-1,-1,0),this.tmpMatrix2.scale(2,2,1),this.tmpMatrix2.translate(a.x,a.y,0),this.tmpMatrix2.scale(h,l,1),this.tmpMatrix2.translate(-this.tmpBoundsOnModel.x,-this.tmpBoundsOnModel.y,0),this.tmpMatrixForMask.setMatrix(this.tmpMatrix2.m),this.tmpMatrix2.identity(),this.tmpMatrix2.translate(a.x,a.y,0),this.tmpMatrix2.scale(h,l,1),this.tmpMatrix2.translate(-this.tmpBoundsOnModel.x,-this.tmpBoundsOnModel.y,0),this.tmpMatrixForDraw.setMatrix(this.tmpMatrix2.m);for(var\" $=\"this.tmpMatrixForMask.getArray(),u=0;u<16;u++)o.matrixForMask[u]=$[u];for(var\" p=\"this.tmpMatrixForDraw.getArray(),u=0;u<16;u++)o.matrixForDraw[u]=p[u];for(var\" f=\"o.clippingMaskDrawIndexList.length,c=0;c<f;c++){var\" d=\"o.clippingMaskDrawIndexList[c],g=t.getDrawData(d),y=t._$C2(d);i.setClipBufPre_clipContextForMask(o),g.draw(i,t,y)}}i.gl.bindFramebuffer(i.gl.FRAMEBUFFER,n),i.setClipBufPre_clipContextForMask(null),i.gl.viewport(s[0],s[1],s[2],s[3])}},e.prototype.getColorBuffer=function(){return\" this.colorbuffer},e.prototype.findsameclip=\"function(t){for(var\" i=\"0;i<this.clipContextList.length;i++){var\" e=\"this.clipContextList[i],r=e.clipIDList.length;if(r==t.length){for(var\" s=\"e.clipIDList[n],_=0;_<r;_++)if(t[_]==s){o++;break}if(o==r)return\" e}}return null},e.prototype.calcclippeddrawtotalbounds=\"function(t,i){for(var\">r?e:r,n=o,s=o,_=0,a=0,h=i.clippedDrawContextList.length,l=0;l<h;l++){var $=\"i.clippedDrawContextList[l],u=$.drawDataIndex,p=t._$C2(u);if(p._$yo()){for(var\" f=\"p.getTransformedPoints(),c=f.length,d=[],g=[],y=0,m=U._$i2;m<c;m+=U._$No)d[y]=f[m],g[y]=f[m+1],y++;var\" t=\"Math.min.apply(null,d),P=Math.min.apply(null,g),S=Math.max.apply(null,d),v=Math.max.apply(null,g);T<n&&(n=T),P<s&&(s=P),S\">_&&(_=S),v>a&&(a=v)}}if(n==o)i.allClippedDrawRect.x=0,i.allClippedDrawRect.y=0,i.allClippedDrawRect.width=0,i.allClippedDrawRect.height=0,i.isUsing=!1;else{var L=_-n,M=a-s;i.allClippedDrawRect.x=n,i.allClippedDrawRect.y=s,i.allClippedDrawRect.width=L,i.allClippedDrawRect.height=M,i.isUsing=!0}},e.prototype.setupLayoutBounds=function(t){var i=t/e.CHANNEL_COUNT,r=t%e.CHANNEL_COUNT;i=~~i,r=~~r;for(var o=0,n=0;n<e.channel_count;n++){var s=\"i+(n<r?1:0);if(0==s);else\" if(1=\"=s){var\" a=\"this.clipContextList[o++];a.layoutChannelNo=n,a.layoutBounds.x=0,a.layoutBounds.y=0,a.layoutBounds.width=1,a.layoutBounds.height=1}else\" if(2=\"=s)for(var\" h=\"0;h<s;h++){var\" l=\"h%2,$=0;l=~~l;var\" if(s<=\"4)for(var\" _._$li(\"_$6 _$0p mask count : %d\",s)}},r.prototype.addclippeddrawdata=\"function(t,i){var\" e=\"new\" o(t,i);this.clippeddrawcontextlist.push(e)},s._$jt=\"function(t,i,e){var\" r=\"t/i,o=e/i,n=o,s=1-(1-o)*(1-o),_=1-(1-n)*(1-n),a=1/3*(1-o)*s+(n*(2/3)+1/3*(1-n))*(1-s),h=(n+2/3*(1-n))*_+(o*(1/3)+2/3*(1-o))*(1-_),l=1-3*h+3*a-0,$=3*h-6*a+0,u=3*a-0;if(r<=0)return\" 0;if(r>=1)return 1;var p=r,f=p*p;return l*(p*f)+$*f+u*p+0},s.prototype._$a0=function(){},s.prototype.setFadeIn=function(t){this._$dP=t},s.prototype.setFadeOut=function(t){this._$eo=t},s.prototype._$pT=function(t){this._$V0=t},s.prototype.getFadeOut=function(){return this._$eo},s.prototype._$4T=function(){return this._$eo},s.prototype._$mT=function(){return this._$V0},s.prototype.getDurationMSec=function(){return-1},s.prototype.getLoopDurationMSec=function(){return-1},s.prototype.updateParam=function(t,i){if(i._$AT&&!i._$9L){var e=w.getUserTimeMSec();if(i._$z2<0){i._$z2=e,i._$bs=e;var r=\"this.getDurationMSec();i._$Do<0&&(i._$Do=r<=0?-1:i._$z2+r)}var\" o=\"this._$V0;o=o*(0==this._$dP?1:ht._$r2((e-i._$bs)/this._$dP))*(0==this._$eo||i._$Do<0?1:ht._$r2((i._$Do-e)/this._$eo)),0<=o&&o<=1||console.log(\" ###\" assert!! ### \"),this.updateparamexe(t,e,o,i),i._$do>0&&i._$Do<e&&(i._$9l=!0)}},s.prototype.updateparamexe=function(t,i,e,r){},_._$8s=0,_._$ft=new object,_.start=\"function(t){var\" i=\"_._$fT[t];null==i&&(i=new\" a,i._$r=\"t,_._$fT[t]=i),i._$0S=w.getSystemTimeMSec()},_.dump=function(t){var\" e=\"w.getSystemTimeMSec(),r=e-i._$0S;return\" console.log(t+\" : \"+r+\"ms\"),r}return-1},_.end=\"function(t){var\" w.getsystemtimemsec()-i._$0s}return-1},_._$li=\"function(t,i){console.log(\" _$li\" \"+t+\"\\n\",i)},_._$ji=\"function(t,i){console.log(t,i)},_._$dL=function(t,i){console.log(t,i),console.log(\" \\n\")},_._$kl=\"function(t,i){for(var\"\">0?console.log(\"\\n\"):e%8==0&&e>0&&console.log(\"  \"),console.log(\"%02X \",255&t[e]);console.log(\"\\n\")},_._$nr=function(t,i,e){console.log(\"%s\\n\",t);for(var r=i.length,o=0;o<r;++o)console.log(\"%5d\",i[o]),console.log(\"%s\\n\",e),console.log(\",\");console.log(\"\\n\")},_._$rb=function(t){console.log(\"dump exception : \"+t),console.log(\"stack :: \"+t.stack)},h.prototype._$8p=\"function(){return.5*(this.x+this.x+this.width)},h.prototype._$6P=function(){return.5*(this.y+this.y+this.height)},h.prototype._$EL=function(){return\" this.x+this.width},h.prototype._$5t=\"function(){return\" this.y+this.height},h.prototype._$jl=\"function(t,i,e,r){this.x=t,this.y=i,this.width=e,this.height=r},h.prototype._$jL=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},l.prototype=new\" et,l._$tp=\"new\" object,l._$27=\"function(){l._$tP.clear()},l.getID=function(t){var\" i=\"l._$tP[t];return\" null=\"=i&&(i=new\" l(t),l._$tp[t]=\"i),i},l.prototype._$3s=function(){return\" new l},u.prototype=\"new\" et,u._$tp=\"new\" object,u._$27=\"function(){u._$tP.clear()},u.getID=function(t){var\" u(t),u._$tp[t]=\"i),i},u.prototype._$3s=function(){return\" u},p._$42=\"0,p.prototype._$zP=function(){null==this._$vo&&(this._$vo=new\" ot),null=\"=this._$F2&&(this._$F2=new\" array)},p.prototype.getcanvaswidth=\"function(){return\" this._$ao},p.prototype.getcanvasheight=\"function(){return\" this._$1s},p.prototype._$f0=\"function(t){this._$vo=t._$nP(),this._$F2=t._$nP(),this._$ao=t._$6L(),this._$1S=t._$6L()},p.prototype._$6S=function(t){this._$F2.push(t)},p.prototype._$Xr=function(){return\" this._$f2},p.prototype._$e2=\"function(){return\" this._$vo},f.prototype.setup=\"function(t,i,e){this._$ks=this._$Yb(),this.p2._$xT(),3==arguments.length&&(this._$Fo=t,this._$L2=i,this.p1._$p=e,this.p2._$p=e,this.p2.y=t,this.setup())},f.prototype.getPhysicsPoint1=function(){return\" this.p1},f.prototype.getphysicspoint2=\"function(){return\" this.p2},f.prototype._$qr=\"function(){return\" this._$db},f.prototype._$pr=\"function(t){this._$Db=t},f.prototype._$5r=function(){return\" this._$m2},f.prototype._$cs=\"function(){return\" this._$9b},f.prototype._$yb=\"function(){return-180*Math.atan2(this.p1.x-this.p2.x,-(this.p1.y-this.p2.y))/Math.PI},f.prototype.addSrcParam=function(t,i,e,r){var\" o=\"new\" g(t,i,e,r);this._$ll.push(o)},f.prototype.addtargetparam=\"function(t,i,e,r){var\" t(t,i,e,r);this._$qp.push(o)},f.prototype.update=\"function(t,i){if(0==this._$iP)return\" this._$ip=\"this._$iT=i,void(this._$Fo=Math.sqrt((this.p1.x-this.p2.x)*(this.p1.x-this.p2.x)+(this.p1.y-this.p2.y)*(this.p1.y-this.p2.y)));var\" e=\"(i-this._$iT)/1e3;if(0!=e){for(var\" r=\"this._$lL.length-1;r\">=0;--r){this._$lL[r]._$oP(t,this)}this._$oo(t,e),this._$M2=this._$Yb(),this._$9b=(this._$M2-this._$ks)/e,this._$ks=this._$M2}for(var r=this._$qP.length-1;r>=0;--r){this._$qP[r]._$YS(t,this)}this._$iT=i},f.prototype._$oo=function(t,i){i<.033&&(i=.033);var e=\"1/i;this.p1.vx=(this.p1.x-this.p1._$s0)*e,this.p1.vy=(this.p1.y-this.p1._$70)*e,this.p1.ax=(this.p1.vx-this.p1._$7L)*e,this.p1.ay=(this.p1.vy-this.p1._$HL)*e,this.p1.fx=this.p1.ax*this.p1._$p,this.p1.fy=this.p1.ay*this.p1._$p,this.p1._$xT();var\" r,o,n=\"-Math.atan2(this.p1.y-this.p2.y,this.p1.x-this.p2.x),s=Math.cos(n),_=Math.sin(n),a=9.8*this.p2._$p,h=this._$Db*Lt._$bS,l=a*Math.cos(n-h);r=l*_,o=l*s;var\" $=\"-this.p1.fx*_*_,u=-this.p1.fy*_*s,p=-this.p2.vx*this._$L2,f=-this.p2.vy*this._$L2;this.p2.fx=r+$+p,this.p2.fy=o+u+f,this.p2.ax=this.p2.fx/this.p2._$p,this.p2.ay=this.p2.fy/this.p2._$p,this.p2.vx+=this.p2.ax*i,this.p2.vy+=this.p2.ay*i,this.p2.x+=this.p2.vx*i,this.p2.y+=this.p2.vy*i;var\" c=\"Math.sqrt((this.p1.x-this.p2.x)*(this.p1.x-this.p2.x)+(this.p1.y-this.p2.y)*(this.p1.y-this.p2.y));this.p2.x=this.p1.x+this._$Fo*(this.p2.x-this.p1.x)/c,this.p2.y=this.p1.y+this._$Fo*(this.p2.y-this.p1.y)/c,this.p2.vx=(this.p2.x-this.p2._$s0)*e,this.p2.vy=(this.p2.y-this.p2._$70)*e,this.p2._$xT()},c.prototype._$xT=function(){this._$s0=this.x,this._$70=this.y,this._$7L=this.vx,this._$HL=this.vy},d.prototype._$oP=function(t,i){},g.prototype=new\" d,g.prototype._$op=\"function(t,i){var\" f.src.src_to_x:r.x=\"r.x+(e-r.x)*this._$V0;break;case\" f.src.src_to_y:r.y=\"r.y+(e-r.y)*this._$V0;break;case\" f.src.src_to_g_angle:var o=\"i._$qr();o+=(e-o)*this._$V0,i._$pr(o)}},y.prototype._$YS=function(t,i){},T.prototype=new\" y,t.prototype._$ys=\"function(t,i){switch(this._$YP){default:case\" f.target.target_from_angle:t.setparamfloat(this._$wl,this.scale*i._$5r(),this._$v0);break;case f.target.target_from_angle_v:t.setparamfloat(this._$wl,this.scale*i._$cs(),this._$v0)}},f.src=\"function(){},f.Src.SRC_TO_X=\" src_to_x\",f.src.src_to_y=\"SRC_TO_Y\" ,f.src.src_to_g_angle=\"SRC_TO_G_ANGLE\" ,f.target=\"function(){},f.Target.TARGET_FROM_ANGLE=\"TARGET_FROM_ANGLE\",f.Target.TARGET_FROM_ANGLE_V=\"TARGET_FROM_ANGLE_V\",P.prototype.init=function(t){this._$fL=t._$fL,this._$gL=t._$gL,this._$B0=t._$B0,this._$z0=t._$z0,this._$qT=t._$qT,this.reflectX=t.reflectX,this.reflectY=t.reflectY},P.prototype._$F0=function(t){this._$fL=t._$_T(),this._$gL=t._$_T(),this._$B0=t._$_T(),this._$z0=t._$_T(),this._$qT=t._$_T(),t.getFormatVersion()\"\">=G.LIVE2D_FORMAT_VERSION_V2_10_SDK2&&(this.reflectX=t._$po(),this.reflectY=t._$po())},P.prototype._$e=function(){};var It=function(){};It._$ni=function(t,i,e,r,o,n,s,_,a){var h=s*n-_*o;if(0==h)return null;var l,$=((t-e)*n-(i-r)*o)/h;return l=0!=o?(t-e-$*s)/o:(i-r-$*_)/n,isNaN(l)&&(l=(t-e-$*s)/o,isNaN(l)&&(l=(i-r-$*_)/n),isNaN(l)&&(console.log(\"a is NaN @UtVector#_$ni() \"),console.log(\"v1x : \"+o),console.log(\"v1x != 0 ? \"+(0!=o)))),null==a?new Array(l,$):(a[0]=l,a[1]=$,a)},S.prototype._$8P=function(){return this.x+.5*this.width},S.prototype._$6P=function(){return this.y+.5*this.height},S.prototype._$EL=function(){return this.x+this.width},S.prototype._$5T=function(){return this.y+this.height},S.prototype._$jL=function(t,i,e,r){this.x=t,this.y=i,this.width=e,this.height=r},S.prototype._$jL=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},S.prototype.contains=function(t,i){return this.x<=this.x&&this.y<=this.y&&this.x<=this.x+this.width&&this.y<=this.y+this.height},s.prototype.expand=function(t,i){this.x-=t,this.y-=i,this.width+=2*t,this.height+=2*i},v._$z2=function(t,i,e,r){var o=\"i._$Q2(t,e),n=t._$vs(),s=t._$Tr();if(i._$zr(n,s,o),o<=0)return\" r[n[0]];if(1=\"=o){var\" _=\"r[n[0]],a=r[n[1]],h=s[0];return\" _+(a-_)*h|0}if(2=\"=o){var\" p+(f-p)*u|0}if(3=\"=o){var\" c=\"r[n[0]],d=r[n[1]],g=r[n[2]],y=r[n[3]],m=r[n[4]],T=r[n[5]],P=r[n[6]],S=r[n[7]],h=s[0],u=s[1],v=s[2],_=c+(d-c)*h|0,a=g+(y-g)*h|0,l=m+(T-m)*h|0,$=P+(S-P)*h|0,p=_+(a-_)*u|0,f=l+($-l)*u|0;return\" p+(f-p)*v|0}if(4=\"=o){var\" l=\"r[n[0]],M=r[n[1]],E=r[n[2]],A=r[n[3]],I=r[n[4]],w=r[n[5]],x=r[n[6]],O=r[n[7]],D=r[n[8]],R=r[n[9]],b=r[n[10]],F=r[n[11]],C=r[n[12]],N=r[n[13]],B=r[n[14]],U=r[n[15]],h=s[0],u=s[1],v=s[2],G=s[3],c=L+(M-L)*h|0,d=E+(A-E)*h|0,g=I+(w-I)*h|0,y=x+(O-x)*h|0,m=D+(R-D)*h|0,T=b+(F-b)*h|0,P=C+(N-C)*h|0,S=B+(U-B)*h|0,_=c+(d-c)*u|0,a=g+(y-g)*u|0,l=m+(T-m)*u|0,$=P+(S-P)*u|0,p=_+(a-_)*v|0,f=l+($-l)*v|0;return\" p+(f-p)*g|0}for(var y=\"1<<o,k=new\" float32array(y),v=\"0;V<Y;V++){for(var\" x=\"V,z=1,H=0;H<o;H++)z*=X%2==0?1-s[H]:s[H],X/=2;k[V]=z}for(var\" w=\"new\" float32array(y),j=\"0;j<Y;j++)W[j]=r[n[j]];for(var\" q=\"0,j=0;j<Y;j++)q+=k[j]*W[j];return\" q+.5|0},v._$br=\"function(t,i,e,r){var\" _+(a-_)*h}if(2=\"=o){var\" p=\"r[n[0]],f=r[n[1]],c=r[n[2]],d=r[n[3]],g=r[n[4]],y=r[n[5]],m=r[n[6]],T=r[n[7]],h=s[0],u=s[1],P=s[2];return(1-P)*((1-u)*(p+(f-p)*h)+u*(c+(d-c)*h))+P*((1-u)*(g+(y-g)*h)+u*(m+(T-m)*h))}if(4==o){var\" s=\"r[n[0]],v=r[n[1]],L=r[n[2]],M=r[n[3]],E=r[n[4]],A=r[n[5]],I=r[n[6]],w=r[n[7]],x=r[n[8]],O=r[n[9]],D=r[n[10]],R=r[n[11]],b=r[n[12]],F=r[n[13]],C=r[n[14]],N=r[n[15]],h=s[0],u=s[1],P=s[2],B=s[3];return(1-B)*((1-P)*((1-u)*(S+(v-S)*h)+u*(L+(M-L)*h))+P*((1-u)*(E+(A-E)*h)+u*(I+(w-I)*h)))+B*((1-P)*((1-u)*(x+(O-x)*h)+u*(D+(R-D)*h))+P*((1-u)*(b+(F-b)*h)+u*(C+(N-C)*h)))}for(var\" u=\"1<<o,G=new\" float32array(u),y=\"0;Y<U;Y++){for(var\" k=\"Y,V=1,X=0;X<o;X++)V*=k%2==0?1-s[X]:s[X],k/=2;G[Y]=V}for(var\" z=\"new\" float32array(u),h=\"0;H<U;H++)z[H]=r[n[H]];for(var\" w},v._$vr=\"function(t,i,e,r,o,n,s,_){var\" a=\"i._$Q2(t,e),h=t._$vs(),l=t._$Tr();i._$zr(h,l,a);var\" $=\"2*r,u=s;if(a<=0){var\" for(var if(1=\"=a)for(var\" f=\"o[h[0]],d=o[h[1]],g=l[0],y=1-g,c=0;c<$;)n[u]=f[c]*y+d[c]*g,++c,n[u+1]=f[c]*y+d[c]*g,++c,u+=_;else\" if(2=\"=a)for(var\" if(3=\"=a)for(var\" if(4=\"=a)for(var\" h=\"o[h[0]],W=o[h[1]],j=o[h[2]],q=o[h[3]],J=o[h[4]],Q=o[h[5]],Z=o[h[6]],K=o[h[7]],tt=o[h[8]],it=o[h[9]],et=o[h[10]],rt=o[h[11]],ot=o[h[12]],nt=o[h[13]],st=o[h[14]],_t=o[h[15]],g=l[0],P=l[1],C=l[2],at=l[3],y=1-g,S=1-P,N=1-C,ht=1-at,lt=ht*N*S*y,$t=ht*N*S*g,ut=ht*N*P*y,pt=ht*N*P*g,ft=ht*C*S*y,ct=ht*C*S*g,dt=ht*C*P*y,gt=ht*C*P*g,yt=at*N*S*y,mt=at*N*S*g,Tt=at*N*P*y,Pt=at*N*P*g,St=at*C*S*y,vt=at*C*S*g,Lt=at*C*P*y,Mt=at*C*P*g,c=0;c<$;)n[u]=lt*H[c]+$t*W[c]+ut*j[c]+pt*q[c]+ft*J[c]+ct*Q[c]+dt*Z[c]+gt*K[c]+yt*tt[c]+mt*it[c]+Tt*et[c]+Pt*rt[c]+St*ot[c]+vt*nt[c]+Lt*st[c]+Mt*_t[c],++c,n[u+1]=lt*H[c]+$t*W[c]+ut*j[c]+pt*q[c]+ft*J[c]+ct*Q[c]+dt*Z[c]+gt*K[c]+yt*tt[c]+mt*it[c]+Tt*et[c]+Pt*rt[c]+St*ot[c]+vt*nt[c]+Lt*st[c]+Mt*_t[c],++c,u+=_;else{for(var\" et=\"1<<a,At=new\" float32array(et),it=\"0;It<Et;It++){for(var\" wt=\"It,xt=1,Ot=0;Ot<a;Ot++)xt*=wt%2==0?1-l[Ot]:l[Ot],wt/=2;At[It]=xt}for(var\" dt=\"new\" float32array(et),rt=\"0;Rt<Et;Rt++)Dt[Rt]=o[h[Rt]];for(var\" bt=\"0,Ft=0,Ct=c+1,Rt=0;Rt<Et;Rt++)bt+=At[Rt]*Dt[Rt][c],Ft+=At[Rt]*Dt[Rt][Ct];c+=2,n[u]=bt,n[u+1]=Ft,u+=_}}},L.prototype._$HT=function(t,i){this.x=t,this.y=i},L.prototype._$HT=function(t){this.x=t.x,this.y=t.y},M._$ur=-2,M._$ES=500,M._$wb=2,M._$8S=3,M._$52=M._$ES,M._$R2=M._$ES,M._$or=function(){return\" m._$52},m._$pr=\"function(){return\" m._$r2},m.prototype.convertclipidforv2_11=\"function(t){var\" i=\"[];return\" null=\"=t?null:0==t.length?null:/,/.test(t)?i=t.id.split(\" ,\"):(i.push(t.id),i)},m.prototype._$f0=\"function(t){this._$gP=t._$nP(),this._$dr=t._$nP(),this._$GS=t._$nP(),this._$qb=t._$6L(),this._$Lb=t._$cS(),this._$mS=t._$Tb(),t.getFormatVersion()\"\">=G._$T7?(this.clipID=t._$nP(),this.clipIDList=this.convertClipIDForV2_11(this.clipID)):this.clipIDList=[],this._$MS(this._$Lb)},M.prototype.getClipIDList=function(){return this.clipIDList},M.prototype.init=function(t){},M.prototype._$Nr=function(t,i){if(i._$IS[0]=!1,i._$Us=v._$Z2(t,this._$GS,i._$IS,this._$Lb),at._$Zs);else if(i._$IS[0])return;i._$7s=v._$br(t,this._$GS,i._$IS,this._$mS)},M.prototype._$2b=function(t,i){},M.prototype.getDrawDataID=function(){return this._$gP},M.prototype._$j2=function(t){this._$gP=t},M.prototype.getOpacity=function(t,i){return i._$7s},M.prototype._$zS=function(t,i){return i._$Us},M.prototype._$MS=function(t){for(var i=t.length-1;i>=0;--i){var e=t[i];e<m._$52?m._$52=e:e>M._$R2&&(M._$R2=e)}},M.prototype.getTargetBaseDataID=function(){return this._$dr},M.prototype._$gs=function(t){this._$dr=t},M.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},M.prototype.preDraw=function(t,i,e){},M.prototype.draw=function(t,i,e){},M.prototype.getType=function(){},M.prototype._$B2=function(t,i,e){},E._$ps=32,E.CLIPPING_PROCESS_NONE=0,E.CLIPPING_PROCESS_OVERWRITE_ALPHA=1,E.CLIPPING_PROCESS_MULTIPLY_ALPHA=2,E.CLIPPING_PROCESS_DRAW=3,E.CLIPPING_PROCESS_CLEAR_ALPHA=4,E.prototype.setChannelFlagAsColor=function(t,i){this.CHANNEL_COLORS[t]=i},E.prototype.getChannelFlagAsColor=function(t){return this.CHANNEL_COLORS[t]},E.prototype._$ZT=function(){},E.prototype._$Uo=function(t,i,e,r,o,n,s){},E.prototype._$Rs=function(){return-1},E.prototype._$Ds=function(t){},E.prototype.setBaseColor=function(t,i,e,r){t<0?t=0:t>1&&(t=1),i<0?i=0:i>1&&(i=1),e<0?e=0:e>1&&(e=1),r<0?r=0:r>1&&(r=1),this._$lT=t,this._$C0=i,this._$tT=e,this._$WL=r},E.prototype._$WP=function(t){this.culling=t},E.prototype.setMatrix=function(t){for(var i=0;i<16;i++)this.matrix4x4[i]=t[i]},e.prototype._$it=function(){return this.matrix4x4},e.prototype.setpremultipliedalpha=\"function(t){this.premultipliedAlpha=t},E.prototype.isPremultipliedAlpha=function(){return\" this.premultipliedalpha},e.prototype.setanisotropy=\"function(t){this.anisotropy=t},E.prototype.getAnisotropy=function(){return\" this.anisotropy},e.prototype.getclippingprocess=\"function(){return\" this.clippingprocess},e.prototype.setclippingprocess=\"function(t){this.clippingProcess=t},E.prototype.setClipBufPre_clipContextForMask=function(t){this.clipBufPre_clipContextMask=t},E.prototype.getClipBufPre_clipContextMask=function(){return\" this.clipbufpre_clipcontextmask},e.prototype.setclipbufpre_clipcontextfordraw=\"function(t){this.clipBufPre_clipContextDraw=t},E.prototype.getClipBufPre_clipContextDraw=function(){return\" this.clipbufpre_clipcontextdraw},i._$ur=\"-2,I._$c2=1,I._$_b=2,I.prototype._$F0=function(t){this._$kP=t._$nP(),this._$dr=t._$nP()},I.prototype.readV2_opacity=function(t){t.getFormatVersion()\">=G.LIVE2D_FORMAT_VERSION_V2_10_SDK2&&(this._$mS=t._$Tb())},I.prototype.init=function(t){},I.prototype._$Nr=function(t,i){},I.prototype.interpolateOpacity=function(t,i,e,r){null==this._$mS?e.setInterpolatedOpacity(1):e.setInterpolatedOpacity(v._$br(t,i,r,this._$mS))},I.prototype._$2b=function(t,i){},I.prototype._$nb=function(t,i,e,r,o,n,s){},I.prototype.getType=function(){},I.prototype._$gs=function(t){this._$dr=t},I.prototype._$a2=function(t){this._$kP=t},I.prototype.getTargetBaseDataID=function(){return this._$dr},I.prototype.getBaseDataID=function(){return this._$kP},I.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},w._$W2=0,w._$CS=w._$W2,w._$Mo=function(){return!0},w._$XP=function(t){try{for(var i=getTimeMSec();getTimeMSec()-i<t;);}catch(t){t._$rb()}},w.getusertimemsec=function(){return w._$cs=\"=w._$W2?w.getSystemTimeMSec():w._$CS},w.setUserTimeMSec=function(t){w._$CS=t},w.updateUserTimeMSec=function(){return\" date).gettime()},w.getsystemtimemsec=\"function(){return(new\" date).gettime()},w._$q=\"function(t){},w._$jT=function(t,i,e,r,o){for(var\" n=\"0;n<o;n++)e[r+n]=t[i+n]},x._$ds=-2,x.prototype._$F0=function(t){this._$wL=t._$nP(),this._$VP=t._$6L(),this._$GP=t._$nP()},x.prototype.getParamIndex=function(t){return\" this._$2r!=\"t&&(this._$8o=x._$ds),this._$8o},x.prototype._$Pb=function(t,i){this._$8o=t,this._$2r=i},x.prototype.getParamID=function(){return\" this._$wl},x.prototype._$yp=\"function(t){this._$wL=t},x.prototype._$N2=function(){return\" this._$vp},x.prototype._$d2=\"function(){return\" this._$gp},x.prototype._$t2=\"function(t,i){this._$VP=t,this._$GP=i},x.prototype._$Lr=function(){return\" this._$o2},x.prototype._$wr=\"function(t){this._$O2=t},x.prototype._$SL=function(){return\" this._$ri},x.prototype._$al=\"function(t){this._$ri=t},O.startsWith=function(t,i,e){var\" r=\"i+e.length;if(r\">=t.length)return!1;for(var o=i;o<r;o++)if(o.getchar(t,o)!=e.charat(o-i))return!1;return!0},o.getchar=function(t,i){return string.fromcharcode(t.getuint8(i))},o.createstring=\"function(t,i,e){for(var\" r=\"new\" arraybuffer(2*e),o=\"new\" uint16array(r),n=\"0;n<e;n++)o[n]=t.getUint8(i+n);return\" string.fromcharcode.apply(null,o)},o._$ls=\"function(t,i,e,r){t\" instanceof arraybuffer&&(t=\"new\" dataview(t));var o=\"e,n=!1,s=!1,_=0,a=O.getChar(t,o);\" -\"=\"=a&&(n=!0,o++);for(var\"\" h=\"!1;o<i;o++){switch(a=O.getChar(t,o)){case\" 0\":_*=\"10;break;case\"1\":_=10*_+1;break;case\"2\":_=10*_+2;break;case\"3\":_=10*_+3;break;case\"4\":_=10*_+4;break;case\"5\":_=10*_+5;break;case\"6\":_=10*_+6;break;case\"7\":_=10*_+7;break;case\"8\":_=10*_+8;break;case\"9\":_=10*_+9;break;case\".\":s=!0,o++,h=!0;break;default:h=!0}if(h)break}if(s)for(var\"\" l=\".1,$=!1;o<i;o++){switch(a=O.getChar(t,o)){case\" 0\":break;case\"1\":_+=\"1*l;break;case\"2\":_+=2*l;break;case\"3\":_+=3*l;break;case\"4\":_+=4*l;break;case\"5\":_+=5*l;break;case\"6\":_+=6*l;break;case\"7\":_+=7*l;break;case\"8\":_+=8*l;break;case\"9\":_+=9*l;break;default:$=!0}if(l*=.1,$)break}return\"\" n&&(_=\"-_),r[0]=o,_},D.prototype._$zP=function(){this._$Ob=new\" array},d.prototype._$f0=\"function(t){this._$Ob=t._$nP()},D.prototype._$Ur=function(t){if(t._$WS())return!0;for(var\" i=\"t._$v2(),e=this._$Ob.length-1;e\">=0;--e){var r=this._$Ob[e].getParamIndex(i);if(r==x._$ds&&(r=t.getParamIndex(this._$Ob[e].getParamID())),t._$Xb(r))return!0}return!1},D.prototype._$Q2=function(t,i){for(var e,r,o=this._$Ob.length,n=t._$v2(),s=0,_=0;_<o;_++){var 23242 a=\"this._$Ob[_];if(e=a.getParamIndex(n),e==x._$ds&&(e=t.getParamIndex(a.getParamID()),a._$Pb(e,n)),e<0)throw\" new exception(\"err : \"+a.getparamid());var h=\"e<0?0:t.getParamFloat(e);r=a._$N2();var\" l,$,u=\"a._$d2(),p=-1,f=0;if(r<1);else\" if(1=\"=r)l=u[0],l-U._$J<h&&h<l+U._$J?(p=0,f=0):(p=0,i[0]=!0);else\" if(l=\"u[0],h<l-U._$J)p=0,i[0]=!0;else\" if(h<l+u._$j)p=\"0;else{for(var\" c=\"!1,d=1;d<r;++d){if($=u[d],h<$+U._$J){$-U._$J<h?p=d:(p=d-1,f=(h-l)/($-l),s++),c=!0;break}l=$}c||(p=r-1,f=0,i[0]=!0)}a._$wr(p),a._$AL(f)}return\" s},d.prototype._$zr=\"function(t,i,e){var\" r=\"1<<e;r+1\">U._$Qb&&console.log(\"err 23245\\n\");for(var o=this._$Ob.length,n=1,s=1,_=0,a=0;a<r;++a)t[a]=0;for(var h=\"0;h<o;++h){var\" l=\"this._$Ob[h];if(0==l._$SL()){var\" $=\"l._$Lr()*n;if($<0&&at._$3T)throw\" new exception(\"err 23246\");for(var a=\"0;a<r;++a)t[a]+=$}else{for(var\" r=\"new\" float32array(i),o=\"0;o<i;++o)r[o]=e[o];var\" n=\"new\" x;n._$yp(t),n._$t2(i,r),this._$ob.push(n)},d.prototype._$j2=\"function(t){for(var\" i=\"t,e=this._$Ob.length,r=0;r<e;++r){var\" o=\"this._$Ob[r],n=o._$N2(),s=i%o._$N2(),_=o._$d2()[s];console.log(\" %s[%d]=\"%7.2f\"\" \",o.getparamid(),s,_),i=\"n}console.log(\"\\n\")},d.prototype.getparamcount=\"function(){return\"\" this._$ob.length},d.prototype._$zs=\"function(){return\" this._$ob},r.prototype.identity=\"function(){for(var\" t=\"0;t<16;t++)this.m[t]=t%5==0?1:0},R.prototype.getArray=function(){return\" this.m},r.prototype.getcopymatrix=\"function(){return\" float32array(this.m)},r.prototype.setmatrix=\"function(t){if(null!=t&&16==t.length)for(var\" null=\"=i?null:(this==i?this.mult_safe(this.m,t.m,i.m,e):this.mult_fast(this.m,t.m,i.m,e),i)},R.prototype.mult_safe=function(t,i,e,r){if(t==e){var\" array(16);this.mult_fast(t,i,o,r);for(var>=0;--n)e[n]=o[n]}else this.mult_fast(t,i,e,r)},R.prototype.mult_fast=function(t,i,e,r){r?(e[0]=t[0]*i[0]+t[4]*i[1]+t[8]*i[2],e[4]=t[0]*i[4]+t[4]*i[5]+t[8]*i[6],e[8]=t[0]*i[8]+t[4]*i[9]+t[8]*i[10],e[12]=t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12],e[1]=t[1]*i[0]+t[5]*i[1]+t[9]*i[2],e[5]=t[1]*i[4]+t[5]*i[5]+t[9]*i[6],e[9]=t[1]*i[8]+t[5]*i[9]+t[9]*i[10],e[13]=t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13],e[2]=t[2]*i[0]+t[6]*i[1]+t[10]*i[2],e[6]=t[2]*i[4]+t[6]*i[5]+t[10]*i[6],e[10]=t[2]*i[8]+t[6]*i[9]+t[10]*i[10],e[14]=t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14],e[3]=e[7]=e[11]=0,e[15]=1):(e[0]=t[0]*i[0]+t[4]*i[1]+t[8]*i[2]+t[12]*i[3],e[4]=t[0]*i[4]+t[4]*i[5]+t[8]*i[6]+t[12]*i[7],e[8]=t[0]*i[8]+t[4]*i[9]+t[8]*i[10]+t[12]*i[11],e[12]=t[0]*i[12]+t[4]*i[13]+t[8]*i[14]+t[12]*i[15],e[1]=t[1]*i[0]+t[5]*i[1]+t[9]*i[2]+t[13]*i[3],e[5]=t[1]*i[4]+t[5]*i[5]+t[9]*i[6]+t[13]*i[7],e[9]=t[1]*i[8]+t[5]*i[9]+t[9]*i[10]+t[13]*i[11],e[13]=t[1]*i[12]+t[5]*i[13]+t[9]*i[14]+t[13]*i[15],e[2]=t[2]*i[0]+t[6]*i[1]+t[10]*i[2]+t[14]*i[3],e[6]=t[2]*i[4]+t[6]*i[5]+t[10]*i[6]+t[14]*i[7],e[10]=t[2]*i[8]+t[6]*i[9]+t[10]*i[10]+t[14]*i[11],e[14]=t[2]*i[12]+t[6]*i[13]+t[10]*i[14]+t[14]*i[15],e[3]=t[3]*i[0]+t[7]*i[1]+t[11]*i[2]+t[15]*i[3],e[7]=t[3]*i[4]+t[7]*i[5]+t[11]*i[6]+t[15]*i[7],e[11]=t[3]*i[8]+t[7]*i[9]+t[11]*i[10]+t[15]*i[11],e[15]=t[3]*i[12]+t[7]*i[13]+t[11]*i[14]+t[15]*i[15])},R.prototype.translate=function(t,i,e){this.m[12]=this.m[0]*t+this.m[4]*i+this.m[8]*e+this.m[12],this.m[13]=this.m[1]*t+this.m[5]*i+this.m[9]*e+this.m[13],this.m[14]=this.m[2]*t+this.m[6]*i+this.m[10]*e+this.m[14],this.m[15]=this.m[3]*t+this.m[7]*i+this.m[11]*e+this.m[15]},R.prototype.scale=function(t,i,e){this.m[0]*=t,this.m[4]*=i,this.m[8]*=e,this.m[1]*=t,this.m[5]*=i,this.m[9]*=e,this.m[2]*=t,this.m[6]*=i,this.m[10]*=e,this.m[3]*=t,this.m[7]*=i,this.m[11]*=e},R.prototype.rotateX=function(t){var i=Lt.fcos(t),e=Lt._$9(t),r=this.m[4];this.m[4]=r*i+this.m[8]*e,this.m[8]=r*-e+this.m[8]*i,r=this.m[5],this.m[5]=r*i+this.m[9]*e,this.m[9]=r*-e+this.m[9]*i,r=this.m[6],this.m[6]=r*i+this.m[10]*e,this.m[10]=r*-e+this.m[10]*i,r=this.m[7],this.m[7]=r*i+this.m[11]*e,this.m[11]=r*-e+this.m[11]*i},R.prototype.rotateY=function(t){var i=Lt.fcos(t),e=Lt._$9(t),r=this.m[0];this.m[0]=r*i+this.m[8]*-e,this.m[8]=r*e+this.m[8]*i,r=this.m[1],this.m[1]=r*i+this.m[9]*-e,this.m[9]=r*e+this.m[9]*i,r=m[2],this.m[2]=r*i+this.m[10]*-e,this.m[10]=r*e+this.m[10]*i,r=m[3],this.m[3]=r*i+this.m[11]*-e,this.m[11]=r*e+this.m[11]*i},R.prototype.rotateZ=function(t){var i=Lt.fcos(t),e=Lt._$9(t),r=this.m[0];this.m[0]=r*i+this.m[4]*e,this.m[4]=r*-e+this.m[4]*i,r=this.m[1],this.m[1]=r*i+this.m[5]*e,this.m[5]=r*-e+this.m[5]*i,r=this.m[2],this.m[2]=r*i+this.m[6]*e,this.m[6]=r*-e+this.m[6]*i,r=this.m[3],this.m[3]=r*i+this.m[7]*e,this.m[7]=r*-e+this.m[7]*i},b.prototype=new et,b._$tP=new Object,b._$27=function(){b._$tP.clear()},b.getID=function(t){var i=b._$tP[t];return null==i&&(i=new b(t),b._$tP[t]=i),i},b.prototype._$3s=function(){return new b},F._$kS=-1,F._$pS=0,F._$hb=1,F.STATE_IDENTITY=0,F._$gb=1,F._$fo=2,F._$go=4,F.prototype.transform=function(t,i,e){var r,o,n,s,_,a,h=0,l=0;switch(this._$hi){default:return;case F._$go|F._$fo|F._$gb:for(r=this._$7,o=this._$H,n=this._$k,s=this._$f,_=this._$g,a=this._$w;--e>=0;){var $=t[h++],u=t[h++];i[l++]=r*$+o*u+n,i[l++]=s*$+_*u+a}return;case F._$go|F._$fo:for(r=this._$7,o=this._$H,s=this._$f,_=this._$g;--e>=0;){var $=t[h++],u=t[h++];i[l++]=r*$+o*u,i[l++]=s*$+_*u}return;case F._$go|F._$gb:for(o=this._$H,n=this._$k,s=this._$f,a=this._$w;--e>=0;){var $=t[h++];i[l++]=o*t[h++]+n,i[l++]=s*$+a}return;case F._$go:for(o=this._$H,s=this._$f;--e>=0;){var $=t[h++];i[l++]=o*t[h++],i[l++]=s*$}return;case F._$fo|F._$gb:for(r=this._$7,n=this._$k,_=this._$g,a=this._$w;--e>=0;)i[l++]=r*t[h++]+n,i[l++]=_*t[h++]+a;return;case F._$fo:for(r=this._$7,_=this._$g;--e>=0;)i[l++]=r*t[h++],i[l++]=_*t[h++];return;case F._$gb:for(n=this._$k,a=this._$w;--e>=0;)i[l++]=t[h++]+n,i[l++]=t[h++]+a;return;case F.STATE_IDENTITY:return void(t==i&&h==l||w._$jT(t,h,i,l,2*e))}},F.prototype.update=function(){0==this._$H&&0==this._$f?1==this._$7&&1==this._$g?0==this._$k&&0==this._$w?(this._$hi=F.STATE_IDENTITY,this._$Z=F._$pS):(this._$hi=F._$gb,this._$Z=F._$hb):0==this._$k&&0==this._$w?(this._$hi=F._$fo,this._$Z=F._$kS):(this._$hi=F._$fo|F._$gb,this._$Z=F._$kS):0==this._$7&&0==this._$g?0==this._$k&&0==this._$w?(this._$hi=F._$go,this._$Z=F._$kS):(this._$hi=F._$go|F._$gb,this._$Z=F._$kS):0==this._$k&&0==this._$w?(this._$hi=F._$go|F._$fo,this._$Z=F._$kS):(this._$hi=F._$go|F._$fo|F._$gb,this._$Z=F._$kS)},F.prototype._$RT=function(t){this._$IT(t);var i=t[0],e=t[2],r=t[1],o=t[3],n=Math.sqrt(i*i+r*r),s=i*o-e*r;0==n?at._$so&&console.log(\"affine._$RT() / rt==0\"):(t[0]=n,t[1]=s/n,t[2]=(r*o+i*e)/s,t[3]=Math.atan2(r,i))},F.prototype._$ho=function(t,i,e,r){var o=new Float32Array(6),n=new Float32Array(6);t._$RT(o),i._$RT(n);var s=new Float32Array(6);s[0]=o[0]+(n[0]-o[0])*e,s[1]=o[1]+(n[1]-o[1])*e,s[2]=o[2]+(n[2]-o[2])*e,s[3]=o[3]+(n[3]-o[3])*e,s[4]=o[4]+(n[4]-o[4])*e,s[5]=o[5]+(n[5]-o[5])*e,r._$CT(s)},F.prototype._$CT=function(t){var i=Math.cos(t[3]),e=Math.sin(t[3]);this._$7=t[0]*i,this._$f=t[0]*e,this._$H=t[1]*(t[2]*i-e),this._$g=t[1]*(t[2]*e+i),this._$k=t[4],this._$w=t[5],this.update()},F.prototype._$IT=function(t){t[0]=this._$7,t[1]=this._$f,t[2]=this._$H,t[3]=this._$g,t[4]=this._$k,t[5]=this._$w},C.prototype=new s,C._$cs=\"VISIBLE:\",C._$ar=\"LAYOUT:\",C._$Co=0,C._$D2=[],C._$1T=1,C.loadMotion=function(t){var i=new C,e=[0],r=t.length;i._$yT=0;for(var o=0;o<r;++o){var n=\"255&t[o];if(\" \\n\"!=\"n&&\"\\r\"!=n)if(\"#\"!=n)if(\"$\"!=n){if(\"a\"<=n&&n<=\"z\"||\"A\"<=n&&n<=\"Z\"||\"_\"==n){for(var\"\" s=\"o,_=-1;o<r&&(\" \\r\"!=\"(n=255&t[o])&&\"\\n\"!=n);++o)if(\"=\"==n){_=o;break}if(_\"\">=0){var a=new B;O.startsWith(t,s,C._$cs)?(a._$RP=B._$hs,a._$4P=new String(t,s,_-s)):O.startsWith(t,s,C._$ar)?(a._$4P=new String(t,s+7,_-s-7),O.startsWith(t,s+7,\"ANCHOR_X\")?a._$RP=B._$xs:O.startsWith(t,s+7,\"ANCHOR_Y\")?a._$RP=B._$us:O.startsWith(t,s+7,\"SCALE_X\")?a._$RP=B._$qs:O.startsWith(t,s+7,\"SCALE_Y\")?a._$RP=B._$Ys:O.startsWith(t,s+7,\"X\")?a._$RP=B._$ws:O.startsWith(t,s+7,\"Y\")&&(a._$RP=B._$Ns)):(a._$RP=B._$Fr,a._$4P=new String(t,s,_-s)),i.motions.push(a);var h=0;for(C._$D2.clear(),o=_+1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\" \\t\"!=\"n){var\"\" l=\"O._$LS(t,r,o,e);if(e[0]\">0){C._$D2.push(l),h++;var $=e[0];if($<o){console.log(\"_$n0 _$hi . @live2dmotion loadmotion()\\n\");break}o=\"$}}a._$I0=C._$D2._$BL(),h\">i._$yT&&(i._$yT=h)}}}else{for(var s=o,_=-1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\"=\"==n){_=o;break}var u=\"!1;if(_\">=0)for(_==s+4&&\"f\"==t[s+1]&&\"p\"==t[s+2]&&\"s\"==t[s+3]&&(u=!0),o=_+1;o<r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\" \\t\"!=\"n){var\"\" l=\"O._$LS(t,r,o,e);e[0]\">0&&u&&5<l&&l<121&&(i._$d0=l),o=e[0]}for(;o<r&&(\"\\n\"!=t[o]&&\"\\r\"!=t[o]);++o);}else for(;o<r&&(\"\\n\"!=\"t[o]&&\" \\r\"!=\"t[o]);++o);}return\"\" i._$as=\"1e3*i._$yT/i._$D0|0,i},C.prototype.getDurationMSec=function(){return\" this._$as},c.prototype.dump=\"function(){for(var\" t=\"0;t<this.motions.length;t++){var\" i=\"this.motions[t];console.log(\" _$wl[%s]\" [%d]. \",i._$4p,i._$i0.length);for(var e=\"0;e<i._$I0.length&&e<10;e++)console.log(\" %5.2f\" ,\",i._$i0[e]);console.log(\"\\n\")}},c.prototype.updateparamexe=\"function(t,i,e,r){for(var\" o=\"i-r._$z2,n=o*this._$D0/1e3,s=0|n,_=n-s,a=0;a<this.motions.length;a++){var\" h=\"this.motions[a],l=h._$I0.length,$=h._$4P;if(h._$RP==B._$hs){var\" u=\"h._$I0[s\">=l?l-1:s];t.setParamFloat($,u)}else if(B._$ws<=h._$rp&&h._$rp<=b._$ys);else{var p=\"t.getParamFloat($),f=h._$I0[s\">=l?l-1:s],c=h._$I0[s+1>=l?l-1:s+1],d=f+(c-f)*_,g=p+(d-p)*e;t.setParamFloat($,g)}}s>=this._$yT&&(this._$E?(r._$z2=i,this.loopFadeIn&&(r._$bs=i)):r._$9L=!0)},C.prototype._$r0=function(){return this._$E},C.prototype._$aL=function(t){this._$E=t},C.prototype.isLoopFadeIn=function(){return this.loopFadeIn},C.prototype.setLoopFadeIn=function(t){this.loopFadeIn=t},N.prototype.clear=function(){this.size=0},N.prototype.add=function(t){if(this._$P.length<=this.size){var i=\"new\" float32array(2*this.size);w._$jt(this._$p,0,i,0,this.size),this._$p=\"i}this._$P[this.size++]=t},N.prototype._$BL=function(){var\" t=\"new\" float32array(this.size);return w._$jt(this._$p,0,t,0,this.size),t},b._$fr=\"0,B._$hs=1,B._$ws=100,B._$Ns=101,B._$xs=102,B._$us=103,B._$qs=104,B._$Ys=105,U._$Ms=1,U._$Qs=2,U._$i2=0,U._$No=2,U._$do=U._$Ms,U._$Ls=!0,U._$1r=5,U._$Qb=65,U._$J=1e-4,U._$FT=.001,U._$Ss=3,G._$o7=6,G._$S7=7,G._$s7=8,G._$77=9,G.LIVE2D_FORMAT_VERSION_V2_10_SDK2=10,G.LIVE2D_FORMAT_VERSION_V2_11_SDK2_1=11,G._$T7=G.LIVE2D_FORMAT_VERSION_V2_11_SDK2_1,G._$Is=-2004318072,G._$h0=0,G._$4L=23,G._$7P=33,G._$uT=function(t){console.log(\" _$bo\" :: _$6 _$mo _$e0 : %d\\n\",t)},g._$9o=\"function(t){if(t<40)return\" g._$ut(t),null;if(t<50)return g._$ut(t),null;if(t<60)return g._$ut(t),null;if(t<100)switch(t){case 65:return new z;case 66:return d;case 67:return x;case 68:return 69:return p;case 70:return $t;default:return g._$ut(t),null}else if(t<150)switch(t){case 131:return st;case 133:return tt;case 136:return 137:return ot;case 142:return j}return g._$ut(t),null},y._$hp=\"0,Y._$_0=!0;Y._$V2=-1,Y._$W0=-1,Y._$jr=!1,Y._$ZS=!0,Y._$tr=-1e6,Y._$lr=1e6,Y._$is=32,Y._$e=!1,Y.prototype.getDrawDataIndex=function(t){for(var\">=0;--i)if(null!=this._$aS[i]&&this._$aS[i].getDrawDataID()==t)return i;return-1},Y.prototype.getDrawData=function(t){if(t instanceof b){if(null==this._$Bo){this._$Bo=new Object;for(var i=this._$aS.length,e=0;e<i;e++){var r=\"this._$aS[e],o=r.getDrawDataID();null!=o&&(this._$Bo[o]=r)}}return\" this._$bo[id]}return t<this._$as.length?this._$as[t]:null},y.prototype.release=\"function(){this._$3S.clear(),this._$aS.clear(),this._$F2.clear(),null!=this._$Bo&&this._$Bo.clear(),this._$db.clear(),this._$8b.clear(),this._$Hr.clear()},Y.prototype.init=function(){this._$co++,this._$F2.length\">0&&this.release();for(var t=this._$Ri.getModelImpl(),i=t._$Xr(),r=i.length,o=new Array,n=new Array,s=0;s<r;++s){var _=\"i[s];this._$F2.push(_),this._$Hr.push(_.init(this));for(var\" a=\"_.getBaseData(),h=a.length,l=0;l<h;++l)o.push(a[l]);for(var\" l=\"0;l<h;++l){var\" $=\"a[l].init(this);$._$l2(s),n.push($)}for(var\" u=\"_.getDrawData(),p=u.length,l=0;l<p;++l){var\" f=\"u[l],c=f.init(this);c._$IP=s,this._$aS.push(f),this._$8b.push(c)}}for(var\" d=\"o.length,g=yt._$2o();;){for(var\" y=\"!1,s=0;s<d;++s){var\" m=\"o[s];if(null!=m){var\" t=\"m.getTargetBaseDataID();(null==T||T==g||this.getBaseDataIndex(T)\">=0)&&(this._$3S.push(m),this._$db.push(n[s]),o[s]=null,y=!0)}}if(!y)break}var P=t._$E2();if(null!=P){var S=P._$1s();if(null!=S)for(var v=S.length,s=0;s<v;++s){var l=\"S[s];null!=L&&this._$02(L.getParamID(),L.getDefaultValue(),L.getMinValue(),L.getMaxValue())}}this.clipManager=new\" e(this.dp_webgl),this.clipmanager.init(this,this._$as,this._$8b),this._$qt=\"!0},Y.prototype.update=function(){Y._$e&&_.start(\" _$zl\");for(var\" t=\"this._$_2.length,i=0;i<t;i++)this._$_2[i]!=this._$vr[i]&&(this._$Js[i]=Y._$ZS,this._$vr[i]=this._$_2[i]);var\" e=\"this._$3S.length,r=this._$aS.length,o=W._$or(),n=W._$Pr(),s=n-o+1;(null==this._$Ws||this._$Ws.length<s)&&(this._$Ws=new\" int16array(s),this._$vs=\"new\" int16array(s));for(var i=\"0;i<s;i++)this._$Ws[i]=Y._$V2,this._$Vs[i]=Y._$V2;(null==this._$Er||this._$Er.length<r)&&(this._$Er=new\" int16array(r));for(var a=\"null,h=0;h<e;++h){var\" u=\"null,p=0;p<r;++p){var\" f=\"this._$aS[p],c=this._$8b[p];try{if(f._$Nr(this,c),c._$u2())continue;f._$2b(this,c);var\" d,g=\"Math.floor(f._$zS(this,c)-o);try{d=this._$Vs[g]}catch(t){console.log(\" _$li\" :: %s \\t\\t\\t\\t@@_$fs\\n\",t.tostring(),f.getdrawdataid().tostring()),g=\"Math.floor(f._$zS(this,c)-o);continue}d==Y._$V2?this._$Ws[g]=p:this._$Er[d]=p,this._$Vs[g]=p}catch(t){null==u&&(u=t,at._$sT(at._$H7))}}null!=u&&Y._$_0&&_._$Rb(u),Y._$e&&_.dump(\" _$dl\"),y._$e&&_.start(\"_$el\");for(var\">=0;i--)this._$Js[i]=Y._$jr;return this._$QT=!1,Y._$e&&_.dump(\"_$eL\"),!1},Y.prototype.preDraw=function(t){null!=this.clipManager&&(t._$ZT(),this.clipManager.setupClip(this,t))},Y.prototype.draw=function(t){if(null==this._$Ws)return void _._$li(\"call _$Ri.update() before _$Ri.draw() \");var i=this._$Ws.length;t._$ZT();for(var e=0;e<i;++e){var r=\"this._$Ws[e];if(r!=Y._$V2)for(;;){var\" o=\"this._$aS[r],n=this._$8b[r];if(n._$yo()){var\" s=\"n._$IP,a=this._$Hr[s];n._$VS=a.getPartsOpacity(),o.draw(t,this,n)}var\" h=\"this._$Er[r];if(h<=r||h==Y._$W0)break;r=h}}},Y.prototype.getParamIndex=function(t){for(var\" i=\"this._$pb.length-1;i\">=0;--i)if(this._$pb[i]==t)return i;return this._$02(t,0,Y._$tr,Y._$lr)},Y.prototype._$BS=function(t){return this.getBaseDataIndex(t)},Y.prototype.getBaseDataIndex=function(t){for(var i=this._$3S.length-1;i>=0;--i)if(null!=this._$3S[i]&&this._$3S[i].getBaseDataID()==t)return i;return-1},Y.prototype._$UT=function(t,i){var e=new Float32Array(i);return w._$jT(t,0,e,0,t.length),e},Y.prototype._$02=function(t,i,e,r){if(this._$qo>=this._$pb.length){var o=this._$pb.length,n=new Array(2*o);w._$jT(this._$pb,0,n,0,o),this._$pb=n,this._$_2=this._$UT(this._$_2,2*o),this._$vr=this._$UT(this._$vr,2*o),this._$Rr=this._$UT(this._$Rr,2*o),this._$Or=this._$UT(this._$Or,2*o);var s=new Array;w._$jT(this._$Js,0,s,0,o),this._$Js=s}return this._$pb[this._$qo]=t,this._$_2[this._$qo]=i,this._$vr[this._$qo]=i,this._$Rr[this._$qo]=e,this._$Or[this._$qo]=r,this._$Js[this._$qo]=Y._$ZS,this._$qo++},Y.prototype._$Zo=function(t,i){this._$3S[t]=i},Y.prototype.setParamFloat=function(t,i){i<this._$rr[t]&&(i=this._$rr[t]),i>this._$Or[t]&&(i=this._$Or[t]),this._$_2[t]=i},Y.prototype.loadParam=function(){var t=this._$_2.length;t>this._$fs.length&&(t=this._$fs.length),w._$jT(this._$fs,0,this._$_2,0,t)},Y.prototype.saveParam=function(){var t=this._$_2.length;t>this._$fs.length&&(this._$fs=new Float32Array(t)),w._$jT(this._$_2,0,this._$fs,0,t)},Y.prototype._$v2=function(){return this._$co},Y.prototype._$WS=function(){return this._$QT},Y.prototype._$Xb=function(t){return this._$Js[t]==Y._$ZS},Y.prototype._$vs=function(){return this._$Es},Y.prototype._$Tr=function(){return this._$ZP},Y.prototype.getBaseData=function(t){return this._$3S[t]},Y.prototype.getParamFloat=function(t){return this._$_2[t]},Y.prototype.getParamMax=function(t){return this._$Or[t]},Y.prototype.getParamMin=function(t){return this._$Rr[t]},Y.prototype.setPartsOpacity=function(t,i){this._$Hr[t].setPartsOpacity(i)},Y.prototype.getPartsOpacity=function(t){return this._$Hr[t].getPartsOpacity()},Y.prototype.getPartsDataIndex=function(t){for(var i=this._$F2.length-1;i>=0;--i)if(null!=this._$F2[i]&&this._$F2[i]._$p2()==t)return i;return-1},Y.prototype._$q2=function(t){return this._$db[t]},Y.prototype._$C2=function(t){return this._$8b[t]},Y.prototype._$Bb=function(t){return this._$Hr[t]},Y.prototype._$5s=function(t,i){for(var e=this._$Ws.length,r=t,o=0;o<e;++o){var n=\"this._$Ws[o];if(n!=Y._$V2)for(;;){var\" s=\"this._$8b[n];s._$yo()&&(s._$GT()._$B2(this,s,r),r+=i);var\" _=\"this._$Er[n];if(_<=n||_==Y._$W0)break;n=_}}},Y.prototype.setDrawParam=function(t){this.dp_webgl=t},Y.prototype.getDrawParam=function(){return\" this.dp_webgl},k._$0t=\"function(t){return\" k._$0t(new _$5(t))},k._$0t=\"function(t){if(!t.exists())throw\" new _$ls(t._$3b());for(var i,e=\"t.length(),r=new\" int8array(e),o=\"new\" _$xs(new _$kb(t),8192),n=\"0;(i=o.read(r,n,e-n))\">0;)n+=i;return r},k._$C=function(t){var i=null,e=null;try{i=t instanceof Array?t:new _$Xs(t,8192),e=new _$js;for(var r,o=new Int8Array(1e3);(r=i.read(o))>0;)e.write(o,0,r);return e._$TS()}finally{null!=t&&t.close(),null!=e&&(e.flush(),e.close())}},V.prototype._$T2=function(){return w.getUserTimeMSec()+Math._$10()*(2*this._$Br-1)},V.prototype._$uo=function(t){this._$Br=t},V.prototype._$QS=function(t,i,e){this._$Dr=t,this._$Cb=i,this._$mr=e},V.prototype._$7T=function(t){var i,e=w.getUserTimeMSec(),r=0;switch(this._$_L){case STATE_CLOSING:r=(e-this._$bb)/this._$Dr,r>=1&&(r=1,this._$_L=wt.STATE_CLOSED,this._$bb=e),i=1-r;break;case STATE_CLOSED:r=(e-this._$bb)/this._$Cb,r>=1&&(this._$_L=wt.STATE_OPENING,this._$bb=e),i=0;break;case STATE_OPENING:r=(e-this._$bb)/this._$mr,r>=1&&(r=1,this._$_L=wt.STATE_INTERVAL,this._$12=this._$T2()),i=r;break;case STATE_INTERVAL:this._$12<e&&(this._$_l=wt.state_closing,this._$bb=e),i=1;break;case state_first:default:this._$_l=\"wt.STATE_INTERVAL,this._$12=this._$T2(),i=1}this._$jo||(i=-i),t.setParamFloat(this._$iL,i),t.setParamFloat(this._$0L,i)};var\" wt=\"function(){};wt.STATE_FIRST=\" state_first\",wt.state_interval=\"STATE_INTERVAL\" ,wt.state_closing=\"STATE_CLOSING\" ,wt.state_closed=\"STATE_CLOSED\" ,wt.state_opening=\"STATE_OPENING\" ,x.prototype=\"new\"\" e,x._$as=\"32,X._$Gr=!1,X._$NT=null,X._$vS=null,X._$no=null,X._$9r=function(t){return\" new float32array(t)},x._$vb=\"function(t){return\" int16array(t)},x._$cr=\"function(t,i){return\" null=\"=t||t._$yL()<i.length?(t=X._$9r(2*i.length),t.put(i),t._$oT(0)):(t.clear(),t.put(i),t._$oT(0)),t},X._$mb=function(t,i){return\" x._$gr},x._$as=\"function(t){X._$Gr=t},X.prototype.setGL=function(t){this.gl=t},X.prototype.setTransform=function(t){this.transform=t},X.prototype._$ZT=function(){},X.prototype._$Uo=function(t,i,e,r,o,n,s,_){if(!(n<.01)){var\" a=\"this._$U2[t],h=n\">.9?at.EXPAND_W:0;this.gl.drawElements(a,e,r,o,n,h,this.transform,_)}},X.prototype._$Rs=function(){throw new Error(\"_$Rs\")},X.prototype._$Ds=function(t){throw new Error(\"_$Ds\")},X.prototype._$K2=function(){for(var t=0;t<this._$sb.length;t++){0!=this._$sb[t]&&(this.gl._$sr(1,this._$sb,t),this._$sb[t]=0)}},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$sb[t]=i},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$u2[t]=i},x.prototype._$ns=function(t){var i=\"Math.max(2*this._$sb.length,t+1+10),e=new\" int32array(i);w._$jt(this._$sb,0,e,0,this._$sb.length),this._$sb=\"e;var\" r=\"new\" array;w._$jt(this._$u2,0,r,0,this._$u2.length),this._$u2=\"r},z.prototype=new\" i,z._$xo=\"new\" float32array(2),z._$io=\"new\" float32array(2),z._$0o=\"new\" float32array(2),z._$lo=\"new\" float32array(2),z._$to=\"new\" float32array(2),z._$po=\"new\" float32array(2),z._$gt=\"new\" array,z.prototype._$zp=\"function(){this._$GS=new\" d,this._$gs._$zp(),this._$y0=\"new\" array},z.prototype.gettype=\"function(){return\" i._$c2},z.prototype._$f0=\"function(t){I.prototype._$F0.call(this,t),this._$GS=t._$nP(),this._$Y0=t._$nP(),I.prototype.readV2_opacity.call(this,t)},z.prototype.init=function(t){var\" h(this);return i._$yr=\"new\" p,this._$32()&&(i._$wr=\"new\" p),i},z.prototype._$nr=\"function(t,i){this!=i._$GT()&&console.log(\" ###\" assert!! ### \");var e=\"i;if(this._$GS._$Ur(t)){var\" o=\"this._$GS._$Q2(t,r);i._$Ib(r[0]),this.interpolateOpacity(t,this._$GS,i,r);var\" n=\"t._$vs(),s=t._$Tr();if(this._$GS._$zr(n,s,o),o<=0){var\" _=\"this._$Y0[n[0]];e._$Yr.init(_)}else\" if(1=\"=o){var\" if(2=\"=o){var\" if(3=\"=o){var\" c=\"this._$Y0[n[0]],d=this._$Y0[n[1]],g=this._$Y0[n[2]],y=this._$Y0[n[3]],m=this._$Y0[n[4]],T=this._$Y0[n[5]],P=this._$Y0[n[6]],S=this._$Y0[n[7]],h=s[0],u=s[1],v=s[2],p=c._$fL+(d._$fL-c._$fL)*h,f=g._$fL+(y._$fL-g._$fL)*h,L=m._$fL+(T._$fL-m._$fL)*h,M=P._$fL+(S._$fL-P._$fL)*h;e._$Yr._$fL=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$gL+(d._$gL-c._$gL)*h,f=g._$gL+(y._$gL-g._$gL)*h,L=m._$gL+(T._$gL-m._$gL)*h,M=P._$gL+(S._$gL-P._$gL)*h,e._$Yr._$gL=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$B0+(d._$B0-c._$B0)*h,f=g._$B0+(y._$B0-g._$B0)*h,L=m._$B0+(T._$B0-m._$B0)*h,M=P._$B0+(S._$B0-P._$B0)*h,e._$Yr._$B0=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$z0+(d._$z0-c._$z0)*h,f=g._$z0+(y._$z0-g._$z0)*h,L=m._$z0+(T._$z0-m._$z0)*h,M=P._$z0+(S._$z0-P._$z0)*h,e._$Yr._$z0=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u),p=c._$qT+(d._$qT-c._$qT)*h,f=g._$qT+(y._$qT-g._$qT)*h,L=m._$qT+(T._$qT-m._$qT)*h,M=P._$qT+(S._$qT-P._$qT)*h,e._$Yr._$qT=(1-v)*(p+(f-p)*u)+v*(L+(M-L)*u)}else\" if(4=\"=o){var\" j=\"0|Math.pow(2,o),q=new\" float32array(j),j=\"0;J<j;J++){for(var\" q=\"J,Z=1,K=0;K<o;K++)Z*=Q%2==0?1-s[K]:s[K],Q/=2;q[J]=Z}for(var\" tt=\"new\" array,it=\"0;it<j;it++)tt[it]=this._$Y0[n[it]];for(var\" et=\"0,rt=0,ot=0,nt=0,st=0,it=0;it<j;it++)et+=q[it]*tt[it]._$fL,rt+=q[it]*tt[it]._$gL,ot+=q[it]*tt[it]._$B0,nt+=q[it]*tt[it]._$z0,st+=q[it]*tt[it]._$qT;e._$Yr._$fL=et,e._$Yr._$gL=rt,e._$Yr._$B0=ot,e._$Yr._$z0=nt,e._$Yr._$qT=st}var\" _$0p _$g :: %s\",r),e._$hs(!1);else{var a=\"z._$io;a[0]=0,a[1]=-.1;n._$GT().getType()==I._$c2?a[1]=-10:a[1]=-.1;var\" h=\"z._$0o;this._$Jr(t,o,n,s,a,h);var\" l=\"Lt._$92(a,h);o._$nb(t,n,s,s,1,0,2),e._$Wr._$fL=s[0],e._$Wr._$gL=s[1],e._$Wr._$B0=e._$Yr._$B0,e._$Wr._$z0=e._$Yr._$z0,e._$Wr._$qT=e._$Yr._$qT-l*Lt._$NS;var\" $=\"n.getTotalScale();e.setTotalScale_notForClient($*e._$Wr._$B0);var\" u=\"n.getTotalOpacity();e.setTotalOpacity(u*e.getInterpolatedOpacity()),e._$Wr.reflectX=e._$Yr.reflectX,e._$Wr.reflectY=e._$Yr.reflectY,e._$hS(n._$yo())}else\" e._$hs(!1)}}else e.settotalscale_notforclient(e._$yr._$b0),e.settotalopacity(e.getinterpolatedopacity())},z.prototype._$nb=\"function(t,i,e,r,o,n,s){this!=i._$GT()&&console.log(\" \");for(var _,a,h=\"i,l=null!=h._$Wr?h._$Wr:h._$Yr,$=Math.sin(Lt._$bS*l._$qT),u=Math.cos(Lt._$bS*l._$qT),p=h.getTotalScale(),f=l.reflectX?-1:1,c=l.reflectY?-1:1,d=u*p*f,g=-$*p*c,y=$*p*f,m=u*p*c,T=l._$fL,P=l._$gL,S=o*s,v=n;v<S;v+=s)_=e[v],a=e[v+1],r[v]=d*_+g*a+T,r[v+1]=y*_+m*a+P},z.prototype._$Jr=function(t,i,e,r,o,n){i!=e._$GT()&&console.log(\" s=\"z._$Lo;z._$Lo[0]=r[0],z._$Lo[1]=r[1],i._$nb(t,e,s,s,1,0,2);for(var\" n[0]=\"_[0],void(n[1]=_[1]);if(a[0]=r[0]-h*o[0],a[1]=r[1]-h*o[1],i._$nb(t,e,a,_,1,0,2),_[0]-=s[0],_[1]-=s[1],0!=_[0]||0!=_[1])return\" _[0]=\"-_[0],_[0]=-_[0],n[0]=_[0],void(n[1]=_[1]);h*=.1}at._$so&&console.log(\" _$l0\" to transform _$sp\\n\")},h.prototype=\"new\" _t,w.prototype=\"new\" m,w._$ur=\"-2,W._$ES=500,W._$wb=2,W._$8S=3,W._$os=4,W._$52=W._$ES,W._$R2=W._$ES,W._$Sb=function(t){for(var\">=0;--i){var e=t[i];e<w._$52?w._$52=e:e>W._$R2&&(W._$R2=e)}},W._$or=function(){return W._$52},W._$Pr=function(){return W._$R2},W.prototype._$F0=function(t){this._$gP=t._$nP(),this._$dr=t._$nP(),this._$GS=t._$nP(),this._$qb=t._$6L(),this._$Lb=t._$cS(),this._$mS=t._$Tb(),t.getFormatVersion()>=G._$T7?(this.clipID=t._$nP(),this.clipIDList=this.convertClipIDForV2_11(this.clipID)):this.clipIDList=null,W._$Sb(this._$Lb)},W.prototype.getClipIDList=function(){return this.clipIDList},W.prototype._$Nr=function(t,i){if(i._$IS[0]=!1,i._$Us=v._$Z2(t,this._$GS,i._$IS,this._$Lb),at._$Zs);else if(i._$IS[0])return;i._$7s=v._$br(t,this._$GS,i._$IS,this._$mS)},W.prototype._$2b=function(t){},W.prototype.getDrawDataID=function(){return this._$gP},W.prototype._$j2=function(t){this._$gP=t},W.prototype.getOpacity=function(t,i){return i._$7s},W.prototype._$zS=function(t,i){return i._$Us},W.prototype.getTargetBaseDataID=function(){return this._$dr},W.prototype._$gs=function(t){this._$dr=t},W.prototype._$32=function(){return null!=this._$dr&&this._$dr!=yt._$2o()},W.prototype.getType=function(){},j._$42=0,j.prototype._$1b=function(){return this._$3S},j.prototype.getDrawDataList=function(){return this._$aS},j.prototype._$F0=function(t){this._$NL=t._$nP(),this._$aS=t._$nP(),this._$3S=t._$nP()},j.prototype._$kr=function(t){t._$Zo(this._$3S),t._$xo(this._$aS),this._$3S=null,this._$aS=null},q.prototype=new i,q.loadModel=function(t){var e=new q;return i._$62(e,t),e},q.loadModel=function(t){var e=new q;return i._$62(e,t),e},q._$to=function(){return new q},q._$er=function(t){var i=new _$5(\"../_$_r/_$t0/_$Ri/_$_P._$d\");if(0==i.exists())throw new _$ls(\"_$t0 _$_ _$6 _$Ui :: \"+i._$PL());for(var e=[\"../_$_r/_$t0/_$Ri/_$_P.512/_$CP._$1\",\"../_$_r/_$t0/_$Ri/_$_P.512/_$vP._$1\",\"../_$_r/_$t0/_$Ri/_$_P.512/_$EP._$1\",\"../_$_r/_$t0/_$Ri/_$_P.512/_$pP._$1\"],r=q.loadModel(i._$3b()),o=0;o<e.length;o++){var n=\"new\" _$5(e[o]);if(0=\"=n.exists())throw\" new _$ls(\"_$t0 _$_ _$6 _$ui :: \"+n._$pl());r.settexture(o,_$nl._$_o(t,n._$3b()))}return r},q.prototype.setgl=\"function(t){this._$zo.setGL(t)},q.prototype.setTransform=function(t){this._$zo.setTransform(t)},q.prototype.draw=function(){this._$5S.draw(this._$zo)},q.prototype._$K2=function(){this._$zo._$K2()},q.prototype.setTexture=function(t,i){null==this._$zo&&_._$li(\" _$yi\" for qt _$ki _$xs() is _$ui!!\"),this._$zo.settexture(t,i)},q.prototype.settexture=\"function(t,i){null==this._$zo&&_._$li(\" _$ui!!\"),this._$zo.settexture(t,i)},q.prototype._$rs=\"function(){return\" this._$zo._$rs()},q.prototype._$ds=\"function(t){this._$zo._$Ds(t)},q.prototype.getDrawParam=function(){return\" this._$zo},j.prototype=\"new\" s,j._$cs=\"VISIBLE:\" ,j._$ar=\"LAYOUT:\" ,j.mtn_prefix_fadein=\"FADEIN:\" ,j.mtn_prefix_fadeout=\"FADEOUT:\" ,j._$co=\"0,J._$1T=1,J.loadMotion=function(t){var\" i=\"k._$C(t);return\" j.loadmotion(i)},j.loadmotion=\"function(t){t\" instanceof arraybuffer&&(t=\"new\" dataview(t));var j,e=\"[0],r=t.byteLength;i._$yT=0;for(var\" o=\"0;o<r;++o){var\" _=\"o,a=-1;o<r&&(\" \\r\"!=\"(n=Q(t,o))&&\"\\n\"!=n);++o)if(\"=\"==n){a=o;break}if(a\"\">=0){var h=new B;O.startsWith(t,_,J._$cs)?(h._$RP=B._$hs,h._$4P=O.createString(t,_,a-_)):O.startsWith(t,_,J._$ar)?(h._$4P=O.createString(t,_+7,a-_-7),O.startsWith(t,_+7,\"ANCHOR_X\")?h._$RP=B._$xs:O.startsWith(t,_+7,\"ANCHOR_Y\")?h._$RP=B._$us:O.startsWith(t,_+7,\"SCALE_X\")?h._$RP=B._$qs:O.startsWith(t,_+7,\"SCALE_Y\")?h._$RP=B._$Ys:O.startsWith(t,_+7,\"X\")?h._$RP=B._$ws:O.startsWith(t,_+7,\"Y\")&&(h._$RP=B._$Ns)):(h._$RP=B._$Fr,h._$4P=O.createString(t,_,a-_)),i.motions.push(h);var l=0,$=[];for(o=a+1;o<r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\" \\t\"!=\"n){var\"\" u=\"O._$LS(t,r,o,e);if(e[0]\">0){$.push(u),l++;var p=e[0];if(p<o){console.log(\"_$n0 _$hi . @live2dmotion loadmotion()\\n\");break}o=\"p-1}}h._$I0=new\" float32array($),l>i._$yT&&(i._$yT=l)}}}else{for(var _=o,a=-1;o<r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\"=\"==n){a=o;break}var f=\"!1;if(a\">=0)for(a==_+4&&\"f\"==Q(t,_+1)&&\"p\"==Q(t,_+2)&&\"s\"==Q(t,_+3)&&(f=!0),o=a+1;o<r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\" \"!=\"n&&\" \\t\"!=\"n){var\"\" u=\"O._$LS(t,r,o,e);e[0]\">0&&f&&5<u&&u<121&&(i._$d0=u),o=e[0]}for(;o<r&&(\"\\n\"!=q(t,o)&&\"\\r\"!=q(t,o));++o);}else for(;o<r&&(\"\\n\"!=\"Q(t,o)&&\" \\r\"!=\"Q(t,o));++o);}return\"\" i._$rr=\"1e3*i._$yT/i._$D0|0,i},J.prototype.getDurationMSec=function(){return\" this._$e?-1:this._$rr},j.prototype.getloopdurationmsec=\"function(){return\" this._$rr},j.prototype.dump=\"function(){for(var\" t=\"0;t<this.motions.length;t++){var\" i=\"this.motions[t];console.log(\" _$wl[%s]\" [%d]. \",i._$4p,i._$i0.length);for(var e=\"0;e<i._$I0.length&&e<10;e++)console.log(\" %5.2f\" ,\",i._$i0[e]);console.log(\"\\n\")}},j.prototype.updateparamexe=\"function(t,i,e,r){for(var\" o=\"i-r._$z2,n=o*this._$D0/1e3,s=0|n,_=n-s,a=0;a<this.motions.length;a++){var\" h=\"this.motions[a],l=h._$I0.length,$=h._$4P;if(h._$RP==B._$hs){var\" u=\"h._$I0[s\">=l?l-1:s];t.setParamFloat($,u)}else if(B._$ws<=h._$rp&&h._$rp<=b._$ys);else{var p,f=\"t.getParamIndex($),c=t.getModelContext(),d=c.getParamMax(f),g=c.getParamMin(f),y=.4*(d-g),m=c.getParamFloat(f),T=h._$I0[s\">=l?l-1:s],P=h._$I0[s+1>=l?l-1:s+1];p=T<p&&p-t>y||T>P&&T-P>y?T:T+(P-T)*_;var S=m+(p-m)*e;t.setParamFloat($,S)}}s>=this._$yT&&(this._$E?(r._$z2=i,this.loopFadeIn&&(r._$bs=i)):r._$9L=!0),this._$eP=e},J.prototype._$r0=function(){return this._$E},J.prototype._$aL=function(t){this._$E=t},J.prototype._$S0=function(){return this._$D0},J.prototype._$U0=function(t){this._$D0=t},J.prototype.isLoopFadeIn=function(){return this.loopFadeIn},J.prototype.setLoopFadeIn=function(t){this.loopFadeIn=t},N.prototype.clear=function(){this.size=0},N.prototype.add=function(t){if(this._$P.length<=this.size){var i=\"new\" float32array(2*this.size);w._$jt(this._$p,0,i,0,this.size),this._$p=\"i}this._$P[this.size++]=t},N.prototype._$BL=function(){var\" t=\"new\" float32array(this.size);return w._$jt(this._$p,0,t,0,this.size),t},b._$fr=\"0,B._$hs=1,B._$ws=100,B._$Ns=101,B._$xs=102,B._$us=103,B._$qs=104,B._$Ys=105,Z.prototype=new\" i,z._$gt=\"new\" array,z.prototype._$zp=\"function(){this._$GS=new\" d,this._$gs._$zp()},z.prototype._$f0=\"function(t){I.prototype._$F0.call(this,t),this._$A=t._$6L(),this._$o=t._$6L(),this._$GS=t._$nP(),this._$Eo=t._$nP(),I.prototype.readV2_opacity.call(this,t)},Z.prototype.init=function(t){var\" k(this),e=\"(this._$o+1)*(this._$A+1);return\" null!=\"i._$Cr&&(i._$Cr=null),i._$Cr=new\" float32array(2*e),null!=\"i._$hr&&(i._$hr=null),this._$32()?i._$hr=new\" float32array(2*e):i._$hr=\"null,i},Z.prototype._$Nr=function(t,i){var\" e=\"i;if(this._$GS._$Ur(t)){var\" r=\"this._$VT(),o=Z._$gT;o[0]=!1,v._$Vr(t,this._$GS,o,r,this._$Eo,e._$Cr,0,2),i._$Ib(o[0]),this.interpolateOpacity(t,this._$GS,i,o)}},Z.prototype._$2b=function(t,i){var\" _$0p _$g :: %s\",r),e._$hs(!1);else{var o=\"t.getBaseData(e._$8r),n=t._$q2(e._$8r);if(null!=o&&n._$yo()){var\" s=\"n.getTotalScale();e.setTotalScale_notForClient(s);var\" a=\"n.getTotalOpacity();e.setTotalOpacity(a*e.getInterpolatedOpacity()),o._$nb(t,n,e._$Cr,e._$hr,this._$VT(),0,2),e._$hS(!0)}else\" e._$hs(!1)}}else e.settotalopacity(e.getinterpolatedopacity())},z.prototype._$nb=\"function(t,i,e,r,o,n,s){var\" _=\"i,a=null!=_._$hr?_._$hr:_._$Cr;Z.transformPoints_sdk2(e,r,o,n,s,a,this._$o,this._$A)},Z.transformPoints_sdk2=function(i,e,r,o,n,s,_,a){for(var\" h,l,$,u=\"r*n,p=0,f=0,c=0,d=0,g=0,y=0,m=!1,T=o;T<u;T+=n){var\" p,s,v,l;if(v=\"i[T],L=i[T+1],P=v*_,S=L*a,P<0||S<0||_<=P||a<=S){var\" m=\"_+1;if(!m){m=!0,p=.25*(s[2*(0+0*M)]+s[2*(_+0*M)]+s[2*(0+a*M)]+s[2*(_+a*M)]),f=.25*(s[2*(0+0*M)+1]+s[2*(_+0*M)+1]+s[2*(0+a*M)+1]+s[2*(_+a*M)+1]);var\" x=\"s[2*(0+0*M)],O=s[2*(0+0*M)+1],D=p-2*c,R=f-2*d,b=p-2*g,F=f-2*y,C=p-2*c-2*g,N=f-2*d-2*y,B=.5*(v-\" -2),u=\".5*(L-\" -2);b+u<=\"1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l>=1){var b=s[2*(0+a*M)],F=s[2*(0+a*M)+1],C=p-2*c+1*g,N=f-2*d+1*y,x=p+3*g,O=f+3*y,D=p-2*c+3*g,R=f-2*d+3*y,B=.5*(v- -2),U=.5*(L-1);B+U<=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var g=\"0|S;G==a&&(G=a-1);var\" b=\".5*(v-\" -2),u=\"S-G,Y=G/a,k=(G+1)/a,b=s[2*(0+G*M)],F=s[2*(0+G*M)+1],x=s[2*(0+(G+1)*M)],O=s[2*(0+(G+1)*M)+1],C=p-2*c+Y*g,N=f-2*d+Y*y,D=p-2*c+k*g,R=f-2*d+k*y;B+U<=1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(1<=\"v)if(L<=0){var\" d=\"s[2*(_+0*M)],R=s[2*(_+0*M)+1],x=p+3*c,O=f+3*d,C=p+1*c-2*g,N=f+1*d-2*y,b=p+3*c-2*g,F=f+3*d-2*y,B=.5*(v-1),U=.5*(L-\" -2);b+u<=\"1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l>=1){var C=s[2*(_+a*M)],N=s[2*(_+a*M)+1],b=p+3*c+1*g,F=f+3*d+1*y,D=p+1*c+3*g,R=f+1*d+3*y,x=p+3*c+3*g,O=f+3*d+3*y,B=.5*(v-1),U=.5*(L-1);B+U<=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var g=\"0|S;G==a&&(G=a-1);var\" b=\".5*(v-1),U=S-G,Y=G/a,k=(G+1)/a,C=s[2*(_+G*M)],N=s[2*(_+G*M)+1],D=s[2*(_+(G+1)*M)],R=s[2*(_+(G+1)*M)+1],b=p+3*c+Y*g,F=f+3*d+Y*y,x=p+3*c+k*g,O=f+3*d+k*y;B+U<=1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l<=\"0){var\" v=\"0|P;V==_&&(V=_-1);var\" -2),x=\"V/_,z=(V+1)/_,D=s[2*(V+0*M)],R=s[2*(V+0*M)+1],x=s[2*(V+1+0*M)],O=s[2*(V+1+0*M)+1],C=p+X*c-2*g,N=f+X*d-2*y,b=p+z*c-2*g,F=f+z*d-2*y;B+U<=1?(e[T]=C+(b-C)*B+(D-C)*U,e[T+1]=N+(F-N)*B+(R-N)*U):(e[T]=x+(D-x)*(1-B)+(b-x)*(1-U),e[T+1]=O+(R-O)*(1-B)+(F-O)*(1-U))}else\" if(l>=1){var V=0|P;V==_&&(V=_-1);var B=P-V,U=.5*(L-1),X=V/_,z=(V+1)/_,C=s[2*(V+a*M)],N=s[2*(V+a*M)+1],b=s[2*(V+1+a*M)],F=s[2*(V+1+a*M)+1],D=p+X*c+3*g,R=f+X*d+3*y,x=p+z*c+3*g,O=f+z*d+3*y;B+U<=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else t.err.printf(\"_$li calc : %.4f , %.4f\\t\\t\\t\\t\\t@@bdboxgrid\\n\",v,l);else e[t]=\"p+v*c+L*g,e[T+1]=f+v*d+L*y}else\" l=\"P-(0|P),$=S-(0|S),h=2*((0|P)+(0|S)*(_+1)),l+$<1?(e[T]=s[h]*(1-l-$)+s[h+2]*l+s[h+2*(_+1)]*$,e[T+1]=s[h+1]*(1-l-$)+s[h+3]*l+s[h+2*(_+1)+1]*$):(e[T]=s[h+2*(_+1)+2]*(l-1+$)+s[h+2*(_+1)]*(1-l)+s[h+2]*(1-$),e[T+1]=s[h+2*(_+1)+3]*(l-1+$)+s[h+2*(_+1)+1]*(1-l)+s[h+3]*(1-$))}},Z.prototype.transformPoints_sdk1=function(t,i,e,r,o,n,s){for(var\" _,a,h,l,$,u,p,f=\"i,c=this._$o,d=this._$A,g=o*s,y=null!=f._$hr?f._$hr:f._$Cr,m=n;m<g;m+=s)at._$ts?(_=e[m],a=e[m+1],_<0?_=0:_\">1&&(_=1),a<0?a=0:a>1&&(a=1),_*=c,a*=d,h=0|_,l=0|a,h>c-1&&(h=c-1),l>d-1&&(l=d-1),u=_-h,p=a-l,$=2*(h+l*(c+1))):(_=e[m]*c,a=e[m+1]*d,u=_-(0|_),p=a-(0|a),$=2*((0|_)+(0|a)*(c+1))),u+p<1?(r[m]=y[$]*(1-u-p)+y[$+2]*u+y[$+2*(c+1)]*p,r[m+1]=y[$+1]*(1-u-p)+y[$+3]*u+y[$+2*(c+1)+1]*p):(r[m]=y[$+2*(c+1)+2]*(u-1+p)+y[$+2*(c+1)]*(1-u)+y[$+2]*(1-p),r[m+1]=y[$+2*(c+1)+3]*(u-1+p)+y[$+2*(c+1)+1]*(1-u)+y[$+3]*(1-p))},z.prototype._$vt=function(){return(this._$o+1)*(this._$a+1)},z.prototype.gettype=function(){return i._$_b},k.prototype=\"new\" _t,tt._$42=\"0,tt.prototype._$zP=function(){this._$3S=new\" array,this._$as=\"new\" array},tt.prototype._$f0=\"function(t){this._$g0=t._$8L(),this.visible=t._$8L(),this._$NL=t._$nP(),this._$3S=t._$nP(),this._$aS=t._$nP()},tt.prototype.init=function(t){var\" i=\"new\" it(this);return i.setpartsopacity(this.isvisible()?1:0),i},tt.prototype._$6o=\"function(t){if(null==this._$3S)throw\" new error(\"_$3s _$6 _$wo@_$6o\");this._$3s.push(t)},tt.prototype._$3o=\"function(t){if(null==this._$aS)throw\" error(\"_$as _$wo@_$3o\");this._$as.push(t)},tt.prototype._$zo=\"function(t){this._$3S=t},tt.prototype._$xo=function(t){this._$aS=t},tt.prototype.isVisible=function(){return\" this.visible},tt.prototype._$ul=\"function(){return\" this._$g0},tt.prototype._$kp=\"function(t){this.visible=t},tt.prototype._$ET=function(t){this._$g0=t},tt.prototype.getBaseData=function(){return\" this._$3s},tt.prototype.getdrawdata=\"function(){return\" this._$as},tt.prototype._$p2=\"function(){return\" this._$nl},tt.prototype._$ob=\"function(t){this._$NL=t},tt.prototype.getPartsID=function(){return\" this._$nl},tt.prototype._$mp=\"function(t){this._$NL=t},it.prototype=new\" $,it.prototype.getpartsopacity=\"function(){return\" this._$vs},it.prototype.setpartsopacity=\"function(t){this._$VS=t},et._$L7=function(){u._$27(),yt._$27(),b._$27(),l._$27()},et.prototype.toString=function(){return\" this.id},rt.prototype._$f0=\"function(t){},ot.prototype._$1s=function(){return\" this._$4s},ot.prototype._$zp=\"function(){this._$4S=new\" array},ot.prototype._$f0=\"function(t){this._$4S=t._$nP()},ot.prototype._$Ks=function(t){this._$4S.push(t)},nt.tr=new\" gt,nt._$50=\"new\" gt,nt._$ti=\"new\" array(0,0),nt._$pi=\"new\" array(0,0),nt._$b=\"new\" array(0,0),nt.prototype._$lp=\"function(t,i,e,r){this.viewport=new\" array(t,i,e,r)},nt.prototype._$bl=\"function(){this.context.save();var\" t=\"this.viewport;null!=t&&(this.context.beginPath(),this.context._$Li(t[0],t[1],t[2],t[3]),this.context.clip())},nt.prototype._$ei=function(){this.context.restore()},nt.prototype.drawElements=function(t,i,e,r,o,n,s,a){try{o!=this._$Qo&&(this._$Qo=o,this.context.globalAlpha=o);for(var\" h=\"i.length,l=t.width,$=t.height,u=this.context,p=this._$xP,f=this._$uP,c=this._$6r,d=this._$3r,g=nt.tr,y=nt._$Ti,m=nt._$Pi,T=nt._$B,P=0;P<h;P+=3){u.save();var\" s=\"i[P],v=i[P+1],L=i[P+2],M=p+c*e[2*S],E=f+d*e[2*S+1],A=p+c*e[2*v],I=f+d*e[2*v+1],w=p+c*e[2*L],x=f+d*e[2*L+1];s&&(s._$PS(M,E,T),M=T[0],E=T[1],s._$PS(A,I,T),A=T[0],I=T[1],s._$PS(w,x,T),w=T[0],x=T[1]);var\" o=\"l*r[2*S],D=$-$*r[2*S+1],R=l*r[2*v],b=$-$*r[2*v+1],F=l*r[2*L],C=$-$*r[2*L+1],N=Math.atan2(b-D,R-O),B=Math.atan2(I-E,A-M),U=A-M,G=I-E,Y=Math.sqrt(U*U+G*G),k=R-O,V=b-D,X=Math.sqrt(k*k+V*V),z=Y/X;It._$ni(F,C,O,D,R-O,b-D,-(b-D),R-O,y),It._$ni(w,x,M,E,A-M,I-E,-(I-E),A-M,m);var\" it=\"a._$e0;if(it.gl_cacheImage=it.gl_cacheImage||{},!it.gl_cacheImage[P]){var\" et=\"nt.createCanvas(K-Q,tt-Z);at.DEBUG_DATA.LDGL_CANVAS_MB=at.DEBUG_DATA.LDGL_CANVAS_MB||0,at.DEBUG_DATA.LDGL_CANVAS_MB+=(K-Q)*(tt-Z)*4;var\" rt=\"et.getContext(\" 2d\");rt.translate(-q,-z),nt.clip(rt,g,n,y,o,d,r,b,f,c,m,e,a,i,w,x),rt.drawimage(t,0,0),it.gl_cacheimage[p]=\"{cacheCanvas:et,cacheContext:rt}}u.drawImage(it.gl_cacheImage[P].cacheCanvas,Q,Z)}else\"\" at.ignore_clip||nt.clip(u,g,n,y,o,d,r,b,f,c,m,e,a,i,w,x),at.use_adjust_translation&&(w=\"0,j=l,q=0,J=$),u.drawImage(t,W,q,j-W,J-q,W,q,j-W,J-q);u.restore()}}catch(t){_._$Rb(t)}},nt.clip=function(t,i,e,r,o,n,s,_,a,h,l,$,u,p,f,c){e\">.02?nt.expandClip(t,i,e,r,l,$,u,p,f,c):nt.clipWithTransform(t,null,o,n,s,_,a,h)},nt.expandClip=function(t,i,e,r,o,n,s,_,a,h){var l=s-o,$=_-n,u=a-o,p=h-n,f=l*p-$*u>0?e:-e,c=-$,d=l,g=a-s,y=h-_,m=-y,T=g,P=Math.sqrt(g*g+y*y),S=-p,v=u,L=Math.sqrt(u*u+p*p),M=o-f*c/r,E=n-f*d/r,A=s-f*c/r,I=_-f*d/r,w=s-f*m/P,x=_-f*T/P,O=a-f*m/P,D=h-f*T/P,R=o+f*S/L,b=n+f*v/L,F=a+f*S/L,C=h+f*v/L,N=nt._$50;return null!=i._$P2(N)&&(nt.clipWithTransform(t,N,M,E,A,I,w,x,O,D,F,C,R,b),!0)},nt.clipWithTransform=function(t,i,e,r,o,n,s,a){if(arguments.length<7)return void _._$li(\"err : @ldgl.clip()\");if(!(arguments[1]instanceof gt))return a[0] is _$6 ldtransform @ldgl.clip()\");var h=\"nt._$B,l=i,$=arguments;if(t.beginPath(),l){l._$PS($[2],$[3],h),t.moveTo(h[0],h[1]);for(var\" u=\"4;u<$.length;u+=2)l._$PS($[u],$[u+1],h),t.lineTo(h[0],h[1])}else{t.moveTo($[2],$[3]);for(var\" e=\"document.createElement(\" canvas\");return\" e.setattribute(\"width\",t),e.setattribute(\"height\",i),e||_._$li(\"err \"+e),e},nt.dumpvalues=\"function(){for(var\" t ,i=\"0;i<arguments.length;i++)t+=\" [\"+i+\"]=\" \" +arguments[i].tofixed(3)+\" , \";console.log(t)},st.prototype._$f0=\"function(t){this._$TT=t._$_T(),this._$LT=t._$_T(),this._$FS=t._$_T(),this._$wL=t._$nP()},st.prototype.getMinValue=function(){return\" this._$tt},st.prototype.getmaxvalue=\"function(){return\" this._$lt},st.prototype.getdefaultvalue=\"function(){return\" this._$fs},st.prototype.getparamid=\"function(){return\" this._$wl},_t.prototype._$yo=\"function(){return\" this._$at&&!this._$js},_t.prototype._$hs=\"function(t){this._$AT=t},_t.prototype._$GT=function(){return\" this._$e0},_t.prototype._$l2=\"function(t){this._$IP=t},_t.prototype.getPartsIndex=function(){return\" this._$ip},_t.prototype._$x2=\"function(){return\" this._$js},_t.prototype._$ib=\"function(t){this._$JS=t},_t.prototype.getTotalScale=function(){return\" this.totalscale},_t.prototype.settotalscale_notforclient=\"function(t){this.totalScale=t},_t.prototype.getInterpolatedOpacity=function(){return\" this._$7s},_t.prototype.setinterpolatedopacity=\"function(t){this._$7s=t},_t.prototype.getTotalOpacity=function(t){return\" this.totalopacity},_t.prototype.settotalopacity=\"function(t){this.totalOpacity=t},at._$2s=\" 2.1.00_1\",at._$kr=\"201001e3,at._$sP=!0,at._$so=!0,at._$cb=!1,at._$3T=!0,at._$Ts=!0,at._$fb=!0,at._$ts=!0,at.L2D_DEFORMER_EXTEND=!0,at._$Wb=!1;at._$yr=!1,at._$Zs=!1,at.L2D_NO_ERROR=0,at._$i7=1e3,at._$9s=1001,at._$es=1100,at._$r7=2e3,at._$07=2001,at._$b7=2002,at._$H7=4e3,at.L2D_COLOR_BLEND_MODE_MULT=0,at.L2D_COLOR_BLEND_MODE_ADD=1,at.L2D_COLOR_BLEND_MODE_INTERPOLATE=2,at._$6b=!0,at._$cT=0,at.clippingMaskBufferSize=256,at.glContext=new\"\" array,at.framebuffers=\"new\" array,at.ftexture=\"new\" array,at.ignore_clip=\"!1,at.IGNORE_EXPAND=!1,at.EXPAND_W=2,at.USE_ADJUST_TRANSLATION=!0,at.USE_CANVAS_TRANSFORM=!0,at.USE_CACHED_POLYGON_IMAGE=!1,at.DEBUG_DATA={},at.PROFILE_IOS_SPEED={PROFILE_NAME:\" ios\" speed\",use_adjust_translation:!0,use_cached_polygon_image:!0,expand_w:4},at.profile_ios_quality=\"{PROFILE_NAME:\" hiq\",use_adjust_translation:!0,use_cached_polygon_image:!1,expand_w:2},at.profile_ios_default=\"at.PROFILE_IOS_QUALITY,at.PROFILE_ANDROID={PROFILE_NAME:\" android\",use_adjust_translation:!1,use_cached_polygon_image:!1,expand_w:2},at.profile_desktop=\"{PROFILE_NAME:\"Desktop\",USE_ADJUST_TRANSLATION:!1,USE_CACHED_POLYGON_IMAGE:!1,EXPAND_W:2},at.initProfile=function(){Et.isIOS()?at.setupProfile(at.PROFILE_IOS_DEFAULT):Et.isAndroid()?at.setupProfile(at.PROFILE_ANDROID):at.setupProfile(at.PROFILE_DESKTOP)},at.setupProfile=function(t,i){if(\"number\"==typeof\"\" t)switch(t){case 9901:t=\"at.PROFILE_IOS_SPEED;break;case\" 9902:t=\"at.PROFILE_IOS_QUALITY;break;case\" 9903:t=\"at.PROFILE_IOS_DEFAULT;break;case\" 9904:t=\"at.PROFILE_ANDROID;break;case\" 9905:t=\"at.PROFILE_DESKTOP;break;default:alert(\" profile\" _$ui \"+t)}arguments.length<2&&(i=\"!0),i&&console.log(\" \"+t.profile_name);for(var in t)at[e]=\"t[e],i&&console.log(\" \" [\"+e+\"]=\"+t[e])},at.init=function(){if(at._$6b){console.log(\" live2d %s\",at._$2s),at._$6b=\"!1;!0,at.initProfile()}},at.getVersionStr=function(){return\" at._$2s},at.getversionno=\"function(){return\" at._$kr},at._$st=\"function(t){at._$cT=t},at.getError=function(){var\" at._$ct=\"0,t},at.dispose=function(){at.glContext=[],at.frameBuffers=[],at.fTexture=[]},at.setGL=function(t,i){var\" at.glcontext[t]},at.setclippingmaskbuffersize=\"function(t){at.clippingMaskBufferSize=t},at.getClippingMaskBufferSize=function(){return\" at.clippingmaskbuffersize},at.deletebuffer=\"function(t){at.getGL(t).deleteFramebuffer(at.frameBuffers[t].framebuffer),delete\" at.framebuffers[t],delete at.glcontext[t]},ht._$r2=\"function(t){return\" t<0?0:t>1?1:.5-.5*Math.cos(t*Lt.PI_F)},lt._$fr=-1,lt.prototype.toString=function(){return this._$ib},$t.prototype=new W,$t._$42=0,$t._$Os=30,$t._$ms=0,$t._$ns=1,$t._$_s=2,$t._$gT=new Array,$t.prototype._$_S=function(t){this._$LP=t},$t.prototype.getTextureNo=function(){return this._$LP},$t.prototype._$ZL=function(){return this._$Qi},$t.prototype._$H2=function(){return this._$JP},$t.prototype.getNumPoints=function(){return this._$d0},$t.prototype.getType=function(){return W._$wb},$t.prototype._$B2=function(t,i,e){var r=i,o=null!=r._$hr?r._$hr:r._$Cr;switch(U._$do){default:case U._$Ms:throw new Error(\"_$L _$ro \");case U._$Qs:for(var n=this._$d0-1;n>=0;--n)o[n*U._$No+4]=e}},$t.prototype._$zP=function(){this._$GS=new D,this._$GS._$zP()},$t.prototype._$F0=function(t){W.prototype._$F0.call(this,t),this._$LP=t._$6L(),this._$d0=t._$6L(),this._$Yo=t._$6L();var i=t._$nP();this._$BP=new Int16Array(3*this._$Yo);for(var e=3*this._$Yo-1;e>=0;--e)this._$BP[e]=i[e];if(this._$Eo=t._$nP(),this._$Qi=t._$nP(),t.getFormatVersion()>=G._$s7){if(this._$JP=t._$6L(),0!=this._$JP){if(0!=(1&this._$JP)){var r=t._$6L();null==this._$5P&&(this._$5P=new Object),this._$5P._$Hb=parseInt(r)}0!=(this._$JP&$t._$Os)?this._$6s=(this._$JP&$t._$Os)>>1:this._$6s=$t._$ms,0!=(32&this._$JP)&&(this.culling=!1)}}else this._$JP=0},$t.prototype.init=function(t){var i=new ut(this),e=this._$d0*U._$No,r=this._$32();switch(null!=i._$Cr&&(i._$Cr=null),i._$Cr=new Float32Array(e),null!=i._$hr&&(i._$hr=null),i._$hr=r?new Float32Array(e):null,U._$do){default:case U._$Ms:if(U._$Ls)for(var o=this._$d0-1;o>=0;--o){var n=o<<1;this._$qi[n+1]=1-this._$qi[n+1]}break;case u._$qs:for(var o=\"this._$d0-1;o\">=0;--o){var n=o<<1,s=o*u._$no,_=this._$qi[n],a=this._$qi[n+1];i._$cr[s]=_,i._$cr[s+1]=a,i._$cr[s+4]=0,r&&(i._$hr[s]=_,i._$hr[s+1]=a,i._$hr[s+4]=0)}}return i},$t.prototype._$nr=\"function(t,i){var\" e=\"i;if(this!=e._$GT()&&console.log(\" ###\" assert!! ### \"),this._$gs._$ur(t)&&(w.prototype._$nr.call(this,t,e),!e._$is[0])){var r=\"$t._$gT;r[0]=!1,v._$Vr(t,this._$GS,r,this._$d0,this._$Eo,e._$Cr,U._$i2,U._$No)}},$t.prototype._$2b=function(t,i){try{this!=i._$GT()&&console.log(\" \");var o=\"this.getTargetBaseDataID();if(r._$8r==W._$ur&&(r._$8r=t.getBaseDataIndex(o)),r._$8r<0)at._$so&&_._$li(\" _$l\" _$0p _$g :: %s\",o);else{var n=\"t.getBaseData(r._$8r),s=t._$q2(r._$8r);null==n||s._$x2()?r._$AT=!1:(n._$nb(t,s,r._$Cr,r._$hr,this._$d0,U._$i2,U._$No),r._$AT=!0),r.baseOpacity=s.getTotalOpacity()}}}catch(t){throw\" t}},$t.prototype.draw=\"function(t,i,e){if(this!=e._$GT()&&console.log(\" \"),!e._$is[0]){var _$yi( %d ) , _$d0( _$yo( \\n\",this._$lp,this._$d0,this._$yo),console.log(\" _$oi _$di=\"{\" \");for(var t=\"0;t<this._$BP.length;t++)console.log(\" %5d\" ,\",this._$bp[t]);console.log(\"\\n _$5i _$30\");for(var _$30[%d]=\",t);for(var i=this._$Eo[t],e=0;e<i.length;e++)console.log(\" %6.2f, \",i[e])}console.log(\"\\n\")},$t.prototype._$72=\"function(t){return\" null=\"=this._$5P?null:this._$5P[t]},$t.prototype.getIndexArray=function(){return\" this._$bp},ut.prototype=\"new\" mt,ut.prototype.gettransformedpoints=\"function(){return\" null!=\"this._$hr?this._$hr:this._$Cr},pt.prototype._$HT=function(t){this.x=t.x,this.y=t.y},pt.prototype._$HT=function(t,i){this.x=t,this.y=i},ft.prototype=new\" i,ft.loadmodel=\"function(t){var\" ft;return i._$62(e,t),e},ft.loadmodel=\"function(t,e){var\" ft(r);return i._$62(o,t),o},ft._$to=\"function(){return\" new ft},ft._$er=\"function(t){var\" i=\"new\" _$5(\".. _$_r _$t0 _$ri _$_p._$d\");if(0=\"=i.exists())throw\" _$ls(\"_$t0 _$_ _$6 _$ui \"+i._$pl());for(var _$5(e[o]);if(0=\"=n.exists())throw\" \"+n._$pl());r.settexture(o,_$nl._$_o(t,n._$3b()))}return r},ft.prototype.setgl=\"function(t){at.setGL(t)},ft.prototype.setTransform=function(t){this.drawParamWebGL.setTransform(t)},ft.prototype.update=function(){this._$5S.update(),this._$5S.preDraw(this.drawParamWebGL)},ft.prototype.draw=function(){this._$5S.draw(this.drawParamWebGL)},ft.prototype._$K2=function(){this.drawParamWebGL._$K2()},ft.prototype.setTexture=function(t,i){null==this.drawParamWebGL&&_._$li(\" _$yi\" for qt _$ki _$xs() is _$ui!!\"),this.drawparamwebgl.settexture(t,i)},ft.prototype.settexture=\"function(t,i){null==this.drawParamWebGL&&_._$li(\" _$ui!!\"),this.drawparamwebgl.settexture(t,i)},ft.prototype._$rs=\"function(){return\" this.drawparamwebgl._$rs()},ft.prototype._$ds=\"function(t){this.drawParamWebGL._$Ds(t)},ft.prototype.getDrawParam=function(){return\" this.drawparamwebgl},ft.prototype.setmatrix=\"function(t){this.drawParamWebGL.setMatrix(t)},ft.prototype.setPremultipliedAlpha=function(t){this.drawParamWebGL.setPremultipliedAlpha(t)},ft.prototype.isPremultipliedAlpha=function(){return\" this.drawparamwebgl.ispremultipliedalpha()},ft.prototype.setanisotropy=\"function(t){this.drawParamWebGL.setAnisotropy(t)},ft.prototype.getAnisotropy=function(){return\" this.drawparamwebgl.getanisotropy()},ct.prototype._$tb=\"function(){return\" this.motions},ct.prototype.startmotion=\"function(t,i){for(var\">startMotion() / start _$K _$3 (m%d)\\n\",r,e._$sr));if(null==t)return-1;e=new dt,e._$w0=t,this.motions.push(e);var n=e._$sr;return this._$eb&&_._$Ji(\"MotionQueueManager[size:%2d]->startMotion() / new _$w0 (m%d)\\n\",r,n),n},ct.prototype.updateParam=function(t){try{for(var i=!1,e=0;e<this.motions.length;e++){var r=\"this.motions[e];if(null!=r){var\" o=\"r._$w0;null!=o?(o.updateParam(t,r),i=!0,r.isFinished()&&(this._$eb&&_._$Ji(\" motionqueuemanager[size:%2d]-\">updateParam() / _$T0 _$w0 (m%d)\\n\",this.motions.length-1,r._$sr),this.motions.splice(e,1),e--)):(this.motions=this.motions.splice(e,1),e--)}else this.motions.splice(e,1),e--}return i}catch(t){return _._$li(t),!0}},ct.prototype.isFinished=function(t){if(arguments.length>=1){for(var i=0;i<this.motions.length;i++){var e=\"this.motions[i];if(null!=e&&(e._$sr==t&&!e.isFinished()))return!1}return!0}for(var\" i=\"0;i<this.motions.length;i++){var\" this.motions.splice(i,1),i--}else this.motions.splice(i,1),i--}return!0},ct.prototype.stopallmotions=\"function(){for(var\" t=\"0;t<this.motions.length;t++){var\" this.motions.splice(t,1),t--}},ct.prototype._$zr=\"function(t){this._$eb=t},ct.prototype._$e=function(){console.log(\" --\" _$r --\\n\");for(var :: %s\\n\",this.motions.length,e.tostring())}},dt._$gs=\"0,dt.prototype.isFinished=function(){return\" this._$9l},dt.prototype._$qs=\"function(t){var\" this._$sr},gt.prototype.setcontext=\"function(t){var\" ,i=\"0;i<9;i++)t+=this.m[i].toFixed(2)+\" \" ,\";return t+=\" }\" },gt.prototype.identity=\"function(){var\" array(0,0));var r=\"this.m;return\" e[0]=\"r[0]*t+r[3]*i+r[6],e[1]=r[1]*t+r[4]*i+r[7],e},gt.prototype._$P2=function(t){t||(t=new\" gt);var null;var u=\"1/$;return\" t.m[0]=\"u*(s*l-h*_),t.m[1]=u*(h*o-r*l),t.m[2]=u*(r*_-s*o),t.m[3]=u*(a*_-n*l),t.m[4]=u*(e*l-a*o),t.m[5]=u*(n*o-e*_),t.m[6]=u*(n*h-a*s),t.m[7]=u*(a*r-e*h),t.m[8]=u*(e*s-n*r),t},gt.prototype.transform=function(t,i,e){null==e&&(e=new\" et,yt._$et=\"null,yt._$tP=new\" object,yt._$2o=\"function(){return\" null=\"=yt._$eT&&(yt._$eT=yt.getID(\" dst_base\")),yt._$et},yt._$27=\"function(){yt._$tP.clear(),yt._$eT=null},yt.getID=function(t){var\"\" yt(t),yt._$tp[t]=\"i),i},yt.prototype._$3s=function(){return\" new yt},mt.prototype=\"new\" e,mt._$9r=\"function(t){return\" float32array(t)},mt._$vb=\"function(t){return\" int16array(t)},mt._$cr=\"function(t,i){return\" this._$gr},mt._$as=\"function(t){this._$Gr=t},mt.prototype.getGL=function(){return\" this.gl},mt.prototype.setgl=\"function(t){this.gl=t},mt.prototype.setTransform=function(t){this.transform=t},mt.prototype._$ZT=function(){var\" a=\"(n\">.9&&at.EXPAND_W,this.gl);if(null==this.gl)throw new Error(\"gl is null\");var h=1*this._$C0*n,l=1*this._$tT*n,$=1*this._$WL*n,u=this._$lT*n;if(null!=this.clipBufPre_clipContextMask){a.frontFace(a.CCW),a.useProgram(this.shaderProgram),this._$vS=Tt(a,this._$vS,r),this._$no=Pt(a,this._$no,e),a.enableVertexAttribArray(this.a_position_Loc),a.vertexAttribPointer(this.a_position_Loc,2,a.FLOAT,!1,0,0),this._$NT=Tt(a,this._$NT,o),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.textures[t]),a.uniform1i(this.s_texture0_Loc,1),a.enableVertexAttribArray(this.a_texCoord_Loc),a.vertexAttribPointer(this.a_texCoord_Loc,2,a.FLOAT,!1,0,0),a.uniformMatrix4fv(this.u_matrix_Loc,!1,this.getClipBufPre_clipContextMask().matrixForMask);var p=this.getClipBufPre_clipContextMask().layoutChannelNo,f=this.getChannelFlagAsColor(p);a.uniform4f(this.u_channelFlag,f.r,f.g,f.b,f.a);var c=this.getClipBufPre_clipContextMask().layoutBounds;a.uniform4f(this.u_baseColor_Loc,2*c.x-1,2*c.y-1,2*c._$EL()-1,2*c._$5T()-1),a.uniform1i(this.u_maskFlag_Loc,!0)}else if(null!=this.getClipBufPre_clipContextDraw()){a.useProgram(this.shaderProgramOff),this._$vS=Tt(a,this._$vS,r),this._$no=Pt(a,this._$no,e),a.enableVertexAttribArray(this.a_position_Loc_Off),a.vertexAttribPointer(this.a_position_Loc_Off,2,a.FLOAT,!1,0,0),this._$NT=Tt(a,this._$NT,o),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.textures[t]),a.uniform1i(this.s_texture0_Loc_Off,1),a.enableVertexAttribArray(this.a_texCoord_Loc_Off),a.vertexAttribPointer(this.a_texCoord_Loc_Off,2,a.FLOAT,!1,0,0),a.uniformMatrix4fv(this.u_clipMatrix_Loc_Off,!1,this.getClipBufPre_clipContextDraw().matrixForDraw),a.uniformMatrix4fv(this.u_matrix_Loc_Off,!1,this.matrix4x4),a.activeTexture(a.TEXTURE2),a.bindTexture(a.TEXTURE_2D,at.fTexture[this.glno]),a.uniform1i(this.s_texture1_Loc_Off,2);var p=this.getClipBufPre_clipContextDraw().layoutChannelNo,f=this.getChannelFlagAsColor(p);a.uniform4f(this.u_channelFlag_Loc_Off,f.r,f.g,f.b,f.a),a.uniform4f(this.u_baseColor_Loc_Off,h,l,$,u)}else a.useProgram(this.shaderProgram),this._$vS=Tt(a,this._$vS,r),this._$no=Pt(a,this._$no,e),a.enableVertexAttribArray(this.a_position_Loc),a.vertexAttribPointer(this.a_position_Loc,2,a.FLOAT,!1,0,0),this._$NT=Tt(a,this._$NT,o),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.textures[t]),a.uniform1i(this.s_texture0_Loc,1),a.enableVertexAttribArray(this.a_texCoord_Loc),a.vertexAttribPointer(this.a_texCoord_Loc,2,a.FLOAT,!1,0,0),a.uniformMatrix4fv(this.u_matrix_Loc,!1,this.matrix4x4),a.uniform4f(this.u_baseColor_Loc,h,l,$,u),a.uniform1i(this.u_maskFlag_Loc,!1);this.culling?this.gl.enable(a.CULL_FACE):this.gl.disable(a.CULL_FACE),this.gl.enable(a.BLEND);var d,g,y,m;if(null!=this.clipBufPre_clipContextMask)d=a.ONE,g=a.ONE_MINUS_SRC_ALPHA,y=a.ONE,m=a.ONE_MINUS_SRC_ALPHA;else switch(s){case $t._$ms:d=a.ONE,g=a.ONE_MINUS_SRC_ALPHA,y=a.ONE,m=a.ONE_MINUS_SRC_ALPHA;break;case $t._$ns:d=a.ONE,g=a.ONE,y=a.ZERO,m=a.ONE;break;case $t._$_s:d=a.DST_COLOR,g=a.ONE_MINUS_SRC_ALPHA,y=a.ZERO,m=a.ONE}a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(d,g,y,m),this.anisotropyExt&&a.texParameteri(a.TEXTURE_2D,this.anisotropyExt.TEXTURE_MAX_ANISOTROPY_EXT,this.maxAnisotropy);var T=e.length;a.drawElements(a.TRIANGLES,T,a.UNSIGNED_SHORT,0),a.bindTexture(a.TEXTURE_2D,null)}},mt.prototype._$Rs=function(){throw new Error(\"_$Rs\")},mt.prototype._$Ds=function(t){throw new Error(\"_$Ds\")},mt.prototype._$K2=function(){for(var t=0;t<this.textures.length;t++){0!=this.textures[t]&&(this.gl._$k2(1,this.textures,t),this.textures[t]=null)}},mt.prototype.settexture=function(t,i){this.textures[t]=i},mt.prototype.initshader=function(){var t=\"this.gl;this.loadShaders2(),this.a_position_Loc=t.getAttribLocation(this.shaderProgram,\" a_position\"),this.a_texcoord_loc=\"t.getAttribLocation(this.shaderProgram,\"a_texCoord\"),this.u_matrix_Loc=t.getUniformLocation(this.shaderProgram,\"u_mvpMatrix\"),this.s_texture0_Loc=t.getUniformLocation(this.shaderProgram,\"s_texture0\"),this.u_channelFlag=t.getUniformLocation(this.shaderProgram,\"u_channelFlag\"),this.u_baseColor_Loc=t.getUniformLocation(this.shaderProgram,\"u_baseColor\"),this.u_maskFlag_Loc=t.getUniformLocation(this.shaderProgram,\"u_maskFlag\"),this.a_position_Loc_Off=t.getAttribLocation(this.shaderProgramOff,\"a_position\"),this.a_texCoord_Loc_Off=t.getAttribLocation(this.shaderProgramOff,\"a_texCoord\"),this.u_matrix_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_mvpMatrix\"),this.u_clipMatrix_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_ClipMatrix\"),this.s_texture0_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"s_texture0\"),this.s_texture1_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"s_texture1\"),this.u_channelFlag_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_channelFlag\"),this.u_baseColor_Loc_Off=t.getUniformLocation(this.shaderProgramOff,\"u_baseColor\")},mt.prototype.disposeShader=function(){var\"\" e=\"this.gl,r=i,o=e.createShader(t);if(null==o)return\" _._$ji(\"_$l0 to create shader\"),null;if(e.shadersource(o,r),e.compileshader(o),!e.getshaderparameter(o,e.compile_status)){var n=\"e.getShaderInfoLog(o);return\" compile shader : \"+n),e.deleteshader(o),null}return o},mt.prototype.loadshaders2=\"function(){var\" vec4 a_position;attribute vec2 a_texcoord;varying v_texcoord;varying v_clippos;uniform mat4 u_mvpmatrix;void main(){ gl_position=\"u_mvpMatrix\" * a_position; v_clippos=\"u_mvpMatrix\" v_texcoord=\"a_texCoord;}\" ),!this.vertshader)return\" _._$ji(\"vertex _$li!\"),!1;if(this.vertshaderoff=\"this.compileShader(t.VERTEX_SHADER,\" attribute\" u_mvpmatrix;uniform u_clipmatrix;void ;}\"),!this.vertshaderoff)return _._$ji(\"offvertex _$li!\"),!1;if(this.fragshader=\"this.compileShader(t.FRAGMENT_SHADER,\" precision\" mediump float;varying sampler2d s_texture0;uniform u_channelflag;uniform u_basecolor;uniform bool u_maskflag;void smpcolor; if(u_maskflag){ float isinside=\"step(u_baseColor.x,\" v_clippos.x v_clippos.w) step(u_basecolor.y, v_clippos.y step(v_clippos.x v_clippos.w, u_basecolor.z) step(v_clippos.y u_basecolor.w); smpcolor=\"u_channelFlag\" texture2d(s_texture0 , v_texcoord).a isinside; }else{ v_texcoord) u_basecolor; } gl_fragcolor=\"smpColor;}\" ),!this.fragshader)return\" _._$ji(\"fragment _$li!\"),!1;if(this.fragshaderoff=\"this.compileShader(t.FRAGMENT_SHADER,\" ;varying s_texture1;uniform u_basecolor ;void col_formask=\"texture2D(s_texture0,\" clipmask=\"texture2D(s_texture1,\" v_clippos.xy u_channelflag; maskval=\"clipMask.r\" + clipmask.g clipmask.b clipmask.a; maskval; _._$ji(\"offfragment _$li!\"),!1;if(t.attachshader(this.shaderprogram,this.vertshader),t.attachshader(this.shaderprogram,this.fragshader),t.attachshader(this.shaderprogramoff,this.vertshaderoff),t.attachshader(this.shaderprogramoff,this.fragshaderoff),t.linkprogram(this.shaderprogram),t.linkprogram(this.shaderprogramoff),!t.getprogramparameter(this.shaderprogram,t.link_status)){var i=\"t.getProgramInfoLog(this.shaderProgram);return\" link program: \"+i),this.vertshader&&(t.deleteshader(this.vertshader),this.vertshader=\"0),this.fragShader&&(t.deleteShader(this.fragShader),this.fragShader=0),this.shaderProgram&&(t.deleteProgram(this.shaderProgram),this.shaderProgram=0),this.vertShaderOff&&(t.deleteShader(this.vertShaderOff),this.vertShaderOff=0),this.fragShaderOff&&(t.deleteShader(this.fragShaderOff),this.fragShaderOff=0),this.shaderProgramOff&&(t.deleteProgram(this.shaderProgramOff),this.shaderProgramOff=0),!1}return!0},mt.prototype.createFramebuffer=function(){var\" r=\"t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,i,i),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,r);var\" o=\"t.createTexture();return\" t.bindtexture(t.texture_2d,o),t.teximage2d(t.texture_2d,0,t.rgba,i,i,0,t.rgba,t.unsigned_byte,null),t.texparameteri(t.texture_2d,t.texture_min_filter,t.linear),t.texparameteri(t.texture_2d,t.texture_mag_filter,t.linear),t.texparameteri(t.texture_2d,t.texture_wrap_s,t.clamp_to_edge),t.texparameteri(t.texture_2d,t.texture_wrap_t,t.clamp_to_edge),t.framebuffertexture2d(t.framebuffer,t.color_attachment0,t.texture_2d,o,0),t.bindtexture(t.texture_2d,null),t.bindrenderbuffer(t.renderbuffer,null),t.bindframebuffer(t.framebuffer,null),at.ftexture[this.glno]=\"o,{framebuffer:e,renderbuffer:r,texture:at.fTexture[this.glno]}},St.prototype._$fP=function(){var\" t,i,e,r=\"this._$ST();if(0==(128&r))return\" 255&r;if(0=\"=(128&(t=this._$ST())))return(127&r)<<7|127&t;if(0==(128&(i=this._$ST())))return(127&r)<<14|(127&t)<<7|255&i;if(0==(128&(e=this._$ST())))return(127&r)<<21|(127&t)<<14|(127&i)<<7|255&e;throw\" new lt(\"_$l _$0p _\")},st.prototype.getformatversion=\"function(){return\" this._$s2},st.prototype._$gr=\"function(t){this._$S2=t},St.prototype._$3L=function(){return\" this._$fp()},st.prototype._$mp=\"function(){return\" this._$zt(),this._$f+=\"8,this._$T.getFloat64(this._$F-8)},St.prototype._$_T=function(){return\" this._$zt(),this._$t.getint8(this._$f++)},st.prototype._$9t=\"function(){return\" _$q read long\")},st.prototype._$po=\"function(){return\" this._$zt(),0!=\"this._$T.getInt8(this._$F++)};var\" xt=\"!0;St.prototype._$bT=function(){this._$zT();var\" arraybuffer(2*t);i=\"new\" uint16array(e);for(var string.fromcharcode.apply(null,i)}catch(t){xt=\"!1}try{var\" array;if(null=\"=i)for(var\" for(var string.fromcharcode.apply(null,o)}catch(t){console.log(\"read utf8 _$rt _$l0 !! \"+t)}},st.prototype._$cs=\"function(){this._$zT();for(var\" int32array(t),e=\"0;e<t;e++)i[e]=this._$T.getInt32(this._$F),this._$F+=4;return\" i},st.prototype._$tb=\"function(){this._$zT();for(var\" float32array(t),e=\"0;e<t;e++)i[e]=this._$T.getFloat32(this._$F),this._$F+=4;return\" i},st.prototype._$5b=\"function(){this._$zT();for(var\" float64array(t),e=\"0;e<t;e++)i[e]=this._$T.getFloat64(this._$F),this._$F+=8;return\" i},st.prototype._$np=\"function(){return\" this._$jb(-1)},st.prototype._$jb=\"function(t){if(this._$zT(),t<0&&(t=this._$3L()),t==G._$7P){var\" this._$ko[i];throw lt(\"_$sl _$4i @_$m0\")}var this._$ko.push(e),e},st.prototype._$4b=\"function(t){if(0==t)return\" null;if(50=\"=t){var\" e}if(51=\"=t){var\" e}if(134=\"=t){var\" e}if(60=\"=t){var\" e}if(t>=48){var r=G._$9o(t);return null!=r?(r._$F0(this),r):null}switch(t){case 1:return this._$bT();case 10:return new n(this._$6L(),!0);case 11:return new S(this._$mP(),this._$mP(),this._$mP(),this._$mP());case 12:return new S(this._$_T(),this._$_T(),this._$_T(),this._$_T());case 13:return new L(this._$mP(),this._$mP());case 14:return new L(this._$_T(),this._$_T());case 15:for(var o=this._$3L(),e=new Array(o),s=0;s<o;s++)e[s]=this._$np();return 0=\"=this._$hL?this._$v0=this._$ST():8==this._$hL&&(this._$v0=this._$ST(),this._$hL=0),1==(this._$v0\" e;case 17:var e=\"new\" f(this._$mp(),this._$mp(),this._$mp(),this._$mp(),this._$mp(),this._$mp());return 21:return new h(this._$6l(),this._$6l(),this._$6l(),this._$6l());case 22:return pt(this._$6l(),this._$6l());case 23:throw error(\"_$l _$ro \");case 16:case 25:return this._$cs();case 26:return this._$5b();case 27:return this._$tb();case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 18:case 19:case 20:case 24:case 28:throw lt(\"_$6 _$q : _$np() of 2-9 ,18,19,20,24,28 \"+t);default:throw no _$i \"+t)}},st.prototype._$8l=\"function(){return\">>7-this._$hL++&1)},St.prototype._$zT=function(){0!=this._$hL&&(this._$hL=0)},vt.prototype._$wP=function(t,i,e){for(var r=0;r<e;r++){for(var o=\"0;o<i;o++){var\" n=\"2*(o+r*i);console.log(\" (%\" 7.3f , % 7.3f) \",t[n],t[n+1])}console.log(\"\\n\")}console.log(\"\\n\")},lt._$2s=\"Math.PI/180,Lt._$bS=Math.PI/180,Lt._$wS=180/Math.PI,Lt._$NS=180/Math.PI,Lt.PI_F=Math.PI,Lt._$kT=[0,.012368,.024734,.037097,.049454,.061803,.074143,.086471,.098786,.111087,.12337,.135634,.147877,.160098,.172295,.184465,.196606,.208718,.220798,.232844,.244854,.256827,.268761,.280654,.292503,.304308,.316066,.327776,.339436,.351044,.362598,.374097,.385538,.396921,.408243,.419502,.430697,.441826,.452888,.463881,.474802,.485651,.496425,.507124,.517745,.528287,.538748,.549126,.559421,.56963,.579752,.589785,.599728,.609579,.619337,.629,.638567,.648036,.657406,.666676,.675843,.684908,.693867,.70272,.711466,.720103,.72863,.737045,.745348,.753536,.76161,.769566,.777405,.785125,.792725,.800204,.807561,.814793,.821901,.828884,.835739,.842467,.849066,.855535,.861873,.868079,.874153,.880093,.885898,.891567,.897101,.902497,.907754,.912873,.917853,.922692,.92739,.931946,.936359,.940629,.944755,.948737,.952574,.956265,.959809,.963207,.966457,.96956,.972514,.97532,.977976,.980482,.982839,.985045,.987101,.989006,.990759,.992361,.993811,.995109,.996254,.997248,.998088,.998776,.999312,.999694,.999924,1],Lt._$92=function(t,i){var\" e=\"Math.atan2(t[1],t[0]),r=Math.atan2(i[1],i[0]);return\" lt._$ts(e,r)},lt._$ts=\"function(t,i){for(var\">Math.PI;)e-=2*Math.PI;return e},Lt._$9=function(t){return Math.sin(t)},Lt.fcos=function(t){return Math.cos(t)},Mt.prototype._$u2=function(){return this._$IS[0]},Mt.prototype._$yo=function(){return this._$AT&&!this._$IS[0]},Mt.prototype._$GT=function(){return this._$e0},Et._$W2=0,Et.SYSTEM_INFO=null,Et.USER_AGENT=navigator.userAgent,Et.isIPhone=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isIPhone},Et.isIOS=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isIPhone||Et.SYSTEM_INFO._isIPad},Et.isAndroid=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isAndroid},Et.getOSVersion=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO.version},Et.getOS=function(){return Et.SYSTEM_INFO||Et.setup(),Et.SYSTEM_INFO._isIPhone||Et.SYSTEM_INFO._isIPad?\"iOS\":Et.SYSTEM_INFO._isAndroid?\"Android\":\"_$Q0 OS\"},Et.setup=function(){function t(t,i){for(var e=t.substring(i).split(/[ _,;\\.]/),r=0,o=0;o<=2&&!isnan(e[o]);o++){var n=\"parseInt(e[o]);if(n<0||n\">999){_._$li(\"err : \"+n+\" @UtHtml5.setup()\"),r=0;break}r+=n*Math.pow(1e3,2-o)}return r}var i,e=Et.USER_AGENT,r=Et.SYSTEM_INFO={userAgent:e};if((i=e.indexOf(\"iPhone OS \"))>=0)r.os=\"iPhone\",r._isIPhone=!0,r.version=t(e,i+\"iPhone OS \".length);else if((i=e.indexOf(\"iPad\"))>=0){if((i=e.indexOf(\"CPU OS\"))<0)return void _._$li(\" err : \"+e+\" @uthtml5.setup()\");r.os=\"iPad\" ,r._isipad=\"!0,r.version=t(e,i+\" cpu\" os \".length)}else(i=\"e.indexOf(\" android\"))\">=0?(r.os=\"Android\",r._isAndroid=!0,r.version=t(e,i+\"Android \".length)):(r.os=\"-\",r.version=-1)},window.UtSystem=w,window.UtDebug=_,window.LDTransform=gt,window.LDGL=nt,window.Live2D=at,window.Live2DModelWebGL=ft,window.Live2DModelJS=q,window.Live2DMotion=J,window.MotionQueueManager=ct,window.PhysicsHair=f,window.AMotion=s,window.PartsDataID=l,window.DrawDataID=b,window.BaseDataID=yt,window.ParamID=u,at.init();var At=!1}()}).call(i,e(7))},function(t,i){t.exports={import:function(){throw new Error(\"System.import cannot be used indirectly\")}}},function(t,i,e){\"use strict\";function r(t){return t&&t.__esModule?t:{default:t}}function o(){this.models=[],this.count=-1,this.reloadFlg=!1,Live2D.init(),n.Live2DFramework.setPlatformManager(new _.default)}Object.defineProperty(i,\"__esModule\",{value:!0}),i.default=o;var n=e(0),s=e(9),_=r(s),a=e(10),h=r(a),l=e(1),$=r(l);o.prototype.createModel=function(){var t=new h.default;return this.models.push(t),t},o.prototype.changeModel=function(t,i){if(this.reloadFlg){this.reloadFlg=!1;this.releaseModel(0,t),this.createModel(),this.models[0].load(t,i)}},o.prototype.getModel=function(t){return t>=this.models.length?null:this.models[t]},o.prototype.releaseModel=function(t,i){this.models.length<=t||(this.models[t].release(i),delete this.models[t],this.models.splice(t,1))},o.prototype.nummodels=\"function(){return\" this.models.length},o.prototype.setdrag=\"function(t,i){for(var\" e=\"0;e<this.models.length;e++)this.models[e].setDrag(t,i)},o.prototype.maxScaleEvent=function(){$.default.DEBUG_LOG&&console.log(\" max\" scale event.\");for(var t=\"0;t<this.models.length;t++)this.models[t].startRandomMotion($.default.MOTION_GROUP_PINCH_IN,$.default.PRIORITY_NORMAL)},o.prototype.minScaleEvent=function(){$.default.DEBUG_LOG&&console.log(\" min\" view x:\"+t+\" y:\"+i);for(var face.\"),this.models[e].setrandomexpression()):this.models[e].hittest($.default.hit_area_body,t,i)?($.default.debug_log&&console.log(\"tap body. models[\"+e+\"]\"),this.models[e].startrandommotion($.default.motion_group_tap_body,$.default.priority_normal)):this.models[e].hittestcustom(\"head\",t,i)?($.default.debug_log&&console.log(\"tap face.\"),this.models[e].startrandommotion($.default.motion_group_flick_head,$.default.priority_normal)):this.models[e].hittestcustom(\"body\",t,i)&&($.default.debug_log&&console.log(\"tap models[\"+e+\"]\"),this.models[e].startrandommotion($.default.motion_group_tap_body,$.default.priority_normal));return!0}},function(t,i,e){\"use strict\";function r(){}object.defineproperty(i,\"__esmodule\",{value:!0}),i.default=\"r;var\" o=\"e(2);r.prototype.loadBytes=function(t,i){var\" xmlhttprequest;e.open(\"get\",t,!0),e.responsetype=\"arraybuffer\" ,e.onload=\"function(){switch(e.status){case\" 200:i(e.response);break;default:console.error(\"failed to load (\"+e.status+\") : \"+t)}},e.send(null)},r.prototype.loadstring=\"function(t){this.loadBytes(t,function(t){return\" t})},r.prototype.loadlive2dmodel=\"function(t,i){var\" n=\"new\" image;n.crossorigin=\"Anonymous\" ,n.src=\"e;n.onload=function(){var\" console.error(\"failed generate gl texture name.\"),-1;0=\"=t.isPremultipliedAlpha()&&e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D),t.setTexture(i,s),s=null,\" function\"=\"=typeof\"\" r&&r()},n.onerror=\"function(){console.error(\" failed\" image \"+e)}},r.prototype.jsonparsefrombytes=\"function(t){var\" i,e=\"new\" uint8array(t,0,3);return i=\"239==e[0]&&187==e[1]&&191==e[2]?String.fromCharCode.apply(null,new\" uint8array(t,3)):string.fromcharcode.apply(null,new uint8array(t)),json.parse(i)},r.prototype.log=\"function(t){}},function(t,i,e){\" use\" r(t){return t&&t.__esmodule?t:{default:t}}function o(){n.l2dbasemodel.prototype.constructor.call(this),this.modelhomedir ,this.modelsetting=\"null,this.tmpMatrix=[]}Object.defineProperty(i,\" __esmodule\",{value:!0}),i.default=\"o;var\"\" n.l2dbasemodel,o.prototype.load=\"function(t,i,e){this.setUpdating(!0),this.setInitialized(!1),this.modelHomeDir=i.substring(0,i.lastIndexOf(\" \")+1),this.modelsetting=\"new\"\" _.default;var r=\"this;this.modelSetting.loadModelSetting(i,function(){var\" var>0){r.expressions={};for(var t=0;t</=t||(this.models[t].release(i),delete></0)return></=2&&!isnan(e[o]);o++){var></e;r++){for(var></o;s++)e[s]=this._$np();return></this.textures.length;t++){0!=this.textures[t]&&(this.gl._$k2(1,this.textures,t),this.textures[t]=null)}},mt.prototype.settexture=function(t,i){this.textures[t]=i},mt.prototype.initshader=function(){var></this.motions.length;i++){var></this.motions.length;e++){var></1,s=o*u._$no,_=this._$qi[n],a=this._$qi[n+1];i._$cr[s]=_,i._$cr[s+1]=a,i._$cr[s+4]=0,r&&(i._$hr[s]=_,i._$hr[s+1]=a,i._$hr[s+4]=0)}}return></1;this._$qi[n+1]=1-this._$qi[n+1]}break;case></7)return></1?(r[m]=y[$]*(1-u-p)+y[$+2]*u+y[$+2*(c+1)]*p,r[m+1]=y[$+1]*(1-u-p)+y[$+3]*u+y[$+2*(c+1)+1]*p):(r[m]=y[$+2*(c+1)+2]*(u-1+p)+y[$+2*(c+1)]*(1-u)+y[$+2]*(1-p),r[m+1]=y[$+2*(c+1)+3]*(u-1+p)+y[$+2*(c+1)+1]*(1-u)+y[$+3]*(1-p))},z.prototype._$vt=function(){return(this._$o+1)*(this._$a+1)},z.prototype.gettype=function(){return></0?a=0:a></=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else></=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var></=1?(e[t]=c+(b-c)*b+(d-c)*u,e[t+1]=n+(f-n)*b+(r-n)*u):(e[t]=x+(d-x)*(1-b)+(b-x)*(1-u),e[t+1]=o+(r-o)*(1-b)+(f-o)*(1-u))}else{var></=this.size){var></p&&p-t></=h._$rp&&h._$rp<=b._$ys);else{var></u&&u<121&&(i._$d0=u),o=e[0]}for(;o<r&&(\"\\n\"!=q(t,o)&&\"\\r\"!=q(t,o));++o);}else></r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\"=\"==n){a=o;break}var></o){console.log(\"_$n0></r&&(\"\\r\"!=(n=q(t,o))&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></e.length;o++){var></w._$52?w._$52=e:e></this._$sb.length;t++){0!=this._$sb[t]&&(this.gl._$sr(1,this._$sb,t),this._$sb[t]=0)}},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$sb[t]=i},x.prototype.settexture=function(t,i){this._$sb.length<t+1&&this._$ns(t),this._$u2[t]=i},x.prototype._$ns=function(t){var></e&&(this._$_l=wt.state_closing,this._$bb=e),i=1;break;case></e;++o){var></this._$rr[t]&&(i=this._$rr[t]),i></i;++e){var></v;++s){var></r;++s){var></i;e++){var></=this.size){var></=h._$rp&&h._$rp<=b._$ys);else{var></l&&l<121&&(i._$d0=l),o=e[0]}for(;o<r&&(\"\\n\"!=t[o]&&\"\\r\"!=t[o]);++o);}else></r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\"=\"==n){_=o;break}var></o){console.log(\"_$n0></r&&(\"\\r\"!=(n=255&t[o])&&\"\\n\"!=n);++o)if(\",\"!=n&&\"></r;++o){var></r;++a)t[a]=0;for(var></o;_++){var></r;o++)if(o.getchar(t,o)!=e.charat(o-i))return!1;return!0},o.getchar=function(t,i){return></t;);}catch(t){t._$rb()}},w.getusertimemsec=function(){return></16;i++)this.matrix4x4[i]=t[i]},e.prototype._$it=function(){return></0?r=0:r></0?e=0:e></0?i=0:i></0?t=0:t></m._$52?m._$52=e:e></=this.x&&this.y<=this.y&&this.x<=this.x+this.width&&this.y<=this.y+this.height},s.prototype.expand=function(t,i){this.x-=t,this.y-=i,this.width+=2*t,this.height+=2*i},v._$z2=function(t,i,e,r){var></.033&&(i=.033);var></r;++o)console.log(\"%5d\",i[o]),console.log(\"%s\\n\",e),console.log(\",\");console.log(\"\\n\")},_._$rb=function(t){console.log(\"dump></e&&(i._$9l=!0)}},s.prototype.updateparamexe=function(t,i,e,r){},_._$8s=0,_._$ft=new></0){i._$z2=e,i._$bs=e;var></e.channel_count;n++){var></h;l++){var></this.clipcontextlist.length;r++){var></t;i++)this.gl.deleteframebuffer(at.framebuffers[i].framebuffer);at.framebuffers=[],at.glcontext=[]},e.prototype.init=function(t,i,e){for(var></t.length;u++){var></0&&(console.log(\"no></0&&(l=0),s.setpartsopacity(h,l)}else{for(var></3&&(e=1),this._$5s.setparamfloat(t,this._$5s.getparamfloat(t)*(1-e)+i*e)},i.prototype.addtoparamfloat=function(t,i,e){\"number\"!=typeof></this.channel_colors.length;e++)this.dp_webgl.setchannelflagascolor(e,this.channel_colors[e])}}function></t.x&&(s=360-s);var></16;t++)this.currentmatrix[t]=t%5==0?1:0},r.push=function(){var></this.min?this.tr[0]></this.screenright&&(t=this.screenright-this.tr[0]*this.maxright-this.tr[12]),this.tr[5]*this.maxtop+(this.tr[13]+i)<this.screentop&&(i=this.screentop-this.tr[5]*this.maxtop-this.tr[13]),this.tr[5]*this.maxbottom+(this.tr[13]+i)></i.length;e++){var></0&&(r=0,o=1);for(var></n;s++){var></e&&(this.eyestate=g.state_closing,this.statestarttime=e),i=1;break;case></_;a++){var></=i[0]&&r<=t[1]&&r></=u&&u<=s&&_<=p&&p<=a},r.prototype.hittestsimplecustom=function(t,i,e,r){return></_&&(_=$),$></.001&&(t=0),this.alpha=t},r.prototype.getalpha=function(){return>"},{"_content":"<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"UTF-8\">\n<title>Live2D 看板娘 / Demo</title>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js\"></script>\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\">\n<style>\n#github svg {\n\ttransition: all 1s;\n\tfill: #222;\n\tcolor: #fff;\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tborder: 0;\n\twidth: 80px;\n\theight: 80px;\n}\n#github:hover svg {\n\twidth: 160px;\n\theight: 160px;\n}\n</style>\n</head>\n<body>\n<a id=\"github\" href=\"https://github.com/stevenjoezhang/live2d-widget\" target=\"_blank\" title=\"Visit the open-source code on GitHub!\">\n\t<svg viewBox=\"0 0 250 250\" aria-hidden=\"true\">\n\t\t<path d=\"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z\"></path>\n\t\t<path d=\"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2\" fill=\"currentColor\" class=\"octo-arm\"></path>\n\t\t<path d=\"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z\" fill=\"currentColor\" class=\"octo-body\"></path>\n\t</svg>\n</a>\n<script src=\"../autoload.js\"></script>\n</body>\n</html>\n","source":"live2d-widget/demo/demo1.html","raw":"<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"UTF-8\">\n<title>Live2D 看板娘 / Demo</title>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js\"></script>\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\">\n<style>\n#github svg {\n\ttransition: all 1s;\n\tfill: #222;\n\tcolor: #fff;\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tborder: 0;\n\twidth: 80px;\n\theight: 80px;\n}\n#github:hover svg {\n\twidth: 160px;\n\theight: 160px;\n}\n</style>\n</head>\n<body>\n<a id=\"github\" href=\"https://github.com/stevenjoezhang/live2d-widget\" target=\"_blank\" title=\"Visit the open-source code on GitHub!\">\n\t<svg viewBox=\"0 0 250 250\" aria-hidden=\"true\">\n\t\t<path d=\"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z\"></path>\n\t\t<path d=\"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2\" fill=\"currentColor\" class=\"octo-arm\"></path>\n\t\t<path d=\"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z\" fill=\"currentColor\" class=\"octo-body\"></path>\n\t</svg>\n</a>\n<script src=\"../autoload.js\"></script>\n</body>\n</html>\n","date":"2020-01-14T19:48:23.486Z","updated":"2020-01-14T19:48:23.486Z","path":"live2d-widget/demo/demo1.html","title":"","comments":1,"layout":"page","_id":"ck5obqncr006i2lwjf0dq38hw","content":"<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"UTF-8\">\n<title>Live2D 看板娘 / Demo</title>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js\"></script>\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\">\n<style>\n#github svg {\n\ttransition: all 1s;\n\tfill: #222;\n\tcolor: #fff;\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tborder: 0;\n\twidth: 80px;\n\theight: 80px;\n}\n#github:hover svg {\n\twidth: 160px;\n\theight: 160px;\n}\n</style>\n</head>\n<body>\n<a id=\"github\" href=\"https://github.com/stevenjoezhang/live2d-widget\" target=\"_blank\" title=\"Visit the open-source code on GitHub!\">\n\t<svg viewbox=\"0 0 250 250\" aria-hidden=\"true\">\n\t\t<path d=\"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z\"/>\n\t\t<path d=\"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2\" fill=\"currentColor\" class=\"octo-arm\"/>\n\t\t<path d=\"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z\" fill=\"currentColor\" class=\"octo-body\"/>\n\t</svg>\n</a>\n<script src=\"../autoload.js\"></script>\n</body>\n</html>\n","site":{"data":{}},"length":171,"excerpt":"","more":"<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"UTF-8\">\n<title>Live2D 看板娘 / Demo</title>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js\"></script>\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\">\n<style>\n#github svg {\n\ttransition: all 1s;\n\tfill: #222;\n\tcolor: #fff;\n\tposition: absolute;\n\ttop: 0;\n\tright: 0;\n\tborder: 0;\n\twidth: 80px;\n\theight: 80px;\n}\n#github:hover svg {\n\twidth: 160px;\n\theight: 160px;\n}\n</style>\n</head>\n<body>\n<a id=\"github\" href=\"https://github.com/stevenjoezhang/live2d-widget\" target=\"_blank\" title=\"Visit the open-source code on GitHub!\">\n\t<svg viewbox=\"0 0 250 250\" aria-hidden=\"true\">\n\t\t<path d=\"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z\"/>\n\t\t<path d=\"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2\" fill=\"currentColor\" class=\"octo-arm\"/>\n\t\t<path d=\"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z\" fill=\"currentColor\" class=\"octo-body\"/>\n\t</svg>\n</a>\n<script src=\"../autoload.js\"></script>\n</body>\n</html>\n"},{"_content":"<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\n<title>看板娘登陆平台</title>\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css\">\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\">\n<script src=\"https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js\"></script>\n<script src=\"../live2d.min.js\"></script>\n<style>\nhtml, body {\n\theight: 100%;\n}\nbody {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding-top: 40px;\n\tpadding-bottom: 40px;\n\tbackground-color: #f5f5f5;\n}\n.form-signin {\n\twidth: 100%;\n\tmax-width: 330px;\n\tpadding: 15px;\n\tmargin: 0 auto;\n}\n.form-signin .checkbox {\n\tfont-weight: 400;\n}\n.form-signin .form-control {\n\tposition: relative;\n\tbox-sizing: border-box;\n\theight: auto;\n\tpadding: 10px;\n\tfont-size: 16px;\n}\n.form-signin .form-control:focus {\n\tz-index: 2;\n}\n.form-signin input[type=text] {\n\tmargin-bottom: -1px;\n\tborder-bottom-right-radius: 0;\n\tborder-bottom-left-radius: 0;\n}\n.form-signin input[type=password] {\n\tmargin-bottom: 10px;\n\tborder-top-left-radius: 0;\n\tborder-top-right-radius: 0;\n}\n#stage {\n\tposition: relative;\n}\n#stage img {\n\twidth: 100%;\n\tmargin-bottom: 20px;\n\tborder-radius: 20px;\n}\n#stage a {\n\tposition: absolute;\n\twidth: 2em;\n\theight: 2em;\n\tborder-radius: 50%;\n}\n#inner {\n\tposition: relative;\n\tbackground-color: #999;\n\tclip-path: circle(120px at center);\n\t-webkit-clip-path: circle(120px at center);\n}\n#cover {\n\tposition: absolute;\n\tbackground-color: #CB3837;\n\twidth: 100%;\n\theight: 100%;\n\tbottom: 10%;\n\ttransition: all 1s;\n\tbox-shadow: 0 0 0 5px rgba(0, 0, 0, .1);\n}\n#text {\n\tposition: absolute;\n\tbottom: 30%;\n\tfont-size: 2em;\n\tleft: 50%;\n\ttransform: translateX(-50%);\n\topacity: 0.4;\n\tfont-weight: bold;\n}\n#detail {\n\tposition: absolute;\n\tbackground: rgba(255, 255, 255, .1);\n\twidth: 100%;\n\theight: 10px;\n\tbottom: 0;\n}\n#handle {\n\tposition: absolute;\n\tbackground: #ccc;\n\tbottom: -2px;\n\tbox-shadow: 0 1px 0 1px rgba(0, 0, 0, .1);\n\theight: 8px;\n\tleft: 50%;\n\tmargin-left: -15px;\n\twidth: 30px;\n\tcursor: pointer;\n}\n#info {\n\tleft: 40px;\n\tbottom: 20px;\n}\n#refresh {\n\tright: 40px;\n\tbottom: 20px;\n}\n#live2d {\n\tcursor: grab;\n}\n#live2d:active {\n\tcursor: grabbing;\n}\n</style>\n</head>\n<body class=\"text-center\">\n<form class=\"form-signin\" action=\"login.php\" method=\"post\">\n\t<div id=\"stage\">\n\t\t<div id=\"inner\">\n\t\t\t<div id=\"cover\">\n\t\t\t\t<div id=\"text\">\n\t\t\t\t\t<span style=\"color: cyan;\">MIMI</span><span style=\"color: white\">POWERED</span>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"detail\"></div>\n\t\t\t\t<div id=\"handle\"></div>\n\t\t\t</div>\n\t\t\t<canvas class=\"mb-4\" id=\"live2d\" width=\"300\" height=\"300\"></canvas>\n\t\t</div>\n\t\t<a id=\"info\" href=\"javascript:info()\"><i class=\"fa fa-lg fa-info\"></i></a>\n\t\t<a id=\"refresh\" href=\"javascript:refresh()\"><i class=\"fa fa-lg fa-refresh\"></i></a>\n\t</div>\n\t<h1 class=\"h3 mb-3 font-weight-normal\">看板娘登陆平台</h1>\n\t<label for=\"room\" class=\"sr-only\">用户名</label>\n\t<input type=\"text\" name=\"room\" class=\"form-control\" placeholder=\"用户名\" required autofocus>\n\t<label for=\"pass\" class=\"sr-only\">密码</label>\n\t<input type=\"password\" name=\"pass\" class=\"form-control\" placeholder=\"密码\" required>\n\t<div class=\"checkbox mb-3\">\n\t\t<label>\n\t\t\t<input type=\"checkbox\" value=\"remember-me\"> 记住我\n\t\t</label>\n\t</div>\n\t<button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\">登录</button>\n\t<p class=\"mt-5 mb-3 text-muted\">Copyleft &copy; Mimi 2019</p>\n</form>\n<script>\n$(function() {\n\t\"use strict\";\n\n\tif (!CSS.supports(\"clip-path\", \"circle(120px at center)\") && !CSS.supports(\"-webkit-clip-path\", \"circle(120px at center)\")) {\n\t\t$(\"#stage\").html('<img src=\"../assets/screenshot-1.png\">');\n\t\treturn;\n\t}\n\n\tvar apiURL = \"https://live2d.fghrsh.net/api\", state = 0,\n\t\tmodelId = localStorage.getItem(\"modelId\"),\n\t\tmodelTexturesId = localStorage.getItem(\"modelTexturesId\");\n\tif (modelId == null) {\n\t\tmodelId = 1;\n\t\tmodelTexturesId = 53;\n\t}\n\tloadModel(modelId, modelTexturesId);\n\n\tfunction loadModel(modelId, modelTexturesId) {\n\t\tlocalStorage.setItem(\"modelId\", modelId);\n\t\tif (modelTexturesId === undefined) modelTexturesId = 0;\n\t\tlocalStorage.setItem(\"modelTexturesId\", modelTexturesId);\n\t\tloadlive2d(\"live2d\", `${apiURL}/get/?id=${modelId}-${modelTexturesId}`, null);\n\t\tconsole.log(\"live2d\", `模型 ${modelId}-${modelTexturesId} 加载完成`);\n\t\tsetTimeout(function() {\n\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t\tstate = 2;\n\t\t}, 2000);\n\t}\n\n\tfunction loadRandModel() {\n\t\tvar modelId = localStorage.getItem(\"modelId\"),\n\t\t\tmodelTexturesId = localStorage.getItem(\"modelTexturesId\");\n\t\tfetch(`${apiPath}/rand_textures/?id=${modelId}-${modelTexturesId}`)\n\t\t\t.then(response => response.json())\n\t\t\t.then(result => {\n\t\t\t\tloadModel(modelId, result.textures.id);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tstate = 2;\n\t\t\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t\t\t\t$(\"#refresh\").attr(\"href\", \"javascript:refresh()\");\n\t\t\t\t}, 1000);\n\t\t\t});\n\t}\n\n\tfunction loadOtherModel() {\n\t\tvar modelId = localStorage.getItem(\"modelId\");\n\t\tfetch(`${apiPath}/switch/?id=${modelId}`)\n\t\t\t.then(response => response.json())\n\t\t\t.then(result => {\n\t\t\t\tloadModel(result.model.id);\n\t\t\t});\n\t}\n\n\twindow.info = function() {\n\t\tfetch(\"https://v1.hitokoto.cn\")\n\t\t\t.then(response => response.json())\n\t\t\t.then(result => {\n\t\t\t\talert(\"「\" + result.hitokoto + \"」——\" + result.from);\n\t\t\t});\n\t}\n\n\twindow.refresh = function() {\n\t\tstate = 0;\n\t\t$(\"#cover\").css(\"bottom\", \"10%\");\n\t\t$(\"#refresh\").attr(\"href\", \"javascript:void(0)\");\n\t\tsetTimeout(loadRandModel, 1000);\n\t}\n\n\t$(\"#handle\").click(function() {\n\t\tif (state == 1) {\n\t\t\tstate = 2;\n\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t}\n\t\telse if (state == 2) {\n\t\t\tstate = 1;\n\t\t\t$(\"#cover\").css(\"bottom\", \"20%\");\n\t\t}\n\t});\n\n\t$(\"input[type=password]\").focus(function() {\n\t\tif (state == 2) {\n\t\t\tstate = 1;\n\t\t\t$(\"#cover\").css(\"bottom\", \"20%\");\n\t\t}\n\t}).blur(function() {\n\t\tif (state == 1) {\n\t\t\tstate = 2;\n\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t}\n\t});\n});\n</script>\n</body>\n</html>\n","source":"live2d-widget/demo/demo2.html","raw":"<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\n<title>看板娘登陆平台</title>\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css\">\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\">\n<script src=\"https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js\"></script>\n<script src=\"../live2d.min.js\"></script>\n<style>\nhtml, body {\n\theight: 100%;\n}\nbody {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding-top: 40px;\n\tpadding-bottom: 40px;\n\tbackground-color: #f5f5f5;\n}\n.form-signin {\n\twidth: 100%;\n\tmax-width: 330px;\n\tpadding: 15px;\n\tmargin: 0 auto;\n}\n.form-signin .checkbox {\n\tfont-weight: 400;\n}\n.form-signin .form-control {\n\tposition: relative;\n\tbox-sizing: border-box;\n\theight: auto;\n\tpadding: 10px;\n\tfont-size: 16px;\n}\n.form-signin .form-control:focus {\n\tz-index: 2;\n}\n.form-signin input[type=text] {\n\tmargin-bottom: -1px;\n\tborder-bottom-right-radius: 0;\n\tborder-bottom-left-radius: 0;\n}\n.form-signin input[type=password] {\n\tmargin-bottom: 10px;\n\tborder-top-left-radius: 0;\n\tborder-top-right-radius: 0;\n}\n#stage {\n\tposition: relative;\n}\n#stage img {\n\twidth: 100%;\n\tmargin-bottom: 20px;\n\tborder-radius: 20px;\n}\n#stage a {\n\tposition: absolute;\n\twidth: 2em;\n\theight: 2em;\n\tborder-radius: 50%;\n}\n#inner {\n\tposition: relative;\n\tbackground-color: #999;\n\tclip-path: circle(120px at center);\n\t-webkit-clip-path: circle(120px at center);\n}\n#cover {\n\tposition: absolute;\n\tbackground-color: #CB3837;\n\twidth: 100%;\n\theight: 100%;\n\tbottom: 10%;\n\ttransition: all 1s;\n\tbox-shadow: 0 0 0 5px rgba(0, 0, 0, .1);\n}\n#text {\n\tposition: absolute;\n\tbottom: 30%;\n\tfont-size: 2em;\n\tleft: 50%;\n\ttransform: translateX(-50%);\n\topacity: 0.4;\n\tfont-weight: bold;\n}\n#detail {\n\tposition: absolute;\n\tbackground: rgba(255, 255, 255, .1);\n\twidth: 100%;\n\theight: 10px;\n\tbottom: 0;\n}\n#handle {\n\tposition: absolute;\n\tbackground: #ccc;\n\tbottom: -2px;\n\tbox-shadow: 0 1px 0 1px rgba(0, 0, 0, .1);\n\theight: 8px;\n\tleft: 50%;\n\tmargin-left: -15px;\n\twidth: 30px;\n\tcursor: pointer;\n}\n#info {\n\tleft: 40px;\n\tbottom: 20px;\n}\n#refresh {\n\tright: 40px;\n\tbottom: 20px;\n}\n#live2d {\n\tcursor: grab;\n}\n#live2d:active {\n\tcursor: grabbing;\n}\n</style>\n</head>\n<body class=\"text-center\">\n<form class=\"form-signin\" action=\"login.php\" method=\"post\">\n\t<div id=\"stage\">\n\t\t<div id=\"inner\">\n\t\t\t<div id=\"cover\">\n\t\t\t\t<div id=\"text\">\n\t\t\t\t\t<span style=\"color: cyan;\">MIMI</span><span style=\"color: white\">POWERED</span>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"detail\"></div>\n\t\t\t\t<div id=\"handle\"></div>\n\t\t\t</div>\n\t\t\t<canvas class=\"mb-4\" id=\"live2d\" width=\"300\" height=\"300\"></canvas>\n\t\t</div>\n\t\t<a id=\"info\" href=\"javascript:info()\"><i class=\"fa fa-lg fa-info\"></i></a>\n\t\t<a id=\"refresh\" href=\"javascript:refresh()\"><i class=\"fa fa-lg fa-refresh\"></i></a>\n\t</div>\n\t<h1 class=\"h3 mb-3 font-weight-normal\">看板娘登陆平台</h1>\n\t<label for=\"room\" class=\"sr-only\">用户名</label>\n\t<input type=\"text\" name=\"room\" class=\"form-control\" placeholder=\"用户名\" required autofocus>\n\t<label for=\"pass\" class=\"sr-only\">密码</label>\n\t<input type=\"password\" name=\"pass\" class=\"form-control\" placeholder=\"密码\" required>\n\t<div class=\"checkbox mb-3\">\n\t\t<label>\n\t\t\t<input type=\"checkbox\" value=\"remember-me\"> 记住我\n\t\t</label>\n\t</div>\n\t<button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\">登录</button>\n\t<p class=\"mt-5 mb-3 text-muted\">Copyleft &copy; Mimi 2019</p>\n</form>\n<script>\n$(function() {\n\t\"use strict\";\n\n\tif (!CSS.supports(\"clip-path\", \"circle(120px at center)\") && !CSS.supports(\"-webkit-clip-path\", \"circle(120px at center)\")) {\n\t\t$(\"#stage\").html('<img src=\"../assets/screenshot-1.png\">');\n\t\treturn;\n\t}\n\n\tvar apiURL = \"https://live2d.fghrsh.net/api\", state = 0,\n\t\tmodelId = localStorage.getItem(\"modelId\"),\n\t\tmodelTexturesId = localStorage.getItem(\"modelTexturesId\");\n\tif (modelId == null) {\n\t\tmodelId = 1;\n\t\tmodelTexturesId = 53;\n\t}\n\tloadModel(modelId, modelTexturesId);\n\n\tfunction loadModel(modelId, modelTexturesId) {\n\t\tlocalStorage.setItem(\"modelId\", modelId);\n\t\tif (modelTexturesId === undefined) modelTexturesId = 0;\n\t\tlocalStorage.setItem(\"modelTexturesId\", modelTexturesId);\n\t\tloadlive2d(\"live2d\", `${apiURL}/get/?id=${modelId}-${modelTexturesId}`, null);\n\t\tconsole.log(\"live2d\", `模型 ${modelId}-${modelTexturesId} 加载完成`);\n\t\tsetTimeout(function() {\n\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t\tstate = 2;\n\t\t}, 2000);\n\t}\n\n\tfunction loadRandModel() {\n\t\tvar modelId = localStorage.getItem(\"modelId\"),\n\t\t\tmodelTexturesId = localStorage.getItem(\"modelTexturesId\");\n\t\tfetch(`${apiPath}/rand_textures/?id=${modelId}-${modelTexturesId}`)\n\t\t\t.then(response => response.json())\n\t\t\t.then(result => {\n\t\t\t\tloadModel(modelId, result.textures.id);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tstate = 2;\n\t\t\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t\t\t\t$(\"#refresh\").attr(\"href\", \"javascript:refresh()\");\n\t\t\t\t}, 1000);\n\t\t\t});\n\t}\n\n\tfunction loadOtherModel() {\n\t\tvar modelId = localStorage.getItem(\"modelId\");\n\t\tfetch(`${apiPath}/switch/?id=${modelId}`)\n\t\t\t.then(response => response.json())\n\t\t\t.then(result => {\n\t\t\t\tloadModel(result.model.id);\n\t\t\t});\n\t}\n\n\twindow.info = function() {\n\t\tfetch(\"https://v1.hitokoto.cn\")\n\t\t\t.then(response => response.json())\n\t\t\t.then(result => {\n\t\t\t\talert(\"「\" + result.hitokoto + \"」——\" + result.from);\n\t\t\t});\n\t}\n\n\twindow.refresh = function() {\n\t\tstate = 0;\n\t\t$(\"#cover\").css(\"bottom\", \"10%\");\n\t\t$(\"#refresh\").attr(\"href\", \"javascript:void(0)\");\n\t\tsetTimeout(loadRandModel, 1000);\n\t}\n\n\t$(\"#handle\").click(function() {\n\t\tif (state == 1) {\n\t\t\tstate = 2;\n\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t}\n\t\telse if (state == 2) {\n\t\t\tstate = 1;\n\t\t\t$(\"#cover\").css(\"bottom\", \"20%\");\n\t\t}\n\t});\n\n\t$(\"input[type=password]\").focus(function() {\n\t\tif (state == 2) {\n\t\t\tstate = 1;\n\t\t\t$(\"#cover\").css(\"bottom\", \"20%\");\n\t\t}\n\t}).blur(function() {\n\t\tif (state == 1) {\n\t\t\tstate = 2;\n\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t}\n\t});\n});\n</script>\n</body>\n</html>\n","date":"2020-01-14T19:48:23.486Z","updated":"2020-01-14T19:48:23.486Z","path":"live2d-widget/demo/demo2.html","title":"","comments":1,"layout":"page","_id":"ck5obqncr006j2lwjasbwd5ll","content":"<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\n<title>看板娘登陆平台</title>\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css\">\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\">\n<script src=\"https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js\"></script>\n<script src=\"../live2d.min.js\"></script>\n<style>\nhtml, body {\n\theight: 100%;\n}\nbody {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding-top: 40px;\n\tpadding-bottom: 40px;\n\tbackground-color: #f5f5f5;\n}\n.form-signin {\n\twidth: 100%;\n\tmax-width: 330px;\n\tpadding: 15px;\n\tmargin: 0 auto;\n}\n.form-signin .checkbox {\n\tfont-weight: 400;\n}\n.form-signin .form-control {\n\tposition: relative;\n\tbox-sizing: border-box;\n\theight: auto;\n\tpadding: 10px;\n\tfont-size: 16px;\n}\n.form-signin .form-control:focus {\n\tz-index: 2;\n}\n.form-signin input[type=text] {\n\tmargin-bottom: -1px;\n\tborder-bottom-right-radius: 0;\n\tborder-bottom-left-radius: 0;\n}\n.form-signin input[type=password] {\n\tmargin-bottom: 10px;\n\tborder-top-left-radius: 0;\n\tborder-top-right-radius: 0;\n}\n#stage {\n\tposition: relative;\n}\n#stage img {\n\twidth: 100%;\n\tmargin-bottom: 20px;\n\tborder-radius: 20px;\n}\n#stage a {\n\tposition: absolute;\n\twidth: 2em;\n\theight: 2em;\n\tborder-radius: 50%;\n}\n#inner {\n\tposition: relative;\n\tbackground-color: #999;\n\tclip-path: circle(120px at center);\n\t-webkit-clip-path: circle(120px at center);\n}\n#cover {\n\tposition: absolute;\n\tbackground-color: #CB3837;\n\twidth: 100%;\n\theight: 100%;\n\tbottom: 10%;\n\ttransition: all 1s;\n\tbox-shadow: 0 0 0 5px rgba(0, 0, 0, .1);\n}\n#text {\n\tposition: absolute;\n\tbottom: 30%;\n\tfont-size: 2em;\n\tleft: 50%;\n\ttransform: translateX(-50%);\n\topacity: 0.4;\n\tfont-weight: bold;\n}\n#detail {\n\tposition: absolute;\n\tbackground: rgba(255, 255, 255, .1);\n\twidth: 100%;\n\theight: 10px;\n\tbottom: 0;\n}\n#handle {\n\tposition: absolute;\n\tbackground: #ccc;\n\tbottom: -2px;\n\tbox-shadow: 0 1px 0 1px rgba(0, 0, 0, .1);\n\theight: 8px;\n\tleft: 50%;\n\tmargin-left: -15px;\n\twidth: 30px;\n\tcursor: pointer;\n}\n#info {\n\tleft: 40px;\n\tbottom: 20px;\n}\n#refresh {\n\tright: 40px;\n\tbottom: 20px;\n}\n#live2d {\n\tcursor: grab;\n}\n#live2d:active {\n\tcursor: grabbing;\n}\n</style>\n</head>\n<body class=\"text-center\">\n<form class=\"form-signin\" action=\"login.php\" method=\"post\">\n\t<div id=\"stage\">\n\t\t<div id=\"inner\">\n\t\t\t<div id=\"cover\">\n\t\t\t\t<div id=\"text\">\n\t\t\t\t\t<span style=\"color: cyan;\">MIMI</span><span style=\"color: white\">POWERED</span>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"detail\"></div>\n\t\t\t\t<div id=\"handle\"></div>\n\t\t\t</div>\n\t\t\t<canvas class=\"mb-4\" id=\"live2d\" width=\"300\" height=\"300\"></canvas>\n\t\t</div>\n\t\t<a id=\"info\" href=\"javascript:info()\"><i class=\"fa fa-lg fa-info\"></i></a>\n\t\t<a id=\"refresh\" href=\"javascript:refresh()\"><i class=\"fa fa-lg fa-refresh\"></i></a>\n\t</div>\n\t<h1 class=\"h3 mb-3 font-weight-normal\">看板娘登陆平台</h1>\n\t<label for=\"room\" class=\"sr-only\">用户名</label>\n\t<input type=\"text\" name=\"room\" class=\"form-control\" placeholder=\"用户名\" required autofocus>\n\t<label for=\"pass\" class=\"sr-only\">密码</label>\n\t<input type=\"password\" name=\"pass\" class=\"form-control\" placeholder=\"密码\" required>\n\t<div class=\"checkbox mb-3\">\n\t\t<label>\n\t\t\t<input type=\"checkbox\" value=\"remember-me\"> 记住我\n\t\t</label>\n\t</div>\n\t<button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\">登录</button>\n\t<p class=\"mt-5 mb-3 text-muted\">Copyleft &copy; Mimi 2019</p>\n</form>\n<script>\n$(function() {\n\t\"use strict\";\n\n\tif (!CSS.supports(\"clip-path\", \"circle(120px at center)\") && !CSS.supports(\"-webkit-clip-path\", \"circle(120px at center)\")) {\n\t\t$(\"#stage\").html('<img src=\"../assets/screenshot-1.png\">');\n\t\treturn;\n\t}\n\n\tvar apiURL = \"https://live2d.fghrsh.net/api\", state = 0,\n\t\tmodelId = localStorage.getItem(\"modelId\"),\n\t\tmodelTexturesId = localStorage.getItem(\"modelTexturesId\");\n\tif (modelId == null) {\n\t\tmodelId = 1;\n\t\tmodelTexturesId = 53;\n\t}\n\tloadModel(modelId, modelTexturesId);\n\n\tfunction loadModel(modelId, modelTexturesId) {\n\t\tlocalStorage.setItem(\"modelId\", modelId);\n\t\tif (modelTexturesId === undefined) modelTexturesId = 0;\n\t\tlocalStorage.setItem(\"modelTexturesId\", modelTexturesId);\n\t\tloadlive2d(\"live2d\", `${apiURL}/get/?id=${modelId}-${modelTexturesId}`, null);\n\t\tconsole.log(\"live2d\", `模型 ${modelId}-${modelTexturesId} 加载完成`);\n\t\tsetTimeout(function() {\n\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t\tstate = 2;\n\t\t}, 2000);\n\t}\n\n\tfunction loadRandModel() {\n\t\tvar modelId = localStorage.getItem(\"modelId\"),\n\t\t\tmodelTexturesId = localStorage.getItem(\"modelTexturesId\");\n\t\tfetch(`${apiPath}/rand_textures/?id=${modelId}-${modelTexturesId}`)\n\t\t\t.then(response => response.json())\n\t\t\t.then(result => {\n\t\t\t\tloadModel(modelId, result.textures.id);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tstate = 2;\n\t\t\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t\t\t\t$(\"#refresh\").attr(\"href\", \"javascript:refresh()\");\n\t\t\t\t}, 1000);\n\t\t\t});\n\t}\n\n\tfunction loadOtherModel() {\n\t\tvar modelId = localStorage.getItem(\"modelId\");\n\t\tfetch(`${apiPath}/switch/?id=${modelId}`)\n\t\t\t.then(response => response.json())\n\t\t\t.then(result => {\n\t\t\t\tloadModel(result.model.id);\n\t\t\t});\n\t}\n\n\twindow.info = function() {\n\t\tfetch(\"https://v1.hitokoto.cn\")\n\t\t\t.then(response => response.json())\n\t\t\t.then(result => {\n\t\t\t\talert(\"「\" + result.hitokoto + \"」——\" + result.from);\n\t\t\t});\n\t}\n\n\twindow.refresh = function() {\n\t\tstate = 0;\n\t\t$(\"#cover\").css(\"bottom\", \"10%\");\n\t\t$(\"#refresh\").attr(\"href\", \"javascript:void(0)\");\n\t\tsetTimeout(loadRandModel, 1000);\n\t}\n\n\t$(\"#handle\").click(function() {\n\t\tif (state == 1) {\n\t\t\tstate = 2;\n\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t}\n\t\telse if (state == 2) {\n\t\t\tstate = 1;\n\t\t\t$(\"#cover\").css(\"bottom\", \"20%\");\n\t\t}\n\t});\n\n\t$(\"input[type=password]\").focus(function() {\n\t\tif (state == 2) {\n\t\t\tstate = 1;\n\t\t\t$(\"#cover\").css(\"bottom\", \"20%\");\n\t\t}\n\t}).blur(function() {\n\t\tif (state == 1) {\n\t\t\tstate = 2;\n\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t}\n\t});\n});\n</script>\n</body>\n</html>\n","site":{"data":{}},"length":3545,"excerpt":"","more":"<!DOCTYPE html>\n<html>\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\n<title>看板娘登陆平台</title>\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css\">\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\">\n<script src=\"https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js\"></script>\n<script src=\"../live2d.min.js\"></script>\n<style>\nhtml, body {\n\theight: 100%;\n}\nbody {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tpadding-top: 40px;\n\tpadding-bottom: 40px;\n\tbackground-color: #f5f5f5;\n}\n.form-signin {\n\twidth: 100%;\n\tmax-width: 330px;\n\tpadding: 15px;\n\tmargin: 0 auto;\n}\n.form-signin .checkbox {\n\tfont-weight: 400;\n}\n.form-signin .form-control {\n\tposition: relative;\n\tbox-sizing: border-box;\n\theight: auto;\n\tpadding: 10px;\n\tfont-size: 16px;\n}\n.form-signin .form-control:focus {\n\tz-index: 2;\n}\n.form-signin input[type=text] {\n\tmargin-bottom: -1px;\n\tborder-bottom-right-radius: 0;\n\tborder-bottom-left-radius: 0;\n}\n.form-signin input[type=password] {\n\tmargin-bottom: 10px;\n\tborder-top-left-radius: 0;\n\tborder-top-right-radius: 0;\n}\n#stage {\n\tposition: relative;\n}\n#stage img {\n\twidth: 100%;\n\tmargin-bottom: 20px;\n\tborder-radius: 20px;\n}\n#stage a {\n\tposition: absolute;\n\twidth: 2em;\n\theight: 2em;\n\tborder-radius: 50%;\n}\n#inner {\n\tposition: relative;\n\tbackground-color: #999;\n\tclip-path: circle(120px at center);\n\t-webkit-clip-path: circle(120px at center);\n}\n#cover {\n\tposition: absolute;\n\tbackground-color: #CB3837;\n\twidth: 100%;\n\theight: 100%;\n\tbottom: 10%;\n\ttransition: all 1s;\n\tbox-shadow: 0 0 0 5px rgba(0, 0, 0, .1);\n}\n#text {\n\tposition: absolute;\n\tbottom: 30%;\n\tfont-size: 2em;\n\tleft: 50%;\n\ttransform: translateX(-50%);\n\topacity: 0.4;\n\tfont-weight: bold;\n}\n#detail {\n\tposition: absolute;\n\tbackground: rgba(255, 255, 255, .1);\n\twidth: 100%;\n\theight: 10px;\n\tbottom: 0;\n}\n#handle {\n\tposition: absolute;\n\tbackground: #ccc;\n\tbottom: -2px;\n\tbox-shadow: 0 1px 0 1px rgba(0, 0, 0, .1);\n\theight: 8px;\n\tleft: 50%;\n\tmargin-left: -15px;\n\twidth: 30px;\n\tcursor: pointer;\n}\n#info {\n\tleft: 40px;\n\tbottom: 20px;\n}\n#refresh {\n\tright: 40px;\n\tbottom: 20px;\n}\n#live2d {\n\tcursor: grab;\n}\n#live2d:active {\n\tcursor: grabbing;\n}\n</style>\n</head>\n<body class=\"text-center\">\n<form class=\"form-signin\" action=\"login.php\" method=\"post\">\n\t<div id=\"stage\">\n\t\t<div id=\"inner\">\n\t\t\t<div id=\"cover\">\n\t\t\t\t<div id=\"text\">\n\t\t\t\t\t<span style=\"color: cyan;\">MIMI</span><span style=\"color: white\">POWERED</span>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"detail\"></div>\n\t\t\t\t<div id=\"handle\"></div>\n\t\t\t</div>\n\t\t\t<canvas class=\"mb-4\" id=\"live2d\" width=\"300\" height=\"300\"></canvas>\n\t\t</div>\n\t\t<a id=\"info\" href=\"javascript:info()\"><i class=\"fa fa-lg fa-info\"></i></a>\n\t\t<a id=\"refresh\" href=\"javascript:refresh()\"><i class=\"fa fa-lg fa-refresh\"></i></a>\n\t</div>\n\t<h1 class=\"h3 mb-3 font-weight-normal\">看板娘登陆平台</h1>\n\t<label for=\"room\" class=\"sr-only\">用户名</label>\n\t<input type=\"text\" name=\"room\" class=\"form-control\" placeholder=\"用户名\" required autofocus>\n\t<label for=\"pass\" class=\"sr-only\">密码</label>\n\t<input type=\"password\" name=\"pass\" class=\"form-control\" placeholder=\"密码\" required>\n\t<div class=\"checkbox mb-3\">\n\t\t<label>\n\t\t\t<input type=\"checkbox\" value=\"remember-me\"> 记住我\n\t\t</label>\n\t</div>\n\t<button class=\"btn btn-lg btn-primary btn-block\" type=\"submit\">登录</button>\n\t<p class=\"mt-5 mb-3 text-muted\">Copyleft &copy; Mimi 2019</p>\n</form>\n<script>\n$(function() {\n\t\"use strict\";\n\n\tif (!CSS.supports(\"clip-path\", \"circle(120px at center)\") && !CSS.supports(\"-webkit-clip-path\", \"circle(120px at center)\")) {\n\t\t$(\"#stage\").html('<img src=\"../assets/screenshot-1.png\">');\n\t\treturn;\n\t}\n\n\tvar apiURL = \"https://live2d.fghrsh.net/api\", state = 0,\n\t\tmodelId = localStorage.getItem(\"modelId\"),\n\t\tmodelTexturesId = localStorage.getItem(\"modelTexturesId\");\n\tif (modelId == null) {\n\t\tmodelId = 1;\n\t\tmodelTexturesId = 53;\n\t}\n\tloadModel(modelId, modelTexturesId);\n\n\tfunction loadModel(modelId, modelTexturesId) {\n\t\tlocalStorage.setItem(\"modelId\", modelId);\n\t\tif (modelTexturesId === undefined) modelTexturesId = 0;\n\t\tlocalStorage.setItem(\"modelTexturesId\", modelTexturesId);\n\t\tloadlive2d(\"live2d\", `${apiURL}/get/?id=${modelId}-${modelTexturesId}`, null);\n\t\tconsole.log(\"live2d\", `模型 ${modelId}-${modelTexturesId} 加载完成`);\n\t\tsetTimeout(function() {\n\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t\tstate = 2;\n\t\t}, 2000);\n\t}\n\n\tfunction loadRandModel() {\n\t\tvar modelId = localStorage.getItem(\"modelId\"),\n\t\t\tmodelTexturesId = localStorage.getItem(\"modelTexturesId\");\n\t\tfetch(`${apiPath}/rand_textures/?id=${modelId}-${modelTexturesId}`)\n\t\t\t.then(response => response.json())\n\t\t\t.then(result => {\n\t\t\t\tloadModel(modelId, result.textures.id);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tstate = 2;\n\t\t\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t\t\t\t$(\"#refresh\").attr(\"href\", \"javascript:refresh()\");\n\t\t\t\t}, 1000);\n\t\t\t});\n\t}\n\n\tfunction loadOtherModel() {\n\t\tvar modelId = localStorage.getItem(\"modelId\");\n\t\tfetch(`${apiPath}/switch/?id=${modelId}`)\n\t\t\t.then(response => response.json())\n\t\t\t.then(result => {\n\t\t\t\tloadModel(result.model.id);\n\t\t\t});\n\t}\n\n\twindow.info = function() {\n\t\tfetch(\"https://v1.hitokoto.cn\")\n\t\t\t.then(response => response.json())\n\t\t\t.then(result => {\n\t\t\t\talert(\"「\" + result.hitokoto + \"」——\" + result.from);\n\t\t\t});\n\t}\n\n\twindow.refresh = function() {\n\t\tstate = 0;\n\t\t$(\"#cover\").css(\"bottom\", \"10%\");\n\t\t$(\"#refresh\").attr(\"href\", \"javascript:void(0)\");\n\t\tsetTimeout(loadRandModel, 1000);\n\t}\n\n\t$(\"#handle\").click(function() {\n\t\tif (state == 1) {\n\t\t\tstate = 2;\n\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t}\n\t\telse if (state == 2) {\n\t\t\tstate = 1;\n\t\t\t$(\"#cover\").css(\"bottom\", \"20%\");\n\t\t}\n\t});\n\n\t$(\"input[type=password]\").focus(function() {\n\t\tif (state == 2) {\n\t\t\tstate = 1;\n\t\t\t$(\"#cover\").css(\"bottom\", \"20%\");\n\t\t}\n\t}).blur(function() {\n\t\tif (state == 1) {\n\t\t\tstate = 2;\n\t\t\t$(\"#cover\").css(\"bottom\", \"80%\");\n\t\t}\n\t});\n});\n</script>\n</body>\n</html>\n"}],"Post":[{"title":"2019银川ACM区域赛总结","date":"2019-10-21T15:09:13.000Z","copyright":true,"image":"http://www.wqh4u.cn/2019/10/21/2019银川ACM区域赛总结/acm.jpg","_content":"\n> <span class = 'introduction'>世上没有绝望的处境，只有对处境绝望的人。</span><br/>\n第四场现场赛，也应该是最后一次了<del>（除非EC Final能再去）</del>。也许也是离银牌最近的一次，但是能力有限，又抱了个铜牌归来。<br />藉此作为一个纪念吧。\n\n<!--more-->\n\n<hr/>\n\n## 赛前\n\n自打 2019年全国邀请赛 以及 2019年陕西省赛 以来，收获到了两块铜牌。在打了第一次银川网络赛 <del> 北师大没有开挂名场面 </del> 之后，自己觉得如果可以进现场赛，不知道哪里来的自信，这次一定可以拿到银牌（我校的第一枚银牌？）。\n\n因为 <a href=\"https://hangcc.cn\">Hang_c</a> 拿到了 Offer，当时不知道还有没有时间去打这一场现场赛。当时是暑假，还记得自己边练车边劝 Hang_c 一定要来打现场赛。\n\n紧接着又知道 yyc 要考研，不准备继续打 ACM 了，当时感觉这次就可能真的要没了。\n\n随后找到了 wjz，又把 Hang_c 拉了回来，这一个三人小队也算是凑齐了。\n\n去银川之前，因为个人走了 Java 开发方向，也许是对算法方面有了点懈怠吧，这个稍后会提。\n\n<div class=\"note info\">谁又能知道这一次 Java 还帮了我大忙呢？</div>\n\n经过了一番波折，我们终于来到了银川大武口，走的 jio 疼也算是终于到了住宿的地方，匆匆忙忙放下书包后，去吃了碗羊杂碎汤（感觉还是有点膻味，但是总体来说超级棒！）\n\n就此，开始了下午的热身赛...\n\n<hr />\n\n## 热身赛\n\n热身赛 A 题憨憨题目，因为当时我是机位也刚好配好了 **IDEA**，顺手打印就过了。\n\nC 题 AC 自动机，自己头脑一热以为很简单的用 replace 能莽过去，但是没过多久就发现了大小写的匹配问题，热身赛也没有拿板子。Hang_c 就接下来了这道题开始研究，我和 wjz 开始推 B 题。\n\nB 题是一个阅读理解，wjz 告诉我 Fighter 可以无限次数地把 Speeder 打晕，然而每次打晕都可以拿到一分，我们就掉进了奇奇怪怪的坑里面无法自拔。到了最后几分钟我愈发觉得不对劲，如果可以无限次数的去攻击得分，那么这道题无论怎么样 Sppder 都会输啊。\n\n<div class=\"note info\">\n除非 Speeder 的速度大于 1200，在一瞬间把操场跑完2333...\n</div>\n\n最后和对面的队伍开始聊了起来，他们是浙江财经大学的，正式赛时表现超级好，队内还有一个小姐姐也很强，这个稍后再说。\n\n对面告诉我们 Fighter 在一回合内只能将 Speeder 打晕一次，我当时就黑人问号脸看着 wjz，最后在题目中也发现了这个 Hint，哇心态崩了，当时就告诉 wjz 第二天正式赛不敢这么拉闸。\n\n<img src=\"./20191019_145938.jpg\" alt=\"热身赛\" title=\"热身赛赛前\" />\n\n## 赛前最后一晚\n\nwjz 和 jj 来找我说晚上去网吧上网被我拒绝了，可能也是因为无限火力还没有出吧2333。Hang_c 睡得比较早，我在一旁看了看 DP 问题，最后想着明天不行就用 Java 去解题，因为队伍内从来没有 Java 解题选手，也就没有任何和 Java 有关的板子一类的资料。\n\n我告诉 Hang_c 说我去找 lx 看看有没有稿纸，我要把一些标准库和黑魔法抄到纸上带过去。结果 lx 并没有，又去找了 wzh 结果也 GG，甚至跑到了酒店前台去借，结果前台没人233\n\n回房间后突然想起来可以用今天热身赛题目的背面来写，事不宜迟就开始干，也就看了看 Collections 与 Map 接口下面的常用标准库，最后又记了一下 Math 中的一些黑魔法，抄了两页纸后忐忑不安的就去睡觉了。\n\n<hr />\n\n## 正式赛\n\n一大早被 Hang_c 叫起来，匆匆忙忙洗漱完就直接去了赛场，路上也遇到了对面浙江财经大学的 Team，打了招呼后就去到了自己的位置上。\n\n5...4...3...2...1...比赛开始\n\n拆开题目后一眼看到了 M 切蛋糕，当时脑袋一热觉得是卡塔兰数，简单地和 Hang_c 交谈了一下得到了肯定，就头铁的去分析 M（记住这个题）。\n\nHang_c 刷了下榜，发现 N 是签到题，我一下就蒙了，N 就在 M 的旁边我却连看一眼都没有。一看 N 又是像热身那样的憨憨题目，随便一写就交了。然后 Hang_c 和 wjz 在看 B 题，我在一旁翻译其他题。\n\n没过多久我发现了 I 题，这时候 Hang_c 和 wjz 对 B 题有了初步的商量，我把机位给了 Hang_c 去开 B，我在一边继续分析 I。\n\nHang_c 的第一发 B WA了，我很着急催他要上机位，然后他们两个继续分析 B，我这边单开一下 I。\n\n想着 I 中会出现 62 的 120 次方，莽开 double 也是炸，脑子一热用了 BigInteger，对超出 F 的 17 进制以上的数字手动转成对应序号，也就是换了一种方法去莽题目吧。\n\n果不其然，我的 I 也 WA 了。\n\n<img src=\"./20191020_141340.jpg\" alt=\"正式赛结束\" title=\"正式赛结束时拍的\" />\n\n我把 I 打印出来，接着换 Hang_c 上机位去攻 B，Hang_c 和 wjz 想的有点复杂了，所以在 B 上也用了很多时间，然后撒花AC。\n\n这时候压力也就转移到了我身上，改动了一次代码后，真棒，果不其然 WA 了。Hang_c 来问我代码思路，我简单地说了一下后，Hang_c 我怎么处理转换之后的超出 16 进制的数字，瞬间我就懂了。我自测样例通过的原因是我没有测 Hang_c 说的那种样例。\n\n这时候刷了下榜，发现 G 题就是铜牌线，Hang_c 和 wjz 开始去首先开 G，我自己一个人在机位处理我的 I，当时也上头了，没有给他们说我要交，自己擅自直接就把 I 交了...\n\n抱着绝对会 WA 的心态按着 F5，没有想到的是就这么的 AC 了？？？\n\nHang_c 和 wjz 也是一脸：？？？你干了什么\n\n<div class=\"note info\">\nBigInteger 真的香啊，我这时候看 lx 他们队没有过 I，就想着一定要把 I 打印出来拿给 lx 他们看233.\n</div>\n\nG 题是线段树，但是我对 **因子** 这种问题一下就头麻了，和 wjz 分析了下思路后，Hang_c 上了机位，然后剩下的三个小时也就用到 G 题上了...\n\n这时候对面也在开 G 题，是一个小姐姐在机位上，我们同时都反应上来 G 题是线段树，然而我们只有 Hang_c 对线段树熟一点，Hang_c 也因为找工作的原因时间紧张，所以我们只好拿着板子去写那个线段树了...\n\n时间一分一秒地过去，只看着周围深蓝色（G题）气球越来越多，感觉自己要凉到这里了...\n\n对面小姐姐交了第一发 RE，然后没多久改正后就 AC 了...\n\n<div class=\"note info\">\n浙江财经大学的那位小姐姐，有看到我的这篇博客欢迎联系啊！<br />比赛完了后<del>Hang_c</del>想着找你要联系方式来着，你真的超级强啊...\n</div>\n\n封榜了，我们的 G 题还没有过，连着交了四发 RE，我提醒了下 Hang_c 看看是不是有下标越界等等问题（也不知道有没有帮上忙），Hang_c 改了改后交了一发结果 WA 了，我感觉这是最好不过的事情了，全队人都来了志气一定要把 G 过了！\n\n剩了 20 分钟，G 题过了，硬生生压住了要喊出来的想法，想着用这最后 20 分钟试一试 F。\n\n**世上没有绝望的处境，只有对处境绝望的人。**\n\nF 题自己眼睛瞎了没有看见那个各自上下取整，以为那是一个中括号，最后发现不对只剩了 5 分钟了。用尽最快的打字速度敲完代码，还剩 15s，简单地测了一下样例后直接提交。\n\n但是 WA 了... 五题就是银牌线了...\n\n<img src=\"./20191020_141204.jpg\" alt=\"四个气球\" title=\"B: 青色；G: 蓝色; I: 粉色; N: 橙色\" />\n\n<hr />\n\n## 赛后\n\n这一次的铜牌再也没有当时打全国邀请赛时的铜牌拿的那么开心那么激动了。更多的只是不甘心，这也许就是我们离银牌最近的一次机会了，如果我的 I 没有粗心忘记兼容，如果我的 F 能早点发现那个括号问题，<span class=\"red-target\">但菜还是原罪</span>。\n\n平常赛后从来不屑于带走牌子和气球的我，这次把气球和队牌全部带了出去，并无视其他人的劝说将一米多的队牌从宁夏抱回了学校。\n\n<img src=\"./20191022161721.jpg\" alt=\"最后一张照片\" title=\"左: wjz; 中: Hang_c; 右: Euphoria\" />\n\n当时抱着一心打网安夺旗赛的心来到了大学，却误打误撞地蓝桥杯在大一拿到了同级唯一的一个省一，也就是那时认识了 Hang_c 他们，也就是那是知道了**算法**。\n\n虽说努力不到一年从零基础开始学算法，但是我也找到了喜欢的事物与志趣相投的人，更多的是了解到人外有人山外有山。\n\n也许是因为大学之前家庭教育对电脑的管制等等，也许是因为我太笨了，也也许是因为我没有百分之百地投入到算法中，罪有应得。\n\nEC final 准备交给 jj 和 wwt 他们去打（没有意外的话），日后希望有一天可以在某次比赛的榜单上面看到 <span class=\"blue-target\">“西安科技大学-我被打了，我是弟弟”</span>  这个队名出现在银牌或者金牌区，学长不给力，还请莫责怪。\n<br /><br />\n\n<div style=\"text-align: right\">就这样吧~ 感谢陪伴<br />\nACM 再见<br /><br />\n--- 来自渣本的一个老年 ACMER </div>\n","source":"_posts/2019银川ACM区域赛总结.md","raw":"---\ntitle: 2019银川ACM区域赛总结\ndate: 2019-10-21 23:09:13\ntags:\n- ACM\n- 比赛\n- 算法\ncategories:\n- 算法\n- ACM\ncopyright: true\nimage: \"http://www.wqh4u.cn/2019/10/21/2019银川ACM区域赛总结/acm.jpg\"\n---\n\n> <span class = 'introduction'>世上没有绝望的处境，只有对处境绝望的人。</span><br/>\n第四场现场赛，也应该是最后一次了<del>（除非EC Final能再去）</del>。也许也是离银牌最近的一次，但是能力有限，又抱了个铜牌归来。<br />藉此作为一个纪念吧。\n\n<!--more-->\n\n<hr/>\n\n## 赛前\n\n自打 2019年全国邀请赛 以及 2019年陕西省赛 以来，收获到了两块铜牌。在打了第一次银川网络赛 <del> 北师大没有开挂名场面 </del> 之后，自己觉得如果可以进现场赛，不知道哪里来的自信，这次一定可以拿到银牌（我校的第一枚银牌？）。\n\n因为 <a href=\"https://hangcc.cn\">Hang_c</a> 拿到了 Offer，当时不知道还有没有时间去打这一场现场赛。当时是暑假，还记得自己边练车边劝 Hang_c 一定要来打现场赛。\n\n紧接着又知道 yyc 要考研，不准备继续打 ACM 了，当时感觉这次就可能真的要没了。\n\n随后找到了 wjz，又把 Hang_c 拉了回来，这一个三人小队也算是凑齐了。\n\n去银川之前，因为个人走了 Java 开发方向，也许是对算法方面有了点懈怠吧，这个稍后会提。\n\n<div class=\"note info\">谁又能知道这一次 Java 还帮了我大忙呢？</div>\n\n经过了一番波折，我们终于来到了银川大武口，走的 jio 疼也算是终于到了住宿的地方，匆匆忙忙放下书包后，去吃了碗羊杂碎汤（感觉还是有点膻味，但是总体来说超级棒！）\n\n就此，开始了下午的热身赛...\n\n<hr />\n\n## 热身赛\n\n热身赛 A 题憨憨题目，因为当时我是机位也刚好配好了 **IDEA**，顺手打印就过了。\n\nC 题 AC 自动机，自己头脑一热以为很简单的用 replace 能莽过去，但是没过多久就发现了大小写的匹配问题，热身赛也没有拿板子。Hang_c 就接下来了这道题开始研究，我和 wjz 开始推 B 题。\n\nB 题是一个阅读理解，wjz 告诉我 Fighter 可以无限次数地把 Speeder 打晕，然而每次打晕都可以拿到一分，我们就掉进了奇奇怪怪的坑里面无法自拔。到了最后几分钟我愈发觉得不对劲，如果可以无限次数的去攻击得分，那么这道题无论怎么样 Sppder 都会输啊。\n\n<div class=\"note info\">\n除非 Speeder 的速度大于 1200，在一瞬间把操场跑完2333...\n</div>\n\n最后和对面的队伍开始聊了起来，他们是浙江财经大学的，正式赛时表现超级好，队内还有一个小姐姐也很强，这个稍后再说。\n\n对面告诉我们 Fighter 在一回合内只能将 Speeder 打晕一次，我当时就黑人问号脸看着 wjz，最后在题目中也发现了这个 Hint，哇心态崩了，当时就告诉 wjz 第二天正式赛不敢这么拉闸。\n\n<img src=\"./20191019_145938.jpg\" alt=\"热身赛\" title=\"热身赛赛前\" />\n\n## 赛前最后一晚\n\nwjz 和 jj 来找我说晚上去网吧上网被我拒绝了，可能也是因为无限火力还没有出吧2333。Hang_c 睡得比较早，我在一旁看了看 DP 问题，最后想着明天不行就用 Java 去解题，因为队伍内从来没有 Java 解题选手，也就没有任何和 Java 有关的板子一类的资料。\n\n我告诉 Hang_c 说我去找 lx 看看有没有稿纸，我要把一些标准库和黑魔法抄到纸上带过去。结果 lx 并没有，又去找了 wzh 结果也 GG，甚至跑到了酒店前台去借，结果前台没人233\n\n回房间后突然想起来可以用今天热身赛题目的背面来写，事不宜迟就开始干，也就看了看 Collections 与 Map 接口下面的常用标准库，最后又记了一下 Math 中的一些黑魔法，抄了两页纸后忐忑不安的就去睡觉了。\n\n<hr />\n\n## 正式赛\n\n一大早被 Hang_c 叫起来，匆匆忙忙洗漱完就直接去了赛场，路上也遇到了对面浙江财经大学的 Team，打了招呼后就去到了自己的位置上。\n\n5...4...3...2...1...比赛开始\n\n拆开题目后一眼看到了 M 切蛋糕，当时脑袋一热觉得是卡塔兰数，简单地和 Hang_c 交谈了一下得到了肯定，就头铁的去分析 M（记住这个题）。\n\nHang_c 刷了下榜，发现 N 是签到题，我一下就蒙了，N 就在 M 的旁边我却连看一眼都没有。一看 N 又是像热身那样的憨憨题目，随便一写就交了。然后 Hang_c 和 wjz 在看 B 题，我在一旁翻译其他题。\n\n没过多久我发现了 I 题，这时候 Hang_c 和 wjz 对 B 题有了初步的商量，我把机位给了 Hang_c 去开 B，我在一边继续分析 I。\n\nHang_c 的第一发 B WA了，我很着急催他要上机位，然后他们两个继续分析 B，我这边单开一下 I。\n\n想着 I 中会出现 62 的 120 次方，莽开 double 也是炸，脑子一热用了 BigInteger，对超出 F 的 17 进制以上的数字手动转成对应序号，也就是换了一种方法去莽题目吧。\n\n果不其然，我的 I 也 WA 了。\n\n<img src=\"./20191020_141340.jpg\" alt=\"正式赛结束\" title=\"正式赛结束时拍的\" />\n\n我把 I 打印出来，接着换 Hang_c 上机位去攻 B，Hang_c 和 wjz 想的有点复杂了，所以在 B 上也用了很多时间，然后撒花AC。\n\n这时候压力也就转移到了我身上，改动了一次代码后，真棒，果不其然 WA 了。Hang_c 来问我代码思路，我简单地说了一下后，Hang_c 我怎么处理转换之后的超出 16 进制的数字，瞬间我就懂了。我自测样例通过的原因是我没有测 Hang_c 说的那种样例。\n\n这时候刷了下榜，发现 G 题就是铜牌线，Hang_c 和 wjz 开始去首先开 G，我自己一个人在机位处理我的 I，当时也上头了，没有给他们说我要交，自己擅自直接就把 I 交了...\n\n抱着绝对会 WA 的心态按着 F5，没有想到的是就这么的 AC 了？？？\n\nHang_c 和 wjz 也是一脸：？？？你干了什么\n\n<div class=\"note info\">\nBigInteger 真的香啊，我这时候看 lx 他们队没有过 I，就想着一定要把 I 打印出来拿给 lx 他们看233.\n</div>\n\nG 题是线段树，但是我对 **因子** 这种问题一下就头麻了，和 wjz 分析了下思路后，Hang_c 上了机位，然后剩下的三个小时也就用到 G 题上了...\n\n这时候对面也在开 G 题，是一个小姐姐在机位上，我们同时都反应上来 G 题是线段树，然而我们只有 Hang_c 对线段树熟一点，Hang_c 也因为找工作的原因时间紧张，所以我们只好拿着板子去写那个线段树了...\n\n时间一分一秒地过去，只看着周围深蓝色（G题）气球越来越多，感觉自己要凉到这里了...\n\n对面小姐姐交了第一发 RE，然后没多久改正后就 AC 了...\n\n<div class=\"note info\">\n浙江财经大学的那位小姐姐，有看到我的这篇博客欢迎联系啊！<br />比赛完了后<del>Hang_c</del>想着找你要联系方式来着，你真的超级强啊...\n</div>\n\n封榜了，我们的 G 题还没有过，连着交了四发 RE，我提醒了下 Hang_c 看看是不是有下标越界等等问题（也不知道有没有帮上忙），Hang_c 改了改后交了一发结果 WA 了，我感觉这是最好不过的事情了，全队人都来了志气一定要把 G 过了！\n\n剩了 20 分钟，G 题过了，硬生生压住了要喊出来的想法，想着用这最后 20 分钟试一试 F。\n\n**世上没有绝望的处境，只有对处境绝望的人。**\n\nF 题自己眼睛瞎了没有看见那个各自上下取整，以为那是一个中括号，最后发现不对只剩了 5 分钟了。用尽最快的打字速度敲完代码，还剩 15s，简单地测了一下样例后直接提交。\n\n但是 WA 了... 五题就是银牌线了...\n\n<img src=\"./20191020_141204.jpg\" alt=\"四个气球\" title=\"B: 青色；G: 蓝色; I: 粉色; N: 橙色\" />\n\n<hr />\n\n## 赛后\n\n这一次的铜牌再也没有当时打全国邀请赛时的铜牌拿的那么开心那么激动了。更多的只是不甘心，这也许就是我们离银牌最近的一次机会了，如果我的 I 没有粗心忘记兼容，如果我的 F 能早点发现那个括号问题，<span class=\"red-target\">但菜还是原罪</span>。\n\n平常赛后从来不屑于带走牌子和气球的我，这次把气球和队牌全部带了出去，并无视其他人的劝说将一米多的队牌从宁夏抱回了学校。\n\n<img src=\"./20191022161721.jpg\" alt=\"最后一张照片\" title=\"左: wjz; 中: Hang_c; 右: Euphoria\" />\n\n当时抱着一心打网安夺旗赛的心来到了大学，却误打误撞地蓝桥杯在大一拿到了同级唯一的一个省一，也就是那时认识了 Hang_c 他们，也就是那是知道了**算法**。\n\n虽说努力不到一年从零基础开始学算法，但是我也找到了喜欢的事物与志趣相投的人，更多的是了解到人外有人山外有山。\n\n也许是因为大学之前家庭教育对电脑的管制等等，也许是因为我太笨了，也也许是因为我没有百分之百地投入到算法中，罪有应得。\n\nEC final 准备交给 jj 和 wwt 他们去打（没有意外的话），日后希望有一天可以在某次比赛的榜单上面看到 <span class=\"blue-target\">“西安科技大学-我被打了，我是弟弟”</span>  这个队名出现在银牌或者金牌区，学长不给力，还请莫责怪。\n<br /><br />\n\n<div style=\"text-align: right\">就这样吧~ 感谢陪伴<br />\nACM 再见<br /><br />\n--- 来自渣本的一个老年 ACMER </div>\n","slug":"2019银川ACM区域赛总结","published":1,"updated":"2020-01-14T21:00:31.675Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn4r00002lwj36g994ba","content":"<blockquote>\n<p><span class=\"introduction\">世上没有绝望的处境，只有对处境绝望的人。</span><br><br>第四场现场赛，也应该是最后一次了<del>（除非EC Final能再去）</del>。也许也是离银牌最近的一次，但是能力有限，又抱了个铜牌归来。<br>藉此作为一个纪念吧。</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"赛前\"><a href=\"#赛前\" class=\"headerlink\" title=\"赛前\"></a>赛前</h2><p>自打 2019年全国邀请赛 以及 2019年陕西省赛 以来，收获到了两块铜牌。在打了第一次银川网络赛 <del> 北师大没有开挂名场面 </del> 之后，自己觉得如果可以进现场赛，不知道哪里来的自信，这次一定可以拿到银牌（我校的第一枚银牌？）。</p>\n<p>因为 <a href=\"https://hangcc.cn\" target=\"_blank\" rel=\"noopener\">Hang_c</a> 拿到了 Offer，当时不知道还有没有时间去打这一场现场赛。当时是暑假，还记得自己边练车边劝 Hang_c 一定要来打现场赛。</p>\n<p>紧接着又知道 yyc 要考研，不准备继续打 ACM 了，当时感觉这次就可能真的要没了。</p>\n<p>随后找到了 wjz，又把 Hang_c 拉了回来，这一个三人小队也算是凑齐了。</p>\n<p>去银川之前，因为个人走了 Java 开发方向，也许是对算法方面有了点懈怠吧，这个稍后会提。</p>\n<div class=\"note info\">谁又能知道这一次 Java 还帮了我大忙呢？</div>\n\n<p>经过了一番波折，我们终于来到了银川大武口，走的 jio 疼也算是终于到了住宿的地方，匆匆忙忙放下书包后，去吃了碗羊杂碎汤（感觉还是有点膻味，但是总体来说超级棒！）</p>\n<p>就此，开始了下午的热身赛…</p>\n<hr>\n\n<h2 id=\"热身赛\"><a href=\"#热身赛\" class=\"headerlink\" title=\"热身赛\"></a>热身赛</h2><p>热身赛 A 题憨憨题目，因为当时我是机位也刚好配好了 <strong>IDEA</strong>，顺手打印就过了。</p>\n<p>C 题 AC 自动机，自己头脑一热以为很简单的用 replace 能莽过去，但是没过多久就发现了大小写的匹配问题，热身赛也没有拿板子。Hang_c 就接下来了这道题开始研究，我和 wjz 开始推 B 题。</p>\n<p>B 题是一个阅读理解，wjz 告诉我 Fighter 可以无限次数地把 Speeder 打晕，然而每次打晕都可以拿到一分，我们就掉进了奇奇怪怪的坑里面无法自拔。到了最后几分钟我愈发觉得不对劲，如果可以无限次数的去攻击得分，那么这道题无论怎么样 Sppder 都会输啊。</p>\n<div class=\"note info\">\n除非 Speeder 的速度大于 1200，在一瞬间把操场跑完2333...\n</div>\n\n<p>最后和对面的队伍开始聊了起来，他们是浙江财经大学的，正式赛时表现超级好，队内还有一个小姐姐也很强，这个稍后再说。</p>\n<p>对面告诉我们 Fighter 在一回合内只能将 Speeder 打晕一次，我当时就黑人问号脸看着 wjz，最后在题目中也发现了这个 Hint，哇心态崩了，当时就告诉 wjz 第二天正式赛不敢这么拉闸。</p>\n<img src=\"/2019/10/21/2019%E9%93%B6%E5%B7%9DACM%E5%8C%BA%E5%9F%9F%E8%B5%9B%E6%80%BB%E7%BB%93/20191019_145938.jpg\" alt=\"热身赛\" title=\"热身赛赛前\">\n\n<h2 id=\"赛前最后一晚\"><a href=\"#赛前最后一晚\" class=\"headerlink\" title=\"赛前最后一晚\"></a>赛前最后一晚</h2><p>wjz 和 jj 来找我说晚上去网吧上网被我拒绝了，可能也是因为无限火力还没有出吧2333。Hang_c 睡得比较早，我在一旁看了看 DP 问题，最后想着明天不行就用 Java 去解题，因为队伍内从来没有 Java 解题选手，也就没有任何和 Java 有关的板子一类的资料。</p>\n<p>我告诉 Hang_c 说我去找 lx 看看有没有稿纸，我要把一些标准库和黑魔法抄到纸上带过去。结果 lx 并没有，又去找了 wzh 结果也 GG，甚至跑到了酒店前台去借，结果前台没人233</p>\n<p>回房间后突然想起来可以用今天热身赛题目的背面来写，事不宜迟就开始干，也就看了看 Collections 与 Map 接口下面的常用标准库，最后又记了一下 Math 中的一些黑魔法，抄了两页纸后忐忑不安的就去睡觉了。</p>\n<hr>\n\n<h2 id=\"正式赛\"><a href=\"#正式赛\" class=\"headerlink\" title=\"正式赛\"></a>正式赛</h2><p>一大早被 Hang_c 叫起来，匆匆忙忙洗漱完就直接去了赛场，路上也遇到了对面浙江财经大学的 Team，打了招呼后就去到了自己的位置上。</p>\n<p>5…4…3…2…1…比赛开始</p>\n<p>拆开题目后一眼看到了 M 切蛋糕，当时脑袋一热觉得是卡塔兰数，简单地和 Hang_c 交谈了一下得到了肯定，就头铁的去分析 M（记住这个题）。</p>\n<p>Hang_c 刷了下榜，发现 N 是签到题，我一下就蒙了，N 就在 M 的旁边我却连看一眼都没有。一看 N 又是像热身那样的憨憨题目，随便一写就交了。然后 Hang_c 和 wjz 在看 B 题，我在一旁翻译其他题。</p>\n<p>没过多久我发现了 I 题，这时候 Hang_c 和 wjz 对 B 题有了初步的商量，我把机位给了 Hang_c 去开 B，我在一边继续分析 I。</p>\n<p>Hang_c 的第一发 B WA了，我很着急催他要上机位，然后他们两个继续分析 B，我这边单开一下 I。</p>\n<p>想着 I 中会出现 62 的 120 次方，莽开 double 也是炸，脑子一热用了 BigInteger，对超出 F 的 17 进制以上的数字手动转成对应序号，也就是换了一种方法去莽题目吧。</p>\n<p>果不其然，我的 I 也 WA 了。</p>\n<img src=\"/2019/10/21/2019%E9%93%B6%E5%B7%9DACM%E5%8C%BA%E5%9F%9F%E8%B5%9B%E6%80%BB%E7%BB%93/20191020_141340.jpg\" alt=\"正式赛结束\" title=\"正式赛结束时拍的\">\n\n<p>我把 I 打印出来，接着换 Hang_c 上机位去攻 B，Hang_c 和 wjz 想的有点复杂了，所以在 B 上也用了很多时间，然后撒花AC。</p>\n<p>这时候压力也就转移到了我身上，改动了一次代码后，真棒，果不其然 WA 了。Hang_c 来问我代码思路，我简单地说了一下后，Hang_c 我怎么处理转换之后的超出 16 进制的数字，瞬间我就懂了。我自测样例通过的原因是我没有测 Hang_c 说的那种样例。</p>\n<p>这时候刷了下榜，发现 G 题就是铜牌线，Hang_c 和 wjz 开始去首先开 G，我自己一个人在机位处理我的 I，当时也上头了，没有给他们说我要交，自己擅自直接就把 I 交了…</p>\n<p>抱着绝对会 WA 的心态按着 F5，没有想到的是就这么的 AC 了？？？</p>\n<p>Hang_c 和 wjz 也是一脸：？？？你干了什么</p>\n<div class=\"note info\">\nBigInteger 真的香啊，我这时候看 lx 他们队没有过 I，就想着一定要把 I 打印出来拿给 lx 他们看233.\n</div>\n\n<p>G 题是线段树，但是我对 <strong>因子</strong> 这种问题一下就头麻了，和 wjz 分析了下思路后，Hang_c 上了机位，然后剩下的三个小时也就用到 G 题上了…</p>\n<p>这时候对面也在开 G 题，是一个小姐姐在机位上，我们同时都反应上来 G 题是线段树，然而我们只有 Hang_c 对线段树熟一点，Hang_c 也因为找工作的原因时间紧张，所以我们只好拿着板子去写那个线段树了…</p>\n<p>时间一分一秒地过去，只看着周围深蓝色（G题）气球越来越多，感觉自己要凉到这里了…</p>\n<p>对面小姐姐交了第一发 RE，然后没多久改正后就 AC 了…</p>\n<div class=\"note info\">\n浙江财经大学的那位小姐姐，有看到我的这篇博客欢迎联系啊！<br>比赛完了后<del>Hang_c</del>想着找你要联系方式来着，你真的超级强啊...\n</div>\n\n<p>封榜了，我们的 G 题还没有过，连着交了四发 RE，我提醒了下 Hang_c 看看是不是有下标越界等等问题（也不知道有没有帮上忙），Hang_c 改了改后交了一发结果 WA 了，我感觉这是最好不过的事情了，全队人都来了志气一定要把 G 过了！</p>\n<p>剩了 20 分钟，G 题过了，硬生生压住了要喊出来的想法，想着用这最后 20 分钟试一试 F。</p>\n<p><strong>世上没有绝望的处境，只有对处境绝望的人。</strong></p>\n<p>F 题自己眼睛瞎了没有看见那个各自上下取整，以为那是一个中括号，最后发现不对只剩了 5 分钟了。用尽最快的打字速度敲完代码，还剩 15s，简单地测了一下样例后直接提交。</p>\n<p>但是 WA 了… 五题就是银牌线了…</p>\n<img src=\"/2019/10/21/2019%E9%93%B6%E5%B7%9DACM%E5%8C%BA%E5%9F%9F%E8%B5%9B%E6%80%BB%E7%BB%93/20191020_141204.jpg\" alt=\"四个气球\" title=\"B: 青色；G: 蓝色; I: 粉色; N: 橙色\">\n\n<hr>\n\n<h2 id=\"赛后\"><a href=\"#赛后\" class=\"headerlink\" title=\"赛后\"></a>赛后</h2><p>这一次的铜牌再也没有当时打全国邀请赛时的铜牌拿的那么开心那么激动了。更多的只是不甘心，这也许就是我们离银牌最近的一次机会了，如果我的 I 没有粗心忘记兼容，如果我的 F 能早点发现那个括号问题，<span class=\"red-target\">但菜还是原罪</span>。</p>\n<p>平常赛后从来不屑于带走牌子和气球的我，这次把气球和队牌全部带了出去，并无视其他人的劝说将一米多的队牌从宁夏抱回了学校。</p>\n<img src=\"/2019/10/21/2019%E9%93%B6%E5%B7%9DACM%E5%8C%BA%E5%9F%9F%E8%B5%9B%E6%80%BB%E7%BB%93/20191022161721.jpg\" alt=\"最后一张照片\" title=\"左: wjz; 中: Hang_c; 右: Euphoria\">\n\n<p>当时抱着一心打网安夺旗赛的心来到了大学，却误打误撞地蓝桥杯在大一拿到了同级唯一的一个省一，也就是那时认识了 Hang_c 他们，也就是那是知道了<strong>算法</strong>。</p>\n<p>虽说努力不到一年从零基础开始学算法，但是我也找到了喜欢的事物与志趣相投的人，更多的是了解到人外有人山外有山。</p>\n<p>也许是因为大学之前家庭教育对电脑的管制等等，也许是因为我太笨了，也也许是因为我没有百分之百地投入到算法中，罪有应得。</p>\n<p>EC final 准备交给 jj 和 wwt 他们去打（没有意外的话），日后希望有一天可以在某次比赛的榜单上面看到 <span class=\"blue-target\">“西安科技大学-我被打了，我是弟弟”</span>  这个队名出现在银牌或者金牌区，学长不给力，还请莫责怪。<br><br><br></p>\n<div style=\"text-align: right\">就这样吧~ 感谢陪伴<br>\nACM 再见<br><br>\n--- 来自渣本的一个老年 ACMER </div>\n","site":{"data":{}},"length":3096,"excerpt":"<blockquote>\n<p><span class=\"introduction\">世上没有绝望的处境，只有对处境绝望的人。</span><br><br>第四场现场赛，也应该是最后一次了<del>（除非EC Final能再去）</del>。也许也是离银牌最近的一次，但是能力有限，又抱了个铜牌归来。<br>藉此作为一个纪念吧。</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"赛前\"><a href=\"#赛前\" class=\"headerlink\" title=\"赛前\"></a>赛前</h2><p>自打 2019年全国邀请赛 以及 2019年陕西省赛 以来，收获到了两块铜牌。在打了第一次银川网络赛 <del> 北师大没有开挂名场面 </del> 之后，自己觉得如果可以进现场赛，不知道哪里来的自信，这次一定可以拿到银牌（我校的第一枚银牌？）。</p>\n<p>因为 <a href=\"https://hangcc.cn\" target=\"_blank\" rel=\"noopener\">Hang_c</a> 拿到了 Offer，当时不知道还有没有时间去打这一场现场赛。当时是暑假，还记得自己边练车边劝 Hang_c 一定要来打现场赛。</p>\n<p>紧接着又知道 yyc 要考研，不准备继续打 ACM 了，当时感觉这次就可能真的要没了。</p>\n<p>随后找到了 wjz，又把 Hang_c 拉了回来，这一个三人小队也算是凑齐了。</p>\n<p>去银川之前，因为个人走了 Java 开发方向，也许是对算法方面有了点懈怠吧，这个稍后会提。</p>\n<div class=\"note info\">谁又能知道这一次 Java 还帮了我大忙呢？</div>\n\n<p>经过了一番波折，我们终于来到了银川大武口，走的 jio 疼也算是终于到了住宿的地方，匆匆忙忙放下书包后，去吃了碗羊杂碎汤（感觉还是有点膻味，但是总体来说超级棒！）</p>\n<p>就此，开始了下午的热身赛…</p>\n<hr>\n\n<h2 id=\"热身赛\"><a href=\"#热身赛\" class=\"headerlink\" title=\"热身赛\"></a>热身赛</h2><p>热身赛 A 题憨憨题目，因为当时我是机位也刚好配好了 <strong>IDEA</strong>，顺手打印就过了。</p>\n<p>C 题 AC 自动机，自己头脑一热以为很简单的用 replace 能莽过去，但是没过多久就发现了大小写的匹配问题，热身赛也没有拿板子。Hang_c 就接下来了这道题开始研究，我和 wjz 开始推 B 题。</p>\n<p>B 题是一个阅读理解，wjz 告诉我 Fighter 可以无限次数地把 Speeder 打晕，然而每次打晕都可以拿到一分，我们就掉进了奇奇怪怪的坑里面无法自拔。到了最后几分钟我愈发觉得不对劲，如果可以无限次数的去攻击得分，那么这道题无论怎么样 Sppder 都会输啊。</p>\n<div class=\"note info\">\n除非 Speeder 的速度大于 1200，在一瞬间把操场跑完2333...\n</div>\n\n<p>最后和对面的队伍开始聊了起来，他们是浙江财经大学的，正式赛时表现超级好，队内还有一个小姐姐也很强，这个稍后再说。</p>\n<p>对面告诉我们 Fighter 在一回合内只能将 Speeder 打晕一次，我当时就黑人问号脸看着 wjz，最后在题目中也发现了这个 Hint，哇心态崩了，当时就告诉 wjz 第二天正式赛不敢这么拉闸。</p>\n<img src=\"/2019/10/21/2019%E9%93%B6%E5%B7%9DACM%E5%8C%BA%E5%9F%9F%E8%B5%9B%E6%80%BB%E7%BB%93/20191019_145938.jpg\" alt=\"热身赛\" title=\"热身赛赛前\">\n\n<h2 id=\"赛前最后一晚\"><a href=\"#赛前最后一晚\" class=\"headerlink\" title=\"赛前最后一晚\"></a>赛前最后一晚</h2><p>wjz 和 jj 来找我说晚上去网吧上网被我拒绝了，可能也是因为无限火力还没有出吧2333。Hang_c 睡得比较早，我在一旁看了看 DP 问题，最后想着明天不行就用 Java 去解题，因为队伍内从来没有 Java 解题选手，也就没有任何和 Java 有关的板子一类的资料。</p>\n<p>我告诉 Hang_c 说我去找 lx 看看有没有稿纸，我要把一些标准库和黑魔法抄到纸上带过去。结果 lx 并没有，又去找了 wzh 结果也 GG，甚至跑到了酒店前台去借，结果前台没人233</p>\n<p>回房间后突然想起来可以用今天热身赛题目的背面来写，事不宜迟就开始干，也就看了看 Collections 与 Map 接口下面的常用标准库，最后又记了一下 Math 中的一些黑魔法，抄了两页纸后忐忑不安的就去睡觉了。</p>\n<hr>\n\n<h2 id=\"正式赛\"><a href=\"#正式赛\" class=\"headerlink\" title=\"正式赛\"></a>正式赛</h2><p>一大早被 Hang_c 叫起来，匆匆忙忙洗漱完就直接去了赛场，路上也遇到了对面浙江财经大学的 Team，打了招呼后就去到了自己的位置上。</p>\n<p>5…4…3…2…1…比赛开始</p>\n<p>拆开题目后一眼看到了 M 切蛋糕，当时脑袋一热觉得是卡塔兰数，简单地和 Hang_c 交谈了一下得到了肯定，就头铁的去分析 M（记住这个题）。</p>\n<p>Hang_c 刷了下榜，发现 N 是签到题，我一下就蒙了，N 就在 M 的旁边我却连看一眼都没有。一看 N 又是像热身那样的憨憨题目，随便一写就交了。然后 Hang_c 和 wjz 在看 B 题，我在一旁翻译其他题。</p>\n<p>没过多久我发现了 I 题，这时候 Hang_c 和 wjz 对 B 题有了初步的商量，我把机位给了 Hang_c 去开 B，我在一边继续分析 I。</p>\n<p>Hang_c 的第一发 B WA了，我很着急催他要上机位，然后他们两个继续分析 B，我这边单开一下 I。</p>\n<p>想着 I 中会出现 62 的 120 次方，莽开 double 也是炸，脑子一热用了 BigInteger，对超出 F 的 17 进制以上的数字手动转成对应序号，也就是换了一种方法去莽题目吧。</p>\n<p>果不其然，我的 I 也 WA 了。</p>\n<img src=\"/2019/10/21/2019%E9%93%B6%E5%B7%9DACM%E5%8C%BA%E5%9F%9F%E8%B5%9B%E6%80%BB%E7%BB%93/20191020_141340.jpg\" alt=\"正式赛结束\" title=\"正式赛结束时拍的\">\n\n<p>我把 I 打印出来，接着换 Hang_c 上机位去攻 B，Hang_c 和 wjz 想的有点复杂了，所以在 B 上也用了很多时间，然后撒花AC。</p>\n<p>这时候压力也就转移到了我身上，改动了一次代码后，真棒，果不其然 WA 了。Hang_c 来问我代码思路，我简单地说了一下后，Hang_c 我怎么处理转换之后的超出 16 进制的数字，瞬间我就懂了。我自测样例通过的原因是我没有测 Hang_c 说的那种样例。</p>\n<p>这时候刷了下榜，发现 G 题就是铜牌线，Hang_c 和 wjz 开始去首先开 G，我自己一个人在机位处理我的 I，当时也上头了，没有给他们说我要交，自己擅自直接就把 I 交了…</p>\n<p>抱着绝对会 WA 的心态按着 F5，没有想到的是就这么的 AC 了？？？</p>\n<p>Hang_c 和 wjz 也是一脸：？？？你干了什么</p>\n<div class=\"note info\">\nBigInteger 真的香啊，我这时候看 lx 他们队没有过 I，就想着一定要把 I 打印出来拿给 lx 他们看233.\n</div>\n\n<p>G 题是线段树，但是我对 <strong>因子</strong> 这种问题一下就头麻了，和 wjz 分析了下思路后，Hang_c 上了机位，然后剩下的三个小时也就用到 G 题上了…</p>\n<p>这时候对面也在开 G 题，是一个小姐姐在机位上，我们同时都反应上来 G 题是线段树，然而我们只有 Hang_c 对线段树熟一点，Hang_c 也因为找工作的原因时间紧张，所以我们只好拿着板子去写那个线段树了…</p>\n<p>时间一分一秒地过去，只看着周围深蓝色（G题）气球越来越多，感觉自己要凉到这里了…</p>\n<p>对面小姐姐交了第一发 RE，然后没多久改正后就 AC 了…</p>\n<div class=\"note info\">\n浙江财经大学的那位小姐姐，有看到我的这篇博客欢迎联系啊！<br>比赛完了后<del>Hang_c</del>想着找你要联系方式来着，你真的超级强啊...\n</div>\n\n<p>封榜了，我们的 G 题还没有过，连着交了四发 RE，我提醒了下 Hang_c 看看是不是有下标越界等等问题（也不知道有没有帮上忙），Hang_c 改了改后交了一发结果 WA 了，我感觉这是最好不过的事情了，全队人都来了志气一定要把 G 过了！</p>\n<p>剩了 20 分钟，G 题过了，硬生生压住了要喊出来的想法，想着用这最后 20 分钟试一试 F。</p>\n<p><strong>世上没有绝望的处境，只有对处境绝望的人。</strong></p>\n<p>F 题自己眼睛瞎了没有看见那个各自上下取整，以为那是一个中括号，最后发现不对只剩了 5 分钟了。用尽最快的打字速度敲完代码，还剩 15s，简单地测了一下样例后直接提交。</p>\n<p>但是 WA 了… 五题就是银牌线了…</p>\n<img src=\"/2019/10/21/2019%E9%93%B6%E5%B7%9DACM%E5%8C%BA%E5%9F%9F%E8%B5%9B%E6%80%BB%E7%BB%93/20191020_141204.jpg\" alt=\"四个气球\" title=\"B: 青色；G: 蓝色; I: 粉色; N: 橙色\">\n\n<hr>\n\n<h2 id=\"赛后\"><a href=\"#赛后\" class=\"headerlink\" title=\"赛后\"></a>赛后</h2><p>这一次的铜牌再也没有当时打全国邀请赛时的铜牌拿的那么开心那么激动了。更多的只是不甘心，这也许就是我们离银牌最近的一次机会了，如果我的 I 没有粗心忘记兼容，如果我的 F 能早点发现那个括号问题，<span class=\"red-target\">但菜还是原罪</span>。</p>\n<p>平常赛后从来不屑于带走牌子和气球的我，这次把气球和队牌全部带了出去，并无视其他人的劝说将一米多的队牌从宁夏抱回了学校。</p>\n<img src=\"/2019/10/21/2019%E9%93%B6%E5%B7%9DACM%E5%8C%BA%E5%9F%9F%E8%B5%9B%E6%80%BB%E7%BB%93/20191022161721.jpg\" alt=\"最后一张照片\" title=\"左: wjz; 中: Hang_c; 右: Euphoria\">\n\n<p>当时抱着一心打网安夺旗赛的心来到了大学，却误打误撞地蓝桥杯在大一拿到了同级唯一的一个省一，也就是那时认识了 Hang_c 他们，也就是那是知道了<strong>算法</strong>。</p>\n<p>虽说努力不到一年从零基础开始学算法，但是我也找到了喜欢的事物与志趣相投的人，更多的是了解到人外有人山外有山。</p>\n<p>也许是因为大学之前家庭教育对电脑的管制等等，也许是因为我太笨了，也也许是因为我没有百分之百地投入到算法中，罪有应得。</p>\n<p>EC final 准备交给 jj 和 wwt 他们去打（没有意外的话），日后希望有一天可以在某次比赛的榜单上面看到 <span class=\"blue-target\">“西安科技大学-我被打了，我是弟弟”</span>  这个队名出现在银牌或者金牌区，学长不给力，还请莫责怪。<br><br><br></p>\n<div style=\"text-align: right\">就这样吧~ 感谢陪伴<br>\nACM 再见<br><br>\n--- 来自渣本的一个老年 ACMER </div>"},{"title":"Hexo-NexT魔改系列-01-准备工作","date":"2019-09-08T07:21:16.000Z","copyright":true,"_content":"\n> <span class = 'introduction'>要想改变命运，首先改变自己。</span><br/>\n本篇博客介绍了如何魔改你的 `Hexo NexT` 博客的初步配置与常用文件介绍，开始你的魔改之路吧~\n\n<!--more-->\n\n<hr/>\n\n## 前言\n\n在接下来的所有描述中，我们会经常用到 <span class = \"blue-target\">站点配置文件</span> 与 <span class = \"purple-target\">主题配置文件</span>，这两个文件将分别会用 <span class = \"blue-target\">蓝色标注</span> 与 <span class = \"purple-target\">紫色标注</span> 来标识。<br/>其余文件将统一采用如下格式：`/themes/next/source/css/_custom/custom.styl`，其中 `/` 代表你的 **Hexo** 博客根目录。\n\n## 重要配置文件\n\n### 站点配置文件\n\n<span class = \"blue-target\">站点配置文件</span> 是位于 `/` 下的 `_config.yml`，我们在里面可以设置：\n\n```yml\n# Site\ntitle: Euphoria's Blog # 你的博客名称\nsubtitle: <strong><font color=\"#FF0000\">Quitters</font> Never Win,<br/> <font color=\"#007FFF\">Winners</font> Never Quit.</strong> # 博客附标题\ndescription: 我摸到了<font color=\"#FF0000\">梦</font>，<br/>也看到了<font color=\"#007FFF\">光</font>。 # 博客简介\nkeywords: Euphoria # 博客关键字\nauthor: 王钦弘 # 作者信息\nlanguage: zh-Hans # 所用语言\ntimezone: # 时区，默认为当前服务器时区\n```\n\n其余设置不变，就是在我的 [Hexo博客的安装与基本配置](https://www.wqh4u.cn/2019/07/31/Hexo博客的安装与基本配置/) 中所设置的所有东西。\n\n<div class = \"note info\">\n如果要在这里设置 CSS 样式的话，可以在 custom.styl 中进行全局设置，或者使用 \t&#60;font&#62; 标签来对其进行修饰，如果使用 &#60;span style = \"xxx\"&#62; 的话，里面的冒号会造成二义性，故不能使用。\n</div>\n\n### 主题配置文件\n\n<span class = \"purple-target\">主题配置文件</span> 是位于 `/themes/next/` 下的 `_config.yml`，这是我们在魔改的时候最常用的一个文件，因为可配置项太多在这里不一一列举，以后的博客中会对所要魔改的项进行解说，其余配置项英语好的小伙伴可以看懂无压力的~\n\n### 自定义配置文件\n\n本系列会使用到大量的 CSS 与 JavaScript 的相关内容，为了更有效率与可观赏性的美化博客，我们将这些美化相关的东西都尽可能地写到一类文件中，方便日后查询与修改。譬如下边的几个文件里，就存放了博客的大部分美化内容：\n\n1. `/themes/next/source/css/_custom/custom.styl`\n2. `/themes/next/source/js/src/custom.js`\n3. `/themes/next/layout/_partials/head/custom-head.swig`\n4. `/themes/next/layout/_custom/custom-foot.swig`\n\n如果没有也请不要过于担心，稍后将会带领创建并引入博客主题内配置。\n\n#### 添加 custom-foot.swig 文件\n\n在 `/themes/next/layout/_custom/` 下创建 `custom-foot.swig` 文件，并加入以下内容：\n\n```html\n{# Custom foot in body, Can add script here. #}\n<!-- 自定义的js文件 -->\n<script type=\"text/javascript\" src=\"/js/src/custom.js\"></script>\n```\n\n接着修改 `themes\\next\\layout\\_layout.swig`，在 &#60;/body&#62; 标签前添加一行代码，表示将我们新添加的 `custom-foot.swig` 文件包括进去：\n\n```html\n    <body>\n        ....\n        {% include '_custom/custom-foot.swig' %}\n    </body>\n</html>\n```\n\n这个文件的作用是负责引入我们想要的 js 文件，比如其他第三方 js 的 cdn 等等。因为页面在引入 js 文件时是阻塞式的（你也可以设置 async），如果我们在页面的最开始就引入这些 js 文件，而这些文件又比较大，会造成页面在渲染时长时间处于白屏状态。\n\n#### 添加 custom.js 文件\n\n在 `/themes/next/source/js/src/` 目录下添加 `custom.js` 文件，该文件用来存放我们自己写的 js 函数等等，需要注意的是，我们之前是在 `custom-foot.swig` 文件中的 &#60;script&#62; 标签里引入了该文件，也就是说，在该文件里，我们不能再自己添加 script 标签了，直接书写 js 函数就行了，如下所示：\n\n```javascript\n/* 轮播背景图片 */\n$(function () {\n    $.backstretch([\n        \"/images/background/bg1.jpg\",\n        \"/images/background/bg2.jpg\",\n        \"/images/background/bg3.jpg\",\n    ], {duration: 300000, fade: 1500});\n}); /*这个是背景轮播图，现在暂时可以不用输入*/\n```\n\n### 其它重要文件\n\n#### footer.swig\n\n这个文件位于 `/themes/next/layout/_partials/` 下，里面配置了关于页脚（也就是最开始下面有 **Powered by Hexo** 的那一块地方），因为要设置如 **备案号**、**博客全站统计字数**、**博客共计访客** 等等信息，都要在这个文件中进行设置。\n\n#### sidebar.swig\n\n这个文件位于 `/themes/next/layout/_custom/` 下，里面将会对 **博客已运行时间** 等进行配置。\n\n<div class = \"note info\">\n上面的所有文件（包括其他没有列举出来的文件）请各位仔细阅读其源码（如果有的话），以便各位可以在今后可以自定义自己的博客样式。\n</div>\n\n<hr/>\n\n## 开始页面的简单美化\n\n### 改变页面的字体大小\n\n打开 `\\themes\\next\\source\\css\\_variables\\base.styl`，该文件保存了一些基础变量的值，我们找到 `$font-size-base`，将值改为 `16px`（我记得默认是 14px，各位根据自己的心情来改）。\n\n```css\n// Font size\n$font-size-base           = 16px\n```\n\n这个文件里定义了很多常量，有兴趣的可以自己去琢磨琢磨，修改一些其它常量值。\n\n### 文章启用 tags 和 categories\n\n在 [Hexo博客的安装与基本配置](https://www.wqh4u.cn/2019/07/31/Hexo博客的安装与基本配置/) 中，没有对增加这两个页面做过多的阐述，在这里将会带领各位创建这两个页面。\n\n首先，你需要在你的文章中设置 `tags` 和 `categories`，具体操作如下：\n\n```markdown\n---\ntitle: Test\ntags:\n  - YourTag\ncategories:\n  - YourCategory\ndate: 20xx-xx-xx xx:xx:xx\n---\n```\n\n在你的 <span class = \"purple-target\">主题配置文件</span> 中，找到 `menu` 项，修改为如下：\n\n```yml\nmenu:\n  home: / || home\n  tags: /tags/ || tags\n  categories: /categories/ || th\n  archives: /archives/ || archive\n```\n\n接着确定是否在 `/source/` 目录下是否已经存在 `tags` 和 `categories` 这两个文件夹，如果不存在需要运行以下命令：\n\n```bash\nhexo n page tags\nhexo n page categories\n```\n\n运行之后会在 `/source/` 目录下生成对应的两个文件夹，在文件夹下会存在一个 `index.md` 文件，打开这两个 `index.md` 文件，分别添加 type: tags 和 type: categories，如下：\n\n**/source/tags/index.md**\n```markdown\n---\ntitle: 标签\ndate: 20xx-xx-xx xx:xx:xx\ntype: tags\n---\n```\n\n**/source/categories/index.md**\n```markdown\n---\ntitle: 分类\ndate: 20xx-xx-xx xx:xx:xx\ntype: categories\n---\n```\n\n### 去掉图片边框\n\nNexT主题默认会有图片边框，不太好看，我们可以把边框去掉。打开 `themes\\next\\source\\css\\_custom\\custom.styl`，添加如下 CSS 代码：\n\n```css\n/* 去掉图片边框 */\n.posts-expand .post-body img {\n    border: none;\n    padding: 0px;\n}\n.post-gallery .post-gallery-img img {\n    padding: 3px;\n}\n```\n\n## 参考文章与推荐\n\n### 大佬们的博客\n\n1. [雨临Lewis大大的博客](https://lewky.cn/posts/ef301a4d.html)\n2. [hexo的next主题个性化配置教程](https://segmentfault.com/a/1190000009544924)\n3. [打造个性超赞博客Hexo+NexT+GithubPages的超深度优化](https://io-oi.me/tech/hexo-next-optimization/)\n\n### 在线压缩图片\n\n在博客上的图片尽可能的要压缩一下体积，否则轻则会造成图片加载迟缓，重则会造成页面卡住白屏很久。推荐一个 [在线压缩图片](https://imagecompressor.com/zh/) 的链接，常用的除了 `.gif` 格式的都可以，我觉得挺好用的，独乐乐不如众乐乐~","source":"_posts/Hexo-NexT魔改系列-01-准备工作.md","raw":"---\ntitle: Hexo-NexT魔改系列-01-准备工作\ndate: 2019-09-08 15:21:16\ntags:\n- Hexo\n- NexT\n- 魔改\n- 瞎折腾\ncategories:\n- Hexo\n- NexT\n- 魔改\ncopyright: true\n---\n\n> <span class = 'introduction'>要想改变命运，首先改变自己。</span><br/>\n本篇博客介绍了如何魔改你的 `Hexo NexT` 博客的初步配置与常用文件介绍，开始你的魔改之路吧~\n\n<!--more-->\n\n<hr/>\n\n## 前言\n\n在接下来的所有描述中，我们会经常用到 <span class = \"blue-target\">站点配置文件</span> 与 <span class = \"purple-target\">主题配置文件</span>，这两个文件将分别会用 <span class = \"blue-target\">蓝色标注</span> 与 <span class = \"purple-target\">紫色标注</span> 来标识。<br/>其余文件将统一采用如下格式：`/themes/next/source/css/_custom/custom.styl`，其中 `/` 代表你的 **Hexo** 博客根目录。\n\n## 重要配置文件\n\n### 站点配置文件\n\n<span class = \"blue-target\">站点配置文件</span> 是位于 `/` 下的 `_config.yml`，我们在里面可以设置：\n\n```yml\n# Site\ntitle: Euphoria's Blog # 你的博客名称\nsubtitle: <strong><font color=\"#FF0000\">Quitters</font> Never Win,<br/> <font color=\"#007FFF\">Winners</font> Never Quit.</strong> # 博客附标题\ndescription: 我摸到了<font color=\"#FF0000\">梦</font>，<br/>也看到了<font color=\"#007FFF\">光</font>。 # 博客简介\nkeywords: Euphoria # 博客关键字\nauthor: 王钦弘 # 作者信息\nlanguage: zh-Hans # 所用语言\ntimezone: # 时区，默认为当前服务器时区\n```\n\n其余设置不变，就是在我的 [Hexo博客的安装与基本配置](https://www.wqh4u.cn/2019/07/31/Hexo博客的安装与基本配置/) 中所设置的所有东西。\n\n<div class = \"note info\">\n如果要在这里设置 CSS 样式的话，可以在 custom.styl 中进行全局设置，或者使用 \t&#60;font&#62; 标签来对其进行修饰，如果使用 &#60;span style = \"xxx\"&#62; 的话，里面的冒号会造成二义性，故不能使用。\n</div>\n\n### 主题配置文件\n\n<span class = \"purple-target\">主题配置文件</span> 是位于 `/themes/next/` 下的 `_config.yml`，这是我们在魔改的时候最常用的一个文件，因为可配置项太多在这里不一一列举，以后的博客中会对所要魔改的项进行解说，其余配置项英语好的小伙伴可以看懂无压力的~\n\n### 自定义配置文件\n\n本系列会使用到大量的 CSS 与 JavaScript 的相关内容，为了更有效率与可观赏性的美化博客，我们将这些美化相关的东西都尽可能地写到一类文件中，方便日后查询与修改。譬如下边的几个文件里，就存放了博客的大部分美化内容：\n\n1. `/themes/next/source/css/_custom/custom.styl`\n2. `/themes/next/source/js/src/custom.js`\n3. `/themes/next/layout/_partials/head/custom-head.swig`\n4. `/themes/next/layout/_custom/custom-foot.swig`\n\n如果没有也请不要过于担心，稍后将会带领创建并引入博客主题内配置。\n\n#### 添加 custom-foot.swig 文件\n\n在 `/themes/next/layout/_custom/` 下创建 `custom-foot.swig` 文件，并加入以下内容：\n\n```html\n{# Custom foot in body, Can add script here. #}\n<!-- 自定义的js文件 -->\n<script type=\"text/javascript\" src=\"/js/src/custom.js\"></script>\n```\n\n接着修改 `themes\\next\\layout\\_layout.swig`，在 &#60;/body&#62; 标签前添加一行代码，表示将我们新添加的 `custom-foot.swig` 文件包括进去：\n\n```html\n    <body>\n        ....\n        {% include '_custom/custom-foot.swig' %}\n    </body>\n</html>\n```\n\n这个文件的作用是负责引入我们想要的 js 文件，比如其他第三方 js 的 cdn 等等。因为页面在引入 js 文件时是阻塞式的（你也可以设置 async），如果我们在页面的最开始就引入这些 js 文件，而这些文件又比较大，会造成页面在渲染时长时间处于白屏状态。\n\n#### 添加 custom.js 文件\n\n在 `/themes/next/source/js/src/` 目录下添加 `custom.js` 文件，该文件用来存放我们自己写的 js 函数等等，需要注意的是，我们之前是在 `custom-foot.swig` 文件中的 &#60;script&#62; 标签里引入了该文件，也就是说，在该文件里，我们不能再自己添加 script 标签了，直接书写 js 函数就行了，如下所示：\n\n```javascript\n/* 轮播背景图片 */\n$(function () {\n    $.backstretch([\n        \"/images/background/bg1.jpg\",\n        \"/images/background/bg2.jpg\",\n        \"/images/background/bg3.jpg\",\n    ], {duration: 300000, fade: 1500});\n}); /*这个是背景轮播图，现在暂时可以不用输入*/\n```\n\n### 其它重要文件\n\n#### footer.swig\n\n这个文件位于 `/themes/next/layout/_partials/` 下，里面配置了关于页脚（也就是最开始下面有 **Powered by Hexo** 的那一块地方），因为要设置如 **备案号**、**博客全站统计字数**、**博客共计访客** 等等信息，都要在这个文件中进行设置。\n\n#### sidebar.swig\n\n这个文件位于 `/themes/next/layout/_custom/` 下，里面将会对 **博客已运行时间** 等进行配置。\n\n<div class = \"note info\">\n上面的所有文件（包括其他没有列举出来的文件）请各位仔细阅读其源码（如果有的话），以便各位可以在今后可以自定义自己的博客样式。\n</div>\n\n<hr/>\n\n## 开始页面的简单美化\n\n### 改变页面的字体大小\n\n打开 `\\themes\\next\\source\\css\\_variables\\base.styl`，该文件保存了一些基础变量的值，我们找到 `$font-size-base`，将值改为 `16px`（我记得默认是 14px，各位根据自己的心情来改）。\n\n```css\n// Font size\n$font-size-base           = 16px\n```\n\n这个文件里定义了很多常量，有兴趣的可以自己去琢磨琢磨，修改一些其它常量值。\n\n### 文章启用 tags 和 categories\n\n在 [Hexo博客的安装与基本配置](https://www.wqh4u.cn/2019/07/31/Hexo博客的安装与基本配置/) 中，没有对增加这两个页面做过多的阐述，在这里将会带领各位创建这两个页面。\n\n首先，你需要在你的文章中设置 `tags` 和 `categories`，具体操作如下：\n\n```markdown\n---\ntitle: Test\ntags:\n  - YourTag\ncategories:\n  - YourCategory\ndate: 20xx-xx-xx xx:xx:xx\n---\n```\n\n在你的 <span class = \"purple-target\">主题配置文件</span> 中，找到 `menu` 项，修改为如下：\n\n```yml\nmenu:\n  home: / || home\n  tags: /tags/ || tags\n  categories: /categories/ || th\n  archives: /archives/ || archive\n```\n\n接着确定是否在 `/source/` 目录下是否已经存在 `tags` 和 `categories` 这两个文件夹，如果不存在需要运行以下命令：\n\n```bash\nhexo n page tags\nhexo n page categories\n```\n\n运行之后会在 `/source/` 目录下生成对应的两个文件夹，在文件夹下会存在一个 `index.md` 文件，打开这两个 `index.md` 文件，分别添加 type: tags 和 type: categories，如下：\n\n**/source/tags/index.md**\n```markdown\n---\ntitle: 标签\ndate: 20xx-xx-xx xx:xx:xx\ntype: tags\n---\n```\n\n**/source/categories/index.md**\n```markdown\n---\ntitle: 分类\ndate: 20xx-xx-xx xx:xx:xx\ntype: categories\n---\n```\n\n### 去掉图片边框\n\nNexT主题默认会有图片边框，不太好看，我们可以把边框去掉。打开 `themes\\next\\source\\css\\_custom\\custom.styl`，添加如下 CSS 代码：\n\n```css\n/* 去掉图片边框 */\n.posts-expand .post-body img {\n    border: none;\n    padding: 0px;\n}\n.post-gallery .post-gallery-img img {\n    padding: 3px;\n}\n```\n\n## 参考文章与推荐\n\n### 大佬们的博客\n\n1. [雨临Lewis大大的博客](https://lewky.cn/posts/ef301a4d.html)\n2. [hexo的next主题个性化配置教程](https://segmentfault.com/a/1190000009544924)\n3. [打造个性超赞博客Hexo+NexT+GithubPages的超深度优化](https://io-oi.me/tech/hexo-next-optimization/)\n\n### 在线压缩图片\n\n在博客上的图片尽可能的要压缩一下体积，否则轻则会造成图片加载迟缓，重则会造成页面卡住白屏很久。推荐一个 [在线压缩图片](https://imagecompressor.com/zh/) 的链接，常用的除了 `.gif` 格式的都可以，我觉得挺好用的，独乐乐不如众乐乐~","slug":"Hexo-NexT魔改系列-01-准备工作","published":1,"updated":"2020-01-14T20:30:46.181Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn4z00022lwj81026hk2","content":"<blockquote>\n<p><span class=\"introduction\">要想改变命运，首先改变自己。</span><br><br>本篇博客介绍了如何魔改你的 <code>Hexo NexT</code> 博客的初步配置与常用文件介绍，开始你的魔改之路吧~</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在接下来的所有描述中，我们会经常用到 <span class=\"blue-target\">站点配置文件</span> 与 <span class=\"purple-target\">主题配置文件</span>，这两个文件将分别会用 <span class=\"blue-target\">蓝色标注</span> 与 <span class=\"purple-target\">紫色标注</span> 来标识。<br>其余文件将统一采用如下格式：<code>/themes/next/source/css/_custom/custom.styl</code>，其中 <code>/</code> 代表你的 <strong>Hexo</strong> 博客根目录。</p>\n<h2 id=\"重要配置文件\"><a href=\"#重要配置文件\" class=\"headerlink\" title=\"重要配置文件\"></a>重要配置文件</h2><h3 id=\"站点配置文件\"><a href=\"#站点配置文件\" class=\"headerlink\" title=\"站点配置文件\"></a>站点配置文件</h3><p><span class=\"blue-target\">站点配置文件</span> 是位于 <code>/</code> 下的 <code>_config.yml</code>，我们在里面可以设置：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Site</span></span><br><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">Euphoria's</span> <span class=\"string\">Blog</span> <span class=\"comment\"># 你的博客名称</span></span><br><span class=\"line\"><span class=\"attr\">subtitle:</span> <span class=\"string\">&lt;strong&gt;&lt;font</span> <span class=\"string\">color=\"#FF0000\"&gt;Quitters&lt;/font&gt;</span> <span class=\"string\">Never</span> <span class=\"string\">Win,&lt;br/&gt;</span> <span class=\"string\">&lt;font</span> <span class=\"string\">color=\"#007FFF\"&gt;Winners&lt;/font&gt;</span> <span class=\"string\">Never</span> <span class=\"string\">Quit.&lt;/strong&gt;</span> <span class=\"comment\"># 博客附标题</span></span><br><span class=\"line\"><span class=\"attr\">description:</span> <span class=\"string\">我摸到了&lt;font</span> <span class=\"string\">color=\"#FF0000\"&gt;梦&lt;/font&gt;，&lt;br/&gt;也看到了&lt;font</span> <span class=\"string\">color=\"#007FFF\"&gt;光&lt;/font&gt;。</span> <span class=\"comment\"># 博客简介</span></span><br><span class=\"line\"><span class=\"attr\">keywords:</span> <span class=\"string\">Euphoria</span> <span class=\"comment\"># 博客关键字</span></span><br><span class=\"line\"><span class=\"attr\">author:</span> <span class=\"string\">王钦弘</span> <span class=\"comment\"># 作者信息</span></span><br><span class=\"line\"><span class=\"attr\">language:</span> <span class=\"string\">zh-Hans</span> <span class=\"comment\"># 所用语言</span></span><br><span class=\"line\"><span class=\"attr\">timezone:</span> <span class=\"comment\"># 时区，默认为当前服务器时区</span></span><br></pre></td></tr></table></figure>\n\n<p>其余设置不变，就是在我的 <a href=\"https://www.wqh4u.cn/2019/07/31/Hexo博客的安装与基本配置/\">Hexo博客的安装与基本配置</a> 中所设置的所有东西。</p>\n<div class=\"note info\">\n如果要在这里设置 CSS 样式的话，可以在 custom.styl 中进行全局设置，或者使用     &#60;font&#62; 标签来对其进行修饰，如果使用 &#60;span style = \"xxx\"&#62; 的话，里面的冒号会造成二义性，故不能使用。\n</div>\n\n<h3 id=\"主题配置文件\"><a href=\"#主题配置文件\" class=\"headerlink\" title=\"主题配置文件\"></a>主题配置文件</h3><p><span class=\"purple-target\">主题配置文件</span> 是位于 <code>/themes/next/</code> 下的 <code>_config.yml</code>，这是我们在魔改的时候最常用的一个文件，因为可配置项太多在这里不一一列举，以后的博客中会对所要魔改的项进行解说，其余配置项英语好的小伙伴可以看懂无压力的~</p>\n<h3 id=\"自定义配置文件\"><a href=\"#自定义配置文件\" class=\"headerlink\" title=\"自定义配置文件\"></a>自定义配置文件</h3><p>本系列会使用到大量的 CSS 与 JavaScript 的相关内容，为了更有效率与可观赏性的美化博客，我们将这些美化相关的东西都尽可能地写到一类文件中，方便日后查询与修改。譬如下边的几个文件里，就存放了博客的大部分美化内容：</p>\n<ol>\n<li><code>/themes/next/source/css/_custom/custom.styl</code></li>\n<li><code>/themes/next/source/js/src/custom.js</code></li>\n<li><code>/themes/next/layout/_partials/head/custom-head.swig</code></li>\n<li><code>/themes/next/layout/_custom/custom-foot.swig</code></li>\n</ol>\n<p>如果没有也请不要过于担心，稍后将会带领创建并引入博客主题内配置。</p>\n<h4 id=\"添加-custom-foot-swig-文件\"><a href=\"#添加-custom-foot-swig-文件\" class=\"headerlink\" title=\"添加 custom-foot.swig 文件\"></a>添加 custom-foot.swig 文件</h4><p>在 <code>/themes/next/layout/_custom/</code> 下创建 <code>custom-foot.swig</code> 文件，并加入以下内容：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;# Custom foot in body, Can add script here. #&#125;</span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 自定义的js文件 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"/js/src/custom.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>接着修改 <code>themes\\next\\layout\\_layout.swig</code>，在 &#60;/body&#62; 标签前添加一行代码，表示将我们新添加的 <code>custom-foot.swig</code> 文件包括进去：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">        ....</span><br><span class=\"line\">        &#123;% include '_custom/custom-foot.swig' %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>这个文件的作用是负责引入我们想要的 js 文件，比如其他第三方 js 的 cdn 等等。因为页面在引入 js 文件时是阻塞式的（你也可以设置 async），如果我们在页面的最开始就引入这些 js 文件，而这些文件又比较大，会造成页面在渲染时长时间处于白屏状态。</p>\n<h4 id=\"添加-custom-js-文件\"><a href=\"#添加-custom-js-文件\" class=\"headerlink\" title=\"添加 custom.js 文件\"></a>添加 custom.js 文件</h4><p>在 <code>/themes/next/source/js/src/</code> 目录下添加 <code>custom.js</code> 文件，该文件用来存放我们自己写的 js 函数等等，需要注意的是，我们之前是在 <code>custom-foot.swig</code> 文件中的 &#60;script&#62; 标签里引入了该文件，也就是说，在该文件里，我们不能再自己添加 script 标签了，直接书写 js 函数就行了，如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 轮播背景图片 */</span></span><br><span class=\"line\">$(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    $.backstretch([</span><br><span class=\"line\">        <span class=\"string\">\"/images/background/bg1.jpg\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/images/background/bg2.jpg\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/images/background/bg3.jpg\"</span>,</span><br><span class=\"line\">    ], &#123;<span class=\"attr\">duration</span>: <span class=\"number\">300000</span>, <span class=\"attr\">fade</span>: <span class=\"number\">1500</span>&#125;);</span><br><span class=\"line\">&#125;); <span class=\"comment\">/*这个是背景轮播图，现在暂时可以不用输入*/</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"其它重要文件\"><a href=\"#其它重要文件\" class=\"headerlink\" title=\"其它重要文件\"></a>其它重要文件</h3><h4 id=\"footer-swig\"><a href=\"#footer-swig\" class=\"headerlink\" title=\"footer.swig\"></a>footer.swig</h4><p>这个文件位于 <code>/themes/next/layout/_partials/</code> 下，里面配置了关于页脚（也就是最开始下面有 <strong>Powered by Hexo</strong> 的那一块地方），因为要设置如 <strong>备案号</strong>、<strong>博客全站统计字数</strong>、<strong>博客共计访客</strong> 等等信息，都要在这个文件中进行设置。</p>\n<h4 id=\"sidebar-swig\"><a href=\"#sidebar-swig\" class=\"headerlink\" title=\"sidebar.swig\"></a>sidebar.swig</h4><p>这个文件位于 <code>/themes/next/layout/_custom/</code> 下，里面将会对 <strong>博客已运行时间</strong> 等进行配置。</p>\n<div class=\"note info\">\n上面的所有文件（包括其他没有列举出来的文件）请各位仔细阅读其源码（如果有的话），以便各位可以在今后可以自定义自己的博客样式。\n</div>\n\n<hr>\n\n<h2 id=\"开始页面的简单美化\"><a href=\"#开始页面的简单美化\" class=\"headerlink\" title=\"开始页面的简单美化\"></a>开始页面的简单美化</h2><h3 id=\"改变页面的字体大小\"><a href=\"#改变页面的字体大小\" class=\"headerlink\" title=\"改变页面的字体大小\"></a>改变页面的字体大小</h3><p>打开 <code>\\themes\\next\\source\\css\\_variables\\base.styl</code>，该文件保存了一些基础变量的值，我们找到 <code>$font-size-base</code>，将值改为 <code>16px</code>（我记得默认是 14px，各位根据自己的心情来改）。</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Font size</span><br><span class=\"line\">$font-size-base           = 16px</span><br></pre></td></tr></table></figure>\n\n<p>这个文件里定义了很多常量，有兴趣的可以自己去琢磨琢磨，修改一些其它常量值。</p>\n<h3 id=\"文章启用-tags-和-categories\"><a href=\"#文章启用-tags-和-categories\" class=\"headerlink\" title=\"文章启用 tags 和 categories\"></a>文章启用 tags 和 categories</h3><p>在 <a href=\"https://www.wqh4u.cn/2019/07/31/Hexo博客的安装与基本配置/\">Hexo博客的安装与基本配置</a> 中，没有对增加这两个页面做过多的阐述，在这里将会带领各位创建这两个页面。</p>\n<p>首先，你需要在你的文章中设置 <code>tags</code> 和 <code>categories</code>，具体操作如下：</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: Test</span><br><span class=\"line\">tags:</span><br><span class=\"line\"><span class=\"bullet\">  - </span>YourTag</span><br><span class=\"line\">categories:</span><br><span class=\"line\"><span class=\"bullet\">  - </span>YourCategory</span><br><span class=\"line\">date: 20xx-xx-xx xx:xx:xx</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<p>在你的 <span class=\"purple-target\">主题配置文件</span> 中，找到 <code>menu</code> 项，修改为如下：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">menu:</span></span><br><span class=\"line\">  <span class=\"attr\">home:</span> <span class=\"string\">/</span> <span class=\"string\">||</span> <span class=\"string\">home</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span> <span class=\"string\">/tags/</span> <span class=\"string\">||</span> <span class=\"string\">tags</span></span><br><span class=\"line\">  <span class=\"attr\">categories:</span> <span class=\"string\">/categories/</span> <span class=\"string\">||</span> <span class=\"string\">th</span></span><br><span class=\"line\">  <span class=\"attr\">archives:</span> <span class=\"string\">/archives/</span> <span class=\"string\">||</span> <span class=\"string\">archive</span></span><br></pre></td></tr></table></figure>\n\n<p>接着确定是否在 <code>/source/</code> 目录下是否已经存在 <code>tags</code> 和 <code>categories</code> 这两个文件夹，如果不存在需要运行以下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo n page tags</span><br><span class=\"line\">hexo n page categories</span><br></pre></td></tr></table></figure>\n\n<p>运行之后会在 <code>/source/</code> 目录下生成对应的两个文件夹，在文件夹下会存在一个 <code>index.md</code> 文件，打开这两个 <code>index.md</code> 文件，分别添加 type: tags 和 type: categories，如下：</p>\n<p><strong>/source/tags/index.md</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: 标签</span><br><span class=\"line\">date: 20xx-xx-xx xx:xx:xx</span><br><span class=\"line\">type: tags</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<p><strong>/source/categories/index.md</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: 分类</span><br><span class=\"line\">date: 20xx-xx-xx xx:xx:xx</span><br><span class=\"line\">type: categories</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"去掉图片边框\"><a href=\"#去掉图片边框\" class=\"headerlink\" title=\"去掉图片边框\"></a>去掉图片边框</h3><p>NexT主题默认会有图片边框，不太好看，我们可以把边框去掉。打开 <code>themes\\next\\source\\css\\_custom\\custom.styl</code>，添加如下 CSS 代码：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 去掉图片边框 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.posts-expand</span> <span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">img</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">0px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.post-gallery</span> <span class=\"selector-class\">.post-gallery-img</span> <span class=\"selector-tag\">img</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">3px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"参考文章与推荐\"><a href=\"#参考文章与推荐\" class=\"headerlink\" title=\"参考文章与推荐\"></a>参考文章与推荐</h2><h3 id=\"大佬们的博客\"><a href=\"#大佬们的博客\" class=\"headerlink\" title=\"大佬们的博客\"></a>大佬们的博客</h3><ol>\n<li><a href=\"https://lewky.cn/posts/ef301a4d.html\" target=\"_blank\" rel=\"noopener\">雨临Lewis大大的博客</a></li>\n<li><a href=\"https://segmentfault.com/a/1190000009544924\" target=\"_blank\" rel=\"noopener\">hexo的next主题个性化配置教程</a></li>\n<li><a href=\"https://io-oi.me/tech/hexo-next-optimization/\" target=\"_blank\" rel=\"noopener\">打造个性超赞博客Hexo+NexT+GithubPages的超深度优化</a></li>\n</ol>\n<h3 id=\"在线压缩图片\"><a href=\"#在线压缩图片\" class=\"headerlink\" title=\"在线压缩图片\"></a>在线压缩图片</h3><p>在博客上的图片尽可能的要压缩一下体积，否则轻则会造成图片加载迟缓，重则会造成页面卡住白屏很久。推荐一个 <a href=\"https://imagecompressor.com/zh/\" target=\"_blank\" rel=\"noopener\">在线压缩图片</a> 的链接，常用的除了 <code>.gif</code> 格式的都可以，我觉得挺好用的，独乐乐不如众乐乐~</p>\n","site":{"data":{}},"length":3698,"excerpt":"<blockquote>\n<p><span class=\"introduction\">要想改变命运，首先改变自己。</span><br><br>本篇博客介绍了如何魔改你的 <code>Hexo NexT</code> 博客的初步配置与常用文件介绍，开始你的魔改之路吧~</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在接下来的所有描述中，我们会经常用到 <span class=\"blue-target\">站点配置文件</span> 与 <span class=\"purple-target\">主题配置文件</span>，这两个文件将分别会用 <span class=\"blue-target\">蓝色标注</span> 与 <span class=\"purple-target\">紫色标注</span> 来标识。<br>其余文件将统一采用如下格式：<code>/themes/next/source/css/_custom/custom.styl</code>，其中 <code>/</code> 代表你的 <strong>Hexo</strong> 博客根目录。</p>\n<h2 id=\"重要配置文件\"><a href=\"#重要配置文件\" class=\"headerlink\" title=\"重要配置文件\"></a>重要配置文件</h2><h3 id=\"站点配置文件\"><a href=\"#站点配置文件\" class=\"headerlink\" title=\"站点配置文件\"></a>站点配置文件</h3><p><span class=\"blue-target\">站点配置文件</span> 是位于 <code>/</code> 下的 <code>_config.yml</code>，我们在里面可以设置：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Site</span></span><br><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">Euphoria's</span> <span class=\"string\">Blog</span> <span class=\"comment\"># 你的博客名称</span></span><br><span class=\"line\"><span class=\"attr\">subtitle:</span> <span class=\"string\">&lt;strong&gt;&lt;font</span> <span class=\"string\">color=\"#FF0000\"&gt;Quitters&lt;/font&gt;</span> <span class=\"string\">Never</span> <span class=\"string\">Win,&lt;br/&gt;</span> <span class=\"string\">&lt;font</span> <span class=\"string\">color=\"#007FFF\"&gt;Winners&lt;/font&gt;</span> <span class=\"string\">Never</span> <span class=\"string\">Quit.&lt;/strong&gt;</span> <span class=\"comment\"># 博客附标题</span></span><br><span class=\"line\"><span class=\"attr\">description:</span> <span class=\"string\">我摸到了&lt;font</span> <span class=\"string\">color=\"#FF0000\"&gt;梦&lt;/font&gt;，&lt;br/&gt;也看到了&lt;font</span> <span class=\"string\">color=\"#007FFF\"&gt;光&lt;/font&gt;。</span> <span class=\"comment\"># 博客简介</span></span><br><span class=\"line\"><span class=\"attr\">keywords:</span> <span class=\"string\">Euphoria</span> <span class=\"comment\"># 博客关键字</span></span><br><span class=\"line\"><span class=\"attr\">author:</span> <span class=\"string\">王钦弘</span> <span class=\"comment\"># 作者信息</span></span><br><span class=\"line\"><span class=\"attr\">language:</span> <span class=\"string\">zh-Hans</span> <span class=\"comment\"># 所用语言</span></span><br><span class=\"line\"><span class=\"attr\">timezone:</span> <span class=\"comment\"># 时区，默认为当前服务器时区</span></span><br></pre></td></tr></table></figure>\n\n<p>其余设置不变，就是在我的 <a href=\"https://www.wqh4u.cn/2019/07/31/Hexo博客的安装与基本配置/\">Hexo博客的安装与基本配置</a> 中所设置的所有东西。</p>\n<div class=\"note info\">\n如果要在这里设置 CSS 样式的话，可以在 custom.styl 中进行全局设置，或者使用     &#60;font&#62; 标签来对其进行修饰，如果使用 &#60;span style = \"xxx\"&#62; 的话，里面的冒号会造成二义性，故不能使用。\n</div>\n\n<h3 id=\"主题配置文件\"><a href=\"#主题配置文件\" class=\"headerlink\" title=\"主题配置文件\"></a>主题配置文件</h3><p><span class=\"purple-target\">主题配置文件</span> 是位于 <code>/themes/next/</code> 下的 <code>_config.yml</code>，这是我们在魔改的时候最常用的一个文件，因为可配置项太多在这里不一一列举，以后的博客中会对所要魔改的项进行解说，其余配置项英语好的小伙伴可以看懂无压力的~</p>\n<h3 id=\"自定义配置文件\"><a href=\"#自定义配置文件\" class=\"headerlink\" title=\"自定义配置文件\"></a>自定义配置文件</h3><p>本系列会使用到大量的 CSS 与 JavaScript 的相关内容，为了更有效率与可观赏性的美化博客，我们将这些美化相关的东西都尽可能地写到一类文件中，方便日后查询与修改。譬如下边的几个文件里，就存放了博客的大部分美化内容：</p>\n<ol>\n<li><code>/themes/next/source/css/_custom/custom.styl</code></li>\n<li><code>/themes/next/source/js/src/custom.js</code></li>\n<li><code>/themes/next/layout/_partials/head/custom-head.swig</code></li>\n<li><code>/themes/next/layout/_custom/custom-foot.swig</code></li>\n</ol>\n<p>如果没有也请不要过于担心，稍后将会带领创建并引入博客主题内配置。</p>\n<h4 id=\"添加-custom-foot-swig-文件\"><a href=\"#添加-custom-foot-swig-文件\" class=\"headerlink\" title=\"添加 custom-foot.swig 文件\"></a>添加 custom-foot.swig 文件</h4><p>在 <code>/themes/next/layout/_custom/</code> 下创建 <code>custom-foot.swig</code> 文件，并加入以下内容：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;# Custom foot in body, Can add script here. #&#125;</span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 自定义的js文件 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"/js/src/custom.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>接着修改 <code>themes\\next\\layout\\_layout.swig</code>，在 &#60;/body&#62; 标签前添加一行代码，表示将我们新添加的 <code>custom-foot.swig</code> 文件包括进去：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">        ....</span><br><span class=\"line\">        &#123;% include '_custom/custom-foot.swig' %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>这个文件的作用是负责引入我们想要的 js 文件，比如其他第三方 js 的 cdn 等等。因为页面在引入 js 文件时是阻塞式的（你也可以设置 async），如果我们在页面的最开始就引入这些 js 文件，而这些文件又比较大，会造成页面在渲染时长时间处于白屏状态。</p>\n<h4 id=\"添加-custom-js-文件\"><a href=\"#添加-custom-js-文件\" class=\"headerlink\" title=\"添加 custom.js 文件\"></a>添加 custom.js 文件</h4><p>在 <code>/themes/next/source/js/src/</code> 目录下添加 <code>custom.js</code> 文件，该文件用来存放我们自己写的 js 函数等等，需要注意的是，我们之前是在 <code>custom-foot.swig</code> 文件中的 &#60;script&#62; 标签里引入了该文件，也就是说，在该文件里，我们不能再自己添加 script 标签了，直接书写 js 函数就行了，如下所示：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 轮播背景图片 */</span></span><br><span class=\"line\">$(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    $.backstretch([</span><br><span class=\"line\">        <span class=\"string\">\"/images/background/bg1.jpg\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/images/background/bg2.jpg\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/images/background/bg3.jpg\"</span>,</span><br><span class=\"line\">    ], &#123;<span class=\"attr\">duration</span>: <span class=\"number\">300000</span>, <span class=\"attr\">fade</span>: <span class=\"number\">1500</span>&#125;);</span><br><span class=\"line\">&#125;); <span class=\"comment\">/*这个是背景轮播图，现在暂时可以不用输入*/</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"其它重要文件\"><a href=\"#其它重要文件\" class=\"headerlink\" title=\"其它重要文件\"></a>其它重要文件</h3><h4 id=\"footer-swig\"><a href=\"#footer-swig\" class=\"headerlink\" title=\"footer.swig\"></a>footer.swig</h4><p>这个文件位于 <code>/themes/next/layout/_partials/</code> 下，里面配置了关于页脚（也就是最开始下面有 <strong>Powered by Hexo</strong> 的那一块地方），因为要设置如 <strong>备案号</strong>、<strong>博客全站统计字数</strong>、<strong>博客共计访客</strong> 等等信息，都要在这个文件中进行设置。</p>\n<h4 id=\"sidebar-swig\"><a href=\"#sidebar-swig\" class=\"headerlink\" title=\"sidebar.swig\"></a>sidebar.swig</h4><p>这个文件位于 <code>/themes/next/layout/_custom/</code> 下，里面将会对 <strong>博客已运行时间</strong> 等进行配置。</p>\n<div class=\"note info\">\n上面的所有文件（包括其他没有列举出来的文件）请各位仔细阅读其源码（如果有的话），以便各位可以在今后可以自定义自己的博客样式。\n</div>\n\n<hr>\n\n<h2 id=\"开始页面的简单美化\"><a href=\"#开始页面的简单美化\" class=\"headerlink\" title=\"开始页面的简单美化\"></a>开始页面的简单美化</h2><h3 id=\"改变页面的字体大小\"><a href=\"#改变页面的字体大小\" class=\"headerlink\" title=\"改变页面的字体大小\"></a>改变页面的字体大小</h3><p>打开 <code>\\themes\\next\\source\\css\\_variables\\base.styl</code>，该文件保存了一些基础变量的值，我们找到 <code>$font-size-base</code>，将值改为 <code>16px</code>（我记得默认是 14px，各位根据自己的心情来改）。</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Font size</span><br><span class=\"line\">$font-size-base           = 16px</span><br></pre></td></tr></table></figure>\n\n<p>这个文件里定义了很多常量，有兴趣的可以自己去琢磨琢磨，修改一些其它常量值。</p>\n<h3 id=\"文章启用-tags-和-categories\"><a href=\"#文章启用-tags-和-categories\" class=\"headerlink\" title=\"文章启用 tags 和 categories\"></a>文章启用 tags 和 categories</h3><p>在 <a href=\"https://www.wqh4u.cn/2019/07/31/Hexo博客的安装与基本配置/\">Hexo博客的安装与基本配置</a> 中，没有对增加这两个页面做过多的阐述，在这里将会带领各位创建这两个页面。</p>\n<p>首先，你需要在你的文章中设置 <code>tags</code> 和 <code>categories</code>，具体操作如下：</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: Test</span><br><span class=\"line\">tags:</span><br><span class=\"line\"><span class=\"bullet\">  - </span>YourTag</span><br><span class=\"line\">categories:</span><br><span class=\"line\"><span class=\"bullet\">  - </span>YourCategory</span><br><span class=\"line\">date: 20xx-xx-xx xx:xx:xx</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<p>在你的 <span class=\"purple-target\">主题配置文件</span> 中，找到 <code>menu</code> 项，修改为如下：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">menu:</span></span><br><span class=\"line\">  <span class=\"attr\">home:</span> <span class=\"string\">/</span> <span class=\"string\">||</span> <span class=\"string\">home</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span> <span class=\"string\">/tags/</span> <span class=\"string\">||</span> <span class=\"string\">tags</span></span><br><span class=\"line\">  <span class=\"attr\">categories:</span> <span class=\"string\">/categories/</span> <span class=\"string\">||</span> <span class=\"string\">th</span></span><br><span class=\"line\">  <span class=\"attr\">archives:</span> <span class=\"string\">/archives/</span> <span class=\"string\">||</span> <span class=\"string\">archive</span></span><br></pre></td></tr></table></figure>\n\n<p>接着确定是否在 <code>/source/</code> 目录下是否已经存在 <code>tags</code> 和 <code>categories</code> 这两个文件夹，如果不存在需要运行以下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo n page tags</span><br><span class=\"line\">hexo n page categories</span><br></pre></td></tr></table></figure>\n\n<p>运行之后会在 <code>/source/</code> 目录下生成对应的两个文件夹，在文件夹下会存在一个 <code>index.md</code> 文件，打开这两个 <code>index.md</code> 文件，分别添加 type: tags 和 type: categories，如下：</p>\n<p><strong>/source/tags/index.md</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: 标签</span><br><span class=\"line\">date: 20xx-xx-xx xx:xx:xx</span><br><span class=\"line\">type: tags</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<p><strong>/source/categories/index.md</strong></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">title: 分类</span><br><span class=\"line\">date: 20xx-xx-xx xx:xx:xx</span><br><span class=\"line\">type: categories</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"去掉图片边框\"><a href=\"#去掉图片边框\" class=\"headerlink\" title=\"去掉图片边框\"></a>去掉图片边框</h3><p>NexT主题默认会有图片边框，不太好看，我们可以把边框去掉。打开 <code>themes\\next\\source\\css\\_custom\\custom.styl</code>，添加如下 CSS 代码：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 去掉图片边框 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.posts-expand</span> <span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">img</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: none;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">0px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.post-gallery</span> <span class=\"selector-class\">.post-gallery-img</span> <span class=\"selector-tag\">img</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">3px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"参考文章与推荐\"><a href=\"#参考文章与推荐\" class=\"headerlink\" title=\"参考文章与推荐\"></a>参考文章与推荐</h2><h3 id=\"大佬们的博客\"><a href=\"#大佬们的博客\" class=\"headerlink\" title=\"大佬们的博客\"></a>大佬们的博客</h3><ol>\n<li><a href=\"https://lewky.cn/posts/ef301a4d.html\" target=\"_blank\" rel=\"noopener\">雨临Lewis大大的博客</a></li>\n<li><a href=\"https://segmentfault.com/a/1190000009544924\" target=\"_blank\" rel=\"noopener\">hexo的next主题个性化配置教程</a></li>\n<li><a href=\"https://io-oi.me/tech/hexo-next-optimization/\" target=\"_blank\" rel=\"noopener\">打造个性超赞博客Hexo+NexT+GithubPages的超深度优化</a></li>\n</ol>\n<h3 id=\"在线压缩图片\"><a href=\"#在线压缩图片\" class=\"headerlink\" title=\"在线压缩图片\"></a>在线压缩图片</h3><p>在博客上的图片尽可能的要压缩一下体积，否则轻则会造成图片加载迟缓，重则会造成页面卡住白屏很久。推荐一个 <a href=\"https://imagecompressor.com/zh/\" target=\"_blank\" rel=\"noopener\">在线压缩图片</a> 的链接，常用的除了 <code>.gif</code> 格式的都可以，我觉得挺好用的，独乐乐不如众乐乐~</p>"},{"title":"Hexo-NexT魔改系列-02-配置博客背景轮播图","date":"2019-09-10T04:44:56.000Z","copyright":true,"_content":"\n> <span class = 'introduction'>生命不在长而在于好，只要每一次尽力的演示，都值得鼓励与喝采。</span><br/>\n本篇博客主要介绍了如何给你的博客加上 `背景轮播图` 及其所需要注意的事项，一步一步地美化你的博客吧!\n\n<!--more-->\n\n## 了解动态背景图片插件 `jquery-backstretch`\n\n`jquery-backstretch` 是一款简单的 jQuery 插件，可以用来设置动态的背景图片，以下是官方网站的介绍。\n\n > A simple jQuery plugin that allows you to add a dynamically-resized, slideshow-capable background image to any page or element.\n \n 可以直接在页面中引入该插件的 `cdn` 来调用函数，也可以直接下载下来使用，这是 [官方地址](https://www.bootcdn.cn/jquery-backstretch/)。\n \n ## `jquery-backstretch` 的使用方法\n \n ### 引入该插件的cdn\n \n 打开我们在 [上个Blog](https://www.wqh4u.cn/2019/09/08/Hexo-NexT魔改系列-01-准备工作/) 中提到的 `\\themes\\next\\layout\\_custom\\custom-foot.swig`，引入该背景图片插件的 cdn：\n \n ```html\n{#Custom foot in body, Can add script here.#}\n<!-- 图片轮播js文件cdn -->\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js\"></script>\n\n<!-- 自定义的js文件 -->\n<script type=\"text/javascript\" src=\"/js/src/custom.js\"></script>\n ```\n \n 需要注意的是，我们要引入的插件cdn，都需要在自定义的js文件 `custom.js` 之前引入才行！否则，当加载 `custom.js` 文件内部的 backstretch 插件会在访问页面时无法生效，可以在浏览器的控制台看到报错。\n \n ### 调用 `backstretch` 函数\n \n 在 `\\themes\\next\\source\\js\\src\\custom.js` 中添加如下代码：\n\n```javascript\n/* 轮播背景图片 */\n$(function () {\n    $.backstretch([\n        \"/images/background/bg1.jpg\",\n        \"/images/background/bg2.jpg\",\n        \"/images/background/bg3.jpg\",\n    ], {duration: 6000, fade: 1500});\n});\n```\n\n这里可以随意添加你想要轮播的图片，但要确保图片路径是正确的，比如我的背景图片就存放在站点根目录下的 `/images/background/` 目录下。\n\n其中 `duration` 指的是轮换图片的时间，单位是毫秒，也就是说这里的代码表示一分钟就轮换到下一张图。\n\n`fade` 指的是轮换图片时会有个渐进渐出的动作，而这个过程需要花费的时间单位也是毫秒，如果不加上这个参数，就表示离开轮换成下一张图片。\n\n注意这里的 `$.backstretch` 指的是对整个页面设置背景图片，我们也可以专门给某个元素设置背景图片，如下：\n\n```javascript\n$(function () {\n    $(\".euphoira1\").backstretch([\"/images/background/euphoira1.jpg\"]);  \n    $(\".euphoria2\").backstretch([\"/images/background/euphoira2.jpg\"]);  \n});\n```\n\n如果只有一张图片，就没必要设置 `duration` 和 `fade` 参数了。\n\n### 为背景图片设置样式\n\n虽然我们设置好了背景图片，但如果页面的许多元素是不透明的，背景图片可能并不能很好地被看见，所以我们可以对背景图片和其他的页面元素进行设置样式。\n\n首先为背景图片设置透明度，因为有的图片颜色比较深厚，而页面多为白色，然后造成喧宾夺主的感觉。\n\n修改 `\\themes\\next\\source\\css\\_custom\\custom.styl`，添加以下代码：\n\n```css\n/* 背景图片透明度 */\n.backstretch {\n    opacity: .75;\n}\n\n/* 页面透明度 */\n.content-wrap, .sidebar {\n    opacity: .9 !important;\n}\n.header-inner {\n    background: rgba(255, 255, 255, 0.9) !important;\n}\n```\n\n至此，`hexo clean` 与 `hexo g` 二连一下，你就可以在你的博客中看到你自己设置的好看的背景图片了~\n\n## 有一些需要注意的点\n\n我们在加载博客的时候，可以按 `F12` 查看一下加载元素的日志信息：\n\n<img src = \"./F12.jpg\" alt = \"F12.jpg\"/>\n\n可以看到它会在第一次加载你的博客任意界面的时候，以队列形式将你所设置的多张背景图一次性加载完成。\n\n如果你有在 [这篇博客](http://www.wqh4u.cn/2019/09/04/设置你喜欢的live2d看板娘/) 中配置了你的高级版本 **Live 2D 看板娘** 的话，你会发现如果你的背景图没有加载完成，你的看板娘是不会出来的，那么就需要利用 [压缩图片](https://imagecompressor.com/zh/) 来压缩你的背景图片以提高加载速率。<del>或者你也可以升级你的服务器</del>\n\n## 参考文章\n\n本篇博客参考了 [雨临Lewis大大的博客](https://lewky.cn/posts/ef301a4d.html) 中的 [Hexo瞎折腾系列(2) - 添加背景图片轮播](https://lewky.cn/posts/576ee548.html)，本站点的很多样式都是基于他的博客来实现的，感兴趣的的小伙伴可以深入阅读一下雨临Lewis大大的博客哦~","source":"_posts/Hexo-NexT魔改系列-02-配置博客背景轮播图.md","raw":"---\ntitle: Hexo-NexT魔改系列-02-配置博客背景轮播图\ndate: 2019-09-10 12:44:56\ntags:\n- Hexo\n- NexT\n- 魔改\n- 瞎折腾\ncategories:\n- Hexo\n- NexT\n- 魔改\ncopyright: true\n---\n\n> <span class = 'introduction'>生命不在长而在于好，只要每一次尽力的演示，都值得鼓励与喝采。</span><br/>\n本篇博客主要介绍了如何给你的博客加上 `背景轮播图` 及其所需要注意的事项，一步一步地美化你的博客吧!\n\n<!--more-->\n\n## 了解动态背景图片插件 `jquery-backstretch`\n\n`jquery-backstretch` 是一款简单的 jQuery 插件，可以用来设置动态的背景图片，以下是官方网站的介绍。\n\n > A simple jQuery plugin that allows you to add a dynamically-resized, slideshow-capable background image to any page or element.\n \n 可以直接在页面中引入该插件的 `cdn` 来调用函数，也可以直接下载下来使用，这是 [官方地址](https://www.bootcdn.cn/jquery-backstretch/)。\n \n ## `jquery-backstretch` 的使用方法\n \n ### 引入该插件的cdn\n \n 打开我们在 [上个Blog](https://www.wqh4u.cn/2019/09/08/Hexo-NexT魔改系列-01-准备工作/) 中提到的 `\\themes\\next\\layout\\_custom\\custom-foot.swig`，引入该背景图片插件的 cdn：\n \n ```html\n{#Custom foot in body, Can add script here.#}\n<!-- 图片轮播js文件cdn -->\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js\"></script>\n\n<!-- 自定义的js文件 -->\n<script type=\"text/javascript\" src=\"/js/src/custom.js\"></script>\n ```\n \n 需要注意的是，我们要引入的插件cdn，都需要在自定义的js文件 `custom.js` 之前引入才行！否则，当加载 `custom.js` 文件内部的 backstretch 插件会在访问页面时无法生效，可以在浏览器的控制台看到报错。\n \n ### 调用 `backstretch` 函数\n \n 在 `\\themes\\next\\source\\js\\src\\custom.js` 中添加如下代码：\n\n```javascript\n/* 轮播背景图片 */\n$(function () {\n    $.backstretch([\n        \"/images/background/bg1.jpg\",\n        \"/images/background/bg2.jpg\",\n        \"/images/background/bg3.jpg\",\n    ], {duration: 6000, fade: 1500});\n});\n```\n\n这里可以随意添加你想要轮播的图片，但要确保图片路径是正确的，比如我的背景图片就存放在站点根目录下的 `/images/background/` 目录下。\n\n其中 `duration` 指的是轮换图片的时间，单位是毫秒，也就是说这里的代码表示一分钟就轮换到下一张图。\n\n`fade` 指的是轮换图片时会有个渐进渐出的动作，而这个过程需要花费的时间单位也是毫秒，如果不加上这个参数，就表示离开轮换成下一张图片。\n\n注意这里的 `$.backstretch` 指的是对整个页面设置背景图片，我们也可以专门给某个元素设置背景图片，如下：\n\n```javascript\n$(function () {\n    $(\".euphoira1\").backstretch([\"/images/background/euphoira1.jpg\"]);  \n    $(\".euphoria2\").backstretch([\"/images/background/euphoira2.jpg\"]);  \n});\n```\n\n如果只有一张图片，就没必要设置 `duration` 和 `fade` 参数了。\n\n### 为背景图片设置样式\n\n虽然我们设置好了背景图片，但如果页面的许多元素是不透明的，背景图片可能并不能很好地被看见，所以我们可以对背景图片和其他的页面元素进行设置样式。\n\n首先为背景图片设置透明度，因为有的图片颜色比较深厚，而页面多为白色，然后造成喧宾夺主的感觉。\n\n修改 `\\themes\\next\\source\\css\\_custom\\custom.styl`，添加以下代码：\n\n```css\n/* 背景图片透明度 */\n.backstretch {\n    opacity: .75;\n}\n\n/* 页面透明度 */\n.content-wrap, .sidebar {\n    opacity: .9 !important;\n}\n.header-inner {\n    background: rgba(255, 255, 255, 0.9) !important;\n}\n```\n\n至此，`hexo clean` 与 `hexo g` 二连一下，你就可以在你的博客中看到你自己设置的好看的背景图片了~\n\n## 有一些需要注意的点\n\n我们在加载博客的时候，可以按 `F12` 查看一下加载元素的日志信息：\n\n<img src = \"./F12.jpg\" alt = \"F12.jpg\"/>\n\n可以看到它会在第一次加载你的博客任意界面的时候，以队列形式将你所设置的多张背景图一次性加载完成。\n\n如果你有在 [这篇博客](http://www.wqh4u.cn/2019/09/04/设置你喜欢的live2d看板娘/) 中配置了你的高级版本 **Live 2D 看板娘** 的话，你会发现如果你的背景图没有加载完成，你的看板娘是不会出来的，那么就需要利用 [压缩图片](https://imagecompressor.com/zh/) 来压缩你的背景图片以提高加载速率。<del>或者你也可以升级你的服务器</del>\n\n## 参考文章\n\n本篇博客参考了 [雨临Lewis大大的博客](https://lewky.cn/posts/ef301a4d.html) 中的 [Hexo瞎折腾系列(2) - 添加背景图片轮播](https://lewky.cn/posts/576ee548.html)，本站点的很多样式都是基于他的博客来实现的，感兴趣的的小伙伴可以深入阅读一下雨临Lewis大大的博客哦~","slug":"Hexo-NexT魔改系列-02-配置博客背景轮播图","published":1,"updated":"2020-01-14T20:30:46.297Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn5700062lwj7ivud9z9","content":"<blockquote>\n<p><span class=\"introduction\">生命不在长而在于好，只要每一次尽力的演示，都值得鼓励与喝采。</span><br><br>本篇博客主要介绍了如何给你的博客加上 <code>背景轮播图</code> 及其所需要注意的事项，一步一步地美化你的博客吧!</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<h2 id=\"了解动态背景图片插件-jquery-backstretch\"><a href=\"#了解动态背景图片插件-jquery-backstretch\" class=\"headerlink\" title=\"了解动态背景图片插件 jquery-backstretch\"></a>了解动态背景图片插件 <code>jquery-backstretch</code></h2><p><code>jquery-backstretch</code> 是一款简单的 jQuery 插件，可以用来设置动态的背景图片，以下是官方网站的介绍。</p>\n<blockquote>\n<p>A simple jQuery plugin that allows you to add a dynamically-resized, slideshow-capable background image to any page or element.</p>\n</blockquote>\n<p> 可以直接在页面中引入该插件的 <code>cdn</code> 来调用函数，也可以直接下载下来使用，这是 <a href=\"https://www.bootcdn.cn/jquery-backstretch/\" target=\"_blank\" rel=\"noopener\">官方地址</a>。</p>\n<h2 id=\"jquery-backstretch-的使用方法\"><a href=\"#jquery-backstretch-的使用方法\" class=\"headerlink\" title=\"jquery-backstretch 的使用方法\"></a><code>jquery-backstretch</code> 的使用方法</h2><h3 id=\"引入该插件的cdn\"><a href=\"#引入该插件的cdn\" class=\"headerlink\" title=\"引入该插件的cdn\"></a>引入该插件的cdn</h3><p> 打开我们在 <a href=\"https://www.wqh4u.cn/2019/09/08/Hexo-NexT魔改系列-01-准备工作/\">上个Blog</a> 中提到的 <code>\\themes\\next\\layout\\_custom\\custom-foot.swig</code>，引入该背景图片插件的 cdn：</p>\n <figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;#Custom foot in body, Can add script here.#&#125;</span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 图片轮播js文件cdn --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 自定义的js文件 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"/js/src/custom.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p> 需要注意的是，我们要引入的插件cdn，都需要在自定义的js文件 <code>custom.js</code> 之前引入才行！否则，当加载 <code>custom.js</code> 文件内部的 backstretch 插件会在访问页面时无法生效，可以在浏览器的控制台看到报错。</p>\n<h3 id=\"调用-backstretch-函数\"><a href=\"#调用-backstretch-函数\" class=\"headerlink\" title=\"调用 backstretch 函数\"></a>调用 <code>backstretch</code> 函数</h3><p> 在 <code>\\themes\\next\\source\\js\\src\\custom.js</code> 中添加如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 轮播背景图片 */</span></span><br><span class=\"line\">$(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    $.backstretch([</span><br><span class=\"line\">        <span class=\"string\">\"/images/background/bg1.jpg\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/images/background/bg2.jpg\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/images/background/bg3.jpg\"</span>,</span><br><span class=\"line\">    ], &#123;<span class=\"attr\">duration</span>: <span class=\"number\">6000</span>, <span class=\"attr\">fade</span>: <span class=\"number\">1500</span>&#125;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>这里可以随意添加你想要轮播的图片，但要确保图片路径是正确的，比如我的背景图片就存放在站点根目录下的 <code>/images/background/</code> 目录下。</p>\n<p>其中 <code>duration</code> 指的是轮换图片的时间，单位是毫秒，也就是说这里的代码表示一分钟就轮换到下一张图。</p>\n<p><code>fade</code> 指的是轮换图片时会有个渐进渐出的动作，而这个过程需要花费的时间单位也是毫秒，如果不加上这个参数，就表示离开轮换成下一张图片。</p>\n<p>注意这里的 <code>$.backstretch</code> 指的是对整个页面设置背景图片，我们也可以专门给某个元素设置背景图片，如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    $(<span class=\"string\">\".euphoira1\"</span>).backstretch([<span class=\"string\">\"/images/background/euphoira1.jpg\"</span>]);  </span><br><span class=\"line\">    $(<span class=\"string\">\".euphoria2\"</span>).backstretch([<span class=\"string\">\"/images/background/euphoira2.jpg\"</span>]);  </span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>如果只有一张图片，就没必要设置 <code>duration</code> 和 <code>fade</code> 参数了。</p>\n<h3 id=\"为背景图片设置样式\"><a href=\"#为背景图片设置样式\" class=\"headerlink\" title=\"为背景图片设置样式\"></a>为背景图片设置样式</h3><p>虽然我们设置好了背景图片，但如果页面的许多元素是不透明的，背景图片可能并不能很好地被看见，所以我们可以对背景图片和其他的页面元素进行设置样式。</p>\n<p>首先为背景图片设置透明度，因为有的图片颜色比较深厚，而页面多为白色，然后造成喧宾夺主的感觉。</p>\n<p>修改 <code>\\themes\\next\\source\\css\\_custom\\custom.styl</code>，添加以下代码：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 背景图片透明度 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.backstretch</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>: .<span class=\"number\">75</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 页面透明度 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.content-wrap</span>, <span class=\"selector-class\">.sidebar</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>: .<span class=\"number\">9</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.header-inner</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">0.9</span>) <span class=\"meta\">!important</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>至此，<code>hexo clean</code> 与 <code>hexo g</code> 二连一下，你就可以在你的博客中看到你自己设置的好看的背景图片了~</p>\n<h2 id=\"有一些需要注意的点\"><a href=\"#有一些需要注意的点\" class=\"headerlink\" title=\"有一些需要注意的点\"></a>有一些需要注意的点</h2><p>我们在加载博客的时候，可以按 <code>F12</code> 查看一下加载元素的日志信息：</p>\n<img src=\"/2019/09/10/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-02-%E9%85%8D%E7%BD%AE%E5%8D%9A%E5%AE%A2%E8%83%8C%E6%99%AF%E8%BD%AE%E6%92%AD%E5%9B%BE/F12.jpg\" alt=\"F12.jpg\">\n\n<p>可以看到它会在第一次加载你的博客任意界面的时候，以队列形式将你所设置的多张背景图一次性加载完成。</p>\n<p>如果你有在 <a href=\"http://www.wqh4u.cn/2019/09/04/设置你喜欢的live2d看板娘/\">这篇博客</a> 中配置了你的高级版本 <strong>Live 2D 看板娘</strong> 的话，你会发现如果你的背景图没有加载完成，你的看板娘是不会出来的，那么就需要利用 <a href=\"https://imagecompressor.com/zh/\" target=\"_blank\" rel=\"noopener\">压缩图片</a> 来压缩你的背景图片以提高加载速率。<del>或者你也可以升级你的服务器</del></p>\n<h2 id=\"参考文章\"><a href=\"#参考文章\" class=\"headerlink\" title=\"参考文章\"></a>参考文章</h2><p>本篇博客参考了 <a href=\"https://lewky.cn/posts/ef301a4d.html\" target=\"_blank\" rel=\"noopener\">雨临Lewis大大的博客</a> 中的 <a href=\"https://lewky.cn/posts/576ee548.html\" target=\"_blank\" rel=\"noopener\">Hexo瞎折腾系列(2) - 添加背景图片轮播</a>，本站点的很多样式都是基于他的博客来实现的，感兴趣的的小伙伴可以深入阅读一下雨临Lewis大大的博客哦~</p>\n","site":{"data":{}},"length":2217,"excerpt":"<blockquote>\n<p><span class=\"introduction\">生命不在长而在于好，只要每一次尽力的演示，都值得鼓励与喝采。</span><br><br>本篇博客主要介绍了如何给你的博客加上 <code>背景轮播图</code> 及其所需要注意的事项，一步一步地美化你的博客吧!</p>\n</blockquote>","more":"<h2 id=\"了解动态背景图片插件-jquery-backstretch\"><a href=\"#了解动态背景图片插件-jquery-backstretch\" class=\"headerlink\" title=\"了解动态背景图片插件 jquery-backstretch\"></a>了解动态背景图片插件 <code>jquery-backstretch</code></h2><p><code>jquery-backstretch</code> 是一款简单的 jQuery 插件，可以用来设置动态的背景图片，以下是官方网站的介绍。</p>\n<blockquote>\n<p>A simple jQuery plugin that allows you to add a dynamically-resized, slideshow-capable background image to any page or element.</p>\n</blockquote>\n<p> 可以直接在页面中引入该插件的 <code>cdn</code> 来调用函数，也可以直接下载下来使用，这是 <a href=\"https://www.bootcdn.cn/jquery-backstretch/\" target=\"_blank\" rel=\"noopener\">官方地址</a>。</p>\n<h2 id=\"jquery-backstretch-的使用方法\"><a href=\"#jquery-backstretch-的使用方法\" class=\"headerlink\" title=\"jquery-backstretch 的使用方法\"></a><code>jquery-backstretch</code> 的使用方法</h2><h3 id=\"引入该插件的cdn\"><a href=\"#引入该插件的cdn\" class=\"headerlink\" title=\"引入该插件的cdn\"></a>引入该插件的cdn</h3><p> 打开我们在 <a href=\"https://www.wqh4u.cn/2019/09/08/Hexo-NexT魔改系列-01-准备工作/\">上个Blog</a> 中提到的 <code>\\themes\\next\\layout\\_custom\\custom-foot.swig</code>，引入该背景图片插件的 cdn：</p>\n <figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;#Custom foot in body, Can add script here.#&#125;</span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 图片轮播js文件cdn --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 自定义的js文件 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"/js/src/custom.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p> 需要注意的是，我们要引入的插件cdn，都需要在自定义的js文件 <code>custom.js</code> 之前引入才行！否则，当加载 <code>custom.js</code> 文件内部的 backstretch 插件会在访问页面时无法生效，可以在浏览器的控制台看到报错。</p>\n<h3 id=\"调用-backstretch-函数\"><a href=\"#调用-backstretch-函数\" class=\"headerlink\" title=\"调用 backstretch 函数\"></a>调用 <code>backstretch</code> 函数</h3><p> 在 <code>\\themes\\next\\source\\js\\src\\custom.js</code> 中添加如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 轮播背景图片 */</span></span><br><span class=\"line\">$(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    $.backstretch([</span><br><span class=\"line\">        <span class=\"string\">\"/images/background/bg1.jpg\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/images/background/bg2.jpg\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"/images/background/bg3.jpg\"</span>,</span><br><span class=\"line\">    ], &#123;<span class=\"attr\">duration</span>: <span class=\"number\">6000</span>, <span class=\"attr\">fade</span>: <span class=\"number\">1500</span>&#125;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>这里可以随意添加你想要轮播的图片，但要确保图片路径是正确的，比如我的背景图片就存放在站点根目录下的 <code>/images/background/</code> 目录下。</p>\n<p>其中 <code>duration</code> 指的是轮换图片的时间，单位是毫秒，也就是说这里的代码表示一分钟就轮换到下一张图。</p>\n<p><code>fade</code> 指的是轮换图片时会有个渐进渐出的动作，而这个过程需要花费的时间单位也是毫秒，如果不加上这个参数，就表示离开轮换成下一张图片。</p>\n<p>注意这里的 <code>$.backstretch</code> 指的是对整个页面设置背景图片，我们也可以专门给某个元素设置背景图片，如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    $(<span class=\"string\">\".euphoira1\"</span>).backstretch([<span class=\"string\">\"/images/background/euphoira1.jpg\"</span>]);  </span><br><span class=\"line\">    $(<span class=\"string\">\".euphoria2\"</span>).backstretch([<span class=\"string\">\"/images/background/euphoira2.jpg\"</span>]);  </span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>如果只有一张图片，就没必要设置 <code>duration</code> 和 <code>fade</code> 参数了。</p>\n<h3 id=\"为背景图片设置样式\"><a href=\"#为背景图片设置样式\" class=\"headerlink\" title=\"为背景图片设置样式\"></a>为背景图片设置样式</h3><p>虽然我们设置好了背景图片，但如果页面的许多元素是不透明的，背景图片可能并不能很好地被看见，所以我们可以对背景图片和其他的页面元素进行设置样式。</p>\n<p>首先为背景图片设置透明度，因为有的图片颜色比较深厚，而页面多为白色，然后造成喧宾夺主的感觉。</p>\n<p>修改 <code>\\themes\\next\\source\\css\\_custom\\custom.styl</code>，添加以下代码：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 背景图片透明度 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.backstretch</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>: .<span class=\"number\">75</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 页面透明度 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.content-wrap</span>, <span class=\"selector-class\">.sidebar</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">opacity</span>: .<span class=\"number\">9</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.header-inner</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">0.9</span>) <span class=\"meta\">!important</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>至此，<code>hexo clean</code> 与 <code>hexo g</code> 二连一下，你就可以在你的博客中看到你自己设置的好看的背景图片了~</p>\n<h2 id=\"有一些需要注意的点\"><a href=\"#有一些需要注意的点\" class=\"headerlink\" title=\"有一些需要注意的点\"></a>有一些需要注意的点</h2><p>我们在加载博客的时候，可以按 <code>F12</code> 查看一下加载元素的日志信息：</p>\n<img src=\"/2019/09/10/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-02-%E9%85%8D%E7%BD%AE%E5%8D%9A%E5%AE%A2%E8%83%8C%E6%99%AF%E8%BD%AE%E6%92%AD%E5%9B%BE/F12.jpg\" alt=\"F12.jpg\">\n\n<p>可以看到它会在第一次加载你的博客任意界面的时候，以队列形式将你所设置的多张背景图一次性加载完成。</p>\n<p>如果你有在 <a href=\"http://www.wqh4u.cn/2019/09/04/设置你喜欢的live2d看板娘/\">这篇博客</a> 中配置了你的高级版本 <strong>Live 2D 看板娘</strong> 的话，你会发现如果你的背景图没有加载完成，你的看板娘是不会出来的，那么就需要利用 <a href=\"https://imagecompressor.com/zh/\" target=\"_blank\" rel=\"noopener\">压缩图片</a> 来压缩你的背景图片以提高加载速率。<del>或者你也可以升级你的服务器</del></p>\n<h2 id=\"参考文章\"><a href=\"#参考文章\" class=\"headerlink\" title=\"参考文章\"></a>参考文章</h2><p>本篇博客参考了 <a href=\"https://lewky.cn/posts/ef301a4d.html\" target=\"_blank\" rel=\"noopener\">雨临Lewis大大的博客</a> 中的 <a href=\"https://lewky.cn/posts/576ee548.html\" target=\"_blank\" rel=\"noopener\">Hexo瞎折腾系列(2) - 添加背景图片轮播</a>，本站点的很多样式都是基于他的博客来实现的，感兴趣的的小伙伴可以深入阅读一下雨临Lewis大大的博客哦~</p>"},{"title":"Hexo-NexT魔改系列-03-添加数据统计","date":"2019-09-14T17:39:35.000Z","copyright":true,"_content":"\n\n> <span class = 'introduction'>志向不过是记忆的奴隶，生气勃勃地降生，但却很难成长。</span><br/>\n本篇博客主要介绍了如何给你的博客加上 `各种统计信息` 及其所需要注意的事项，一步一步地美化你的博客吧!\n\n<!--more-->\n\n## 添加博客访问人数统计\n\n在这里我们使用的是 `busuanzi插件`，最终效果图如下：\n\n<div style = \"text-align: center;\">\n    <img src = \"busuanzi.png\" alt = \"busuanzi\"></img>\n</div>\n\n在你的 `\\themes\\next\\source\\js\\` 中创建一个文件，名称为 `busuanzi.pure.min.js`，然后打开 [这个网页](http://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js)，将里面的内容拷贝到刚刚你创建的那个文件中，保存。\n\n然后打开 `\\themes\\next\\layout\\_partials\\footer.swig` 这个文件，在第一行加入以下代码：\n\n```html\n<script async src=\"/js/src/busuanzi.pure.mini.js\"></script>\n```\n\n在这个文件中，之前在 [这篇博客]() 中注释了一些代码，然后我们在这个位置添加如下代码：\n\n```html\n<span id=\"busuanzi_container_site_pv\">\n      <span class=\"post-meta-item-text\">博客全站共计访客&#58;</span>\n    <span id=\"busuanzi_value_site_pv\"></span> 人\n</span>\n\n<!--\n{% if theme.footer.powered %}\n  <div class=\"powered-by\">{#\n  #}{{ __('footer.powered', '<a class=\"theme-link\" target=\"_blank\" href=\"https://hexo.io\">Hexo</a>') }}{#\n#}</div>\n{% endif %}\n......\n```\n\n其中注意 `busuanzi_container_site_pv` 这个 id，当后面是 `pv` 的时候，你每刷新一次页面就会多一个访客量。如果不喜欢这样的话可以换成 `uv`，意思是每个用户访问多个页面只记录一次。（记得把两个 id 都要改啊！）\n\n然后 `hexo clean` 与 `hexo g` 二连即可。\n\n## 添加博客文章字数统计\n\n`NexT` 主题默认集成了 `post_wordcount` 插件，我们可以在 <span class = \"purple-target\">主题配置文件</span> 中找到它，并修改为：\n\n```yml\n# Post wordcount display settings\n# Dependencies: https://github.com/willin/hexo-wordcount\npost_wordcount:\n  item_text: true\n  wordcount: true         # 单篇 字数统计\n  min2read: true          # 单篇 阅读时长\n  totalcount: true       # 网站 字数统计\n  separated_meta: true\n```\n\n然后在 <span class = \"red-target\">博客根目录</span> 下，利用 npm 安装一个插件：\n\n```bash\nnpm i --save hexo-wordcount\n```\n\n然后打开 `\\themes\\next\\layout\\_partials\\footer.swig` 这个文件，在上面加入的博客访客量之前，加入以下代码：\n\n```html\n<span class=\"post-meta-item-text\">{# {{ __('post.totalcount') }} #}博客全站共&#58;</span>\n<span title=\"{{ __('post.totalcount') }}\">\n{##}{{ totalcount(site, '0,0.0a') }} 字&nbsp;|&nbsp;{##}\n</span>\n```\n\n在页脚就形成了这样的样式：\n\n<div style = \"text-align: center;\">\n    <img src = \"busuanzi.png\" alt = \"busuanzi\"></img>\n</div>\n\n同时你也会看到在你的每一篇博客中也会有详细的字数统计与阅读时间：\n\n<div style = \"text-align: center;\">\n    <img src = \"title.png\" alt = \"title\"></img>\n</div>\n\n如果要修改这个样式的话，请打开 `/themes/next/layout/_macro/post.swig` 文件，修改【字数统计】，找到如下代码：\n\n```html\n<span title=\"{{ __('post.wordcount') }}\">\n    {{ wordcount(post.content) }}\n</span>\n```\n\n修改为:\n\n```html\n<span title=\"{{ __('post.wordcount') }}\">\n    {{ wordcount(post.content) }} 字\n</span>\n```\n\n同理，我们修改【阅读时长】，修改后如下：\n\n```html\n<span title=\"{{ __('post.min2read') }}\">\n    {{ min2read(post.content) }} 分钟\n</span>\n```\n\n然后 `hexo clean` 与 `hexo g` 二连即可。\n\n## 侧栏加入已运行的时间\n\n你可以在你的主页侧栏中加入你的博客总运行时间，这样你就可以看着你的博客一天天的长大了~\n\n我们打开 `/themes/next/layout/_custom/sidebar.swig` 文件，加入以下代码：\n\n```html\n<div id=\"days\"></div>\n<script>\nfunction show_date_time(){\n    window.setTimeout(\"show_date_time()\", 1000);\n    BirthDay = new Date(\"05/27/2017 15:13:14\");\n    today = new Date();\n    timeold = (today.getTime() - BirthDay.getTime());\n    sectimeold = timeold / 1000\n    secondsold = Math.floor(sectimeold);\n    msPerDay = 24 * 60 * 60 * 1000\n    e_daysold = timeold / msPerDay\n    daysold = Math.floor(e_daysold);\n    e_hrsold = (e_daysold - daysold) * 24;\n    hrsold = setzero(Math.floor(e_hrsold));\n    e_minsold = (e_hrsold - hrsold) * 60;\n    minsold = setzero(Math.floor((e_hrsold - hrsold) * 60));\n    seconds = setzero(Math.floor((e_minsold - minsold) * 60));\n    document.getElementById('days').innerHTML= \"已运行 \" + daysold + \" 天 \" + hrsold + \" 小时 \" + minsold + \" 分 \" + seconds + \" 秒\";\n}\nfunction setzero(i) {\n    if (i < 10) {\n        i = \"0\" + i\n    };\n    return i;\n}\nshow_date_time();\n</script>\n```\n\n上面 `Date` 的值记得改为你自己的，且按上面格式，然后修改 `/themes/next/layout/_macro/sidebar.swig` 文件，修改如下代码：\n\n```html\n{# Blogroll #}\n{% if theme.links %}\n    <div class=\"links-of-blogroll motion-element {{ \"links-of-blogroll-\" + theme.links_layout | default('inline') }}\">\n        <div class=\"links-of-blogroll-title\">\n              <i class=\"fa  fa-fw fa-{{ theme.links_icon | default('globe') | lower }}\"></i>\n              {{ theme.links_title }}&nbsp;\n              <i class=\"fa  fa-fw fa-{{ theme.links_icon | default('globe') | lower }}\"></i>\n        </div>\n        <ul class=\"links-of-blogroll-list\">\n            {% for name, link in theme.links %}\n            <li class=\"links-of-blogroll-item\">\n                <a href=\"{{ link }}\" title=\"{{ name }}\" target=\"_blank\">{{ name }}</a>\n            </li>\n            {% endfor %}\n        </ul>\n        {% include '../_custom/sidebar.swig' %}\n    </div>\n{% endif %}\n\n<!--       {% include '../_custom/sidebar.swig' %}   -->\n```\n\n这样就可以了！当然，要是不喜欢颜色，感觉不好看，就可以在 `/themes/next/source/css/_custom/custom.styl` 中加入你自己的样式：\n\n```css\n/* 自定义的侧栏时间样式 */\n#days {\n    display: block;\n    color: rgb(7, 179, 155);\n    font-size: 13px;\n    margin-top: 15px;\n}\n```\n\n然后 `hexo clean` 与 `hexo g` 二连即可。\n\n## 更厉害的设置\n\n### 页面宽度问题\n\n如果你很细心的对你的网页进行缩放，你会发现当你的网页宽度小于一定值时，页脚那里会因为文字换行而变得非常难看，那为什么不这样设置一下？如果页面的宽度小于某个值了，可以让某些文字不再显示，那么就不会导致换行问题的发生了！\n\n打开 `\\themes\\next\\layout\\_partials\\footer.swig` 这个文件，将刚刚加入的 `博客全站共xxx字` 与 `博客全站共计访客xxx人` 那一部分的代码修改为这样：\n\n```\n{% if theme.post_wordcount.totalcount %}\n    {# <span class=\"post-meta-divider\"><br/></span> #}\n    <br/>\n    <span class=\"post-meta-item-icon\">\n      <i class=\"fa fa-font\"></i>\n    </span>\n    {% if theme.post_wordcount.item_text %}\n     <span class=\"post-meta-item-text\">{# {{ __('post.totalcount') }} #}博客全站共&#58;</span>\n    {% endif %}\n    <span title=\"{{ __('post.totalcount') }}\">\n    {##}{{ totalcount(site, '0,0.0a') }} 字&nbsp;|&nbsp;{##}\n    </span>\n{% endif %}\n<span class=\"post-meta-item-icon\">\n    <i class=\"fa fa-user\"></i>\n</span>\n<span id=\"busuanzi_container_site_pv\">\n    {% if theme.post_wordcount.item_text %}\n      <span class=\"post-meta-item-text\">博客全站共计访客&#58;</span>\n    {% endif %}\n    <span id=\"busuanzi_value_site_pv\"></span> 人\n</span>\n```\n\n二连之后就会发现，当你的博客在 PC 端以一个正常宽度显示的时候，页脚会是这个样子：\n\n<div style = \"text-align: center;\">\n    <img src = \"normal_footer.png\" alt = \"normal_footer\"></img>\n</div>\n\n当你使用移动端或将 PC 端页面宽度缩小时，会变成这样：\n\n<div style = \"text-align: center;\">\n    <img src = \"mini_footer.png\" alt = \"mini_footer\"></img>\n</div>\n\n### 加入备案号\n\n紧接着上一步加入的那些代码，在他们之前，加入以下代码：\n\n```html\n{% if theme.post_wordcount.item_text %}\n    <span class=\"post-meta-item-text\">\n      <span>&nbsp;|&nbsp;\n        <span class=\"post-meta-item-icon\">\n          <i class=\"fa fa-search\"></i>\n        </span> 备案号&#58; <a href = \"http://www.beian.miit.gov.cn\">陕ICP备xxxxxxxx号</a>\n      </span>\n    </span>\n{% endif %}\n```\n\n<div class = \"note info\">这个已经优化过了，当页面缩小的时候这个备案号直接就会消失掉！</div>\n\n<div class = \"note info\">可能有一些细心的小伙伴们已经发现了，我们控制它在特定宽度下的显示问题就是利用了 <code>theme.post_wordcount.item_text</code> 这个值，那么你也就可以将它用到其他地方了！</div>\n\n### 博客全站人数显示问题\n\n如果你的服务器加载速度有点堪忧（就像我的学生机一样），那么你刷新页面后迅速看你的 `busuanzi` 统计博客人数，会发现变成了这样（没有图，大家意会一下）：\n\n<div class = \"note info\">博客全站共计访客：人</div>\n\n直到你的插件加载 OK 之后，才会正常的显示人数，但是这一点足够逼疯一些强迫症患者了，我随即研究了一下它这个显示人数的原理，就是替换掉了那个 `<span>` 标签中的东西，那么我们可以写成这样：\n\n```html\n<span id=\"busuanzi_container_site_pv\">\n    {% if theme.post_wordcount.item_text %}\n      <span class=\"post-meta-item-text\">博客全站共计访客&#58;</span>\n    {% endif %}\n    <span id=\"busuanzi_value_site_pv\"> ???</span> 人\n</span>\n```\n\n这样即使我们的插件没有加载好，它也会显示：\n\n<div class = \"note info\">博客全站共计访客：???人</div>\n\n是不是比之前能看起来更舒服一些了~ 当插件加载好之后会直接替换掉 `???` 转而显示数字，赞！\n\n## 参考文章\n\n- [Yulin Lewis's Blog](https://lewky.cn)\n- [打造个性超赞博客 Hexo + NexT + GitHub Pages 的超深度优化](https://io-oi.me/tech/hexo-next-optimization/#)\n- [Hexo添加字数统计、阅读时长](https://www.cnblogs.com/php-linux/p/8418518.html)","source":"_posts/Hexo-NexT魔改系列-03-添加数据统计.md","raw":"---\ntitle: Hexo-NexT魔改系列-03-添加数据统计\ndate: 2019-09-15 01:39:35\ntags:\n- Hexo\n- NexT\n- 魔改\n- 瞎折腾\ncategories:\n- Hexo\n- NexT\n- 魔改\ncopyright: true\n---\n\n\n> <span class = 'introduction'>志向不过是记忆的奴隶，生气勃勃地降生，但却很难成长。</span><br/>\n本篇博客主要介绍了如何给你的博客加上 `各种统计信息` 及其所需要注意的事项，一步一步地美化你的博客吧!\n\n<!--more-->\n\n## 添加博客访问人数统计\n\n在这里我们使用的是 `busuanzi插件`，最终效果图如下：\n\n<div style = \"text-align: center;\">\n    <img src = \"busuanzi.png\" alt = \"busuanzi\"></img>\n</div>\n\n在你的 `\\themes\\next\\source\\js\\` 中创建一个文件，名称为 `busuanzi.pure.min.js`，然后打开 [这个网页](http://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js)，将里面的内容拷贝到刚刚你创建的那个文件中，保存。\n\n然后打开 `\\themes\\next\\layout\\_partials\\footer.swig` 这个文件，在第一行加入以下代码：\n\n```html\n<script async src=\"/js/src/busuanzi.pure.mini.js\"></script>\n```\n\n在这个文件中，之前在 [这篇博客]() 中注释了一些代码，然后我们在这个位置添加如下代码：\n\n```html\n<span id=\"busuanzi_container_site_pv\">\n      <span class=\"post-meta-item-text\">博客全站共计访客&#58;</span>\n    <span id=\"busuanzi_value_site_pv\"></span> 人\n</span>\n\n<!--\n{% if theme.footer.powered %}\n  <div class=\"powered-by\">{#\n  #}{{ __('footer.powered', '<a class=\"theme-link\" target=\"_blank\" href=\"https://hexo.io\">Hexo</a>') }}{#\n#}</div>\n{% endif %}\n......\n```\n\n其中注意 `busuanzi_container_site_pv` 这个 id，当后面是 `pv` 的时候，你每刷新一次页面就会多一个访客量。如果不喜欢这样的话可以换成 `uv`，意思是每个用户访问多个页面只记录一次。（记得把两个 id 都要改啊！）\n\n然后 `hexo clean` 与 `hexo g` 二连即可。\n\n## 添加博客文章字数统计\n\n`NexT` 主题默认集成了 `post_wordcount` 插件，我们可以在 <span class = \"purple-target\">主题配置文件</span> 中找到它，并修改为：\n\n```yml\n# Post wordcount display settings\n# Dependencies: https://github.com/willin/hexo-wordcount\npost_wordcount:\n  item_text: true\n  wordcount: true         # 单篇 字数统计\n  min2read: true          # 单篇 阅读时长\n  totalcount: true       # 网站 字数统计\n  separated_meta: true\n```\n\n然后在 <span class = \"red-target\">博客根目录</span> 下，利用 npm 安装一个插件：\n\n```bash\nnpm i --save hexo-wordcount\n```\n\n然后打开 `\\themes\\next\\layout\\_partials\\footer.swig` 这个文件，在上面加入的博客访客量之前，加入以下代码：\n\n```html\n<span class=\"post-meta-item-text\">{# {{ __('post.totalcount') }} #}博客全站共&#58;</span>\n<span title=\"{{ __('post.totalcount') }}\">\n{##}{{ totalcount(site, '0,0.0a') }} 字&nbsp;|&nbsp;{##}\n</span>\n```\n\n在页脚就形成了这样的样式：\n\n<div style = \"text-align: center;\">\n    <img src = \"busuanzi.png\" alt = \"busuanzi\"></img>\n</div>\n\n同时你也会看到在你的每一篇博客中也会有详细的字数统计与阅读时间：\n\n<div style = \"text-align: center;\">\n    <img src = \"title.png\" alt = \"title\"></img>\n</div>\n\n如果要修改这个样式的话，请打开 `/themes/next/layout/_macro/post.swig` 文件，修改【字数统计】，找到如下代码：\n\n```html\n<span title=\"{{ __('post.wordcount') }}\">\n    {{ wordcount(post.content) }}\n</span>\n```\n\n修改为:\n\n```html\n<span title=\"{{ __('post.wordcount') }}\">\n    {{ wordcount(post.content) }} 字\n</span>\n```\n\n同理，我们修改【阅读时长】，修改后如下：\n\n```html\n<span title=\"{{ __('post.min2read') }}\">\n    {{ min2read(post.content) }} 分钟\n</span>\n```\n\n然后 `hexo clean` 与 `hexo g` 二连即可。\n\n## 侧栏加入已运行的时间\n\n你可以在你的主页侧栏中加入你的博客总运行时间，这样你就可以看着你的博客一天天的长大了~\n\n我们打开 `/themes/next/layout/_custom/sidebar.swig` 文件，加入以下代码：\n\n```html\n<div id=\"days\"></div>\n<script>\nfunction show_date_time(){\n    window.setTimeout(\"show_date_time()\", 1000);\n    BirthDay = new Date(\"05/27/2017 15:13:14\");\n    today = new Date();\n    timeold = (today.getTime() - BirthDay.getTime());\n    sectimeold = timeold / 1000\n    secondsold = Math.floor(sectimeold);\n    msPerDay = 24 * 60 * 60 * 1000\n    e_daysold = timeold / msPerDay\n    daysold = Math.floor(e_daysold);\n    e_hrsold = (e_daysold - daysold) * 24;\n    hrsold = setzero(Math.floor(e_hrsold));\n    e_minsold = (e_hrsold - hrsold) * 60;\n    minsold = setzero(Math.floor((e_hrsold - hrsold) * 60));\n    seconds = setzero(Math.floor((e_minsold - minsold) * 60));\n    document.getElementById('days').innerHTML= \"已运行 \" + daysold + \" 天 \" + hrsold + \" 小时 \" + minsold + \" 分 \" + seconds + \" 秒\";\n}\nfunction setzero(i) {\n    if (i < 10) {\n        i = \"0\" + i\n    };\n    return i;\n}\nshow_date_time();\n</script>\n```\n\n上面 `Date` 的值记得改为你自己的，且按上面格式，然后修改 `/themes/next/layout/_macro/sidebar.swig` 文件，修改如下代码：\n\n```html\n{# Blogroll #}\n{% if theme.links %}\n    <div class=\"links-of-blogroll motion-element {{ \"links-of-blogroll-\" + theme.links_layout | default('inline') }}\">\n        <div class=\"links-of-blogroll-title\">\n              <i class=\"fa  fa-fw fa-{{ theme.links_icon | default('globe') | lower }}\"></i>\n              {{ theme.links_title }}&nbsp;\n              <i class=\"fa  fa-fw fa-{{ theme.links_icon | default('globe') | lower }}\"></i>\n        </div>\n        <ul class=\"links-of-blogroll-list\">\n            {% for name, link in theme.links %}\n            <li class=\"links-of-blogroll-item\">\n                <a href=\"{{ link }}\" title=\"{{ name }}\" target=\"_blank\">{{ name }}</a>\n            </li>\n            {% endfor %}\n        </ul>\n        {% include '../_custom/sidebar.swig' %}\n    </div>\n{% endif %}\n\n<!--       {% include '../_custom/sidebar.swig' %}   -->\n```\n\n这样就可以了！当然，要是不喜欢颜色，感觉不好看，就可以在 `/themes/next/source/css/_custom/custom.styl` 中加入你自己的样式：\n\n```css\n/* 自定义的侧栏时间样式 */\n#days {\n    display: block;\n    color: rgb(7, 179, 155);\n    font-size: 13px;\n    margin-top: 15px;\n}\n```\n\n然后 `hexo clean` 与 `hexo g` 二连即可。\n\n## 更厉害的设置\n\n### 页面宽度问题\n\n如果你很细心的对你的网页进行缩放，你会发现当你的网页宽度小于一定值时，页脚那里会因为文字换行而变得非常难看，那为什么不这样设置一下？如果页面的宽度小于某个值了，可以让某些文字不再显示，那么就不会导致换行问题的发生了！\n\n打开 `\\themes\\next\\layout\\_partials\\footer.swig` 这个文件，将刚刚加入的 `博客全站共xxx字` 与 `博客全站共计访客xxx人` 那一部分的代码修改为这样：\n\n```\n{% if theme.post_wordcount.totalcount %}\n    {# <span class=\"post-meta-divider\"><br/></span> #}\n    <br/>\n    <span class=\"post-meta-item-icon\">\n      <i class=\"fa fa-font\"></i>\n    </span>\n    {% if theme.post_wordcount.item_text %}\n     <span class=\"post-meta-item-text\">{# {{ __('post.totalcount') }} #}博客全站共&#58;</span>\n    {% endif %}\n    <span title=\"{{ __('post.totalcount') }}\">\n    {##}{{ totalcount(site, '0,0.0a') }} 字&nbsp;|&nbsp;{##}\n    </span>\n{% endif %}\n<span class=\"post-meta-item-icon\">\n    <i class=\"fa fa-user\"></i>\n</span>\n<span id=\"busuanzi_container_site_pv\">\n    {% if theme.post_wordcount.item_text %}\n      <span class=\"post-meta-item-text\">博客全站共计访客&#58;</span>\n    {% endif %}\n    <span id=\"busuanzi_value_site_pv\"></span> 人\n</span>\n```\n\n二连之后就会发现，当你的博客在 PC 端以一个正常宽度显示的时候，页脚会是这个样子：\n\n<div style = \"text-align: center;\">\n    <img src = \"normal_footer.png\" alt = \"normal_footer\"></img>\n</div>\n\n当你使用移动端或将 PC 端页面宽度缩小时，会变成这样：\n\n<div style = \"text-align: center;\">\n    <img src = \"mini_footer.png\" alt = \"mini_footer\"></img>\n</div>\n\n### 加入备案号\n\n紧接着上一步加入的那些代码，在他们之前，加入以下代码：\n\n```html\n{% if theme.post_wordcount.item_text %}\n    <span class=\"post-meta-item-text\">\n      <span>&nbsp;|&nbsp;\n        <span class=\"post-meta-item-icon\">\n          <i class=\"fa fa-search\"></i>\n        </span> 备案号&#58; <a href = \"http://www.beian.miit.gov.cn\">陕ICP备xxxxxxxx号</a>\n      </span>\n    </span>\n{% endif %}\n```\n\n<div class = \"note info\">这个已经优化过了，当页面缩小的时候这个备案号直接就会消失掉！</div>\n\n<div class = \"note info\">可能有一些细心的小伙伴们已经发现了，我们控制它在特定宽度下的显示问题就是利用了 <code>theme.post_wordcount.item_text</code> 这个值，那么你也就可以将它用到其他地方了！</div>\n\n### 博客全站人数显示问题\n\n如果你的服务器加载速度有点堪忧（就像我的学生机一样），那么你刷新页面后迅速看你的 `busuanzi` 统计博客人数，会发现变成了这样（没有图，大家意会一下）：\n\n<div class = \"note info\">博客全站共计访客：人</div>\n\n直到你的插件加载 OK 之后，才会正常的显示人数，但是这一点足够逼疯一些强迫症患者了，我随即研究了一下它这个显示人数的原理，就是替换掉了那个 `<span>` 标签中的东西，那么我们可以写成这样：\n\n```html\n<span id=\"busuanzi_container_site_pv\">\n    {% if theme.post_wordcount.item_text %}\n      <span class=\"post-meta-item-text\">博客全站共计访客&#58;</span>\n    {% endif %}\n    <span id=\"busuanzi_value_site_pv\"> ???</span> 人\n</span>\n```\n\n这样即使我们的插件没有加载好，它也会显示：\n\n<div class = \"note info\">博客全站共计访客：???人</div>\n\n是不是比之前能看起来更舒服一些了~ 当插件加载好之后会直接替换掉 `???` 转而显示数字，赞！\n\n## 参考文章\n\n- [Yulin Lewis's Blog](https://lewky.cn)\n- [打造个性超赞博客 Hexo + NexT + GitHub Pages 的超深度优化](https://io-oi.me/tech/hexo-next-optimization/#)\n- [Hexo添加字数统计、阅读时长](https://www.cnblogs.com/php-linux/p/8418518.html)","slug":"Hexo-NexT魔改系列-03-添加数据统计","published":1,"updated":"2020-01-14T20:30:46.413Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn5900082lwj9482hjee","content":"<blockquote>\n<p><span class=\"introduction\">志向不过是记忆的奴隶，生气勃勃地降生，但却很难成长。</span><br><br>本篇博客主要介绍了如何给你的博客加上 <code>各种统计信息</code> 及其所需要注意的事项，一步一步地美化你的博客吧!</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<h2 id=\"添加博客访问人数统计\"><a href=\"#添加博客访问人数统计\" class=\"headerlink\" title=\"添加博客访问人数统计\"></a>添加博客访问人数统计</h2><p>在这里我们使用的是 <code>busuanzi插件</code>，最终效果图如下：</p>\n<div style=\"text-align: center;\">\n    <img src=\"/2019/09/15/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-03-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/busuanzi.png\" alt=\"busuanzi\">\n</div>\n\n<p>在你的 <code>\\themes\\next\\source\\js\\</code> 中创建一个文件，名称为 <code>busuanzi.pure.min.js</code>，然后打开 <a href=\"http://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\" target=\"_blank\" rel=\"noopener\">这个网页</a>，将里面的内容拷贝到刚刚你创建的那个文件中，保存。</p>\n<p>然后打开 <code>\\themes\\next\\layout\\_partials\\footer.swig</code> 这个文件，在第一行加入以下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">async</span> <span class=\"attr\">src</span>=<span class=\"string\">\"/js/src/busuanzi.pure.mini.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在这个文件中，之前在 <a href>这篇博客</a> 中注释了一些代码，然后我们在这个位置添加如下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_container_site_pv\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-item-text\"</span>&gt;</span>博客全站共计访客<span class=\"symbol\">&amp;#58;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_value_site_pv\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> 人</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!--</span></span><br><span class=\"line\"><span class=\"comment\">&#123;% if theme.footer.powered %&#125;</span></span><br><span class=\"line\"><span class=\"comment\">  &lt;div class=\"powered-by\"&gt;&#123;#</span></span><br><span class=\"line\"><span class=\"comment\">  #&#125;&#123;&#123; __('footer.powered', '&lt;a class=\"theme-link\" target=\"_blank\" href=\"https://hexo.io\"&gt;Hexo&lt;/a&gt;') &#125;&#125;&#123;#</span></span><br><span class=\"line\"><span class=\"comment\">#&#125;&lt;/div&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&#123;% endif %&#125;</span></span><br><span class=\"line\"><span class=\"comment\">......</span></span><br></pre></td></tr></table></figure>\n\n<p>其中注意 <code>busuanzi_container_site_pv</code> 这个 id，当后面是 <code>pv</code> 的时候，你每刷新一次页面就会多一个访客量。如果不喜欢这样的话可以换成 <code>uv</code>，意思是每个用户访问多个页面只记录一次。（记得把两个 id 都要改啊！）</p>\n<p>然后 <code>hexo clean</code> 与 <code>hexo g</code> 二连即可。</p>\n<h2 id=\"添加博客文章字数统计\"><a href=\"#添加博客文章字数统计\" class=\"headerlink\" title=\"添加博客文章字数统计\"></a>添加博客文章字数统计</h2><p><code>NexT</code> 主题默认集成了 <code>post_wordcount</code> 插件，我们可以在 <span class=\"purple-target\">主题配置文件</span> 中找到它，并修改为：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Post wordcount display settings</span></span><br><span class=\"line\"><span class=\"comment\"># Dependencies: https://github.com/willin/hexo-wordcount</span></span><br><span class=\"line\"><span class=\"attr\">post_wordcount:</span></span><br><span class=\"line\">  <span class=\"attr\">item_text:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">wordcount:</span> <span class=\"literal\">true</span>         <span class=\"comment\"># 单篇 字数统计</span></span><br><span class=\"line\">  <span class=\"attr\">min2read:</span> <span class=\"literal\">true</span>          <span class=\"comment\"># 单篇 阅读时长</span></span><br><span class=\"line\">  <span class=\"attr\">totalcount:</span> <span class=\"literal\">true</span>       <span class=\"comment\"># 网站 字数统计</span></span><br><span class=\"line\">  <span class=\"attr\">separated_meta:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<p>然后在 <span class=\"red-target\">博客根目录</span> 下，利用 npm 安装一个插件：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i --save hexo-wordcount</span><br></pre></td></tr></table></figure>\n\n<p>然后打开 <code>\\themes\\next\\layout\\_partials\\footer.swig</code> 这个文件，在上面加入的博客访客量之前，加入以下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-item-text\"</span>&gt;</span>&#123;# &#123;&#123; __('post.totalcount') &#125;&#125; #&#125;博客全站共<span class=\"symbol\">&amp;#58;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">title</span>=<span class=\"string\">\"&#123;&#123; __('post.totalcount') &#125;&#125;\"</span>&gt;</span></span><br><span class=\"line\">&#123;##&#125;&#123;&#123; totalcount(site, '0,0.0a') &#125;&#125; 字<span class=\"symbol\">&amp;nbsp;</span>|<span class=\"symbol\">&amp;nbsp;</span>&#123;##&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在页脚就形成了这样的样式：</p>\n<div style=\"text-align: center;\">\n    <img src=\"/2019/09/15/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-03-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/busuanzi.png\" alt=\"busuanzi\">\n</div>\n\n<p>同时你也会看到在你的每一篇博客中也会有详细的字数统计与阅读时间：</p>\n<div style=\"text-align: center;\">\n    <img src=\"/2019/09/15/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-03-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/title.png\" alt=\"title\">\n</div>\n\n<p>如果要修改这个样式的话，请打开 <code>/themes/next/layout/_macro/post.swig</code> 文件，修改【字数统计】，找到如下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">title</span>=<span class=\"string\">\"&#123;&#123; __('post.wordcount') &#125;&#125;\"</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; wordcount(post.content) &#125;&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>修改为:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">title</span>=<span class=\"string\">\"&#123;&#123; __('post.wordcount') &#125;&#125;\"</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; wordcount(post.content) &#125;&#125; 字</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>同理，我们修改【阅读时长】，修改后如下：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">title</span>=<span class=\"string\">\"&#123;&#123; __('post.min2read') &#125;&#125;\"</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; min2read(post.content) &#125;&#125; 分钟</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>然后 <code>hexo clean</code> 与 <code>hexo g</code> 二连即可。</p>\n<h2 id=\"侧栏加入已运行的时间\"><a href=\"#侧栏加入已运行的时间\" class=\"headerlink\" title=\"侧栏加入已运行的时间\"></a>侧栏加入已运行的时间</h2><p>你可以在你的主页侧栏中加入你的博客总运行时间，这样你就可以看着你的博客一天天的长大了~</p>\n<p>我们打开 <code>/themes/next/layout/_custom/sidebar.swig</code> 文件，加入以下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"days\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"actionscript\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show_date_time</span><span class=\"params\">()</span></span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">window</span>.setTimeout(<span class=\"string\">\"show_date_time()\"</span>, <span class=\"number\">1000</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">    BirthDay = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(<span class=\"string\">\"05/27/2017 15:13:14\"</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">    today = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span></span><br><span class=\"line\">    timeold = (today.getTime() - BirthDay.getTime());</span><br><span class=\"line\">    sectimeold = timeold / 1000</span><br><span class=\"line\"><span class=\"javascript\">    secondsold = <span class=\"built_in\">Math</span>.floor(sectimeold);</span></span><br><span class=\"line\">    msPerDay = 24 * 60 * 60 * 1000</span><br><span class=\"line\">    e_daysold = timeold / msPerDay</span><br><span class=\"line\"><span class=\"javascript\">    daysold = <span class=\"built_in\">Math</span>.floor(e_daysold);</span></span><br><span class=\"line\">    e_hrsold = (e_daysold - daysold) * 24;</span><br><span class=\"line\"><span class=\"javascript\">    hrsold = setzero(<span class=\"built_in\">Math</span>.floor(e_hrsold));</span></span><br><span class=\"line\">    e_minsold = (e_hrsold - hrsold) * 60;</span><br><span class=\"line\"><span class=\"javascript\">    minsold = setzero(<span class=\"built_in\">Math</span>.floor((e_hrsold - hrsold) * <span class=\"number\">60</span>));</span></span><br><span class=\"line\"><span class=\"javascript\">    seconds = setzero(<span class=\"built_in\">Math</span>.floor((e_minsold - minsold) * <span class=\"number\">60</span>));</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'days'</span>).innerHTML= <span class=\"string\">\"已运行 \"</span> + daysold + <span class=\"string\">\" 天 \"</span> + hrsold + <span class=\"string\">\" 小时 \"</span> + minsold + <span class=\"string\">\" 分 \"</span> + seconds + <span class=\"string\">\" 秒\"</span>;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"actionscript\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">setzero</span><span class=\"params\">(i)</span> </span>&#123;</span></span><br><span class=\"line\">    if (i &lt; 10) &#123;</span><br><span class=\"line\"><span class=\"actionscript\">        i = <span class=\"string\">\"0\"</span> + i</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"><span class=\"actionscript\">    <span class=\"keyword\">return</span> i;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">show_date_time();</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>上面 <code>Date</code> 的值记得改为你自己的，且按上面格式，然后修改 <code>/themes/next/layout/_macro/sidebar.swig</code> 文件，修改如下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;# Blogroll #&#125;</span><br><span class=\"line\">&#123;% if theme.links %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"links-of-blogroll motion-element &#123;&#123; \"</span><span class=\"attr\">links-of-blogroll-</span>\" + <span class=\"attr\">theme.links_layout</span> | <span class=\"attr\">default</span>('<span class=\"attr\">inline</span>') &#125;&#125;\"&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"links-of-blogroll-title\"</span>&gt;</span></span><br><span class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa  fa-fw fa-&#123;&#123; theme.links_icon | default('globe') | lower &#125;&#125;\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">              &#123;&#123; theme.links_title &#125;&#125;<span class=\"symbol\">&amp;nbsp;</span></span><br><span class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa  fa-fw fa-&#123;&#123; theme.links_icon | default('globe') | lower &#125;&#125;\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">ul</span> <span class=\"attr\">class</span>=<span class=\"string\">\"links-of-blogroll-list\"</span>&gt;</span></span><br><span class=\"line\">            &#123;% for name, link in theme.links %&#125;</span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">\"links-of-blogroll-item\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"&#123;&#123; link &#125;&#125;\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"&#123;&#123; name &#125;&#125;\"</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span>&gt;</span>&#123;&#123; name &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">            &#123;% endfor %&#125;</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">        &#123;% include '../_custom/sidebar.swig' %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">&#123;% endif %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!--       &#123;% include '../_custom/sidebar.swig' %&#125;   --&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>这样就可以了！当然，要是不喜欢颜色，感觉不好看，就可以在 <code>/themes/next/source/css/_custom/custom.styl</code> 中加入你自己的样式：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 自定义的侧栏时间样式 */</span></span><br><span class=\"line\"><span class=\"selector-id\">#days</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"built_in\">rgb</span>(<span class=\"number\">7</span>, <span class=\"number\">179</span>, <span class=\"number\">155</span>);</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">13px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin-top</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>然后 <code>hexo clean</code> 与 <code>hexo g</code> 二连即可。</p>\n<h2 id=\"更厉害的设置\"><a href=\"#更厉害的设置\" class=\"headerlink\" title=\"更厉害的设置\"></a>更厉害的设置</h2><h3 id=\"页面宽度问题\"><a href=\"#页面宽度问题\" class=\"headerlink\" title=\"页面宽度问题\"></a>页面宽度问题</h3><p>如果你很细心的对你的网页进行缩放，你会发现当你的网页宽度小于一定值时，页脚那里会因为文字换行而变得非常难看，那为什么不这样设置一下？如果页面的宽度小于某个值了，可以让某些文字不再显示，那么就不会导致换行问题的发生了！</p>\n<p>打开 <code>\\themes\\next\\layout\\_partials\\footer.swig</code> 这个文件，将刚刚加入的 <code>博客全站共xxx字</code> 与 <code>博客全站共计访客xxx人</code> 那一部分的代码修改为这样：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% if theme.post_wordcount.totalcount %&#125;</span><br><span class=\"line\">    &#123;# &lt;span class&#x3D;&quot;post-meta-divider&quot;&gt;&lt;br&#x2F;&gt;&lt;&#x2F;span&gt; #&#125;</span><br><span class=\"line\">    &lt;br&#x2F;&gt;</span><br><span class=\"line\">    &lt;span class&#x3D;&quot;post-meta-item-icon&quot;&gt;</span><br><span class=\"line\">      &lt;i class&#x3D;&quot;fa fa-font&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class=\"line\">    &lt;&#x2F;span&gt;</span><br><span class=\"line\">    &#123;% if theme.post_wordcount.item_text %&#125;</span><br><span class=\"line\">     &lt;span class&#x3D;&quot;post-meta-item-text&quot;&gt;&#123;# &#123;&#123; __(&#39;post.totalcount&#39;) &#125;&#125; #&#125;博客全站共&amp;#58;&lt;&#x2F;span&gt;</span><br><span class=\"line\">    &#123;% endif %&#125;</span><br><span class=\"line\">    &lt;span title&#x3D;&quot;&#123;&#123; __(&#39;post.totalcount&#39;) &#125;&#125;&quot;&gt;</span><br><span class=\"line\">    &#123;##&#125;&#123;&#123; totalcount(site, &#39;0,0.0a&#39;) &#125;&#125; 字&amp;nbsp;|&amp;nbsp;&#123;##&#125;</span><br><span class=\"line\">    &lt;&#x2F;span&gt;</span><br><span class=\"line\">&#123;% endif %&#125;</span><br><span class=\"line\">&lt;span class&#x3D;&quot;post-meta-item-icon&quot;&gt;</span><br><span class=\"line\">    &lt;i class&#x3D;&quot;fa fa-user&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class=\"line\">&lt;&#x2F;span&gt;</span><br><span class=\"line\">&lt;span id&#x3D;&quot;busuanzi_container_site_pv&quot;&gt;</span><br><span class=\"line\">    &#123;% if theme.post_wordcount.item_text %&#125;</span><br><span class=\"line\">      &lt;span class&#x3D;&quot;post-meta-item-text&quot;&gt;博客全站共计访客&amp;#58;&lt;&#x2F;span&gt;</span><br><span class=\"line\">    &#123;% endif %&#125;</span><br><span class=\"line\">    &lt;span id&#x3D;&quot;busuanzi_value_site_pv&quot;&gt;&lt;&#x2F;span&gt; 人</span><br><span class=\"line\">&lt;&#x2F;span&gt;</span><br></pre></td></tr></table></figure>\n\n<p>二连之后就会发现，当你的博客在 PC 端以一个正常宽度显示的时候，页脚会是这个样子：</p>\n<div style=\"text-align: center;\">\n    <img src=\"/2019/09/15/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-03-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/normal_footer.png\" alt=\"normal_footer\">\n</div>\n\n<p>当你使用移动端或将 PC 端页面宽度缩小时，会变成这样：</p>\n<div style=\"text-align: center;\">\n    <img src=\"/2019/09/15/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-03-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/mini_footer.png\" alt=\"mini_footer\">\n</div>\n\n<h3 id=\"加入备案号\"><a href=\"#加入备案号\" class=\"headerlink\" title=\"加入备案号\"></a>加入备案号</h3><p>紧接着上一步加入的那些代码，在他们之前，加入以下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% if theme.post_wordcount.item_text %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-item-text\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span><span class=\"symbol\">&amp;nbsp;</span>|<span class=\"symbol\">&amp;nbsp;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-item-icon\"</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa fa-search\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> 备案号<span class=\"symbol\">&amp;#58;</span> <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span> = <span class=\"string\">\"http://www.beian.miit.gov.cn\"</span>&gt;</span>陕ICP备xxxxxxxx号<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>\n\n<div class=\"note info\">这个已经优化过了，当页面缩小的时候这个备案号直接就会消失掉！</div>\n\n<div class=\"note info\">可能有一些细心的小伙伴们已经发现了，我们控制它在特定宽度下的显示问题就是利用了 <code>theme.post_wordcount.item_text</code> 这个值，那么你也就可以将它用到其他地方了！</div>\n\n<h3 id=\"博客全站人数显示问题\"><a href=\"#博客全站人数显示问题\" class=\"headerlink\" title=\"博客全站人数显示问题\"></a>博客全站人数显示问题</h3><p>如果你的服务器加载速度有点堪忧（就像我的学生机一样），那么你刷新页面后迅速看你的 <code>busuanzi</code> 统计博客人数，会发现变成了这样（没有图，大家意会一下）：</p>\n<div class=\"note info\">博客全站共计访客：人</div>\n\n<p>直到你的插件加载 OK 之后，才会正常的显示人数，但是这一点足够逼疯一些强迫症患者了，我随即研究了一下它这个显示人数的原理，就是替换掉了那个 <code>&lt;span&gt;</code> 标签中的东西，那么我们可以写成这样：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_container_site_pv\"</span>&gt;</span></span><br><span class=\"line\">    &#123;% if theme.post_wordcount.item_text %&#125;</span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-item-text\"</span>&gt;</span>博客全站共计访客<span class=\"symbol\">&amp;#58;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    &#123;% endif %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_value_site_pv\"</span>&gt;</span> ???<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> 人</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>这样即使我们的插件没有加载好，它也会显示：</p>\n<div class=\"note info\">博客全站共计访客：???人</div>\n\n<p>是不是比之前能看起来更舒服一些了~ 当插件加载好之后会直接替换掉 <code>???</code> 转而显示数字，赞！</p>\n<h2 id=\"参考文章\"><a href=\"#参考文章\" class=\"headerlink\" title=\"参考文章\"></a>参考文章</h2><ul>\n<li><a href=\"https://lewky.cn\" target=\"_blank\" rel=\"noopener\">Yulin Lewis’s Blog</a></li>\n<li><a href=\"https://io-oi.me/tech/hexo-next-optimization/#\" target=\"_blank\" rel=\"noopener\">打造个性超赞博客 Hexo + NexT + GitHub Pages 的超深度优化</a></li>\n<li><a href=\"https://www.cnblogs.com/php-linux/p/8418518.html\" target=\"_blank\" rel=\"noopener\">Hexo添加字数统计、阅读时长</a></li>\n</ul>\n","site":{"data":{}},"length":6899,"excerpt":"<blockquote>\n<p><span class=\"introduction\">志向不过是记忆的奴隶，生气勃勃地降生，但却很难成长。</span><br><br>本篇博客主要介绍了如何给你的博客加上 <code>各种统计信息</code> 及其所需要注意的事项，一步一步地美化你的博客吧!</p>\n</blockquote>","more":"<h2 id=\"添加博客访问人数统计\"><a href=\"#添加博客访问人数统计\" class=\"headerlink\" title=\"添加博客访问人数统计\"></a>添加博客访问人数统计</h2><p>在这里我们使用的是 <code>busuanzi插件</code>，最终效果图如下：</p>\n<div style=\"text-align: center;\">\n    <img src=\"/2019/09/15/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-03-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/busuanzi.png\" alt=\"busuanzi\">\n</div>\n\n<p>在你的 <code>\\themes\\next\\source\\js\\</code> 中创建一个文件，名称为 <code>busuanzi.pure.min.js</code>，然后打开 <a href=\"http://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\" target=\"_blank\" rel=\"noopener\">这个网页</a>，将里面的内容拷贝到刚刚你创建的那个文件中，保存。</p>\n<p>然后打开 <code>\\themes\\next\\layout\\_partials\\footer.swig</code> 这个文件，在第一行加入以下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">async</span> <span class=\"attr\">src</span>=<span class=\"string\">\"/js/src/busuanzi.pure.mini.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在这个文件中，之前在 <a href>这篇博客</a> 中注释了一些代码，然后我们在这个位置添加如下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_container_site_pv\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-item-text\"</span>&gt;</span>博客全站共计访客<span class=\"symbol\">&amp;#58;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_value_site_pv\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> 人</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!--</span></span><br><span class=\"line\"><span class=\"comment\">&#123;% if theme.footer.powered %&#125;</span></span><br><span class=\"line\"><span class=\"comment\">  &lt;div class=\"powered-by\"&gt;&#123;#</span></span><br><span class=\"line\"><span class=\"comment\">  #&#125;&#123;&#123; __('footer.powered', '&lt;a class=\"theme-link\" target=\"_blank\" href=\"https://hexo.io\"&gt;Hexo&lt;/a&gt;') &#125;&#125;&#123;#</span></span><br><span class=\"line\"><span class=\"comment\">#&#125;&lt;/div&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&#123;% endif %&#125;</span></span><br><span class=\"line\"><span class=\"comment\">......</span></span><br></pre></td></tr></table></figure>\n\n<p>其中注意 <code>busuanzi_container_site_pv</code> 这个 id，当后面是 <code>pv</code> 的时候，你每刷新一次页面就会多一个访客量。如果不喜欢这样的话可以换成 <code>uv</code>，意思是每个用户访问多个页面只记录一次。（记得把两个 id 都要改啊！）</p>\n<p>然后 <code>hexo clean</code> 与 <code>hexo g</code> 二连即可。</p>\n<h2 id=\"添加博客文章字数统计\"><a href=\"#添加博客文章字数统计\" class=\"headerlink\" title=\"添加博客文章字数统计\"></a>添加博客文章字数统计</h2><p><code>NexT</code> 主题默认集成了 <code>post_wordcount</code> 插件，我们可以在 <span class=\"purple-target\">主题配置文件</span> 中找到它，并修改为：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Post wordcount display settings</span></span><br><span class=\"line\"><span class=\"comment\"># Dependencies: https://github.com/willin/hexo-wordcount</span></span><br><span class=\"line\"><span class=\"attr\">post_wordcount:</span></span><br><span class=\"line\">  <span class=\"attr\">item_text:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">wordcount:</span> <span class=\"literal\">true</span>         <span class=\"comment\"># 单篇 字数统计</span></span><br><span class=\"line\">  <span class=\"attr\">min2read:</span> <span class=\"literal\">true</span>          <span class=\"comment\"># 单篇 阅读时长</span></span><br><span class=\"line\">  <span class=\"attr\">totalcount:</span> <span class=\"literal\">true</span>       <span class=\"comment\"># 网站 字数统计</span></span><br><span class=\"line\">  <span class=\"attr\">separated_meta:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<p>然后在 <span class=\"red-target\">博客根目录</span> 下，利用 npm 安装一个插件：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i --save hexo-wordcount</span><br></pre></td></tr></table></figure>\n\n<p>然后打开 <code>\\themes\\next\\layout\\_partials\\footer.swig</code> 这个文件，在上面加入的博客访客量之前，加入以下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-item-text\"</span>&gt;</span>&#123;# &#123;&#123; __('post.totalcount') &#125;&#125; #&#125;博客全站共<span class=\"symbol\">&amp;#58;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">title</span>=<span class=\"string\">\"&#123;&#123; __('post.totalcount') &#125;&#125;\"</span>&gt;</span></span><br><span class=\"line\">&#123;##&#125;&#123;&#123; totalcount(site, '0,0.0a') &#125;&#125; 字<span class=\"symbol\">&amp;nbsp;</span>|<span class=\"symbol\">&amp;nbsp;</span>&#123;##&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在页脚就形成了这样的样式：</p>\n<div style=\"text-align: center;\">\n    <img src=\"/2019/09/15/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-03-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/busuanzi.png\" alt=\"busuanzi\">\n</div>\n\n<p>同时你也会看到在你的每一篇博客中也会有详细的字数统计与阅读时间：</p>\n<div style=\"text-align: center;\">\n    <img src=\"/2019/09/15/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-03-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/title.png\" alt=\"title\">\n</div>\n\n<p>如果要修改这个样式的话，请打开 <code>/themes/next/layout/_macro/post.swig</code> 文件，修改【字数统计】，找到如下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">title</span>=<span class=\"string\">\"&#123;&#123; __('post.wordcount') &#125;&#125;\"</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; wordcount(post.content) &#125;&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>修改为:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">title</span>=<span class=\"string\">\"&#123;&#123; __('post.wordcount') &#125;&#125;\"</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; wordcount(post.content) &#125;&#125; 字</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>同理，我们修改【阅读时长】，修改后如下：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">title</span>=<span class=\"string\">\"&#123;&#123; __('post.min2read') &#125;&#125;\"</span>&gt;</span></span><br><span class=\"line\">    &#123;&#123; min2read(post.content) &#125;&#125; 分钟</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>然后 <code>hexo clean</code> 与 <code>hexo g</code> 二连即可。</p>\n<h2 id=\"侧栏加入已运行的时间\"><a href=\"#侧栏加入已运行的时间\" class=\"headerlink\" title=\"侧栏加入已运行的时间\"></a>侧栏加入已运行的时间</h2><p>你可以在你的主页侧栏中加入你的博客总运行时间，这样你就可以看着你的博客一天天的长大了~</p>\n<p>我们打开 <code>/themes/next/layout/_custom/sidebar.swig</code> 文件，加入以下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"days\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"actionscript\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show_date_time</span><span class=\"params\">()</span></span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">window</span>.setTimeout(<span class=\"string\">\"show_date_time()\"</span>, <span class=\"number\">1000</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">    BirthDay = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(<span class=\"string\">\"05/27/2017 15:13:14\"</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">    today = <span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>();</span></span><br><span class=\"line\">    timeold = (today.getTime() - BirthDay.getTime());</span><br><span class=\"line\">    sectimeold = timeold / 1000</span><br><span class=\"line\"><span class=\"javascript\">    secondsold = <span class=\"built_in\">Math</span>.floor(sectimeold);</span></span><br><span class=\"line\">    msPerDay = 24 * 60 * 60 * 1000</span><br><span class=\"line\">    e_daysold = timeold / msPerDay</span><br><span class=\"line\"><span class=\"javascript\">    daysold = <span class=\"built_in\">Math</span>.floor(e_daysold);</span></span><br><span class=\"line\">    e_hrsold = (e_daysold - daysold) * 24;</span><br><span class=\"line\"><span class=\"javascript\">    hrsold = setzero(<span class=\"built_in\">Math</span>.floor(e_hrsold));</span></span><br><span class=\"line\">    e_minsold = (e_hrsold - hrsold) * 60;</span><br><span class=\"line\"><span class=\"javascript\">    minsold = setzero(<span class=\"built_in\">Math</span>.floor((e_hrsold - hrsold) * <span class=\"number\">60</span>));</span></span><br><span class=\"line\"><span class=\"javascript\">    seconds = setzero(<span class=\"built_in\">Math</span>.floor((e_minsold - minsold) * <span class=\"number\">60</span>));</span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'days'</span>).innerHTML= <span class=\"string\">\"已运行 \"</span> + daysold + <span class=\"string\">\" 天 \"</span> + hrsold + <span class=\"string\">\" 小时 \"</span> + minsold + <span class=\"string\">\" 分 \"</span> + seconds + <span class=\"string\">\" 秒\"</span>;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"actionscript\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">setzero</span><span class=\"params\">(i)</span> </span>&#123;</span></span><br><span class=\"line\">    if (i &lt; 10) &#123;</span><br><span class=\"line\"><span class=\"actionscript\">        i = <span class=\"string\">\"0\"</span> + i</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"><span class=\"actionscript\">    <span class=\"keyword\">return</span> i;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\">show_date_time();</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>上面 <code>Date</code> 的值记得改为你自己的，且按上面格式，然后修改 <code>/themes/next/layout/_macro/sidebar.swig</code> 文件，修改如下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;# Blogroll #&#125;</span><br><span class=\"line\">&#123;% if theme.links %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"links-of-blogroll motion-element &#123;&#123; \"</span><span class=\"attr\">links-of-blogroll-</span>\" + <span class=\"attr\">theme.links_layout</span> | <span class=\"attr\">default</span>('<span class=\"attr\">inline</span>') &#125;&#125;\"&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"links-of-blogroll-title\"</span>&gt;</span></span><br><span class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa  fa-fw fa-&#123;&#123; theme.links_icon | default('globe') | lower &#125;&#125;\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">              &#123;&#123; theme.links_title &#125;&#125;<span class=\"symbol\">&amp;nbsp;</span></span><br><span class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa  fa-fw fa-&#123;&#123; theme.links_icon | default('globe') | lower &#125;&#125;\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">ul</span> <span class=\"attr\">class</span>=<span class=\"string\">\"links-of-blogroll-list\"</span>&gt;</span></span><br><span class=\"line\">            &#123;% for name, link in theme.links %&#125;</span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">li</span> <span class=\"attr\">class</span>=<span class=\"string\">\"links-of-blogroll-item\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"&#123;&#123; link &#125;&#125;\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"&#123;&#123; name &#125;&#125;\"</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span>&gt;</span>&#123;&#123; name &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">li</span>&gt;</span></span><br><span class=\"line\">            &#123;% endfor %&#125;</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">ul</span>&gt;</span></span><br><span class=\"line\">        &#123;% include '../_custom/sidebar.swig' %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">&#123;% endif %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!--       &#123;% include '../_custom/sidebar.swig' %&#125;   --&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>这样就可以了！当然，要是不喜欢颜色，感觉不好看，就可以在 <code>/themes/next/source/css/_custom/custom.styl</code> 中加入你自己的样式：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 自定义的侧栏时间样式 */</span></span><br><span class=\"line\"><span class=\"selector-id\">#days</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"built_in\">rgb</span>(<span class=\"number\">7</span>, <span class=\"number\">179</span>, <span class=\"number\">155</span>);</span><br><span class=\"line\">    <span class=\"attribute\">font-size</span>: <span class=\"number\">13px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin-top</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>然后 <code>hexo clean</code> 与 <code>hexo g</code> 二连即可。</p>\n<h2 id=\"更厉害的设置\"><a href=\"#更厉害的设置\" class=\"headerlink\" title=\"更厉害的设置\"></a>更厉害的设置</h2><h3 id=\"页面宽度问题\"><a href=\"#页面宽度问题\" class=\"headerlink\" title=\"页面宽度问题\"></a>页面宽度问题</h3><p>如果你很细心的对你的网页进行缩放，你会发现当你的网页宽度小于一定值时，页脚那里会因为文字换行而变得非常难看，那为什么不这样设置一下？如果页面的宽度小于某个值了，可以让某些文字不再显示，那么就不会导致换行问题的发生了！</p>\n<p>打开 <code>\\themes\\next\\layout\\_partials\\footer.swig</code> 这个文件，将刚刚加入的 <code>博客全站共xxx字</code> 与 <code>博客全站共计访客xxx人</code> 那一部分的代码修改为这样：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% if theme.post_wordcount.totalcount %&#125;</span><br><span class=\"line\">    &#123;# &lt;span class&#x3D;&quot;post-meta-divider&quot;&gt;&lt;br&#x2F;&gt;&lt;&#x2F;span&gt; #&#125;</span><br><span class=\"line\">    &lt;br&#x2F;&gt;</span><br><span class=\"line\">    &lt;span class&#x3D;&quot;post-meta-item-icon&quot;&gt;</span><br><span class=\"line\">      &lt;i class&#x3D;&quot;fa fa-font&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class=\"line\">    &lt;&#x2F;span&gt;</span><br><span class=\"line\">    &#123;% if theme.post_wordcount.item_text %&#125;</span><br><span class=\"line\">     &lt;span class&#x3D;&quot;post-meta-item-text&quot;&gt;&#123;# &#123;&#123; __(&#39;post.totalcount&#39;) &#125;&#125; #&#125;博客全站共&amp;#58;&lt;&#x2F;span&gt;</span><br><span class=\"line\">    &#123;% endif %&#125;</span><br><span class=\"line\">    &lt;span title&#x3D;&quot;&#123;&#123; __(&#39;post.totalcount&#39;) &#125;&#125;&quot;&gt;</span><br><span class=\"line\">    &#123;##&#125;&#123;&#123; totalcount(site, &#39;0,0.0a&#39;) &#125;&#125; 字&amp;nbsp;|&amp;nbsp;&#123;##&#125;</span><br><span class=\"line\">    &lt;&#x2F;span&gt;</span><br><span class=\"line\">&#123;% endif %&#125;</span><br><span class=\"line\">&lt;span class&#x3D;&quot;post-meta-item-icon&quot;&gt;</span><br><span class=\"line\">    &lt;i class&#x3D;&quot;fa fa-user&quot;&gt;&lt;&#x2F;i&gt;</span><br><span class=\"line\">&lt;&#x2F;span&gt;</span><br><span class=\"line\">&lt;span id&#x3D;&quot;busuanzi_container_site_pv&quot;&gt;</span><br><span class=\"line\">    &#123;% if theme.post_wordcount.item_text %&#125;</span><br><span class=\"line\">      &lt;span class&#x3D;&quot;post-meta-item-text&quot;&gt;博客全站共计访客&amp;#58;&lt;&#x2F;span&gt;</span><br><span class=\"line\">    &#123;% endif %&#125;</span><br><span class=\"line\">    &lt;span id&#x3D;&quot;busuanzi_value_site_pv&quot;&gt;&lt;&#x2F;span&gt; 人</span><br><span class=\"line\">&lt;&#x2F;span&gt;</span><br></pre></td></tr></table></figure>\n\n<p>二连之后就会发现，当你的博客在 PC 端以一个正常宽度显示的时候，页脚会是这个样子：</p>\n<div style=\"text-align: center;\">\n    <img src=\"/2019/09/15/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-03-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/normal_footer.png\" alt=\"normal_footer\">\n</div>\n\n<p>当你使用移动端或将 PC 端页面宽度缩小时，会变成这样：</p>\n<div style=\"text-align: center;\">\n    <img src=\"/2019/09/15/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-03-%E6%B7%BB%E5%8A%A0%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1/mini_footer.png\" alt=\"mini_footer\">\n</div>\n\n<h3 id=\"加入备案号\"><a href=\"#加入备案号\" class=\"headerlink\" title=\"加入备案号\"></a>加入备案号</h3><p>紧接着上一步加入的那些代码，在他们之前，加入以下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% if theme.post_wordcount.item_text %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-item-text\"</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span><span class=\"symbol\">&amp;nbsp;</span>|<span class=\"symbol\">&amp;nbsp;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-item-icon\"</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa fa-search\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> 备案号<span class=\"symbol\">&amp;#58;</span> <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span> = <span class=\"string\">\"http://www.beian.miit.gov.cn\"</span>&gt;</span>陕ICP备xxxxxxxx号<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>\n\n<div class=\"note info\">这个已经优化过了，当页面缩小的时候这个备案号直接就会消失掉！</div>\n\n<div class=\"note info\">可能有一些细心的小伙伴们已经发现了，我们控制它在特定宽度下的显示问题就是利用了 <code>theme.post_wordcount.item_text</code> 这个值，那么你也就可以将它用到其他地方了！</div>\n\n<h3 id=\"博客全站人数显示问题\"><a href=\"#博客全站人数显示问题\" class=\"headerlink\" title=\"博客全站人数显示问题\"></a>博客全站人数显示问题</h3><p>如果你的服务器加载速度有点堪忧（就像我的学生机一样），那么你刷新页面后迅速看你的 <code>busuanzi</code> 统计博客人数，会发现变成了这样（没有图，大家意会一下）：</p>\n<div class=\"note info\">博客全站共计访客：人</div>\n\n<p>直到你的插件加载 OK 之后，才会正常的显示人数，但是这一点足够逼疯一些强迫症患者了，我随即研究了一下它这个显示人数的原理，就是替换掉了那个 <code>&lt;span&gt;</code> 标签中的东西，那么我们可以写成这样：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_container_site_pv\"</span>&gt;</span></span><br><span class=\"line\">    &#123;% if theme.post_wordcount.item_text %&#125;</span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"post-meta-item-text\"</span>&gt;</span>博客全站共计访客<span class=\"symbol\">&amp;#58;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">    &#123;% endif %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">id</span>=<span class=\"string\">\"busuanzi_value_site_pv\"</span>&gt;</span> ???<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span> 人</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>这样即使我们的插件没有加载好，它也会显示：</p>\n<div class=\"note info\">博客全站共计访客：???人</div>\n\n<p>是不是比之前能看起来更舒服一些了~ 当插件加载好之后会直接替换掉 <code>???</code> 转而显示数字，赞！</p>\n<h2 id=\"参考文章\"><a href=\"#参考文章\" class=\"headerlink\" title=\"参考文章\"></a>参考文章</h2><ul>\n<li><a href=\"https://lewky.cn\" target=\"_blank\" rel=\"noopener\">Yulin Lewis’s Blog</a></li>\n<li><a href=\"https://io-oi.me/tech/hexo-next-optimization/#\" target=\"_blank\" rel=\"noopener\">打造个性超赞博客 Hexo + NexT + GitHub Pages 的超深度优化</a></li>\n<li><a href=\"https://www.cnblogs.com/php-linux/p/8418518.html\" target=\"_blank\" rel=\"noopener\">Hexo添加字数统计、阅读时长</a></li>\n</ul>"},{"title":"Hexo-NexT魔改系列-04-进阶设置","date":"2019-09-23T04:27:40.000Z","copyright":true,"_content":"\n\n> <span class = 'introduction'>没有退路的时候，正是潜力发挥最大的时候。</span><br/>\nHey~ 这里有你不知道的一些进阶 CSS 配置哦~ 来这里看看吧！<br/>完结撒花！！！\n\n<!--more-->\n\n<hr/>\n\n## 页脚美化\n\n首先来康康效果图哟:\n\n<div style = \"text-align: center;\">\n    <img src = \"footer.png\" alt = \"footer\"></img>\n</div>\n\n接下来将一步步带领大家美化你的页脚！\n\n<div class = \"note info\">在我的 <a href = \"http://www.wqh4u.cn/2019/09/15/Hexo-NexT魔改系列-03-添加数据统计/\">这篇博客</a> 已经有对即将要修改的文件的初始操作，还请各位小伙伴首先阅读链接中的博客哦</div>\n\n### 跳动的心\n\n首先编辑你的博客中的 <span class = \"purple-target\">主题配置文件</span> 修改 `footer` 值：\n\n```yml\nfooter:\n    icon: heart\n```\n\n然后编辑 `/themes/next/layout/_partials/footer.swig` 文件，找到 `<span class=\"with-love\">` 将其修改为：\n\n```html\n<span class=\"with-love\" id=\"heart\">\n```\n\n再编辑 `/themes/next/source/css/_custom/custom.styl` 文件，加入以下代码：\n\n```css\n/* 自定义页脚跳动的心样式 */\n@keyframes heartAnimate {\n    0%,100%{transform:scale(1);}\n    10%,30%{transform:scale(0.9);}\n    20%,40%,60%,80%{transform:scale(1.1);}\n    50%,70%{transform:scale(1.1);}\n}\n#heart {\n    animation: heartAnimate 1.33s ease-in-out infinite;\n}\n.with-love {\n    color: rgb(255, 113, 168);\n}\n```\n\n其中，`color` 的值可以设置成你喜欢的值，灵感来自 <a href = \"\">DIYgod</a> 大佬的博客，CSS代码参考 [这篇文章](https://www.jianshu.com/p/73b46c376188)。\n\n最新版本的 `NexT` 主题已经内嵌支持，无需添加代码，详情参考 [这里](https://theme-next.org/docs/theme-settings/footer)。\n\n### 页脚样式美化\n\n修改 `/themes/next/layout/_partials/footer.swig` 文件，将 `<div class = \"copyright\"></div>` 改为：\n\n```\n<div class=\"copyright custom-footer\">\n```\n\n这里就是加上一个 class 然后你就可以在 `/themes/next/source/css/_custom/custom.styl` 文件中写下你喜欢的样式了~ 这里贴上我的样式作为参考：\n\n```css\n.custom-footer {\n  color: rgba(52, 52, 52, 1.0);\n  border-top: 3px solid #9370db;\n  background-color: rgba(255, 255, 255, 0.75);\n  padding: 10px 0;\n  font-size: 15px;\n}\n```\n\n<hr/>\n\n## SideBar美化\n\n### Side Title\n\n在 `/themes/next/source/css/_custom/custom.styl` 文件中加入以下样式：\n\n```css\n.site-title:hover {\n  webkit-background-clip: text;\n  -webkit-text-fill-color: #000;\n  -webkit-text-stroke: 1px #ddd;\n}\n\n.site-title {\n  display: inline-block;\n  vertical-align: top;\n  line-height: 36px;\n  font-size: 21px;\n  font-weight: 700;\n  font-family: Lato, \"PingFang SC\", \"Microsoft YaHei\", sans-serif;\n  text-shadow: 5px 5px 3px rgba(47, 138, 216, 0.47);\n  color: #329edc;\n}\n```\n\n这个是修改了你的博客左上角的主页按钮，简介的话之前有说，可以使用 `<font>` 来修改颜色。\n\n### 友情链接\n\n修改 <span class = \"purple-target\">主题配置文件</span>，找到 `Blog rolls`，修改为如下：\n\n```yml\n# Blog rolls\nlinks_icon: thumbs-o-up\nlinks_title: 哥哥们的博客\nlinks_layout: block\n#links_layout: inline\nlinks:\n  #Title: http://example.com/\n  【全能选手Hang_ccccc】: https://hangcc.cn\n  【金牌选手LuKe】: https://www.cnblogs.com/317zhang/\n```\n\n就可以啦！\n\n<hr/>\n\n## 自定义样式\n\n众所周知 `MarkDown` 可以变成 `HTML5`，那么我们可以加上自己设置的样式来美化文章，打开 `/themes/next/source/css/_custom/custom.styl`，我在这里贴上我所用的样式供各位小伙伴们参考:\n\n```css\n// Custom styles.\n/* 文章内链接文本样式 */\n.post-body p a,\n.post-body li a {\n  color: #0593d3;\n  border-bottom: none;\n  border-bottom: 1px solid #0593d3;\n\n  &:hover {\n    color: #fc6423;\n    border-bottom: none;\n    border-bottom: 1px solid #fc6423;\n  }\n}\n\n/* 主页文章添加阴影效果 */\n.post {\n  margin-top: 60px;\n  margin-bottom: 60px;\n  padding: 25px;\n  -webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5);\n  -moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5);\n}\n\n/* 背景图片透明度 */\n.backstretch {\n  opacity: .85;\n}\n\n/* 页面透明度 */\n.content-wrap, .sidebar {\n  opacity: .9 !important;\n}\n\n.header-inner {\n  background: rgba(255, 255, 255, 0.9) !important;\n}\n\n/* 去掉图片边框 */\n.posts-expand .post-body img {\n  border: none;\n  padding: 0;\n}\n\n.post-gallery .post-gallery-img img {\n  padding: 3;\n}\n\n.euphoria-footer {\n  color: rgba(52, 52, 52, 1.0);\n  border-top: 3px solid #9370db;\n  background-color: rgba(255, 255, 255, 0.75);\n  padding: 10px 0;\n  font-size: 15px;\n}\n\n/* 自定义页脚跳动的心样式 */\n@keyframes heartAnimate {\n  0%, 100% {\n    transform: scale(1);\n  }\n  10%, 30% {\n    transform: scale(0.9);\n  }\n  20%, 40%, 60%, 80% {\n    transform: scale(1.1);\n  }\n  50%, 70% {\n    transform: scale(1.1);\n  }\n}\n\n#heart {\n  animation: heartAnimate 1.33s ease-in-out infinite;\n}\n\n.with-love {\n  color: rgb(255, 113, 168);\n}\n\n/* 自定义的侧栏时间样式 */\n#days {\n  display: block;\n  color: #007FFF;\n  font-size: 14px;\n  margin-top: 15px;\n}\n\n/*By Euphoria*/\n\n.introduction {\n  color: #ff0000;\n}\n\ntd {\n  text-align: center;\n  vertical-align: bottom;\n}\n\ntd, th {\n  border: 2px solid white;\n  font-size: 18px;\n}\n\nth {\n  background-color: #337ab7;\n  color: white;\n}\n\n.code {\n  text-align: left;\n  font-size: 14px;\n}\n\ncode {\n  color: rgba(213, 0, 252, 0.91);\n  background: rgba(78, 240, 233, 0.55);\n  margin: 0 4px;\n  font-size: .9em;\n  border: 1px solid #d6d6d6;\n  border-radius: 3px;\n  padding: 2px 4px;\n  word-wrap: break-word;\n}\n\ncode, pre {\n  font-family: consolas, Menlo, \"PingFang SC\", \"Microsoft YaHei\", monospace;\n}\n\n.blue-target {\n  padding: 3px 5px;\n  margin: 0 4px;\n  font-size: 16px;\n  font-weight: 700;\n  color: white;\n  background-color: #337ab7;\n  border-radius: 6px 6px 6px 6px;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n}\n\n.purple-target {\n  padding: 3px 5px;\n  margin: 0 4px;\n  font-size: 16px;\n  font-weight: 700;\n  color: white;\n  background-color: #9954bb;\n  border-radius: 6px 6px 6px 6px;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n}\n\n.green-target {\n  padding: 3px 5px;\n  margin: 0 4px;\n  font-size: 16px;\n  font-weight: 700;\n  color: white;\n  background-color: #2b6600;\n  border-radius: 6px 6px 6px 6px;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n}\n\n.red-target {\n  padding: 3px 5px;\n  margin: 0 4px;\n  font-size: 16px;\n  font-weight: 700;\n  color: white;\n  background-color: #ff0000;\n  border-radius: 6px 6px 6px 6px;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n}\n\n.post-body h2 {\n  background: #2b6695;\n  border-radius: 6px 6px 6px 6px;\n  border: none;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n  color: #fff;\n  font-family: \"微软雅黑\", \"宋体\", \"黑体\", Arial;\n  font-weight: 700;\n  line-height: 1.3;\n  margin: 18px 0 18px -10px !important;\n  padding: 10px;\n  text-shadow: 2px 2px 3px #222;\n  font-size: 1.45em;\n  display: block;\n}\n\n.post-body h3 {\n  background: #2b6600;\n  border-radius: 6px 6px 6px 6px;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n  color: #fff;\n  font-family: \"微软雅黑\", \"宋体\", \"黑体\", Arial;\n  font-size: 1.2em;\n  font-weight: 700;\n  line-height: 1.5;\n  margin: 12px 0 12px -3px !important;\n  padding: 5px 10px 3px 10px;\n  text-shadow: 2px 2px 3px #222;\n  border-bottom: 1px solid #eee;\n  display: block;\n}\n\n.post-body h4 {\n  background: rgba(103, 58, 183, 0.72);\n  border-radius: 6px 6px 6px 6px;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n  color: #fff;\n  font-family: \"微软雅黑\", \"宋体\", \"黑体\", Arial;\n  font-size: 1em;\n  font-weight: 700;\n  line-height: 1.5;\n  margin: 12px 0 12px -3px !important;\n  padding: 5px 10px 3px 10px;\n  text-shadow: 2px 2px 3px #222;\n  border-bottom: 1px solid #eee;\n  display: block;\n}\n\n.post-body h2 code, .post-body h3 code, .post-body h4 code {\n  font-size: inherit;\n  color: #f7ab01;\n  background: 0 0;\n  border: none;\n}\n\n.site-title:hover {\n  webkit-background-clip: text;\n  -webkit-text-fill-color: #000;\n  -webkit-text-stroke: 1px #ddd;\n}\n\n.site-title {\n  display: inline-block;\n  vertical-align: top;\n  line-height: 36px;\n  font-size: 21px;\n  font-weight: 700;\n  font-family: Lato, \"PingFang SC\", \"Microsoft YaHei\", sans-serif;\n  text-shadow: 5px 5px 3px rgba(47, 138, 216, 0.47);\n  color: #329edc;\n}\n\n.note {\n  position: relative;\n  padding: 15px;\n  margin-bottom: 20px;\n  border: initial;\n  border-left: 3px solid #eee;\n  background-color: #f9f9f9;\n  border-radius: 3px;\n}\n\n.note.info {\n  background-color: #eef7fa;\n  border-left-color: #428bca;\n}\n\n.post-tags {\n  margin-top: 0;\n}\n\n.post-widgets {\n  padding-top: 10px;\n  padding-bottom: 25px;\n  margin-top: 0;\n}\n```\n\n<hr/>\n\n<div class = \"info note\">\n至此，我们的 <code>Hexo-NexT魔改系列</code> 暂时告一段落了（要找工作辽顶不住），有问题或者更好的建议的小伙伴可以在下方留言或添加 QQ 879969355 来找到菜鸡本人。<br/>祝各位的博客越变越漂亮~<br/><br/><span class = \"red-target\">(完结撒花)</span></div>","source":"_posts/Hexo-NexT魔改系列-04-进阶设置.md","raw":"---\ntitle: Hexo-NexT魔改系列-04-进阶设置\ndate: 2019-09-23 12:27:40\ntags:\n- Hexo\n- NexT\n- 魔改\n- 瞎折腾\ncategories:\n- Hexo\n- NexT\n- 魔改\ncopyright: true\n---\n\n\n> <span class = 'introduction'>没有退路的时候，正是潜力发挥最大的时候。</span><br/>\nHey~ 这里有你不知道的一些进阶 CSS 配置哦~ 来这里看看吧！<br/>完结撒花！！！\n\n<!--more-->\n\n<hr/>\n\n## 页脚美化\n\n首先来康康效果图哟:\n\n<div style = \"text-align: center;\">\n    <img src = \"footer.png\" alt = \"footer\"></img>\n</div>\n\n接下来将一步步带领大家美化你的页脚！\n\n<div class = \"note info\">在我的 <a href = \"http://www.wqh4u.cn/2019/09/15/Hexo-NexT魔改系列-03-添加数据统计/\">这篇博客</a> 已经有对即将要修改的文件的初始操作，还请各位小伙伴首先阅读链接中的博客哦</div>\n\n### 跳动的心\n\n首先编辑你的博客中的 <span class = \"purple-target\">主题配置文件</span> 修改 `footer` 值：\n\n```yml\nfooter:\n    icon: heart\n```\n\n然后编辑 `/themes/next/layout/_partials/footer.swig` 文件，找到 `<span class=\"with-love\">` 将其修改为：\n\n```html\n<span class=\"with-love\" id=\"heart\">\n```\n\n再编辑 `/themes/next/source/css/_custom/custom.styl` 文件，加入以下代码：\n\n```css\n/* 自定义页脚跳动的心样式 */\n@keyframes heartAnimate {\n    0%,100%{transform:scale(1);}\n    10%,30%{transform:scale(0.9);}\n    20%,40%,60%,80%{transform:scale(1.1);}\n    50%,70%{transform:scale(1.1);}\n}\n#heart {\n    animation: heartAnimate 1.33s ease-in-out infinite;\n}\n.with-love {\n    color: rgb(255, 113, 168);\n}\n```\n\n其中，`color` 的值可以设置成你喜欢的值，灵感来自 <a href = \"\">DIYgod</a> 大佬的博客，CSS代码参考 [这篇文章](https://www.jianshu.com/p/73b46c376188)。\n\n最新版本的 `NexT` 主题已经内嵌支持，无需添加代码，详情参考 [这里](https://theme-next.org/docs/theme-settings/footer)。\n\n### 页脚样式美化\n\n修改 `/themes/next/layout/_partials/footer.swig` 文件，将 `<div class = \"copyright\"></div>` 改为：\n\n```\n<div class=\"copyright custom-footer\">\n```\n\n这里就是加上一个 class 然后你就可以在 `/themes/next/source/css/_custom/custom.styl` 文件中写下你喜欢的样式了~ 这里贴上我的样式作为参考：\n\n```css\n.custom-footer {\n  color: rgba(52, 52, 52, 1.0);\n  border-top: 3px solid #9370db;\n  background-color: rgba(255, 255, 255, 0.75);\n  padding: 10px 0;\n  font-size: 15px;\n}\n```\n\n<hr/>\n\n## SideBar美化\n\n### Side Title\n\n在 `/themes/next/source/css/_custom/custom.styl` 文件中加入以下样式：\n\n```css\n.site-title:hover {\n  webkit-background-clip: text;\n  -webkit-text-fill-color: #000;\n  -webkit-text-stroke: 1px #ddd;\n}\n\n.site-title {\n  display: inline-block;\n  vertical-align: top;\n  line-height: 36px;\n  font-size: 21px;\n  font-weight: 700;\n  font-family: Lato, \"PingFang SC\", \"Microsoft YaHei\", sans-serif;\n  text-shadow: 5px 5px 3px rgba(47, 138, 216, 0.47);\n  color: #329edc;\n}\n```\n\n这个是修改了你的博客左上角的主页按钮，简介的话之前有说，可以使用 `<font>` 来修改颜色。\n\n### 友情链接\n\n修改 <span class = \"purple-target\">主题配置文件</span>，找到 `Blog rolls`，修改为如下：\n\n```yml\n# Blog rolls\nlinks_icon: thumbs-o-up\nlinks_title: 哥哥们的博客\nlinks_layout: block\n#links_layout: inline\nlinks:\n  #Title: http://example.com/\n  【全能选手Hang_ccccc】: https://hangcc.cn\n  【金牌选手LuKe】: https://www.cnblogs.com/317zhang/\n```\n\n就可以啦！\n\n<hr/>\n\n## 自定义样式\n\n众所周知 `MarkDown` 可以变成 `HTML5`，那么我们可以加上自己设置的样式来美化文章，打开 `/themes/next/source/css/_custom/custom.styl`，我在这里贴上我所用的样式供各位小伙伴们参考:\n\n```css\n// Custom styles.\n/* 文章内链接文本样式 */\n.post-body p a,\n.post-body li a {\n  color: #0593d3;\n  border-bottom: none;\n  border-bottom: 1px solid #0593d3;\n\n  &:hover {\n    color: #fc6423;\n    border-bottom: none;\n    border-bottom: 1px solid #fc6423;\n  }\n}\n\n/* 主页文章添加阴影效果 */\n.post {\n  margin-top: 60px;\n  margin-bottom: 60px;\n  padding: 25px;\n  -webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5);\n  -moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5);\n}\n\n/* 背景图片透明度 */\n.backstretch {\n  opacity: .85;\n}\n\n/* 页面透明度 */\n.content-wrap, .sidebar {\n  opacity: .9 !important;\n}\n\n.header-inner {\n  background: rgba(255, 255, 255, 0.9) !important;\n}\n\n/* 去掉图片边框 */\n.posts-expand .post-body img {\n  border: none;\n  padding: 0;\n}\n\n.post-gallery .post-gallery-img img {\n  padding: 3;\n}\n\n.euphoria-footer {\n  color: rgba(52, 52, 52, 1.0);\n  border-top: 3px solid #9370db;\n  background-color: rgba(255, 255, 255, 0.75);\n  padding: 10px 0;\n  font-size: 15px;\n}\n\n/* 自定义页脚跳动的心样式 */\n@keyframes heartAnimate {\n  0%, 100% {\n    transform: scale(1);\n  }\n  10%, 30% {\n    transform: scale(0.9);\n  }\n  20%, 40%, 60%, 80% {\n    transform: scale(1.1);\n  }\n  50%, 70% {\n    transform: scale(1.1);\n  }\n}\n\n#heart {\n  animation: heartAnimate 1.33s ease-in-out infinite;\n}\n\n.with-love {\n  color: rgb(255, 113, 168);\n}\n\n/* 自定义的侧栏时间样式 */\n#days {\n  display: block;\n  color: #007FFF;\n  font-size: 14px;\n  margin-top: 15px;\n}\n\n/*By Euphoria*/\n\n.introduction {\n  color: #ff0000;\n}\n\ntd {\n  text-align: center;\n  vertical-align: bottom;\n}\n\ntd, th {\n  border: 2px solid white;\n  font-size: 18px;\n}\n\nth {\n  background-color: #337ab7;\n  color: white;\n}\n\n.code {\n  text-align: left;\n  font-size: 14px;\n}\n\ncode {\n  color: rgba(213, 0, 252, 0.91);\n  background: rgba(78, 240, 233, 0.55);\n  margin: 0 4px;\n  font-size: .9em;\n  border: 1px solid #d6d6d6;\n  border-radius: 3px;\n  padding: 2px 4px;\n  word-wrap: break-word;\n}\n\ncode, pre {\n  font-family: consolas, Menlo, \"PingFang SC\", \"Microsoft YaHei\", monospace;\n}\n\n.blue-target {\n  padding: 3px 5px;\n  margin: 0 4px;\n  font-size: 16px;\n  font-weight: 700;\n  color: white;\n  background-color: #337ab7;\n  border-radius: 6px 6px 6px 6px;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n}\n\n.purple-target {\n  padding: 3px 5px;\n  margin: 0 4px;\n  font-size: 16px;\n  font-weight: 700;\n  color: white;\n  background-color: #9954bb;\n  border-radius: 6px 6px 6px 6px;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n}\n\n.green-target {\n  padding: 3px 5px;\n  margin: 0 4px;\n  font-size: 16px;\n  font-weight: 700;\n  color: white;\n  background-color: #2b6600;\n  border-radius: 6px 6px 6px 6px;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n}\n\n.red-target {\n  padding: 3px 5px;\n  margin: 0 4px;\n  font-size: 16px;\n  font-weight: 700;\n  color: white;\n  background-color: #ff0000;\n  border-radius: 6px 6px 6px 6px;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n}\n\n.post-body h2 {\n  background: #2b6695;\n  border-radius: 6px 6px 6px 6px;\n  border: none;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n  color: #fff;\n  font-family: \"微软雅黑\", \"宋体\", \"黑体\", Arial;\n  font-weight: 700;\n  line-height: 1.3;\n  margin: 18px 0 18px -10px !important;\n  padding: 10px;\n  text-shadow: 2px 2px 3px #222;\n  font-size: 1.45em;\n  display: block;\n}\n\n.post-body h3 {\n  background: #2b6600;\n  border-radius: 6px 6px 6px 6px;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n  color: #fff;\n  font-family: \"微软雅黑\", \"宋体\", \"黑体\", Arial;\n  font-size: 1.2em;\n  font-weight: 700;\n  line-height: 1.5;\n  margin: 12px 0 12px -3px !important;\n  padding: 5px 10px 3px 10px;\n  text-shadow: 2px 2px 3px #222;\n  border-bottom: 1px solid #eee;\n  display: block;\n}\n\n.post-body h4 {\n  background: rgba(103, 58, 183, 0.72);\n  border-radius: 6px 6px 6px 6px;\n  box-shadow: 0 0 0 1px #5f5a4b, 1px 1px 6px 1px rgba(10, 10, 0, 0.5);\n  color: #fff;\n  font-family: \"微软雅黑\", \"宋体\", \"黑体\", Arial;\n  font-size: 1em;\n  font-weight: 700;\n  line-height: 1.5;\n  margin: 12px 0 12px -3px !important;\n  padding: 5px 10px 3px 10px;\n  text-shadow: 2px 2px 3px #222;\n  border-bottom: 1px solid #eee;\n  display: block;\n}\n\n.post-body h2 code, .post-body h3 code, .post-body h4 code {\n  font-size: inherit;\n  color: #f7ab01;\n  background: 0 0;\n  border: none;\n}\n\n.site-title:hover {\n  webkit-background-clip: text;\n  -webkit-text-fill-color: #000;\n  -webkit-text-stroke: 1px #ddd;\n}\n\n.site-title {\n  display: inline-block;\n  vertical-align: top;\n  line-height: 36px;\n  font-size: 21px;\n  font-weight: 700;\n  font-family: Lato, \"PingFang SC\", \"Microsoft YaHei\", sans-serif;\n  text-shadow: 5px 5px 3px rgba(47, 138, 216, 0.47);\n  color: #329edc;\n}\n\n.note {\n  position: relative;\n  padding: 15px;\n  margin-bottom: 20px;\n  border: initial;\n  border-left: 3px solid #eee;\n  background-color: #f9f9f9;\n  border-radius: 3px;\n}\n\n.note.info {\n  background-color: #eef7fa;\n  border-left-color: #428bca;\n}\n\n.post-tags {\n  margin-top: 0;\n}\n\n.post-widgets {\n  padding-top: 10px;\n  padding-bottom: 25px;\n  margin-top: 0;\n}\n```\n\n<hr/>\n\n<div class = \"info note\">\n至此，我们的 <code>Hexo-NexT魔改系列</code> 暂时告一段落了（要找工作辽顶不住），有问题或者更好的建议的小伙伴可以在下方留言或添加 QQ 879969355 来找到菜鸡本人。<br/>祝各位的博客越变越漂亮~<br/><br/><span class = \"red-target\">(完结撒花)</span></div>","slug":"Hexo-NexT魔改系列-04-进阶设置","published":1,"updated":"2020-01-14T20:30:46.533Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn5e000a2lwjd6w6fv0u","content":"<blockquote>\n<p><span class=\"introduction\">没有退路的时候，正是潜力发挥最大的时候。</span><br><br>Hey~ 这里有你不知道的一些进阶 CSS 配置哦~ 来这里看看吧！<br>完结撒花！！！</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"页脚美化\"><a href=\"#页脚美化\" class=\"headerlink\" title=\"页脚美化\"></a>页脚美化</h2><p>首先来康康效果图哟:</p>\n<div style=\"text-align: center;\">\n    <img src=\"/2019/09/23/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-04-%E8%BF%9B%E9%98%B6%E8%AE%BE%E7%BD%AE/footer.png\" alt=\"footer\">\n</div>\n\n<p>接下来将一步步带领大家美化你的页脚！</p>\n<div class=\"note info\">在我的 <a href=\"http://www.wqh4u.cn/2019/09/15/Hexo-NexT魔改系列-03-添加数据统计/\">这篇博客</a> 已经有对即将要修改的文件的初始操作，还请各位小伙伴首先阅读链接中的博客哦</div>\n\n<h3 id=\"跳动的心\"><a href=\"#跳动的心\" class=\"headerlink\" title=\"跳动的心\"></a>跳动的心</h3><p>首先编辑你的博客中的 <span class=\"purple-target\">主题配置文件</span> 修改 <code>footer</code> 值：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">footer:</span></span><br><span class=\"line\">    <span class=\"attr\">icon:</span> <span class=\"string\">heart</span></span><br></pre></td></tr></table></figure>\n\n<p>然后编辑 <code>/themes/next/layout/_partials/footer.swig</code> 文件，找到 <code>&lt;span class=&quot;with-love&quot;&gt;</code> 将其修改为：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"with-love\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"heart\"</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>再编辑 <code>/themes/next/source/css/_custom/custom.styl</code> 文件，加入以下代码：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 自定义页脚跳动的心样式 */</span></span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> heartAnimate &#123;</span><br><span class=\"line\">    0%,100%&#123;<span class=\"attribute\">transform</span>:<span class=\"built_in\">scale</span>(<span class=\"number\">1</span>);&#125;</span><br><span class=\"line\">    10%,30%&#123;<span class=\"attribute\">transform</span>:<span class=\"built_in\">scale</span>(<span class=\"number\">0.9</span>);&#125;</span><br><span class=\"line\">    20%,40%,60%,80%&#123;<span class=\"attribute\">transform</span>:<span class=\"built_in\">scale</span>(<span class=\"number\">1.1</span>);&#125;</span><br><span class=\"line\">    50%,70%&#123;<span class=\"attribute\">transform</span>:<span class=\"built_in\">scale</span>(<span class=\"number\">1.1</span>);&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-id\">#heart</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">animation</span>: heartAnimate <span class=\"number\">1.33s</span> ease-in-out infinite;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.with-love</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"built_in\">rgb</span>(<span class=\"number\">255</span>, <span class=\"number\">113</span>, <span class=\"number\">168</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>其中，<code>color</code> 的值可以设置成你喜欢的值，灵感来自 <a href>DIYgod</a> 大佬的博客，CSS代码参考 <a href=\"https://www.jianshu.com/p/73b46c376188\" target=\"_blank\" rel=\"noopener\">这篇文章</a>。</p>\n<p>最新版本的 <code>NexT</code> 主题已经内嵌支持，无需添加代码，详情参考 <a href=\"https://theme-next.org/docs/theme-settings/footer\" target=\"_blank\" rel=\"noopener\">这里</a>。</p>\n<h3 id=\"页脚样式美化\"><a href=\"#页脚样式美化\" class=\"headerlink\" title=\"页脚样式美化\"></a>页脚样式美化</h3><p>修改 <code>/themes/next/layout/_partials/footer.swig</code> 文件，将 <code>&lt;div class = &quot;copyright&quot;&gt;&lt;/div&gt;</code> 改为：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;div class&#x3D;&quot;copyright custom-footer&quot;&gt;</span><br></pre></td></tr></table></figure>\n\n<p>这里就是加上一个 class 然后你就可以在 <code>/themes/next/source/css/_custom/custom.styl</code> 文件中写下你喜欢的样式了~ 这里贴上我的样式作为参考：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.custom-footer</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">52</span>, <span class=\"number\">52</span>, <span class=\"number\">52</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">  <span class=\"attribute\">border-top</span>: <span class=\"number\">3px</span> solid <span class=\"number\">#9370db</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">0.75</span>);</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">10px</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"SideBar美化\"><a href=\"#SideBar美化\" class=\"headerlink\" title=\"SideBar美化\"></a>SideBar美化</h2><h3 id=\"Side-Title\"><a href=\"#Side-Title\" class=\"headerlink\" title=\"Side Title\"></a>Side Title</h3><p>在 <code>/themes/next/source/css/_custom/custom.styl</code> 文件中加入以下样式：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.site-title</span><span class=\"selector-pseudo\">:hover</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">webkit-background-clip</span>: text;</span><br><span class=\"line\">  <span class=\"attribute\">-webkit-text-fill-color</span>: <span class=\"number\">#000</span>;</span><br><span class=\"line\">  <span class=\"attribute\">-webkit-text-stroke</span>: <span class=\"number\">1px</span> <span class=\"number\">#ddd</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.site-title</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: inline-block;</span><br><span class=\"line\">  <span class=\"attribute\">vertical-align</span>: top;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">36px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">21px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-family</span>: Lato, <span class=\"string\">\"PingFang SC\"</span>, <span class=\"string\">\"Microsoft YaHei\"</span>, sans-serif;</span><br><span class=\"line\">  <span class=\"attribute\">text-shadow</span>: <span class=\"number\">5px</span> <span class=\"number\">5px</span> <span class=\"number\">3px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">47</span>, <span class=\"number\">138</span>, <span class=\"number\">216</span>, <span class=\"number\">0.47</span>);</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#329edc</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>这个是修改了你的博客左上角的主页按钮，简介的话之前有说，可以使用 <code>&lt;font&gt;</code> 来修改颜色。</p>\n<h3 id=\"友情链接\"><a href=\"#友情链接\" class=\"headerlink\" title=\"友情链接\"></a>友情链接</h3><p>修改 <span class=\"purple-target\">主题配置文件</span>，找到 <code>Blog rolls</code>，修改为如下：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Blog rolls</span></span><br><span class=\"line\"><span class=\"attr\">links_icon:</span> <span class=\"string\">thumbs-o-up</span></span><br><span class=\"line\"><span class=\"attr\">links_title:</span> <span class=\"string\">哥哥们的博客</span></span><br><span class=\"line\"><span class=\"attr\">links_layout:</span> <span class=\"string\">block</span></span><br><span class=\"line\"><span class=\"comment\">#links_layout: inline</span></span><br><span class=\"line\"><span class=\"attr\">links:</span></span><br><span class=\"line\">  <span class=\"comment\">#Title: http://example.com/</span></span><br><span class=\"line\">  <span class=\"string\">【全能选手Hang_ccccc】:</span> <span class=\"string\">https://hangcc.cn</span></span><br><span class=\"line\">  <span class=\"string\">【金牌选手LuKe】:</span> <span class=\"string\">https://www.cnblogs.com/317zhang/</span></span><br></pre></td></tr></table></figure>\n\n<p>就可以啦！</p>\n<hr>\n\n<h2 id=\"自定义样式\"><a href=\"#自定义样式\" class=\"headerlink\" title=\"自定义样式\"></a>自定义样式</h2><p>众所周知 <code>MarkDown</code> 可以变成 <code>HTML5</code>，那么我们可以加上自己设置的样式来美化文章，打开 <code>/themes/next/source/css/_custom/custom.styl</code>，我在这里贴上我所用的样式供各位小伙伴们参考:</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Custom styles.</span><br><span class=\"line\"><span class=\"comment\">/* 文章内链接文本样式 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">p</span> <span class=\"selector-tag\">a</span>,</span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">li</span> <span class=\"selector-tag\">a</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#0593d3</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>: none;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#0593d3</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  &amp;:hover &#123;</span><br><span class=\"line\">    <span class=\"selector-tag\">color</span>: <span class=\"selector-id\">#fc6423</span>;</span><br><span class=\"line\">    <span class=\"selector-tag\">border-bottom</span>: <span class=\"selector-tag\">none</span>;</span><br><span class=\"line\">    <span class=\"selector-tag\">border-bottom</span>: 1<span class=\"selector-tag\">px</span> <span class=\"selector-tag\">solid</span> <span class=\"selector-id\">#fc6423</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 主页文章添加阴影效果 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.post</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">margin-top</span>: <span class=\"number\">60px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin-bottom</span>: <span class=\"number\">60px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">-webkit-box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">5px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">202</span>, <span class=\"number\">203</span>, <span class=\"number\">203</span>, .<span class=\"number\">5</span>);</span><br><span class=\"line\">  <span class=\"attribute\">-moz-box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">5px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">202</span>, <span class=\"number\">203</span>, <span class=\"number\">204</span>, .<span class=\"number\">5</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 背景图片透明度 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.backstretch</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">opacity</span>: .<span class=\"number\">85</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 页面透明度 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.content-wrap</span>, <span class=\"selector-class\">.sidebar</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">opacity</span>: .<span class=\"number\">9</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.header-inner</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">0.9</span>) <span class=\"meta\">!important</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 去掉图片边框 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.posts-expand</span> <span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">img</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: none;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-gallery</span> <span class=\"selector-class\">.post-gallery-img</span> <span class=\"selector-tag\">img</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">3</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.euphoria-footer</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">52</span>, <span class=\"number\">52</span>, <span class=\"number\">52</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">  <span class=\"attribute\">border-top</span>: <span class=\"number\">3px</span> solid <span class=\"number\">#9370db</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">0.75</span>);</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">10px</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 自定义页脚跳动的心样式 */</span></span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> heartAnimate &#123;</span><br><span class=\"line\">  0%, 100% &#123;</span><br><span class=\"line\">    <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  10%, 30% &#123;</span><br><span class=\"line\">    <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale</span>(<span class=\"number\">0.9</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  20%, 40%, 60%, 80% &#123;</span><br><span class=\"line\">    <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale</span>(<span class=\"number\">1.1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  50%, 70% &#123;</span><br><span class=\"line\">    <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale</span>(<span class=\"number\">1.1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#heart</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">animation</span>: heartAnimate <span class=\"number\">1.33s</span> ease-in-out infinite;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.with-love</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"built_in\">rgb</span>(<span class=\"number\">255</span>, <span class=\"number\">113</span>, <span class=\"number\">168</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 自定义的侧栏时间样式 */</span></span><br><span class=\"line\"><span class=\"selector-id\">#days</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#007FFF</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">14px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin-top</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*By Euphoria*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.introduction</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#ff0000</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">td</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">  <span class=\"attribute\">vertical-align</span>: bottom;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">td</span>, <span class=\"selector-tag\">th</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: <span class=\"number\">2px</span> solid white;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">18px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">th</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#337ab7</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: white;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.code</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">text-align</span>: left;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">14px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">code</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">213</span>, <span class=\"number\">0</span>, <span class=\"number\">252</span>, <span class=\"number\">0.91</span>);</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">78</span>, <span class=\"number\">240</span>, <span class=\"number\">233</span>, <span class=\"number\">0.55</span>);</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> <span class=\"number\">4px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: .<span class=\"number\">9em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#d6d6d6</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">3px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">2px</span> <span class=\"number\">4px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">word-wrap</span>: break-word;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">code</span>, <span class=\"selector-tag\">pre</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">font-family</span>: consolas, Menlo, <span class=\"string\">\"PingFang SC\"</span>, <span class=\"string\">\"Microsoft YaHei\"</span>, monospace;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.blue-target</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">3px</span> <span class=\"number\">5px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> <span class=\"number\">4px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">16px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: white;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#337ab7</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.purple-target</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">3px</span> <span class=\"number\">5px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> <span class=\"number\">4px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">16px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: white;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#9954bb</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.green-target</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">3px</span> <span class=\"number\">5px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> <span class=\"number\">4px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">16px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: white;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#2b6600</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.red-target</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">3px</span> <span class=\"number\">5px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> <span class=\"number\">4px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">16px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: white;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#ff0000</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">h2</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"number\">#2b6695</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: none;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-family</span>: <span class=\"string\">\"微软雅黑\"</span>, <span class=\"string\">\"宋体\"</span>, <span class=\"string\">\"黑体\"</span>, Arial;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">1.3</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">18px</span> <span class=\"number\">0</span> <span class=\"number\">18px</span> -<span class=\"number\">10px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">text-shadow</span>: <span class=\"number\">2px</span> <span class=\"number\">2px</span> <span class=\"number\">3px</span> <span class=\"number\">#222</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">1.45em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">h3</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"number\">#2b6600</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-family</span>: <span class=\"string\">\"微软雅黑\"</span>, <span class=\"string\">\"宋体\"</span>, <span class=\"string\">\"黑体\"</span>, Arial;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">1.2em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">1.5</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">12px</span> <span class=\"number\">0</span> <span class=\"number\">12px</span> -<span class=\"number\">3px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">5px</span> <span class=\"number\">10px</span> <span class=\"number\">3px</span> <span class=\"number\">10px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">text-shadow</span>: <span class=\"number\">2px</span> <span class=\"number\">2px</span> <span class=\"number\">3px</span> <span class=\"number\">#222</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#eee</span>;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">h4</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">103</span>, <span class=\"number\">58</span>, <span class=\"number\">183</span>, <span class=\"number\">0.72</span>);</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-family</span>: <span class=\"string\">\"微软雅黑\"</span>, <span class=\"string\">\"宋体\"</span>, <span class=\"string\">\"黑体\"</span>, Arial;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">1em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">1.5</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">12px</span> <span class=\"number\">0</span> <span class=\"number\">12px</span> -<span class=\"number\">3px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">5px</span> <span class=\"number\">10px</span> <span class=\"number\">3px</span> <span class=\"number\">10px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">text-shadow</span>: <span class=\"number\">2px</span> <span class=\"number\">2px</span> <span class=\"number\">3px</span> <span class=\"number\">#222</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#eee</span>;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">h2</span> <span class=\"selector-tag\">code</span>, <span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">h3</span> <span class=\"selector-tag\">code</span>, <span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">h4</span> <span class=\"selector-tag\">code</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: inherit;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#f7ab01</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"number\">0</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.site-title</span><span class=\"selector-pseudo\">:hover</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">webkit-background-clip</span>: text;</span><br><span class=\"line\">  <span class=\"attribute\">-webkit-text-fill-color</span>: <span class=\"number\">#000</span>;</span><br><span class=\"line\">  <span class=\"attribute\">-webkit-text-stroke</span>: <span class=\"number\">1px</span> <span class=\"number\">#ddd</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.site-title</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: inline-block;</span><br><span class=\"line\">  <span class=\"attribute\">vertical-align</span>: top;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">36px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">21px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-family</span>: Lato, <span class=\"string\">\"PingFang SC\"</span>, <span class=\"string\">\"Microsoft YaHei\"</span>, sans-serif;</span><br><span class=\"line\">  <span class=\"attribute\">text-shadow</span>: <span class=\"number\">5px</span> <span class=\"number\">5px</span> <span class=\"number\">3px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">47</span>, <span class=\"number\">138</span>, <span class=\"number\">216</span>, <span class=\"number\">0.47</span>);</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#329edc</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.note</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin-bottom</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: initial;</span><br><span class=\"line\">  <span class=\"attribute\">border-left</span>: <span class=\"number\">3px</span> solid <span class=\"number\">#eee</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#f9f9f9</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">3px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.note</span><span class=\"selector-class\">.info</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#eef7fa</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-left-color</span>: <span class=\"number\">#428bca</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-tags</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">margin-top</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-widgets</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">padding-top</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding-bottom</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin-top</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<div class=\"info note\">\n至此，我们的 <code>Hexo-NexT魔改系列</code> 暂时告一段落了（要找工作辽顶不住），有问题或者更好的建议的小伙伴可以在下方留言或添加 QQ 879969355 来找到菜鸡本人。<br>祝各位的博客越变越漂亮~<br><br><span class=\"red-target\">(完结撒花)</span></div>","site":{"data":{}},"length":7225,"excerpt":"<blockquote>\n<p><span class=\"introduction\">没有退路的时候，正是潜力发挥最大的时候。</span><br><br>Hey~ 这里有你不知道的一些进阶 CSS 配置哦~ 来这里看看吧！<br>完结撒花！！！</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"页脚美化\"><a href=\"#页脚美化\" class=\"headerlink\" title=\"页脚美化\"></a>页脚美化</h2><p>首先来康康效果图哟:</p>\n<div style=\"text-align: center;\">\n    <img src=\"/2019/09/23/Hexo-NexT%E9%AD%94%E6%94%B9%E7%B3%BB%E5%88%97-04-%E8%BF%9B%E9%98%B6%E8%AE%BE%E7%BD%AE/footer.png\" alt=\"footer\">\n</div>\n\n<p>接下来将一步步带领大家美化你的页脚！</p>\n<div class=\"note info\">在我的 <a href=\"http://www.wqh4u.cn/2019/09/15/Hexo-NexT魔改系列-03-添加数据统计/\">这篇博客</a> 已经有对即将要修改的文件的初始操作，还请各位小伙伴首先阅读链接中的博客哦</div>\n\n<h3 id=\"跳动的心\"><a href=\"#跳动的心\" class=\"headerlink\" title=\"跳动的心\"></a>跳动的心</h3><p>首先编辑你的博客中的 <span class=\"purple-target\">主题配置文件</span> 修改 <code>footer</code> 值：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">footer:</span></span><br><span class=\"line\">    <span class=\"attr\">icon:</span> <span class=\"string\">heart</span></span><br></pre></td></tr></table></figure>\n\n<p>然后编辑 <code>/themes/next/layout/_partials/footer.swig</code> 文件，找到 <code>&lt;span class=&quot;with-love&quot;&gt;</code> 将其修改为：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"with-love\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"heart\"</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>再编辑 <code>/themes/next/source/css/_custom/custom.styl</code> 文件，加入以下代码：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* 自定义页脚跳动的心样式 */</span></span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> heartAnimate &#123;</span><br><span class=\"line\">    0%,100%&#123;<span class=\"attribute\">transform</span>:<span class=\"built_in\">scale</span>(<span class=\"number\">1</span>);&#125;</span><br><span class=\"line\">    10%,30%&#123;<span class=\"attribute\">transform</span>:<span class=\"built_in\">scale</span>(<span class=\"number\">0.9</span>);&#125;</span><br><span class=\"line\">    20%,40%,60%,80%&#123;<span class=\"attribute\">transform</span>:<span class=\"built_in\">scale</span>(<span class=\"number\">1.1</span>);&#125;</span><br><span class=\"line\">    50%,70%&#123;<span class=\"attribute\">transform</span>:<span class=\"built_in\">scale</span>(<span class=\"number\">1.1</span>);&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-id\">#heart</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">animation</span>: heartAnimate <span class=\"number\">1.33s</span> ease-in-out infinite;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.with-love</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"built_in\">rgb</span>(<span class=\"number\">255</span>, <span class=\"number\">113</span>, <span class=\"number\">168</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>其中，<code>color</code> 的值可以设置成你喜欢的值，灵感来自 <a href>DIYgod</a> 大佬的博客，CSS代码参考 <a href=\"https://www.jianshu.com/p/73b46c376188\" target=\"_blank\" rel=\"noopener\">这篇文章</a>。</p>\n<p>最新版本的 <code>NexT</code> 主题已经内嵌支持，无需添加代码，详情参考 <a href=\"https://theme-next.org/docs/theme-settings/footer\" target=\"_blank\" rel=\"noopener\">这里</a>。</p>\n<h3 id=\"页脚样式美化\"><a href=\"#页脚样式美化\" class=\"headerlink\" title=\"页脚样式美化\"></a>页脚样式美化</h3><p>修改 <code>/themes/next/layout/_partials/footer.swig</code> 文件，将 <code>&lt;div class = &quot;copyright&quot;&gt;&lt;/div&gt;</code> 改为：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;div class&#x3D;&quot;copyright custom-footer&quot;&gt;</span><br></pre></td></tr></table></figure>\n\n<p>这里就是加上一个 class 然后你就可以在 <code>/themes/next/source/css/_custom/custom.styl</code> 文件中写下你喜欢的样式了~ 这里贴上我的样式作为参考：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.custom-footer</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">52</span>, <span class=\"number\">52</span>, <span class=\"number\">52</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">  <span class=\"attribute\">border-top</span>: <span class=\"number\">3px</span> solid <span class=\"number\">#9370db</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">0.75</span>);</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">10px</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"SideBar美化\"><a href=\"#SideBar美化\" class=\"headerlink\" title=\"SideBar美化\"></a>SideBar美化</h2><h3 id=\"Side-Title\"><a href=\"#Side-Title\" class=\"headerlink\" title=\"Side Title\"></a>Side Title</h3><p>在 <code>/themes/next/source/css/_custom/custom.styl</code> 文件中加入以下样式：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.site-title</span><span class=\"selector-pseudo\">:hover</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">webkit-background-clip</span>: text;</span><br><span class=\"line\">  <span class=\"attribute\">-webkit-text-fill-color</span>: <span class=\"number\">#000</span>;</span><br><span class=\"line\">  <span class=\"attribute\">-webkit-text-stroke</span>: <span class=\"number\">1px</span> <span class=\"number\">#ddd</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.site-title</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: inline-block;</span><br><span class=\"line\">  <span class=\"attribute\">vertical-align</span>: top;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">36px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">21px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-family</span>: Lato, <span class=\"string\">\"PingFang SC\"</span>, <span class=\"string\">\"Microsoft YaHei\"</span>, sans-serif;</span><br><span class=\"line\">  <span class=\"attribute\">text-shadow</span>: <span class=\"number\">5px</span> <span class=\"number\">5px</span> <span class=\"number\">3px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">47</span>, <span class=\"number\">138</span>, <span class=\"number\">216</span>, <span class=\"number\">0.47</span>);</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#329edc</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>这个是修改了你的博客左上角的主页按钮，简介的话之前有说，可以使用 <code>&lt;font&gt;</code> 来修改颜色。</p>\n<h3 id=\"友情链接\"><a href=\"#友情链接\" class=\"headerlink\" title=\"友情链接\"></a>友情链接</h3><p>修改 <span class=\"purple-target\">主题配置文件</span>，找到 <code>Blog rolls</code>，修改为如下：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Blog rolls</span></span><br><span class=\"line\"><span class=\"attr\">links_icon:</span> <span class=\"string\">thumbs-o-up</span></span><br><span class=\"line\"><span class=\"attr\">links_title:</span> <span class=\"string\">哥哥们的博客</span></span><br><span class=\"line\"><span class=\"attr\">links_layout:</span> <span class=\"string\">block</span></span><br><span class=\"line\"><span class=\"comment\">#links_layout: inline</span></span><br><span class=\"line\"><span class=\"attr\">links:</span></span><br><span class=\"line\">  <span class=\"comment\">#Title: http://example.com/</span></span><br><span class=\"line\">  <span class=\"string\">【全能选手Hang_ccccc】:</span> <span class=\"string\">https://hangcc.cn</span></span><br><span class=\"line\">  <span class=\"string\">【金牌选手LuKe】:</span> <span class=\"string\">https://www.cnblogs.com/317zhang/</span></span><br></pre></td></tr></table></figure>\n\n<p>就可以啦！</p>\n<hr>\n\n<h2 id=\"自定义样式\"><a href=\"#自定义样式\" class=\"headerlink\" title=\"自定义样式\"></a>自定义样式</h2><p>众所周知 <code>MarkDown</code> 可以变成 <code>HTML5</code>，那么我们可以加上自己设置的样式来美化文章，打开 <code>/themes/next/source/css/_custom/custom.styl</code>，我在这里贴上我所用的样式供各位小伙伴们参考:</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Custom styles.</span><br><span class=\"line\"><span class=\"comment\">/* 文章内链接文本样式 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">p</span> <span class=\"selector-tag\">a</span>,</span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">li</span> <span class=\"selector-tag\">a</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#0593d3</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>: none;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#0593d3</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  &amp;:hover &#123;</span><br><span class=\"line\">    <span class=\"selector-tag\">color</span>: <span class=\"selector-id\">#fc6423</span>;</span><br><span class=\"line\">    <span class=\"selector-tag\">border-bottom</span>: <span class=\"selector-tag\">none</span>;</span><br><span class=\"line\">    <span class=\"selector-tag\">border-bottom</span>: 1<span class=\"selector-tag\">px</span> <span class=\"selector-tag\">solid</span> <span class=\"selector-id\">#fc6423</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 主页文章添加阴影效果 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.post</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">margin-top</span>: <span class=\"number\">60px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin-bottom</span>: <span class=\"number\">60px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">-webkit-box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">5px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">202</span>, <span class=\"number\">203</span>, <span class=\"number\">203</span>, .<span class=\"number\">5</span>);</span><br><span class=\"line\">  <span class=\"attribute\">-moz-box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">5px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">202</span>, <span class=\"number\">203</span>, <span class=\"number\">204</span>, .<span class=\"number\">5</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 背景图片透明度 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.backstretch</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">opacity</span>: .<span class=\"number\">85</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 页面透明度 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.content-wrap</span>, <span class=\"selector-class\">.sidebar</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">opacity</span>: .<span class=\"number\">9</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.header-inner</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">0.9</span>) <span class=\"meta\">!important</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 去掉图片边框 */</span></span><br><span class=\"line\"><span class=\"selector-class\">.posts-expand</span> <span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">img</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: none;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-gallery</span> <span class=\"selector-class\">.post-gallery-img</span> <span class=\"selector-tag\">img</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">3</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.euphoria-footer</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">52</span>, <span class=\"number\">52</span>, <span class=\"number\">52</span>, <span class=\"number\">1.0</span>);</span><br><span class=\"line\">  <span class=\"attribute\">border-top</span>: <span class=\"number\">3px</span> solid <span class=\"number\">#9370db</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">255</span>, <span class=\"number\">0.75</span>);</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">10px</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 自定义页脚跳动的心样式 */</span></span><br><span class=\"line\"><span class=\"keyword\">@keyframes</span> heartAnimate &#123;</span><br><span class=\"line\">  0%, 100% &#123;</span><br><span class=\"line\">    <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale</span>(<span class=\"number\">1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  10%, 30% &#123;</span><br><span class=\"line\">    <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale</span>(<span class=\"number\">0.9</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  20%, 40%, 60%, 80% &#123;</span><br><span class=\"line\">    <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale</span>(<span class=\"number\">1.1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  50%, 70% &#123;</span><br><span class=\"line\">    <span class=\"attribute\">transform</span>: <span class=\"built_in\">scale</span>(<span class=\"number\">1.1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-id\">#heart</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">animation</span>: heartAnimate <span class=\"number\">1.33s</span> ease-in-out infinite;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.with-love</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"built_in\">rgb</span>(<span class=\"number\">255</span>, <span class=\"number\">113</span>, <span class=\"number\">168</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 自定义的侧栏时间样式 */</span></span><br><span class=\"line\"><span class=\"selector-id\">#days</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#007FFF</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">14px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin-top</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*By Euphoria*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.introduction</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#ff0000</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">td</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">text-align</span>: center;</span><br><span class=\"line\">  <span class=\"attribute\">vertical-align</span>: bottom;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">td</span>, <span class=\"selector-tag\">th</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: <span class=\"number\">2px</span> solid white;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">18px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">th</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#337ab7</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: white;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.code</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">text-align</span>: left;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">14px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">code</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">213</span>, <span class=\"number\">0</span>, <span class=\"number\">252</span>, <span class=\"number\">0.91</span>);</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">78</span>, <span class=\"number\">240</span>, <span class=\"number\">233</span>, <span class=\"number\">0.55</span>);</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> <span class=\"number\">4px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: .<span class=\"number\">9em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#d6d6d6</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">3px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">2px</span> <span class=\"number\">4px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">word-wrap</span>: break-word;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-tag\">code</span>, <span class=\"selector-tag\">pre</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">font-family</span>: consolas, Menlo, <span class=\"string\">\"PingFang SC\"</span>, <span class=\"string\">\"Microsoft YaHei\"</span>, monospace;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.blue-target</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">3px</span> <span class=\"number\">5px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> <span class=\"number\">4px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">16px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: white;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#337ab7</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.purple-target</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">3px</span> <span class=\"number\">5px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> <span class=\"number\">4px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">16px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: white;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#9954bb</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.green-target</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">3px</span> <span class=\"number\">5px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> <span class=\"number\">4px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">16px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: white;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#2b6600</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.red-target</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">3px</span> <span class=\"number\">5px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> <span class=\"number\">4px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">16px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: white;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#ff0000</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">h2</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"number\">#2b6695</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: none;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-family</span>: <span class=\"string\">\"微软雅黑\"</span>, <span class=\"string\">\"宋体\"</span>, <span class=\"string\">\"黑体\"</span>, Arial;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">1.3</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">18px</span> <span class=\"number\">0</span> <span class=\"number\">18px</span> -<span class=\"number\">10px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">text-shadow</span>: <span class=\"number\">2px</span> <span class=\"number\">2px</span> <span class=\"number\">3px</span> <span class=\"number\">#222</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">1.45em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">h3</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"number\">#2b6600</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-family</span>: <span class=\"string\">\"微软雅黑\"</span>, <span class=\"string\">\"宋体\"</span>, <span class=\"string\">\"黑体\"</span>, Arial;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">1.2em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">1.5</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">12px</span> <span class=\"number\">0</span> <span class=\"number\">12px</span> -<span class=\"number\">3px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">5px</span> <span class=\"number\">10px</span> <span class=\"number\">3px</span> <span class=\"number\">10px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">text-shadow</span>: <span class=\"number\">2px</span> <span class=\"number\">2px</span> <span class=\"number\">3px</span> <span class=\"number\">#222</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#eee</span>;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">h4</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">103</span>, <span class=\"number\">58</span>, <span class=\"number\">183</span>, <span class=\"number\">0.72</span>);</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span> <span class=\"number\">6px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1px</span> <span class=\"number\">#5f5a4b</span>, <span class=\"number\">1px</span> <span class=\"number\">1px</span> <span class=\"number\">6px</span> <span class=\"number\">1px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">10</span>, <span class=\"number\">10</span>, <span class=\"number\">0</span>, <span class=\"number\">0.5</span>);</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#fff</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-family</span>: <span class=\"string\">\"微软雅黑\"</span>, <span class=\"string\">\"宋体\"</span>, <span class=\"string\">\"黑体\"</span>, Arial;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">1em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">1.5</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">12px</span> <span class=\"number\">0</span> <span class=\"number\">12px</span> -<span class=\"number\">3px</span> <span class=\"meta\">!important</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">5px</span> <span class=\"number\">10px</span> <span class=\"number\">3px</span> <span class=\"number\">10px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">text-shadow</span>: <span class=\"number\">2px</span> <span class=\"number\">2px</span> <span class=\"number\">3px</span> <span class=\"number\">#222</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#eee</span>;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: block;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">h2</span> <span class=\"selector-tag\">code</span>, <span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">h3</span> <span class=\"selector-tag\">code</span>, <span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">h4</span> <span class=\"selector-tag\">code</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: inherit;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#f7ab01</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"number\">0</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.site-title</span><span class=\"selector-pseudo\">:hover</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">webkit-background-clip</span>: text;</span><br><span class=\"line\">  <span class=\"attribute\">-webkit-text-fill-color</span>: <span class=\"number\">#000</span>;</span><br><span class=\"line\">  <span class=\"attribute\">-webkit-text-stroke</span>: <span class=\"number\">1px</span> <span class=\"number\">#ddd</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.site-title</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: inline-block;</span><br><span class=\"line\">  <span class=\"attribute\">vertical-align</span>: top;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">36px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">21px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: <span class=\"number\">700</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-family</span>: Lato, <span class=\"string\">\"PingFang SC\"</span>, <span class=\"string\">\"Microsoft YaHei\"</span>, sans-serif;</span><br><span class=\"line\">  <span class=\"attribute\">text-shadow</span>: <span class=\"number\">5px</span> <span class=\"number\">5px</span> <span class=\"number\">3px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">47</span>, <span class=\"number\">138</span>, <span class=\"number\">216</span>, <span class=\"number\">0.47</span>);</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#329edc</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.note</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">position</span>: relative;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">15px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin-bottom</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: initial;</span><br><span class=\"line\">  <span class=\"attribute\">border-left</span>: <span class=\"number\">3px</span> solid <span class=\"number\">#eee</span>;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#f9f9f9</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-radius</span>: <span class=\"number\">3px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.note</span><span class=\"selector-class\">.info</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">background-color</span>: <span class=\"number\">#eef7fa</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-left-color</span>: <span class=\"number\">#428bca</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-tags</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">margin-top</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.post-widgets</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">padding-top</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding-bottom</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin-top</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<div class=\"info note\">\n至此，我们的 <code>Hexo-NexT魔改系列</code> 暂时告一段落了（要找工作辽顶不住），有问题或者更好的建议的小伙伴可以在下方留言或添加 QQ 879969355 来找到菜鸡本人。<br>祝各位的博客越变越漂亮~<br><br><span class=\"red-target\">(完结撒花)</span></div>"},{"title":"Hexo博客的安装与基本配置","date":"2019-07-31T14:54:59.000Z","copyright":true,"_content":"\n<style type = \"text/css\">\n.quotetitle {\n    color: #337ab7;\n    font-weight: 700;\n}\n\n.redspan {\n    color: #ff0000;\n}\n\n.italic {\n    font-style: italic;\n}\n\n</style>\n\n> <span class = 'introduction'>不先经历风雨，怎能见彩虹？</span><br/>\n在经历了无数次失败后，终于将我的 [Hexo](https://hexo.io/) 配置到了自己能看得过去的样子。<br/>特此写下 Blog 为更多想了解 Hexo 的人阅读使用。\n\n<!--more-->\n\n<hr/>\n\n## 环境搭建\n### 本人环境配置：\n- 服务器：腾讯云学生机，`Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-29-generic x86_64)`\n- Node.js：在 Hexo 的[官方文档](https://hexo.io/zh-cn/docs/)里面有说，`Node.js` 的版本不得低于 `6.9`，这里提供两种安装 `Node.js` 的方式：\n\ncURL：\n``` bash\n$ curl https://raw.github.com/creationix/nvm/v0.33.11/install.sh | sh\n```\nWget：\n``` bash\n$ wget -qO- https://raw.github.com/creationix/nvm/v0.33.11/install.sh | sh\n```\n安装完成后，重启终端并执行下列命令即可安装 Node.js。\n``` bash\n$ nvm install stable\n```\n或者可以在 `Node.js` 的官网上[下载安装](https://nodejs.org/en/)。\n\n> <span class = \"quotetitle\">Windows用户</span><br/>\n对于 windows 用户来说，建议使用安装程序进行安装。安装时，请勾选 Add to PATH 选项。\n另外，您也可以使用 Git Bash，这是 git for windows 自带的一组程序，提供了 Linux 风格的 shell，在该环境下，您可以直接用上面提到的命令来安装 Node.js。打开它的方法很简单，在任意位置单击右键，选择 “Git Bash Here” 即可。由于 Hexo 的很多操作都涉及到命令行，您可以考虑始终使用 Git Bash 来进行操作。\n\n- Git：我的 `Git` 版本为 *`git version 2.17.1`* \n\n这里使用 `Ubuntu` 或 `Debian` 系的：\n``` bash\n$ sudo apt-get install git-core\n```\n或者使用 `Fedora`、`红帽`或者 `CentOS`：\n``` bash\n$ sudo yum install git-core\n```\n像 `Arch Linux` 等其他发行版请自行善用包管理器进行安装。\n\n> <span class = \"quotetitle\">Windows用户</span><br/>\n由于~~众所周知~~的原因，从上面的链接下载 git for windows 最好挂上一个代理，否则下载速度十分缓慢。也可以参考[这里](https://github.com/waylau/git-for-win)，收录了存储于百度云的下载地址。\n\n### 开始安装\n现在我们开始安装 `Hexo`：\n``` bash\n$ npm install -g hexo-cli\n```\n如果发现下载奇慢，那么请首先更换你的 npm 源：\n``` bash\n$ npm config set registry https://registry.npm.taobao.org\n```\n\n<hr/>\n\n## 开始使用\n### 初始化 Hexo\n安装 `Hexo` 完成后，请执行下列命令，`Hexo` 将会在指定文件夹中新建所需要的文件。\n``` bash\n$ hexo init <folder>\n$ cd <folder>\n```\n其中，**`<folder>`** 就是你要在哪个路径下安装 `Hexo`，比如 `/home/ubuntu/hexo/`。\n新建完成后，指定文件夹的目录如下：\n``` bash\n├── _config.yml\n├── package.json\n├── scaffolds\n├── source\n|   ├── _drafts\n|   └── _posts\n└── themes\n```\n详细说明如下：\n> 1. `_config.yml` 是 YAML 格式文件，也是 Hexo 的站点 **重要配置文件** ，以后很多的自定义配置都要修改这个文件。\n> 2. package.json 配置 Hexo 运行需要的 Node.js 包，不用手动更改。\n> 3. scaffolds 是模板文件夹。这个“模板”就是指新建的 markdown 文件的模板，每新建一个 markdown 文件（由于 Hexo 使用 markdown 语法，在渲染生成静态 HTML 页面之前，源文件都是 markdown 文件），就会包含对应模板的内容。 \n该文件夹内有三个模板： \n> - draft.md --- 草稿的模板 \n> - page.md --- 页面的模板 \n> - post.md --- 文章的模板\n> 4. source 是资源文件夹，资源文件夹是存放用户资源的地方。除 posts 文件夹之外，开头命名为 (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。 \n> 5. themes 是主题文件夹。Hexo 会根据主题来生成静态页面。\n\n### 初次运行Hexo\n输入 <span class = 'redspan italic'>hexo generate</span> 命令来生成静态文件。\n> <span class = \"quotetitle\">注意！</span><br/>\n1：生成的静态文件存放在 public 文件夹中<br/> \n2：此命令可简写为 *`hexo g`*\n\n然后输入 <span class = 'redspan italic'>hexo server</span> (可简写为 *`hexo s`*)来启动服务器。\n\n默认情况下，端口号为 4000，所以服务器启动成功后，在浏览器中输入 `http://<你的IP地址>:4000` ，即可看到第一次运行的状况。\n\n和 Django 一样，按 *`Ctrl + c`* 结束服务。\n\n> <span class = \"quotetitle\">注意！</span><br/>\n如果运行时没有报任何错误，但是浏览器中显示网页无法访问，可能是你的服务器安全组没有配置，像腾讯云或者阿里云都需要配置端口安全组策略，请先去设置 4000 端口开放形式，再运行 Hexo 服务。\n\n<hr/>\n\n## 安装并配置Nginx\n安装 `Nginx` 主要是想让网站能随时随地访问，不像上文中 Hexo 提供的 server，只能手动输入命令后才能访问到网站。\n### 安装Nginx\n在 `Ubuntu` 上安装 `Nginx` 方法很简单：\n``` bash\n$ sudo apt install nginx\n```\n#### 配置防火墙\n如果您正在运行防火墙，则还需要打开端口 `80` 和 `443`：\n``` bash\n$ sudo ufw allow 'Nginx Full'\n```\n### 启动Nginx服务\n``` bash\n$ sudo systemctl start nginx\n```\n此时，用浏览器访问 `http://<你的IP地址>` 便可以看到 `Nginx` 的测试页面，即表示 `Nginx` 启动成功！\n\n继续输入以下命令使 `Nginx` 开机自动启动：\n``` bash\n$ systemctl enable nginx\n```\n\n<hr/>\n\n## 配置静态服务器访问路径\n`Nginx` 需要配置静态资源的路径信息才能通过 `url` 正确访问到服务器上的静态资源。 <br/>\n即是要将 `Hexo` 生成的静态资源的路径放置到 `Nginx` 的访问路径\n\n打开 `Nginx` 的默认配置文件 `/etc/nginx/nginx.conf` ，将默认的 `root /usr/share/nginx/html` 修改为： `root /…/<folder>/public`，里面的 `<folder>` 就是你刚刚Hexo安装的文件夹。\n\n修改完成后保存，输入以下命令重启 `Nginx`：\n```bash\n$ nginx -s reload\n```\n此时再次访问你的 IP 地址，若显示上文的 `Hexo` 初次运行的样子，则说明配置成功。\n\n> <span class = \"quotetitle\">注意！</span><br/>\n可能会报 403 错误，原因是 Nginx 没有权限访问 public文件夹，修改方法有两种： <br/>\n1：修改 public 文件夹的权限，修改为 777（即任何人可读可写可执行），不推荐； <br/>\n2：修改 nginx.conf 中的 user（可能在第5行），改为可以访问 public文件夹的用户，如 root。\n\n## 配置Hexo\n### 站点配置\n配置 Hexo 时，需要修改上文提到的根目录下的 `_config.yml` 文件，主要修改的就是这部分：\n``` yml\n# Site\ntitle: Euphoria Blog      # 网站标题\nsubtitle:                 # 网站副标题\ndescription:              # 网站描述，可以是你喜欢的一句话 :)\nkeywords: Euphoria        # 网站关键词  \nauthor: Euphoria          # 你的名字\nlanguage: zh-CN           # 网站使用的语言\ntimezone:                 # 网站时区，默认使用服务器的时区\n```\n其余的文件内容可以使用默认值，萌新可不必修改，具体参见[官方文档](https://hexo.io/zh-cn/docs/configuration.html)。\n\n> <span class = \"quotetitle\">注意！</span><br/>\n修改yml文件时应注意“:”后面应加空格。\n\n## 配置主题\nHexo 安装主题的方式非常简单，只需要将主题文件拷贝至站点目录的 `themes` 目录下，你可以在[这里](https://hexo.io/themes/)寻找你喜欢的主题，然后修改下配置文件即可。\n\n在 Hexo 中有两份主要的配置文件，其名称都是 `_config.yml`。 其中，一份位于站点根目录下，主要包含 Hexo 本身的配置；另一份位于主题目录下，这份配置由主题作者提供，主要用于配置主题相关的选项。\n\n为了描述方便，在以下说明中，将前者称为 <span class = \"blue-target\">站点配置文件</span>， 后者称为 <span class = \"purple-target\">主题配置文件</span>。\n\n这里我强烈推荐 `NexT` 这款主题，接下来为安装及其配置方法：\n\n### 安装 NexT\n如果你熟悉 Git，建议你使用 `克隆最新版本` 的方式，之后的更新可以通过 `git pull` 来快速更新， 而不用再次下载压缩包替换。\n\n在终端窗口下，定位到 Hexo 站点目录下。使用 `Git checkout` 代码：\n```bash\n$ cd your-hexo-site\n$ git clone https://github.com/iissnan/hexo-theme-next themes/next\n```\n\n### 启用主题\n与所有 `Hexo` 主题启用的模式一样。 当 `克隆/下载` 完成后，打开 <span class = \"blue-target\">站点配置文件</span>， 找到 `theme` 字段，并将其值更改为 `next`。\n```yml\ntheme: next\n```\n到此，NexT 主题安装完成。下一步我们将验证主题是否正确启用。在切换主题之后、验证之前， 我们最好使用 `hexo clean` 来清除 Hexo 的缓存。\n\n### 个性化主题\n#### 选择 Scheme\nScheme 是 NexT 提供的一种特性，借助于 Scheme，NexT 为你提供多种不同的外观。同时，几乎所有的配置都可以 在 Scheme 之间共用。目前 NexT 支持三种 Scheme，他们是：\n\n- Muse - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白\n- Mist - Muse 的紧凑版本，整洁有序的单栏外观\n- Pisces - 双栏 Scheme，小家碧玉似的清新\n\nScheme 的切换通过更改 <span class = \"purple-target\">主题配置文件</span>，搜索 scheme 关键字。 你会看到有三行 scheme 的配置，将你需用启用的 scheme 前面注释 # 去除即可。\n```yml\n# scheme: Muse\nscheme: Mist\n# scheme: Pisces\n```\n#### 设置语言\n编辑 <span class = \"blue-target\">站点配置文件</span>， 将 `language` 设置成你所需要的语言。建议明确设置你所需要的语言，例如选用简体中文，配置如下：\n```yml\nlanguage: zh-Hans\n```\n目前 NexT 支持的语言如以下表格所示：\n\n|语言|代码|设定示例|\n|:--|:--|:------|\n|English|en|language: en|\n|简体中文|zh-Hans|language: zh-Hans|\n|Français|fr-FR|language: fr-FR|\n|Português|pt|language: pt or language: pt-BR|\n|繁體中文|zh-hk 或者 zh-tw|language: zh-hk|\n|Русский язык|ru|language: ru|\n|Deutsch|de|language: de|\n|日本語|ja|language: ja|\n|Indonesian|id|language: id|\n|Korean|ko|language: ko|\n\n#### 设置菜单\n菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是 [Font Awesome](https://fontawesome.com/?from=io) 提供的图标， Font Awesome 提供了 600+ 的图标，可以满足绝大的多数的场景，同时无须担心在 Retina 屏幕下 图标模糊的问题。\n\n编辑 <span class = \"purple-target\">主题配置文件</span>，修改以下内容：\n\n1. 设定菜单内容，对应的字段是 `menu`。 菜单内容的设置格式是：`item name: link`。其中 `item name` 是一个名称，这个名称并不直接显示在页面上，她将用于匹配图标以及翻译。\n    ```yml\n    menu:\n     home: /\n     archives: /archives\n     #about: /about\n     #categories: /categories\n     tags: /tags\n     #commonweal: /404.html\n    ```\n    > <span class = \"quotetitle\">注意！</span><br/>\n    若你的站点运行在子目录中，请将链接前缀的 / 去掉！\n    \n    NexT 默认的菜单项有（标注 * 的项表示需要手动创建这个页面）：\n    \n    |键值|设定值|显示文本（简体中文）|\n    |:--|:----|:------------------|\n    |home|home: /|主页|\n    |archives|archives: /archives|归档页|\n    |categories|categories: /categories|分类页 |\n    |tags|tags: /tags|标签页 |\n    |about|about: /about|关于页面 |\n    |commonweal|commonweal: /404.html|公益 404 |\n2. 设置菜单项的显示文本。在第一步中设置的菜单的名称并不直接用于界面上的展示。Hexo 在生成的时候将使用 这个名称查找对应的语言翻译，并提取显示文本。这些翻译文本放置在 NexT 主题目录下的 `languages/{language}.yml` （{language} 为你所使用的语言）。\n\n    以简体中文为例，若你需要添加一个菜单项，比如 `something`。那么就需要修改简体中文对应的翻译文件 `languages/zh-Hans.yml`，在 `menu` 字段下添加一项：\n    ```yml\n    menu:\n      home: 首页\n      archives: 归档\n      categories: 分类\n      tags: 标签\n      about: 关于\n      search: 搜索\n      commonweal: 公益404\n      something: 有料\n    ```\n3. 设定菜单项的图标，对应的字段是 `menu_icons`。 此设定格式是 `item name: icon name`，其中 `item name` 与上一步所配置的菜单名字对应，`icon name` 是 **Font Awesome** 图标的 **名字**。而 `enable` 可用于控制是否显示图标，你可以设置成 `false` 来去掉图标。\n    ```yml\n    menu_icons:\n      enable: true\n      # Icon Mapping.\n      home: home\n      about: user\n      categories: th\n      tags: tags\n      archives: archive\n      commonweal: heartbeat\n    ```\n    > <span class = \"quotetitle\">注意！</span><br/>\n    1: 在菜单图标开启的情况下，如果菜单项与菜单未匹配（没有设置或者无效的 **Font Awesome** 图标名字） 的情况下，NexT 将会使用 **?** 作为图标。<br/>\n    2: 请注意键值（如 `home`）的大小写要严格匹配。\n    \n#### 设置侧栏\n默认情况下，侧栏仅在文章页面（拥有目录列表）时才显示，并放置于右侧位置。 可以通过修改 <span class = \"purple-target\">主题配置文件</span> 中的 `sidebar` 字段来控制侧栏的行为。侧栏的设置包括两个部分，其一是侧栏的位置， 其二是侧栏显示的时机。\n1. 设置侧栏的位置，修改 `sidebar.position` 的值，支持的选项有：\n    - left - 靠左放置\n    - right - 靠右放置\n    > <span class = \"quotetitle\">注意！</span><br/>\n    目前仅 Pisces Scheme 支持 position 配置。影响版本 <span class = \"red-target\">5.0.0</span> 及更低版本。\n    ```yml\n    sidebar:\n      position: left\n    ```\n2. 设置侧栏显示的时机，修改 sidebar.display 的值，支持的选项有：\n    - post - 默认行为，在文章页面（拥有目录列表）时显示\n    - always - 在所有页面中都显示\n    - hide - 在所有页面中都隐藏（可以手动展开）\n    - remove - 完全移除\n    ```yml\n    sidebar:\n      display: post\n    ```\n    > <span class = \"quotetitle\">注意！</span><br/>\n    已知侧栏在 use motion: false 的情况下不会展示。影响版本 <span class = \"red-target\">5.0.0</span> 及更低版本。\n    \n#### 设置头像\n编辑 <span class = \"purple-target\">主题配置文件</span>， 修改字段 `avatar`， 值设置成头像的链接地址。其中，头像的链接地址可以是：\n\n|地址|值|\n|:--|:--|\n|完整的互联网 URI|http://example.com/avatar.png|\n|站点内的地址\t|将头像放置主题目录下的 source/uploads/ （新建 uploads 目录若不存在）<br/>配置为：avatar: /uploads/avatar.png<br/>或者 放置在 source/images/ 目录下<br/>配置为：avatar: /images/avatar.png|\n\n```yml\navatar: http://example.com/avatar.png\n```\n\n#### 设置代码高亮主题\nNexT 使用 [Tomorrow Theme](https://github.com/chriskempson/tomorrow-theme) 作为代码高亮，共有5款主题供你选择。 NexT 默认使用的是白色的 `normal` 主题，可选的值有 `normal`，`night`， `night blue`， `night bright`， `night eighties`：\n<div>\n<img src=\"./tomorrow.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow.png\"/>\n<img src=\"./tomorrow-night.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night.png\"/>\n<img src=\"./tomorrow-night-blue.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night-blue.png\"/>\n<img src=\"./tomorrow-night-bright.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night-bright.png\"/>\n<img src=\"./tomorrow-night-eighties.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night-eighties.png\"/>\n</div>\n<div style = \"clear: both;\"></div>\n更改 <span class = \"purple-target\">主题配置文件</span> 中 `highlight_theme` 字段，将其值设定成你所喜爱的高亮主题，例如：\n\n```yml\n# Code Highlight theme\n# Available value: normal | night | night eighties | night blue | night bright\n# https://github.com/chriskempson/tomorrow-theme\nhighlight_theme: normal\n```\n\n#### 侧边栏社交链接\n侧栏社交链接的修改包含两个部分，第一是链接，第二是链接图标。 两者配置均在 <span class = \"purple-target\">主题配置文件</span> 中。\n1. 链接放置在 `social` 字段下，一行一个链接。其键值格式是 `显示文本: 链接地址`。\n    ```yml\n    # Social links\n    social:\n      GitHub: https://github.com/your-user-name\n      Twitter: https://twitter.com/your-user-name\n      微博: http://weibo.com/your-user-name\n      豆瓣: http://douban.com/people/your-user-name\n      知乎: http://www.zhihu.com/people/your-user-name\n      # 等等...\n    ```\n2. 设定链接的图标，对应的字段是 `social_icons`。其键值格式是 匹配键: **Font Awesome** 图标名称， 匹配键 与上一步所配置的链接的 显示文本 相同（大小写严格匹配），图标名称 是 **Font Awesome** 图标的名字（不必带 fa- 前缀）。 `enable` 选项用于控制是否显示图标，你可以设置成 `false` 来去掉图标。\n    ```yml\n    # Social Icons\n    social_icons:\n      enable: true\n      # Icon Mappings\n      GitHub: github\n      Twitter: twitter\n      微博: weibo\n    ```\n    \n#### 开启打赏功能 <sub>由 <a href=\"https://github.com/iissnan/hexo-theme-next/pull/687\">habren</a> 贡献</sub>\n越来越多的平台（微信公众平台，新浪微博，简书，百度打赏等）支持打赏功能，付费阅读时代越来越近，特此增加了打赏功能，支持微信打赏和支付宝打赏。 只需要 <span class = \"purple-target\">主题配置文件</span> 中填入 `微信` 和 `支付宝` 收款二维码图片地址，即可开启该功能。\n```yml\nreward_comment: 坚持原创技术分享，您的支持将鼓励我继续创作！\nwechatpay: /path/to/wechat-reward-image\nalipay: /path/to/alipay-reward-image\n```\n\n#### 站点建立时间\n这个时间将在站点的底部显示，例如 © 2013 - 2015。 编辑 <span class = \"purple-target\">主题配置文件</span>，新增字段 `since`。\n```yml\nsince: 2013\n```\n\n#### 实现 fork me on github\n点击 [这里](https://github.com/blog/273-github-ribbons) 或者 [这里](http://tholman.com/github-corners/) 挑选自己喜欢的样式，并复制旁边的对应代码。\n\n然后粘贴刚才复制的代码到 `themes/next/layout/_layout.swig` 文件中(放在 `<div class=\"headband\"></div>` 的下面)，并把 `href` 改为你的 `github` 地址，比如 `https://github.com/euphoriachn`。\n\n<img src=\"./fork-on-github.png\" alt=\"fork-on-github.png\"/>\n\n#### 添加动态背景\n> <span class = \"quotetitle\">注意！</span><br/>\n如果 `NexT` 主题在 <span class = \"red-target\">5.1.1</span> 以上的话就不用我这样设置，直接在主题配置文件中找到 `canvas_nest: false`，把它改为 `canvas_nest: true` 就行了（注意分号后面要加一个空格）。如果发现这样并不行 ~~（像我一样）~~，或者版本低于 `5.1.1` 的话，请按照如下操作进行。\n\n1. 修改 `_layout.swig`\n\n    打开 `next/layout/_layout.swig`\n    在 `</body>` 之前添加代码（注意不要放在 `</body>` 的后面）\n    ```html\n    {# TODO: Euphoria #}\n    {% if theme.canvas_nest %}\n        <script type=\"text/javascript\" src=\"//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js\"></script>\n    {% endif %}\n    ```\n    \n2. 修改配置文件\n    打开 `/next/_config.yml`，在里面添加如下代码：(可以放在最后面)\n    ```yml\n    # --------------------------------------------------------------\n    # background settings\n    # --------------------------------------------------------------\n    # add canvas-nest effect\n    # see detail from https://github.com/hustcc/canvas-nest.js\n    canvas_nest: true\n    ```\n    \n3. 试试 `hexo clean` 然后 `hexo g`，最后访问你的个人博客，就能看到效果了~\n\n#### 修改文章内链接文本样式\n修改文件 `themes\\next\\source\\css\\_common\\components\\post\\post.styl`，在末尾添加如下 `css` 样式：\n```css\n// 文章内链接文本样式\n.post-body p a{\n  color: #0593d3;\n  border-bottom: none;\n  border-bottom: 1px solid #0593d3;\n  &:hover {\n    color: #fc6423;\n    border-bottom: none;\n    border-bottom: 1px solid #fc6423;\n  }\n}\n```\n其中选择 `.post-body` 是为了不影响标题，选择 `p` 是为了不影响首页 “阅读全文” 的显示样式，颜色可以自己定义。\n\n#### 修改文章底部的那个带 # 号的标签\n修改模板 `/themes/next/layout/_macro/post.swig`，搜索 `rel=\"tag\">#`，将 `#` 换成 `<i class=\"fa fa-tag\"></i>` 即可，你也可以在 **Font Awesome** 上寻找自己喜欢的图标。\n\n#### 在每篇文章末尾统一添加 “本文结束” 标记\n在路径 `\\themes\\next\\layout\\_macro` 中新建 `passage-end-tag.swig` 文件,并添加以下内容：\n```html\n<div>\n    {% if not is_index %}\n        <div style=\"text-align:center;color: #ccc;font-size:14px;\">-------------本文结束<i class=\"fa fa-paw\"></i>感谢您的阅读-------------</div>\n    {% endif %}\n</div>\n```\n接着打开 `\\themes\\next\\layout\\_macro\\post.swig` 文件，在 `END POST BODY` 之前添加如下画红色部分代码：\n```html\n<div>\n  {% if not is_index %}\n    {% include 'passage-end-tag.swig' %}\n  {% endif %}\n</div>\n```\n就像这样：\n<img src=\"./thanks.png\" alt=\"thanks.png\"/>\n\n然后打开 <span class=\"purple-target\">主题配置文件</span>，在末尾添加：\n```yml\n# 文章末尾添加“本文结束”标记\npassage_end_tag:\n  enabled: true\n```\n\n#### 修改``代码块自定义样式\n打开 `\\themes\\next\\source\\css\\_custom\\custom.styl`，向里面加入如下代码：(颜色可以自己定义)\n```css\n// Custom styles.\ncode {\n    color: #ff7600;\n    background: #fbf7f8;\n    margin: 2px;\n}\n// 大代码块的自定义样式\n.highlight, pre {\n    margin: 5px 0;\n    padding: 5px;\n    border-radius: 3px;\n}\n.highlight, code, pre {\n    border: 1px solid #d6d6d6;\n}\n```\n\n#### 侧边栏社交小图标设置\n打开 <span class=\"purple-target\">主题配置文件</span>，搜索 `social_icons:`，在 **Font Awesome** 图标库找自己喜欢的小图标，并将名字复制在如下位置，保存即可。\n\n<img src=\"./social-links.png\" alt=\"social-links.png\"/>\n\n#### 主页文章添加阴影效果\n打开 `\\themes\\next\\source\\css\\_custom\\custom.styl`，向里面加入如下代码：\n```css\n// 主页文章添加阴影效果\n .post {\n   margin-top: 60px;\n   margin-bottom: 60px;\n   padding: 25px;\n   -webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5);\n   -moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5);\n  }\n```\n\n#### 设置网站的图标 Favicon\n你可以在 [EasyIcon](https://www.easyicon.net/) 中找一张 **（32*32）** 的 `ico` 图标，或者去别的网站下载或者制作，并将图标名称改为 `favicon.ico`，然后把图标放在 `/themes/next/source/images` 里，并且修改 <span class=\"purple-target\">主题配置文件</span>：\n```yml\n# Put your favicon.ico into `hexo-site/source/` directory.\nfavicon: /favicon.ico\n```\n\n#### 在文章底部增加版权信息\n在目录 `next/layout/_macro/` 下添加 `my-copyright.swig`：\n```html\n{% if page.copyright %}\n<div class=\"my_post_copyright\">\n  <script src=\"//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js\"></script>\n  \n  <!-- JS库 sweetalert 可修改路径 -->\n  <script src=\"https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js\"></script>\n  <script src=\"https://unpkg.com/sweetalert/dist/sweetalert.min.js\"></script>\n  <p><span>本文标题:</span><a href=\"{{ url_for(page.path) }}\">{{ page.title }}</a></p>\n  <p><span>文章作者:</span><a href=\"/\" title=\"访问 {{ theme.author }} 的个人博客\">{{ theme.author }}</a></p>\n  <p><span>发布时间:</span>{{ page.date.format(\"YYYY年MM月DD日 - HH:mm\") }}</p>\n  <p><span>最后更新:</span>{{ page.updated.format(\"YYYY年MM月DD日 - HH:mm\") }}</p>\n  <p><span>原始链接:</span><a href=\"{{ url_for(page.path) }}\" title=\"{{ page.title }}\">{{ page.permalink }}</a>\n    <span class=\"copy-path\"  title=\"点击复制文章链接\"><i class=\"fa fa-clipboard\" data-clipboard-text=\"{{ page.permalink }}\"  aria-label=\"复制成功！\"></i></span>\n  </p>\n  <p><span>许可协议:</span><i class=\"fa fa-creative-commons\"></i> <a rel=\"license\" href=\"https://creativecommons.org/licenses/by-nc-nd/4.0/\" target=\"_blank\" title=\"Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)\">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  \n</div>\n<script> \n    var clipboard = new Clipboard('.fa-clipboard');\n    $(\".fa-clipboard\").click(function(){\n      clipboard.on('success', function(){\n        swal({   \n          title: \"\",   \n          text: '复制成功',\n          icon: \"success\", \n          showConfirmButton: true\n          });\n\t});\n    });  \n</script>\n{% endif %}\n```\n在目录 `next/source/css/_common/components/post/` 下添加 `my-post-copyright.styl`：\n```css\n.my_post_copyright {\n  width: 85%;\n  max-width: 45em;\n  margin: 2.8em auto 0;\n  padding: 0.5em 1.0em;\n  border: 1px solid #d3d3d3;\n  font-size: 0.93rem;\n  line-height: 1.6em;\n  word-break: break-all;\n  background: rgba(255,255,255,0.4);\n}\n.my_post_copyright p{margin:0;}\n.my_post_copyright span {\n  display: inline-block;\n  width: 5.2em;\n  color: #b5b5b5;\n  font-weight: bold;\n}\n.my_post_copyright .raw {\n  margin-left: 1em;\n  width: 5em;\n}\n.my_post_copyright a {\n  color: #808080;\n  border-bottom:0;\n}\n.my_post_copyright a:hover {\n  color: #a3d2a3;\n  text-decoration: underline;\n}\n.my_post_copyright:hover .fa-clipboard {\n  color: #000;\n}\n.my_post_copyright .post-url:hover {\n  font-weight: normal;\n}\n.my_post_copyright .copy-path {\n  margin-left: 1em;\n  width: 1em;\n  +mobile(){display:none;}\n}\n.my_post_copyright .copy-path:hover {\n  color: #808080;\n  cursor: pointer;\n}\n```\n修改 `next/layout/_macro/post.swig`，在之前添加 **底部阅读完毕** 代码中，再添加如下代码：\n```html\n{% include 'my-copyright.swig' %}\n```\n如图所示：\n<img src=\"./my-copyright.png\" alt=\"my-copyright.png\"/>\n修改 `next/source/css/_common/components/post/post.styl` 文件，在最后一行增加代码：\n``` css\n@import \"my-post-copyright\"\n```\n如果要在该博文下面增加版权信息的显示，需要在 **Markdown** 中增加 `copyright: true` 的设置，如图所示：\n\n<img src=\"./show-copyright.png\" alt=\"show-copyright.png\"/>\n\n#### 隐藏网页底部 powered By Hexo / 强力驱动\n打开 `themes/next/layout/_partials/footer.swig`，隐藏之间的代码即可，或者直接删除。位置如图：\n<img src=\"./hide-hexo.png\" alt=\"hide-hexo.png\"/>\n\n#### <a name = \"live2d\" style=\"cursor: default; color: #fff; border-bottom: none; :hover {color: #fff; border-bottom: none;}\">添加 Live 2D 小宠物</a>\n切换至 `Hexo` 根目录下，在终端中输入以下代码：\n```bash\n$ npm install -save hexo-helper-live2d\n```\n\n编辑 <span class = \"blue-target\">站点配置文件</span>：（具体配置见 [官方文档](https://github.com/EYHN/hexo-helper-live2d)）\n```yml\nlive2d:\n  enable: true\n  scriptFrom: local\n  pluginRootPath: live2dw/\n  pluginJsPath: lib/\n  pluginModelPath: assets/\n  model:\n    use: live2d-widget-model-wanko\n  display:\n    position: right\n    width: 150\n    height: 300\n  mobile:\n    show: true\n```\n\n我的 [这一篇博客](https://www.wqh4u.cn/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/) 中写了一些关于 <span class = \"blue-target\">Live 2D</span> 的一些进阶设置，感兴趣的看官可以参考一下。\n\n> 完~\n\n## 参考文献\n1. [文档 | Hexo](https://hexo.io/zh-cn/docs/)\n2. [Themes | Hexo](https://hexo.io/themes/)\n3. [开始使用 - NexT 使用文档](http://theme-next.iissnan.com/getting-started.html)\n4. [结合hexo在GitHub上搭建个人博客——全过程](https://www.cnblogs.com/trista222/p/8017300.html)\n5. [阿里云CentOS下Hexo+Nginx建站过程 - 来吧，和鹿丸君一起打豆豆](https://blog.csdn.net/coding01/article/details/80083033)\n6. [hexo的next主题个性化教程:打造炫酷网站](http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html)\n","source":"_posts/Hexo博客的安装与基本配置.md","raw":"---\ntitle: Hexo博客的安装与基本配置\ndate: 2019-07-31 22:54:59\ntags:\n- Hexo\n- 建站\n- Nginx\n- NexT\ncategories:\n- Hexo\ncopyright: true\n---\n\n<style type = \"text/css\">\n.quotetitle {\n    color: #337ab7;\n    font-weight: 700;\n}\n\n.redspan {\n    color: #ff0000;\n}\n\n.italic {\n    font-style: italic;\n}\n\n</style>\n\n> <span class = 'introduction'>不先经历风雨，怎能见彩虹？</span><br/>\n在经历了无数次失败后，终于将我的 [Hexo](https://hexo.io/) 配置到了自己能看得过去的样子。<br/>特此写下 Blog 为更多想了解 Hexo 的人阅读使用。\n\n<!--more-->\n\n<hr/>\n\n## 环境搭建\n### 本人环境配置：\n- 服务器：腾讯云学生机，`Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-29-generic x86_64)`\n- Node.js：在 Hexo 的[官方文档](https://hexo.io/zh-cn/docs/)里面有说，`Node.js` 的版本不得低于 `6.9`，这里提供两种安装 `Node.js` 的方式：\n\ncURL：\n``` bash\n$ curl https://raw.github.com/creationix/nvm/v0.33.11/install.sh | sh\n```\nWget：\n``` bash\n$ wget -qO- https://raw.github.com/creationix/nvm/v0.33.11/install.sh | sh\n```\n安装完成后，重启终端并执行下列命令即可安装 Node.js。\n``` bash\n$ nvm install stable\n```\n或者可以在 `Node.js` 的官网上[下载安装](https://nodejs.org/en/)。\n\n> <span class = \"quotetitle\">Windows用户</span><br/>\n对于 windows 用户来说，建议使用安装程序进行安装。安装时，请勾选 Add to PATH 选项。\n另外，您也可以使用 Git Bash，这是 git for windows 自带的一组程序，提供了 Linux 风格的 shell，在该环境下，您可以直接用上面提到的命令来安装 Node.js。打开它的方法很简单，在任意位置单击右键，选择 “Git Bash Here” 即可。由于 Hexo 的很多操作都涉及到命令行，您可以考虑始终使用 Git Bash 来进行操作。\n\n- Git：我的 `Git` 版本为 *`git version 2.17.1`* \n\n这里使用 `Ubuntu` 或 `Debian` 系的：\n``` bash\n$ sudo apt-get install git-core\n```\n或者使用 `Fedora`、`红帽`或者 `CentOS`：\n``` bash\n$ sudo yum install git-core\n```\n像 `Arch Linux` 等其他发行版请自行善用包管理器进行安装。\n\n> <span class = \"quotetitle\">Windows用户</span><br/>\n由于~~众所周知~~的原因，从上面的链接下载 git for windows 最好挂上一个代理，否则下载速度十分缓慢。也可以参考[这里](https://github.com/waylau/git-for-win)，收录了存储于百度云的下载地址。\n\n### 开始安装\n现在我们开始安装 `Hexo`：\n``` bash\n$ npm install -g hexo-cli\n```\n如果发现下载奇慢，那么请首先更换你的 npm 源：\n``` bash\n$ npm config set registry https://registry.npm.taobao.org\n```\n\n<hr/>\n\n## 开始使用\n### 初始化 Hexo\n安装 `Hexo` 完成后，请执行下列命令，`Hexo` 将会在指定文件夹中新建所需要的文件。\n``` bash\n$ hexo init <folder>\n$ cd <folder>\n```\n其中，**`<folder>`** 就是你要在哪个路径下安装 `Hexo`，比如 `/home/ubuntu/hexo/`。\n新建完成后，指定文件夹的目录如下：\n``` bash\n├── _config.yml\n├── package.json\n├── scaffolds\n├── source\n|   ├── _drafts\n|   └── _posts\n└── themes\n```\n详细说明如下：\n> 1. `_config.yml` 是 YAML 格式文件，也是 Hexo 的站点 **重要配置文件** ，以后很多的自定义配置都要修改这个文件。\n> 2. package.json 配置 Hexo 运行需要的 Node.js 包，不用手动更改。\n> 3. scaffolds 是模板文件夹。这个“模板”就是指新建的 markdown 文件的模板，每新建一个 markdown 文件（由于 Hexo 使用 markdown 语法，在渲染生成静态 HTML 页面之前，源文件都是 markdown 文件），就会包含对应模板的内容。 \n该文件夹内有三个模板： \n> - draft.md --- 草稿的模板 \n> - page.md --- 页面的模板 \n> - post.md --- 文章的模板\n> 4. source 是资源文件夹，资源文件夹是存放用户资源的地方。除 posts 文件夹之外，开头命名为 (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。 \n> 5. themes 是主题文件夹。Hexo 会根据主题来生成静态页面。\n\n### 初次运行Hexo\n输入 <span class = 'redspan italic'>hexo generate</span> 命令来生成静态文件。\n> <span class = \"quotetitle\">注意！</span><br/>\n1：生成的静态文件存放在 public 文件夹中<br/> \n2：此命令可简写为 *`hexo g`*\n\n然后输入 <span class = 'redspan italic'>hexo server</span> (可简写为 *`hexo s`*)来启动服务器。\n\n默认情况下，端口号为 4000，所以服务器启动成功后，在浏览器中输入 `http://<你的IP地址>:4000` ，即可看到第一次运行的状况。\n\n和 Django 一样，按 *`Ctrl + c`* 结束服务。\n\n> <span class = \"quotetitle\">注意！</span><br/>\n如果运行时没有报任何错误，但是浏览器中显示网页无法访问，可能是你的服务器安全组没有配置，像腾讯云或者阿里云都需要配置端口安全组策略，请先去设置 4000 端口开放形式，再运行 Hexo 服务。\n\n<hr/>\n\n## 安装并配置Nginx\n安装 `Nginx` 主要是想让网站能随时随地访问，不像上文中 Hexo 提供的 server，只能手动输入命令后才能访问到网站。\n### 安装Nginx\n在 `Ubuntu` 上安装 `Nginx` 方法很简单：\n``` bash\n$ sudo apt install nginx\n```\n#### 配置防火墙\n如果您正在运行防火墙，则还需要打开端口 `80` 和 `443`：\n``` bash\n$ sudo ufw allow 'Nginx Full'\n```\n### 启动Nginx服务\n``` bash\n$ sudo systemctl start nginx\n```\n此时，用浏览器访问 `http://<你的IP地址>` 便可以看到 `Nginx` 的测试页面，即表示 `Nginx` 启动成功！\n\n继续输入以下命令使 `Nginx` 开机自动启动：\n``` bash\n$ systemctl enable nginx\n```\n\n<hr/>\n\n## 配置静态服务器访问路径\n`Nginx` 需要配置静态资源的路径信息才能通过 `url` 正确访问到服务器上的静态资源。 <br/>\n即是要将 `Hexo` 生成的静态资源的路径放置到 `Nginx` 的访问路径\n\n打开 `Nginx` 的默认配置文件 `/etc/nginx/nginx.conf` ，将默认的 `root /usr/share/nginx/html` 修改为： `root /…/<folder>/public`，里面的 `<folder>` 就是你刚刚Hexo安装的文件夹。\n\n修改完成后保存，输入以下命令重启 `Nginx`：\n```bash\n$ nginx -s reload\n```\n此时再次访问你的 IP 地址，若显示上文的 `Hexo` 初次运行的样子，则说明配置成功。\n\n> <span class = \"quotetitle\">注意！</span><br/>\n可能会报 403 错误，原因是 Nginx 没有权限访问 public文件夹，修改方法有两种： <br/>\n1：修改 public 文件夹的权限，修改为 777（即任何人可读可写可执行），不推荐； <br/>\n2：修改 nginx.conf 中的 user（可能在第5行），改为可以访问 public文件夹的用户，如 root。\n\n## 配置Hexo\n### 站点配置\n配置 Hexo 时，需要修改上文提到的根目录下的 `_config.yml` 文件，主要修改的就是这部分：\n``` yml\n# Site\ntitle: Euphoria Blog      # 网站标题\nsubtitle:                 # 网站副标题\ndescription:              # 网站描述，可以是你喜欢的一句话 :)\nkeywords: Euphoria        # 网站关键词  \nauthor: Euphoria          # 你的名字\nlanguage: zh-CN           # 网站使用的语言\ntimezone:                 # 网站时区，默认使用服务器的时区\n```\n其余的文件内容可以使用默认值，萌新可不必修改，具体参见[官方文档](https://hexo.io/zh-cn/docs/configuration.html)。\n\n> <span class = \"quotetitle\">注意！</span><br/>\n修改yml文件时应注意“:”后面应加空格。\n\n## 配置主题\nHexo 安装主题的方式非常简单，只需要将主题文件拷贝至站点目录的 `themes` 目录下，你可以在[这里](https://hexo.io/themes/)寻找你喜欢的主题，然后修改下配置文件即可。\n\n在 Hexo 中有两份主要的配置文件，其名称都是 `_config.yml`。 其中，一份位于站点根目录下，主要包含 Hexo 本身的配置；另一份位于主题目录下，这份配置由主题作者提供，主要用于配置主题相关的选项。\n\n为了描述方便，在以下说明中，将前者称为 <span class = \"blue-target\">站点配置文件</span>， 后者称为 <span class = \"purple-target\">主题配置文件</span>。\n\n这里我强烈推荐 `NexT` 这款主题，接下来为安装及其配置方法：\n\n### 安装 NexT\n如果你熟悉 Git，建议你使用 `克隆最新版本` 的方式，之后的更新可以通过 `git pull` 来快速更新， 而不用再次下载压缩包替换。\n\n在终端窗口下，定位到 Hexo 站点目录下。使用 `Git checkout` 代码：\n```bash\n$ cd your-hexo-site\n$ git clone https://github.com/iissnan/hexo-theme-next themes/next\n```\n\n### 启用主题\n与所有 `Hexo` 主题启用的模式一样。 当 `克隆/下载` 完成后，打开 <span class = \"blue-target\">站点配置文件</span>， 找到 `theme` 字段，并将其值更改为 `next`。\n```yml\ntheme: next\n```\n到此，NexT 主题安装完成。下一步我们将验证主题是否正确启用。在切换主题之后、验证之前， 我们最好使用 `hexo clean` 来清除 Hexo 的缓存。\n\n### 个性化主题\n#### 选择 Scheme\nScheme 是 NexT 提供的一种特性，借助于 Scheme，NexT 为你提供多种不同的外观。同时，几乎所有的配置都可以 在 Scheme 之间共用。目前 NexT 支持三种 Scheme，他们是：\n\n- Muse - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白\n- Mist - Muse 的紧凑版本，整洁有序的单栏外观\n- Pisces - 双栏 Scheme，小家碧玉似的清新\n\nScheme 的切换通过更改 <span class = \"purple-target\">主题配置文件</span>，搜索 scheme 关键字。 你会看到有三行 scheme 的配置，将你需用启用的 scheme 前面注释 # 去除即可。\n```yml\n# scheme: Muse\nscheme: Mist\n# scheme: Pisces\n```\n#### 设置语言\n编辑 <span class = \"blue-target\">站点配置文件</span>， 将 `language` 设置成你所需要的语言。建议明确设置你所需要的语言，例如选用简体中文，配置如下：\n```yml\nlanguage: zh-Hans\n```\n目前 NexT 支持的语言如以下表格所示：\n\n|语言|代码|设定示例|\n|:--|:--|:------|\n|English|en|language: en|\n|简体中文|zh-Hans|language: zh-Hans|\n|Français|fr-FR|language: fr-FR|\n|Português|pt|language: pt or language: pt-BR|\n|繁體中文|zh-hk 或者 zh-tw|language: zh-hk|\n|Русский язык|ru|language: ru|\n|Deutsch|de|language: de|\n|日本語|ja|language: ja|\n|Indonesian|id|language: id|\n|Korean|ko|language: ko|\n\n#### 设置菜单\n菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是 [Font Awesome](https://fontawesome.com/?from=io) 提供的图标， Font Awesome 提供了 600+ 的图标，可以满足绝大的多数的场景，同时无须担心在 Retina 屏幕下 图标模糊的问题。\n\n编辑 <span class = \"purple-target\">主题配置文件</span>，修改以下内容：\n\n1. 设定菜单内容，对应的字段是 `menu`。 菜单内容的设置格式是：`item name: link`。其中 `item name` 是一个名称，这个名称并不直接显示在页面上，她将用于匹配图标以及翻译。\n    ```yml\n    menu:\n     home: /\n     archives: /archives\n     #about: /about\n     #categories: /categories\n     tags: /tags\n     #commonweal: /404.html\n    ```\n    > <span class = \"quotetitle\">注意！</span><br/>\n    若你的站点运行在子目录中，请将链接前缀的 / 去掉！\n    \n    NexT 默认的菜单项有（标注 * 的项表示需要手动创建这个页面）：\n    \n    |键值|设定值|显示文本（简体中文）|\n    |:--|:----|:------------------|\n    |home|home: /|主页|\n    |archives|archives: /archives|归档页|\n    |categories|categories: /categories|分类页 |\n    |tags|tags: /tags|标签页 |\n    |about|about: /about|关于页面 |\n    |commonweal|commonweal: /404.html|公益 404 |\n2. 设置菜单项的显示文本。在第一步中设置的菜单的名称并不直接用于界面上的展示。Hexo 在生成的时候将使用 这个名称查找对应的语言翻译，并提取显示文本。这些翻译文本放置在 NexT 主题目录下的 `languages/{language}.yml` （{language} 为你所使用的语言）。\n\n    以简体中文为例，若你需要添加一个菜单项，比如 `something`。那么就需要修改简体中文对应的翻译文件 `languages/zh-Hans.yml`，在 `menu` 字段下添加一项：\n    ```yml\n    menu:\n      home: 首页\n      archives: 归档\n      categories: 分类\n      tags: 标签\n      about: 关于\n      search: 搜索\n      commonweal: 公益404\n      something: 有料\n    ```\n3. 设定菜单项的图标，对应的字段是 `menu_icons`。 此设定格式是 `item name: icon name`，其中 `item name` 与上一步所配置的菜单名字对应，`icon name` 是 **Font Awesome** 图标的 **名字**。而 `enable` 可用于控制是否显示图标，你可以设置成 `false` 来去掉图标。\n    ```yml\n    menu_icons:\n      enable: true\n      # Icon Mapping.\n      home: home\n      about: user\n      categories: th\n      tags: tags\n      archives: archive\n      commonweal: heartbeat\n    ```\n    > <span class = \"quotetitle\">注意！</span><br/>\n    1: 在菜单图标开启的情况下，如果菜单项与菜单未匹配（没有设置或者无效的 **Font Awesome** 图标名字） 的情况下，NexT 将会使用 **?** 作为图标。<br/>\n    2: 请注意键值（如 `home`）的大小写要严格匹配。\n    \n#### 设置侧栏\n默认情况下，侧栏仅在文章页面（拥有目录列表）时才显示，并放置于右侧位置。 可以通过修改 <span class = \"purple-target\">主题配置文件</span> 中的 `sidebar` 字段来控制侧栏的行为。侧栏的设置包括两个部分，其一是侧栏的位置， 其二是侧栏显示的时机。\n1. 设置侧栏的位置，修改 `sidebar.position` 的值，支持的选项有：\n    - left - 靠左放置\n    - right - 靠右放置\n    > <span class = \"quotetitle\">注意！</span><br/>\n    目前仅 Pisces Scheme 支持 position 配置。影响版本 <span class = \"red-target\">5.0.0</span> 及更低版本。\n    ```yml\n    sidebar:\n      position: left\n    ```\n2. 设置侧栏显示的时机，修改 sidebar.display 的值，支持的选项有：\n    - post - 默认行为，在文章页面（拥有目录列表）时显示\n    - always - 在所有页面中都显示\n    - hide - 在所有页面中都隐藏（可以手动展开）\n    - remove - 完全移除\n    ```yml\n    sidebar:\n      display: post\n    ```\n    > <span class = \"quotetitle\">注意！</span><br/>\n    已知侧栏在 use motion: false 的情况下不会展示。影响版本 <span class = \"red-target\">5.0.0</span> 及更低版本。\n    \n#### 设置头像\n编辑 <span class = \"purple-target\">主题配置文件</span>， 修改字段 `avatar`， 值设置成头像的链接地址。其中，头像的链接地址可以是：\n\n|地址|值|\n|:--|:--|\n|完整的互联网 URI|http://example.com/avatar.png|\n|站点内的地址\t|将头像放置主题目录下的 source/uploads/ （新建 uploads 目录若不存在）<br/>配置为：avatar: /uploads/avatar.png<br/>或者 放置在 source/images/ 目录下<br/>配置为：avatar: /images/avatar.png|\n\n```yml\navatar: http://example.com/avatar.png\n```\n\n#### 设置代码高亮主题\nNexT 使用 [Tomorrow Theme](https://github.com/chriskempson/tomorrow-theme) 作为代码高亮，共有5款主题供你选择。 NexT 默认使用的是白色的 `normal` 主题，可选的值有 `normal`，`night`， `night blue`， `night bright`， `night eighties`：\n<div>\n<img src=\"./tomorrow.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow.png\"/>\n<img src=\"./tomorrow-night.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night.png\"/>\n<img src=\"./tomorrow-night-blue.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night-blue.png\"/>\n<img src=\"./tomorrow-night-bright.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night-bright.png\"/>\n<img src=\"./tomorrow-night-eighties.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night-eighties.png\"/>\n</div>\n<div style = \"clear: both;\"></div>\n更改 <span class = \"purple-target\">主题配置文件</span> 中 `highlight_theme` 字段，将其值设定成你所喜爱的高亮主题，例如：\n\n```yml\n# Code Highlight theme\n# Available value: normal | night | night eighties | night blue | night bright\n# https://github.com/chriskempson/tomorrow-theme\nhighlight_theme: normal\n```\n\n#### 侧边栏社交链接\n侧栏社交链接的修改包含两个部分，第一是链接，第二是链接图标。 两者配置均在 <span class = \"purple-target\">主题配置文件</span> 中。\n1. 链接放置在 `social` 字段下，一行一个链接。其键值格式是 `显示文本: 链接地址`。\n    ```yml\n    # Social links\n    social:\n      GitHub: https://github.com/your-user-name\n      Twitter: https://twitter.com/your-user-name\n      微博: http://weibo.com/your-user-name\n      豆瓣: http://douban.com/people/your-user-name\n      知乎: http://www.zhihu.com/people/your-user-name\n      # 等等...\n    ```\n2. 设定链接的图标，对应的字段是 `social_icons`。其键值格式是 匹配键: **Font Awesome** 图标名称， 匹配键 与上一步所配置的链接的 显示文本 相同（大小写严格匹配），图标名称 是 **Font Awesome** 图标的名字（不必带 fa- 前缀）。 `enable` 选项用于控制是否显示图标，你可以设置成 `false` 来去掉图标。\n    ```yml\n    # Social Icons\n    social_icons:\n      enable: true\n      # Icon Mappings\n      GitHub: github\n      Twitter: twitter\n      微博: weibo\n    ```\n    \n#### 开启打赏功能 <sub>由 <a href=\"https://github.com/iissnan/hexo-theme-next/pull/687\">habren</a> 贡献</sub>\n越来越多的平台（微信公众平台，新浪微博，简书，百度打赏等）支持打赏功能，付费阅读时代越来越近，特此增加了打赏功能，支持微信打赏和支付宝打赏。 只需要 <span class = \"purple-target\">主题配置文件</span> 中填入 `微信` 和 `支付宝` 收款二维码图片地址，即可开启该功能。\n```yml\nreward_comment: 坚持原创技术分享，您的支持将鼓励我继续创作！\nwechatpay: /path/to/wechat-reward-image\nalipay: /path/to/alipay-reward-image\n```\n\n#### 站点建立时间\n这个时间将在站点的底部显示，例如 © 2013 - 2015。 编辑 <span class = \"purple-target\">主题配置文件</span>，新增字段 `since`。\n```yml\nsince: 2013\n```\n\n#### 实现 fork me on github\n点击 [这里](https://github.com/blog/273-github-ribbons) 或者 [这里](http://tholman.com/github-corners/) 挑选自己喜欢的样式，并复制旁边的对应代码。\n\n然后粘贴刚才复制的代码到 `themes/next/layout/_layout.swig` 文件中(放在 `<div class=\"headband\"></div>` 的下面)，并把 `href` 改为你的 `github` 地址，比如 `https://github.com/euphoriachn`。\n\n<img src=\"./fork-on-github.png\" alt=\"fork-on-github.png\"/>\n\n#### 添加动态背景\n> <span class = \"quotetitle\">注意！</span><br/>\n如果 `NexT` 主题在 <span class = \"red-target\">5.1.1</span> 以上的话就不用我这样设置，直接在主题配置文件中找到 `canvas_nest: false`，把它改为 `canvas_nest: true` 就行了（注意分号后面要加一个空格）。如果发现这样并不行 ~~（像我一样）~~，或者版本低于 `5.1.1` 的话，请按照如下操作进行。\n\n1. 修改 `_layout.swig`\n\n    打开 `next/layout/_layout.swig`\n    在 `</body>` 之前添加代码（注意不要放在 `</body>` 的后面）\n    ```html\n    {# TODO: Euphoria #}\n    {% if theme.canvas_nest %}\n        <script type=\"text/javascript\" src=\"//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js\"></script>\n    {% endif %}\n    ```\n    \n2. 修改配置文件\n    打开 `/next/_config.yml`，在里面添加如下代码：(可以放在最后面)\n    ```yml\n    # --------------------------------------------------------------\n    # background settings\n    # --------------------------------------------------------------\n    # add canvas-nest effect\n    # see detail from https://github.com/hustcc/canvas-nest.js\n    canvas_nest: true\n    ```\n    \n3. 试试 `hexo clean` 然后 `hexo g`，最后访问你的个人博客，就能看到效果了~\n\n#### 修改文章内链接文本样式\n修改文件 `themes\\next\\source\\css\\_common\\components\\post\\post.styl`，在末尾添加如下 `css` 样式：\n```css\n// 文章内链接文本样式\n.post-body p a{\n  color: #0593d3;\n  border-bottom: none;\n  border-bottom: 1px solid #0593d3;\n  &:hover {\n    color: #fc6423;\n    border-bottom: none;\n    border-bottom: 1px solid #fc6423;\n  }\n}\n```\n其中选择 `.post-body` 是为了不影响标题，选择 `p` 是为了不影响首页 “阅读全文” 的显示样式，颜色可以自己定义。\n\n#### 修改文章底部的那个带 # 号的标签\n修改模板 `/themes/next/layout/_macro/post.swig`，搜索 `rel=\"tag\">#`，将 `#` 换成 `<i class=\"fa fa-tag\"></i>` 即可，你也可以在 **Font Awesome** 上寻找自己喜欢的图标。\n\n#### 在每篇文章末尾统一添加 “本文结束” 标记\n在路径 `\\themes\\next\\layout\\_macro` 中新建 `passage-end-tag.swig` 文件,并添加以下内容：\n```html\n<div>\n    {% if not is_index %}\n        <div style=\"text-align:center;color: #ccc;font-size:14px;\">-------------本文结束<i class=\"fa fa-paw\"></i>感谢您的阅读-------------</div>\n    {% endif %}\n</div>\n```\n接着打开 `\\themes\\next\\layout\\_macro\\post.swig` 文件，在 `END POST BODY` 之前添加如下画红色部分代码：\n```html\n<div>\n  {% if not is_index %}\n    {% include 'passage-end-tag.swig' %}\n  {% endif %}\n</div>\n```\n就像这样：\n<img src=\"./thanks.png\" alt=\"thanks.png\"/>\n\n然后打开 <span class=\"purple-target\">主题配置文件</span>，在末尾添加：\n```yml\n# 文章末尾添加“本文结束”标记\npassage_end_tag:\n  enabled: true\n```\n\n#### 修改``代码块自定义样式\n打开 `\\themes\\next\\source\\css\\_custom\\custom.styl`，向里面加入如下代码：(颜色可以自己定义)\n```css\n// Custom styles.\ncode {\n    color: #ff7600;\n    background: #fbf7f8;\n    margin: 2px;\n}\n// 大代码块的自定义样式\n.highlight, pre {\n    margin: 5px 0;\n    padding: 5px;\n    border-radius: 3px;\n}\n.highlight, code, pre {\n    border: 1px solid #d6d6d6;\n}\n```\n\n#### 侧边栏社交小图标设置\n打开 <span class=\"purple-target\">主题配置文件</span>，搜索 `social_icons:`，在 **Font Awesome** 图标库找自己喜欢的小图标，并将名字复制在如下位置，保存即可。\n\n<img src=\"./social-links.png\" alt=\"social-links.png\"/>\n\n#### 主页文章添加阴影效果\n打开 `\\themes\\next\\source\\css\\_custom\\custom.styl`，向里面加入如下代码：\n```css\n// 主页文章添加阴影效果\n .post {\n   margin-top: 60px;\n   margin-bottom: 60px;\n   padding: 25px;\n   -webkit-box-shadow: 0 0 5px rgba(202, 203, 203, .5);\n   -moz-box-shadow: 0 0 5px rgba(202, 203, 204, .5);\n  }\n```\n\n#### 设置网站的图标 Favicon\n你可以在 [EasyIcon](https://www.easyicon.net/) 中找一张 **（32*32）** 的 `ico` 图标，或者去别的网站下载或者制作，并将图标名称改为 `favicon.ico`，然后把图标放在 `/themes/next/source/images` 里，并且修改 <span class=\"purple-target\">主题配置文件</span>：\n```yml\n# Put your favicon.ico into `hexo-site/source/` directory.\nfavicon: /favicon.ico\n```\n\n#### 在文章底部增加版权信息\n在目录 `next/layout/_macro/` 下添加 `my-copyright.swig`：\n```html\n{% if page.copyright %}\n<div class=\"my_post_copyright\">\n  <script src=\"//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js\"></script>\n  \n  <!-- JS库 sweetalert 可修改路径 -->\n  <script src=\"https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js\"></script>\n  <script src=\"https://unpkg.com/sweetalert/dist/sweetalert.min.js\"></script>\n  <p><span>本文标题:</span><a href=\"{{ url_for(page.path) }}\">{{ page.title }}</a></p>\n  <p><span>文章作者:</span><a href=\"/\" title=\"访问 {{ theme.author }} 的个人博客\">{{ theme.author }}</a></p>\n  <p><span>发布时间:</span>{{ page.date.format(\"YYYY年MM月DD日 - HH:mm\") }}</p>\n  <p><span>最后更新:</span>{{ page.updated.format(\"YYYY年MM月DD日 - HH:mm\") }}</p>\n  <p><span>原始链接:</span><a href=\"{{ url_for(page.path) }}\" title=\"{{ page.title }}\">{{ page.permalink }}</a>\n    <span class=\"copy-path\"  title=\"点击复制文章链接\"><i class=\"fa fa-clipboard\" data-clipboard-text=\"{{ page.permalink }}\"  aria-label=\"复制成功！\"></i></span>\n  </p>\n  <p><span>许可协议:</span><i class=\"fa fa-creative-commons\"></i> <a rel=\"license\" href=\"https://creativecommons.org/licenses/by-nc-nd/4.0/\" target=\"_blank\" title=\"Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)\">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  \n</div>\n<script> \n    var clipboard = new Clipboard('.fa-clipboard');\n    $(\".fa-clipboard\").click(function(){\n      clipboard.on('success', function(){\n        swal({   \n          title: \"\",   \n          text: '复制成功',\n          icon: \"success\", \n          showConfirmButton: true\n          });\n\t});\n    });  \n</script>\n{% endif %}\n```\n在目录 `next/source/css/_common/components/post/` 下添加 `my-post-copyright.styl`：\n```css\n.my_post_copyright {\n  width: 85%;\n  max-width: 45em;\n  margin: 2.8em auto 0;\n  padding: 0.5em 1.0em;\n  border: 1px solid #d3d3d3;\n  font-size: 0.93rem;\n  line-height: 1.6em;\n  word-break: break-all;\n  background: rgba(255,255,255,0.4);\n}\n.my_post_copyright p{margin:0;}\n.my_post_copyright span {\n  display: inline-block;\n  width: 5.2em;\n  color: #b5b5b5;\n  font-weight: bold;\n}\n.my_post_copyright .raw {\n  margin-left: 1em;\n  width: 5em;\n}\n.my_post_copyright a {\n  color: #808080;\n  border-bottom:0;\n}\n.my_post_copyright a:hover {\n  color: #a3d2a3;\n  text-decoration: underline;\n}\n.my_post_copyright:hover .fa-clipboard {\n  color: #000;\n}\n.my_post_copyright .post-url:hover {\n  font-weight: normal;\n}\n.my_post_copyright .copy-path {\n  margin-left: 1em;\n  width: 1em;\n  +mobile(){display:none;}\n}\n.my_post_copyright .copy-path:hover {\n  color: #808080;\n  cursor: pointer;\n}\n```\n修改 `next/layout/_macro/post.swig`，在之前添加 **底部阅读完毕** 代码中，再添加如下代码：\n```html\n{% include 'my-copyright.swig' %}\n```\n如图所示：\n<img src=\"./my-copyright.png\" alt=\"my-copyright.png\"/>\n修改 `next/source/css/_common/components/post/post.styl` 文件，在最后一行增加代码：\n``` css\n@import \"my-post-copyright\"\n```\n如果要在该博文下面增加版权信息的显示，需要在 **Markdown** 中增加 `copyright: true` 的设置，如图所示：\n\n<img src=\"./show-copyright.png\" alt=\"show-copyright.png\"/>\n\n#### 隐藏网页底部 powered By Hexo / 强力驱动\n打开 `themes/next/layout/_partials/footer.swig`，隐藏之间的代码即可，或者直接删除。位置如图：\n<img src=\"./hide-hexo.png\" alt=\"hide-hexo.png\"/>\n\n#### <a name = \"live2d\" style=\"cursor: default; color: #fff; border-bottom: none; :hover {color: #fff; border-bottom: none;}\">添加 Live 2D 小宠物</a>\n切换至 `Hexo` 根目录下，在终端中输入以下代码：\n```bash\n$ npm install -save hexo-helper-live2d\n```\n\n编辑 <span class = \"blue-target\">站点配置文件</span>：（具体配置见 [官方文档](https://github.com/EYHN/hexo-helper-live2d)）\n```yml\nlive2d:\n  enable: true\n  scriptFrom: local\n  pluginRootPath: live2dw/\n  pluginJsPath: lib/\n  pluginModelPath: assets/\n  model:\n    use: live2d-widget-model-wanko\n  display:\n    position: right\n    width: 150\n    height: 300\n  mobile:\n    show: true\n```\n\n我的 [这一篇博客](https://www.wqh4u.cn/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/) 中写了一些关于 <span class = \"blue-target\">Live 2D</span> 的一些进阶设置，感兴趣的看官可以参考一下。\n\n> 完~\n\n## 参考文献\n1. [文档 | Hexo](https://hexo.io/zh-cn/docs/)\n2. [Themes | Hexo](https://hexo.io/themes/)\n3. [开始使用 - NexT 使用文档](http://theme-next.iissnan.com/getting-started.html)\n4. [结合hexo在GitHub上搭建个人博客——全过程](https://www.cnblogs.com/trista222/p/8017300.html)\n5. [阿里云CentOS下Hexo+Nginx建站过程 - 来吧，和鹿丸君一起打豆豆](https://blog.csdn.net/coding01/article/details/80083033)\n6. [hexo的next主题个性化教程:打造炫酷网站](http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html)\n","slug":"Hexo博客的安装与基本配置","published":1,"updated":"2020-01-14T20:30:46.681Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn5h000e2lwj52zf0kud","content":"<style type=\"text/css\">\n.quotetitle {\n    color: #337ab7;\n    font-weight: 700;\n}\n\n.redspan {\n    color: #ff0000;\n}\n\n.italic {\n    font-style: italic;\n}\n\n</style>\n\n<blockquote>\n<p><span class=\"introduction\">不先经历风雨，怎能见彩虹？</span><br><br>在经历了无数次失败后，终于将我的 <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a> 配置到了自己能看得过去的样子。<br>特此写下 Blog 为更多想了解 Hexo 的人阅读使用。</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"环境搭建\"><a href=\"#环境搭建\" class=\"headerlink\" title=\"环境搭建\"></a>环境搭建</h2><h3 id=\"本人环境配置：\"><a href=\"#本人环境配置：\" class=\"headerlink\" title=\"本人环境配置：\"></a>本人环境配置：</h3><ul>\n<li>服务器：腾讯云学生机，<code>Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-29-generic x86_64)</code></li>\n<li>Node.js：在 Hexo 的<a href=\"https://hexo.io/zh-cn/docs/\" target=\"_blank\" rel=\"noopener\">官方文档</a>里面有说，<code>Node.js</code> 的版本不得低于 <code>6.9</code>，这里提供两种安装 <code>Node.js</code> 的方式：</li>\n</ul>\n<p>cURL：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ curl https://raw.github.com/creationix/nvm/v0.33.11/install.sh | sh</span><br></pre></td></tr></table></figure>\n<p>Wget：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ wget -qO- https://raw.github.com/creationix/nvm/v0.33.11/install.sh | sh</span><br></pre></td></tr></table></figure>\n<p>安装完成后，重启终端并执行下列命令即可安装 Node.js。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ nvm install stable</span><br></pre></td></tr></table></figure>\n<p>或者可以在 <code>Node.js</code> 的官网上<a href=\"https://nodejs.org/en/\" target=\"_blank\" rel=\"noopener\">下载安装</a>。</p>\n<blockquote>\n<p><span class=\"quotetitle\">Windows用户</span><br><br>对于 windows 用户来说，建议使用安装程序进行安装。安装时，请勾选 Add to PATH 选项。<br>另外，您也可以使用 Git Bash，这是 git for windows 自带的一组程序，提供了 Linux 风格的 shell，在该环境下，您可以直接用上面提到的命令来安装 Node.js。打开它的方法很简单，在任意位置单击右键，选择 “Git Bash Here” 即可。由于 Hexo 的很多操作都涉及到命令行，您可以考虑始终使用 Git Bash 来进行操作。</p>\n</blockquote>\n<ul>\n<li>Git：我的 <code>Git</code> 版本为 <em><code>git version 2.17.1</code></em> </li>\n</ul>\n<p>这里使用 <code>Ubuntu</code> 或 <code>Debian</code> 系的：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo apt-get install git-core</span><br></pre></td></tr></table></figure>\n<p>或者使用 <code>Fedora</code>、<code>红帽</code>或者 <code>CentOS</code>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum install git-core</span><br></pre></td></tr></table></figure>\n<p>像 <code>Arch Linux</code> 等其他发行版请自行善用包管理器进行安装。</p>\n<blockquote>\n<p><span class=\"quotetitle\">Windows用户</span><br><br>由于<del>众所周知</del>的原因，从上面的链接下载 git for windows 最好挂上一个代理，否则下载速度十分缓慢。也可以参考<a href=\"https://github.com/waylau/git-for-win\" target=\"_blank\" rel=\"noopener\">这里</a>，收录了存储于百度云的下载地址。</p>\n</blockquote>\n<h3 id=\"开始安装\"><a href=\"#开始安装\" class=\"headerlink\" title=\"开始安装\"></a>开始安装</h3><p>现在我们开始安装 <code>Hexo</code>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure>\n<p>如果发现下载奇慢，那么请首先更换你的 npm 源：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm config <span class=\"built_in\">set</span> registry https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"开始使用\"><a href=\"#开始使用\" class=\"headerlink\" title=\"开始使用\"></a>开始使用</h2><h3 id=\"初始化-Hexo\"><a href=\"#初始化-Hexo\" class=\"headerlink\" title=\"初始化 Hexo\"></a>初始化 Hexo</h3><p>安装 <code>Hexo</code> 完成后，请执行下列命令，<code>Hexo</code> 将会在指定文件夹中新建所需要的文件。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo init &lt;folder&gt;</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> &lt;folder&gt;</span><br></pre></td></tr></table></figure>\n<p>其中，<strong><code>&lt;folder&gt;</code></strong> 就是你要在哪个路径下安装 <code>Hexo</code>，比如 <code>/home/ubuntu/hexo/</code>。<br>新建完成后，指定文件夹的目录如下：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">├── _config.yml</span><br><span class=\"line\">├── package.json</span><br><span class=\"line\">├── scaffolds</span><br><span class=\"line\">├── <span class=\"built_in\">source</span></span><br><span class=\"line\">|   ├── _drafts</span><br><span class=\"line\">|   └── _posts</span><br><span class=\"line\">└── themes</span><br></pre></td></tr></table></figure>\n<p>详细说明如下：</p>\n<blockquote>\n<ol>\n<li><code>_config.yml</code> 是 YAML 格式文件，也是 Hexo 的站点 <strong>重要配置文件</strong> ，以后很多的自定义配置都要修改这个文件。</li>\n<li>package.json 配置 Hexo 运行需要的 Node.js 包，不用手动更改。</li>\n<li>scaffolds 是模板文件夹。这个“模板”就是指新建的 markdown 文件的模板，每新建一个 markdown 文件（由于 Hexo 使用 markdown 语法，在渲染生成静态 HTML 页面之前，源文件都是 markdown 文件），就会包含对应模板的内容。<br>该文件夹内有三个模板： </li>\n</ol>\n<ul>\n<li>draft.md — 草稿的模板 </li>\n<li>page.md — 页面的模板 </li>\n<li>post.md — 文章的模板</li>\n</ul>\n<ol start=\"4\">\n<li>source 是资源文件夹，资源文件夹是存放用户资源的地方。除 posts 文件夹之外，开头命名为 (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。 </li>\n<li>themes 是主题文件夹。Hexo 会根据主题来生成静态页面。</li>\n</ol>\n</blockquote>\n<h3 id=\"初次运行Hexo\"><a href=\"#初次运行Hexo\" class=\"headerlink\" title=\"初次运行Hexo\"></a>初次运行Hexo</h3><p>输入 <span class=\"redspan italic\">hexo generate</span> 命令来生成静态文件。</p>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>1：生成的静态文件存放在 public 文件夹中<br><br>2：此命令可简写为 <em><code>hexo g</code></em></p>\n</blockquote>\n<p>然后输入 <span class=\"redspan italic\">hexo server</span> (可简写为 <em><code>hexo s</code></em>)来启动服务器。</p>\n<p>默认情况下，端口号为 4000，所以服务器启动成功后，在浏览器中输入 <code>http://&lt;你的IP地址&gt;:4000</code> ，即可看到第一次运行的状况。</p>\n<p>和 Django 一样，按 <em><code>Ctrl + c</code></em> 结束服务。</p>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>如果运行时没有报任何错误，但是浏览器中显示网页无法访问，可能是你的服务器安全组没有配置，像腾讯云或者阿里云都需要配置端口安全组策略，请先去设置 4000 端口开放形式，再运行 Hexo 服务。</p>\n</blockquote>\n<hr>\n\n<h2 id=\"安装并配置Nginx\"><a href=\"#安装并配置Nginx\" class=\"headerlink\" title=\"安装并配置Nginx\"></a>安装并配置Nginx</h2><p>安装 <code>Nginx</code> 主要是想让网站能随时随地访问，不像上文中 Hexo 提供的 server，只能手动输入命令后才能访问到网站。</p>\n<h3 id=\"安装Nginx\"><a href=\"#安装Nginx\" class=\"headerlink\" title=\"安装Nginx\"></a>安装Nginx</h3><p>在 <code>Ubuntu</code> 上安装 <code>Nginx</code> 方法很简单：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo apt install nginx</span><br></pre></td></tr></table></figure>\n<h4 id=\"配置防火墙\"><a href=\"#配置防火墙\" class=\"headerlink\" title=\"配置防火墙\"></a>配置防火墙</h4><p>如果您正在运行防火墙，则还需要打开端口 <code>80</code> 和 <code>443</code>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo ufw allow <span class=\"string\">'Nginx Full'</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"启动Nginx服务\"><a href=\"#启动Nginx服务\" class=\"headerlink\" title=\"启动Nginx服务\"></a>启动Nginx服务</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo systemctl start nginx</span><br></pre></td></tr></table></figure>\n<p>此时，用浏览器访问 <code>http://&lt;你的IP地址&gt;</code> 便可以看到 <code>Nginx</code> 的测试页面，即表示 <code>Nginx</code> 启动成功！</p>\n<p>继续输入以下命令使 <code>Nginx</code> 开机自动启动：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ systemctl <span class=\"built_in\">enable</span> nginx</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"配置静态服务器访问路径\"><a href=\"#配置静态服务器访问路径\" class=\"headerlink\" title=\"配置静态服务器访问路径\"></a>配置静态服务器访问路径</h2><p><code>Nginx</code> 需要配置静态资源的路径信息才能通过 <code>url</code> 正确访问到服务器上的静态资源。 <br><br>即是要将 <code>Hexo</code> 生成的静态资源的路径放置到 <code>Nginx</code> 的访问路径</p>\n<p>打开 <code>Nginx</code> 的默认配置文件 <code>/etc/nginx/nginx.conf</code> ，将默认的 <code>root /usr/share/nginx/html</code> 修改为： <code>root /…/&lt;folder&gt;/public</code>，里面的 <code>&lt;folder&gt;</code> 就是你刚刚Hexo安装的文件夹。</p>\n<p>修改完成后保存，输入以下命令重启 <code>Nginx</code>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ nginx -s reload</span><br></pre></td></tr></table></figure>\n<p>此时再次访问你的 IP 地址，若显示上文的 <code>Hexo</code> 初次运行的样子，则说明配置成功。</p>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>可能会报 403 错误，原因是 Nginx 没有权限访问 public文件夹，修改方法有两种： <br><br>1：修改 public 文件夹的权限，修改为 777（即任何人可读可写可执行），不推荐； <br><br>2：修改 nginx.conf 中的 user（可能在第5行），改为可以访问 public文件夹的用户，如 root。</p>\n</blockquote>\n<h2 id=\"配置Hexo\"><a href=\"#配置Hexo\" class=\"headerlink\" title=\"配置Hexo\"></a>配置Hexo</h2><h3 id=\"站点配置\"><a href=\"#站点配置\" class=\"headerlink\" title=\"站点配置\"></a>站点配置</h3><p>配置 Hexo 时，需要修改上文提到的根目录下的 <code>_config.yml</code> 文件，主要修改的就是这部分：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Site</span></span><br><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">Euphoria</span> <span class=\"string\">Blog</span>      <span class=\"comment\"># 网站标题</span></span><br><span class=\"line\"><span class=\"attr\">subtitle:</span>                 <span class=\"comment\"># 网站副标题</span></span><br><span class=\"line\"><span class=\"attr\">description:</span>              <span class=\"comment\"># 网站描述，可以是你喜欢的一句话 :)</span></span><br><span class=\"line\"><span class=\"attr\">keywords:</span> <span class=\"string\">Euphoria</span>        <span class=\"comment\"># 网站关键词  </span></span><br><span class=\"line\"><span class=\"attr\">author:</span> <span class=\"string\">Euphoria</span>          <span class=\"comment\"># 你的名字</span></span><br><span class=\"line\"><span class=\"attr\">language:</span> <span class=\"string\">zh-CN</span>           <span class=\"comment\"># 网站使用的语言</span></span><br><span class=\"line\"><span class=\"attr\">timezone:</span>                 <span class=\"comment\"># 网站时区，默认使用服务器的时区</span></span><br></pre></td></tr></table></figure>\n<p>其余的文件内容可以使用默认值，萌新可不必修改，具体参见<a href=\"https://hexo.io/zh-cn/docs/configuration.html\" target=\"_blank\" rel=\"noopener\">官方文档</a>。</p>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>修改yml文件时应注意“:”后面应加空格。</p>\n</blockquote>\n<h2 id=\"配置主题\"><a href=\"#配置主题\" class=\"headerlink\" title=\"配置主题\"></a>配置主题</h2><p>Hexo 安装主题的方式非常简单，只需要将主题文件拷贝至站点目录的 <code>themes</code> 目录下，你可以在<a href=\"https://hexo.io/themes/\" target=\"_blank\" rel=\"noopener\">这里</a>寻找你喜欢的主题，然后修改下配置文件即可。</p>\n<p>在 Hexo 中有两份主要的配置文件，其名称都是 <code>_config.yml</code>。 其中，一份位于站点根目录下，主要包含 Hexo 本身的配置；另一份位于主题目录下，这份配置由主题作者提供，主要用于配置主题相关的选项。</p>\n<p>为了描述方便，在以下说明中，将前者称为 <span class=\"blue-target\">站点配置文件</span>， 后者称为 <span class=\"purple-target\">主题配置文件</span>。</p>\n<p>这里我强烈推荐 <code>NexT</code> 这款主题，接下来为安装及其配置方法：</p>\n<h3 id=\"安装-NexT\"><a href=\"#安装-NexT\" class=\"headerlink\" title=\"安装 NexT\"></a>安装 NexT</h3><p>如果你熟悉 Git，建议你使用 <code>克隆最新版本</code> 的方式，之后的更新可以通过 <code>git pull</code> 来快速更新， 而不用再次下载压缩包替换。</p>\n<p>在终端窗口下，定位到 Hexo 站点目录下。使用 <code>Git checkout</code> 代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> your-hexo-site</span><br><span class=\"line\">$ git <span class=\"built_in\">clone</span> https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"启用主题\"><a href=\"#启用主题\" class=\"headerlink\" title=\"启用主题\"></a>启用主题</h3><p>与所有 <code>Hexo</code> 主题启用的模式一样。 当 <code>克隆/下载</code> 完成后，打开 <span class=\"blue-target\">站点配置文件</span>， 找到 <code>theme</code> 字段，并将其值更改为 <code>next</code>。</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">theme:</span> <span class=\"string\">next</span></span><br></pre></td></tr></table></figure>\n<p>到此，NexT 主题安装完成。下一步我们将验证主题是否正确启用。在切换主题之后、验证之前， 我们最好使用 <code>hexo clean</code> 来清除 Hexo 的缓存。</p>\n<h3 id=\"个性化主题\"><a href=\"#个性化主题\" class=\"headerlink\" title=\"个性化主题\"></a>个性化主题</h3><h4 id=\"选择-Scheme\"><a href=\"#选择-Scheme\" class=\"headerlink\" title=\"选择 Scheme\"></a>选择 Scheme</h4><p>Scheme 是 NexT 提供的一种特性，借助于 Scheme，NexT 为你提供多种不同的外观。同时，几乎所有的配置都可以 在 Scheme 之间共用。目前 NexT 支持三种 Scheme，他们是：</p>\n<ul>\n<li>Muse - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白</li>\n<li>Mist - Muse 的紧凑版本，整洁有序的单栏外观</li>\n<li>Pisces - 双栏 Scheme，小家碧玉似的清新</li>\n</ul>\n<p>Scheme 的切换通过更改 <span class=\"purple-target\">主题配置文件</span>，搜索 scheme 关键字。 你会看到有三行 scheme 的配置，将你需用启用的 scheme 前面注释 # 去除即可。</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># scheme: Muse</span></span><br><span class=\"line\"><span class=\"attr\">scheme:</span> <span class=\"string\">Mist</span></span><br><span class=\"line\"><span class=\"comment\"># scheme: Pisces</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"设置语言\"><a href=\"#设置语言\" class=\"headerlink\" title=\"设置语言\"></a>设置语言</h4><p>编辑 <span class=\"blue-target\">站点配置文件</span>， 将 <code>language</code> 设置成你所需要的语言。建议明确设置你所需要的语言，例如选用简体中文，配置如下：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">language:</span> <span class=\"string\">zh-Hans</span></span><br></pre></td></tr></table></figure>\n<p>目前 NexT 支持的语言如以下表格所示：</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">语言</th>\n<th align=\"left\">代码</th>\n<th align=\"left\">设定示例</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">English</td>\n<td align=\"left\">en</td>\n<td align=\"left\">language: en</td>\n</tr>\n<tr>\n<td align=\"left\">简体中文</td>\n<td align=\"left\">zh-Hans</td>\n<td align=\"left\">language: zh-Hans</td>\n</tr>\n<tr>\n<td align=\"left\">Français</td>\n<td align=\"left\">fr-FR</td>\n<td align=\"left\">language: fr-FR</td>\n</tr>\n<tr>\n<td align=\"left\">Português</td>\n<td align=\"left\">pt</td>\n<td align=\"left\">language: pt or language: pt-BR</td>\n</tr>\n<tr>\n<td align=\"left\">繁體中文</td>\n<td align=\"left\">zh-hk 或者 zh-tw</td>\n<td align=\"left\">language: zh-hk</td>\n</tr>\n<tr>\n<td align=\"left\">Русский язык</td>\n<td align=\"left\">ru</td>\n<td align=\"left\">language: ru</td>\n</tr>\n<tr>\n<td align=\"left\">Deutsch</td>\n<td align=\"left\">de</td>\n<td align=\"left\">language: de</td>\n</tr>\n<tr>\n<td align=\"left\">日本語</td>\n<td align=\"left\">ja</td>\n<td align=\"left\">language: ja</td>\n</tr>\n<tr>\n<td align=\"left\">Indonesian</td>\n<td align=\"left\">id</td>\n<td align=\"left\">language: id</td>\n</tr>\n<tr>\n<td align=\"left\">Korean</td>\n<td align=\"left\">ko</td>\n<td align=\"left\">language: ko</td>\n</tr>\n</tbody></table>\n<h4 id=\"设置菜单\"><a href=\"#设置菜单\" class=\"headerlink\" title=\"设置菜单\"></a>设置菜单</h4><p>菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是 <a href=\"https://fontawesome.com/?from=io\" target=\"_blank\" rel=\"noopener\">Font Awesome</a> 提供的图标， Font Awesome 提供了 600+ 的图标，可以满足绝大的多数的场景，同时无须担心在 Retina 屏幕下 图标模糊的问题。</p>\n<p>编辑 <span class=\"purple-target\">主题配置文件</span>，修改以下内容：</p>\n<ol>\n<li><p>设定菜单内容，对应的字段是 <code>menu</code>。 菜单内容的设置格式是：<code>item name: link</code>。其中 <code>item name</code> 是一个名称，这个名称并不直接显示在页面上，她将用于匹配图标以及翻译。</p>\n <figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">menu:</span></span><br><span class=\"line\"> <span class=\"attr\">home:</span> <span class=\"string\">/</span></span><br><span class=\"line\"> <span class=\"attr\">archives:</span> <span class=\"string\">/archives</span></span><br><span class=\"line\"> <span class=\"comment\">#about: /about</span></span><br><span class=\"line\"> <span class=\"comment\">#categories: /categories</span></span><br><span class=\"line\"> <span class=\"attr\">tags:</span> <span class=\"string\">/tags</span></span><br><span class=\"line\"> <span class=\"comment\">#commonweal: /404.html</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br> 若你的站点运行在子目录中，请将链接前缀的 / 去掉！</p>\n</blockquote>\n<p> NexT 默认的菜单项有（标注 * 的项表示需要手动创建这个页面）：</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">键值</th>\n<th align=\"left\">设定值</th>\n<th align=\"left\">显示文本（简体中文）</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">home</td>\n<td align=\"left\">home: /</td>\n<td align=\"left\">主页</td>\n</tr>\n<tr>\n<td align=\"left\">archives</td>\n<td align=\"left\">archives: /archives</td>\n<td align=\"left\">归档页</td>\n</tr>\n<tr>\n<td align=\"left\">categories</td>\n<td align=\"left\">categories: /categories</td>\n<td align=\"left\">分类页</td>\n</tr>\n<tr>\n<td align=\"left\">tags</td>\n<td align=\"left\">tags: /tags</td>\n<td align=\"left\">标签页</td>\n</tr>\n<tr>\n<td align=\"left\">about</td>\n<td align=\"left\">about: /about</td>\n<td align=\"left\">关于页面</td>\n</tr>\n<tr>\n<td align=\"left\">commonweal</td>\n<td align=\"left\">commonweal: /404.html</td>\n<td align=\"left\">公益 404</td>\n</tr>\n</tbody></table>\n</li>\n<li><p>设置菜单项的显示文本。在第一步中设置的菜单的名称并不直接用于界面上的展示。Hexo 在生成的时候将使用 这个名称查找对应的语言翻译，并提取显示文本。这些翻译文本放置在 NexT 主题目录下的 <code>languages/{language}.yml</code> （{language} 为你所使用的语言）。</p>\n<p> 以简体中文为例，若你需要添加一个菜单项，比如 <code>something</code>。那么就需要修改简体中文对应的翻译文件 <code>languages/zh-Hans.yml</code>，在 <code>menu</code> 字段下添加一项：</p>\n <figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">menu:</span></span><br><span class=\"line\">  <span class=\"attr\">home:</span> <span class=\"string\">首页</span></span><br><span class=\"line\">  <span class=\"attr\">archives:</span> <span class=\"string\">归档</span></span><br><span class=\"line\">  <span class=\"attr\">categories:</span> <span class=\"string\">分类</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span> <span class=\"string\">标签</span></span><br><span class=\"line\">  <span class=\"attr\">about:</span> <span class=\"string\">关于</span></span><br><span class=\"line\">  <span class=\"attr\">search:</span> <span class=\"string\">搜索</span></span><br><span class=\"line\">  <span class=\"attr\">commonweal:</span> <span class=\"string\">公益404</span></span><br><span class=\"line\">  <span class=\"attr\">something:</span> <span class=\"string\">有料</span></span><br></pre></td></tr></table></figure></li>\n<li><p>设定菜单项的图标，对应的字段是 <code>menu_icons</code>。 此设定格式是 <code>item name: icon name</code>，其中 <code>item name</code> 与上一步所配置的菜单名字对应，<code>icon name</code> 是 <strong>Font Awesome</strong> 图标的 <strong>名字</strong>。而 <code>enable</code> 可用于控制是否显示图标，你可以设置成 <code>false</code> 来去掉图标。</p>\n <figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">menu_icons:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\"># Icon Mapping.</span></span><br><span class=\"line\">  <span class=\"attr\">home:</span> <span class=\"string\">home</span></span><br><span class=\"line\">  <span class=\"attr\">about:</span> <span class=\"string\">user</span></span><br><span class=\"line\">  <span class=\"attr\">categories:</span> <span class=\"string\">th</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span> <span class=\"string\">tags</span></span><br><span class=\"line\">  <span class=\"attr\">archives:</span> <span class=\"string\">archive</span></span><br><span class=\"line\">  <span class=\"attr\">commonweal:</span> <span class=\"string\">heartbeat</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br> 1: 在菜单图标开启的情况下，如果菜单项与菜单未匹配（没有设置或者无效的 <strong>Font Awesome</strong> 图标名字） 的情况下，NexT 将会使用 <strong>?</strong> 作为图标。<br><br> 2: 请注意键值（如 <code>home</code>）的大小写要严格匹配。</p>\n</blockquote>\n</li>\n</ol>\n<h4 id=\"设置侧栏\"><a href=\"#设置侧栏\" class=\"headerlink\" title=\"设置侧栏\"></a>设置侧栏</h4><p>默认情况下，侧栏仅在文章页面（拥有目录列表）时才显示，并放置于右侧位置。 可以通过修改 <span class=\"purple-target\">主题配置文件</span> 中的 <code>sidebar</code> 字段来控制侧栏的行为。侧栏的设置包括两个部分，其一是侧栏的位置， 其二是侧栏显示的时机。</p>\n<ol>\n<li>设置侧栏的位置，修改 <code>sidebar.position</code> 的值，支持的选项有：<ul>\n<li>left - 靠左放置</li>\n<li>right - 靠右放置<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>目前仅 Pisces Scheme 支持 position 配置。影响版本 <span class=\"red-target\">5.0.0</span> 及更低版本。</p>\n</blockquote>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">sidebar:</span></span><br><span class=\"line\">  <span class=\"attr\">position:</span> <span class=\"string\">left</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li>设置侧栏显示的时机，修改 sidebar.display 的值，支持的选项有：<ul>\n<li>post - 默认行为，在文章页面（拥有目录列表）时显示</li>\n<li>always - 在所有页面中都显示</li>\n<li>hide - 在所有页面中都隐藏（可以手动展开）</li>\n<li>remove - 完全移除<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">sidebar:</span></span><br><span class=\"line\">  <span class=\"attr\">display:</span> <span class=\"string\">post</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>已知侧栏在 use motion: false 的情况下不会展示。影响版本 <span class=\"red-target\">5.0.0</span> 及更低版本。</p>\n</blockquote>\n</li>\n</ul>\n</li>\n</ol>\n<h4 id=\"设置头像\"><a href=\"#设置头像\" class=\"headerlink\" title=\"设置头像\"></a>设置头像</h4><p>编辑 <span class=\"purple-target\">主题配置文件</span>， 修改字段 <code>avatar</code>， 值设置成头像的链接地址。其中，头像的链接地址可以是：</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">地址</th>\n<th align=\"left\">值</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">完整的互联网 URI</td>\n<td align=\"left\"><a href=\"http://example.com/avatar.png\" target=\"_blank\" rel=\"noopener\">http://example.com/avatar.png</a></td>\n</tr>\n<tr>\n<td align=\"left\">站点内的地址</td>\n<td align=\"left\">将头像放置主题目录下的 source/uploads/ （新建 uploads 目录若不存在）<br>配置为：avatar: /uploads/avatar.png<br>或者 放置在 source/images/ 目录下<br>配置为：avatar: /images/avatar.png</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">avatar:</span> <span class=\"string\">http://example.com/avatar.png</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"设置代码高亮主题\"><a href=\"#设置代码高亮主题\" class=\"headerlink\" title=\"设置代码高亮主题\"></a>设置代码高亮主题</h4><p>NexT 使用 <a href=\"https://github.com/chriskempson/tomorrow-theme\" target=\"_blank\" rel=\"noopener\">Tomorrow Theme</a> 作为代码高亮，共有5款主题供你选择。 NexT 默认使用的是白色的 <code>normal</code> 主题，可选的值有 <code>normal</code>，<code>night</code>， <code>night blue</code>， <code>night bright</code>， <code>night eighties</code>：</p>\n<div>\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/tomorrow.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow.png\">\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/tomorrow-night.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night.png\">\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/tomorrow-night-blue.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night-blue.png\">\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/tomorrow-night-bright.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night-bright.png\">\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/tomorrow-night-eighties.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night-eighties.png\">\n</div>\n<div style=\"clear: both;\"></div>\n更改 <span class=\"purple-target\">主题配置文件</span> 中 `highlight_theme` 字段，将其值设定成你所喜爱的高亮主题，例如：\n\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Code Highlight theme</span></span><br><span class=\"line\"><span class=\"comment\"># Available value: normal | night | night eighties | night blue | night bright</span></span><br><span class=\"line\"><span class=\"comment\"># https://github.com/chriskempson/tomorrow-theme</span></span><br><span class=\"line\"><span class=\"attr\">highlight_theme:</span> <span class=\"string\">normal</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"侧边栏社交链接\"><a href=\"#侧边栏社交链接\" class=\"headerlink\" title=\"侧边栏社交链接\"></a>侧边栏社交链接</h4><p>侧栏社交链接的修改包含两个部分，第一是链接，第二是链接图标。 两者配置均在 <span class=\"purple-target\">主题配置文件</span> 中。</p>\n<ol>\n<li>链接放置在 <code>social</code> 字段下，一行一个链接。其键值格式是 <code>显示文本: 链接地址</code>。 <figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Social links</span></span><br><span class=\"line\"><span class=\"attr\">social:</span></span><br><span class=\"line\">  <span class=\"attr\">GitHub:</span> <span class=\"string\">https://github.com/your-user-name</span></span><br><span class=\"line\">  <span class=\"attr\">Twitter:</span> <span class=\"string\">https://twitter.com/your-user-name</span></span><br><span class=\"line\">  <span class=\"string\">微博:</span> <span class=\"string\">http://weibo.com/your-user-name</span></span><br><span class=\"line\">  <span class=\"string\">豆瓣:</span> <span class=\"string\">http://douban.com/people/your-user-name</span></span><br><span class=\"line\">  <span class=\"string\">知乎:</span> <span class=\"string\">http://www.zhihu.com/people/your-user-name</span></span><br><span class=\"line\">  <span class=\"comment\"># 等等...</span></span><br></pre></td></tr></table></figure></li>\n<li>设定链接的图标，对应的字段是 <code>social_icons</code>。其键值格式是 匹配键: <strong>Font Awesome</strong> 图标名称， 匹配键 与上一步所配置的链接的 显示文本 相同（大小写严格匹配），图标名称 是 <strong>Font Awesome</strong> 图标的名字（不必带 fa- 前缀）。 <code>enable</code> 选项用于控制是否显示图标，你可以设置成 <code>false</code> 来去掉图标。 <figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Social Icons</span></span><br><span class=\"line\"><span class=\"attr\">social_icons:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\"># Icon Mappings</span></span><br><span class=\"line\">  <span class=\"attr\">GitHub:</span> <span class=\"string\">github</span></span><br><span class=\"line\">  <span class=\"attr\">Twitter:</span> <span class=\"string\">twitter</span></span><br><span class=\"line\">  <span class=\"string\">微博:</span> <span class=\"string\">weibo</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h4 id=\"开启打赏功能-由-habren-贡献\"><a href=\"#开启打赏功能-由-habren-贡献\" class=\"headerlink\" title=\"开启打赏功能 由 habren 贡献\"></a>开启打赏功能 <sub>由 <a href=\"https://github.com/iissnan/hexo-theme-next/pull/687\" target=\"_blank\" rel=\"noopener\">habren</a> 贡献</sub></h4><p>越来越多的平台（微信公众平台，新浪微博，简书，百度打赏等）支持打赏功能，付费阅读时代越来越近，特此增加了打赏功能，支持微信打赏和支付宝打赏。 只需要 <span class=\"purple-target\">主题配置文件</span> 中填入 <code>微信</code> 和 <code>支付宝</code> 收款二维码图片地址，即可开启该功能。</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">reward_comment:</span> <span class=\"string\">坚持原创技术分享，您的支持将鼓励我继续创作！</span></span><br><span class=\"line\"><span class=\"attr\">wechatpay:</span> <span class=\"string\">/path/to/wechat-reward-image</span></span><br><span class=\"line\"><span class=\"attr\">alipay:</span> <span class=\"string\">/path/to/alipay-reward-image</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"站点建立时间\"><a href=\"#站点建立时间\" class=\"headerlink\" title=\"站点建立时间\"></a>站点建立时间</h4><p>这个时间将在站点的底部显示，例如 © 2013 - 2015。 编辑 <span class=\"purple-target\">主题配置文件</span>，新增字段 <code>since</code>。</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">since:</span> <span class=\"number\">2013</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"实现-fork-me-on-github\"><a href=\"#实现-fork-me-on-github\" class=\"headerlink\" title=\"实现 fork me on github\"></a>实现 fork me on github</h4><p>点击 <a href=\"https://github.com/blog/273-github-ribbons\" target=\"_blank\" rel=\"noopener\">这里</a> 或者 <a href=\"http://tholman.com/github-corners/\" target=\"_blank\" rel=\"noopener\">这里</a> 挑选自己喜欢的样式，并复制旁边的对应代码。</p>\n<p>然后粘贴刚才复制的代码到 <code>themes/next/layout/_layout.swig</code> 文件中(放在 <code>&lt;div class=&quot;headband&quot;&gt;&lt;/div&gt;</code> 的下面)，并把 <code>href</code> 改为你的 <code>github</code> 地址，比如 <code>https://github.com/euphoriachn</code>。</p>\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/fork-on-github.png\" alt=\"fork-on-github.png\">\n\n<h4 id=\"添加动态背景\"><a href=\"#添加动态背景\" class=\"headerlink\" title=\"添加动态背景\"></a>添加动态背景</h4><blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>如果 <code>NexT</code> 主题在 <span class=\"red-target\">5.1.1</span> 以上的话就不用我这样设置，直接在主题配置文件中找到 <code>canvas_nest: false</code>，把它改为 <code>canvas_nest: true</code> 就行了（注意分号后面要加一个空格）。如果发现这样并不行 <del>（像我一样）</del>，或者版本低于 <code>5.1.1</code> 的话，请按照如下操作进行。</p>\n</blockquote>\n<ol>\n<li><p>修改 <code>_layout.swig</code></p>\n<p> 打开 <code>next/layout/_layout.swig</code><br> 在 <code>&lt;/body&gt;</code> 之前添加代码（注意不要放在 <code>&lt;/body&gt;</code> 的后面）</p>\n <figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;# TODO: Euphoria #&#125;</span><br><span class=\"line\">&#123;% if theme.canvas_nest %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>修改配置文件<br> 打开 <code>/next/_config.yml</code>，在里面添加如下代码：(可以放在最后面)</p>\n <figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># --------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># background settings</span></span><br><span class=\"line\"><span class=\"comment\"># --------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># add canvas-nest effect</span></span><br><span class=\"line\"><span class=\"comment\"># see detail from https://github.com/hustcc/canvas-nest.js</span></span><br><span class=\"line\"><span class=\"attr\">canvas_nest:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>试试 <code>hexo clean</code> 然后 <code>hexo g</code>，最后访问你的个人博客，就能看到效果了~</p>\n</li>\n</ol>\n<h4 id=\"修改文章内链接文本样式\"><a href=\"#修改文章内链接文本样式\" class=\"headerlink\" title=\"修改文章内链接文本样式\"></a>修改文章内链接文本样式</h4><p>修改文件 <code>themes\\next\\source\\css\\_common\\components\\post\\post.styl</code>，在末尾添加如下 <code>css</code> 样式：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 文章内链接文本样式</span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">p</span> <span class=\"selector-tag\">a</span>&#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#0593d3</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>: none;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#0593d3</span>;</span><br><span class=\"line\">  &amp;:hover &#123;</span><br><span class=\"line\">    <span class=\"selector-tag\">color</span>: <span class=\"selector-id\">#fc6423</span>;</span><br><span class=\"line\">    <span class=\"selector-tag\">border-bottom</span>: <span class=\"selector-tag\">none</span>;</span><br><span class=\"line\">    <span class=\"selector-tag\">border-bottom</span>: 1<span class=\"selector-tag\">px</span> <span class=\"selector-tag\">solid</span> <span class=\"selector-id\">#fc6423</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>其中选择 <code>.post-body</code> 是为了不影响标题，选择 <code>p</code> 是为了不影响首页 “阅读全文” 的显示样式，颜色可以自己定义。</p>\n<h4 id=\"修改文章底部的那个带-号的标签\"><a href=\"#修改文章底部的那个带-号的标签\" class=\"headerlink\" title=\"修改文章底部的那个带 # 号的标签\"></a>修改文章底部的那个带 # 号的标签</h4><p>修改模板 <code>/themes/next/layout/_macro/post.swig</code>，搜索 <code>rel=&quot;tag&quot;&gt;#</code>，将 <code>#</code> 换成 <code>&lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt;</code> 即可，你也可以在 <strong>Font Awesome</strong> 上寻找自己喜欢的图标。</p>\n<h4 id=\"在每篇文章末尾统一添加-“本文结束”-标记\"><a href=\"#在每篇文章末尾统一添加-“本文结束”-标记\" class=\"headerlink\" title=\"在每篇文章末尾统一添加 “本文结束” 标记\"></a>在每篇文章末尾统一添加 “本文结束” 标记</h4><p>在路径 <code>\\themes\\next\\layout\\_macro</code> 中新建 <code>passage-end-tag.swig</code> 文件,并添加以下内容：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    &#123;% if not is_index %&#125;</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"text-align:center;color: #ccc;font-size:14px;\"</span>&gt;</span>-------------本文结束<span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa fa-paw\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span>感谢您的阅读-------------<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    &#123;% endif %&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>接着打开 <code>\\themes\\next\\layout\\_macro\\post.swig</code> 文件，在 <code>END POST BODY</code> 之前添加如下画红色部分代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  &#123;% if not is_index %&#125;</span><br><span class=\"line\">    &#123;% include 'passage-end-tag.swig' %&#125;</span><br><span class=\"line\">  &#123;% endif %&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>就像这样：<br><img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/thanks.png\" alt=\"thanks.png\"></p>\n<p>然后打开 <span class=\"purple-target\">主题配置文件</span>，在末尾添加：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 文章末尾添加“本文结束”标记</span></span><br><span class=\"line\"><span class=\"attr\">passage_end_tag:</span></span><br><span class=\"line\">  <span class=\"attr\">enabled:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"修改-代码块自定义样式\"><a href=\"#修改-代码块自定义样式\" class=\"headerlink\" title=\"修改``代码块自定义样式\"></a>修改``代码块自定义样式</h4><p>打开 <code>\\themes\\next\\source\\css\\_custom\\custom.styl</code>，向里面加入如下代码：(颜色可以自己定义)</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Custom styles.</span><br><span class=\"line\"><span class=\"selector-tag\">code</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#ff7600</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#fbf7f8</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">2px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// 大代码块的自定义样式</span><br><span class=\"line\"><span class=\"selector-class\">.highlight</span>, <span class=\"selector-tag\">pre</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">5px</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">3px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.highlight</span>, <span class=\"selector-tag\">code</span>, <span class=\"selector-tag\">pre</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#d6d6d6</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"侧边栏社交小图标设置\"><a href=\"#侧边栏社交小图标设置\" class=\"headerlink\" title=\"侧边栏社交小图标设置\"></a>侧边栏社交小图标设置</h4><p>打开 <span class=\"purple-target\">主题配置文件</span>，搜索 <code>social_icons:</code>，在 <strong>Font Awesome</strong> 图标库找自己喜欢的小图标，并将名字复制在如下位置，保存即可。</p>\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/social-links.png\" alt=\"social-links.png\">\n\n<h4 id=\"主页文章添加阴影效果\"><a href=\"#主页文章添加阴影效果\" class=\"headerlink\" title=\"主页文章添加阴影效果\"></a>主页文章添加阴影效果</h4><p>打开 <code>\\themes\\next\\source\\css\\_custom\\custom.styl</code>，向里面加入如下代码：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 主页文章添加阴影效果</span><br><span class=\"line\"> <span class=\"selector-class\">.post</span> &#123;</span><br><span class=\"line\">   <span class=\"attribute\">margin-top</span>: <span class=\"number\">60px</span>;</span><br><span class=\"line\">   <span class=\"attribute\">margin-bottom</span>: <span class=\"number\">60px</span>;</span><br><span class=\"line\">   <span class=\"attribute\">padding</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">   <span class=\"attribute\">-webkit-box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">5px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">202</span>, <span class=\"number\">203</span>, <span class=\"number\">203</span>, .<span class=\"number\">5</span>);</span><br><span class=\"line\">   <span class=\"attribute\">-moz-box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">5px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">202</span>, <span class=\"number\">203</span>, <span class=\"number\">204</span>, .<span class=\"number\">5</span>);</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"设置网站的图标-Favicon\"><a href=\"#设置网站的图标-Favicon\" class=\"headerlink\" title=\"设置网站的图标 Favicon\"></a>设置网站的图标 Favicon</h4><p>你可以在 <a href=\"https://www.easyicon.net/\" target=\"_blank\" rel=\"noopener\">EasyIcon</a> 中找一张 <strong>（32*32）</strong> 的 <code>ico</code> 图标，或者去别的网站下载或者制作，并将图标名称改为 <code>favicon.ico</code>，然后把图标放在 <code>/themes/next/source/images</code> 里，并且修改 <span class=\"purple-target\">主题配置文件</span>：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Put your favicon.ico into `hexo-site/source/` directory.</span></span><br><span class=\"line\"><span class=\"attr\">favicon:</span> <span class=\"string\">/favicon.ico</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"在文章底部增加版权信息\"><a href=\"#在文章底部增加版权信息\" class=\"headerlink\" title=\"在文章底部增加版权信息\"></a>在文章底部增加版权信息</h4><p>在目录 <code>next/layout/_macro/</code> 下添加 <code>my-copyright.swig</code>：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% if page.copyright %&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"my_post_copyright\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- JS库 sweetalert 可修改路径 --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://unpkg.com/sweetalert/dist/sweetalert.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>本文标题:<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"&#123;&#123; url_for(page.path) &#125;&#125;\"</span>&gt;</span>&#123;&#123; page.title &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>文章作者:<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"/\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"访问 &#123;&#123; theme.author &#125;&#125; 的个人博客\"</span>&gt;</span>&#123;&#123; theme.author &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>发布时间:<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span>&#123;&#123; page.date.format(\"YYYY年MM月DD日 - HH:mm\") &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>最后更新:<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span>&#123;&#123; page.updated.format(\"YYYY年MM月DD日 - HH:mm\") &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>原始链接:<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"&#123;&#123; url_for(page.path) &#125;&#125;\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"&#123;&#123; page.title &#125;&#125;\"</span>&gt;</span>&#123;&#123; page.permalink &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"copy-path\"</span>  <span class=\"attr\">title</span>=<span class=\"string\">\"点击复制文章链接\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa fa-clipboard\"</span> <span class=\"attr\">data-clipboard-text</span>=<span class=\"string\">\"&#123;&#123; page.permalink &#125;&#125;\"</span>  <span class=\"attr\">aria-label</span>=<span class=\"string\">\"复制成功！\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>许可协议:<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa fa-creative-commons\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"license\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://creativecommons.org/licenses/by-nc-nd/4.0/\"</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)\"</span>&gt;</span>署名-非商业性使用-禁止演绎 4.0 国际<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span> 转载请保留原文链接及作者。<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span>  </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span> </span><br><span class=\"line\"><span class=\"actionscript\">    <span class=\"keyword\">var</span> clipboard = <span class=\"keyword\">new</span> Clipboard(<span class=\"string\">'.fa-clipboard'</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">    $(<span class=\"string\">\".fa-clipboard\"</span>).click(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">      clipboard.on(<span class=\"string\">'success'</span>, <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">()</span></span>&#123;</span></span><br><span class=\"line\">        swal(&#123;   </span><br><span class=\"line\"><span class=\"actionscript\">          title: <span class=\"string\">\"\"</span>,   </span></span><br><span class=\"line\"><span class=\"actionscript\">          text: <span class=\"string\">'复制成功'</span>,</span></span><br><span class=\"line\"><span class=\"actionscript\">          icon: <span class=\"string\">\"success\"</span>, </span></span><br><span class=\"line\"><span class=\"actionscript\">          showConfirmButton: <span class=\"literal\">true</span></span></span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">    &#125;);  </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>\n<p>在目录 <code>next/source/css/_common/components/post/</code> 下添加 <code>my-post-copyright.styl</code>：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">85%</span>;</span><br><span class=\"line\">  <span class=\"attribute\">max-width</span>: <span class=\"number\">45em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">2.8em</span> auto <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">0.5em</span> <span class=\"number\">1.0em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#d3d3d3</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">0.93rem</span>;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">1.6em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">word-break</span>: break-all;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">255</span>,<span class=\"number\">255</span>,<span class=\"number\">255</span>,<span class=\"number\">0.4</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-tag\">p</span>&#123;<span class=\"attribute\">margin</span>:<span class=\"number\">0</span>;&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-tag\">span</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: inline-block;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">5.2em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#b5b5b5</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-class\">.raw</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">margin-left</span>: <span class=\"number\">1em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">5em</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-tag\">a</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#808080</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>:<span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-tag\">a</span><span class=\"selector-pseudo\">:hover</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#a3d2a3</span>;</span><br><span class=\"line\">  <span class=\"attribute\">text-decoration</span>: underline;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span><span class=\"selector-pseudo\">:hover</span> <span class=\"selector-class\">.fa-clipboard</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#000</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-class\">.post-url</span><span class=\"selector-pseudo\">:hover</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: normal;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-class\">.copy-path</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">margin-left</span>: <span class=\"number\">1em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">1em</span>;</span><br><span class=\"line\">  +mobile()&#123;display:none;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-class\">.copy-path</span><span class=\"selector-pseudo\">:hover</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#808080</span>;</span><br><span class=\"line\">  <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>修改 <code>next/layout/_macro/post.swig</code>，在之前添加 <strong>底部阅读完毕</strong> 代码中，再添加如下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% include 'my-copyright.swig' %&#125;</span><br></pre></td></tr></table></figure>\n<p>如图所示：<br><img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/my-copyright.png\" alt=\"my-copyright.png\"><br>修改 <code>next/source/css/_common/components/post/post.styl</code> 文件，在最后一行增加代码：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">@import</span> <span class=\"string\">\"my-post-copyright\"</span></span><br></pre></td></tr></table></figure>\n<p>如果要在该博文下面增加版权信息的显示，需要在 <strong>Markdown</strong> 中增加 <code>copyright: true</code> 的设置，如图所示：</p>\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/show-copyright.png\" alt=\"show-copyright.png\">\n\n<h4 id=\"隐藏网页底部-powered-By-Hexo-强力驱动\"><a href=\"#隐藏网页底部-powered-By-Hexo-强力驱动\" class=\"headerlink\" title=\"隐藏网页底部 powered By Hexo / 强力驱动\"></a>隐藏网页底部 powered By Hexo / 强力驱动</h4><p>打开 <code>themes/next/layout/_partials/footer.swig</code>，隐藏之间的代码即可，或者直接删除。位置如图：<br><img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/hide-hexo.png\" alt=\"hide-hexo.png\"></p>\n<h4 id=\"添加-Live-2D-小宠物\"><a href=\"#添加-Live-2D-小宠物\" class=\"headerlink\" title=\"添加 Live 2D 小宠物\"></a><a name=\"live2d\" style=\"cursor: default; color: #fff; border-bottom: none; :hover {color: #fff; border-bottom: none;}\">添加 Live 2D 小宠物</a></h4><p>切换至 <code>Hexo</code> 根目录下，在终端中输入以下代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install -save hexo-helper-live2d</span><br></pre></td></tr></table></figure>\n\n<p>编辑 <span class=\"blue-target\">站点配置文件</span>：（具体配置见 <a href=\"https://github.com/EYHN/hexo-helper-live2d\" target=\"_blank\" rel=\"noopener\">官方文档</a>）</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">live2d:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">scriptFrom:</span> <span class=\"string\">local</span></span><br><span class=\"line\">  <span class=\"attr\">pluginRootPath:</span> <span class=\"string\">live2dw/</span></span><br><span class=\"line\">  <span class=\"attr\">pluginJsPath:</span> <span class=\"string\">lib/</span></span><br><span class=\"line\">  <span class=\"attr\">pluginModelPath:</span> <span class=\"string\">assets/</span></span><br><span class=\"line\">  <span class=\"attr\">model:</span></span><br><span class=\"line\">    <span class=\"attr\">use:</span> <span class=\"string\">live2d-widget-model-wanko</span></span><br><span class=\"line\">  <span class=\"attr\">display:</span></span><br><span class=\"line\">    <span class=\"attr\">position:</span> <span class=\"string\">right</span></span><br><span class=\"line\">    <span class=\"attr\">width:</span> <span class=\"number\">150</span></span><br><span class=\"line\">    <span class=\"attr\">height:</span> <span class=\"number\">300</span></span><br><span class=\"line\">  <span class=\"attr\">mobile:</span></span><br><span class=\"line\">    <span class=\"attr\">show:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<p>我的 <a href=\"https://www.wqh4u.cn/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/\">这一篇博客</a> 中写了一些关于 <span class=\"blue-target\">Live 2D</span> 的一些进阶设置，感兴趣的看官可以参考一下。</p>\n<blockquote>\n<p>完~</p>\n</blockquote>\n<h2 id=\"参考文献\"><a href=\"#参考文献\" class=\"headerlink\" title=\"参考文献\"></a>参考文献</h2><ol>\n<li><a href=\"https://hexo.io/zh-cn/docs/\" target=\"_blank\" rel=\"noopener\">文档 | Hexo</a></li>\n<li><a href=\"https://hexo.io/themes/\" target=\"_blank\" rel=\"noopener\">Themes | Hexo</a></li>\n<li><a href=\"http://theme-next.iissnan.com/getting-started.html\" target=\"_blank\" rel=\"noopener\">开始使用 - NexT 使用文档</a></li>\n<li><a href=\"https://www.cnblogs.com/trista222/p/8017300.html\" target=\"_blank\" rel=\"noopener\">结合hexo在GitHub上搭建个人博客——全过程</a></li>\n<li><a href=\"https://blog.csdn.net/coding01/article/details/80083033\" target=\"_blank\" rel=\"noopener\">阿里云CentOS下Hexo+Nginx建站过程 - 来吧，和鹿丸君一起打豆豆</a></li>\n<li><a href=\"http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html\" target=\"_blank\" rel=\"noopener\">hexo的next主题个性化教程:打造炫酷网站</a></li>\n</ol>\n","site":{"data":{}},"length":13948,"excerpt":"<style type=\"text/css\">\n.quotetitle {\n    color: #337ab7;\n    font-weight: 700;\n}\n\n.redspan {\n    color: #ff0000;\n}\n\n.italic {\n    font-style: italic;\n}\n\n</style>\n\n<blockquote>\n<p><span class=\"introduction\">不先经历风雨，怎能见彩虹？</span><br><br>在经历了无数次失败后，终于将我的 <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a> 配置到了自己能看得过去的样子。<br>特此写下 Blog 为更多想了解 Hexo 的人阅读使用。</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"环境搭建\"><a href=\"#环境搭建\" class=\"headerlink\" title=\"环境搭建\"></a>环境搭建</h2><h3 id=\"本人环境配置：\"><a href=\"#本人环境配置：\" class=\"headerlink\" title=\"本人环境配置：\"></a>本人环境配置：</h3><ul>\n<li>服务器：腾讯云学生机，<code>Ubuntu 18.04.1 LTS (GNU/Linux 4.15.0-29-generic x86_64)</code></li>\n<li>Node.js：在 Hexo 的<a href=\"https://hexo.io/zh-cn/docs/\" target=\"_blank\" rel=\"noopener\">官方文档</a>里面有说，<code>Node.js</code> 的版本不得低于 <code>6.9</code>，这里提供两种安装 <code>Node.js</code> 的方式：</li>\n</ul>\n<p>cURL：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ curl https://raw.github.com/creationix/nvm/v0.33.11/install.sh | sh</span><br></pre></td></tr></table></figure>\n<p>Wget：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ wget -qO- https://raw.github.com/creationix/nvm/v0.33.11/install.sh | sh</span><br></pre></td></tr></table></figure>\n<p>安装完成后，重启终端并执行下列命令即可安装 Node.js。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ nvm install stable</span><br></pre></td></tr></table></figure>\n<p>或者可以在 <code>Node.js</code> 的官网上<a href=\"https://nodejs.org/en/\" target=\"_blank\" rel=\"noopener\">下载安装</a>。</p>\n<blockquote>\n<p><span class=\"quotetitle\">Windows用户</span><br><br>对于 windows 用户来说，建议使用安装程序进行安装。安装时，请勾选 Add to PATH 选项。<br>另外，您也可以使用 Git Bash，这是 git for windows 自带的一组程序，提供了 Linux 风格的 shell，在该环境下，您可以直接用上面提到的命令来安装 Node.js。打开它的方法很简单，在任意位置单击右键，选择 “Git Bash Here” 即可。由于 Hexo 的很多操作都涉及到命令行，您可以考虑始终使用 Git Bash 来进行操作。</p>\n</blockquote>\n<ul>\n<li>Git：我的 <code>Git</code> 版本为 <em><code>git version 2.17.1</code></em> </li>\n</ul>\n<p>这里使用 <code>Ubuntu</code> 或 <code>Debian</code> 系的：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo apt-get install git-core</span><br></pre></td></tr></table></figure>\n<p>或者使用 <code>Fedora</code>、<code>红帽</code>或者 <code>CentOS</code>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo yum install git-core</span><br></pre></td></tr></table></figure>\n<p>像 <code>Arch Linux</code> 等其他发行版请自行善用包管理器进行安装。</p>\n<blockquote>\n<p><span class=\"quotetitle\">Windows用户</span><br><br>由于<del>众所周知</del>的原因，从上面的链接下载 git for windows 最好挂上一个代理，否则下载速度十分缓慢。也可以参考<a href=\"https://github.com/waylau/git-for-win\" target=\"_blank\" rel=\"noopener\">这里</a>，收录了存储于百度云的下载地址。</p>\n</blockquote>\n<h3 id=\"开始安装\"><a href=\"#开始安装\" class=\"headerlink\" title=\"开始安装\"></a>开始安装</h3><p>现在我们开始安装 <code>Hexo</code>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure>\n<p>如果发现下载奇慢，那么请首先更换你的 npm 源：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm config <span class=\"built_in\">set</span> registry https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"开始使用\"><a href=\"#开始使用\" class=\"headerlink\" title=\"开始使用\"></a>开始使用</h2><h3 id=\"初始化-Hexo\"><a href=\"#初始化-Hexo\" class=\"headerlink\" title=\"初始化 Hexo\"></a>初始化 Hexo</h3><p>安装 <code>Hexo</code> 完成后，请执行下列命令，<code>Hexo</code> 将会在指定文件夹中新建所需要的文件。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo init &lt;folder&gt;</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> &lt;folder&gt;</span><br></pre></td></tr></table></figure>\n<p>其中，<strong><code>&lt;folder&gt;</code></strong> 就是你要在哪个路径下安装 <code>Hexo</code>，比如 <code>/home/ubuntu/hexo/</code>。<br>新建完成后，指定文件夹的目录如下：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">├── _config.yml</span><br><span class=\"line\">├── package.json</span><br><span class=\"line\">├── scaffolds</span><br><span class=\"line\">├── <span class=\"built_in\">source</span></span><br><span class=\"line\">|   ├── _drafts</span><br><span class=\"line\">|   └── _posts</span><br><span class=\"line\">└── themes</span><br></pre></td></tr></table></figure>\n<p>详细说明如下：</p>\n<blockquote>\n<ol>\n<li><code>_config.yml</code> 是 YAML 格式文件，也是 Hexo 的站点 <strong>重要配置文件</strong> ，以后很多的自定义配置都要修改这个文件。</li>\n<li>package.json 配置 Hexo 运行需要的 Node.js 包，不用手动更改。</li>\n<li>scaffolds 是模板文件夹。这个“模板”就是指新建的 markdown 文件的模板，每新建一个 markdown 文件（由于 Hexo 使用 markdown 语法，在渲染生成静态 HTML 页面之前，源文件都是 markdown 文件），就会包含对应模板的内容。<br>该文件夹内有三个模板： </li>\n</ol>\n<ul>\n<li>draft.md — 草稿的模板 </li>\n<li>page.md — 页面的模板 </li>\n<li>post.md — 文章的模板</li>\n</ul>\n<ol start=\"4\">\n<li>source 是资源文件夹，资源文件夹是存放用户资源的地方。除 posts 文件夹之外，开头命名为 (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 public 文件夹，而其他文件会被拷贝过去。 </li>\n<li>themes 是主题文件夹。Hexo 会根据主题来生成静态页面。</li>\n</ol>\n</blockquote>\n<h3 id=\"初次运行Hexo\"><a href=\"#初次运行Hexo\" class=\"headerlink\" title=\"初次运行Hexo\"></a>初次运行Hexo</h3><p>输入 <span class=\"redspan italic\">hexo generate</span> 命令来生成静态文件。</p>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>1：生成的静态文件存放在 public 文件夹中<br><br>2：此命令可简写为 <em><code>hexo g</code></em></p>\n</blockquote>\n<p>然后输入 <span class=\"redspan italic\">hexo server</span> (可简写为 <em><code>hexo s</code></em>)来启动服务器。</p>\n<p>默认情况下，端口号为 4000，所以服务器启动成功后，在浏览器中输入 <code>http://&lt;你的IP地址&gt;:4000</code> ，即可看到第一次运行的状况。</p>\n<p>和 Django 一样，按 <em><code>Ctrl + c</code></em> 结束服务。</p>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>如果运行时没有报任何错误，但是浏览器中显示网页无法访问，可能是你的服务器安全组没有配置，像腾讯云或者阿里云都需要配置端口安全组策略，请先去设置 4000 端口开放形式，再运行 Hexo 服务。</p>\n</blockquote>\n<hr>\n\n<h2 id=\"安装并配置Nginx\"><a href=\"#安装并配置Nginx\" class=\"headerlink\" title=\"安装并配置Nginx\"></a>安装并配置Nginx</h2><p>安装 <code>Nginx</code> 主要是想让网站能随时随地访问，不像上文中 Hexo 提供的 server，只能手动输入命令后才能访问到网站。</p>\n<h3 id=\"安装Nginx\"><a href=\"#安装Nginx\" class=\"headerlink\" title=\"安装Nginx\"></a>安装Nginx</h3><p>在 <code>Ubuntu</code> 上安装 <code>Nginx</code> 方法很简单：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo apt install nginx</span><br></pre></td></tr></table></figure>\n<h4 id=\"配置防火墙\"><a href=\"#配置防火墙\" class=\"headerlink\" title=\"配置防火墙\"></a>配置防火墙</h4><p>如果您正在运行防火墙，则还需要打开端口 <code>80</code> 和 <code>443</code>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo ufw allow <span class=\"string\">'Nginx Full'</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"启动Nginx服务\"><a href=\"#启动Nginx服务\" class=\"headerlink\" title=\"启动Nginx服务\"></a>启动Nginx服务</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ sudo systemctl start nginx</span><br></pre></td></tr></table></figure>\n<p>此时，用浏览器访问 <code>http://&lt;你的IP地址&gt;</code> 便可以看到 <code>Nginx</code> 的测试页面，即表示 <code>Nginx</code> 启动成功！</p>\n<p>继续输入以下命令使 <code>Nginx</code> 开机自动启动：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ systemctl <span class=\"built_in\">enable</span> nginx</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"配置静态服务器访问路径\"><a href=\"#配置静态服务器访问路径\" class=\"headerlink\" title=\"配置静态服务器访问路径\"></a>配置静态服务器访问路径</h2><p><code>Nginx</code> 需要配置静态资源的路径信息才能通过 <code>url</code> 正确访问到服务器上的静态资源。 <br><br>即是要将 <code>Hexo</code> 生成的静态资源的路径放置到 <code>Nginx</code> 的访问路径</p>\n<p>打开 <code>Nginx</code> 的默认配置文件 <code>/etc/nginx/nginx.conf</code> ，将默认的 <code>root /usr/share/nginx/html</code> 修改为： <code>root /…/&lt;folder&gt;/public</code>，里面的 <code>&lt;folder&gt;</code> 就是你刚刚Hexo安装的文件夹。</p>\n<p>修改完成后保存，输入以下命令重启 <code>Nginx</code>：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ nginx -s reload</span><br></pre></td></tr></table></figure>\n<p>此时再次访问你的 IP 地址，若显示上文的 <code>Hexo</code> 初次运行的样子，则说明配置成功。</p>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>可能会报 403 错误，原因是 Nginx 没有权限访问 public文件夹，修改方法有两种： <br><br>1：修改 public 文件夹的权限，修改为 777（即任何人可读可写可执行），不推荐； <br><br>2：修改 nginx.conf 中的 user（可能在第5行），改为可以访问 public文件夹的用户，如 root。</p>\n</blockquote>\n<h2 id=\"配置Hexo\"><a href=\"#配置Hexo\" class=\"headerlink\" title=\"配置Hexo\"></a>配置Hexo</h2><h3 id=\"站点配置\"><a href=\"#站点配置\" class=\"headerlink\" title=\"站点配置\"></a>站点配置</h3><p>配置 Hexo 时，需要修改上文提到的根目录下的 <code>_config.yml</code> 文件，主要修改的就是这部分：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Site</span></span><br><span class=\"line\"><span class=\"attr\">title:</span> <span class=\"string\">Euphoria</span> <span class=\"string\">Blog</span>      <span class=\"comment\"># 网站标题</span></span><br><span class=\"line\"><span class=\"attr\">subtitle:</span>                 <span class=\"comment\"># 网站副标题</span></span><br><span class=\"line\"><span class=\"attr\">description:</span>              <span class=\"comment\"># 网站描述，可以是你喜欢的一句话 :)</span></span><br><span class=\"line\"><span class=\"attr\">keywords:</span> <span class=\"string\">Euphoria</span>        <span class=\"comment\"># 网站关键词  </span></span><br><span class=\"line\"><span class=\"attr\">author:</span> <span class=\"string\">Euphoria</span>          <span class=\"comment\"># 你的名字</span></span><br><span class=\"line\"><span class=\"attr\">language:</span> <span class=\"string\">zh-CN</span>           <span class=\"comment\"># 网站使用的语言</span></span><br><span class=\"line\"><span class=\"attr\">timezone:</span>                 <span class=\"comment\"># 网站时区，默认使用服务器的时区</span></span><br></pre></td></tr></table></figure>\n<p>其余的文件内容可以使用默认值，萌新可不必修改，具体参见<a href=\"https://hexo.io/zh-cn/docs/configuration.html\" target=\"_blank\" rel=\"noopener\">官方文档</a>。</p>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>修改yml文件时应注意“:”后面应加空格。</p>\n</blockquote>\n<h2 id=\"配置主题\"><a href=\"#配置主题\" class=\"headerlink\" title=\"配置主题\"></a>配置主题</h2><p>Hexo 安装主题的方式非常简单，只需要将主题文件拷贝至站点目录的 <code>themes</code> 目录下，你可以在<a href=\"https://hexo.io/themes/\" target=\"_blank\" rel=\"noopener\">这里</a>寻找你喜欢的主题，然后修改下配置文件即可。</p>\n<p>在 Hexo 中有两份主要的配置文件，其名称都是 <code>_config.yml</code>。 其中，一份位于站点根目录下，主要包含 Hexo 本身的配置；另一份位于主题目录下，这份配置由主题作者提供，主要用于配置主题相关的选项。</p>\n<p>为了描述方便，在以下说明中，将前者称为 <span class=\"blue-target\">站点配置文件</span>， 后者称为 <span class=\"purple-target\">主题配置文件</span>。</p>\n<p>这里我强烈推荐 <code>NexT</code> 这款主题，接下来为安装及其配置方法：</p>\n<h3 id=\"安装-NexT\"><a href=\"#安装-NexT\" class=\"headerlink\" title=\"安装 NexT\"></a>安装 NexT</h3><p>如果你熟悉 Git，建议你使用 <code>克隆最新版本</code> 的方式，之后的更新可以通过 <code>git pull</code> 来快速更新， 而不用再次下载压缩包替换。</p>\n<p>在终端窗口下，定位到 Hexo 站点目录下。使用 <code>Git checkout</code> 代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> your-hexo-site</span><br><span class=\"line\">$ git <span class=\"built_in\">clone</span> https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"启用主题\"><a href=\"#启用主题\" class=\"headerlink\" title=\"启用主题\"></a>启用主题</h3><p>与所有 <code>Hexo</code> 主题启用的模式一样。 当 <code>克隆/下载</code> 完成后，打开 <span class=\"blue-target\">站点配置文件</span>， 找到 <code>theme</code> 字段，并将其值更改为 <code>next</code>。</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">theme:</span> <span class=\"string\">next</span></span><br></pre></td></tr></table></figure>\n<p>到此，NexT 主题安装完成。下一步我们将验证主题是否正确启用。在切换主题之后、验证之前， 我们最好使用 <code>hexo clean</code> 来清除 Hexo 的缓存。</p>\n<h3 id=\"个性化主题\"><a href=\"#个性化主题\" class=\"headerlink\" title=\"个性化主题\"></a>个性化主题</h3><h4 id=\"选择-Scheme\"><a href=\"#选择-Scheme\" class=\"headerlink\" title=\"选择 Scheme\"></a>选择 Scheme</h4><p>Scheme 是 NexT 提供的一种特性，借助于 Scheme，NexT 为你提供多种不同的外观。同时，几乎所有的配置都可以 在 Scheme 之间共用。目前 NexT 支持三种 Scheme，他们是：</p>\n<ul>\n<li>Muse - 默认 Scheme，这是 NexT 最初的版本，黑白主调，大量留白</li>\n<li>Mist - Muse 的紧凑版本，整洁有序的单栏外观</li>\n<li>Pisces - 双栏 Scheme，小家碧玉似的清新</li>\n</ul>\n<p>Scheme 的切换通过更改 <span class=\"purple-target\">主题配置文件</span>，搜索 scheme 关键字。 你会看到有三行 scheme 的配置，将你需用启用的 scheme 前面注释 # 去除即可。</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># scheme: Muse</span></span><br><span class=\"line\"><span class=\"attr\">scheme:</span> <span class=\"string\">Mist</span></span><br><span class=\"line\"><span class=\"comment\"># scheme: Pisces</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"设置语言\"><a href=\"#设置语言\" class=\"headerlink\" title=\"设置语言\"></a>设置语言</h4><p>编辑 <span class=\"blue-target\">站点配置文件</span>， 将 <code>language</code> 设置成你所需要的语言。建议明确设置你所需要的语言，例如选用简体中文，配置如下：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">language:</span> <span class=\"string\">zh-Hans</span></span><br></pre></td></tr></table></figure>\n<p>目前 NexT 支持的语言如以下表格所示：</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">语言</th>\n<th align=\"left\">代码</th>\n<th align=\"left\">设定示例</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">English</td>\n<td align=\"left\">en</td>\n<td align=\"left\">language: en</td>\n</tr>\n<tr>\n<td align=\"left\">简体中文</td>\n<td align=\"left\">zh-Hans</td>\n<td align=\"left\">language: zh-Hans</td>\n</tr>\n<tr>\n<td align=\"left\">Français</td>\n<td align=\"left\">fr-FR</td>\n<td align=\"left\">language: fr-FR</td>\n</tr>\n<tr>\n<td align=\"left\">Português</td>\n<td align=\"left\">pt</td>\n<td align=\"left\">language: pt or language: pt-BR</td>\n</tr>\n<tr>\n<td align=\"left\">繁體中文</td>\n<td align=\"left\">zh-hk 或者 zh-tw</td>\n<td align=\"left\">language: zh-hk</td>\n</tr>\n<tr>\n<td align=\"left\">Русский язык</td>\n<td align=\"left\">ru</td>\n<td align=\"left\">language: ru</td>\n</tr>\n<tr>\n<td align=\"left\">Deutsch</td>\n<td align=\"left\">de</td>\n<td align=\"left\">language: de</td>\n</tr>\n<tr>\n<td align=\"left\">日本語</td>\n<td align=\"left\">ja</td>\n<td align=\"left\">language: ja</td>\n</tr>\n<tr>\n<td align=\"left\">Indonesian</td>\n<td align=\"left\">id</td>\n<td align=\"left\">language: id</td>\n</tr>\n<tr>\n<td align=\"left\">Korean</td>\n<td align=\"left\">ko</td>\n<td align=\"left\">language: ko</td>\n</tr>\n</tbody></table>\n<h4 id=\"设置菜单\"><a href=\"#设置菜单\" class=\"headerlink\" title=\"设置菜单\"></a>设置菜单</h4><p>菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是 <a href=\"https://fontawesome.com/?from=io\" target=\"_blank\" rel=\"noopener\">Font Awesome</a> 提供的图标， Font Awesome 提供了 600+ 的图标，可以满足绝大的多数的场景，同时无须担心在 Retina 屏幕下 图标模糊的问题。</p>\n<p>编辑 <span class=\"purple-target\">主题配置文件</span>，修改以下内容：</p>\n<ol>\n<li><p>设定菜单内容，对应的字段是 <code>menu</code>。 菜单内容的设置格式是：<code>item name: link</code>。其中 <code>item name</code> 是一个名称，这个名称并不直接显示在页面上，她将用于匹配图标以及翻译。</p>\n <figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">menu:</span></span><br><span class=\"line\"> <span class=\"attr\">home:</span> <span class=\"string\">/</span></span><br><span class=\"line\"> <span class=\"attr\">archives:</span> <span class=\"string\">/archives</span></span><br><span class=\"line\"> <span class=\"comment\">#about: /about</span></span><br><span class=\"line\"> <span class=\"comment\">#categories: /categories</span></span><br><span class=\"line\"> <span class=\"attr\">tags:</span> <span class=\"string\">/tags</span></span><br><span class=\"line\"> <span class=\"comment\">#commonweal: /404.html</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br> 若你的站点运行在子目录中，请将链接前缀的 / 去掉！</p>\n</blockquote>\n<p> NexT 默认的菜单项有（标注 * 的项表示需要手动创建这个页面）：</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">键值</th>\n<th align=\"left\">设定值</th>\n<th align=\"left\">显示文本（简体中文）</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">home</td>\n<td align=\"left\">home: /</td>\n<td align=\"left\">主页</td>\n</tr>\n<tr>\n<td align=\"left\">archives</td>\n<td align=\"left\">archives: /archives</td>\n<td align=\"left\">归档页</td>\n</tr>\n<tr>\n<td align=\"left\">categories</td>\n<td align=\"left\">categories: /categories</td>\n<td align=\"left\">分类页</td>\n</tr>\n<tr>\n<td align=\"left\">tags</td>\n<td align=\"left\">tags: /tags</td>\n<td align=\"left\">标签页</td>\n</tr>\n<tr>\n<td align=\"left\">about</td>\n<td align=\"left\">about: /about</td>\n<td align=\"left\">关于页面</td>\n</tr>\n<tr>\n<td align=\"left\">commonweal</td>\n<td align=\"left\">commonweal: /404.html</td>\n<td align=\"left\">公益 404</td>\n</tr>\n</tbody></table>\n</li>\n<li><p>设置菜单项的显示文本。在第一步中设置的菜单的名称并不直接用于界面上的展示。Hexo 在生成的时候将使用 这个名称查找对应的语言翻译，并提取显示文本。这些翻译文本放置在 NexT 主题目录下的 <code>languages/{language}.yml</code> （{language} 为你所使用的语言）。</p>\n<p> 以简体中文为例，若你需要添加一个菜单项，比如 <code>something</code>。那么就需要修改简体中文对应的翻译文件 <code>languages/zh-Hans.yml</code>，在 <code>menu</code> 字段下添加一项：</p>\n <figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">menu:</span></span><br><span class=\"line\">  <span class=\"attr\">home:</span> <span class=\"string\">首页</span></span><br><span class=\"line\">  <span class=\"attr\">archives:</span> <span class=\"string\">归档</span></span><br><span class=\"line\">  <span class=\"attr\">categories:</span> <span class=\"string\">分类</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span> <span class=\"string\">标签</span></span><br><span class=\"line\">  <span class=\"attr\">about:</span> <span class=\"string\">关于</span></span><br><span class=\"line\">  <span class=\"attr\">search:</span> <span class=\"string\">搜索</span></span><br><span class=\"line\">  <span class=\"attr\">commonweal:</span> <span class=\"string\">公益404</span></span><br><span class=\"line\">  <span class=\"attr\">something:</span> <span class=\"string\">有料</span></span><br></pre></td></tr></table></figure></li>\n<li><p>设定菜单项的图标，对应的字段是 <code>menu_icons</code>。 此设定格式是 <code>item name: icon name</code>，其中 <code>item name</code> 与上一步所配置的菜单名字对应，<code>icon name</code> 是 <strong>Font Awesome</strong> 图标的 <strong>名字</strong>。而 <code>enable</code> 可用于控制是否显示图标，你可以设置成 <code>false</code> 来去掉图标。</p>\n <figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">menu_icons:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\"># Icon Mapping.</span></span><br><span class=\"line\">  <span class=\"attr\">home:</span> <span class=\"string\">home</span></span><br><span class=\"line\">  <span class=\"attr\">about:</span> <span class=\"string\">user</span></span><br><span class=\"line\">  <span class=\"attr\">categories:</span> <span class=\"string\">th</span></span><br><span class=\"line\">  <span class=\"attr\">tags:</span> <span class=\"string\">tags</span></span><br><span class=\"line\">  <span class=\"attr\">archives:</span> <span class=\"string\">archive</span></span><br><span class=\"line\">  <span class=\"attr\">commonweal:</span> <span class=\"string\">heartbeat</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br> 1: 在菜单图标开启的情况下，如果菜单项与菜单未匹配（没有设置或者无效的 <strong>Font Awesome</strong> 图标名字） 的情况下，NexT 将会使用 <strong>?</strong> 作为图标。<br><br> 2: 请注意键值（如 <code>home</code>）的大小写要严格匹配。</p>\n</blockquote>\n</li>\n</ol>\n<h4 id=\"设置侧栏\"><a href=\"#设置侧栏\" class=\"headerlink\" title=\"设置侧栏\"></a>设置侧栏</h4><p>默认情况下，侧栏仅在文章页面（拥有目录列表）时才显示，并放置于右侧位置。 可以通过修改 <span class=\"purple-target\">主题配置文件</span> 中的 <code>sidebar</code> 字段来控制侧栏的行为。侧栏的设置包括两个部分，其一是侧栏的位置， 其二是侧栏显示的时机。</p>\n<ol>\n<li>设置侧栏的位置，修改 <code>sidebar.position</code> 的值，支持的选项有：<ul>\n<li>left - 靠左放置</li>\n<li>right - 靠右放置<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>目前仅 Pisces Scheme 支持 position 配置。影响版本 <span class=\"red-target\">5.0.0</span> 及更低版本。</p>\n</blockquote>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">sidebar:</span></span><br><span class=\"line\">  <span class=\"attr\">position:</span> <span class=\"string\">left</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n<li>设置侧栏显示的时机，修改 sidebar.display 的值，支持的选项有：<ul>\n<li>post - 默认行为，在文章页面（拥有目录列表）时显示</li>\n<li>always - 在所有页面中都显示</li>\n<li>hide - 在所有页面中都隐藏（可以手动展开）</li>\n<li>remove - 完全移除<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">sidebar:</span></span><br><span class=\"line\">  <span class=\"attr\">display:</span> <span class=\"string\">post</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>已知侧栏在 use motion: false 的情况下不会展示。影响版本 <span class=\"red-target\">5.0.0</span> 及更低版本。</p>\n</blockquote>\n</li>\n</ul>\n</li>\n</ol>\n<h4 id=\"设置头像\"><a href=\"#设置头像\" class=\"headerlink\" title=\"设置头像\"></a>设置头像</h4><p>编辑 <span class=\"purple-target\">主题配置文件</span>， 修改字段 <code>avatar</code>， 值设置成头像的链接地址。其中，头像的链接地址可以是：</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">地址</th>\n<th align=\"left\">值</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">完整的互联网 URI</td>\n<td align=\"left\"><a href=\"http://example.com/avatar.png\" target=\"_blank\" rel=\"noopener\">http://example.com/avatar.png</a></td>\n</tr>\n<tr>\n<td align=\"left\">站点内的地址</td>\n<td align=\"left\">将头像放置主题目录下的 source/uploads/ （新建 uploads 目录若不存在）<br>配置为：avatar: /uploads/avatar.png<br>或者 放置在 source/images/ 目录下<br>配置为：avatar: /images/avatar.png</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">avatar:</span> <span class=\"string\">http://example.com/avatar.png</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"设置代码高亮主题\"><a href=\"#设置代码高亮主题\" class=\"headerlink\" title=\"设置代码高亮主题\"></a>设置代码高亮主题</h4><p>NexT 使用 <a href=\"https://github.com/chriskempson/tomorrow-theme\" target=\"_blank\" rel=\"noopener\">Tomorrow Theme</a> 作为代码高亮，共有5款主题供你选择。 NexT 默认使用的是白色的 <code>normal</code> 主题，可选的值有 <code>normal</code>，<code>night</code>， <code>night blue</code>， <code>night bright</code>， <code>night eighties</code>：</p>\n<div>\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/tomorrow.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow.png\">\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/tomorrow-night.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night.png\">\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/tomorrow-night-blue.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night-blue.png\">\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/tomorrow-night-bright.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night-bright.png\">\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/tomorrow-night-eighties.png\" style=\"width: 19%; display: inline-block; float: left\" alt=\"tomorrow-night-eighties.png\">\n</div>\n<div style=\"clear: both;\"></div>\n更改 <span class=\"purple-target\">主题配置文件</span> 中 `highlight_theme` 字段，将其值设定成你所喜爱的高亮主题，例如：\n\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Code Highlight theme</span></span><br><span class=\"line\"><span class=\"comment\"># Available value: normal | night | night eighties | night blue | night bright</span></span><br><span class=\"line\"><span class=\"comment\"># https://github.com/chriskempson/tomorrow-theme</span></span><br><span class=\"line\"><span class=\"attr\">highlight_theme:</span> <span class=\"string\">normal</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"侧边栏社交链接\"><a href=\"#侧边栏社交链接\" class=\"headerlink\" title=\"侧边栏社交链接\"></a>侧边栏社交链接</h4><p>侧栏社交链接的修改包含两个部分，第一是链接，第二是链接图标。 两者配置均在 <span class=\"purple-target\">主题配置文件</span> 中。</p>\n<ol>\n<li>链接放置在 <code>social</code> 字段下，一行一个链接。其键值格式是 <code>显示文本: 链接地址</code>。 <figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Social links</span></span><br><span class=\"line\"><span class=\"attr\">social:</span></span><br><span class=\"line\">  <span class=\"attr\">GitHub:</span> <span class=\"string\">https://github.com/your-user-name</span></span><br><span class=\"line\">  <span class=\"attr\">Twitter:</span> <span class=\"string\">https://twitter.com/your-user-name</span></span><br><span class=\"line\">  <span class=\"string\">微博:</span> <span class=\"string\">http://weibo.com/your-user-name</span></span><br><span class=\"line\">  <span class=\"string\">豆瓣:</span> <span class=\"string\">http://douban.com/people/your-user-name</span></span><br><span class=\"line\">  <span class=\"string\">知乎:</span> <span class=\"string\">http://www.zhihu.com/people/your-user-name</span></span><br><span class=\"line\">  <span class=\"comment\"># 等等...</span></span><br></pre></td></tr></table></figure></li>\n<li>设定链接的图标，对应的字段是 <code>social_icons</code>。其键值格式是 匹配键: <strong>Font Awesome</strong> 图标名称， 匹配键 与上一步所配置的链接的 显示文本 相同（大小写严格匹配），图标名称 是 <strong>Font Awesome</strong> 图标的名字（不必带 fa- 前缀）。 <code>enable</code> 选项用于控制是否显示图标，你可以设置成 <code>false</code> 来去掉图标。 <figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Social Icons</span></span><br><span class=\"line\"><span class=\"attr\">social_icons:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"comment\"># Icon Mappings</span></span><br><span class=\"line\">  <span class=\"attr\">GitHub:</span> <span class=\"string\">github</span></span><br><span class=\"line\">  <span class=\"attr\">Twitter:</span> <span class=\"string\">twitter</span></span><br><span class=\"line\">  <span class=\"string\">微博:</span> <span class=\"string\">weibo</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h4 id=\"开启打赏功能-由-habren-贡献\"><a href=\"#开启打赏功能-由-habren-贡献\" class=\"headerlink\" title=\"开启打赏功能 由 habren 贡献\"></a>开启打赏功能 <sub>由 <a href=\"https://github.com/iissnan/hexo-theme-next/pull/687\" target=\"_blank\" rel=\"noopener\">habren</a> 贡献</sub></h4><p>越来越多的平台（微信公众平台，新浪微博，简书，百度打赏等）支持打赏功能，付费阅读时代越来越近，特此增加了打赏功能，支持微信打赏和支付宝打赏。 只需要 <span class=\"purple-target\">主题配置文件</span> 中填入 <code>微信</code> 和 <code>支付宝</code> 收款二维码图片地址，即可开启该功能。</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">reward_comment:</span> <span class=\"string\">坚持原创技术分享，您的支持将鼓励我继续创作！</span></span><br><span class=\"line\"><span class=\"attr\">wechatpay:</span> <span class=\"string\">/path/to/wechat-reward-image</span></span><br><span class=\"line\"><span class=\"attr\">alipay:</span> <span class=\"string\">/path/to/alipay-reward-image</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"站点建立时间\"><a href=\"#站点建立时间\" class=\"headerlink\" title=\"站点建立时间\"></a>站点建立时间</h4><p>这个时间将在站点的底部显示，例如 © 2013 - 2015。 编辑 <span class=\"purple-target\">主题配置文件</span>，新增字段 <code>since</code>。</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">since:</span> <span class=\"number\">2013</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"实现-fork-me-on-github\"><a href=\"#实现-fork-me-on-github\" class=\"headerlink\" title=\"实现 fork me on github\"></a>实现 fork me on github</h4><p>点击 <a href=\"https://github.com/blog/273-github-ribbons\" target=\"_blank\" rel=\"noopener\">这里</a> 或者 <a href=\"http://tholman.com/github-corners/\" target=\"_blank\" rel=\"noopener\">这里</a> 挑选自己喜欢的样式，并复制旁边的对应代码。</p>\n<p>然后粘贴刚才复制的代码到 <code>themes/next/layout/_layout.swig</code> 文件中(放在 <code>&lt;div class=&quot;headband&quot;&gt;&lt;/div&gt;</code> 的下面)，并把 <code>href</code> 改为你的 <code>github</code> 地址，比如 <code>https://github.com/euphoriachn</code>。</p>\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/fork-on-github.png\" alt=\"fork-on-github.png\">\n\n<h4 id=\"添加动态背景\"><a href=\"#添加动态背景\" class=\"headerlink\" title=\"添加动态背景\"></a>添加动态背景</h4><blockquote>\n<p><span class=\"quotetitle\">注意！</span><br><br>如果 <code>NexT</code> 主题在 <span class=\"red-target\">5.1.1</span> 以上的话就不用我这样设置，直接在主题配置文件中找到 <code>canvas_nest: false</code>，把它改为 <code>canvas_nest: true</code> 就行了（注意分号后面要加一个空格）。如果发现这样并不行 <del>（像我一样）</del>，或者版本低于 <code>5.1.1</code> 的话，请按照如下操作进行。</p>\n</blockquote>\n<ol>\n<li><p>修改 <code>_layout.swig</code></p>\n<p> 打开 <code>next/layout/_layout.swig</code><br> 在 <code>&lt;/body&gt;</code> 之前添加代码（注意不要放在 <code>&lt;/body&gt;</code> 的后面）</p>\n <figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;# TODO: Euphoria #&#125;</span><br><span class=\"line\">&#123;% if theme.canvas_nest %&#125;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>修改配置文件<br> 打开 <code>/next/_config.yml</code>，在里面添加如下代码：(可以放在最后面)</p>\n <figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># --------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># background settings</span></span><br><span class=\"line\"><span class=\"comment\"># --------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># add canvas-nest effect</span></span><br><span class=\"line\"><span class=\"comment\"># see detail from https://github.com/hustcc/canvas-nest.js</span></span><br><span class=\"line\"><span class=\"attr\">canvas_nest:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>试试 <code>hexo clean</code> 然后 <code>hexo g</code>，最后访问你的个人博客，就能看到效果了~</p>\n</li>\n</ol>\n<h4 id=\"修改文章内链接文本样式\"><a href=\"#修改文章内链接文本样式\" class=\"headerlink\" title=\"修改文章内链接文本样式\"></a>修改文章内链接文本样式</h4><p>修改文件 <code>themes\\next\\source\\css\\_common\\components\\post\\post.styl</code>，在末尾添加如下 <code>css</code> 样式：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 文章内链接文本样式</span><br><span class=\"line\"><span class=\"selector-class\">.post-body</span> <span class=\"selector-tag\">p</span> <span class=\"selector-tag\">a</span>&#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#0593d3</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>: none;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#0593d3</span>;</span><br><span class=\"line\">  &amp;:hover &#123;</span><br><span class=\"line\">    <span class=\"selector-tag\">color</span>: <span class=\"selector-id\">#fc6423</span>;</span><br><span class=\"line\">    <span class=\"selector-tag\">border-bottom</span>: <span class=\"selector-tag\">none</span>;</span><br><span class=\"line\">    <span class=\"selector-tag\">border-bottom</span>: 1<span class=\"selector-tag\">px</span> <span class=\"selector-tag\">solid</span> <span class=\"selector-id\">#fc6423</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>其中选择 <code>.post-body</code> 是为了不影响标题，选择 <code>p</code> 是为了不影响首页 “阅读全文” 的显示样式，颜色可以自己定义。</p>\n<h4 id=\"修改文章底部的那个带-号的标签\"><a href=\"#修改文章底部的那个带-号的标签\" class=\"headerlink\" title=\"修改文章底部的那个带 # 号的标签\"></a>修改文章底部的那个带 # 号的标签</h4><p>修改模板 <code>/themes/next/layout/_macro/post.swig</code>，搜索 <code>rel=&quot;tag&quot;&gt;#</code>，将 <code>#</code> 换成 <code>&lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt;</code> 即可，你也可以在 <strong>Font Awesome</strong> 上寻找自己喜欢的图标。</p>\n<h4 id=\"在每篇文章末尾统一添加-“本文结束”-标记\"><a href=\"#在每篇文章末尾统一添加-“本文结束”-标记\" class=\"headerlink\" title=\"在每篇文章末尾统一添加 “本文结束” 标记\"></a>在每篇文章末尾统一添加 “本文结束” 标记</h4><p>在路径 <code>\\themes\\next\\layout\\_macro</code> 中新建 <code>passage-end-tag.swig</code> 文件,并添加以下内容：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    &#123;% if not is_index %&#125;</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">\"text-align:center;color: #ccc;font-size:14px;\"</span>&gt;</span>-------------本文结束<span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa fa-paw\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span>感谢您的阅读-------------<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    &#123;% endif %&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>接着打开 <code>\\themes\\next\\layout\\_macro\\post.swig</code> 文件，在 <code>END POST BODY</code> 之前添加如下画红色部分代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  &#123;% if not is_index %&#125;</span><br><span class=\"line\">    &#123;% include 'passage-end-tag.swig' %&#125;</span><br><span class=\"line\">  &#123;% endif %&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>就像这样：<br><img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/thanks.png\" alt=\"thanks.png\"></p>\n<p>然后打开 <span class=\"purple-target\">主题配置文件</span>，在末尾添加：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 文章末尾添加“本文结束”标记</span></span><br><span class=\"line\"><span class=\"attr\">passage_end_tag:</span></span><br><span class=\"line\">  <span class=\"attr\">enabled:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"修改-代码块自定义样式\"><a href=\"#修改-代码块自定义样式\" class=\"headerlink\" title=\"修改``代码块自定义样式\"></a>修改``代码块自定义样式</h4><p>打开 <code>\\themes\\next\\source\\css\\_custom\\custom.styl</code>，向里面加入如下代码：(颜色可以自己定义)</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Custom styles.</span><br><span class=\"line\"><span class=\"selector-tag\">code</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"number\">#ff7600</span>;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"number\">#fbf7f8</span>;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">2px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">// 大代码块的自定义样式</span><br><span class=\"line\"><span class=\"selector-class\">.highlight</span>, <span class=\"selector-tag\">pre</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">margin</span>: <span class=\"number\">5px</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"attribute\">padding</span>: <span class=\"number\">5px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">3px</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.highlight</span>, <span class=\"selector-tag\">code</span>, <span class=\"selector-tag\">pre</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#d6d6d6</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"侧边栏社交小图标设置\"><a href=\"#侧边栏社交小图标设置\" class=\"headerlink\" title=\"侧边栏社交小图标设置\"></a>侧边栏社交小图标设置</h4><p>打开 <span class=\"purple-target\">主题配置文件</span>，搜索 <code>social_icons:</code>，在 <strong>Font Awesome</strong> 图标库找自己喜欢的小图标，并将名字复制在如下位置，保存即可。</p>\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/social-links.png\" alt=\"social-links.png\">\n\n<h4 id=\"主页文章添加阴影效果\"><a href=\"#主页文章添加阴影效果\" class=\"headerlink\" title=\"主页文章添加阴影效果\"></a>主页文章添加阴影效果</h4><p>打开 <code>\\themes\\next\\source\\css\\_custom\\custom.styl</code>，向里面加入如下代码：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 主页文章添加阴影效果</span><br><span class=\"line\"> <span class=\"selector-class\">.post</span> &#123;</span><br><span class=\"line\">   <span class=\"attribute\">margin-top</span>: <span class=\"number\">60px</span>;</span><br><span class=\"line\">   <span class=\"attribute\">margin-bottom</span>: <span class=\"number\">60px</span>;</span><br><span class=\"line\">   <span class=\"attribute\">padding</span>: <span class=\"number\">25px</span>;</span><br><span class=\"line\">   <span class=\"attribute\">-webkit-box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">5px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">202</span>, <span class=\"number\">203</span>, <span class=\"number\">203</span>, .<span class=\"number\">5</span>);</span><br><span class=\"line\">   <span class=\"attribute\">-moz-box-shadow</span>: <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">5px</span> <span class=\"built_in\">rgba</span>(<span class=\"number\">202</span>, <span class=\"number\">203</span>, <span class=\"number\">204</span>, .<span class=\"number\">5</span>);</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"设置网站的图标-Favicon\"><a href=\"#设置网站的图标-Favicon\" class=\"headerlink\" title=\"设置网站的图标 Favicon\"></a>设置网站的图标 Favicon</h4><p>你可以在 <a href=\"https://www.easyicon.net/\" target=\"_blank\" rel=\"noopener\">EasyIcon</a> 中找一张 <strong>（32*32）</strong> 的 <code>ico</code> 图标，或者去别的网站下载或者制作，并将图标名称改为 <code>favicon.ico</code>，然后把图标放在 <code>/themes/next/source/images</code> 里，并且修改 <span class=\"purple-target\">主题配置文件</span>：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Put your favicon.ico into `hexo-site/source/` directory.</span></span><br><span class=\"line\"><span class=\"attr\">favicon:</span> <span class=\"string\">/favicon.ico</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"在文章底部增加版权信息\"><a href=\"#在文章底部增加版权信息\" class=\"headerlink\" title=\"在文章底部增加版权信息\"></a>在文章底部增加版权信息</h4><p>在目录 <code>next/layout/_macro/</code> 下添加 <code>my-copyright.swig</code>：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% if page.copyright %&#125;</span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"my_post_copyright\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- JS库 sweetalert 可修改路径 --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://unpkg.com/sweetalert/dist/sweetalert.min.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>本文标题:<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"&#123;&#123; url_for(page.path) &#125;&#125;\"</span>&gt;</span>&#123;&#123; page.title &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>文章作者:<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"/\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"访问 &#123;&#123; theme.author &#125;&#125; 的个人博客\"</span>&gt;</span>&#123;&#123; theme.author &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>发布时间:<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span>&#123;&#123; page.date.format(\"YYYY年MM月DD日 - HH:mm\") &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>最后更新:<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span>&#123;&#123; page.updated.format(\"YYYY年MM月DD日 - HH:mm\") &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>原始链接:<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"&#123;&#123; url_for(page.path) &#125;&#125;\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"&#123;&#123; page.title &#125;&#125;\"</span>&gt;</span>&#123;&#123; page.permalink &#125;&#125;<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"copy-path\"</span>  <span class=\"attr\">title</span>=<span class=\"string\">\"点击复制文章链接\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa fa-clipboard\"</span> <span class=\"attr\">data-clipboard-text</span>=<span class=\"string\">\"&#123;&#123; page.permalink &#125;&#125;\"</span>  <span class=\"attr\">aria-label</span>=<span class=\"string\">\"复制成功！\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">p</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>许可协议:<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">\"fa fa-creative-commons\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"license\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://creativecommons.org/licenses/by-nc-nd/4.0/\"</span> <span class=\"attr\">target</span>=<span class=\"string\">\"_blank\"</span> <span class=\"attr\">title</span>=<span class=\"string\">\"Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)\"</span>&gt;</span>署名-非商业性使用-禁止演绎 4.0 国际<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span> 转载请保留原文链接及作者。<span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span>  </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span> </span><br><span class=\"line\"><span class=\"actionscript\">    <span class=\"keyword\">var</span> clipboard = <span class=\"keyword\">new</span> Clipboard(<span class=\"string\">'.fa-clipboard'</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">    $(<span class=\"string\">\".fa-clipboard\"</span>).click(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>)</span>&#123;</span></span><br><span class=\"line\"><span class=\"actionscript\">      clipboard.on(<span class=\"string\">'success'</span>, <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">()</span></span>&#123;</span></span><br><span class=\"line\">        swal(&#123;   </span><br><span class=\"line\"><span class=\"actionscript\">          title: <span class=\"string\">\"\"</span>,   </span></span><br><span class=\"line\"><span class=\"actionscript\">          text: <span class=\"string\">'复制成功'</span>,</span></span><br><span class=\"line\"><span class=\"actionscript\">          icon: <span class=\"string\">\"success\"</span>, </span></span><br><span class=\"line\"><span class=\"actionscript\">          showConfirmButton: <span class=\"literal\">true</span></span></span><br><span class=\"line\">          &#125;);</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">    &#125;);  </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure>\n<p>在目录 <code>next/source/css/_common/components/post/</code> 下添加 <code>my-post-copyright.styl</code>：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">85%</span>;</span><br><span class=\"line\">  <span class=\"attribute\">max-width</span>: <span class=\"number\">45em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">2.8em</span> auto <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"attribute\">padding</span>: <span class=\"number\">0.5em</span> <span class=\"number\">1.0em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#d3d3d3</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-size</span>: <span class=\"number\">0.93rem</span>;</span><br><span class=\"line\">  <span class=\"attribute\">line-height</span>: <span class=\"number\">1.6em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">word-break</span>: break-all;</span><br><span class=\"line\">  <span class=\"attribute\">background</span>: <span class=\"built_in\">rgba</span>(<span class=\"number\">255</span>,<span class=\"number\">255</span>,<span class=\"number\">255</span>,<span class=\"number\">0.4</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-tag\">p</span>&#123;<span class=\"attribute\">margin</span>:<span class=\"number\">0</span>;&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-tag\">span</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: inline-block;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">5.2em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#b5b5b5</span>;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: bold;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-class\">.raw</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">margin-left</span>: <span class=\"number\">1em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">5em</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-tag\">a</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#808080</span>;</span><br><span class=\"line\">  <span class=\"attribute\">border-bottom</span>:<span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-tag\">a</span><span class=\"selector-pseudo\">:hover</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#a3d2a3</span>;</span><br><span class=\"line\">  <span class=\"attribute\">text-decoration</span>: underline;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span><span class=\"selector-pseudo\">:hover</span> <span class=\"selector-class\">.fa-clipboard</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#000</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-class\">.post-url</span><span class=\"selector-pseudo\">:hover</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">font-weight</span>: normal;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-class\">.copy-path</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">margin-left</span>: <span class=\"number\">1em</span>;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">1em</span>;</span><br><span class=\"line\">  +mobile()&#123;display:none;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.my_post_copyright</span> <span class=\"selector-class\">.copy-path</span><span class=\"selector-pseudo\">:hover</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">color</span>: <span class=\"number\">#808080</span>;</span><br><span class=\"line\">  <span class=\"attribute\">cursor</span>: pointer;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>修改 <code>next/layout/_macro/post.swig</code>，在之前添加 <strong>底部阅读完毕</strong> 代码中，再添加如下代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% include 'my-copyright.swig' %&#125;</span><br></pre></td></tr></table></figure>\n<p>如图所示：<br><img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/my-copyright.png\" alt=\"my-copyright.png\"><br>修改 <code>next/source/css/_common/components/post/post.styl</code> 文件，在最后一行增加代码：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">@import</span> <span class=\"string\">\"my-post-copyright\"</span></span><br></pre></td></tr></table></figure>\n<p>如果要在该博文下面增加版权信息的显示，需要在 <strong>Markdown</strong> 中增加 <code>copyright: true</code> 的设置，如图所示：</p>\n<img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/show-copyright.png\" alt=\"show-copyright.png\">\n\n<h4 id=\"隐藏网页底部-powered-By-Hexo-强力驱动\"><a href=\"#隐藏网页底部-powered-By-Hexo-强力驱动\" class=\"headerlink\" title=\"隐藏网页底部 powered By Hexo / 强力驱动\"></a>隐藏网页底部 powered By Hexo / 强力驱动</h4><p>打开 <code>themes/next/layout/_partials/footer.swig</code>，隐藏之间的代码即可，或者直接删除。位置如图：<br><img src=\"/2019/07/31/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/hide-hexo.png\" alt=\"hide-hexo.png\"></p>\n<h4 id=\"添加-Live-2D-小宠物\"><a href=\"#添加-Live-2D-小宠物\" class=\"headerlink\" title=\"添加 Live 2D 小宠物\"></a><a name=\"live2d\" style=\"cursor: default; color: #fff; border-bottom: none; :hover {color: #fff; border-bottom: none;}\">添加 Live 2D 小宠物</a></h4><p>切换至 <code>Hexo</code> 根目录下，在终端中输入以下代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install -save hexo-helper-live2d</span><br></pre></td></tr></table></figure>\n\n<p>编辑 <span class=\"blue-target\">站点配置文件</span>：（具体配置见 <a href=\"https://github.com/EYHN/hexo-helper-live2d\" target=\"_blank\" rel=\"noopener\">官方文档</a>）</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">live2d:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">scriptFrom:</span> <span class=\"string\">local</span></span><br><span class=\"line\">  <span class=\"attr\">pluginRootPath:</span> <span class=\"string\">live2dw/</span></span><br><span class=\"line\">  <span class=\"attr\">pluginJsPath:</span> <span class=\"string\">lib/</span></span><br><span class=\"line\">  <span class=\"attr\">pluginModelPath:</span> <span class=\"string\">assets/</span></span><br><span class=\"line\">  <span class=\"attr\">model:</span></span><br><span class=\"line\">    <span class=\"attr\">use:</span> <span class=\"string\">live2d-widget-model-wanko</span></span><br><span class=\"line\">  <span class=\"attr\">display:</span></span><br><span class=\"line\">    <span class=\"attr\">position:</span> <span class=\"string\">right</span></span><br><span class=\"line\">    <span class=\"attr\">width:</span> <span class=\"number\">150</span></span><br><span class=\"line\">    <span class=\"attr\">height:</span> <span class=\"number\">300</span></span><br><span class=\"line\">  <span class=\"attr\">mobile:</span></span><br><span class=\"line\">    <span class=\"attr\">show:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<p>我的 <a href=\"https://www.wqh4u.cn/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/\">这一篇博客</a> 中写了一些关于 <span class=\"blue-target\">Live 2D</span> 的一些进阶设置，感兴趣的看官可以参考一下。</p>\n<blockquote>\n<p>完~</p>\n</blockquote>\n<h2 id=\"参考文献\"><a href=\"#参考文献\" class=\"headerlink\" title=\"参考文献\"></a>参考文献</h2><ol>\n<li><a href=\"https://hexo.io/zh-cn/docs/\" target=\"_blank\" rel=\"noopener\">文档 | Hexo</a></li>\n<li><a href=\"https://hexo.io/themes/\" target=\"_blank\" rel=\"noopener\">Themes | Hexo</a></li>\n<li><a href=\"http://theme-next.iissnan.com/getting-started.html\" target=\"_blank\" rel=\"noopener\">开始使用 - NexT 使用文档</a></li>\n<li><a href=\"https://www.cnblogs.com/trista222/p/8017300.html\" target=\"_blank\" rel=\"noopener\">结合hexo在GitHub上搭建个人博客——全过程</a></li>\n<li><a href=\"https://blog.csdn.net/coding01/article/details/80083033\" target=\"_blank\" rel=\"noopener\">阿里云CentOS下Hexo+Nginx建站过程 - 来吧，和鹿丸君一起打豆豆</a></li>\n<li><a href=\"http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html\" target=\"_blank\" rel=\"noopener\">hexo的next主题个性化教程:打造炫酷网站</a></li>\n</ol>"},{"title":"JavaScript的基本组成部分","date":"2019-12-07T13:48:50.000Z","copyright":true,"image":"http://www.wqh4u.cn/2019/12/07/JavaScript的基本组成部分/java-script.jpg","_content":"\n> <span class = 'introduction'>大多数人想改造这个世界，但却罕有人想改造自己。</span><br/>\nJavaScript（通常缩写JS）是一种进阶的、直译的程式语言。JavaScript 是一门基于原型、函式先行的语言，是一门多范式的语言，它支援物件导向编程，指令式程式设计，以及函式语言程式设计。它被世界上的绝大多数网站所使用，也被世界主流浏览器（Chrome、IE、Firefox、Safari、Opera）支援。\n\n<!--more-->\n\n<hr/>\n\n## JavaScript 的组成\n\n**Java Script的三个主要组成部分是：ECMAScript(核心)，DOM（文档对象模型），BOM（浏览器对象模型）**\n\n<img src=\"structure.png\" alt=\"structure.png\" title=\"JavaScript 的组成部分\" />\n\n<hr />\n\n## ECMAScript\n\n<div class=\"note info\">\n<p><code>ECMAScript</code>是一种由 <em>Ecma</em> 国际（前身为欧洲计算机制造商协会）在标准 <em>ECMA-262</em> 中定义的脚本语言规范。这种语言在万维网上应用广泛，它往往被称为 <em>JavaScript</em> 或 <em>JScript</em>，但实际上后两者是 <em>ECMA-262</em> 标准的实现和扩展。</p>\n</div>\n\nECMA-262 没有参照 web 浏览器，规定了语言的组成部分，具体包括 <b>语法、类型、语言、关键字、保留字、操作符、对象</b>。\n\n<code>ECMAScript</code>就是对该标准规定了各个方面内容的语言的描述。\n\n1. 支持ECMA-262描述的所有“类型，值，对象，属性，函数，以及程序语法和语义” 。\n\n2. 支持Unicode字符标准。\n\n3. 添加ECMA-262没有描述的更多“类型，值，对象，属性，函数”，ECMA-262说说的浙西新增特性，主要是指该标准中没有规定的新对象和对象的新属性。\n\n4. 支持ECMA-262中没有定义的“程序和正则表达式的语法”。也就是说可以修改和扩展内置的正则表达式语法。\n\n**ECMAScript - 语法规范**\n- 变量、数据类型、类型转换、操作符\n- 流程控制语句：判断、循环\n- 数组、函数、作用域、预解析（变量提升、函数提升）\n- 对象、属性、方法、简单类型和复杂类型的区别\n- 内置对象：Math、Date、Array\n- 基本包装类型：Number、String、Boolean\n  \n<hr />\n\n## Web APIs\n\n### Document Object Models\n\n**DOM(Document Object Models, 文档对象模型)** 是针对 XML 但经过扩展用于 HTML 的应用程序编程接口（API）。\n\n**DOM** 把整个页面映射为一个多层次节点结构。\n\nHTML 或者 XML 页面中的每个组成部分都是某种类型的节点，这些节点又包含着不同类型的数据。\n\n在 **DOM** 中，页面一般可以用分层节点图表示。\n\n<img src=\"DOM_tree.png\" alt=\"DOM_tree.png\" title=\"DOM 树\" />\n\n#### DOM级别\n\n**DOM1** 级于 1998 年 10 月成为 W3C 的推荐标准。BOM1 由两个模块组成分别是 **DOM core 和 DOM HTML**。\n\n<div class=\"note info\">\n<b>DOM core</b>：规定如何映射基于 XML 的文档结构，以便简化对文档中任意部分的访问和操作。\n\n<b>DOM HTML</b>：在 DOM core 的基础上加以扩展，添加了针对 HTML 的对象和方法。\n</div>\n\n**DOM2** 级在原来 DOM 的基础上有扩充了鼠标和用户界面事件、范围、遍历等细分模块，通过对象接口增加了对 css 的支持。包括以下模块：\n\n<div class=\"note info\">\n<b>DOM Views（DOM视图）</b>：定义了跟踪不同文档视图的接口。\n\n<b>DOM Events（DOM事件）</b>：定义了事件与事件处理的接口。\n\n<b>DOM Traversal and Range(DOM遍历和范围)</b>：定义了遍历和操作文档的接口。\n</div>\n\n**DOM3** 级则进一步扩展了 DOM，引入了 <span class=\"blue-target\">加载和保存模块</span> 以统一方式加载和保存文档的方法，新增了 DOM 验证模块主要还是验证文档的方法。\n\n### Browser Object Model\n\n**BOM(Brower Object Model，浏览器对象模型)** 处理浏览器窗口和框架，人们习惯上把所有针对浏览器的 JavaScript 扩展算作是 BOM 的一部分。\n\nBOM 包括：\n\n1. 弹出新浏览器窗口的功能。\n2. 移动、缩放和关闭浏览器窗口的功能。\n3. 提供浏览器所加载页面的详细信息的 navigator 对象。\n4. 提供浏览器所加载页面的详细信息的 location 对象。\n5. 提供用户分辨率详细信息的screen对象。\n6. 对 cookies 的支持。\n7. 像 XMLHttpRequest 和 IE 的 ActionXobject 这样的自定义对象。\n\n<hr />\n\n## JavaScript 执行过程\n\n<img src=\"jszxgc.png\" alt=\"jszxgc.png\" title=\"JavaScript 执行过程\" />\n\n- User Interface: 用户界面\n- Browser Engine: 浏览器引擎，用来查询和操作渲染的引擎\n- Rendering Engine: 渲染引擎，用来显示请求的内容，负责解析 HTML、CSS，并把解析的内容显示出来（生成一个 DOM 树）\n- Networking: 网络，负责发送网络请求\n- JavaScript Interpreter: JavaScript 解析器，负责执行 JavaScript 代码\n- UI Backend: UI后端，用来绘制类似组合框的弹出窗口\n- Data Persistence: 数据持久化，数据存储 cookie、sessionStorage\n","source":"_posts/JavaScript的基本组成部分.md","raw":"---\ntitle: JavaScript的基本组成部分\ndate: 2019-12-07 21:48:50\ntags:\n- Web\n- JavaScript\ncategories:\n- 前端\n- 面经\n- JavaScript\ncopyright: true\nimage: \"http://www.wqh4u.cn/2019/12/07/JavaScript的基本组成部分/java-script.jpg\"\n---\n\n> <span class = 'introduction'>大多数人想改造这个世界，但却罕有人想改造自己。</span><br/>\nJavaScript（通常缩写JS）是一种进阶的、直译的程式语言。JavaScript 是一门基于原型、函式先行的语言，是一门多范式的语言，它支援物件导向编程，指令式程式设计，以及函式语言程式设计。它被世界上的绝大多数网站所使用，也被世界主流浏览器（Chrome、IE、Firefox、Safari、Opera）支援。\n\n<!--more-->\n\n<hr/>\n\n## JavaScript 的组成\n\n**Java Script的三个主要组成部分是：ECMAScript(核心)，DOM（文档对象模型），BOM（浏览器对象模型）**\n\n<img src=\"structure.png\" alt=\"structure.png\" title=\"JavaScript 的组成部分\" />\n\n<hr />\n\n## ECMAScript\n\n<div class=\"note info\">\n<p><code>ECMAScript</code>是一种由 <em>Ecma</em> 国际（前身为欧洲计算机制造商协会）在标准 <em>ECMA-262</em> 中定义的脚本语言规范。这种语言在万维网上应用广泛，它往往被称为 <em>JavaScript</em> 或 <em>JScript</em>，但实际上后两者是 <em>ECMA-262</em> 标准的实现和扩展。</p>\n</div>\n\nECMA-262 没有参照 web 浏览器，规定了语言的组成部分，具体包括 <b>语法、类型、语言、关键字、保留字、操作符、对象</b>。\n\n<code>ECMAScript</code>就是对该标准规定了各个方面内容的语言的描述。\n\n1. 支持ECMA-262描述的所有“类型，值，对象，属性，函数，以及程序语法和语义” 。\n\n2. 支持Unicode字符标准。\n\n3. 添加ECMA-262没有描述的更多“类型，值，对象，属性，函数”，ECMA-262说说的浙西新增特性，主要是指该标准中没有规定的新对象和对象的新属性。\n\n4. 支持ECMA-262中没有定义的“程序和正则表达式的语法”。也就是说可以修改和扩展内置的正则表达式语法。\n\n**ECMAScript - 语法规范**\n- 变量、数据类型、类型转换、操作符\n- 流程控制语句：判断、循环\n- 数组、函数、作用域、预解析（变量提升、函数提升）\n- 对象、属性、方法、简单类型和复杂类型的区别\n- 内置对象：Math、Date、Array\n- 基本包装类型：Number、String、Boolean\n  \n<hr />\n\n## Web APIs\n\n### Document Object Models\n\n**DOM(Document Object Models, 文档对象模型)** 是针对 XML 但经过扩展用于 HTML 的应用程序编程接口（API）。\n\n**DOM** 把整个页面映射为一个多层次节点结构。\n\nHTML 或者 XML 页面中的每个组成部分都是某种类型的节点，这些节点又包含着不同类型的数据。\n\n在 **DOM** 中，页面一般可以用分层节点图表示。\n\n<img src=\"DOM_tree.png\" alt=\"DOM_tree.png\" title=\"DOM 树\" />\n\n#### DOM级别\n\n**DOM1** 级于 1998 年 10 月成为 W3C 的推荐标准。BOM1 由两个模块组成分别是 **DOM core 和 DOM HTML**。\n\n<div class=\"note info\">\n<b>DOM core</b>：规定如何映射基于 XML 的文档结构，以便简化对文档中任意部分的访问和操作。\n\n<b>DOM HTML</b>：在 DOM core 的基础上加以扩展，添加了针对 HTML 的对象和方法。\n</div>\n\n**DOM2** 级在原来 DOM 的基础上有扩充了鼠标和用户界面事件、范围、遍历等细分模块，通过对象接口增加了对 css 的支持。包括以下模块：\n\n<div class=\"note info\">\n<b>DOM Views（DOM视图）</b>：定义了跟踪不同文档视图的接口。\n\n<b>DOM Events（DOM事件）</b>：定义了事件与事件处理的接口。\n\n<b>DOM Traversal and Range(DOM遍历和范围)</b>：定义了遍历和操作文档的接口。\n</div>\n\n**DOM3** 级则进一步扩展了 DOM，引入了 <span class=\"blue-target\">加载和保存模块</span> 以统一方式加载和保存文档的方法，新增了 DOM 验证模块主要还是验证文档的方法。\n\n### Browser Object Model\n\n**BOM(Brower Object Model，浏览器对象模型)** 处理浏览器窗口和框架，人们习惯上把所有针对浏览器的 JavaScript 扩展算作是 BOM 的一部分。\n\nBOM 包括：\n\n1. 弹出新浏览器窗口的功能。\n2. 移动、缩放和关闭浏览器窗口的功能。\n3. 提供浏览器所加载页面的详细信息的 navigator 对象。\n4. 提供浏览器所加载页面的详细信息的 location 对象。\n5. 提供用户分辨率详细信息的screen对象。\n6. 对 cookies 的支持。\n7. 像 XMLHttpRequest 和 IE 的 ActionXobject 这样的自定义对象。\n\n<hr />\n\n## JavaScript 执行过程\n\n<img src=\"jszxgc.png\" alt=\"jszxgc.png\" title=\"JavaScript 执行过程\" />\n\n- User Interface: 用户界面\n- Browser Engine: 浏览器引擎，用来查询和操作渲染的引擎\n- Rendering Engine: 渲染引擎，用来显示请求的内容，负责解析 HTML、CSS，并把解析的内容显示出来（生成一个 DOM 树）\n- Networking: 网络，负责发送网络请求\n- JavaScript Interpreter: JavaScript 解析器，负责执行 JavaScript 代码\n- UI Backend: UI后端，用来绘制类似组合框的弹出窗口\n- Data Persistence: 数据持久化，数据存储 cookie、sessionStorage\n","slug":"JavaScript的基本组成部分","published":1,"updated":"2020-01-14T20:30:46.797Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn5i000g2lwjgnk8fvbc","content":"<blockquote>\n<p><span class=\"introduction\">大多数人想改造这个世界，但却罕有人想改造自己。</span><br><br>JavaScript（通常缩写JS）是一种进阶的、直译的程式语言。JavaScript 是一门基于原型、函式先行的语言，是一门多范式的语言，它支援物件导向编程，指令式程式设计，以及函式语言程式设计。它被世界上的绝大多数网站所使用，也被世界主流浏览器（Chrome、IE、Firefox、Safari、Opera）支援。</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"JavaScript-的组成\"><a href=\"#JavaScript-的组成\" class=\"headerlink\" title=\"JavaScript 的组成\"></a>JavaScript 的组成</h2><p><strong>Java Script的三个主要组成部分是：ECMAScript(核心)，DOM（文档对象模型），BOM（浏览器对象模型）</strong></p>\n<img src=\"/2019/12/07/JavaScript%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86/structure.png\" alt=\"structure.png\" title=\"JavaScript 的组成部分\">\n\n<hr>\n\n<h2 id=\"ECMAScript\"><a href=\"#ECMAScript\" class=\"headerlink\" title=\"ECMAScript\"></a>ECMAScript</h2><div class=\"note info\">\n<p><code>ECMAScript</code>是一种由 <em>Ecma</em> 国际（前身为欧洲计算机制造商协会）在标准 <em>ECMA-262</em> 中定义的脚本语言规范。这种语言在万维网上应用广泛，它往往被称为 <em>JavaScript</em> 或 <em>JScript</em>，但实际上后两者是 <em>ECMA-262</em> 标准的实现和扩展。</p>\n</div>\n\n<p>ECMA-262 没有参照 web 浏览器，规定了语言的组成部分，具体包括 <b>语法、类型、语言、关键字、保留字、操作符、对象</b>。</p>\n<p><code>ECMAScript</code>就是对该标准规定了各个方面内容的语言的描述。</p>\n<ol>\n<li><p>支持ECMA-262描述的所有“类型，值，对象，属性，函数，以及程序语法和语义” 。</p>\n</li>\n<li><p>支持Unicode字符标准。</p>\n</li>\n<li><p>添加ECMA-262没有描述的更多“类型，值，对象，属性，函数”，ECMA-262说说的浙西新增特性，主要是指该标准中没有规定的新对象和对象的新属性。</p>\n</li>\n<li><p>支持ECMA-262中没有定义的“程序和正则表达式的语法”。也就是说可以修改和扩展内置的正则表达式语法。</p>\n</li>\n</ol>\n<p><strong>ECMAScript - 语法规范</strong></p>\n<ul>\n<li>变量、数据类型、类型转换、操作符</li>\n<li>流程控制语句：判断、循环</li>\n<li>数组、函数、作用域、预解析（变量提升、函数提升）</li>\n<li>对象、属性、方法、简单类型和复杂类型的区别</li>\n<li>内置对象：Math、Date、Array</li>\n<li>基本包装类型：Number、String、Boolean</li>\n</ul>\n<hr>\n\n<h2 id=\"Web-APIs\"><a href=\"#Web-APIs\" class=\"headerlink\" title=\"Web APIs\"></a>Web APIs</h2><h3 id=\"Document-Object-Models\"><a href=\"#Document-Object-Models\" class=\"headerlink\" title=\"Document Object Models\"></a>Document Object Models</h3><p><strong>DOM(Document Object Models, 文档对象模型)</strong> 是针对 XML 但经过扩展用于 HTML 的应用程序编程接口（API）。</p>\n<p><strong>DOM</strong> 把整个页面映射为一个多层次节点结构。</p>\n<p>HTML 或者 XML 页面中的每个组成部分都是某种类型的节点，这些节点又包含着不同类型的数据。</p>\n<p>在 <strong>DOM</strong> 中，页面一般可以用分层节点图表示。</p>\n<img src=\"/2019/12/07/JavaScript%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86/DOM_tree.png\" alt=\"DOM_tree.png\" title=\"DOM 树\">\n\n<h4 id=\"DOM级别\"><a href=\"#DOM级别\" class=\"headerlink\" title=\"DOM级别\"></a>DOM级别</h4><p><strong>DOM1</strong> 级于 1998 年 10 月成为 W3C 的推荐标准。BOM1 由两个模块组成分别是 <strong>DOM core 和 DOM HTML</strong>。</p>\n<div class=\"note info\">\n<b>DOM core</b>：规定如何映射基于 XML 的文档结构，以便简化对文档中任意部分的访问和操作。\n\n<p><b>DOM HTML</b>：在 DOM core 的基础上加以扩展，添加了针对 HTML 的对象和方法。</p>\n</div>\n\n<p><strong>DOM2</strong> 级在原来 DOM 的基础上有扩充了鼠标和用户界面事件、范围、遍历等细分模块，通过对象接口增加了对 css 的支持。包括以下模块：</p>\n<div class=\"note info\">\n<b>DOM Views（DOM视图）</b>：定义了跟踪不同文档视图的接口。\n\n<p><b>DOM Events（DOM事件）</b>：定义了事件与事件处理的接口。</p>\n<p><b>DOM Traversal and Range(DOM遍历和范围)</b>：定义了遍历和操作文档的接口。</p>\n</div>\n\n<p><strong>DOM3</strong> 级则进一步扩展了 DOM，引入了 <span class=\"blue-target\">加载和保存模块</span> 以统一方式加载和保存文档的方法，新增了 DOM 验证模块主要还是验证文档的方法。</p>\n<h3 id=\"Browser-Object-Model\"><a href=\"#Browser-Object-Model\" class=\"headerlink\" title=\"Browser Object Model\"></a>Browser Object Model</h3><p><strong>BOM(Brower Object Model，浏览器对象模型)</strong> 处理浏览器窗口和框架，人们习惯上把所有针对浏览器的 JavaScript 扩展算作是 BOM 的一部分。</p>\n<p>BOM 包括：</p>\n<ol>\n<li>弹出新浏览器窗口的功能。</li>\n<li>移动、缩放和关闭浏览器窗口的功能。</li>\n<li>提供浏览器所加载页面的详细信息的 navigator 对象。</li>\n<li>提供浏览器所加载页面的详细信息的 location 对象。</li>\n<li>提供用户分辨率详细信息的screen对象。</li>\n<li>对 cookies 的支持。</li>\n<li>像 XMLHttpRequest 和 IE 的 ActionXobject 这样的自定义对象。</li>\n</ol>\n<hr>\n\n<h2 id=\"JavaScript-执行过程\"><a href=\"#JavaScript-执行过程\" class=\"headerlink\" title=\"JavaScript 执行过程\"></a>JavaScript 执行过程</h2><img src=\"/2019/12/07/JavaScript%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86/jszxgc.png\" alt=\"jszxgc.png\" title=\"JavaScript 执行过程\">\n\n<ul>\n<li>User Interface: 用户界面</li>\n<li>Browser Engine: 浏览器引擎，用来查询和操作渲染的引擎</li>\n<li>Rendering Engine: 渲染引擎，用来显示请求的内容，负责解析 HTML、CSS，并把解析的内容显示出来（生成一个 DOM 树）</li>\n<li>Networking: 网络，负责发送网络请求</li>\n<li>JavaScript Interpreter: JavaScript 解析器，负责执行 JavaScript 代码</li>\n<li>UI Backend: UI后端，用来绘制类似组合框的弹出窗口</li>\n<li>Data Persistence: 数据持久化，数据存储 cookie、sessionStorage</li>\n</ul>\n","site":{"data":{}},"length":1890,"excerpt":"<blockquote>\n<p><span class=\"introduction\">大多数人想改造这个世界，但却罕有人想改造自己。</span><br><br>JavaScript（通常缩写JS）是一种进阶的、直译的程式语言。JavaScript 是一门基于原型、函式先行的语言，是一门多范式的语言，它支援物件导向编程，指令式程式设计，以及函式语言程式设计。它被世界上的绝大多数网站所使用，也被世界主流浏览器（Chrome、IE、Firefox、Safari、Opera）支援。</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"JavaScript-的组成\"><a href=\"#JavaScript-的组成\" class=\"headerlink\" title=\"JavaScript 的组成\"></a>JavaScript 的组成</h2><p><strong>Java Script的三个主要组成部分是：ECMAScript(核心)，DOM（文档对象模型），BOM（浏览器对象模型）</strong></p>\n<img src=\"/2019/12/07/JavaScript%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86/structure.png\" alt=\"structure.png\" title=\"JavaScript 的组成部分\">\n\n<hr>\n\n<h2 id=\"ECMAScript\"><a href=\"#ECMAScript\" class=\"headerlink\" title=\"ECMAScript\"></a>ECMAScript</h2><div class=\"note info\">\n<p><code>ECMAScript</code>是一种由 <em>Ecma</em> 国际（前身为欧洲计算机制造商协会）在标准 <em>ECMA-262</em> 中定义的脚本语言规范。这种语言在万维网上应用广泛，它往往被称为 <em>JavaScript</em> 或 <em>JScript</em>，但实际上后两者是 <em>ECMA-262</em> 标准的实现和扩展。</p>\n</div>\n\n<p>ECMA-262 没有参照 web 浏览器，规定了语言的组成部分，具体包括 <b>语法、类型、语言、关键字、保留字、操作符、对象</b>。</p>\n<p><code>ECMAScript</code>就是对该标准规定了各个方面内容的语言的描述。</p>\n<ol>\n<li><p>支持ECMA-262描述的所有“类型，值，对象，属性，函数，以及程序语法和语义” 。</p>\n</li>\n<li><p>支持Unicode字符标准。</p>\n</li>\n<li><p>添加ECMA-262没有描述的更多“类型，值，对象，属性，函数”，ECMA-262说说的浙西新增特性，主要是指该标准中没有规定的新对象和对象的新属性。</p>\n</li>\n<li><p>支持ECMA-262中没有定义的“程序和正则表达式的语法”。也就是说可以修改和扩展内置的正则表达式语法。</p>\n</li>\n</ol>\n<p><strong>ECMAScript - 语法规范</strong></p>\n<ul>\n<li>变量、数据类型、类型转换、操作符</li>\n<li>流程控制语句：判断、循环</li>\n<li>数组、函数、作用域、预解析（变量提升、函数提升）</li>\n<li>对象、属性、方法、简单类型和复杂类型的区别</li>\n<li>内置对象：Math、Date、Array</li>\n<li>基本包装类型：Number、String、Boolean</li>\n</ul>\n<hr>\n\n<h2 id=\"Web-APIs\"><a href=\"#Web-APIs\" class=\"headerlink\" title=\"Web APIs\"></a>Web APIs</h2><h3 id=\"Document-Object-Models\"><a href=\"#Document-Object-Models\" class=\"headerlink\" title=\"Document Object Models\"></a>Document Object Models</h3><p><strong>DOM(Document Object Models, 文档对象模型)</strong> 是针对 XML 但经过扩展用于 HTML 的应用程序编程接口（API）。</p>\n<p><strong>DOM</strong> 把整个页面映射为一个多层次节点结构。</p>\n<p>HTML 或者 XML 页面中的每个组成部分都是某种类型的节点，这些节点又包含着不同类型的数据。</p>\n<p>在 <strong>DOM</strong> 中，页面一般可以用分层节点图表示。</p>\n<img src=\"/2019/12/07/JavaScript%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86/DOM_tree.png\" alt=\"DOM_tree.png\" title=\"DOM 树\">\n\n<h4 id=\"DOM级别\"><a href=\"#DOM级别\" class=\"headerlink\" title=\"DOM级别\"></a>DOM级别</h4><p><strong>DOM1</strong> 级于 1998 年 10 月成为 W3C 的推荐标准。BOM1 由两个模块组成分别是 <strong>DOM core 和 DOM HTML</strong>。</p>\n<div class=\"note info\">\n<b>DOM core</b>：规定如何映射基于 XML 的文档结构，以便简化对文档中任意部分的访问和操作。\n\n<p><b>DOM HTML</b>：在 DOM core 的基础上加以扩展，添加了针对 HTML 的对象和方法。</p>\n</div>\n\n<p><strong>DOM2</strong> 级在原来 DOM 的基础上有扩充了鼠标和用户界面事件、范围、遍历等细分模块，通过对象接口增加了对 css 的支持。包括以下模块：</p>\n<div class=\"note info\">\n<b>DOM Views（DOM视图）</b>：定义了跟踪不同文档视图的接口。\n\n<p><b>DOM Events（DOM事件）</b>：定义了事件与事件处理的接口。</p>\n<p><b>DOM Traversal and Range(DOM遍历和范围)</b>：定义了遍历和操作文档的接口。</p>\n</div>\n\n<p><strong>DOM3</strong> 级则进一步扩展了 DOM，引入了 <span class=\"blue-target\">加载和保存模块</span> 以统一方式加载和保存文档的方法，新增了 DOM 验证模块主要还是验证文档的方法。</p>\n<h3 id=\"Browser-Object-Model\"><a href=\"#Browser-Object-Model\" class=\"headerlink\" title=\"Browser Object Model\"></a>Browser Object Model</h3><p><strong>BOM(Brower Object Model，浏览器对象模型)</strong> 处理浏览器窗口和框架，人们习惯上把所有针对浏览器的 JavaScript 扩展算作是 BOM 的一部分。</p>\n<p>BOM 包括：</p>\n<ol>\n<li>弹出新浏览器窗口的功能。</li>\n<li>移动、缩放和关闭浏览器窗口的功能。</li>\n<li>提供浏览器所加载页面的详细信息的 navigator 对象。</li>\n<li>提供浏览器所加载页面的详细信息的 location 对象。</li>\n<li>提供用户分辨率详细信息的screen对象。</li>\n<li>对 cookies 的支持。</li>\n<li>像 XMLHttpRequest 和 IE 的 ActionXobject 这样的自定义对象。</li>\n</ol>\n<hr>\n\n<h2 id=\"JavaScript-执行过程\"><a href=\"#JavaScript-执行过程\" class=\"headerlink\" title=\"JavaScript 执行过程\"></a>JavaScript 执行过程</h2><img src=\"/2019/12/07/JavaScript%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86/jszxgc.png\" alt=\"jszxgc.png\" title=\"JavaScript 执行过程\">\n\n<ul>\n<li>User Interface: 用户界面</li>\n<li>Browser Engine: 浏览器引擎，用来查询和操作渲染的引擎</li>\n<li>Rendering Engine: 渲染引擎，用来显示请求的内容，负责解析 HTML、CSS，并把解析的内容显示出来（生成一个 DOM 树）</li>\n<li>Networking: 网络，负责发送网络请求</li>\n<li>JavaScript Interpreter: JavaScript 解析器，负责执行 JavaScript 代码</li>\n<li>UI Backend: UI后端，用来绘制类似组合框的弹出窗口</li>\n<li>Data Persistence: 数据持久化，数据存储 cookie、sessionStorage</li>\n</ul>"},{"title":"JavaScript观察者模式与发布订阅","date":"2020-01-14T11:55:10.000Z","updated":"2020-01-18T08:25:07.000Z","copyright":true,"_content":"\n> <span class = 'introduction'>青少年是一个美好而又是一去不可再得的时期，是将来一切光明和幸福的开端。</span><br/>\n如果面试官问到你：“What is the difference between the Observer pattern and Pub-Sub pattern?”，你该怎么回答呢？\n\n<!--more-->\n\n<hr/>\n\n## 背景\n\n<div class=\"note info\">设计模式是在面向对象软件设计过程中针对特定问题的简洁而优雅的解决方案。</div>\n\n在《Head First 设计模式》一书中有讲到：\n\n> Publishers + Subscribers = Observer pattern\n\n但 **发布订阅** 和 **观察者模式** 真的是完全相同的吗？\n\n<hr />\n\n## Observer Pattern\n\n### 定义\n\n所谓观察者模式，其实就是为了实现 **松耦合**(loosely coupled)。\n\n观察者模式定义了对象间的一种 **一对多** 的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知，并自动更新。\n\n观察者模式属于 **行为型模式**，行为型模式关注的是对象之间的通讯，观察者模式就是观察者和被观察者之间的通讯。\n\n<img src=\"ObserverPattern.png\" alt=\"Observer design pattern\" />\n\n### 实现\n\n被观察者（Subject，或者叫 Observable），它只需维护一套观察者（Observer）的集合，这些 Observer 实现相同的接口，Subject 只需要知道，通知 Observer 时，需要调用哪个统一方法就好了：\n\n```javascript\nclass User {\n    constructor(name) {\n        this.name = name;\n        this.subscriberlList = []; // 每个人都可能会有其订阅者\n    }\n\n    publish(rewards) {\n        console.log(`${this.name} 用户发布了价值为 ${rewards} 的物品！`);\n        this.subscriberlList.forEach(value => value(rewards)); \n        // 逐个调用发布者的订阅列表中，与订阅者约定好的的通知方法\n    }\n\n    subscribe(subject, callback) {\n        console.log(`${this.name} 用户订阅了 ${subject.name}！`);\n        subject.subscriberlList.push(callback); // 送入被订阅者的订阅列表中\n    }\n}\n```\n\n现在有四个用户 *wang*, *li*, *zhang*, *sun*，*wang* 手中即将新进一批货物，其余三人则 *订阅* 了 *wang*，当其发布了新物品时需要通知到这三个人：\n\n```javascript\nlet wang = new User('wang');\nlet li = new User('li');\nlet zhang = new User('zhang');\nlet sun = new User('sun');\n\nli.subscribe(wang, rewards => {\n    console.log(`li ${rewards > 100 ? '觉得太贵了，不' : ''}决定购买这件物品！`);\n});\n\nzhang.subscribe(wang, rewards => {\n    console.log(`zhang ${rewards > 50 ? '觉得太贵了，不' : ''}决定购买这件物品！`);\n});\n\nsun.subscribe(wang, rewards => {\n    console.log(`sun ${rewards > 25 ? '觉得太贵了，不' : ''}决定购买这件物品！`);\n});\n\nwang.publish(75); // 最后，wang 发布一个消息，其即将会通知到所有已订阅的人\n```\n\n```txt\nli 用户订阅了 wang！\nzhang 用户订阅了 wang！\nsun 用户订阅了 wang！\nwang 用户发布了价值为 75 的物品！\nli 决定购买这件物品！\nzhang 觉得太贵了，不决定购买这件物品！\nsun 觉得太贵了，不决定购买这件物品！\n```\n\n从这里我们可以看出来，发布者会直接主动通知其订阅者，即双方互相“认识”。\n\n### 观察者模式的优缺点\n\n<div class=\"note success\">\n    <p>1、具体主题和具体观察者是 <b>松耦合</b> 关系。由于主题接口仅仅依赖于观察者接口，因此具体主题只是知道它的观察者是实现观察者接口的某个类的实例，但不需要知道具体是哪个类。同样，由于观察者仅仅依赖于主题接口，因此具体观察者只是知道它依赖的主题是实现主题接口的某个类的实例，但不需要知道具体是哪个类。</p>\n    <p>2、观察者模式满足 <b>“开-闭原则”</b>。主题接口仅仅依赖于观察者接口，这样，就可以让创建具体主题的类也仅仅是依赖于观察者接口，因此，如果增加新的实现观察者接口的类，不必修改创建具体主题的类的代码。。同样，创建具体观察者的类仅仅依赖于主题接口，如果增加新的实现主题接口的类，也不必修改创建具体观察者类的代码。</p>\n</div>\n\n<div class=\"note danger\">\n    <p>1、如果一个被观察者对象有很多的直接和间接的观察者的话，将所有的观察者 <b>都通知到会花费很多时间</b>。</p>\n    <p>2、如果在观察者和观察目标之间有循环依赖的话，观察目标 <b>会触发它们之间进行循环调用</b>，可能导致系统崩溃。</p>\n    <p>3、观察者模式没有相应的机制让观察者知道所观察的目标对象是怎么发生变化的，而仅仅只是知道观察目标发生了变化。</p>\n</div>\n\n<hr />\n\n## Pub-Sub Pattern\n\n### 定义\n\n在 *Pub-Sub Pattern* 中，发布者，并不会直接通知订阅者，换句话说，发布者和订阅者，彼此互不相识。\n\n<div class=\"note info\">In ‘Publisher-Subscriber’ pattern, senders of messages, called <b>publishers</b>, do not program the messages to be sent directly to specific receivers, called <b>subscribers</b>.</div>\n\n既然这意味着发布者和订阅者互相不知道彼此的存在，那么就需要第三个组件，其被称为 **代理**（消息代理、事件总线）。发布者和订阅者都知道它，它过滤所有传入的消息并相应地分发它们。\n\n换句话说，**Pub-Sub** 是一种模式，用于在不同的系统组件之间传递消息，而这些组件之间不了解彼此的身份，如果有兴趣了解更多请戳蓝链 => <a href=\"https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern#Message_filtering\">维基百科对此已经进行了很好的解释</a>。\n\n<img src=\"./PubSubPattern.gif\" alt=\"Pub-Sub Pattern\" />\n\n现在让我们再来对比一下观察者模式和发布订阅的主要区别：\n\n<img src=\"vs.jpeg\" alt=\"观察者模式 vs 发布订阅\" />\n\n大致总结一下就是：\n\n- 在 **观察者** 模式中，**观察者知道主题**，**主题也维护观察者的记录**。而在 **发布订阅** 中，发布者和订阅者 **不需要彼此了解**。他们只是在消息队列或代理的帮助下进行通信。\n- 在 **发布订阅** 模式中，与 **观察者** 模式相反，组件是松散耦合的。\n- **观察者** 模式主要以 **同步** 方式实现，即，当某个事件发生时，Subject 调用其所有观察者的适当方法。而 **发布订阅** 通常使用的是 **消息队列** 去维护。\n- **观察者** 模式需要在单个应用程序地址空间中实现。**发布订阅** 更多地是跨应用程序模式.\n\n尽管这些模式之间存在差异，但有些人可能会说 **Publisher-Subscriber** 是 **Observer** 模式的变体，因为它们之间在概念上相似。而且这根本没有错。无需认真对待差异。\n\n- 如果以结构来分辨模式，发布订阅模式相比观察者模式多了一个中间件订阅器，所以发布订阅模式是不同于观察者模式的；\n- 如果以意图来分辨模式，他们都是 **实现了对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知，并自动更新**，那么他们就是同一种模式，发布订阅模式是在观察者模式的基础上做的优化升级。\n\n<div class=\"note success\"><b>分辨模式的关键是意图而不是结构</b> --- 《JavaScript设计模式与开发实践》</div>\n\n### 实现\n\n在观察者模式的实现背景中，增加一个中介者（Broker）：\n\n```javascript\nclass Broker {\n    constructor(name) {\n        this.name = name;\n        this.topicsList = [];\n    }\n\n    publish(topic, rewards, publisher) {\n        if (!this.topicsList[topic]) {\n            return 'No subscribers'; // 对于 target 事件没有任何的订阅者\n        }\n        this.topicsList[topic].forEach(value => value(rewards, publisher));\n        // 由 Broker 去通知订阅 topic 的订阅者\n    }\n\n    subscribe(topic, callback) {\n        if (!this.topicsList[topic]) {\n            this.topicsList[topic] = []; // 如果这个事件是全新的，就去对这个事件维护一个序列\n        }\n        this.topicsList[topic].push(callback);\n    }\n\n    letsSomebodyJoin(...users) {\n        users.forEach(value => {\n            console.log(`用户 ${value.name} 加入了 ${this.name}！`);\n            value.brokersList.push(this);\n        });\n    }\n}\n```\n\n对于 User 类的定义，只需要稍做一些改动：\n\n```javascript\nclass User {\n    constructor(name) {\n        this.name = name;\n        this.brokersList = [];\n    }\n\n    subscribe(topic, callback) {\n        this.brokersList.forEach(value => {\n            console.log(`用户 ${this.name} 在 ${value.name} 中介里订阅了 ${topic}！`);\n            value.subscribe(topic, callback); // 对于当前订阅者所在的 Broker 中去订阅 topic\n        });\n    }\n\n    publish(topic, rewards) {\n        this.brokersList.forEach(value => {\n            console.log(`用户 ${this.name} 向 ${value.name} 发布了价值为 ${rewards} 的 ${topic}！`);\n            value.publish(topic, rewards, this); // 对于当前订阅者所在的 Broker 中去发布 topic\n        });\n    }\n}\n```\n\nClient:\n\n```javascript\nlet broker = new Broker('Broker');\n\nlet wang = new User('wang');\nlet li = new User('li');\nlet zhang = new User('zhang');\nlet sun = new User('sun');\n\nbroker.letsSomebodyJoin(wang, li, zhang, sun);\n\nli.subscribe('窝窝头', (rewards, publisher) => {\n    console.log(`li ${rewards > 100 ? '觉得太贵了，不' : ''}决定购买 ${publisher.name} 发布的窝窝头！`);\n});\n\nzhang.subscribe('窝窝头', (rewards, publisher) => {\n    console.log(`zhang ${rewards > 50 ? '觉得太贵了，不' : ''}决定购买 ${publisher.name} 发布的窝窝头！`);\n});\n\nsun.subscribe('窝窝头', (rewards, publisher) => {\n    console.log(`sun ${rewards > 25 ? '觉得太贵了，不' : ''}决定购买 ${publisher.name} 发布的窝窝头！`);\n});\n\nwang.publish('窝窝头', 35);\n```\n\n*wang* 发布了 35 价值的窝窝头，可以预想的到是 *sun* 没有购买：\n\n```txt\n用户 wang 加入了 Broker！\n用户 li 加入了 Broker！\n用户 zhang 加入了 Broker！\n用户 sun 加入了 Broker！\n用户 li 在 Broker 中介里订阅了 窝窝头！\n用户 zhang 在 Broker 中介里订阅了 窝窝头！\n用户 sun 在 Broker 中介里订阅了 窝窝头！\n用户 wang 向 Broker 发布了价值为 35 的 窝窝头！\nli 决定购买 wang 发布的窝窝头！\nzhang 决定购买 wang 发布的窝窝头！\nsun 觉得太贵了，不决定购买 wang 发布的窝窝头！\n```\n\n### 发布订阅的优缺点\n\n<div class=\"note success\">\n    <p>1. <b>松耦合</b>：发布者与订阅者松耦合，<b>甚至不需要知道它们的存在</b>。由于 <b>主题才是关注的焦点</b>，发布者和订阅者可以对系统拓扑结构保持一无所知。各自继续正常操作而无需顾及对方。在传统的紧耦合的客户端-服务器模式中，当服务器进程不运行时，客户端无法发送消息给服务器，服务器也无法在客户端不运行时接收消息。许多发布/订阅系统不但将发布者和订阅者 <b>从位置上解耦</b>，还 <b>从时间上解耦</b> 他们。中间件分析师对这种发布/订阅使用的常用策略，是拆卸一个发布者来让订阅者处理完积压的工作（带宽限制的一种形式）。</p>\n    <p>2. <b>可扩展性</b>：通过并行操作，消息缓存，基于树或基于网络的路由等技术，<b>发布/订阅提供了比传统的客户端–服务器更好的可扩展性</b>。然而，在某些类型的紧耦合、高容量的企业环境中，随着系统规模上升到由上千台服务器组成的数据中心所共享的发布/订阅基础架构，现有的供应商系统经常失去这项好处；在这些高负载环境下，发布/订阅产品的扩展性是一个研究课题。</p>\n    <p>另一方面，在企业环境之外，发布/订阅范式已经证明了它的可扩展性远超过一个单一的数据中心，通过网络聚合协议如 <a href=\"https://baike.baidu.com/item/RSS/24470\">RSS</a> 和 <a href=\"https://baike.baidu.com/item/atom/353868#viewPageContent\">Atom</a> 提供互联网范围内分发的消息。在交互时，为了能够即便是用低档Web服务器也能将消息播出到(可能)数以百万计的独立用户节点，这些聚合协议接受更高的延迟和无保障交付。</p>\n</div>\n\n<div class=\"note danger\">\n    <p>发布/订阅系统最严重的问题是 <b>其主要优点的副作用：发布者解耦订阅者</b>。</p>\n    <p>消息交付问题：发布/订阅系统必须仔细设计，才能提供特定的应用程序可能需要的更强大的系统性能，例如有保障的交付。</p>\n    <ul>\n        <li>发布/订阅系统的中介（broker）可能设计为在指定时间发送消息，随后便停止尝试发送，无论是否已收到所有用户成功接收消息的确认回复。这样设计的发布/订阅系统 <b>不能保证消息能够传递到所有需要这种有保障交付的应用程序</b>。要达成有保障交付，必须在发布/订阅架构之外强制执行这种发布者和订阅者之间在设计上更紧密的耦合（例如，通过要求订阅者宣布消息已接收）。</li>\n        <li>发布/订阅系统中的 <b>发布者会“假定”订阅者正在监听</b>，而实际上可能没有。一个工厂可能会使用发布/订阅系统来允许设备发布问题和故障，订阅者将问题显示并记录。<b>如果记录器失败（崩溃了），那么设备故障发布者不一定收到记录器失败的通知，发布/订阅系统的任何设备都不会显示和记录错误消息</b>。</li>\n    </ul>\n    <p>在有少量发布者和订阅节点的小型网络和低信息量时发布/订阅能够自如伸缩。然而，随着节点和消息量的增长，不稳定性随之增长，限制了发布/订阅网络的最大可扩展性。大规模时吞吐量不稳定的例子包括：</p>\n    <ul>\n        <li><b>负载激增</b> - 订阅请求使网络流量饱和，随后进入低信息量（未充分利用网络带宽）</li>\n        <li><b>速度变慢</b> - 越来越多的应用程序使用该系统（即使它们是在不同的发布/订阅频道通信）消息量流入单个订阅者的速度缓慢</li>\n    </ul>\n</div>\n\n<hr />\n\n## 参考资料\n\n- [Observer vs Pub-Sub pattern](https://hackernoon.com/observer-vs-pub-sub-pattern-50d3b27f838c)\n- [Publish–subscribe pattern](https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern#Message_filtering)\n- [观察者模式 vs 发布订阅模式](https://zhuanlan.zhihu.com/p/51357583)\n- [Javascript中理解发布--订阅模式](https://www.cnblogs.com/itgezhu/p/10947405.html)\n- [观察者和发布订阅模式的区别](https://www.cnblogs.com/viaiu/p/9939301.html)\n- [发布订阅模式与观察者模式](https://blog.csdn.net/hf872914334/article/details/88899326)","source":"_posts/JavaScript观察者模式与发布订阅.md","raw":"---\ntitle: JavaScript观察者模式与发布订阅\ndate: 2020-01-14 19:55:10\nupdated: 2020-01-18 16:25:07\ntags:\n- Web\n- JavaScript\n- 设计模式\ncategories:\n- 前端\n- 面经\n- JavaScript\n- 设计模式\ncopyright: true\n---\n\n> <span class = 'introduction'>青少年是一个美好而又是一去不可再得的时期，是将来一切光明和幸福的开端。</span><br/>\n如果面试官问到你：“What is the difference between the Observer pattern and Pub-Sub pattern?”，你该怎么回答呢？\n\n<!--more-->\n\n<hr/>\n\n## 背景\n\n<div class=\"note info\">设计模式是在面向对象软件设计过程中针对特定问题的简洁而优雅的解决方案。</div>\n\n在《Head First 设计模式》一书中有讲到：\n\n> Publishers + Subscribers = Observer pattern\n\n但 **发布订阅** 和 **观察者模式** 真的是完全相同的吗？\n\n<hr />\n\n## Observer Pattern\n\n### 定义\n\n所谓观察者模式，其实就是为了实现 **松耦合**(loosely coupled)。\n\n观察者模式定义了对象间的一种 **一对多** 的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知，并自动更新。\n\n观察者模式属于 **行为型模式**，行为型模式关注的是对象之间的通讯，观察者模式就是观察者和被观察者之间的通讯。\n\n<img src=\"ObserverPattern.png\" alt=\"Observer design pattern\" />\n\n### 实现\n\n被观察者（Subject，或者叫 Observable），它只需维护一套观察者（Observer）的集合，这些 Observer 实现相同的接口，Subject 只需要知道，通知 Observer 时，需要调用哪个统一方法就好了：\n\n```javascript\nclass User {\n    constructor(name) {\n        this.name = name;\n        this.subscriberlList = []; // 每个人都可能会有其订阅者\n    }\n\n    publish(rewards) {\n        console.log(`${this.name} 用户发布了价值为 ${rewards} 的物品！`);\n        this.subscriberlList.forEach(value => value(rewards)); \n        // 逐个调用发布者的订阅列表中，与订阅者约定好的的通知方法\n    }\n\n    subscribe(subject, callback) {\n        console.log(`${this.name} 用户订阅了 ${subject.name}！`);\n        subject.subscriberlList.push(callback); // 送入被订阅者的订阅列表中\n    }\n}\n```\n\n现在有四个用户 *wang*, *li*, *zhang*, *sun*，*wang* 手中即将新进一批货物，其余三人则 *订阅* 了 *wang*，当其发布了新物品时需要通知到这三个人：\n\n```javascript\nlet wang = new User('wang');\nlet li = new User('li');\nlet zhang = new User('zhang');\nlet sun = new User('sun');\n\nli.subscribe(wang, rewards => {\n    console.log(`li ${rewards > 100 ? '觉得太贵了，不' : ''}决定购买这件物品！`);\n});\n\nzhang.subscribe(wang, rewards => {\n    console.log(`zhang ${rewards > 50 ? '觉得太贵了，不' : ''}决定购买这件物品！`);\n});\n\nsun.subscribe(wang, rewards => {\n    console.log(`sun ${rewards > 25 ? '觉得太贵了，不' : ''}决定购买这件物品！`);\n});\n\nwang.publish(75); // 最后，wang 发布一个消息，其即将会通知到所有已订阅的人\n```\n\n```txt\nli 用户订阅了 wang！\nzhang 用户订阅了 wang！\nsun 用户订阅了 wang！\nwang 用户发布了价值为 75 的物品！\nli 决定购买这件物品！\nzhang 觉得太贵了，不决定购买这件物品！\nsun 觉得太贵了，不决定购买这件物品！\n```\n\n从这里我们可以看出来，发布者会直接主动通知其订阅者，即双方互相“认识”。\n\n### 观察者模式的优缺点\n\n<div class=\"note success\">\n    <p>1、具体主题和具体观察者是 <b>松耦合</b> 关系。由于主题接口仅仅依赖于观察者接口，因此具体主题只是知道它的观察者是实现观察者接口的某个类的实例，但不需要知道具体是哪个类。同样，由于观察者仅仅依赖于主题接口，因此具体观察者只是知道它依赖的主题是实现主题接口的某个类的实例，但不需要知道具体是哪个类。</p>\n    <p>2、观察者模式满足 <b>“开-闭原则”</b>。主题接口仅仅依赖于观察者接口，这样，就可以让创建具体主题的类也仅仅是依赖于观察者接口，因此，如果增加新的实现观察者接口的类，不必修改创建具体主题的类的代码。。同样，创建具体观察者的类仅仅依赖于主题接口，如果增加新的实现主题接口的类，也不必修改创建具体观察者类的代码。</p>\n</div>\n\n<div class=\"note danger\">\n    <p>1、如果一个被观察者对象有很多的直接和间接的观察者的话，将所有的观察者 <b>都通知到会花费很多时间</b>。</p>\n    <p>2、如果在观察者和观察目标之间有循环依赖的话，观察目标 <b>会触发它们之间进行循环调用</b>，可能导致系统崩溃。</p>\n    <p>3、观察者模式没有相应的机制让观察者知道所观察的目标对象是怎么发生变化的，而仅仅只是知道观察目标发生了变化。</p>\n</div>\n\n<hr />\n\n## Pub-Sub Pattern\n\n### 定义\n\n在 *Pub-Sub Pattern* 中，发布者，并不会直接通知订阅者，换句话说，发布者和订阅者，彼此互不相识。\n\n<div class=\"note info\">In ‘Publisher-Subscriber’ pattern, senders of messages, called <b>publishers</b>, do not program the messages to be sent directly to specific receivers, called <b>subscribers</b>.</div>\n\n既然这意味着发布者和订阅者互相不知道彼此的存在，那么就需要第三个组件，其被称为 **代理**（消息代理、事件总线）。发布者和订阅者都知道它，它过滤所有传入的消息并相应地分发它们。\n\n换句话说，**Pub-Sub** 是一种模式，用于在不同的系统组件之间传递消息，而这些组件之间不了解彼此的身份，如果有兴趣了解更多请戳蓝链 => <a href=\"https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern#Message_filtering\">维基百科对此已经进行了很好的解释</a>。\n\n<img src=\"./PubSubPattern.gif\" alt=\"Pub-Sub Pattern\" />\n\n现在让我们再来对比一下观察者模式和发布订阅的主要区别：\n\n<img src=\"vs.jpeg\" alt=\"观察者模式 vs 发布订阅\" />\n\n大致总结一下就是：\n\n- 在 **观察者** 模式中，**观察者知道主题**，**主题也维护观察者的记录**。而在 **发布订阅** 中，发布者和订阅者 **不需要彼此了解**。他们只是在消息队列或代理的帮助下进行通信。\n- 在 **发布订阅** 模式中，与 **观察者** 模式相反，组件是松散耦合的。\n- **观察者** 模式主要以 **同步** 方式实现，即，当某个事件发生时，Subject 调用其所有观察者的适当方法。而 **发布订阅** 通常使用的是 **消息队列** 去维护。\n- **观察者** 模式需要在单个应用程序地址空间中实现。**发布订阅** 更多地是跨应用程序模式.\n\n尽管这些模式之间存在差异，但有些人可能会说 **Publisher-Subscriber** 是 **Observer** 模式的变体，因为它们之间在概念上相似。而且这根本没有错。无需认真对待差异。\n\n- 如果以结构来分辨模式，发布订阅模式相比观察者模式多了一个中间件订阅器，所以发布订阅模式是不同于观察者模式的；\n- 如果以意图来分辨模式，他们都是 **实现了对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知，并自动更新**，那么他们就是同一种模式，发布订阅模式是在观察者模式的基础上做的优化升级。\n\n<div class=\"note success\"><b>分辨模式的关键是意图而不是结构</b> --- 《JavaScript设计模式与开发实践》</div>\n\n### 实现\n\n在观察者模式的实现背景中，增加一个中介者（Broker）：\n\n```javascript\nclass Broker {\n    constructor(name) {\n        this.name = name;\n        this.topicsList = [];\n    }\n\n    publish(topic, rewards, publisher) {\n        if (!this.topicsList[topic]) {\n            return 'No subscribers'; // 对于 target 事件没有任何的订阅者\n        }\n        this.topicsList[topic].forEach(value => value(rewards, publisher));\n        // 由 Broker 去通知订阅 topic 的订阅者\n    }\n\n    subscribe(topic, callback) {\n        if (!this.topicsList[topic]) {\n            this.topicsList[topic] = []; // 如果这个事件是全新的，就去对这个事件维护一个序列\n        }\n        this.topicsList[topic].push(callback);\n    }\n\n    letsSomebodyJoin(...users) {\n        users.forEach(value => {\n            console.log(`用户 ${value.name} 加入了 ${this.name}！`);\n            value.brokersList.push(this);\n        });\n    }\n}\n```\n\n对于 User 类的定义，只需要稍做一些改动：\n\n```javascript\nclass User {\n    constructor(name) {\n        this.name = name;\n        this.brokersList = [];\n    }\n\n    subscribe(topic, callback) {\n        this.brokersList.forEach(value => {\n            console.log(`用户 ${this.name} 在 ${value.name} 中介里订阅了 ${topic}！`);\n            value.subscribe(topic, callback); // 对于当前订阅者所在的 Broker 中去订阅 topic\n        });\n    }\n\n    publish(topic, rewards) {\n        this.brokersList.forEach(value => {\n            console.log(`用户 ${this.name} 向 ${value.name} 发布了价值为 ${rewards} 的 ${topic}！`);\n            value.publish(topic, rewards, this); // 对于当前订阅者所在的 Broker 中去发布 topic\n        });\n    }\n}\n```\n\nClient:\n\n```javascript\nlet broker = new Broker('Broker');\n\nlet wang = new User('wang');\nlet li = new User('li');\nlet zhang = new User('zhang');\nlet sun = new User('sun');\n\nbroker.letsSomebodyJoin(wang, li, zhang, sun);\n\nli.subscribe('窝窝头', (rewards, publisher) => {\n    console.log(`li ${rewards > 100 ? '觉得太贵了，不' : ''}决定购买 ${publisher.name} 发布的窝窝头！`);\n});\n\nzhang.subscribe('窝窝头', (rewards, publisher) => {\n    console.log(`zhang ${rewards > 50 ? '觉得太贵了，不' : ''}决定购买 ${publisher.name} 发布的窝窝头！`);\n});\n\nsun.subscribe('窝窝头', (rewards, publisher) => {\n    console.log(`sun ${rewards > 25 ? '觉得太贵了，不' : ''}决定购买 ${publisher.name} 发布的窝窝头！`);\n});\n\nwang.publish('窝窝头', 35);\n```\n\n*wang* 发布了 35 价值的窝窝头，可以预想的到是 *sun* 没有购买：\n\n```txt\n用户 wang 加入了 Broker！\n用户 li 加入了 Broker！\n用户 zhang 加入了 Broker！\n用户 sun 加入了 Broker！\n用户 li 在 Broker 中介里订阅了 窝窝头！\n用户 zhang 在 Broker 中介里订阅了 窝窝头！\n用户 sun 在 Broker 中介里订阅了 窝窝头！\n用户 wang 向 Broker 发布了价值为 35 的 窝窝头！\nli 决定购买 wang 发布的窝窝头！\nzhang 决定购买 wang 发布的窝窝头！\nsun 觉得太贵了，不决定购买 wang 发布的窝窝头！\n```\n\n### 发布订阅的优缺点\n\n<div class=\"note success\">\n    <p>1. <b>松耦合</b>：发布者与订阅者松耦合，<b>甚至不需要知道它们的存在</b>。由于 <b>主题才是关注的焦点</b>，发布者和订阅者可以对系统拓扑结构保持一无所知。各自继续正常操作而无需顾及对方。在传统的紧耦合的客户端-服务器模式中，当服务器进程不运行时，客户端无法发送消息给服务器，服务器也无法在客户端不运行时接收消息。许多发布/订阅系统不但将发布者和订阅者 <b>从位置上解耦</b>，还 <b>从时间上解耦</b> 他们。中间件分析师对这种发布/订阅使用的常用策略，是拆卸一个发布者来让订阅者处理完积压的工作（带宽限制的一种形式）。</p>\n    <p>2. <b>可扩展性</b>：通过并行操作，消息缓存，基于树或基于网络的路由等技术，<b>发布/订阅提供了比传统的客户端–服务器更好的可扩展性</b>。然而，在某些类型的紧耦合、高容量的企业环境中，随着系统规模上升到由上千台服务器组成的数据中心所共享的发布/订阅基础架构，现有的供应商系统经常失去这项好处；在这些高负载环境下，发布/订阅产品的扩展性是一个研究课题。</p>\n    <p>另一方面，在企业环境之外，发布/订阅范式已经证明了它的可扩展性远超过一个单一的数据中心，通过网络聚合协议如 <a href=\"https://baike.baidu.com/item/RSS/24470\">RSS</a> 和 <a href=\"https://baike.baidu.com/item/atom/353868#viewPageContent\">Atom</a> 提供互联网范围内分发的消息。在交互时，为了能够即便是用低档Web服务器也能将消息播出到(可能)数以百万计的独立用户节点，这些聚合协议接受更高的延迟和无保障交付。</p>\n</div>\n\n<div class=\"note danger\">\n    <p>发布/订阅系统最严重的问题是 <b>其主要优点的副作用：发布者解耦订阅者</b>。</p>\n    <p>消息交付问题：发布/订阅系统必须仔细设计，才能提供特定的应用程序可能需要的更强大的系统性能，例如有保障的交付。</p>\n    <ul>\n        <li>发布/订阅系统的中介（broker）可能设计为在指定时间发送消息，随后便停止尝试发送，无论是否已收到所有用户成功接收消息的确认回复。这样设计的发布/订阅系统 <b>不能保证消息能够传递到所有需要这种有保障交付的应用程序</b>。要达成有保障交付，必须在发布/订阅架构之外强制执行这种发布者和订阅者之间在设计上更紧密的耦合（例如，通过要求订阅者宣布消息已接收）。</li>\n        <li>发布/订阅系统中的 <b>发布者会“假定”订阅者正在监听</b>，而实际上可能没有。一个工厂可能会使用发布/订阅系统来允许设备发布问题和故障，订阅者将问题显示并记录。<b>如果记录器失败（崩溃了），那么设备故障发布者不一定收到记录器失败的通知，发布/订阅系统的任何设备都不会显示和记录错误消息</b>。</li>\n    </ul>\n    <p>在有少量发布者和订阅节点的小型网络和低信息量时发布/订阅能够自如伸缩。然而，随着节点和消息量的增长，不稳定性随之增长，限制了发布/订阅网络的最大可扩展性。大规模时吞吐量不稳定的例子包括：</p>\n    <ul>\n        <li><b>负载激增</b> - 订阅请求使网络流量饱和，随后进入低信息量（未充分利用网络带宽）</li>\n        <li><b>速度变慢</b> - 越来越多的应用程序使用该系统（即使它们是在不同的发布/订阅频道通信）消息量流入单个订阅者的速度缓慢</li>\n    </ul>\n</div>\n\n<hr />\n\n## 参考资料\n\n- [Observer vs Pub-Sub pattern](https://hackernoon.com/observer-vs-pub-sub-pattern-50d3b27f838c)\n- [Publish–subscribe pattern](https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern#Message_filtering)\n- [观察者模式 vs 发布订阅模式](https://zhuanlan.zhihu.com/p/51357583)\n- [Javascript中理解发布--订阅模式](https://www.cnblogs.com/itgezhu/p/10947405.html)\n- [观察者和发布订阅模式的区别](https://www.cnblogs.com/viaiu/p/9939301.html)\n- [发布订阅模式与观察者模式](https://blog.csdn.net/hf872914334/article/details/88899326)","slug":"JavaScript观察者模式与发布订阅","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn5u000k2lwjev7necfz","content":"<blockquote>\n<p><span class=\"introduction\">青少年是一个美好而又是一去不可再得的时期，是将来一切光明和幸福的开端。</span><br><br>如果面试官问到你：“What is the difference between the Observer pattern and Pub-Sub pattern?”，你该怎么回答呢？</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><div class=\"note info\">设计模式是在面向对象软件设计过程中针对特定问题的简洁而优雅的解决方案。</div>\n\n<p>在《Head First 设计模式》一书中有讲到：</p>\n<blockquote>\n<p>Publishers + Subscribers = Observer pattern</p>\n</blockquote>\n<p>但 <strong>发布订阅</strong> 和 <strong>观察者模式</strong> 真的是完全相同的吗？</p>\n<hr>\n\n<h2 id=\"Observer-Pattern\"><a href=\"#Observer-Pattern\" class=\"headerlink\" title=\"Observer Pattern\"></a>Observer Pattern</h2><h3 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>所谓观察者模式，其实就是为了实现 <strong>松耦合</strong>(loosely coupled)。</p>\n<p>观察者模式定义了对象间的一种 <strong>一对多</strong> 的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知，并自动更新。</p>\n<p>观察者模式属于 <strong>行为型模式</strong>，行为型模式关注的是对象之间的通讯，观察者模式就是观察者和被观察者之间的通讯。</p>\n<img src=\"/2020/01/14/JavaScript%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/ObserverPattern.png\" alt=\"Observer design pattern\">\n\n<h3 id=\"实现\"><a href=\"#实现\" class=\"headerlink\" title=\"实现\"></a>实现</h3><p>被观察者（Subject，或者叫 Observable），它只需维护一套观察者（Observer）的集合，这些 Observer 实现相同的接口，Subject 只需要知道，通知 Observer 时，需要调用哪个统一方法就好了：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(name) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.subscriberlList = []; <span class=\"comment\">// 每个人都可能会有其订阅者</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    publish(rewards) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span> 用户发布了价值为 <span class=\"subst\">$&#123;rewards&#125;</span> 的物品！`</span>);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.subscriberlList.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value(rewards)); </span><br><span class=\"line\">        <span class=\"comment\">// 逐个调用发布者的订阅列表中，与订阅者约定好的的通知方法</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    subscribe(subject, callback) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span> 用户订阅了 <span class=\"subst\">$&#123;subject.name&#125;</span>！`</span>);</span><br><span class=\"line\">        subject.subscriberlList.push(callback); <span class=\"comment\">// 送入被订阅者的订阅列表中</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>现在有四个用户 <em>wang</em>, <em>li</em>, <em>zhang</em>, <em>sun<em>，</em>wang</em> 手中即将新进一批货物，其余三人则 <em>订阅</em> 了 <em>wang</em>，当其发布了新物品时需要通知到这三个人：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> wang = <span class=\"keyword\">new</span> User(<span class=\"string\">'wang'</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> li = <span class=\"keyword\">new</span> User(<span class=\"string\">'li'</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> zhang = <span class=\"keyword\">new</span> User(<span class=\"string\">'zhang'</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> sun = <span class=\"keyword\">new</span> User(<span class=\"string\">'sun'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">li.subscribe(wang, rewards =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`li <span class=\"subst\">$&#123;rewards &gt; <span class=\"number\">100</span> ? <span class=\"string\">'觉得太贵了，不'</span> : <span class=\"string\">''</span>&#125;</span>决定购买这件物品！`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">zhang.subscribe(wang, rewards =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`zhang <span class=\"subst\">$&#123;rewards &gt; <span class=\"number\">50</span> ? <span class=\"string\">'觉得太贵了，不'</span> : <span class=\"string\">''</span>&#125;</span>决定购买这件物品！`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">sun.subscribe(wang, rewards =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`sun <span class=\"subst\">$&#123;rewards &gt; <span class=\"number\">25</span> ? <span class=\"string\">'觉得太贵了，不'</span> : <span class=\"string\">''</span>&#125;</span>决定购买这件物品！`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">wang.publish(<span class=\"number\">75</span>); <span class=\"comment\">// 最后，wang 发布一个消息，其即将会通知到所有已订阅的人</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">li 用户订阅了 wang！</span><br><span class=\"line\">zhang 用户订阅了 wang！</span><br><span class=\"line\">sun 用户订阅了 wang！</span><br><span class=\"line\">wang 用户发布了价值为 75 的物品！</span><br><span class=\"line\">li 决定购买这件物品！</span><br><span class=\"line\">zhang 觉得太贵了，不决定购买这件物品！</span><br><span class=\"line\">sun 觉得太贵了，不决定购买这件物品！</span><br></pre></td></tr></table></figure>\n\n<p>从这里我们可以看出来，发布者会直接主动通知其订阅者，即双方互相“认识”。</p>\n<h3 id=\"观察者模式的优缺点\"><a href=\"#观察者模式的优缺点\" class=\"headerlink\" title=\"观察者模式的优缺点\"></a>观察者模式的优缺点</h3><div class=\"note success\">\n    <p>1、具体主题和具体观察者是 <b>松耦合</b> 关系。由于主题接口仅仅依赖于观察者接口，因此具体主题只是知道它的观察者是实现观察者接口的某个类的实例，但不需要知道具体是哪个类。同样，由于观察者仅仅依赖于主题接口，因此具体观察者只是知道它依赖的主题是实现主题接口的某个类的实例，但不需要知道具体是哪个类。</p>\n    <p>2、观察者模式满足 <b>“开-闭原则”</b>。主题接口仅仅依赖于观察者接口，这样，就可以让创建具体主题的类也仅仅是依赖于观察者接口，因此，如果增加新的实现观察者接口的类，不必修改创建具体主题的类的代码。。同样，创建具体观察者的类仅仅依赖于主题接口，如果增加新的实现主题接口的类，也不必修改创建具体观察者类的代码。</p>\n</div>\n\n<div class=\"note danger\">\n    <p>1、如果一个被观察者对象有很多的直接和间接的观察者的话，将所有的观察者 <b>都通知到会花费很多时间</b>。</p>\n    <p>2、如果在观察者和观察目标之间有循环依赖的话，观察目标 <b>会触发它们之间进行循环调用</b>，可能导致系统崩溃。</p>\n    <p>3、观察者模式没有相应的机制让观察者知道所观察的目标对象是怎么发生变化的，而仅仅只是知道观察目标发生了变化。</p>\n</div>\n\n<hr>\n\n<h2 id=\"Pub-Sub-Pattern\"><a href=\"#Pub-Sub-Pattern\" class=\"headerlink\" title=\"Pub-Sub Pattern\"></a>Pub-Sub Pattern</h2><h3 id=\"定义-1\"><a href=\"#定义-1\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>在 <em>Pub-Sub Pattern</em> 中，发布者，并不会直接通知订阅者，换句话说，发布者和订阅者，彼此互不相识。</p>\n<div class=\"note info\">In ‘Publisher-Subscriber’ pattern, senders of messages, called <b>publishers</b>, do not program the messages to be sent directly to specific receivers, called <b>subscribers</b>.</div>\n\n<p>既然这意味着发布者和订阅者互相不知道彼此的存在，那么就需要第三个组件，其被称为 <strong>代理</strong>（消息代理、事件总线）。发布者和订阅者都知道它，它过滤所有传入的消息并相应地分发它们。</p>\n<p>换句话说，<strong>Pub-Sub</strong> 是一种模式，用于在不同的系统组件之间传递消息，而这些组件之间不了解彼此的身份，如果有兴趣了解更多请戳蓝链 =&gt; <a href=\"https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern#Message_filtering\" target=\"_blank\" rel=\"noopener\">维基百科对此已经进行了很好的解释</a>。</p>\n<img src=\"/2020/01/14/JavaScript%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/PubSubPattern.gif\" alt=\"Pub-Sub Pattern\">\n\n<p>现在让我们再来对比一下观察者模式和发布订阅的主要区别：</p>\n<img src=\"/2020/01/14/JavaScript%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/vs.jpeg\" alt=\"观察者模式 vs 发布订阅\">\n\n<p>大致总结一下就是：</p>\n<ul>\n<li>在 <strong>观察者</strong> 模式中，<strong>观察者知道主题</strong>，<strong>主题也维护观察者的记录</strong>。而在 <strong>发布订阅</strong> 中，发布者和订阅者 <strong>不需要彼此了解</strong>。他们只是在消息队列或代理的帮助下进行通信。</li>\n<li>在 <strong>发布订阅</strong> 模式中，与 <strong>观察者</strong> 模式相反，组件是松散耦合的。</li>\n<li><strong>观察者</strong> 模式主要以 <strong>同步</strong> 方式实现，即，当某个事件发生时，Subject 调用其所有观察者的适当方法。而 <strong>发布订阅</strong> 通常使用的是 <strong>消息队列</strong> 去维护。</li>\n<li><strong>观察者</strong> 模式需要在单个应用程序地址空间中实现。<strong>发布订阅</strong> 更多地是跨应用程序模式.</li>\n</ul>\n<p>尽管这些模式之间存在差异，但有些人可能会说 <strong>Publisher-Subscriber</strong> 是 <strong>Observer</strong> 模式的变体，因为它们之间在概念上相似。而且这根本没有错。无需认真对待差异。</p>\n<ul>\n<li>如果以结构来分辨模式，发布订阅模式相比观察者模式多了一个中间件订阅器，所以发布订阅模式是不同于观察者模式的；</li>\n<li>如果以意图来分辨模式，他们都是 <strong>实现了对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知，并自动更新</strong>，那么他们就是同一种模式，发布订阅模式是在观察者模式的基础上做的优化升级。</li>\n</ul>\n<div class=\"note success\"><b>分辨模式的关键是意图而不是结构</b> --- 《JavaScript设计模式与开发实践》</div>\n\n<h3 id=\"实现-1\"><a href=\"#实现-1\" class=\"headerlink\" title=\"实现\"></a>实现</h3><p>在观察者模式的实现背景中，增加一个中介者（Broker）：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Broker</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(name) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.topicsList = [];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    publish(topic, rewards, publisher) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"keyword\">this</span>.topicsList[topic]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">'No subscribers'</span>; <span class=\"comment\">// 对于 target 事件没有任何的订阅者</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.topicsList[topic].forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value(rewards, publisher));</span><br><span class=\"line\">        <span class=\"comment\">// 由 Broker 去通知订阅 topic 的订阅者</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    subscribe(topic, callback) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"keyword\">this</span>.topicsList[topic]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.topicsList[topic] = []; <span class=\"comment\">// 如果这个事件是全新的，就去对这个事件维护一个序列</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.topicsList[topic].push(callback);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    letsSomebodyJoin(...users) &#123;</span><br><span class=\"line\">        users.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">`用户 <span class=\"subst\">$&#123;value.name&#125;</span> 加入了 <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>！`</span>);</span><br><span class=\"line\">            value.brokersList.push(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>对于 User 类的定义，只需要稍做一些改动：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(name) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.brokersList = [];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    subscribe(topic, callback) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.brokersList.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">`用户 <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span> 在 <span class=\"subst\">$&#123;value.name&#125;</span> 中介里订阅了 <span class=\"subst\">$&#123;topic&#125;</span>！`</span>);</span><br><span class=\"line\">            value.subscribe(topic, callback); <span class=\"comment\">// 对于当前订阅者所在的 Broker 中去订阅 topic</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    publish(topic, rewards) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.brokersList.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">`用户 <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span> 向 <span class=\"subst\">$&#123;value.name&#125;</span> 发布了价值为 <span class=\"subst\">$&#123;rewards&#125;</span> 的 <span class=\"subst\">$&#123;topic&#125;</span>！`</span>);</span><br><span class=\"line\">            value.publish(topic, rewards, <span class=\"keyword\">this</span>); <span class=\"comment\">// 对于当前订阅者所在的 Broker 中去发布 topic</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Client:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> broker = <span class=\"keyword\">new</span> Broker(<span class=\"string\">'Broker'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> wang = <span class=\"keyword\">new</span> User(<span class=\"string\">'wang'</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> li = <span class=\"keyword\">new</span> User(<span class=\"string\">'li'</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> zhang = <span class=\"keyword\">new</span> User(<span class=\"string\">'zhang'</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> sun = <span class=\"keyword\">new</span> User(<span class=\"string\">'sun'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">broker.letsSomebodyJoin(wang, li, zhang, sun);</span><br><span class=\"line\"></span><br><span class=\"line\">li.subscribe(<span class=\"string\">'窝窝头'</span>, (rewards, publisher) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`li <span class=\"subst\">$&#123;rewards &gt; <span class=\"number\">100</span> ? <span class=\"string\">'觉得太贵了，不'</span> : <span class=\"string\">''</span>&#125;</span>决定购买 <span class=\"subst\">$&#123;publisher.name&#125;</span> 发布的窝窝头！`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">zhang.subscribe(<span class=\"string\">'窝窝头'</span>, (rewards, publisher) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`zhang <span class=\"subst\">$&#123;rewards &gt; <span class=\"number\">50</span> ? <span class=\"string\">'觉得太贵了，不'</span> : <span class=\"string\">''</span>&#125;</span>决定购买 <span class=\"subst\">$&#123;publisher.name&#125;</span> 发布的窝窝头！`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">sun.subscribe(<span class=\"string\">'窝窝头'</span>, (rewards, publisher) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`sun <span class=\"subst\">$&#123;rewards &gt; <span class=\"number\">25</span> ? <span class=\"string\">'觉得太贵了，不'</span> : <span class=\"string\">''</span>&#125;</span>决定购买 <span class=\"subst\">$&#123;publisher.name&#125;</span> 发布的窝窝头！`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">wang.publish(<span class=\"string\">'窝窝头'</span>, <span class=\"number\">35</span>);</span><br></pre></td></tr></table></figure>\n\n<p><em>wang</em> 发布了 35 价值的窝窝头，可以预想的到是 <em>sun</em> 没有购买：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">用户 wang 加入了 Broker！</span><br><span class=\"line\">用户 li 加入了 Broker！</span><br><span class=\"line\">用户 zhang 加入了 Broker！</span><br><span class=\"line\">用户 sun 加入了 Broker！</span><br><span class=\"line\">用户 li 在 Broker 中介里订阅了 窝窝头！</span><br><span class=\"line\">用户 zhang 在 Broker 中介里订阅了 窝窝头！</span><br><span class=\"line\">用户 sun 在 Broker 中介里订阅了 窝窝头！</span><br><span class=\"line\">用户 wang 向 Broker 发布了价值为 35 的 窝窝头！</span><br><span class=\"line\">li 决定购买 wang 发布的窝窝头！</span><br><span class=\"line\">zhang 决定购买 wang 发布的窝窝头！</span><br><span class=\"line\">sun 觉得太贵了，不决定购买 wang 发布的窝窝头！</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"发布订阅的优缺点\"><a href=\"#发布订阅的优缺点\" class=\"headerlink\" title=\"发布订阅的优缺点\"></a>发布订阅的优缺点</h3><div class=\"note success\">\n    <p>1. <b>松耦合</b>：发布者与订阅者松耦合，<b>甚至不需要知道它们的存在</b>。由于 <b>主题才是关注的焦点</b>，发布者和订阅者可以对系统拓扑结构保持一无所知。各自继续正常操作而无需顾及对方。在传统的紧耦合的客户端-服务器模式中，当服务器进程不运行时，客户端无法发送消息给服务器，服务器也无法在客户端不运行时接收消息。许多发布/订阅系统不但将发布者和订阅者 <b>从位置上解耦</b>，还 <b>从时间上解耦</b> 他们。中间件分析师对这种发布/订阅使用的常用策略，是拆卸一个发布者来让订阅者处理完积压的工作（带宽限制的一种形式）。</p>\n    <p>2. <b>可扩展性</b>：通过并行操作，消息缓存，基于树或基于网络的路由等技术，<b>发布/订阅提供了比传统的客户端–服务器更好的可扩展性</b>。然而，在某些类型的紧耦合、高容量的企业环境中，随着系统规模上升到由上千台服务器组成的数据中心所共享的发布/订阅基础架构，现有的供应商系统经常失去这项好处；在这些高负载环境下，发布/订阅产品的扩展性是一个研究课题。</p>\n    <p>另一方面，在企业环境之外，发布/订阅范式已经证明了它的可扩展性远超过一个单一的数据中心，通过网络聚合协议如 <a href=\"https://baike.baidu.com/item/RSS/24470\" target=\"_blank\" rel=\"noopener\">RSS</a> 和 <a href=\"https://baike.baidu.com/item/atom/353868#viewPageContent\" target=\"_blank\" rel=\"noopener\">Atom</a> 提供互联网范围内分发的消息。在交互时，为了能够即便是用低档Web服务器也能将消息播出到(可能)数以百万计的独立用户节点，这些聚合协议接受更高的延迟和无保障交付。</p>\n</div>\n\n<div class=\"note danger\">\n    <p>发布/订阅系统最严重的问题是 <b>其主要优点的副作用：发布者解耦订阅者</b>。</p>\n    <p>消息交付问题：发布/订阅系统必须仔细设计，才能提供特定的应用程序可能需要的更强大的系统性能，例如有保障的交付。</p>\n    <ul>\n        <li>发布/订阅系统的中介（broker）可能设计为在指定时间发送消息，随后便停止尝试发送，无论是否已收到所有用户成功接收消息的确认回复。这样设计的发布/订阅系统 <b>不能保证消息能够传递到所有需要这种有保障交付的应用程序</b>。要达成有保障交付，必须在发布/订阅架构之外强制执行这种发布者和订阅者之间在设计上更紧密的耦合（例如，通过要求订阅者宣布消息已接收）。</li>\n        <li>发布/订阅系统中的 <b>发布者会“假定”订阅者正在监听</b>，而实际上可能没有。一个工厂可能会使用发布/订阅系统来允许设备发布问题和故障，订阅者将问题显示并记录。<b>如果记录器失败（崩溃了），那么设备故障发布者不一定收到记录器失败的通知，发布/订阅系统的任何设备都不会显示和记录错误消息</b>。</li>\n    </ul>\n    <p>在有少量发布者和订阅节点的小型网络和低信息量时发布/订阅能够自如伸缩。然而，随着节点和消息量的增长，不稳定性随之增长，限制了发布/订阅网络的最大可扩展性。大规模时吞吐量不稳定的例子包括：</p>\n    <ul>\n        <li><b>负载激增</b> - 订阅请求使网络流量饱和，随后进入低信息量（未充分利用网络带宽）</li>\n        <li><b>速度变慢</b> - 越来越多的应用程序使用该系统（即使它们是在不同的发布/订阅频道通信）消息量流入单个订阅者的速度缓慢</li>\n    </ul>\n</div>\n\n<hr>\n\n<h2 id=\"参考资料\"><a href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"></a>参考资料</h2><ul>\n<li><a href=\"https://hackernoon.com/observer-vs-pub-sub-pattern-50d3b27f838c\" target=\"_blank\" rel=\"noopener\">Observer vs Pub-Sub pattern</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern#Message_filtering\" target=\"_blank\" rel=\"noopener\">Publish–subscribe pattern</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/51357583\" target=\"_blank\" rel=\"noopener\">观察者模式 vs 发布订阅模式</a></li>\n<li><a href=\"https://www.cnblogs.com/itgezhu/p/10947405.html\" target=\"_blank\" rel=\"noopener\">Javascript中理解发布–订阅模式</a></li>\n<li><a href=\"https://www.cnblogs.com/viaiu/p/9939301.html\" target=\"_blank\" rel=\"noopener\">观察者和发布订阅模式的区别</a></li>\n<li><a href=\"https://blog.csdn.net/hf872914334/article/details/88899326\" target=\"_blank\" rel=\"noopener\">发布订阅模式与观察者模式</a></li>\n</ul>\n","site":{"data":{}},"length":6607,"excerpt":"<blockquote>\n<p><span class=\"introduction\">青少年是一个美好而又是一去不可再得的时期，是将来一切光明和幸福的开端。</span><br><br>如果面试官问到你：“What is the difference between the Observer pattern and Pub-Sub pattern?”，你该怎么回答呢？</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><div class=\"note info\">设计模式是在面向对象软件设计过程中针对特定问题的简洁而优雅的解决方案。</div>\n\n<p>在《Head First 设计模式》一书中有讲到：</p>\n<blockquote>\n<p>Publishers + Subscribers = Observer pattern</p>\n</blockquote>\n<p>但 <strong>发布订阅</strong> 和 <strong>观察者模式</strong> 真的是完全相同的吗？</p>\n<hr>\n\n<h2 id=\"Observer-Pattern\"><a href=\"#Observer-Pattern\" class=\"headerlink\" title=\"Observer Pattern\"></a>Observer Pattern</h2><h3 id=\"定义\"><a href=\"#定义\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>所谓观察者模式，其实就是为了实现 <strong>松耦合</strong>(loosely coupled)。</p>\n<p>观察者模式定义了对象间的一种 <strong>一对多</strong> 的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知，并自动更新。</p>\n<p>观察者模式属于 <strong>行为型模式</strong>，行为型模式关注的是对象之间的通讯，观察者模式就是观察者和被观察者之间的通讯。</p>\n<img src=\"/2020/01/14/JavaScript%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/ObserverPattern.png\" alt=\"Observer design pattern\">\n\n<h3 id=\"实现\"><a href=\"#实现\" class=\"headerlink\" title=\"实现\"></a>实现</h3><p>被观察者（Subject，或者叫 Observable），它只需维护一套观察者（Observer）的集合，这些 Observer 实现相同的接口，Subject 只需要知道，通知 Observer 时，需要调用哪个统一方法就好了：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(name) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.subscriberlList = []; <span class=\"comment\">// 每个人都可能会有其订阅者</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    publish(rewards) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span> 用户发布了价值为 <span class=\"subst\">$&#123;rewards&#125;</span> 的物品！`</span>);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.subscriberlList.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value(rewards)); </span><br><span class=\"line\">        <span class=\"comment\">// 逐个调用发布者的订阅列表中，与订阅者约定好的的通知方法</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    subscribe(subject, callback) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(<span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span> 用户订阅了 <span class=\"subst\">$&#123;subject.name&#125;</span>！`</span>);</span><br><span class=\"line\">        subject.subscriberlList.push(callback); <span class=\"comment\">// 送入被订阅者的订阅列表中</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>现在有四个用户 <em>wang</em>, <em>li</em>, <em>zhang</em>, <em>sun<em>，</em>wang</em> 手中即将新进一批货物，其余三人则 <em>订阅</em> 了 <em>wang</em>，当其发布了新物品时需要通知到这三个人：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> wang = <span class=\"keyword\">new</span> User(<span class=\"string\">'wang'</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> li = <span class=\"keyword\">new</span> User(<span class=\"string\">'li'</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> zhang = <span class=\"keyword\">new</span> User(<span class=\"string\">'zhang'</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> sun = <span class=\"keyword\">new</span> User(<span class=\"string\">'sun'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">li.subscribe(wang, rewards =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`li <span class=\"subst\">$&#123;rewards &gt; <span class=\"number\">100</span> ? <span class=\"string\">'觉得太贵了，不'</span> : <span class=\"string\">''</span>&#125;</span>决定购买这件物品！`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">zhang.subscribe(wang, rewards =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`zhang <span class=\"subst\">$&#123;rewards &gt; <span class=\"number\">50</span> ? <span class=\"string\">'觉得太贵了，不'</span> : <span class=\"string\">''</span>&#125;</span>决定购买这件物品！`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">sun.subscribe(wang, rewards =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`sun <span class=\"subst\">$&#123;rewards &gt; <span class=\"number\">25</span> ? <span class=\"string\">'觉得太贵了，不'</span> : <span class=\"string\">''</span>&#125;</span>决定购买这件物品！`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">wang.publish(<span class=\"number\">75</span>); <span class=\"comment\">// 最后，wang 发布一个消息，其即将会通知到所有已订阅的人</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">li 用户订阅了 wang！</span><br><span class=\"line\">zhang 用户订阅了 wang！</span><br><span class=\"line\">sun 用户订阅了 wang！</span><br><span class=\"line\">wang 用户发布了价值为 75 的物品！</span><br><span class=\"line\">li 决定购买这件物品！</span><br><span class=\"line\">zhang 觉得太贵了，不决定购买这件物品！</span><br><span class=\"line\">sun 觉得太贵了，不决定购买这件物品！</span><br></pre></td></tr></table></figure>\n\n<p>从这里我们可以看出来，发布者会直接主动通知其订阅者，即双方互相“认识”。</p>\n<h3 id=\"观察者模式的优缺点\"><a href=\"#观察者模式的优缺点\" class=\"headerlink\" title=\"观察者模式的优缺点\"></a>观察者模式的优缺点</h3><div class=\"note success\">\n    <p>1、具体主题和具体观察者是 <b>松耦合</b> 关系。由于主题接口仅仅依赖于观察者接口，因此具体主题只是知道它的观察者是实现观察者接口的某个类的实例，但不需要知道具体是哪个类。同样，由于观察者仅仅依赖于主题接口，因此具体观察者只是知道它依赖的主题是实现主题接口的某个类的实例，但不需要知道具体是哪个类。</p>\n    <p>2、观察者模式满足 <b>“开-闭原则”</b>。主题接口仅仅依赖于观察者接口，这样，就可以让创建具体主题的类也仅仅是依赖于观察者接口，因此，如果增加新的实现观察者接口的类，不必修改创建具体主题的类的代码。。同样，创建具体观察者的类仅仅依赖于主题接口，如果增加新的实现主题接口的类，也不必修改创建具体观察者类的代码。</p>\n</div>\n\n<div class=\"note danger\">\n    <p>1、如果一个被观察者对象有很多的直接和间接的观察者的话，将所有的观察者 <b>都通知到会花费很多时间</b>。</p>\n    <p>2、如果在观察者和观察目标之间有循环依赖的话，观察目标 <b>会触发它们之间进行循环调用</b>，可能导致系统崩溃。</p>\n    <p>3、观察者模式没有相应的机制让观察者知道所观察的目标对象是怎么发生变化的，而仅仅只是知道观察目标发生了变化。</p>\n</div>\n\n<hr>\n\n<h2 id=\"Pub-Sub-Pattern\"><a href=\"#Pub-Sub-Pattern\" class=\"headerlink\" title=\"Pub-Sub Pattern\"></a>Pub-Sub Pattern</h2><h3 id=\"定义-1\"><a href=\"#定义-1\" class=\"headerlink\" title=\"定义\"></a>定义</h3><p>在 <em>Pub-Sub Pattern</em> 中，发布者，并不会直接通知订阅者，换句话说，发布者和订阅者，彼此互不相识。</p>\n<div class=\"note info\">In ‘Publisher-Subscriber’ pattern, senders of messages, called <b>publishers</b>, do not program the messages to be sent directly to specific receivers, called <b>subscribers</b>.</div>\n\n<p>既然这意味着发布者和订阅者互相不知道彼此的存在，那么就需要第三个组件，其被称为 <strong>代理</strong>（消息代理、事件总线）。发布者和订阅者都知道它，它过滤所有传入的消息并相应地分发它们。</p>\n<p>换句话说，<strong>Pub-Sub</strong> 是一种模式，用于在不同的系统组件之间传递消息，而这些组件之间不了解彼此的身份，如果有兴趣了解更多请戳蓝链 =&gt; <a href=\"https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern#Message_filtering\" target=\"_blank\" rel=\"noopener\">维基百科对此已经进行了很好的解释</a>。</p>\n<img src=\"/2020/01/14/JavaScript%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/PubSubPattern.gif\" alt=\"Pub-Sub Pattern\">\n\n<p>现在让我们再来对比一下观察者模式和发布订阅的主要区别：</p>\n<img src=\"/2020/01/14/JavaScript%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/vs.jpeg\" alt=\"观察者模式 vs 发布订阅\">\n\n<p>大致总结一下就是：</p>\n<ul>\n<li>在 <strong>观察者</strong> 模式中，<strong>观察者知道主题</strong>，<strong>主题也维护观察者的记录</strong>。而在 <strong>发布订阅</strong> 中，发布者和订阅者 <strong>不需要彼此了解</strong>。他们只是在消息队列或代理的帮助下进行通信。</li>\n<li>在 <strong>发布订阅</strong> 模式中，与 <strong>观察者</strong> 模式相反，组件是松散耦合的。</li>\n<li><strong>观察者</strong> 模式主要以 <strong>同步</strong> 方式实现，即，当某个事件发生时，Subject 调用其所有观察者的适当方法。而 <strong>发布订阅</strong> 通常使用的是 <strong>消息队列</strong> 去维护。</li>\n<li><strong>观察者</strong> 模式需要在单个应用程序地址空间中实现。<strong>发布订阅</strong> 更多地是跨应用程序模式.</li>\n</ul>\n<p>尽管这些模式之间存在差异，但有些人可能会说 <strong>Publisher-Subscriber</strong> 是 <strong>Observer</strong> 模式的变体，因为它们之间在概念上相似。而且这根本没有错。无需认真对待差异。</p>\n<ul>\n<li>如果以结构来分辨模式，发布订阅模式相比观察者模式多了一个中间件订阅器，所以发布订阅模式是不同于观察者模式的；</li>\n<li>如果以意图来分辨模式，他们都是 <strong>实现了对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都将得到通知，并自动更新</strong>，那么他们就是同一种模式，发布订阅模式是在观察者模式的基础上做的优化升级。</li>\n</ul>\n<div class=\"note success\"><b>分辨模式的关键是意图而不是结构</b> --- 《JavaScript设计模式与开发实践》</div>\n\n<h3 id=\"实现-1\"><a href=\"#实现-1\" class=\"headerlink\" title=\"实现\"></a>实现</h3><p>在观察者模式的实现背景中，增加一个中介者（Broker）：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Broker</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(name) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.topicsList = [];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    publish(topic, rewards, publisher) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"keyword\">this</span>.topicsList[topic]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">'No subscribers'</span>; <span class=\"comment\">// 对于 target 事件没有任何的订阅者</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.topicsList[topic].forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value(rewards, publisher));</span><br><span class=\"line\">        <span class=\"comment\">// 由 Broker 去通知订阅 topic 的订阅者</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    subscribe(topic, callback) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"keyword\">this</span>.topicsList[topic]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.topicsList[topic] = []; <span class=\"comment\">// 如果这个事件是全新的，就去对这个事件维护一个序列</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.topicsList[topic].push(callback);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    letsSomebodyJoin(...users) &#123;</span><br><span class=\"line\">        users.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">`用户 <span class=\"subst\">$&#123;value.name&#125;</span> 加入了 <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>！`</span>);</span><br><span class=\"line\">            value.brokersList.push(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>对于 User 类的定义，只需要稍做一些改动：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">User</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(name) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.brokersList = [];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    subscribe(topic, callback) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.brokersList.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">`用户 <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span> 在 <span class=\"subst\">$&#123;value.name&#125;</span> 中介里订阅了 <span class=\"subst\">$&#123;topic&#125;</span>！`</span>);</span><br><span class=\"line\">            value.subscribe(topic, callback); <span class=\"comment\">// 对于当前订阅者所在的 Broker 中去订阅 topic</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    publish(topic, rewards) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.brokersList.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">`用户 <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span> 向 <span class=\"subst\">$&#123;value.name&#125;</span> 发布了价值为 <span class=\"subst\">$&#123;rewards&#125;</span> 的 <span class=\"subst\">$&#123;topic&#125;</span>！`</span>);</span><br><span class=\"line\">            value.publish(topic, rewards, <span class=\"keyword\">this</span>); <span class=\"comment\">// 对于当前订阅者所在的 Broker 中去发布 topic</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Client:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> broker = <span class=\"keyword\">new</span> Broker(<span class=\"string\">'Broker'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> wang = <span class=\"keyword\">new</span> User(<span class=\"string\">'wang'</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> li = <span class=\"keyword\">new</span> User(<span class=\"string\">'li'</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> zhang = <span class=\"keyword\">new</span> User(<span class=\"string\">'zhang'</span>);</span><br><span class=\"line\"><span class=\"keyword\">let</span> sun = <span class=\"keyword\">new</span> User(<span class=\"string\">'sun'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">broker.letsSomebodyJoin(wang, li, zhang, sun);</span><br><span class=\"line\"></span><br><span class=\"line\">li.subscribe(<span class=\"string\">'窝窝头'</span>, (rewards, publisher) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`li <span class=\"subst\">$&#123;rewards &gt; <span class=\"number\">100</span> ? <span class=\"string\">'觉得太贵了，不'</span> : <span class=\"string\">''</span>&#125;</span>决定购买 <span class=\"subst\">$&#123;publisher.name&#125;</span> 发布的窝窝头！`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">zhang.subscribe(<span class=\"string\">'窝窝头'</span>, (rewards, publisher) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`zhang <span class=\"subst\">$&#123;rewards &gt; <span class=\"number\">50</span> ? <span class=\"string\">'觉得太贵了，不'</span> : <span class=\"string\">''</span>&#125;</span>决定购买 <span class=\"subst\">$&#123;publisher.name&#125;</span> 发布的窝窝头！`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">sun.subscribe(<span class=\"string\">'窝窝头'</span>, (rewards, publisher) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">`sun <span class=\"subst\">$&#123;rewards &gt; <span class=\"number\">25</span> ? <span class=\"string\">'觉得太贵了，不'</span> : <span class=\"string\">''</span>&#125;</span>决定购买 <span class=\"subst\">$&#123;publisher.name&#125;</span> 发布的窝窝头！`</span>);</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">wang.publish(<span class=\"string\">'窝窝头'</span>, <span class=\"number\">35</span>);</span><br></pre></td></tr></table></figure>\n\n<p><em>wang</em> 发布了 35 价值的窝窝头，可以预想的到是 <em>sun</em> 没有购买：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">用户 wang 加入了 Broker！</span><br><span class=\"line\">用户 li 加入了 Broker！</span><br><span class=\"line\">用户 zhang 加入了 Broker！</span><br><span class=\"line\">用户 sun 加入了 Broker！</span><br><span class=\"line\">用户 li 在 Broker 中介里订阅了 窝窝头！</span><br><span class=\"line\">用户 zhang 在 Broker 中介里订阅了 窝窝头！</span><br><span class=\"line\">用户 sun 在 Broker 中介里订阅了 窝窝头！</span><br><span class=\"line\">用户 wang 向 Broker 发布了价值为 35 的 窝窝头！</span><br><span class=\"line\">li 决定购买 wang 发布的窝窝头！</span><br><span class=\"line\">zhang 决定购买 wang 发布的窝窝头！</span><br><span class=\"line\">sun 觉得太贵了，不决定购买 wang 发布的窝窝头！</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"发布订阅的优缺点\"><a href=\"#发布订阅的优缺点\" class=\"headerlink\" title=\"发布订阅的优缺点\"></a>发布订阅的优缺点</h3><div class=\"note success\">\n    <p>1. <b>松耦合</b>：发布者与订阅者松耦合，<b>甚至不需要知道它们的存在</b>。由于 <b>主题才是关注的焦点</b>，发布者和订阅者可以对系统拓扑结构保持一无所知。各自继续正常操作而无需顾及对方。在传统的紧耦合的客户端-服务器模式中，当服务器进程不运行时，客户端无法发送消息给服务器，服务器也无法在客户端不运行时接收消息。许多发布/订阅系统不但将发布者和订阅者 <b>从位置上解耦</b>，还 <b>从时间上解耦</b> 他们。中间件分析师对这种发布/订阅使用的常用策略，是拆卸一个发布者来让订阅者处理完积压的工作（带宽限制的一种形式）。</p>\n    <p>2. <b>可扩展性</b>：通过并行操作，消息缓存，基于树或基于网络的路由等技术，<b>发布/订阅提供了比传统的客户端–服务器更好的可扩展性</b>。然而，在某些类型的紧耦合、高容量的企业环境中，随着系统规模上升到由上千台服务器组成的数据中心所共享的发布/订阅基础架构，现有的供应商系统经常失去这项好处；在这些高负载环境下，发布/订阅产品的扩展性是一个研究课题。</p>\n    <p>另一方面，在企业环境之外，发布/订阅范式已经证明了它的可扩展性远超过一个单一的数据中心，通过网络聚合协议如 <a href=\"https://baike.baidu.com/item/RSS/24470\" target=\"_blank\" rel=\"noopener\">RSS</a> 和 <a href=\"https://baike.baidu.com/item/atom/353868#viewPageContent\" target=\"_blank\" rel=\"noopener\">Atom</a> 提供互联网范围内分发的消息。在交互时，为了能够即便是用低档Web服务器也能将消息播出到(可能)数以百万计的独立用户节点，这些聚合协议接受更高的延迟和无保障交付。</p>\n</div>\n\n<div class=\"note danger\">\n    <p>发布/订阅系统最严重的问题是 <b>其主要优点的副作用：发布者解耦订阅者</b>。</p>\n    <p>消息交付问题：发布/订阅系统必须仔细设计，才能提供特定的应用程序可能需要的更强大的系统性能，例如有保障的交付。</p>\n    <ul>\n        <li>发布/订阅系统的中介（broker）可能设计为在指定时间发送消息，随后便停止尝试发送，无论是否已收到所有用户成功接收消息的确认回复。这样设计的发布/订阅系统 <b>不能保证消息能够传递到所有需要这种有保障交付的应用程序</b>。要达成有保障交付，必须在发布/订阅架构之外强制执行这种发布者和订阅者之间在设计上更紧密的耦合（例如，通过要求订阅者宣布消息已接收）。</li>\n        <li>发布/订阅系统中的 <b>发布者会“假定”订阅者正在监听</b>，而实际上可能没有。一个工厂可能会使用发布/订阅系统来允许设备发布问题和故障，订阅者将问题显示并记录。<b>如果记录器失败（崩溃了），那么设备故障发布者不一定收到记录器失败的通知，发布/订阅系统的任何设备都不会显示和记录错误消息</b>。</li>\n    </ul>\n    <p>在有少量发布者和订阅节点的小型网络和低信息量时发布/订阅能够自如伸缩。然而，随着节点和消息量的增长，不稳定性随之增长，限制了发布/订阅网络的最大可扩展性。大规模时吞吐量不稳定的例子包括：</p>\n    <ul>\n        <li><b>负载激增</b> - 订阅请求使网络流量饱和，随后进入低信息量（未充分利用网络带宽）</li>\n        <li><b>速度变慢</b> - 越来越多的应用程序使用该系统（即使它们是在不同的发布/订阅频道通信）消息量流入单个订阅者的速度缓慢</li>\n    </ul>\n</div>\n\n<hr>\n\n<h2 id=\"参考资料\"><a href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"></a>参考资料</h2><ul>\n<li><a href=\"https://hackernoon.com/observer-vs-pub-sub-pattern-50d3b27f838c\" target=\"_blank\" rel=\"noopener\">Observer vs Pub-Sub pattern</a></li>\n<li><a href=\"https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern#Message_filtering\" target=\"_blank\" rel=\"noopener\">Publish–subscribe pattern</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/51357583\" target=\"_blank\" rel=\"noopener\">观察者模式 vs 发布订阅模式</a></li>\n<li><a href=\"https://www.cnblogs.com/itgezhu/p/10947405.html\" target=\"_blank\" rel=\"noopener\">Javascript中理解发布–订阅模式</a></li>\n<li><a href=\"https://www.cnblogs.com/viaiu/p/9939301.html\" target=\"_blank\" rel=\"noopener\">观察者和发布订阅模式的区别</a></li>\n<li><a href=\"https://blog.csdn.net/hf872914334/article/details/88899326\" target=\"_blank\" rel=\"noopener\">发布订阅模式与观察者模式</a></li>\n</ul>"},{"title":"JavaScript面向对象-01-Constructor","date":"2019-12-07T15:46:31.000Z","copyright":true,"_content":"\n> <span class = 'introduction'>成功的关键在于相信自己有成功的能力。</span><br/>\n在类别基础的面向对象程序设计中，构造器（英语： Constructor，有时简称 ctor，别称：构造方法、构造函数、建构子）是一个类里用于创建对象的特殊子程序。它能初始化一个新建的对象，并时常会接受参数用以设定实例变量。<br/>在 JavaScript 中，又是怎么去实现 OOP 编程呢？\n\n<!--more-->\n\n<hr/>\n\n## Atwood's Law\n\n<div class=\"note info\">\nAny application that can be written in JavaScript, will eventually be written in JavaScript.<br/>\n(任何可以用JavaScript来写的应用，最终都将用JavaScript来写。)\n</div>\n\n<hr />\n\n## Before ES6\n\n在 JavaScript 中，创建对象的模板是构造函数（ECMA6之前，没有 `class` 关键字），而在其他语言中创建对象的模板是类。\n\nJavaScript 传统的创建对象方法有点怪异，是用函数的形式去封装一个对象：\n\n```javascript\nfunction Student(name, subject, score) {\n    this.name = name; // 通过 this 去给当前对象动态地添加一个属性 or 方法\n}\n\nvar student = new Student(\"Wang\", \"JavaScript\", 100); // 通过 new 关键字去创建一个对象\n```\n\n### 创建对象的几种方式\n\n#### new Object()\n\n```javascript\nvar student = new Object();  // 创建一个空对象\nstudent.name = 'wang';       // 动态地去给对象添加属性 or 方法\n```\n\n#### 对象字面量 {}\n\n```javascript\nlet student = {};           // 创建一个空对象，等同于 new Object();\nstudent.name = 'xxx';       // 动态地去给对象添加属性 or 方法\n```\n\n或者直接令某个变量去引用一个自定义对象：\n\n```javascript\nlet student = {\n    name: 'xxx',\n    age: 20\n}; // 类似字典，键就是属性名，值就是属性值\n```\n\n#### 工厂函数（工厂方法）\n\n与 <a href=\"https://zh.wikipedia.org/wiki/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95\" target=\"_blank\">工厂方法模式</a> 类似，Client 去通知某个对象的工厂，传入对应的参数去获得一个对象：\n\n```javascript\nfunction studentFactory(name, age) {\n    let student = new Object();\n    student.name = name;\n    student.age = age;\n    return student; // 工厂方法将包装好的对象送给 Client\n}\n```\n\n<div class=\"note danger\">\n但是通过这种方法，Client 所接到的对象类型是 <b>object</b>，因为通过了 <code>new Object()</code> 来创建的，应该令他的类型为 <b>student</b>。\n\n即，这种方法产生的对象，<code>student instanceof Student === false</code>，不方便判断对象类型。\n\n所有对象使用 <code>typeof object</code> 得到的答案都为 <code>object</code>，但使用构造函数可以使用 <code>instanceof</code> 去判断具体类型。\n</div>\n\n#### 构造函数\n\n```javascript\n// 构造函数首字母大写驼峰（就像类名）\nfunction Student(name, subject, score) {\n    this.name = name;\n    this.subject = subject;\n    this.score = score;\n\n    this.toString = function() {\n        return `{name=${this.name}, subject=${this.subject}, score=${this.score}}`;\n    };\n}\n```\n\n1. 构造函数在使用的时候，首先会在内存中创建一个空对象\n2. 设置构造函数的 this，让 this 指向刚刚创建好的对象\n3. 执行构造函数中的代码\n4. 最后返回这个对象（以上的行为都无须用户显式使用）\n\n构造函数创建的对象，使用 typeof 得到的答案仍然为 **object**，但使用构造函数创建的对象，可以使用 <code>student instanceof Student === true</code> 去得知具体类型。\n\n<div class=\"note info\">\n每个对象中都有一个属性，student.constructor，这个属性的值为创建这个对象的构造函数本身，\n所以也可以使用 <code>student.constructor === Student</code> 去判断对象的类型，但不建议这样使用（这使用的就是 <b>__proto__</b> 中的 <b>constructor</b>，关于原型会在 <a href=\"https://www.wqh4u.cn/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/\" target=\"_blank\">JavaScript 原型</a> 中提到）\n</div>\n\n### 如何去选择构造器\n\n在 JavaScript 中，使用字面量（静态成员）去创建工具类，而使用构造函数（示例成员）去创建一般类。\n\n工具类就像 Math，一般类就像 Date：\n\n```javascript\n// 工具类\nvar Tools = {\n    // 获取一个在 [min, max] 中的随机数\n    // 这个函数可以直接由 Tools.getRandomNumber(); 去调用，而不需去 new 一个 Tools 对象\n    // 就像 Math.floor()、Math.ceil() 这样\n    getRandomNumber: function(min, max) {\n        min = Math.ceil(min);\n        max = Math.floor(max);\n        return Math.floor(Math.random() * (max - min + 1)) + min;\n    },\n};\nconsole.log(Tools.getRandomNumber(0, 100)); // 就像类的静态方法一样\n\n// 一般类\nfunction Student(name, age) {\n    this.name = name;\n    this.age = age;\n    // ......\n}\n// 当我们需要使用学生对象时，则需要使用 new 关键字去获得一个学生对象\nvar student = new Student('Wang', 20);\n```\n\n<hr />\n\n## After ES6\n\n在 ES6 标准中，JavaScript 也支持了使用 `class` 关键字这种创建一个类的方法：\n\n```javascript\nclass Student {\n    constructor(name, age) {\n        this.name = name;\n        this.age = age;\n    }\n    \n    toString() {\n        return `{name=${this.name}, subject=${this.subject}, score=${this.score}}`;\n    }\n}\n\nlet student = new Student('Wang', 20);\nconsole.log(student.toString());\n```\n","source":"_posts/JavaScript面向对象-01-Constructor.md","raw":"---\ntitle: JavaScript面向对象-01-Constructor\ndate: 2019-12-07 23:46:31\ntags:\n- Web\n- JavaScript\ncategories:\n- 前端\n- 面经\n- JavaScript\ncopyright: true\n---\n\n> <span class = 'introduction'>成功的关键在于相信自己有成功的能力。</span><br/>\n在类别基础的面向对象程序设计中，构造器（英语： Constructor，有时简称 ctor，别称：构造方法、构造函数、建构子）是一个类里用于创建对象的特殊子程序。它能初始化一个新建的对象，并时常会接受参数用以设定实例变量。<br/>在 JavaScript 中，又是怎么去实现 OOP 编程呢？\n\n<!--more-->\n\n<hr/>\n\n## Atwood's Law\n\n<div class=\"note info\">\nAny application that can be written in JavaScript, will eventually be written in JavaScript.<br/>\n(任何可以用JavaScript来写的应用，最终都将用JavaScript来写。)\n</div>\n\n<hr />\n\n## Before ES6\n\n在 JavaScript 中，创建对象的模板是构造函数（ECMA6之前，没有 `class` 关键字），而在其他语言中创建对象的模板是类。\n\nJavaScript 传统的创建对象方法有点怪异，是用函数的形式去封装一个对象：\n\n```javascript\nfunction Student(name, subject, score) {\n    this.name = name; // 通过 this 去给当前对象动态地添加一个属性 or 方法\n}\n\nvar student = new Student(\"Wang\", \"JavaScript\", 100); // 通过 new 关键字去创建一个对象\n```\n\n### 创建对象的几种方式\n\n#### new Object()\n\n```javascript\nvar student = new Object();  // 创建一个空对象\nstudent.name = 'wang';       // 动态地去给对象添加属性 or 方法\n```\n\n#### 对象字面量 {}\n\n```javascript\nlet student = {};           // 创建一个空对象，等同于 new Object();\nstudent.name = 'xxx';       // 动态地去给对象添加属性 or 方法\n```\n\n或者直接令某个变量去引用一个自定义对象：\n\n```javascript\nlet student = {\n    name: 'xxx',\n    age: 20\n}; // 类似字典，键就是属性名，值就是属性值\n```\n\n#### 工厂函数（工厂方法）\n\n与 <a href=\"https://zh.wikipedia.org/wiki/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95\" target=\"_blank\">工厂方法模式</a> 类似，Client 去通知某个对象的工厂，传入对应的参数去获得一个对象：\n\n```javascript\nfunction studentFactory(name, age) {\n    let student = new Object();\n    student.name = name;\n    student.age = age;\n    return student; // 工厂方法将包装好的对象送给 Client\n}\n```\n\n<div class=\"note danger\">\n但是通过这种方法，Client 所接到的对象类型是 <b>object</b>，因为通过了 <code>new Object()</code> 来创建的，应该令他的类型为 <b>student</b>。\n\n即，这种方法产生的对象，<code>student instanceof Student === false</code>，不方便判断对象类型。\n\n所有对象使用 <code>typeof object</code> 得到的答案都为 <code>object</code>，但使用构造函数可以使用 <code>instanceof</code> 去判断具体类型。\n</div>\n\n#### 构造函数\n\n```javascript\n// 构造函数首字母大写驼峰（就像类名）\nfunction Student(name, subject, score) {\n    this.name = name;\n    this.subject = subject;\n    this.score = score;\n\n    this.toString = function() {\n        return `{name=${this.name}, subject=${this.subject}, score=${this.score}}`;\n    };\n}\n```\n\n1. 构造函数在使用的时候，首先会在内存中创建一个空对象\n2. 设置构造函数的 this，让 this 指向刚刚创建好的对象\n3. 执行构造函数中的代码\n4. 最后返回这个对象（以上的行为都无须用户显式使用）\n\n构造函数创建的对象，使用 typeof 得到的答案仍然为 **object**，但使用构造函数创建的对象，可以使用 <code>student instanceof Student === true</code> 去得知具体类型。\n\n<div class=\"note info\">\n每个对象中都有一个属性，student.constructor，这个属性的值为创建这个对象的构造函数本身，\n所以也可以使用 <code>student.constructor === Student</code> 去判断对象的类型，但不建议这样使用（这使用的就是 <b>__proto__</b> 中的 <b>constructor</b>，关于原型会在 <a href=\"https://www.wqh4u.cn/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/\" target=\"_blank\">JavaScript 原型</a> 中提到）\n</div>\n\n### 如何去选择构造器\n\n在 JavaScript 中，使用字面量（静态成员）去创建工具类，而使用构造函数（示例成员）去创建一般类。\n\n工具类就像 Math，一般类就像 Date：\n\n```javascript\n// 工具类\nvar Tools = {\n    // 获取一个在 [min, max] 中的随机数\n    // 这个函数可以直接由 Tools.getRandomNumber(); 去调用，而不需去 new 一个 Tools 对象\n    // 就像 Math.floor()、Math.ceil() 这样\n    getRandomNumber: function(min, max) {\n        min = Math.ceil(min);\n        max = Math.floor(max);\n        return Math.floor(Math.random() * (max - min + 1)) + min;\n    },\n};\nconsole.log(Tools.getRandomNumber(0, 100)); // 就像类的静态方法一样\n\n// 一般类\nfunction Student(name, age) {\n    this.name = name;\n    this.age = age;\n    // ......\n}\n// 当我们需要使用学生对象时，则需要使用 new 关键字去获得一个学生对象\nvar student = new Student('Wang', 20);\n```\n\n<hr />\n\n## After ES6\n\n在 ES6 标准中，JavaScript 也支持了使用 `class` 关键字这种创建一个类的方法：\n\n```javascript\nclass Student {\n    constructor(name, age) {\n        this.name = name;\n        this.age = age;\n    }\n    \n    toString() {\n        return `{name=${this.name}, subject=${this.subject}, score=${this.score}}`;\n    }\n}\n\nlet student = new Student('Wang', 20);\nconsole.log(student.toString());\n```\n","slug":"JavaScript面向对象-01-Constructor","published":1,"updated":"2020-01-14T20:30:46.917Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn5w000m2lwj6sl482pf","content":"<blockquote>\n<p><span class=\"introduction\">成功的关键在于相信自己有成功的能力。</span><br><br>在类别基础的面向对象程序设计中，构造器（英语： Constructor，有时简称 ctor，别称：构造方法、构造函数、建构子）是一个类里用于创建对象的特殊子程序。它能初始化一个新建的对象，并时常会接受参数用以设定实例变量。<br>在 JavaScript 中，又是怎么去实现 OOP 编程呢？</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"Atwood’s-Law\"><a href=\"#Atwood’s-Law\" class=\"headerlink\" title=\"Atwood’s Law\"></a>Atwood’s Law</h2><div class=\"note info\">\nAny application that can be written in JavaScript, will eventually be written in JavaScript.<br>\n(任何可以用JavaScript来写的应用，最终都将用JavaScript来写。)\n</div>\n\n<hr>\n\n<h2 id=\"Before-ES6\"><a href=\"#Before-ES6\" class=\"headerlink\" title=\"Before ES6\"></a>Before ES6</h2><p>在 JavaScript 中，创建对象的模板是构造函数（ECMA6之前，没有 <code>class</code> 关键字），而在其他语言中创建对象的模板是类。</p>\n<p>JavaScript 传统的创建对象方法有点怪异，是用函数的形式去封装一个对象：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, subject, score</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name; <span class=\"comment\">// 通过 this 去给当前对象动态地添加一个属性 or 方法</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">\"Wang\"</span>, <span class=\"string\">\"JavaScript\"</span>, <span class=\"number\">100</span>); <span class=\"comment\">// 通过 new 关键字去创建一个对象</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建对象的几种方式\"><a href=\"#创建对象的几种方式\" class=\"headerlink\" title=\"创建对象的几种方式\"></a>创建对象的几种方式</h3><h4 id=\"new-Object\"><a href=\"#new-Object\" class=\"headerlink\" title=\"new Object()\"></a>new Object()</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> student = <span class=\"keyword\">new</span> <span class=\"built_in\">Object</span>();  <span class=\"comment\">// 创建一个空对象</span></span><br><span class=\"line\">student.name = <span class=\"string\">'wang'</span>;       <span class=\"comment\">// 动态地去给对象添加属性 or 方法</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"对象字面量\"><a href=\"#对象字面量\" class=\"headerlink\" title=\"对象字面量 {}\"></a>对象字面量 {}</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> student = &#123;&#125;;           <span class=\"comment\">// 创建一个空对象，等同于 new Object();</span></span><br><span class=\"line\">student.name = <span class=\"string\">'xxx'</span>;       <span class=\"comment\">// 动态地去给对象添加属性 or 方法</span></span><br></pre></td></tr></table></figure>\n\n<p>或者直接令某个变量去引用一个自定义对象：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> student = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'xxx'</span>,</span><br><span class=\"line\">    age: <span class=\"number\">20</span></span><br><span class=\"line\">&#125;; <span class=\"comment\">// 类似字典，键就是属性名，值就是属性值</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"工厂函数（工厂方法）\"><a href=\"#工厂函数（工厂方法）\" class=\"headerlink\" title=\"工厂函数（工厂方法）\"></a>工厂函数（工厂方法）</h4><p>与 <a href=\"https://zh.wikipedia.org/wiki/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95\" target=\"_blank\">工厂方法模式</a> 类似，Client 去通知某个对象的工厂，传入对应的参数去获得一个对象：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">studentFactory</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> <span class=\"built_in\">Object</span>();</span><br><span class=\"line\">    student.name = name;</span><br><span class=\"line\">    student.age = age;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> student; <span class=\"comment\">// 工厂方法将包装好的对象送给 Client</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<div class=\"note danger\">\n但是通过这种方法，Client 所接到的对象类型是 <b>object</b>，因为通过了 <code>new Object()</code> 来创建的，应该令他的类型为 <b>student</b>。\n\n<p>即，这种方法产生的对象，<code>student instanceof Student === false</code>，不方便判断对象类型。</p>\n<p>所有对象使用 <code>typeof object</code> 得到的答案都为 <code>object</code>，但使用构造函数可以使用 <code>instanceof</code> 去判断具体类型。</p>\n</div>\n\n<h4 id=\"构造函数\"><a href=\"#构造函数\" class=\"headerlink\" title=\"构造函数\"></a>构造函数</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 构造函数首字母大写驼峰（就像类名）</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, subject, score</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.subject = subject;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.score = score;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.toString = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">`&#123;name=<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>, subject=<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.subject&#125;</span>, score=<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.score&#125;</span>&#125;`</span>;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol>\n<li>构造函数在使用的时候，首先会在内存中创建一个空对象</li>\n<li>设置构造函数的 this，让 this 指向刚刚创建好的对象</li>\n<li>执行构造函数中的代码</li>\n<li>最后返回这个对象（以上的行为都无须用户显式使用）</li>\n</ol>\n<p>构造函数创建的对象，使用 typeof 得到的答案仍然为 <strong>object</strong>，但使用构造函数创建的对象，可以使用 <code>student instanceof Student === true</code> 去得知具体类型。</p>\n<div class=\"note info\">\n每个对象中都有一个属性，student.constructor，这个属性的值为创建这个对象的构造函数本身，\n所以也可以使用 <code>student.constructor === Student</code> 去判断对象的类型，但不建议这样使用（这使用的就是 <b>__proto__</b> 中的 <b>constructor</b>，关于原型会在 <a href=\"https://www.wqh4u.cn/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/\" target=\"_blank\">JavaScript 原型</a> 中提到）\n</div>\n\n<h3 id=\"如何去选择构造器\"><a href=\"#如何去选择构造器\" class=\"headerlink\" title=\"如何去选择构造器\"></a>如何去选择构造器</h3><p>在 JavaScript 中，使用字面量（静态成员）去创建工具类，而使用构造函数（示例成员）去创建一般类。</p>\n<p>工具类就像 Math，一般类就像 Date：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 工具类</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Tools = &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 获取一个在 [min, max] 中的随机数</span></span><br><span class=\"line\">    <span class=\"comment\">// 这个函数可以直接由 Tools.getRandomNumber(); 去调用，而不需去 new 一个 Tools 对象</span></span><br><span class=\"line\">    <span class=\"comment\">// 就像 Math.floor()、Math.ceil() 这样</span></span><br><span class=\"line\">    getRandomNumber: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">min, max</span>) </span>&#123;</span><br><span class=\"line\">        min = <span class=\"built_in\">Math</span>.ceil(min);</span><br><span class=\"line\">        max = <span class=\"built_in\">Math</span>.floor(max);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">Math</span>.floor(<span class=\"built_in\">Math</span>.random() * (max - min + <span class=\"number\">1</span>)) + min;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(Tools.getRandomNumber(<span class=\"number\">0</span>, <span class=\"number\">100</span>)); <span class=\"comment\">// 就像类的静态方法一样</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 一般类</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">    <span class=\"comment\">// ......</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 当我们需要使用学生对象时，则需要使用 new 关键字去获得一个学生对象</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"After-ES6\"><a href=\"#After-ES6\" class=\"headerlink\" title=\"After ES6\"></a>After ES6</h2><p>在 ES6 标准中，JavaScript 也支持了使用 <code>class</code> 关键字这种创建一个类的方法：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(name, age) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    toString() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">`&#123;name=<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>, subject=<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.subject&#125;</span>, score=<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.score&#125;</span>&#125;`</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(student.toString());</span><br></pre></td></tr></table></figure>\n","site":{"data":{}},"length":2748,"excerpt":"<blockquote>\n<p><span class=\"introduction\">成功的关键在于相信自己有成功的能力。</span><br><br>在类别基础的面向对象程序设计中，构造器（英语： Constructor，有时简称 ctor，别称：构造方法、构造函数、建构子）是一个类里用于创建对象的特殊子程序。它能初始化一个新建的对象，并时常会接受参数用以设定实例变量。<br>在 JavaScript 中，又是怎么去实现 OOP 编程呢？</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"Atwood’s-Law\"><a href=\"#Atwood’s-Law\" class=\"headerlink\" title=\"Atwood’s Law\"></a>Atwood’s Law</h2><div class=\"note info\">\nAny application that can be written in JavaScript, will eventually be written in JavaScript.<br>\n(任何可以用JavaScript来写的应用，最终都将用JavaScript来写。)\n</div>\n\n<hr>\n\n<h2 id=\"Before-ES6\"><a href=\"#Before-ES6\" class=\"headerlink\" title=\"Before ES6\"></a>Before ES6</h2><p>在 JavaScript 中，创建对象的模板是构造函数（ECMA6之前，没有 <code>class</code> 关键字），而在其他语言中创建对象的模板是类。</p>\n<p>JavaScript 传统的创建对象方法有点怪异，是用函数的形式去封装一个对象：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, subject, score</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name; <span class=\"comment\">// 通过 this 去给当前对象动态地添加一个属性 or 方法</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">var</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">\"Wang\"</span>, <span class=\"string\">\"JavaScript\"</span>, <span class=\"number\">100</span>); <span class=\"comment\">// 通过 new 关键字去创建一个对象</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建对象的几种方式\"><a href=\"#创建对象的几种方式\" class=\"headerlink\" title=\"创建对象的几种方式\"></a>创建对象的几种方式</h3><h4 id=\"new-Object\"><a href=\"#new-Object\" class=\"headerlink\" title=\"new Object()\"></a>new Object()</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> student = <span class=\"keyword\">new</span> <span class=\"built_in\">Object</span>();  <span class=\"comment\">// 创建一个空对象</span></span><br><span class=\"line\">student.name = <span class=\"string\">'wang'</span>;       <span class=\"comment\">// 动态地去给对象添加属性 or 方法</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"对象字面量\"><a href=\"#对象字面量\" class=\"headerlink\" title=\"对象字面量 {}\"></a>对象字面量 {}</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> student = &#123;&#125;;           <span class=\"comment\">// 创建一个空对象，等同于 new Object();</span></span><br><span class=\"line\">student.name = <span class=\"string\">'xxx'</span>;       <span class=\"comment\">// 动态地去给对象添加属性 or 方法</span></span><br></pre></td></tr></table></figure>\n\n<p>或者直接令某个变量去引用一个自定义对象：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> student = &#123;</span><br><span class=\"line\">    name: <span class=\"string\">'xxx'</span>,</span><br><span class=\"line\">    age: <span class=\"number\">20</span></span><br><span class=\"line\">&#125;; <span class=\"comment\">// 类似字典，键就是属性名，值就是属性值</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"工厂函数（工厂方法）\"><a href=\"#工厂函数（工厂方法）\" class=\"headerlink\" title=\"工厂函数（工厂方法）\"></a>工厂函数（工厂方法）</h4><p>与 <a href=\"https://zh.wikipedia.org/wiki/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95\" target=\"_blank\">工厂方法模式</a> 类似，Client 去通知某个对象的工厂，传入对应的参数去获得一个对象：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">studentFactory</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> <span class=\"built_in\">Object</span>();</span><br><span class=\"line\">    student.name = name;</span><br><span class=\"line\">    student.age = age;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> student; <span class=\"comment\">// 工厂方法将包装好的对象送给 Client</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<div class=\"note danger\">\n但是通过这种方法，Client 所接到的对象类型是 <b>object</b>，因为通过了 <code>new Object()</code> 来创建的，应该令他的类型为 <b>student</b>。\n\n<p>即，这种方法产生的对象，<code>student instanceof Student === false</code>，不方便判断对象类型。</p>\n<p>所有对象使用 <code>typeof object</code> 得到的答案都为 <code>object</code>，但使用构造函数可以使用 <code>instanceof</code> 去判断具体类型。</p>\n</div>\n\n<h4 id=\"构造函数\"><a href=\"#构造函数\" class=\"headerlink\" title=\"构造函数\"></a>构造函数</h4><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 构造函数首字母大写驼峰（就像类名）</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, subject, score</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.subject = subject;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.score = score;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.toString = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">`&#123;name=<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>, subject=<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.subject&#125;</span>, score=<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.score&#125;</span>&#125;`</span>;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol>\n<li>构造函数在使用的时候，首先会在内存中创建一个空对象</li>\n<li>设置构造函数的 this，让 this 指向刚刚创建好的对象</li>\n<li>执行构造函数中的代码</li>\n<li>最后返回这个对象（以上的行为都无须用户显式使用）</li>\n</ol>\n<p>构造函数创建的对象，使用 typeof 得到的答案仍然为 <strong>object</strong>，但使用构造函数创建的对象，可以使用 <code>student instanceof Student === true</code> 去得知具体类型。</p>\n<div class=\"note info\">\n每个对象中都有一个属性，student.constructor，这个属性的值为创建这个对象的构造函数本身，\n所以也可以使用 <code>student.constructor === Student</code> 去判断对象的类型，但不建议这样使用（这使用的就是 <b>__proto__</b> 中的 <b>constructor</b>，关于原型会在 <a href=\"https://www.wqh4u.cn/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/\" target=\"_blank\">JavaScript 原型</a> 中提到）\n</div>\n\n<h3 id=\"如何去选择构造器\"><a href=\"#如何去选择构造器\" class=\"headerlink\" title=\"如何去选择构造器\"></a>如何去选择构造器</h3><p>在 JavaScript 中，使用字面量（静态成员）去创建工具类，而使用构造函数（示例成员）去创建一般类。</p>\n<p>工具类就像 Math，一般类就像 Date：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 工具类</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> Tools = &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 获取一个在 [min, max] 中的随机数</span></span><br><span class=\"line\">    <span class=\"comment\">// 这个函数可以直接由 Tools.getRandomNumber(); 去调用，而不需去 new 一个 Tools 对象</span></span><br><span class=\"line\">    <span class=\"comment\">// 就像 Math.floor()、Math.ceil() 这样</span></span><br><span class=\"line\">    getRandomNumber: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">min, max</span>) </span>&#123;</span><br><span class=\"line\">        min = <span class=\"built_in\">Math</span>.ceil(min);</span><br><span class=\"line\">        max = <span class=\"built_in\">Math</span>.floor(max);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">Math</span>.floor(<span class=\"built_in\">Math</span>.random() * (max - min + <span class=\"number\">1</span>)) + min;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(Tools.getRandomNumber(<span class=\"number\">0</span>, <span class=\"number\">100</span>)); <span class=\"comment\">// 就像类的静态方法一样</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 一般类</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">    <span class=\"comment\">// ......</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 当我们需要使用学生对象时，则需要使用 new 关键字去获得一个学生对象</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"After-ES6\"><a href=\"#After-ES6\" class=\"headerlink\" title=\"After ES6\"></a>After ES6</h2><p>在 ES6 标准中，JavaScript 也支持了使用 <code>class</code> 关键字这种创建一个类的方法：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(name, age) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    toString() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">`&#123;name=<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>, subject=<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.subject&#125;</span>, score=<span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.score&#125;</span>&#125;`</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(student.toString());</span><br></pre></td></tr></table></figure>"},{"title":"JavaScript面向对象-02-Prototype","date":"2019-12-07T16:42:51.000Z","updated":"2020-01-13T16:39:01.000Z","copyright":true,"_content":"\n> <span class = 'introduction'>盛年不重来，一日难再晨。及时宜自勉，岁月不待人。</span><br/>\n这里由 Euphoria 个人总结了一些 JavaScript 中 prototype 原型的理解与使用方法~来看看叭\n\n<!--more-->\n\n<hr/>\n\n## 为什么要使用 prototype\n\n### 发现问题\n\n在 <a href=\"http://www.wqh4u.cn/2019/12/07/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-01-Constructor/\">上一篇博客</a> 中简单地介绍了 JavaScript 中如何去写 OOP，那趁热来再写一个（不使用 ES6 中的 `class` 关键字，下同）：\n\n```javascript\nfunction People(name, age) {\n    this.name = name;\n    this.age = age;\n\n    this.getInformation = function () {\n        return `{name: ${this.name}, age: ${this.age}}`\n    }\n}\n\nlet people_one = new People('wang', 20);\n\nconsole.log(people_one.getInformation());\n```\n\n显而易见，它会输出 `{name: wang, age: 20}`。\n\n现在让我们再来声明一个对象 `people_two`：\n\n```javascript\nlet people_two = new People('li', 18);\n\nconsole.log(people_two.getInformation());\n```\n\n在这里我们很容易得知，这两个对象都是 People 类的实例，每个实例拥有两个属性 **name** 和 **age**，每个实例也拥有一个方法 **getInformation()**。\n\n<span class=\"red-target\">但是！JavaScript 看起来并不是那么简单</span>\n\n在 JavaScript 中，如果某个类含有方法，在创建对象时，**每个对象在内存中都有一个方法的存储**，这可就令人头疼，每一个方法都单独的存储在这个对象中，无形中就造成了内存的浪费。\n\n### 一个并不是怎么好的解决方法\n\n不要在构造函数中声明方法，而是声明一个全局的方法，在构造函数中去引用这个函数即可，这样每个对象在创建时，所引用的都为一个方法。\n\n```javascript\nfunction getInformation() {\n    return `{name: ${this.name}, age: ${this.age}}`\n}\n\nfunction People(name, age) {\n    this.name = name;\n    this.age = age;\n\n    this.getInformation = getInformation;\n}\n\nlet people_one = new People('wang', 20);\n\nconsole.log(people_one.getInformation());\n```\n\n但是这个方法并不建议使用，因为需要去声明一个全局的命名函数，丧失了 OOP 最基本的封装性。\n\n<hr />\n\n## prototype\n\n每一个构造函数，都有一个属性，这个属性就被称作原型（原型对象）。\n\n既然这个值是对象，那么可以给这个对象去动态地去增加一些属性 or 方法：\n\n```javascript\nfunction People(name, age) {\n    this.name = name;\n    this.age = age;\n}\n\nPeople.prototype.getInformation = function() {\n    // 想想这里为什么不能用箭头函数呢？\n    return `{name: ${this.name}, age: ${this.age}}`;\n};\n\nlet people_one = new People('wang', 20);\n\nconsole.log(people_one.getInformation());\n```\n\n既然构造函数在内存中只有一份，那么这个构造方法所对应的原型对象也只有一份，所以这个原型中的值也会只有一份。\n\n通过构造函数所创建的对象，都可以直接地去访问原型中的成员，不需要显式地写 `prototype`。\n\n<h3>对象中的 __proto__</h3>\n\n每个对象也有一个属性 `__proto__` 指向了构造函数的原型，即 `object.__proto__ === Constructor.prototype`。\n\n<div class=\"note danger\">__proto__ 属性是非标准属性，在生产环境中不建议使用。</div>\n\n### constructor\n\n在原型中有一个属性 `constructor`，这个属性指向了构造函数，其作用是记录了创建该对象的构造器。\n即 object.`__proto__`.constructor === object.constructor === Constructor === Constructor.prototype.constructor\n\n<hr />\n\n## 原型链\n\n<h3>突然出现的 __proto__</h3>\n\n如果我们在浏览器（默认 Chrome，下同）中打印出来 `People` 的 `prototype` 的话，可以看到它是一个对象，且具有三个值：\n\n<img src=\"./prototype_dir.png\" alt=\"一个类的原型\" />\n\n康康我们发现了什么！我们在 `People` 这个类的 `prototype` 里面竟然发现了一个 `__proto__`！\n\n前面有说到这个 `prototype` 是一个对象，又恰好每个对象都有一个 `__proto__` 属性，这就不难理解了。\n\n来让我们继续康康这个 `__proto__` 中有什么东西：\n\n<img src=\"./base__proto__.png\" alt=\"上一层原型\" />\n\n可以看到一大堆定义的属性和方法，更神奇的是，我们竟然可以直接用 People 的实例去调用这些方法！\n\n```javascript\nconsole.dir(people_one.toString()); // 输出 '[object Object]'\n```\n\n在这些方法中，我们又发现了一个特殊的属性 `constructor`，这代表着构造函数，再结合刚刚所说的 object.`__proto__`.constructor === object.constructor === Constructor === Constructor.prototype.constructor，那么就说明这是由一个特殊的类（构造函数）创造的对象中的 `__proto__`！\n\n接下来看看这个 `constructor` 中到底有什么：\n\n<img src=\"./object.png\" alt=\"Object 构造函数\" />\n\n这个构造方法的名称竟然是 `Object`！是不是已经有一些学 Java 的小伙伴懂了。\n\n### 什么是原型链\n\n<img src=\"./yuanxinglian.png\" alt=\"原型链\" />\n\n<div class=\"note info\">原型对象的最顶层，即 Object 的原型对象（`Object.prototype.__proto__`）是 null。</div>\n\n我们可以非常简单地认为，`People` 类继承了 `Object` 类！\n\n为了证实我们的想法，我们再新建一个 `Student` 类：\n\n```javascript\nfunction Student(name, age, studentId) {\n    this.studentId = studentId;\n}\n\nlet student = new Student('li', 18, 12345);\n```\n\n为什么接受三个参数呢？因为要搞一个继承出来！按照继承链的写法，我们了解到了：\n\n1. `Student.prototype` 和 `student.__proto__` 严格等于；\n2. 'Student.prototype.__proto__' 本来是 `Object`，所以 `student` 可以用 `Object` 中的方法；\n3. 'People.prototype.__proto__' 也是 'Object'。\n\n那么我们只需要将 `Student.prototype.__proto__` 设置为 `People.prototype`：\n\n```javascript\nfunction Student(name, age, studentId) {\n    this.studentId = studentId;\n    this.__proto__.name = name;\n    this.__proto__.age = age;\n}\n\nStudent.prototype.__proto__ = People.prototype;\n\nlet student = new Student('li', 18, 12345);\n```\n\n<div class=\"note success\">在构造函数中的 this 就是当前对象，那么当前对象的 __proto__ 属性就是它的原型 People，而 name 和 age 又在 People 上，所以写为 this.__proto__.name = name;</div>\n\n<div class=\"note info\">为什么不直接写 this.name = name 呢？</div>\n\n### 方法重载\n\n当调用对象的属性或方法时，会先去寻找当前构造函数中的属性或方法，如果没有，将会去寻找原型中的属性或方法，不断迭代至无上一级原型（null），那么会报错。\n\n先找 当前的构造函数中 => 再找原型 => 原型的构造函数 => 原型构造函数的原型 => ... => null（最顶级原型），这使得 JavaScript 实现了方法的重写。\n\n有了原型链，我们要重载方法也就很简单了：\n\n```javascript\nfunction Student(name, age, studentId) {\n    this.studentId = studentId;\n    this.__proto__.name = name;\n    this.__proto__.age = age;\n}\n\nStudent.prototype.__proto__ = People.prototype;\n\n// 重载了 People 中的 getInformation 方法\nStudent.prototype.getInformation = function() {\n    return `{name: ${this.name}, age: ${this.age}, studentId: ${this.studentId}}`;\n};\n\nlet student = new Student('li', 18, 12345);\n\nconsole.log(student.getInformation());\n```\n\n<hr />\n\n## End？\n\n<div class=\"note info\">所有总结、截图与代码均由个人总结，请想转载的哥哥姐姐们一定要记得注明出处奥，要不然挺不好看的。既然是个人总结，难免会有纰漏或错误，如有看官发现还恳请告知，我会及时核对并纠错，在此谢过！</div>\n\n再出一篇 《JavaScript面向对象-03-原型中的注意点》吧~","source":"_posts/JavaScript面向对象-02-Prototype.md","raw":"---\ntitle: JavaScript面向对象-02-Prototype\ndate: 2019-12-08 00:42:51\nupdated: 2020-01-14 00:39:01\ntags:\n- Web\n- JavaScript\ncategories:\n- 前端\n- 面经\n- JavaScript\ncopyright: true\n---\n\n> <span class = 'introduction'>盛年不重来，一日难再晨。及时宜自勉，岁月不待人。</span><br/>\n这里由 Euphoria 个人总结了一些 JavaScript 中 prototype 原型的理解与使用方法~来看看叭\n\n<!--more-->\n\n<hr/>\n\n## 为什么要使用 prototype\n\n### 发现问题\n\n在 <a href=\"http://www.wqh4u.cn/2019/12/07/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-01-Constructor/\">上一篇博客</a> 中简单地介绍了 JavaScript 中如何去写 OOP，那趁热来再写一个（不使用 ES6 中的 `class` 关键字，下同）：\n\n```javascript\nfunction People(name, age) {\n    this.name = name;\n    this.age = age;\n\n    this.getInformation = function () {\n        return `{name: ${this.name}, age: ${this.age}}`\n    }\n}\n\nlet people_one = new People('wang', 20);\n\nconsole.log(people_one.getInformation());\n```\n\n显而易见，它会输出 `{name: wang, age: 20}`。\n\n现在让我们再来声明一个对象 `people_two`：\n\n```javascript\nlet people_two = new People('li', 18);\n\nconsole.log(people_two.getInformation());\n```\n\n在这里我们很容易得知，这两个对象都是 People 类的实例，每个实例拥有两个属性 **name** 和 **age**，每个实例也拥有一个方法 **getInformation()**。\n\n<span class=\"red-target\">但是！JavaScript 看起来并不是那么简单</span>\n\n在 JavaScript 中，如果某个类含有方法，在创建对象时，**每个对象在内存中都有一个方法的存储**，这可就令人头疼，每一个方法都单独的存储在这个对象中，无形中就造成了内存的浪费。\n\n### 一个并不是怎么好的解决方法\n\n不要在构造函数中声明方法，而是声明一个全局的方法，在构造函数中去引用这个函数即可，这样每个对象在创建时，所引用的都为一个方法。\n\n```javascript\nfunction getInformation() {\n    return `{name: ${this.name}, age: ${this.age}}`\n}\n\nfunction People(name, age) {\n    this.name = name;\n    this.age = age;\n\n    this.getInformation = getInformation;\n}\n\nlet people_one = new People('wang', 20);\n\nconsole.log(people_one.getInformation());\n```\n\n但是这个方法并不建议使用，因为需要去声明一个全局的命名函数，丧失了 OOP 最基本的封装性。\n\n<hr />\n\n## prototype\n\n每一个构造函数，都有一个属性，这个属性就被称作原型（原型对象）。\n\n既然这个值是对象，那么可以给这个对象去动态地去增加一些属性 or 方法：\n\n```javascript\nfunction People(name, age) {\n    this.name = name;\n    this.age = age;\n}\n\nPeople.prototype.getInformation = function() {\n    // 想想这里为什么不能用箭头函数呢？\n    return `{name: ${this.name}, age: ${this.age}}`;\n};\n\nlet people_one = new People('wang', 20);\n\nconsole.log(people_one.getInformation());\n```\n\n既然构造函数在内存中只有一份，那么这个构造方法所对应的原型对象也只有一份，所以这个原型中的值也会只有一份。\n\n通过构造函数所创建的对象，都可以直接地去访问原型中的成员，不需要显式地写 `prototype`。\n\n<h3>对象中的 __proto__</h3>\n\n每个对象也有一个属性 `__proto__` 指向了构造函数的原型，即 `object.__proto__ === Constructor.prototype`。\n\n<div class=\"note danger\">__proto__ 属性是非标准属性，在生产环境中不建议使用。</div>\n\n### constructor\n\n在原型中有一个属性 `constructor`，这个属性指向了构造函数，其作用是记录了创建该对象的构造器。\n即 object.`__proto__`.constructor === object.constructor === Constructor === Constructor.prototype.constructor\n\n<hr />\n\n## 原型链\n\n<h3>突然出现的 __proto__</h3>\n\n如果我们在浏览器（默认 Chrome，下同）中打印出来 `People` 的 `prototype` 的话，可以看到它是一个对象，且具有三个值：\n\n<img src=\"./prototype_dir.png\" alt=\"一个类的原型\" />\n\n康康我们发现了什么！我们在 `People` 这个类的 `prototype` 里面竟然发现了一个 `__proto__`！\n\n前面有说到这个 `prototype` 是一个对象，又恰好每个对象都有一个 `__proto__` 属性，这就不难理解了。\n\n来让我们继续康康这个 `__proto__` 中有什么东西：\n\n<img src=\"./base__proto__.png\" alt=\"上一层原型\" />\n\n可以看到一大堆定义的属性和方法，更神奇的是，我们竟然可以直接用 People 的实例去调用这些方法！\n\n```javascript\nconsole.dir(people_one.toString()); // 输出 '[object Object]'\n```\n\n在这些方法中，我们又发现了一个特殊的属性 `constructor`，这代表着构造函数，再结合刚刚所说的 object.`__proto__`.constructor === object.constructor === Constructor === Constructor.prototype.constructor，那么就说明这是由一个特殊的类（构造函数）创造的对象中的 `__proto__`！\n\n接下来看看这个 `constructor` 中到底有什么：\n\n<img src=\"./object.png\" alt=\"Object 构造函数\" />\n\n这个构造方法的名称竟然是 `Object`！是不是已经有一些学 Java 的小伙伴懂了。\n\n### 什么是原型链\n\n<img src=\"./yuanxinglian.png\" alt=\"原型链\" />\n\n<div class=\"note info\">原型对象的最顶层，即 Object 的原型对象（`Object.prototype.__proto__`）是 null。</div>\n\n我们可以非常简单地认为，`People` 类继承了 `Object` 类！\n\n为了证实我们的想法，我们再新建一个 `Student` 类：\n\n```javascript\nfunction Student(name, age, studentId) {\n    this.studentId = studentId;\n}\n\nlet student = new Student('li', 18, 12345);\n```\n\n为什么接受三个参数呢？因为要搞一个继承出来！按照继承链的写法，我们了解到了：\n\n1. `Student.prototype` 和 `student.__proto__` 严格等于；\n2. 'Student.prototype.__proto__' 本来是 `Object`，所以 `student` 可以用 `Object` 中的方法；\n3. 'People.prototype.__proto__' 也是 'Object'。\n\n那么我们只需要将 `Student.prototype.__proto__` 设置为 `People.prototype`：\n\n```javascript\nfunction Student(name, age, studentId) {\n    this.studentId = studentId;\n    this.__proto__.name = name;\n    this.__proto__.age = age;\n}\n\nStudent.prototype.__proto__ = People.prototype;\n\nlet student = new Student('li', 18, 12345);\n```\n\n<div class=\"note success\">在构造函数中的 this 就是当前对象，那么当前对象的 __proto__ 属性就是它的原型 People，而 name 和 age 又在 People 上，所以写为 this.__proto__.name = name;</div>\n\n<div class=\"note info\">为什么不直接写 this.name = name 呢？</div>\n\n### 方法重载\n\n当调用对象的属性或方法时，会先去寻找当前构造函数中的属性或方法，如果没有，将会去寻找原型中的属性或方法，不断迭代至无上一级原型（null），那么会报错。\n\n先找 当前的构造函数中 => 再找原型 => 原型的构造函数 => 原型构造函数的原型 => ... => null（最顶级原型），这使得 JavaScript 实现了方法的重写。\n\n有了原型链，我们要重载方法也就很简单了：\n\n```javascript\nfunction Student(name, age, studentId) {\n    this.studentId = studentId;\n    this.__proto__.name = name;\n    this.__proto__.age = age;\n}\n\nStudent.prototype.__proto__ = People.prototype;\n\n// 重载了 People 中的 getInformation 方法\nStudent.prototype.getInformation = function() {\n    return `{name: ${this.name}, age: ${this.age}, studentId: ${this.studentId}}`;\n};\n\nlet student = new Student('li', 18, 12345);\n\nconsole.log(student.getInformation());\n```\n\n<hr />\n\n## End？\n\n<div class=\"note info\">所有总结、截图与代码均由个人总结，请想转载的哥哥姐姐们一定要记得注明出处奥，要不然挺不好看的。既然是个人总结，难免会有纰漏或错误，如有看官发现还恳请告知，我会及时核对并纠错，在此谢过！</div>\n\n再出一篇 《JavaScript面向对象-03-原型中的注意点》吧~","slug":"JavaScript面向对象-02-Prototype","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn5y000q2lwjckj9ayrl","content":"<blockquote>\n<p><span class=\"introduction\">盛年不重来，一日难再晨。及时宜自勉，岁月不待人。</span><br><br>这里由 Euphoria 个人总结了一些 JavaScript 中 prototype 原型的理解与使用方法~来看看叭</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"为什么要使用-prototype\"><a href=\"#为什么要使用-prototype\" class=\"headerlink\" title=\"为什么要使用 prototype\"></a>为什么要使用 prototype</h2><h3 id=\"发现问题\"><a href=\"#发现问题\" class=\"headerlink\" title=\"发现问题\"></a>发现问题</h3><p>在 <a href=\"http://www.wqh4u.cn/2019/12/07/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-01-Constructor/\">上一篇博客</a> 中简单地介绍了 JavaScript 中如何去写 OOP，那趁热来再写一个（不使用 ES6 中的 <code>class</code> 关键字，下同）：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">People</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.getInformation = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">`&#123;name: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>, age: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.age&#125;</span>&#125;`</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people_one = <span class=\"keyword\">new</span> People(<span class=\"string\">'wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people_one.getInformation());</span><br></pre></td></tr></table></figure>\n\n<p>显而易见，它会输出 <code>{name: wang, age: 20}</code>。</p>\n<p>现在让我们再来声明一个对象 <code>people_two</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> people_two = <span class=\"keyword\">new</span> People(<span class=\"string\">'li'</span>, <span class=\"number\">18</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people_two.getInformation());</span><br></pre></td></tr></table></figure>\n\n<p>在这里我们很容易得知，这两个对象都是 People 类的实例，每个实例拥有两个属性 <strong>name</strong> 和 <strong>age</strong>，每个实例也拥有一个方法 <strong>getInformation()</strong>。</p>\n<p><span class=\"red-target\">但是！JavaScript 看起来并不是那么简单</span></p>\n<p>在 JavaScript 中，如果某个类含有方法，在创建对象时，<strong>每个对象在内存中都有一个方法的存储</strong>，这可就令人头疼，每一个方法都单独的存储在这个对象中，无形中就造成了内存的浪费。</p>\n<h3 id=\"一个并不是怎么好的解决方法\"><a href=\"#一个并不是怎么好的解决方法\" class=\"headerlink\" title=\"一个并不是怎么好的解决方法\"></a>一个并不是怎么好的解决方法</h3><p>不要在构造函数中声明方法，而是声明一个全局的方法，在构造函数中去引用这个函数即可，这样每个对象在创建时，所引用的都为一个方法。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getInformation</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">`&#123;name: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>, age: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.age&#125;</span>&#125;`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">People</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.getInformation = getInformation;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people_one = <span class=\"keyword\">new</span> People(<span class=\"string\">'wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people_one.getInformation());</span><br></pre></td></tr></table></figure>\n\n<p>但是这个方法并不建议使用，因为需要去声明一个全局的命名函数，丧失了 OOP 最基本的封装性。</p>\n<hr>\n\n<h2 id=\"prototype\"><a href=\"#prototype\" class=\"headerlink\" title=\"prototype\"></a>prototype</h2><p>每一个构造函数，都有一个属性，这个属性就被称作原型（原型对象）。</p>\n<p>既然这个值是对象，那么可以给这个对象去动态地去增加一些属性 or 方法：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">People</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">People.prototype.getInformation = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 想想这里为什么不能用箭头函数呢？</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">`&#123;name: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>, age: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.age&#125;</span>&#125;`</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people_one = <span class=\"keyword\">new</span> People(<span class=\"string\">'wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people_one.getInformation());</span><br></pre></td></tr></table></figure>\n\n<p>既然构造函数在内存中只有一份，那么这个构造方法所对应的原型对象也只有一份，所以这个原型中的值也会只有一份。</p>\n<p>通过构造函数所创建的对象，都可以直接地去访问原型中的成员，不需要显式地写 <code>prototype</code>。</p>\n<h3>对象中的 __proto__</h3>\n\n<p>每个对象也有一个属性 <code>__proto__</code> 指向了构造函数的原型，即 <code>object.__proto__ === Constructor.prototype</code>。</p>\n<div class=\"note danger\">__proto__ 属性是非标准属性，在生产环境中不建议使用。</div>\n\n<h3 id=\"constructor-NaN\"><a href=\"#constructor-NaN\" class=\"headerlink\" title=\"constructor\"></a>constructor</h3><p>在原型中有一个属性 <code>constructor</code>，这个属性指向了构造函数，其作用是记录了创建该对象的构造器。<br>即 object.<code>__proto__</code>.constructor === object.constructor === Constructor === Constructor.prototype.constructor</p>\n<hr>\n\n<h2 id=\"原型链\"><a href=\"#原型链\" class=\"headerlink\" title=\"原型链\"></a>原型链</h2><h3>突然出现的 __proto__</h3>\n\n<p>如果我们在浏览器（默认 Chrome，下同）中打印出来 <code>People</code> 的 <code>prototype</code> 的话，可以看到它是一个对象，且具有三个值：</p>\n<img src=\"/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/prototype_dir.png\" alt=\"一个类的原型\">\n\n<p>康康我们发现了什么！我们在 <code>People</code> 这个类的 <code>prototype</code> 里面竟然发现了一个 <code>__proto__</code>！</p>\n<p>前面有说到这个 <code>prototype</code> 是一个对象，又恰好每个对象都有一个 <code>__proto__</code> 属性，这就不难理解了。</p>\n<p>来让我们继续康康这个 <code>__proto__</code> 中有什么东西：</p>\n<img src=\"/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/base__proto__.png\" alt=\"上一层原型\">\n\n<p>可以看到一大堆定义的属性和方法，更神奇的是，我们竟然可以直接用 People 的实例去调用这些方法！</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">console</span>.dir(people_one.toString()); <span class=\"comment\">// 输出 '[object Object]'</span></span><br></pre></td></tr></table></figure>\n\n<p>在这些方法中，我们又发现了一个特殊的属性 <code>constructor</code>，这代表着构造函数，再结合刚刚所说的 object.<code>__proto__</code>.constructor === object.constructor === Constructor === Constructor.prototype.constructor，那么就说明这是由一个特殊的类（构造函数）创造的对象中的 <code>__proto__</code>！</p>\n<p>接下来看看这个 <code>constructor</code> 中到底有什么：</p>\n<img src=\"/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/object.png\" alt=\"Object 构造函数\">\n\n<p>这个构造方法的名称竟然是 <code>Object</code>！是不是已经有一些学 Java 的小伙伴懂了。</p>\n<h3 id=\"什么是原型链\"><a href=\"#什么是原型链\" class=\"headerlink\" title=\"什么是原型链\"></a>什么是原型链</h3><img src=\"/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/yuanxinglian.png\" alt=\"原型链\">\n\n<div class=\"note info\">原型对象的最顶层，即 Object 的原型对象（`Object.prototype.__proto__`）是 null。</div>\n\n<p>我们可以非常简单地认为，<code>People</code> 类继承了 <code>Object</code> 类！</p>\n<p>为了证实我们的想法，我们再新建一个 <code>Student</code> 类：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, age, studentId</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.studentId = studentId;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">'li'</span>, <span class=\"number\">18</span>, <span class=\"number\">12345</span>);</span><br></pre></td></tr></table></figure>\n\n<p>为什么接受三个参数呢？因为要搞一个继承出来！按照继承链的写法，我们了解到了：</p>\n<ol>\n<li><code>Student.prototype</code> 和 <code>student.__proto__</code> 严格等于；</li>\n<li>‘Student.prototype.<strong>proto</strong>‘ 本来是 <code>Object</code>，所以 <code>student</code> 可以用 <code>Object</code> 中的方法；</li>\n<li>‘People.prototype.<strong>proto</strong>‘ 也是 ‘Object’。</li>\n</ol>\n<p>那么我们只需要将 <code>Student.prototype.__proto__</code> 设置为 <code>People.prototype</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, age, studentId</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.studentId = studentId;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.__proto__.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.__proto__.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Student.prototype.__proto__ = People.prototype;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">'li'</span>, <span class=\"number\">18</span>, <span class=\"number\">12345</span>);</span><br></pre></td></tr></table></figure>\n\n<div class=\"note success\">在构造函数中的 this 就是当前对象，那么当前对象的 __proto__ 属性就是它的原型 People，而 name 和 age 又在 People 上，所以写为 this.__proto__.name = name;</div>\n\n<div class=\"note info\">为什么不直接写 this.name = name 呢？</div>\n\n<h3 id=\"方法重载\"><a href=\"#方法重载\" class=\"headerlink\" title=\"方法重载\"></a>方法重载</h3><p>当调用对象的属性或方法时，会先去寻找当前构造函数中的属性或方法，如果没有，将会去寻找原型中的属性或方法，不断迭代至无上一级原型（null），那么会报错。</p>\n<p>先找 当前的构造函数中 =&gt; 再找原型 =&gt; 原型的构造函数 =&gt; 原型构造函数的原型 =&gt; … =&gt; null（最顶级原型），这使得 JavaScript 实现了方法的重写。</p>\n<p>有了原型链，我们要重载方法也就很简单了：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, age, studentId</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.studentId = studentId;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.__proto__.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.__proto__.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Student.prototype.__proto__ = People.prototype;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 重载了 People 中的 getInformation 方法</span></span><br><span class=\"line\">Student.prototype.getInformation = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">`&#123;name: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>, age: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.age&#125;</span>, studentId: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.studentId&#125;</span>&#125;`</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">'li'</span>, <span class=\"number\">18</span>, <span class=\"number\">12345</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(student.getInformation());</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"End？\"><a href=\"#End？\" class=\"headerlink\" title=\"End？\"></a>End？</h2><div class=\"note info\">所有总结、截图与代码均由个人总结，请想转载的哥哥姐姐们一定要记得注明出处奥，要不然挺不好看的。既然是个人总结，难免会有纰漏或错误，如有看官发现还恳请告知，我会及时核对并纠错，在此谢过！</div>\n\n<p>再出一篇 《JavaScript面向对象-03-原型中的注意点》吧~</p>\n","site":{"data":{}},"length":4053,"excerpt":"<blockquote>\n<p><span class=\"introduction\">盛年不重来，一日难再晨。及时宜自勉，岁月不待人。</span><br><br>这里由 Euphoria 个人总结了一些 JavaScript 中 prototype 原型的理解与使用方法~来看看叭</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"为什么要使用-prototype\"><a href=\"#为什么要使用-prototype\" class=\"headerlink\" title=\"为什么要使用 prototype\"></a>为什么要使用 prototype</h2><h3 id=\"发现问题\"><a href=\"#发现问题\" class=\"headerlink\" title=\"发现问题\"></a>发现问题</h3><p>在 <a href=\"http://www.wqh4u.cn/2019/12/07/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-01-Constructor/\">上一篇博客</a> 中简单地介绍了 JavaScript 中如何去写 OOP，那趁热来再写一个（不使用 ES6 中的 <code>class</code> 关键字，下同）：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">People</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.getInformation = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">`&#123;name: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>, age: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.age&#125;</span>&#125;`</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people_one = <span class=\"keyword\">new</span> People(<span class=\"string\">'wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people_one.getInformation());</span><br></pre></td></tr></table></figure>\n\n<p>显而易见，它会输出 <code>{name: wang, age: 20}</code>。</p>\n<p>现在让我们再来声明一个对象 <code>people_two</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> people_two = <span class=\"keyword\">new</span> People(<span class=\"string\">'li'</span>, <span class=\"number\">18</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people_two.getInformation());</span><br></pre></td></tr></table></figure>\n\n<p>在这里我们很容易得知，这两个对象都是 People 类的实例，每个实例拥有两个属性 <strong>name</strong> 和 <strong>age</strong>，每个实例也拥有一个方法 <strong>getInformation()</strong>。</p>\n<p><span class=\"red-target\">但是！JavaScript 看起来并不是那么简单</span></p>\n<p>在 JavaScript 中，如果某个类含有方法，在创建对象时，<strong>每个对象在内存中都有一个方法的存储</strong>，这可就令人头疼，每一个方法都单独的存储在这个对象中，无形中就造成了内存的浪费。</p>\n<h3 id=\"一个并不是怎么好的解决方法\"><a href=\"#一个并不是怎么好的解决方法\" class=\"headerlink\" title=\"一个并不是怎么好的解决方法\"></a>一个并不是怎么好的解决方法</h3><p>不要在构造函数中声明方法，而是声明一个全局的方法，在构造函数中去引用这个函数即可，这样每个对象在创建时，所引用的都为一个方法。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getInformation</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">`&#123;name: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>, age: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.age&#125;</span>&#125;`</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">People</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.getInformation = getInformation;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people_one = <span class=\"keyword\">new</span> People(<span class=\"string\">'wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people_one.getInformation());</span><br></pre></td></tr></table></figure>\n\n<p>但是这个方法并不建议使用，因为需要去声明一个全局的命名函数，丧失了 OOP 最基本的封装性。</p>\n<hr>\n\n<h2 id=\"prototype\"><a href=\"#prototype\" class=\"headerlink\" title=\"prototype\"></a>prototype</h2><p>每一个构造函数，都有一个属性，这个属性就被称作原型（原型对象）。</p>\n<p>既然这个值是对象，那么可以给这个对象去动态地去增加一些属性 or 方法：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">People</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">People.prototype.getInformation = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 想想这里为什么不能用箭头函数呢？</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">`&#123;name: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>, age: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.age&#125;</span>&#125;`</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people_one = <span class=\"keyword\">new</span> People(<span class=\"string\">'wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people_one.getInformation());</span><br></pre></td></tr></table></figure>\n\n<p>既然构造函数在内存中只有一份，那么这个构造方法所对应的原型对象也只有一份，所以这个原型中的值也会只有一份。</p>\n<p>通过构造函数所创建的对象，都可以直接地去访问原型中的成员，不需要显式地写 <code>prototype</code>。</p>\n<h3>对象中的 __proto__</h3>\n\n<p>每个对象也有一个属性 <code>__proto__</code> 指向了构造函数的原型，即 <code>object.__proto__ === Constructor.prototype</code>。</p>\n<div class=\"note danger\">__proto__ 属性是非标准属性，在生产环境中不建议使用。</div>\n\n<h3 id=\"constructor-NaN\"><a href=\"#constructor-NaN\" class=\"headerlink\" title=\"constructor\"></a>constructor</h3><p>在原型中有一个属性 <code>constructor</code>，这个属性指向了构造函数，其作用是记录了创建该对象的构造器。<br>即 object.<code>__proto__</code>.constructor === object.constructor === Constructor === Constructor.prototype.constructor</p>\n<hr>\n\n<h2 id=\"原型链\"><a href=\"#原型链\" class=\"headerlink\" title=\"原型链\"></a>原型链</h2><h3>突然出现的 __proto__</h3>\n\n<p>如果我们在浏览器（默认 Chrome，下同）中打印出来 <code>People</code> 的 <code>prototype</code> 的话，可以看到它是一个对象，且具有三个值：</p>\n<img src=\"/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/prototype_dir.png\" alt=\"一个类的原型\">\n\n<p>康康我们发现了什么！我们在 <code>People</code> 这个类的 <code>prototype</code> 里面竟然发现了一个 <code>__proto__</code>！</p>\n<p>前面有说到这个 <code>prototype</code> 是一个对象，又恰好每个对象都有一个 <code>__proto__</code> 属性，这就不难理解了。</p>\n<p>来让我们继续康康这个 <code>__proto__</code> 中有什么东西：</p>\n<img src=\"/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/base__proto__.png\" alt=\"上一层原型\">\n\n<p>可以看到一大堆定义的属性和方法，更神奇的是，我们竟然可以直接用 People 的实例去调用这些方法！</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">console</span>.dir(people_one.toString()); <span class=\"comment\">// 输出 '[object Object]'</span></span><br></pre></td></tr></table></figure>\n\n<p>在这些方法中，我们又发现了一个特殊的属性 <code>constructor</code>，这代表着构造函数，再结合刚刚所说的 object.<code>__proto__</code>.constructor === object.constructor === Constructor === Constructor.prototype.constructor，那么就说明这是由一个特殊的类（构造函数）创造的对象中的 <code>__proto__</code>！</p>\n<p>接下来看看这个 <code>constructor</code> 中到底有什么：</p>\n<img src=\"/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/object.png\" alt=\"Object 构造函数\">\n\n<p>这个构造方法的名称竟然是 <code>Object</code>！是不是已经有一些学 Java 的小伙伴懂了。</p>\n<h3 id=\"什么是原型链\"><a href=\"#什么是原型链\" class=\"headerlink\" title=\"什么是原型链\"></a>什么是原型链</h3><img src=\"/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/yuanxinglian.png\" alt=\"原型链\">\n\n<div class=\"note info\">原型对象的最顶层，即 Object 的原型对象（`Object.prototype.__proto__`）是 null。</div>\n\n<p>我们可以非常简单地认为，<code>People</code> 类继承了 <code>Object</code> 类！</p>\n<p>为了证实我们的想法，我们再新建一个 <code>Student</code> 类：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, age, studentId</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.studentId = studentId;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">'li'</span>, <span class=\"number\">18</span>, <span class=\"number\">12345</span>);</span><br></pre></td></tr></table></figure>\n\n<p>为什么接受三个参数呢？因为要搞一个继承出来！按照继承链的写法，我们了解到了：</p>\n<ol>\n<li><code>Student.prototype</code> 和 <code>student.__proto__</code> 严格等于；</li>\n<li>‘Student.prototype.<strong>proto</strong>‘ 本来是 <code>Object</code>，所以 <code>student</code> 可以用 <code>Object</code> 中的方法；</li>\n<li>‘People.prototype.<strong>proto</strong>‘ 也是 ‘Object’。</li>\n</ol>\n<p>那么我们只需要将 <code>Student.prototype.__proto__</code> 设置为 <code>People.prototype</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, age, studentId</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.studentId = studentId;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.__proto__.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.__proto__.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Student.prototype.__proto__ = People.prototype;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">'li'</span>, <span class=\"number\">18</span>, <span class=\"number\">12345</span>);</span><br></pre></td></tr></table></figure>\n\n<div class=\"note success\">在构造函数中的 this 就是当前对象，那么当前对象的 __proto__ 属性就是它的原型 People，而 name 和 age 又在 People 上，所以写为 this.__proto__.name = name;</div>\n\n<div class=\"note info\">为什么不直接写 this.name = name 呢？</div>\n\n<h3 id=\"方法重载\"><a href=\"#方法重载\" class=\"headerlink\" title=\"方法重载\"></a>方法重载</h3><p>当调用对象的属性或方法时，会先去寻找当前构造函数中的属性或方法，如果没有，将会去寻找原型中的属性或方法，不断迭代至无上一级原型（null），那么会报错。</p>\n<p>先找 当前的构造函数中 =&gt; 再找原型 =&gt; 原型的构造函数 =&gt; 原型构造函数的原型 =&gt; … =&gt; null（最顶级原型），这使得 JavaScript 实现了方法的重写。</p>\n<p>有了原型链，我们要重载方法也就很简单了：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, age, studentId</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.studentId = studentId;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.__proto__.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.__proto__.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Student.prototype.__proto__ = People.prototype;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 重载了 People 中的 getInformation 方法</span></span><br><span class=\"line\">Student.prototype.getInformation = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">`&#123;name: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.name&#125;</span>, age: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.age&#125;</span>, studentId: <span class=\"subst\">$&#123;<span class=\"keyword\">this</span>.studentId&#125;</span>&#125;`</span>;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">'li'</span>, <span class=\"number\">18</span>, <span class=\"number\">12345</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(student.getInformation());</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"End？\"><a href=\"#End？\" class=\"headerlink\" title=\"End？\"></a>End？</h2><div class=\"note info\">所有总结、截图与代码均由个人总结，请想转载的哥哥姐姐们一定要记得注明出处奥，要不然挺不好看的。既然是个人总结，难免会有纰漏或错误，如有看官发现还恳请告知，我会及时核对并纠错，在此谢过！</div>\n\n<p>再出一篇 《JavaScript面向对象-03-原型中的注意点》吧~</p>"},{"title":"JavaScript面向对象-03-原型中的注意点","date":"2020-01-13T16:55:53.000Z","updated":"2020-01-13T18:14:37.000Z","copyright":true,"_content":"\n> <span class = 'introduction'>有人在光明中注视着阴影，有人在阴影中眺望着光明。</span><br/>\n解决了 JS-OOP-02 中的一个小尾巴，也说了一些关于 Getter 和 Setter 对于原型链的访问问题，还有一些奇奇怪怪的问题（甚至还有一个没有搞明白的问题？？？）\n\n<!--more-->\n\n<hr/>\n\n## 上一篇中的小尾巴\n\n在 <a href=\"https://www.wqh4u.cn/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/\" target=\"__blank\">JavaScript面向对象-02-Prototype</a> 中，我们利用原型链搞了一个伪继承出来：\n\n```javascript\nfunction Student(name, age, studentId) {\n    this.studentId = studentId;\n    this.__proto__.name = name; // 为什么不直接写 this.name = name 呢？\n    this.__proto__.age = age; // 为什么不直接写 this.age = age 呢？\n}\n\nStudent.prototype.__proto__ = People.prototype;\n\nlet student = new Student('li', 18, 12345);\n```\n\n接下来就来处理这个小尾巴！\n\n<hr />\n\n## 特殊的 Getter 和 Setter 机制\n\n### 发现问题\n\n现在我们声明一个类 `ChinesePeople`：\n\n```javascript\nfunction ChinesePeople(name, age) {\n    this.name = name;\n    this.age = age;\n}\n\nlet people = new ChinesePeople('Wang', 20);\n\nconsole.log(people.toString());\n```\n\n这样看起来没有什么问题，`toString()` 是 `Object` 原型中的一个方法，又因为 `ChinesePeople.prototype.__proto__` 就是 `Object.prototype`，所以 `ChinesePeople` 的实例调用 `toString()` 方法是没有问题的。\n\n既然原型上的属性或方法是所有对象共享的，那么可以通过原型去当方法区去存储，或者存储一些特殊变量：\n\n```javascript\nfunction ChinesePeople(name, age) {\n    this.name = name;\n    this.age = age;\n}\n\nChinesePeople.prototype.homeland = 'China No.1';\n\nlet people = new ChinesePeople('Wang', 20);\n\nconsole.log(people.homeland); // China No.1\n```\n\n我们可以将其看作一个静态成员变量，所有的对象都是共享的，即使它可以用很多种方式去访问：\n\n```javascript\nfunction ChinesePeople(name, age) {\n    this.name = name;\n    this.age = age;\n}\n\nChinesePeople.prototype.homeland = 'China No.1';\nChinesePeople.prototype.getHomeland = function() {\n    return this.homeland;\n};\n\nlet people = new ChinesePeople('Wang', 20);\n\nconsole.log(ChinesePeople.prototype.homeland); // 构造函数.原型对象.属性\nconsole.log(people.homeland); // 对象.属性\nconsole.log(people.getHomeland()); // this.属性\n```\n\n突然有一天来了一个 **喜欢玩推特的中国人**：\n\n```javascript\nlet tweeterLover = new ChinesePeople('建国', 18);\n```\n\n然后 ta 突然将 `homeland` 属性改为了 `China No.2`：\n\n```javascript\nlet people = new ChinesePeople('Wang', 20);\n\nconsole.log(ChinesePeople.prototype.homeland); // China No.1\nconsole.log(people.homeland); // China No.1\nconsole.log(people.getHomeland()); // China No.1\n\nlet tweeterLover = new ChinesePeople('建国', 18);\nChinesePeople.prototype.homeland = 'China No.2';\n\nconsole.log(ChinesePeople.prototype.homeland); // China No.2\nconsole.log(people.homeland); // China No.2\nconsole.log(people.getHomeland()); // China No.2\n```\n\nta 又觉得这样不太 OK，因为 ta 并没有什么实际性的动作，在冥思苦想后发现了重点：\n\n- 访问 `homeland` 有三种方法；\n- ta 使用了 `ChinesePeople.prototype.homeland` 去直接修改；\n- ta 没有使用 `对象.属性` 或 `this.属性` 去修改，这样会很没有牌面；\n\n于是 ta 通过自己（`对象.属性`），去修改了 `homeland` 的值：\n\n```javascript\nlet people = new ChinesePeople('Wang', 20);\n\nconsole.log(ChinesePeople.prototype.homeland); // China No.1\nconsole.log(people.homeland); // China No.1\nconsole.log(people.getHomeland()); // China No.1\n\nlet tweeterLover = new ChinesePeople('建国', 18);\ntweeterLover.homeland = 'China No.2';\n\nconsole.log(ChinesePeople.prototype.homeland); // China No.1\nconsole.log(people.homeland); // China No.1\nconsole.log(people.getHomeland()); // China No.1\n\nconsole.log(tweeterLover.homeland); // China No.2\nconsole.log(tweeterLover.getHomeland()); // China No.2\n```\n\n结果惊人的一幕出现了，别人的 `homeland` 都没有发生改变，并且在这之后也只有 ta 自己的 `homeland` 改为了他想要的，即使调用了存在于原型上的 `getHomeland()` 方法也一样。\n\n### 正常的 Getter\n\n<div class=\"note success\">在读取对象的属性或方法时，会顺序查找原型链，如果当前对象内不存在这个属性，那么就会向上一层去搜索原型链，直到 null。</div>\n\n所以在访问 `homeland` 的时候，因为对象内部并不存在这个属性，此时就会向上不断地去查找原型链，结果在 `People.prototype` 中发现了 `homeland` 的定义，故最开始都会返回 `China No.1`。\n\n### 奇怪的 Setter\n\n<div class=\"note danger\">在设置对象的属性或方法时，<b>不会去访问原型</b>，而是直接给对象添加一个这样的属性，因为对象内部属性查询优先级高于其原型链，那么就会发生覆盖。</div>\n\n这样就真相大白了，建国同志在使用 `tweeterLover.homeland='China No.2'` 的时候，其实是给自己内部添加了一个新的、只属于他自己的 `homeland`。\n\n在设置完成后，即使他使用 `对象.homeland` 去访问，这时候按照 **Getter** 流程，其对象内部就存在了 `homeland` 这个属性，所以也就不会去访问存在于原型链上的值了。\n\n### 奇怪的 Setter（2）\n\n如果对象内部并不存在某个成员，但是它的原型链上存在，就像刚刚的 `homeland` 一样，那么如果出现了下面这样的代码：\n\n```javascript\nfunction ChinesePeople(name, age) {\n    this.name = name;\n    this.age = age;\n}\n\nChinesePeople.prototype.homeland = 'China No.1';\n\nlet people = new ChinesePeople('Wang', 20);\n\npeople.homeland = people.homeland; // 真的是一行没有用的语句吗？\n```\n\n分析 `people.homeland = people.homeland`：\n\n1. 这是一个赋值表达式，'=' 运算符会将右侧的只赋予左侧的值；\n2. 右值是 `people.homeland`，这就相当于 Getter，因为在查询时可以省略写 `__proto__`；\n3. 所以，右值也就是 `people.__proto__.homeland`；\n4. 然而左值是一个 Setter，其直接使用了 `对象.属性` 的方法，不会去查找原型链；\n5. 因为对象可以动态地设置属性 or 方法，所以 `people` 对象会多出来一个 `homeland` 属性，其值与 `people.__proto__.homeland` 相同；\n\n<div class=\"note info\">就是说！拿，可以查找原型链，但是放，不行（不包括直接通过构造函数去设置其原型）。</div>\n\n<hr />\n\n## 更方便地设置 prototype\n\n对于一个自定义类，常常不止一个方法，那么可能会出现以下的情况：\n\n```javascript\nPeople.prototype.methodOne = function() {};\nPeople.prototype.methodTwo = function() {};\nPeople.prototype.methodThree = function() {};\n// ......\n```\n\n<div class=\"note danger\">这样会非常的麻烦，显得代码十分臃肿。</div>\n\n既然 People.prototype 是一个对象，那么就可以为其进行重新赋值，令一个新的对象以键值对的方式给其赋值：\n\n```javascript\nPeople.prototype = {\n    methodOne: function() {},\n    methodTwo: function() {},\n    methodThree: function() {}\n    // ......\n};\n```\n\n这样提高了代码的可读性，可以重新改变 `prototype`的属性。\n\n<div class=\"note danger\">\n但是这样又出现一个问题，<b>People.prototype</b> 被赋予了一个新的值（引用），但 <b>People.prototype</b> 中应该具有一个特殊的属性 <b>People.prototype.constructor</b>\n这个属性指向了当前对象所处的构造函数，这个属性也帮助了程序员去获取这个对象的具体类型<b>（但即使这个时候，也可以使用 instanceof，这个不受影响）</b>。</div>\n\n即：如果通过覆盖 `People.prototype`，那么此时 `People.prototype.constructor` 则应该是 `Object` 或 `People.prototype.__protype__.constructor`，而不是 `People`。\n\n<div class=\"note success\">所以在覆盖 People.prototype 时，需要手动地去添加一个 constructor 属性，值为构造函数本身。</div>\n\n```javascript\nPeople.prototype = {\n    constructor: People, // 手动地设置其构造器\n    methodOne: function() {},\n    methodTwo: function() {},\n    methodThree: function() {}\n    // ......\n};\n```\n\n<hr />\n\n## 又一个奇怪的问题（尚未解决）\n\n现在必须先在原型中声明某个属性或方法，再去调用。（但是先创建这个对象，再去添加原型，这个对象中仍然会动态地去加入这个新方法？？？）\n\n代码如下：\n\n```javascript\nfunction Student(name, subject, score) {\n    this.name = name;\n    this.subject = subject;\n    this.score = score;\n}\n\nlet student = new Student(\"Wang\", \"Chinese\", 100);\n\nconsole.dir(student); // 这个时候打印出来的对象，原型里面已经包含了 sayHello() 方法？？？（前提是下一行被注释掉）\n// student.sayHello(); // 调用失败，错误信息为 sayHello() 未定义\n// 如果这一行被注释掉，程序成功运行结束，那么在上面打印出来的 student 中，可以在原型中找到 sayHello() 方法，即使位置在声明前\n// 如果这一行没有被注释掉，程序在此时报错中断，那么在上面打印出来的 student 中，就不会出现 sayHello() 方法？？？？？\n\nStudent.prototype.sayHello = function() {\n    console.log(\"Hello\");\n}; // 为原型添加一个方法\n\nconsole.dir(student); // 此时对象的原型中具有这个方法\nstudent.sayHello(); // 调用成功\n```\n\n（也许是类似于变量提升？？？恳请大佬指点）\n\n","source":"_posts/JavaScript面向对象-03-原型中的注意点.md","raw":"---\ntitle: JavaScript面向对象-03-原型中的注意点\ndate: 2020-01-14 00:55:53\nupdated: 2020-01-14 02:14:37\ntags:\n- Web\n- JavaScript\ncategories:\n- 前端\n- 面经\n- JavaScript\ncopyright: true\n---\n\n> <span class = 'introduction'>有人在光明中注视着阴影，有人在阴影中眺望着光明。</span><br/>\n解决了 JS-OOP-02 中的一个小尾巴，也说了一些关于 Getter 和 Setter 对于原型链的访问问题，还有一些奇奇怪怪的问题（甚至还有一个没有搞明白的问题？？？）\n\n<!--more-->\n\n<hr/>\n\n## 上一篇中的小尾巴\n\n在 <a href=\"https://www.wqh4u.cn/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/\" target=\"__blank\">JavaScript面向对象-02-Prototype</a> 中，我们利用原型链搞了一个伪继承出来：\n\n```javascript\nfunction Student(name, age, studentId) {\n    this.studentId = studentId;\n    this.__proto__.name = name; // 为什么不直接写 this.name = name 呢？\n    this.__proto__.age = age; // 为什么不直接写 this.age = age 呢？\n}\n\nStudent.prototype.__proto__ = People.prototype;\n\nlet student = new Student('li', 18, 12345);\n```\n\n接下来就来处理这个小尾巴！\n\n<hr />\n\n## 特殊的 Getter 和 Setter 机制\n\n### 发现问题\n\n现在我们声明一个类 `ChinesePeople`：\n\n```javascript\nfunction ChinesePeople(name, age) {\n    this.name = name;\n    this.age = age;\n}\n\nlet people = new ChinesePeople('Wang', 20);\n\nconsole.log(people.toString());\n```\n\n这样看起来没有什么问题，`toString()` 是 `Object` 原型中的一个方法，又因为 `ChinesePeople.prototype.__proto__` 就是 `Object.prototype`，所以 `ChinesePeople` 的实例调用 `toString()` 方法是没有问题的。\n\n既然原型上的属性或方法是所有对象共享的，那么可以通过原型去当方法区去存储，或者存储一些特殊变量：\n\n```javascript\nfunction ChinesePeople(name, age) {\n    this.name = name;\n    this.age = age;\n}\n\nChinesePeople.prototype.homeland = 'China No.1';\n\nlet people = new ChinesePeople('Wang', 20);\n\nconsole.log(people.homeland); // China No.1\n```\n\n我们可以将其看作一个静态成员变量，所有的对象都是共享的，即使它可以用很多种方式去访问：\n\n```javascript\nfunction ChinesePeople(name, age) {\n    this.name = name;\n    this.age = age;\n}\n\nChinesePeople.prototype.homeland = 'China No.1';\nChinesePeople.prototype.getHomeland = function() {\n    return this.homeland;\n};\n\nlet people = new ChinesePeople('Wang', 20);\n\nconsole.log(ChinesePeople.prototype.homeland); // 构造函数.原型对象.属性\nconsole.log(people.homeland); // 对象.属性\nconsole.log(people.getHomeland()); // this.属性\n```\n\n突然有一天来了一个 **喜欢玩推特的中国人**：\n\n```javascript\nlet tweeterLover = new ChinesePeople('建国', 18);\n```\n\n然后 ta 突然将 `homeland` 属性改为了 `China No.2`：\n\n```javascript\nlet people = new ChinesePeople('Wang', 20);\n\nconsole.log(ChinesePeople.prototype.homeland); // China No.1\nconsole.log(people.homeland); // China No.1\nconsole.log(people.getHomeland()); // China No.1\n\nlet tweeterLover = new ChinesePeople('建国', 18);\nChinesePeople.prototype.homeland = 'China No.2';\n\nconsole.log(ChinesePeople.prototype.homeland); // China No.2\nconsole.log(people.homeland); // China No.2\nconsole.log(people.getHomeland()); // China No.2\n```\n\nta 又觉得这样不太 OK，因为 ta 并没有什么实际性的动作，在冥思苦想后发现了重点：\n\n- 访问 `homeland` 有三种方法；\n- ta 使用了 `ChinesePeople.prototype.homeland` 去直接修改；\n- ta 没有使用 `对象.属性` 或 `this.属性` 去修改，这样会很没有牌面；\n\n于是 ta 通过自己（`对象.属性`），去修改了 `homeland` 的值：\n\n```javascript\nlet people = new ChinesePeople('Wang', 20);\n\nconsole.log(ChinesePeople.prototype.homeland); // China No.1\nconsole.log(people.homeland); // China No.1\nconsole.log(people.getHomeland()); // China No.1\n\nlet tweeterLover = new ChinesePeople('建国', 18);\ntweeterLover.homeland = 'China No.2';\n\nconsole.log(ChinesePeople.prototype.homeland); // China No.1\nconsole.log(people.homeland); // China No.1\nconsole.log(people.getHomeland()); // China No.1\n\nconsole.log(tweeterLover.homeland); // China No.2\nconsole.log(tweeterLover.getHomeland()); // China No.2\n```\n\n结果惊人的一幕出现了，别人的 `homeland` 都没有发生改变，并且在这之后也只有 ta 自己的 `homeland` 改为了他想要的，即使调用了存在于原型上的 `getHomeland()` 方法也一样。\n\n### 正常的 Getter\n\n<div class=\"note success\">在读取对象的属性或方法时，会顺序查找原型链，如果当前对象内不存在这个属性，那么就会向上一层去搜索原型链，直到 null。</div>\n\n所以在访问 `homeland` 的时候，因为对象内部并不存在这个属性，此时就会向上不断地去查找原型链，结果在 `People.prototype` 中发现了 `homeland` 的定义，故最开始都会返回 `China No.1`。\n\n### 奇怪的 Setter\n\n<div class=\"note danger\">在设置对象的属性或方法时，<b>不会去访问原型</b>，而是直接给对象添加一个这样的属性，因为对象内部属性查询优先级高于其原型链，那么就会发生覆盖。</div>\n\n这样就真相大白了，建国同志在使用 `tweeterLover.homeland='China No.2'` 的时候，其实是给自己内部添加了一个新的、只属于他自己的 `homeland`。\n\n在设置完成后，即使他使用 `对象.homeland` 去访问，这时候按照 **Getter** 流程，其对象内部就存在了 `homeland` 这个属性，所以也就不会去访问存在于原型链上的值了。\n\n### 奇怪的 Setter（2）\n\n如果对象内部并不存在某个成员，但是它的原型链上存在，就像刚刚的 `homeland` 一样，那么如果出现了下面这样的代码：\n\n```javascript\nfunction ChinesePeople(name, age) {\n    this.name = name;\n    this.age = age;\n}\n\nChinesePeople.prototype.homeland = 'China No.1';\n\nlet people = new ChinesePeople('Wang', 20);\n\npeople.homeland = people.homeland; // 真的是一行没有用的语句吗？\n```\n\n分析 `people.homeland = people.homeland`：\n\n1. 这是一个赋值表达式，'=' 运算符会将右侧的只赋予左侧的值；\n2. 右值是 `people.homeland`，这就相当于 Getter，因为在查询时可以省略写 `__proto__`；\n3. 所以，右值也就是 `people.__proto__.homeland`；\n4. 然而左值是一个 Setter，其直接使用了 `对象.属性` 的方法，不会去查找原型链；\n5. 因为对象可以动态地设置属性 or 方法，所以 `people` 对象会多出来一个 `homeland` 属性，其值与 `people.__proto__.homeland` 相同；\n\n<div class=\"note info\">就是说！拿，可以查找原型链，但是放，不行（不包括直接通过构造函数去设置其原型）。</div>\n\n<hr />\n\n## 更方便地设置 prototype\n\n对于一个自定义类，常常不止一个方法，那么可能会出现以下的情况：\n\n```javascript\nPeople.prototype.methodOne = function() {};\nPeople.prototype.methodTwo = function() {};\nPeople.prototype.methodThree = function() {};\n// ......\n```\n\n<div class=\"note danger\">这样会非常的麻烦，显得代码十分臃肿。</div>\n\n既然 People.prototype 是一个对象，那么就可以为其进行重新赋值，令一个新的对象以键值对的方式给其赋值：\n\n```javascript\nPeople.prototype = {\n    methodOne: function() {},\n    methodTwo: function() {},\n    methodThree: function() {}\n    // ......\n};\n```\n\n这样提高了代码的可读性，可以重新改变 `prototype`的属性。\n\n<div class=\"note danger\">\n但是这样又出现一个问题，<b>People.prototype</b> 被赋予了一个新的值（引用），但 <b>People.prototype</b> 中应该具有一个特殊的属性 <b>People.prototype.constructor</b>\n这个属性指向了当前对象所处的构造函数，这个属性也帮助了程序员去获取这个对象的具体类型<b>（但即使这个时候，也可以使用 instanceof，这个不受影响）</b>。</div>\n\n即：如果通过覆盖 `People.prototype`，那么此时 `People.prototype.constructor` 则应该是 `Object` 或 `People.prototype.__protype__.constructor`，而不是 `People`。\n\n<div class=\"note success\">所以在覆盖 People.prototype 时，需要手动地去添加一个 constructor 属性，值为构造函数本身。</div>\n\n```javascript\nPeople.prototype = {\n    constructor: People, // 手动地设置其构造器\n    methodOne: function() {},\n    methodTwo: function() {},\n    methodThree: function() {}\n    // ......\n};\n```\n\n<hr />\n\n## 又一个奇怪的问题（尚未解决）\n\n现在必须先在原型中声明某个属性或方法，再去调用。（但是先创建这个对象，再去添加原型，这个对象中仍然会动态地去加入这个新方法？？？）\n\n代码如下：\n\n```javascript\nfunction Student(name, subject, score) {\n    this.name = name;\n    this.subject = subject;\n    this.score = score;\n}\n\nlet student = new Student(\"Wang\", \"Chinese\", 100);\n\nconsole.dir(student); // 这个时候打印出来的对象，原型里面已经包含了 sayHello() 方法？？？（前提是下一行被注释掉）\n// student.sayHello(); // 调用失败，错误信息为 sayHello() 未定义\n// 如果这一行被注释掉，程序成功运行结束，那么在上面打印出来的 student 中，可以在原型中找到 sayHello() 方法，即使位置在声明前\n// 如果这一行没有被注释掉，程序在此时报错中断，那么在上面打印出来的 student 中，就不会出现 sayHello() 方法？？？？？\n\nStudent.prototype.sayHello = function() {\n    console.log(\"Hello\");\n}; // 为原型添加一个方法\n\nconsole.dir(student); // 此时对象的原型中具有这个方法\nstudent.sayHello(); // 调用成功\n```\n\n（也许是类似于变量提升？？？恳请大佬指点）\n\n","slug":"JavaScript面向对象-03-原型中的注意点","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn5z000s2lwjdzglgd8p","content":"<blockquote>\n<p><span class=\"introduction\">有人在光明中注视着阴影，有人在阴影中眺望着光明。</span><br><br>解决了 JS-OOP-02 中的一个小尾巴，也说了一些关于 Getter 和 Setter 对于原型链的访问问题，还有一些奇奇怪怪的问题（甚至还有一个没有搞明白的问题？？？）</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"上一篇中的小尾巴\"><a href=\"#上一篇中的小尾巴\" class=\"headerlink\" title=\"上一篇中的小尾巴\"></a>上一篇中的小尾巴</h2><p>在 <a href=\"https://www.wqh4u.cn/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/\" target=\"__blank\">JavaScript面向对象-02-Prototype</a> 中，我们利用原型链搞了一个伪继承出来：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, age, studentId</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.studentId = studentId;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.__proto__.name = name; <span class=\"comment\">// 为什么不直接写 this.name = name 呢？</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.__proto__.age = age; <span class=\"comment\">// 为什么不直接写 this.age = age 呢？</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Student.prototype.__proto__ = People.prototype;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">'li'</span>, <span class=\"number\">18</span>, <span class=\"number\">12345</span>);</span><br></pre></td></tr></table></figure>\n\n<p>接下来就来处理这个小尾巴！</p>\n<hr>\n\n<h2 id=\"特殊的-Getter-和-Setter-机制\"><a href=\"#特殊的-Getter-和-Setter-机制\" class=\"headerlink\" title=\"特殊的 Getter 和 Setter 机制\"></a>特殊的 Getter 和 Setter 机制</h2><h3 id=\"发现问题\"><a href=\"#发现问题\" class=\"headerlink\" title=\"发现问题\"></a>发现问题</h3><p>现在我们声明一个类 <code>ChinesePeople</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ChinesePeople</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.toString());</span><br></pre></td></tr></table></figure>\n\n<p>这样看起来没有什么问题，<code>toString()</code> 是 <code>Object</code> 原型中的一个方法，又因为 <code>ChinesePeople.prototype.__proto__</code> 就是 <code>Object.prototype</code>，所以 <code>ChinesePeople</code> 的实例调用 <code>toString()</code> 方法是没有问题的。</p>\n<p>既然原型上的属性或方法是所有对象共享的，那么可以通过原型去当方法区去存储，或者存储一些特殊变量：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ChinesePeople</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">ChinesePeople.prototype.homeland = <span class=\"string\">'China No.1'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.homeland); <span class=\"comment\">// China No.1</span></span><br></pre></td></tr></table></figure>\n\n<p>我们可以将其看作一个静态成员变量，所有的对象都是共享的，即使它可以用很多种方式去访问：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ChinesePeople</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">ChinesePeople.prototype.homeland = <span class=\"string\">'China No.1'</span>;</span><br><span class=\"line\">ChinesePeople.prototype.getHomeland = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.homeland;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(ChinesePeople.prototype.homeland); <span class=\"comment\">// 构造函数.原型对象.属性</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.homeland); <span class=\"comment\">// 对象.属性</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.getHomeland()); <span class=\"comment\">// this.属性</span></span><br></pre></td></tr></table></figure>\n\n<p>突然有一天来了一个 <strong>喜欢玩推特的中国人</strong>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> tweeterLover = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'建国'</span>, <span class=\"number\">18</span>);</span><br></pre></td></tr></table></figure>\n\n<p>然后 ta 突然将 <code>homeland</code> 属性改为了 <code>China No.2</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> people = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(ChinesePeople.prototype.homeland); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.homeland); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.getHomeland()); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> tweeterLover = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'建国'</span>, <span class=\"number\">18</span>);</span><br><span class=\"line\">ChinesePeople.prototype.homeland = <span class=\"string\">'China No.2'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(ChinesePeople.prototype.homeland); <span class=\"comment\">// China No.2</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.homeland); <span class=\"comment\">// China No.2</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.getHomeland()); <span class=\"comment\">// China No.2</span></span><br></pre></td></tr></table></figure>\n\n<p>ta 又觉得这样不太 OK，因为 ta 并没有什么实际性的动作，在冥思苦想后发现了重点：</p>\n<ul>\n<li>访问 <code>homeland</code> 有三种方法；</li>\n<li>ta 使用了 <code>ChinesePeople.prototype.homeland</code> 去直接修改；</li>\n<li>ta 没有使用 <code>对象.属性</code> 或 <code>this.属性</code> 去修改，这样会很没有牌面；</li>\n</ul>\n<p>于是 ta 通过自己（<code>对象.属性</code>），去修改了 <code>homeland</code> 的值：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> people = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(ChinesePeople.prototype.homeland); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.homeland); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.getHomeland()); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> tweeterLover = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'建国'</span>, <span class=\"number\">18</span>);</span><br><span class=\"line\">tweeterLover.homeland = <span class=\"string\">'China No.2'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(ChinesePeople.prototype.homeland); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.homeland); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.getHomeland()); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(tweeterLover.homeland); <span class=\"comment\">// China No.2</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(tweeterLover.getHomeland()); <span class=\"comment\">// China No.2</span></span><br></pre></td></tr></table></figure>\n\n<p>结果惊人的一幕出现了，别人的 <code>homeland</code> 都没有发生改变，并且在这之后也只有 ta 自己的 <code>homeland</code> 改为了他想要的，即使调用了存在于原型上的 <code>getHomeland()</code> 方法也一样。</p>\n<h3 id=\"正常的-Getter\"><a href=\"#正常的-Getter\" class=\"headerlink\" title=\"正常的 Getter\"></a>正常的 Getter</h3><div class=\"note success\">在读取对象的属性或方法时，会顺序查找原型链，如果当前对象内不存在这个属性，那么就会向上一层去搜索原型链，直到 null。</div>\n\n<p>所以在访问 <code>homeland</code> 的时候，因为对象内部并不存在这个属性，此时就会向上不断地去查找原型链，结果在 <code>People.prototype</code> 中发现了 <code>homeland</code> 的定义，故最开始都会返回 <code>China No.1</code>。</p>\n<h3 id=\"奇怪的-Setter\"><a href=\"#奇怪的-Setter\" class=\"headerlink\" title=\"奇怪的 Setter\"></a>奇怪的 Setter</h3><div class=\"note danger\">在设置对象的属性或方法时，<b>不会去访问原型</b>，而是直接给对象添加一个这样的属性，因为对象内部属性查询优先级高于其原型链，那么就会发生覆盖。</div>\n\n<p>这样就真相大白了，建国同志在使用 <code>tweeterLover.homeland=&#39;China No.2&#39;</code> 的时候，其实是给自己内部添加了一个新的、只属于他自己的 <code>homeland</code>。</p>\n<p>在设置完成后，即使他使用 <code>对象.homeland</code> 去访问，这时候按照 <strong>Getter</strong> 流程，其对象内部就存在了 <code>homeland</code> 这个属性，所以也就不会去访问存在于原型链上的值了。</p>\n<h3 id=\"奇怪的-Setter（2）\"><a href=\"#奇怪的-Setter（2）\" class=\"headerlink\" title=\"奇怪的 Setter（2）\"></a>奇怪的 Setter（2）</h3><p>如果对象内部并不存在某个成员，但是它的原型链上存在，就像刚刚的 <code>homeland</code> 一样，那么如果出现了下面这样的代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ChinesePeople</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">ChinesePeople.prototype.homeland = <span class=\"string\">'China No.1'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">people.homeland = people.homeland; <span class=\"comment\">// 真的是一行没有用的语句吗？</span></span><br></pre></td></tr></table></figure>\n\n<p>分析 <code>people.homeland = people.homeland</code>：</p>\n<ol>\n<li>这是一个赋值表达式，’=’ 运算符会将右侧的只赋予左侧的值；</li>\n<li>右值是 <code>people.homeland</code>，这就相当于 Getter，因为在查询时可以省略写 <code>__proto__</code>；</li>\n<li>所以，右值也就是 <code>people.__proto__.homeland</code>；</li>\n<li>然而左值是一个 Setter，其直接使用了 <code>对象.属性</code> 的方法，不会去查找原型链；</li>\n<li>因为对象可以动态地设置属性 or 方法，所以 <code>people</code> 对象会多出来一个 <code>homeland</code> 属性，其值与 <code>people.__proto__.homeland</code> 相同；</li>\n</ol>\n<div class=\"note info\">就是说！拿，可以查找原型链，但是放，不行（不包括直接通过构造函数去设置其原型）。</div>\n\n<hr>\n\n<h2 id=\"更方便地设置-prototype\"><a href=\"#更方便地设置-prototype\" class=\"headerlink\" title=\"更方便地设置 prototype\"></a>更方便地设置 prototype</h2><p>对于一个自定义类，常常不止一个方法，那么可能会出现以下的情况：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">People.prototype.methodOne = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;;</span><br><span class=\"line\">People.prototype.methodTwo = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;;</span><br><span class=\"line\">People.prototype.methodThree = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;;</span><br><span class=\"line\"><span class=\"comment\">// ......</span></span><br></pre></td></tr></table></figure>\n\n<div class=\"note danger\">这样会非常的麻烦，显得代码十分臃肿。</div>\n\n<p>既然 People.prototype 是一个对象，那么就可以为其进行重新赋值，令一个新的对象以键值对的方式给其赋值：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">People.prototype = &#123;</span><br><span class=\"line\">    methodOne: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;,</span><br><span class=\"line\">    methodTwo: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;,</span><br><span class=\"line\">    methodThree: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\">// ......</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>这样提高了代码的可读性，可以重新改变 <code>prototype</code>的属性。</p>\n<div class=\"note danger\">\n但是这样又出现一个问题，<b>People.prototype</b> 被赋予了一个新的值（引用），但 <b>People.prototype</b> 中应该具有一个特殊的属性 <b>People.prototype.constructor</b>\n这个属性指向了当前对象所处的构造函数，这个属性也帮助了程序员去获取这个对象的具体类型<b>（但即使这个时候，也可以使用 instanceof，这个不受影响）</b>。</div>\n\n<p>即：如果通过覆盖 <code>People.prototype</code>，那么此时 <code>People.prototype.constructor</code> 则应该是 <code>Object</code> 或 <code>People.prototype.__protype__.constructor</code>，而不是 <code>People</code>。</p>\n<div class=\"note success\">所以在覆盖 People.prototype 时，需要手动地去添加一个 constructor 属性，值为构造函数本身。</div>\n\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">People.prototype = &#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>: People, // 手动地设置其构造器</span><br><span class=\"line\">    methodOne: function() &#123;&#125;,</span><br><span class=\"line\">    methodTwo: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;,</span><br><span class=\"line\">    methodThree: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\">// ......</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"又一个奇怪的问题（尚未解决）\"><a href=\"#又一个奇怪的问题（尚未解决）\" class=\"headerlink\" title=\"又一个奇怪的问题（尚未解决）\"></a>又一个奇怪的问题（尚未解决）</h2><p>现在必须先在原型中声明某个属性或方法，再去调用。（但是先创建这个对象，再去添加原型，这个对象中仍然会动态地去加入这个新方法？？？）</p>\n<p>代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, subject, score</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.subject = subject;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.score = score;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">\"Wang\"</span>, <span class=\"string\">\"Chinese\"</span>, <span class=\"number\">100</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.dir(student); <span class=\"comment\">// 这个时候打印出来的对象，原型里面已经包含了 sayHello() 方法？？？（前提是下一行被注释掉）</span></span><br><span class=\"line\"><span class=\"comment\">// student.sayHello(); // 调用失败，错误信息为 sayHello() 未定义</span></span><br><span class=\"line\"><span class=\"comment\">// 如果这一行被注释掉，程序成功运行结束，那么在上面打印出来的 student 中，可以在原型中找到 sayHello() 方法，即使位置在声明前</span></span><br><span class=\"line\"><span class=\"comment\">// 如果这一行没有被注释掉，程序在此时报错中断，那么在上面打印出来的 student 中，就不会出现 sayHello() 方法？？？？？</span></span><br><span class=\"line\"></span><br><span class=\"line\">Student.prototype.sayHello = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Hello\"</span>);</span><br><span class=\"line\">&#125;; <span class=\"comment\">// 为原型添加一个方法</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.dir(student); <span class=\"comment\">// 此时对象的原型中具有这个方法</span></span><br><span class=\"line\">student.sayHello(); <span class=\"comment\">// 调用成功</span></span><br></pre></td></tr></table></figure>\n\n<p>（也许是类似于变量提升？？？恳请大佬指点）</p>\n","site":{"data":{}},"length":5393,"excerpt":"<blockquote>\n<p><span class=\"introduction\">有人在光明中注视着阴影，有人在阴影中眺望着光明。</span><br><br>解决了 JS-OOP-02 中的一个小尾巴，也说了一些关于 Getter 和 Setter 对于原型链的访问问题，还有一些奇奇怪怪的问题（甚至还有一个没有搞明白的问题？？？）</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"上一篇中的小尾巴\"><a href=\"#上一篇中的小尾巴\" class=\"headerlink\" title=\"上一篇中的小尾巴\"></a>上一篇中的小尾巴</h2><p>在 <a href=\"https://www.wqh4u.cn/2019/12/08/JavaScript%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-02-Prototype/\" target=\"__blank\">JavaScript面向对象-02-Prototype</a> 中，我们利用原型链搞了一个伪继承出来：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, age, studentId</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.studentId = studentId;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.__proto__.name = name; <span class=\"comment\">// 为什么不直接写 this.name = name 呢？</span></span><br><span class=\"line\">    <span class=\"keyword\">this</span>.__proto__.age = age; <span class=\"comment\">// 为什么不直接写 this.age = age 呢？</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">Student.prototype.__proto__ = People.prototype;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">'li'</span>, <span class=\"number\">18</span>, <span class=\"number\">12345</span>);</span><br></pre></td></tr></table></figure>\n\n<p>接下来就来处理这个小尾巴！</p>\n<hr>\n\n<h2 id=\"特殊的-Getter-和-Setter-机制\"><a href=\"#特殊的-Getter-和-Setter-机制\" class=\"headerlink\" title=\"特殊的 Getter 和 Setter 机制\"></a>特殊的 Getter 和 Setter 机制</h2><h3 id=\"发现问题\"><a href=\"#发现问题\" class=\"headerlink\" title=\"发现问题\"></a>发现问题</h3><p>现在我们声明一个类 <code>ChinesePeople</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ChinesePeople</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.toString());</span><br></pre></td></tr></table></figure>\n\n<p>这样看起来没有什么问题，<code>toString()</code> 是 <code>Object</code> 原型中的一个方法，又因为 <code>ChinesePeople.prototype.__proto__</code> 就是 <code>Object.prototype</code>，所以 <code>ChinesePeople</code> 的实例调用 <code>toString()</code> 方法是没有问题的。</p>\n<p>既然原型上的属性或方法是所有对象共享的，那么可以通过原型去当方法区去存储，或者存储一些特殊变量：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ChinesePeople</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">ChinesePeople.prototype.homeland = <span class=\"string\">'China No.1'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.homeland); <span class=\"comment\">// China No.1</span></span><br></pre></td></tr></table></figure>\n\n<p>我们可以将其看作一个静态成员变量，所有的对象都是共享的，即使它可以用很多种方式去访问：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ChinesePeople</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">ChinesePeople.prototype.homeland = <span class=\"string\">'China No.1'</span>;</span><br><span class=\"line\">ChinesePeople.prototype.getHomeland = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.homeland;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(ChinesePeople.prototype.homeland); <span class=\"comment\">// 构造函数.原型对象.属性</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.homeland); <span class=\"comment\">// 对象.属性</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.getHomeland()); <span class=\"comment\">// this.属性</span></span><br></pre></td></tr></table></figure>\n\n<p>突然有一天来了一个 <strong>喜欢玩推特的中国人</strong>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> tweeterLover = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'建国'</span>, <span class=\"number\">18</span>);</span><br></pre></td></tr></table></figure>\n\n<p>然后 ta 突然将 <code>homeland</code> 属性改为了 <code>China No.2</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> people = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(ChinesePeople.prototype.homeland); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.homeland); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.getHomeland()); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> tweeterLover = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'建国'</span>, <span class=\"number\">18</span>);</span><br><span class=\"line\">ChinesePeople.prototype.homeland = <span class=\"string\">'China No.2'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(ChinesePeople.prototype.homeland); <span class=\"comment\">// China No.2</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.homeland); <span class=\"comment\">// China No.2</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.getHomeland()); <span class=\"comment\">// China No.2</span></span><br></pre></td></tr></table></figure>\n\n<p>ta 又觉得这样不太 OK，因为 ta 并没有什么实际性的动作，在冥思苦想后发现了重点：</p>\n<ul>\n<li>访问 <code>homeland</code> 有三种方法；</li>\n<li>ta 使用了 <code>ChinesePeople.prototype.homeland</code> 去直接修改；</li>\n<li>ta 没有使用 <code>对象.属性</code> 或 <code>this.属性</code> 去修改，这样会很没有牌面；</li>\n</ul>\n<p>于是 ta 通过自己（<code>对象.属性</code>），去修改了 <code>homeland</code> 的值：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> people = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(ChinesePeople.prototype.homeland); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.homeland); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.getHomeland()); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> tweeterLover = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'建国'</span>, <span class=\"number\">18</span>);</span><br><span class=\"line\">tweeterLover.homeland = <span class=\"string\">'China No.2'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(ChinesePeople.prototype.homeland); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.homeland); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(people.getHomeland()); <span class=\"comment\">// China No.1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(tweeterLover.homeland); <span class=\"comment\">// China No.2</span></span><br><span class=\"line\"><span class=\"built_in\">console</span>.log(tweeterLover.getHomeland()); <span class=\"comment\">// China No.2</span></span><br></pre></td></tr></table></figure>\n\n<p>结果惊人的一幕出现了，别人的 <code>homeland</code> 都没有发生改变，并且在这之后也只有 ta 自己的 <code>homeland</code> 改为了他想要的，即使调用了存在于原型上的 <code>getHomeland()</code> 方法也一样。</p>\n<h3 id=\"正常的-Getter\"><a href=\"#正常的-Getter\" class=\"headerlink\" title=\"正常的 Getter\"></a>正常的 Getter</h3><div class=\"note success\">在读取对象的属性或方法时，会顺序查找原型链，如果当前对象内不存在这个属性，那么就会向上一层去搜索原型链，直到 null。</div>\n\n<p>所以在访问 <code>homeland</code> 的时候，因为对象内部并不存在这个属性，此时就会向上不断地去查找原型链，结果在 <code>People.prototype</code> 中发现了 <code>homeland</code> 的定义，故最开始都会返回 <code>China No.1</code>。</p>\n<h3 id=\"奇怪的-Setter\"><a href=\"#奇怪的-Setter\" class=\"headerlink\" title=\"奇怪的 Setter\"></a>奇怪的 Setter</h3><div class=\"note danger\">在设置对象的属性或方法时，<b>不会去访问原型</b>，而是直接给对象添加一个这样的属性，因为对象内部属性查询优先级高于其原型链，那么就会发生覆盖。</div>\n\n<p>这样就真相大白了，建国同志在使用 <code>tweeterLover.homeland=&#39;China No.2&#39;</code> 的时候，其实是给自己内部添加了一个新的、只属于他自己的 <code>homeland</code>。</p>\n<p>在设置完成后，即使他使用 <code>对象.homeland</code> 去访问，这时候按照 <strong>Getter</strong> 流程，其对象内部就存在了 <code>homeland</code> 这个属性，所以也就不会去访问存在于原型链上的值了。</p>\n<h3 id=\"奇怪的-Setter（2）\"><a href=\"#奇怪的-Setter（2）\" class=\"headerlink\" title=\"奇怪的 Setter（2）\"></a>奇怪的 Setter（2）</h3><p>如果对象内部并不存在某个成员，但是它的原型链上存在，就像刚刚的 <code>homeland</code> 一样，那么如果出现了下面这样的代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ChinesePeople</span>(<span class=\"params\">name, age</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">ChinesePeople.prototype.homeland = <span class=\"string\">'China No.1'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> people = <span class=\"keyword\">new</span> ChinesePeople(<span class=\"string\">'Wang'</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">people.homeland = people.homeland; <span class=\"comment\">// 真的是一行没有用的语句吗？</span></span><br></pre></td></tr></table></figure>\n\n<p>分析 <code>people.homeland = people.homeland</code>：</p>\n<ol>\n<li>这是一个赋值表达式，’=’ 运算符会将右侧的只赋予左侧的值；</li>\n<li>右值是 <code>people.homeland</code>，这就相当于 Getter，因为在查询时可以省略写 <code>__proto__</code>；</li>\n<li>所以，右值也就是 <code>people.__proto__.homeland</code>；</li>\n<li>然而左值是一个 Setter，其直接使用了 <code>对象.属性</code> 的方法，不会去查找原型链；</li>\n<li>因为对象可以动态地设置属性 or 方法，所以 <code>people</code> 对象会多出来一个 <code>homeland</code> 属性，其值与 <code>people.__proto__.homeland</code> 相同；</li>\n</ol>\n<div class=\"note info\">就是说！拿，可以查找原型链，但是放，不行（不包括直接通过构造函数去设置其原型）。</div>\n\n<hr>\n\n<h2 id=\"更方便地设置-prototype\"><a href=\"#更方便地设置-prototype\" class=\"headerlink\" title=\"更方便地设置 prototype\"></a>更方便地设置 prototype</h2><p>对于一个自定义类，常常不止一个方法，那么可能会出现以下的情况：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">People.prototype.methodOne = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;;</span><br><span class=\"line\">People.prototype.methodTwo = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;;</span><br><span class=\"line\">People.prototype.methodThree = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;;</span><br><span class=\"line\"><span class=\"comment\">// ......</span></span><br></pre></td></tr></table></figure>\n\n<div class=\"note danger\">这样会非常的麻烦，显得代码十分臃肿。</div>\n\n<p>既然 People.prototype 是一个对象，那么就可以为其进行重新赋值，令一个新的对象以键值对的方式给其赋值：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">People.prototype = &#123;</span><br><span class=\"line\">    methodOne: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;,</span><br><span class=\"line\">    methodTwo: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;,</span><br><span class=\"line\">    methodThree: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\">// ......</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>这样提高了代码的可读性，可以重新改变 <code>prototype</code>的属性。</p>\n<div class=\"note danger\">\n但是这样又出现一个问题，<b>People.prototype</b> 被赋予了一个新的值（引用），但 <b>People.prototype</b> 中应该具有一个特殊的属性 <b>People.prototype.constructor</b>\n这个属性指向了当前对象所处的构造函数，这个属性也帮助了程序员去获取这个对象的具体类型<b>（但即使这个时候，也可以使用 instanceof，这个不受影响）</b>。</div>\n\n<p>即：如果通过覆盖 <code>People.prototype</code>，那么此时 <code>People.prototype.constructor</code> 则应该是 <code>Object</code> 或 <code>People.prototype.__protype__.constructor</code>，而不是 <code>People</code>。</p>\n<div class=\"note success\">所以在覆盖 People.prototype 时，需要手动地去添加一个 constructor 属性，值为构造函数本身。</div>\n\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">People.prototype = &#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>: People, // 手动地设置其构造器</span><br><span class=\"line\">    methodOne: function() &#123;&#125;,</span><br><span class=\"line\">    methodTwo: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;,</span><br><span class=\"line\">    methodThree: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;&#125;</span><br><span class=\"line\">    <span class=\"comment\">// ......</span></span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"又一个奇怪的问题（尚未解决）\"><a href=\"#又一个奇怪的问题（尚未解决）\" class=\"headerlink\" title=\"又一个奇怪的问题（尚未解决）\"></a>又一个奇怪的问题（尚未解决）</h2><p>现在必须先在原型中声明某个属性或方法，再去调用。（但是先创建这个对象，再去添加原型，这个对象中仍然会动态地去加入这个新方法？？？）</p>\n<p>代码如下：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Student</span>(<span class=\"params\">name, subject, score</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.subject = subject;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.score = score;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> student = <span class=\"keyword\">new</span> Student(<span class=\"string\">\"Wang\"</span>, <span class=\"string\">\"Chinese\"</span>, <span class=\"number\">100</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.dir(student); <span class=\"comment\">// 这个时候打印出来的对象，原型里面已经包含了 sayHello() 方法？？？（前提是下一行被注释掉）</span></span><br><span class=\"line\"><span class=\"comment\">// student.sayHello(); // 调用失败，错误信息为 sayHello() 未定义</span></span><br><span class=\"line\"><span class=\"comment\">// 如果这一行被注释掉，程序成功运行结束，那么在上面打印出来的 student 中，可以在原型中找到 sayHello() 方法，即使位置在声明前</span></span><br><span class=\"line\"><span class=\"comment\">// 如果这一行没有被注释掉，程序在此时报错中断，那么在上面打印出来的 student 中，就不会出现 sayHello() 方法？？？？？</span></span><br><span class=\"line\"></span><br><span class=\"line\">Student.prototype.sayHello = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">console</span>.log(<span class=\"string\">\"Hello\"</span>);</span><br><span class=\"line\">&#125;; <span class=\"comment\">// 为原型添加一个方法</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">console</span>.dir(student); <span class=\"comment\">// 此时对象的原型中具有这个方法</span></span><br><span class=\"line\">student.sayHello(); <span class=\"comment\">// 调用成功</span></span><br></pre></td></tr></table></figure>\n\n<p>（也许是类似于变量提升？？？恳请大佬指点）</p>"},{"title":"The K Nearest Neighbor Algorithm","date":"2019-10-15T03:34:41.000Z","copyright":true,"image":"http://www.wqh4u.cn/2019/10/15/The-K-Nearest-Neighbor-Algorithm/1024px-KnnClassification.svg.png","_content":"\n> <span class = 'introduction'>活着的目的不在于永远活着，而在于永远活出自己。</span><br/>\n在模式识别领域中，最近邻居法（KNN算法，又译K-近邻算法）是一种用于分类和回归的非参数统计方法。<br />在这两种情况下，输入包含特征空间（Feature Space）中的k个最接近的训练样本。\n<br />这次主要实现了使用原生 Python 来模拟一个 KNN 算法。\n\n<!--more-->\n\n<hr/>\n\n## k-nearest neighbors algorithm\n\n**K-NN** 是一种[基于实例的学习](https://en.wikipedia.org/wiki/Instance-based_learning)，或者是局部近似和将所有计算推迟到分类之后的[惰性学习](https://en.wikipedia.org/wiki/Lazy_learning)。k-近邻算法是所有的机器学习算法中最简单的之一。\n\n<ul>\n<li>在 <strong>k-NN</strong> 分类中，输出是一个分类族群。一个对象的分类是由其邻居的 <span class=\"blue-target\">“多数表决”</span> 确定的，k个最近邻居（k为正整数，通常较小）中最常见的分类决定了赋予该对象的类别。若 k = 1，则该对象的类别直接由最近的一个节点赋予。</li>\n<li>在 <strong>k-NN</strong> 回归中，输出是该对象的属性值。该值是其k个最近邻居的值的平均值。</li>\n</ul>\n\n无论是分类还是回归，衡量邻居的权重都非常有用，使较近邻居的权重比较远邻居的权重大。例如，一种常见的加权方案是给每个邻居权重赋值为 1/ d，其中 d 是到邻居的距离。\n\n<div class=\"note info\">邻居都取自一组已经正确分类（在回归的情况下，指属性值正确）的对象。虽然没要求明确的训练步骤，但这也可以当作是此算法的一个训练样本集。</div>\n\n<div class=\"note danger\">k-近邻算法的缺点是对数据的局部结构非常敏感。本算法与K-平均算法（另一流行的机器学习技术）没有任何关系，请勿与之混淆。</div>\n\n## Algorithm\n\n训练样本是多维特征空间向量，其中每个训练样本带有一个类别标签。算法的训练阶段只包含存储的[特征向量](https://zh.wikipedia.org/wiki/%E7%89%B9%E5%BE%81%E5%80%BC%E5%92%8C%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F)和训练样本的标签。\n\n在分类阶段，k是一个用户定义的常数。一个没有类别标签的向量（查询或测试点）将被归类为最接近该点的k个样本点中最频繁使用的一类。\n\n一般情况下，将[欧氏距离](https://zh.wikipedia.org/wiki/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E8%B7%9D%E7%A6%BB)作为距离度量，但是这是只适用于[连续变量](https://zh.wikipedia.org/wiki/概率分布#连续分布)。在文本分类这种离散变量情况下，另一个度量——重叠度量（或[海明距离](https://zh.wikipedia.org/wiki/汉明距离)）可以用来作为度量。例如对于基因表达微阵列数据，**k-NN** 也与 **Pearson** 和 **Spearman** 相关系数结合起来使用。通常情况下，如果运用一些特殊的算法来计算度量的话，k近邻分类精度可显著提高，如运用[大间隔最近邻居](https://zh.wikipedia.org/wiki/大间隔最近邻居)或者[邻里成分分析法](https://zh.wikipedia.org/wiki/邻里成分分析)。\n\n**“多数表决”** 分类会在类别分布偏斜时出现缺陷。也就是说，出现频率较多的样本将会主导测试点的预测结果，因为他们比较大可能出现在测试点的 K 邻域而测试点的属性又是通过 k 邻域内的样本计算出来的。解决这个缺点的方法之一是在进行分类时将样本到 k 个近邻点的距离考虑进去。k 近邻点中每一个的分类（对于回归问题来说，是数值）都乘以与测试点之间距离的成反比的权重。另一种克服偏斜的方式是通过数据表示形式的抽象。例如，在[自组织映射](https://zh.wikipedia.org/wiki/自组织映射)（SOM）中，每个节点是相似的点的一个集群的代表（中心），而与它们在原始训练数据的密度无关。**K-NN** 可以应用到 **SOM** 中。\n\n## 发展\n然而 k 最近邻居法因为计算量相当的大，所以相当的耗时，Ko 与 Seo 提出一算法 **TCFP**（**t**ext **c**ategorization using **f**eature **p**rojection），尝试利用[特征投影法](https://en.wikipedia.org/wiki/Feature_projection)来降低与分类无关的特征对于系统的影响，并借此提升系统性能，其实验结果显示其分类效果与 k 最近邻居法相近，但其运算所需时间仅需k最近邻居法运算时间的五十分之一。\n\n除了针对文件分类的效率，尚有研究针对如何促进k最近邻居法在文件分类方面的效果，如 Han 等人于 2002 年尝试利用[贪心法](https://zh.wikipedia.org/wiki/贪心算法)，针对文件分类实做可调整权重的k最近邻居法 **WAkNN**（**w**eighted **a**djusted **k** **n**earest **n**eighbor），以促进分类效果；而 Li 等人于 2004 年提出由于不同分类的文件本身有数量上有差异，因此也应该依照训练集合中各种分类的文件数量，选取不同数目的最近邻居，来参与分类。\n\n## Python 代码实现 \n\n```python\n# -*- coding: utf-8 -*-\n\"\"\"\nauthor: Wang Qinhong\ndate: 2019/10/14\ntitle: 模拟 K Nearest Neighbor Algorithm\nIDE: Jet Brains PyCharm 2019.2\n\"\"\"\n\nfrom sklearn.datasets import load_iris  # 从 sklearn 中导入鸢尾花数据集\nimport math  # 数学计算标准库\nfrom collections import Counter  # Collection标准库\nimport numpy as np  # 导入 numpy 科学计算库\n\n\nclass k_nearest_neighbor_algorithm:\n    \"\"\" Main K Nearest Neighbor Algorithm\n\n    定义了有关 KNN 算法的基础操作\n\n    Attributes:\n        x_train: training test of X\n        y_train: training test of Y\n        k: The numbers of neighbors\n    \"\"\"\n\n    def __init__(self, k):\n        \"\"\"\n        Default Constructor\n        :param k: The numbers of neighbors\n        \"\"\"\n        self.k = k\n        self.x_train = None\n        self.y_train = None\n\n    def fit(self, x_train, y_train):\n        \"\"\"\n        监督训练\n        :param x_train: training test of X\n        :param y_train: training test of Y\n        :return: This object\n        \"\"\"\n        self.x_train = x_train\n        self.y_train = y_train\n        return self\n\n    def predict(self, x_pretest):\n        \"\"\"\n        给定待预测数剧集，给出预测结果向量\n        :param x_pretest: 给定结果的数据集\n        :return: 预测结果向量\n        \"\"\"\n        y_pretest = [self.get_answer(x) for x in x_pretest]\n        return np.array(y_pretest)\n\n    def get_answer(self, test_data):\n        \"\"\"\n        给定单个数据，返回预测类别\n        :param test_data: 测试数据\n        :return: 预测结果\n        \"\"\"\n        # 计算距离\n        d = [math.sqrt(np.sum((test_data - self.x_train[iter]) ** 2)) for iter in range(len(self.x_train))]\n        near = np.argsort(d)\n        top_k = [self.y_train[iter] for iter in near[0:6]]\n        votes = Counter(top_k)  # 计算k个最近邻\n        return votes.most_common(1)[0][0]  # 预测结果\n\n\n# 载入数据集,有iris.data和iris.target\niris = load_iris()\n\nprint(\"TEST DATA: \")\nfor i in iris:\n    print(i + \":\")\n    print(iris.get(i))\n\nknn = k_nearest_neighbor_algorithm(6)  # 设置 K = 6\nknn.fit(iris.data[0:149], iris.target[:149])\n\nanswer_target = knn.predict([iris.data[149]])\nprint(\"*\" * 80, )\nprint(\"\\nThe answer is: \")\nfor i, j in zip(iris.feature_names, iris.data[149]):\n    print(i + \": \", end=\"\")\n    print(j)\nprint(\"\\n\" + r\"iris.date[149]'s target is : \" + str(answer_target), end=\"\")\nprint(r\", It's \" + iris.target_names[int(str(answer_target)[1])] + \"\\n\")\nprint(\"*\" * 80, )\n\n```\n\n### 输出结果\n\n<img src=\"./run01.png\" alt=\"run01.png\" title=\"可以看到所有鸢尾花数据集\"></img>\n\n<img src=\"./run02.png\" alt=\"run02.png\" title=\"可以看到所有鸢尾花数据集\"></img>\n\n<img src=\"./run03.png\" alt=\"run03.png\" title=\"训练结果集\"></img>\n\n<img src=\"./run04.png\" alt=\"run04.png\" title=\"测试结果集\"></img>\n\n## 参考文献\n\n- [k-nearest neighbors algorithm(From Wikipedia, the free encyclopedia)](https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm)\n- [最近邻居法(维基百科，自由的百科全书)](https://zh.wikipedia.org/wiki/最近鄰居法)\n","source":"_posts/The-K-Nearest-Neighbor-Algorithm.md","raw":"---\ntitle: The K Nearest Neighbor Algorithm\ndate: 2019-10-15 11:34:41\ntags:\n- Python\n- 人工智能\ncategories:\n- 学校课程\ncopyright: true\nimage: \"http://www.wqh4u.cn/2019/10/15/The-K-Nearest-Neighbor-Algorithm/1024px-KnnClassification.svg.png\"\n---\n\n> <span class = 'introduction'>活着的目的不在于永远活着，而在于永远活出自己。</span><br/>\n在模式识别领域中，最近邻居法（KNN算法，又译K-近邻算法）是一种用于分类和回归的非参数统计方法。<br />在这两种情况下，输入包含特征空间（Feature Space）中的k个最接近的训练样本。\n<br />这次主要实现了使用原生 Python 来模拟一个 KNN 算法。\n\n<!--more-->\n\n<hr/>\n\n## k-nearest neighbors algorithm\n\n**K-NN** 是一种[基于实例的学习](https://en.wikipedia.org/wiki/Instance-based_learning)，或者是局部近似和将所有计算推迟到分类之后的[惰性学习](https://en.wikipedia.org/wiki/Lazy_learning)。k-近邻算法是所有的机器学习算法中最简单的之一。\n\n<ul>\n<li>在 <strong>k-NN</strong> 分类中，输出是一个分类族群。一个对象的分类是由其邻居的 <span class=\"blue-target\">“多数表决”</span> 确定的，k个最近邻居（k为正整数，通常较小）中最常见的分类决定了赋予该对象的类别。若 k = 1，则该对象的类别直接由最近的一个节点赋予。</li>\n<li>在 <strong>k-NN</strong> 回归中，输出是该对象的属性值。该值是其k个最近邻居的值的平均值。</li>\n</ul>\n\n无论是分类还是回归，衡量邻居的权重都非常有用，使较近邻居的权重比较远邻居的权重大。例如，一种常见的加权方案是给每个邻居权重赋值为 1/ d，其中 d 是到邻居的距离。\n\n<div class=\"note info\">邻居都取自一组已经正确分类（在回归的情况下，指属性值正确）的对象。虽然没要求明确的训练步骤，但这也可以当作是此算法的一个训练样本集。</div>\n\n<div class=\"note danger\">k-近邻算法的缺点是对数据的局部结构非常敏感。本算法与K-平均算法（另一流行的机器学习技术）没有任何关系，请勿与之混淆。</div>\n\n## Algorithm\n\n训练样本是多维特征空间向量，其中每个训练样本带有一个类别标签。算法的训练阶段只包含存储的[特征向量](https://zh.wikipedia.org/wiki/%E7%89%B9%E5%BE%81%E5%80%BC%E5%92%8C%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F)和训练样本的标签。\n\n在分类阶段，k是一个用户定义的常数。一个没有类别标签的向量（查询或测试点）将被归类为最接近该点的k个样本点中最频繁使用的一类。\n\n一般情况下，将[欧氏距离](https://zh.wikipedia.org/wiki/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E8%B7%9D%E7%A6%BB)作为距离度量，但是这是只适用于[连续变量](https://zh.wikipedia.org/wiki/概率分布#连续分布)。在文本分类这种离散变量情况下，另一个度量——重叠度量（或[海明距离](https://zh.wikipedia.org/wiki/汉明距离)）可以用来作为度量。例如对于基因表达微阵列数据，**k-NN** 也与 **Pearson** 和 **Spearman** 相关系数结合起来使用。通常情况下，如果运用一些特殊的算法来计算度量的话，k近邻分类精度可显著提高，如运用[大间隔最近邻居](https://zh.wikipedia.org/wiki/大间隔最近邻居)或者[邻里成分分析法](https://zh.wikipedia.org/wiki/邻里成分分析)。\n\n**“多数表决”** 分类会在类别分布偏斜时出现缺陷。也就是说，出现频率较多的样本将会主导测试点的预测结果，因为他们比较大可能出现在测试点的 K 邻域而测试点的属性又是通过 k 邻域内的样本计算出来的。解决这个缺点的方法之一是在进行分类时将样本到 k 个近邻点的距离考虑进去。k 近邻点中每一个的分类（对于回归问题来说，是数值）都乘以与测试点之间距离的成反比的权重。另一种克服偏斜的方式是通过数据表示形式的抽象。例如，在[自组织映射](https://zh.wikipedia.org/wiki/自组织映射)（SOM）中，每个节点是相似的点的一个集群的代表（中心），而与它们在原始训练数据的密度无关。**K-NN** 可以应用到 **SOM** 中。\n\n## 发展\n然而 k 最近邻居法因为计算量相当的大，所以相当的耗时，Ko 与 Seo 提出一算法 **TCFP**（**t**ext **c**ategorization using **f**eature **p**rojection），尝试利用[特征投影法](https://en.wikipedia.org/wiki/Feature_projection)来降低与分类无关的特征对于系统的影响，并借此提升系统性能，其实验结果显示其分类效果与 k 最近邻居法相近，但其运算所需时间仅需k最近邻居法运算时间的五十分之一。\n\n除了针对文件分类的效率，尚有研究针对如何促进k最近邻居法在文件分类方面的效果，如 Han 等人于 2002 年尝试利用[贪心法](https://zh.wikipedia.org/wiki/贪心算法)，针对文件分类实做可调整权重的k最近邻居法 **WAkNN**（**w**eighted **a**djusted **k** **n**earest **n**eighbor），以促进分类效果；而 Li 等人于 2004 年提出由于不同分类的文件本身有数量上有差异，因此也应该依照训练集合中各种分类的文件数量，选取不同数目的最近邻居，来参与分类。\n\n## Python 代码实现 \n\n```python\n# -*- coding: utf-8 -*-\n\"\"\"\nauthor: Wang Qinhong\ndate: 2019/10/14\ntitle: 模拟 K Nearest Neighbor Algorithm\nIDE: Jet Brains PyCharm 2019.2\n\"\"\"\n\nfrom sklearn.datasets import load_iris  # 从 sklearn 中导入鸢尾花数据集\nimport math  # 数学计算标准库\nfrom collections import Counter  # Collection标准库\nimport numpy as np  # 导入 numpy 科学计算库\n\n\nclass k_nearest_neighbor_algorithm:\n    \"\"\" Main K Nearest Neighbor Algorithm\n\n    定义了有关 KNN 算法的基础操作\n\n    Attributes:\n        x_train: training test of X\n        y_train: training test of Y\n        k: The numbers of neighbors\n    \"\"\"\n\n    def __init__(self, k):\n        \"\"\"\n        Default Constructor\n        :param k: The numbers of neighbors\n        \"\"\"\n        self.k = k\n        self.x_train = None\n        self.y_train = None\n\n    def fit(self, x_train, y_train):\n        \"\"\"\n        监督训练\n        :param x_train: training test of X\n        :param y_train: training test of Y\n        :return: This object\n        \"\"\"\n        self.x_train = x_train\n        self.y_train = y_train\n        return self\n\n    def predict(self, x_pretest):\n        \"\"\"\n        给定待预测数剧集，给出预测结果向量\n        :param x_pretest: 给定结果的数据集\n        :return: 预测结果向量\n        \"\"\"\n        y_pretest = [self.get_answer(x) for x in x_pretest]\n        return np.array(y_pretest)\n\n    def get_answer(self, test_data):\n        \"\"\"\n        给定单个数据，返回预测类别\n        :param test_data: 测试数据\n        :return: 预测结果\n        \"\"\"\n        # 计算距离\n        d = [math.sqrt(np.sum((test_data - self.x_train[iter]) ** 2)) for iter in range(len(self.x_train))]\n        near = np.argsort(d)\n        top_k = [self.y_train[iter] for iter in near[0:6]]\n        votes = Counter(top_k)  # 计算k个最近邻\n        return votes.most_common(1)[0][0]  # 预测结果\n\n\n# 载入数据集,有iris.data和iris.target\niris = load_iris()\n\nprint(\"TEST DATA: \")\nfor i in iris:\n    print(i + \":\")\n    print(iris.get(i))\n\nknn = k_nearest_neighbor_algorithm(6)  # 设置 K = 6\nknn.fit(iris.data[0:149], iris.target[:149])\n\nanswer_target = knn.predict([iris.data[149]])\nprint(\"*\" * 80, )\nprint(\"\\nThe answer is: \")\nfor i, j in zip(iris.feature_names, iris.data[149]):\n    print(i + \": \", end=\"\")\n    print(j)\nprint(\"\\n\" + r\"iris.date[149]'s target is : \" + str(answer_target), end=\"\")\nprint(r\", It's \" + iris.target_names[int(str(answer_target)[1])] + \"\\n\")\nprint(\"*\" * 80, )\n\n```\n\n### 输出结果\n\n<img src=\"./run01.png\" alt=\"run01.png\" title=\"可以看到所有鸢尾花数据集\"></img>\n\n<img src=\"./run02.png\" alt=\"run02.png\" title=\"可以看到所有鸢尾花数据集\"></img>\n\n<img src=\"./run03.png\" alt=\"run03.png\" title=\"训练结果集\"></img>\n\n<img src=\"./run04.png\" alt=\"run04.png\" title=\"测试结果集\"></img>\n\n## 参考文献\n\n- [k-nearest neighbors algorithm(From Wikipedia, the free encyclopedia)](https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm)\n- [最近邻居法(维基百科，自由的百科全书)](https://zh.wikipedia.org/wiki/最近鄰居法)\n","slug":"The-K-Nearest-Neighbor-Algorithm","published":1,"updated":"2020-01-14T20:30:47.369Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn61000w2lwjetj3b9p4","content":"<blockquote>\n<p><span class=\"introduction\">活着的目的不在于永远活着，而在于永远活出自己。</span><br><br>在模式识别领域中，最近邻居法（KNN算法，又译K-近邻算法）是一种用于分类和回归的非参数统计方法。<br>在这两种情况下，输入包含特征空间（Feature Space）中的k个最接近的训练样本。<br><br>这次主要实现了使用原生 Python 来模拟一个 KNN 算法。</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"k-nearest-neighbors-algorithm\"><a href=\"#k-nearest-neighbors-algorithm\" class=\"headerlink\" title=\"k-nearest neighbors algorithm\"></a>k-nearest neighbors algorithm</h2><p><strong>K-NN</strong> 是一种<a href=\"https://en.wikipedia.org/wiki/Instance-based_learning\" target=\"_blank\" rel=\"noopener\">基于实例的学习</a>，或者是局部近似和将所有计算推迟到分类之后的<a href=\"https://en.wikipedia.org/wiki/Lazy_learning\" target=\"_blank\" rel=\"noopener\">惰性学习</a>。k-近邻算法是所有的机器学习算法中最简单的之一。</p>\n<ul>\n<li>在 <strong>k-NN</strong> 分类中，输出是一个分类族群。一个对象的分类是由其邻居的 <span class=\"blue-target\">“多数表决”</span> 确定的，k个最近邻居（k为正整数，通常较小）中最常见的分类决定了赋予该对象的类别。若 k = 1，则该对象的类别直接由最近的一个节点赋予。</li>\n<li>在 <strong>k-NN</strong> 回归中，输出是该对象的属性值。该值是其k个最近邻居的值的平均值。</li>\n</ul>\n\n<p>无论是分类还是回归，衡量邻居的权重都非常有用，使较近邻居的权重比较远邻居的权重大。例如，一种常见的加权方案是给每个邻居权重赋值为 1/ d，其中 d 是到邻居的距离。</p>\n<div class=\"note info\">邻居都取自一组已经正确分类（在回归的情况下，指属性值正确）的对象。虽然没要求明确的训练步骤，但这也可以当作是此算法的一个训练样本集。</div>\n\n<div class=\"note danger\">k-近邻算法的缺点是对数据的局部结构非常敏感。本算法与K-平均算法（另一流行的机器学习技术）没有任何关系，请勿与之混淆。</div>\n\n<h2 id=\"Algorithm\"><a href=\"#Algorithm\" class=\"headerlink\" title=\"Algorithm\"></a>Algorithm</h2><p>训练样本是多维特征空间向量，其中每个训练样本带有一个类别标签。算法的训练阶段只包含存储的<a href=\"https://zh.wikipedia.org/wiki/%E7%89%B9%E5%BE%81%E5%80%BC%E5%92%8C%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F\" target=\"_blank\" rel=\"noopener\">特征向量</a>和训练样本的标签。</p>\n<p>在分类阶段，k是一个用户定义的常数。一个没有类别标签的向量（查询或测试点）将被归类为最接近该点的k个样本点中最频繁使用的一类。</p>\n<p>一般情况下，将<a href=\"https://zh.wikipedia.org/wiki/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E8%B7%9D%E7%A6%BB\" target=\"_blank\" rel=\"noopener\">欧氏距离</a>作为距离度量，但是这是只适用于<a href=\"https://zh.wikipedia.org/wiki/概率分布#连续分布\" target=\"_blank\" rel=\"noopener\">连续变量</a>。在文本分类这种离散变量情况下，另一个度量——重叠度量（或<a href=\"https://zh.wikipedia.org/wiki/汉明距离\" target=\"_blank\" rel=\"noopener\">海明距离</a>）可以用来作为度量。例如对于基因表达微阵列数据，<strong>k-NN</strong> 也与 <strong>Pearson</strong> 和 <strong>Spearman</strong> 相关系数结合起来使用。通常情况下，如果运用一些特殊的算法来计算度量的话，k近邻分类精度可显著提高，如运用<a href=\"https://zh.wikipedia.org/wiki/大间隔最近邻居\" target=\"_blank\" rel=\"noopener\">大间隔最近邻居</a>或者<a href=\"https://zh.wikipedia.org/wiki/邻里成分分析\" target=\"_blank\" rel=\"noopener\">邻里成分分析法</a>。</p>\n<p><strong>“多数表决”</strong> 分类会在类别分布偏斜时出现缺陷。也就是说，出现频率较多的样本将会主导测试点的预测结果，因为他们比较大可能出现在测试点的 K 邻域而测试点的属性又是通过 k 邻域内的样本计算出来的。解决这个缺点的方法之一是在进行分类时将样本到 k 个近邻点的距离考虑进去。k 近邻点中每一个的分类（对于回归问题来说，是数值）都乘以与测试点之间距离的成反比的权重。另一种克服偏斜的方式是通过数据表示形式的抽象。例如，在<a href=\"https://zh.wikipedia.org/wiki/自组织映射\" target=\"_blank\" rel=\"noopener\">自组织映射</a>（SOM）中，每个节点是相似的点的一个集群的代表（中心），而与它们在原始训练数据的密度无关。<strong>K-NN</strong> 可以应用到 <strong>SOM</strong> 中。</p>\n<h2 id=\"发展\"><a href=\"#发展\" class=\"headerlink\" title=\"发展\"></a>发展</h2><p>然而 k 最近邻居法因为计算量相当的大，所以相当的耗时，Ko 与 Seo 提出一算法 <strong>TCFP</strong>（<strong>t</strong>ext <strong>c</strong>ategorization using <strong>f</strong>eature <strong>p</strong>rojection），尝试利用<a href=\"https://en.wikipedia.org/wiki/Feature_projection\" target=\"_blank\" rel=\"noopener\">特征投影法</a>来降低与分类无关的特征对于系统的影响，并借此提升系统性能，其实验结果显示其分类效果与 k 最近邻居法相近，但其运算所需时间仅需k最近邻居法运算时间的五十分之一。</p>\n<p>除了针对文件分类的效率，尚有研究针对如何促进k最近邻居法在文件分类方面的效果，如 Han 等人于 2002 年尝试利用<a href=\"https://zh.wikipedia.org/wiki/贪心算法\" target=\"_blank\" rel=\"noopener\">贪心法</a>，针对文件分类实做可调整权重的k最近邻居法 <strong>WAkNN</strong>（<strong>w</strong>eighted <strong>a</strong>djusted <strong>k</strong> <strong>n</strong>earest <strong>n</strong>eighbor），以促进分类效果；而 Li 等人于 2004 年提出由于不同分类的文件本身有数量上有差异，因此也应该依照训练集合中各种分类的文件数量，选取不同数目的最近邻居，来参与分类。</p>\n<h2 id=\"Python-代码实现\"><a href=\"#Python-代码实现\" class=\"headerlink\" title=\"Python 代码实现\"></a>Python 代码实现</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">author: Wang Qinhong</span></span><br><span class=\"line\"><span class=\"string\">date: 2019/10/14</span></span><br><span class=\"line\"><span class=\"string\">title: 模拟 K Nearest Neighbor Algorithm</span></span><br><span class=\"line\"><span class=\"string\">IDE: Jet Brains PyCharm 2019.2</span></span><br><span class=\"line\"><span class=\"string\">\"\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.datasets <span class=\"keyword\">import</span> load_iris  <span class=\"comment\"># 从 sklearn 中导入鸢尾花数据集</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> math  <span class=\"comment\"># 数学计算标准库</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> collections <span class=\"keyword\">import</span> Counter  <span class=\"comment\"># Collection标准库</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np  <span class=\"comment\"># 导入 numpy 科学计算库</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">k_nearest_neighbor_algorithm</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\" Main K Nearest Neighbor Algorithm</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    定义了有关 KNN 算法的基础操作</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Attributes:</span></span><br><span class=\"line\"><span class=\"string\">        x_train: training test of X</span></span><br><span class=\"line\"><span class=\"string\">        y_train: training test of Y</span></span><br><span class=\"line\"><span class=\"string\">        k: The numbers of neighbors</span></span><br><span class=\"line\"><span class=\"string\">    \"\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, k)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        Default Constructor</span></span><br><span class=\"line\"><span class=\"string\">        :param k: The numbers of neighbors</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.k = k</span><br><span class=\"line\">        self.x_train = <span class=\"literal\">None</span></span><br><span class=\"line\">        self.y_train = <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fit</span><span class=\"params\">(self, x_train, y_train)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        监督训练</span></span><br><span class=\"line\"><span class=\"string\">        :param x_train: training test of X</span></span><br><span class=\"line\"><span class=\"string\">        :param y_train: training test of Y</span></span><br><span class=\"line\"><span class=\"string\">        :return: This object</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.x_train = x_train</span><br><span class=\"line\">        self.y_train = y_train</span><br><span class=\"line\">        <span class=\"keyword\">return</span> self</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">predict</span><span class=\"params\">(self, x_pretest)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        给定待预测数剧集，给出预测结果向量</span></span><br><span class=\"line\"><span class=\"string\">        :param x_pretest: 给定结果的数据集</span></span><br><span class=\"line\"><span class=\"string\">        :return: 预测结果向量</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        y_pretest = [self.get_answer(x) <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> x_pretest]</span><br><span class=\"line\">        <span class=\"keyword\">return</span> np.array(y_pretest)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_answer</span><span class=\"params\">(self, test_data)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        给定单个数据，返回预测类别</span></span><br><span class=\"line\"><span class=\"string\">        :param test_data: 测试数据</span></span><br><span class=\"line\"><span class=\"string\">        :return: 预测结果</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"comment\"># 计算距离</span></span><br><span class=\"line\">        d = [math.sqrt(np.sum((test_data - self.x_train[iter]) ** <span class=\"number\">2</span>)) <span class=\"keyword\">for</span> iter <span class=\"keyword\">in</span> range(len(self.x_train))]</span><br><span class=\"line\">        near = np.argsort(d)</span><br><span class=\"line\">        top_k = [self.y_train[iter] <span class=\"keyword\">for</span> iter <span class=\"keyword\">in</span> near[<span class=\"number\">0</span>:<span class=\"number\">6</span>]]</span><br><span class=\"line\">        votes = Counter(top_k)  <span class=\"comment\"># 计算k个最近邻</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> votes.most_common(<span class=\"number\">1</span>)[<span class=\"number\">0</span>][<span class=\"number\">0</span>]  <span class=\"comment\"># 预测结果</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 载入数据集,有iris.data和iris.target</span></span><br><span class=\"line\">iris = load_iris()</span><br><span class=\"line\"></span><br><span class=\"line\">print(<span class=\"string\">\"TEST DATA: \"</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> iris:</span><br><span class=\"line\">    print(i + <span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    print(iris.get(i))</span><br><span class=\"line\"></span><br><span class=\"line\">knn = k_nearest_neighbor_algorithm(<span class=\"number\">6</span>)  <span class=\"comment\"># 设置 K = 6</span></span><br><span class=\"line\">knn.fit(iris.data[<span class=\"number\">0</span>:<span class=\"number\">149</span>], iris.target[:<span class=\"number\">149</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">answer_target = knn.predict([iris.data[<span class=\"number\">149</span>]])</span><br><span class=\"line\">print(<span class=\"string\">\"*\"</span> * <span class=\"number\">80</span>, )</span><br><span class=\"line\">print(<span class=\"string\">\"\\nThe answer is: \"</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, j <span class=\"keyword\">in</span> zip(iris.feature_names, iris.data[<span class=\"number\">149</span>]):</span><br><span class=\"line\">    print(i + <span class=\"string\">\": \"</span>, end=<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">    print(j)</span><br><span class=\"line\">print(<span class=\"string\">\"\\n\"</span> + <span class=\"string\">r\"iris.date[149]'s target is : \"</span> + str(answer_target), end=<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">print(<span class=\"string\">r\", It's \"</span> + iris.target_names[int(str(answer_target)[<span class=\"number\">1</span>])] + <span class=\"string\">\"\\n\"</span>)</span><br><span class=\"line\">print(<span class=\"string\">\"*\"</span> * <span class=\"number\">80</span>, )</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"输出结果\"><a href=\"#输出结果\" class=\"headerlink\" title=\"输出结果\"></a>输出结果</h3><p><img src=\"/2019/10/15/The-K-Nearest-Neighbor-Algorithm/run01.png\" alt=\"run01.png\" title=\"可以看到所有鸢尾花数据集\"></p>\n<p><img src=\"/2019/10/15/The-K-Nearest-Neighbor-Algorithm/run02.png\" alt=\"run02.png\" title=\"可以看到所有鸢尾花数据集\"></p>\n<p><img src=\"/2019/10/15/The-K-Nearest-Neighbor-Algorithm/run03.png\" alt=\"run03.png\" title=\"训练结果集\"></p>\n<p><img src=\"/2019/10/15/The-K-Nearest-Neighbor-Algorithm/run04.png\" alt=\"run04.png\" title=\"测试结果集\"></p>\n<h2 id=\"参考文献\"><a href=\"#参考文献\" class=\"headerlink\" title=\"参考文献\"></a>参考文献</h2><ul>\n<li><a href=\"https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm\" target=\"_blank\" rel=\"noopener\">k-nearest neighbors algorithm(From Wikipedia, the free encyclopedia)</a></li>\n<li><a href=\"https://zh.wikipedia.org/wiki/最近鄰居法\" target=\"_blank\" rel=\"noopener\">最近邻居法(维基百科，自由的百科全书)</a></li>\n</ul>\n","site":{"data":{}},"length":3439,"excerpt":"<blockquote>\n<p><span class=\"introduction\">活着的目的不在于永远活着，而在于永远活出自己。</span><br><br>在模式识别领域中，最近邻居法（KNN算法，又译K-近邻算法）是一种用于分类和回归的非参数统计方法。<br>在这两种情况下，输入包含特征空间（Feature Space）中的k个最接近的训练样本。<br><br>这次主要实现了使用原生 Python 来模拟一个 KNN 算法。</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"k-nearest-neighbors-algorithm\"><a href=\"#k-nearest-neighbors-algorithm\" class=\"headerlink\" title=\"k-nearest neighbors algorithm\"></a>k-nearest neighbors algorithm</h2><p><strong>K-NN</strong> 是一种<a href=\"https://en.wikipedia.org/wiki/Instance-based_learning\" target=\"_blank\" rel=\"noopener\">基于实例的学习</a>，或者是局部近似和将所有计算推迟到分类之后的<a href=\"https://en.wikipedia.org/wiki/Lazy_learning\" target=\"_blank\" rel=\"noopener\">惰性学习</a>。k-近邻算法是所有的机器学习算法中最简单的之一。</p>\n<ul>\n<li>在 <strong>k-NN</strong> 分类中，输出是一个分类族群。一个对象的分类是由其邻居的 <span class=\"blue-target\">“多数表决”</span> 确定的，k个最近邻居（k为正整数，通常较小）中最常见的分类决定了赋予该对象的类别。若 k = 1，则该对象的类别直接由最近的一个节点赋予。</li>\n<li>在 <strong>k-NN</strong> 回归中，输出是该对象的属性值。该值是其k个最近邻居的值的平均值。</li>\n</ul>\n\n<p>无论是分类还是回归，衡量邻居的权重都非常有用，使较近邻居的权重比较远邻居的权重大。例如，一种常见的加权方案是给每个邻居权重赋值为 1/ d，其中 d 是到邻居的距离。</p>\n<div class=\"note info\">邻居都取自一组已经正确分类（在回归的情况下，指属性值正确）的对象。虽然没要求明确的训练步骤，但这也可以当作是此算法的一个训练样本集。</div>\n\n<div class=\"note danger\">k-近邻算法的缺点是对数据的局部结构非常敏感。本算法与K-平均算法（另一流行的机器学习技术）没有任何关系，请勿与之混淆。</div>\n\n<h2 id=\"Algorithm\"><a href=\"#Algorithm\" class=\"headerlink\" title=\"Algorithm\"></a>Algorithm</h2><p>训练样本是多维特征空间向量，其中每个训练样本带有一个类别标签。算法的训练阶段只包含存储的<a href=\"https://zh.wikipedia.org/wiki/%E7%89%B9%E5%BE%81%E5%80%BC%E5%92%8C%E7%89%B9%E5%BE%81%E5%90%91%E9%87%8F\" target=\"_blank\" rel=\"noopener\">特征向量</a>和训练样本的标签。</p>\n<p>在分类阶段，k是一个用户定义的常数。一个没有类别标签的向量（查询或测试点）将被归类为最接近该点的k个样本点中最频繁使用的一类。</p>\n<p>一般情况下，将<a href=\"https://zh.wikipedia.org/wiki/%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E8%B7%9D%E7%A6%BB\" target=\"_blank\" rel=\"noopener\">欧氏距离</a>作为距离度量，但是这是只适用于<a href=\"https://zh.wikipedia.org/wiki/概率分布#连续分布\" target=\"_blank\" rel=\"noopener\">连续变量</a>。在文本分类这种离散变量情况下，另一个度量——重叠度量（或<a href=\"https://zh.wikipedia.org/wiki/汉明距离\" target=\"_blank\" rel=\"noopener\">海明距离</a>）可以用来作为度量。例如对于基因表达微阵列数据，<strong>k-NN</strong> 也与 <strong>Pearson</strong> 和 <strong>Spearman</strong> 相关系数结合起来使用。通常情况下，如果运用一些特殊的算法来计算度量的话，k近邻分类精度可显著提高，如运用<a href=\"https://zh.wikipedia.org/wiki/大间隔最近邻居\" target=\"_blank\" rel=\"noopener\">大间隔最近邻居</a>或者<a href=\"https://zh.wikipedia.org/wiki/邻里成分分析\" target=\"_blank\" rel=\"noopener\">邻里成分分析法</a>。</p>\n<p><strong>“多数表决”</strong> 分类会在类别分布偏斜时出现缺陷。也就是说，出现频率较多的样本将会主导测试点的预测结果，因为他们比较大可能出现在测试点的 K 邻域而测试点的属性又是通过 k 邻域内的样本计算出来的。解决这个缺点的方法之一是在进行分类时将样本到 k 个近邻点的距离考虑进去。k 近邻点中每一个的分类（对于回归问题来说，是数值）都乘以与测试点之间距离的成反比的权重。另一种克服偏斜的方式是通过数据表示形式的抽象。例如，在<a href=\"https://zh.wikipedia.org/wiki/自组织映射\" target=\"_blank\" rel=\"noopener\">自组织映射</a>（SOM）中，每个节点是相似的点的一个集群的代表（中心），而与它们在原始训练数据的密度无关。<strong>K-NN</strong> 可以应用到 <strong>SOM</strong> 中。</p>\n<h2 id=\"发展\"><a href=\"#发展\" class=\"headerlink\" title=\"发展\"></a>发展</h2><p>然而 k 最近邻居法因为计算量相当的大，所以相当的耗时，Ko 与 Seo 提出一算法 <strong>TCFP</strong>（<strong>t</strong>ext <strong>c</strong>ategorization using <strong>f</strong>eature <strong>p</strong>rojection），尝试利用<a href=\"https://en.wikipedia.org/wiki/Feature_projection\" target=\"_blank\" rel=\"noopener\">特征投影法</a>来降低与分类无关的特征对于系统的影响，并借此提升系统性能，其实验结果显示其分类效果与 k 最近邻居法相近，但其运算所需时间仅需k最近邻居法运算时间的五十分之一。</p>\n<p>除了针对文件分类的效率，尚有研究针对如何促进k最近邻居法在文件分类方面的效果，如 Han 等人于 2002 年尝试利用<a href=\"https://zh.wikipedia.org/wiki/贪心算法\" target=\"_blank\" rel=\"noopener\">贪心法</a>，针对文件分类实做可调整权重的k最近邻居法 <strong>WAkNN</strong>（<strong>w</strong>eighted <strong>a</strong>djusted <strong>k</strong> <strong>n</strong>earest <strong>n</strong>eighbor），以促进分类效果；而 Li 等人于 2004 年提出由于不同分类的文件本身有数量上有差异，因此也应该依照训练集合中各种分类的文件数量，选取不同数目的最近邻居，来参与分类。</p>\n<h2 id=\"Python-代码实现\"><a href=\"#Python-代码实现\" class=\"headerlink\" title=\"Python 代码实现\"></a>Python 代码实现</h2><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">author: Wang Qinhong</span></span><br><span class=\"line\"><span class=\"string\">date: 2019/10/14</span></span><br><span class=\"line\"><span class=\"string\">title: 模拟 K Nearest Neighbor Algorithm</span></span><br><span class=\"line\"><span class=\"string\">IDE: Jet Brains PyCharm 2019.2</span></span><br><span class=\"line\"><span class=\"string\">\"\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.datasets <span class=\"keyword\">import</span> load_iris  <span class=\"comment\"># 从 sklearn 中导入鸢尾花数据集</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> math  <span class=\"comment\"># 数学计算标准库</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> collections <span class=\"keyword\">import</span> Counter  <span class=\"comment\"># Collection标准库</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np  <span class=\"comment\"># 导入 numpy 科学计算库</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">k_nearest_neighbor_algorithm</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\" Main K Nearest Neighbor Algorithm</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    定义了有关 KNN 算法的基础操作</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    Attributes:</span></span><br><span class=\"line\"><span class=\"string\">        x_train: training test of X</span></span><br><span class=\"line\"><span class=\"string\">        y_train: training test of Y</span></span><br><span class=\"line\"><span class=\"string\">        k: The numbers of neighbors</span></span><br><span class=\"line\"><span class=\"string\">    \"\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span><span class=\"params\">(self, k)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        Default Constructor</span></span><br><span class=\"line\"><span class=\"string\">        :param k: The numbers of neighbors</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.k = k</span><br><span class=\"line\">        self.x_train = <span class=\"literal\">None</span></span><br><span class=\"line\">        self.y_train = <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">fit</span><span class=\"params\">(self, x_train, y_train)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        监督训练</span></span><br><span class=\"line\"><span class=\"string\">        :param x_train: training test of X</span></span><br><span class=\"line\"><span class=\"string\">        :param y_train: training test of Y</span></span><br><span class=\"line\"><span class=\"string\">        :return: This object</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        self.x_train = x_train</span><br><span class=\"line\">        self.y_train = y_train</span><br><span class=\"line\">        <span class=\"keyword\">return</span> self</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">predict</span><span class=\"params\">(self, x_pretest)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        给定待预测数剧集，给出预测结果向量</span></span><br><span class=\"line\"><span class=\"string\">        :param x_pretest: 给定结果的数据集</span></span><br><span class=\"line\"><span class=\"string\">        :return: 预测结果向量</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        y_pretest = [self.get_answer(x) <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> x_pretest]</span><br><span class=\"line\">        <span class=\"keyword\">return</span> np.array(y_pretest)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">get_answer</span><span class=\"params\">(self, test_data)</span>:</span></span><br><span class=\"line\">        <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">        给定单个数据，返回预测类别</span></span><br><span class=\"line\"><span class=\"string\">        :param test_data: 测试数据</span></span><br><span class=\"line\"><span class=\"string\">        :return: 预测结果</span></span><br><span class=\"line\"><span class=\"string\">        \"\"\"</span></span><br><span class=\"line\">        <span class=\"comment\"># 计算距离</span></span><br><span class=\"line\">        d = [math.sqrt(np.sum((test_data - self.x_train[iter]) ** <span class=\"number\">2</span>)) <span class=\"keyword\">for</span> iter <span class=\"keyword\">in</span> range(len(self.x_train))]</span><br><span class=\"line\">        near = np.argsort(d)</span><br><span class=\"line\">        top_k = [self.y_train[iter] <span class=\"keyword\">for</span> iter <span class=\"keyword\">in</span> near[<span class=\"number\">0</span>:<span class=\"number\">6</span>]]</span><br><span class=\"line\">        votes = Counter(top_k)  <span class=\"comment\"># 计算k个最近邻</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> votes.most_common(<span class=\"number\">1</span>)[<span class=\"number\">0</span>][<span class=\"number\">0</span>]  <span class=\"comment\"># 预测结果</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 载入数据集,有iris.data和iris.target</span></span><br><span class=\"line\">iris = load_iris()</span><br><span class=\"line\"></span><br><span class=\"line\">print(<span class=\"string\">\"TEST DATA: \"</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> iris:</span><br><span class=\"line\">    print(i + <span class=\"string\">\":\"</span>)</span><br><span class=\"line\">    print(iris.get(i))</span><br><span class=\"line\"></span><br><span class=\"line\">knn = k_nearest_neighbor_algorithm(<span class=\"number\">6</span>)  <span class=\"comment\"># 设置 K = 6</span></span><br><span class=\"line\">knn.fit(iris.data[<span class=\"number\">0</span>:<span class=\"number\">149</span>], iris.target[:<span class=\"number\">149</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">answer_target = knn.predict([iris.data[<span class=\"number\">149</span>]])</span><br><span class=\"line\">print(<span class=\"string\">\"*\"</span> * <span class=\"number\">80</span>, )</span><br><span class=\"line\">print(<span class=\"string\">\"\\nThe answer is: \"</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, j <span class=\"keyword\">in</span> zip(iris.feature_names, iris.data[<span class=\"number\">149</span>]):</span><br><span class=\"line\">    print(i + <span class=\"string\">\": \"</span>, end=<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">    print(j)</span><br><span class=\"line\">print(<span class=\"string\">\"\\n\"</span> + <span class=\"string\">r\"iris.date[149]'s target is : \"</span> + str(answer_target), end=<span class=\"string\">\"\"</span>)</span><br><span class=\"line\">print(<span class=\"string\">r\", It's \"</span> + iris.target_names[int(str(answer_target)[<span class=\"number\">1</span>])] + <span class=\"string\">\"\\n\"</span>)</span><br><span class=\"line\">print(<span class=\"string\">\"*\"</span> * <span class=\"number\">80</span>, )</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"输出结果\"><a href=\"#输出结果\" class=\"headerlink\" title=\"输出结果\"></a>输出结果</h3><p><img src=\"/2019/10/15/The-K-Nearest-Neighbor-Algorithm/run01.png\" alt=\"run01.png\" title=\"可以看到所有鸢尾花数据集\"></p>\n<p><img src=\"/2019/10/15/The-K-Nearest-Neighbor-Algorithm/run02.png\" alt=\"run02.png\" title=\"可以看到所有鸢尾花数据集\"></p>\n<p><img src=\"/2019/10/15/The-K-Nearest-Neighbor-Algorithm/run03.png\" alt=\"run03.png\" title=\"训练结果集\"></p>\n<p><img src=\"/2019/10/15/The-K-Nearest-Neighbor-Algorithm/run04.png\" alt=\"run04.png\" title=\"测试结果集\"></p>\n<h2 id=\"参考文献\"><a href=\"#参考文献\" class=\"headerlink\" title=\"参考文献\"></a>参考文献</h2><ul>\n<li><a href=\"https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm\" target=\"_blank\" rel=\"noopener\">k-nearest neighbors algorithm(From Wikipedia, the free encyclopedia)</a></li>\n<li><a href=\"https://zh.wikipedia.org/wiki/最近鄰居法\" target=\"_blank\" rel=\"noopener\">最近邻居法(维基百科，自由的百科全书)</a></li>\n</ul>"},{"title":"UML图例详解","date":"2019-08-28T08:13:57.000Z","copyright":true,"_content":"\n<style type=\"text/css\">\n.redspan {\n    color: red;\n}\n.quotetitle {\n    color: #337ab7;\n    font-weight: 700;\n}\n.purpletitle {\n    color: #9954bb;\n    font-weight: 700;\n}\n.italic {\n    font-style: italic;\n}\n.markbutton {\n    padding: 3px 5px;\n    margin: 0 4px;\n    font-size: 16px;\n    font-weight: 700;\n    color: white;\n}\n.bgblue {\n    background-color: #337ab7;\n}\n.bgpurple {\n    background-color: #9954bb;\n}\n.bgred {\n    background-color: red;\n}\ntd {\n    text-align: center;\n    vertical-align: bottom;\n}\ntd, th {\n    border: 2px solid white;\n    font-size: 18px;\n}\nth {\n    background-color: #337ab7;\n    color: white;\n}\n.image-display {\n    text-align: center;\n    font-size: 16px;\n}\n.image-display img {\n    padding-bottom: 8px;\n}\n.code {\n    text-align: left;\n}\n</style>\n\n> <span class = \"redspan\">志向和热爱是伟大行为的双翼。</span><br/>\n<a name = \"UML\">UML（Unified Modeling Language）</a>是一种统一建模语言，为面向对象开发系统的产品进行说明、可视化、和编制文档的一种标准语言。<br/>在这里将介绍 `UML` 基本概念以及各个图的使用场景。\n\n<!-- more -->\n\n<hr/>\n\n## `UML` 图例详解\n`UML` 分为用例视图、设计视图、进程视图、实现视图和拓扑视图，又可以静动分为静态视图和动态视图。静态图分为：用例图，类图，对象图，包图，构件图，部署图。动态图分为：状态图，活动图，协作图，序列图。\n\n### <i class = \"fa fa-angle-double-right\"></i> 用例图（UseCase Diagrams）\n> 用例是目标系统<a name = \"business-process\">业务过程（Business Process）</a>的抽象，由<a name = \"actor\">参与者（Actor）</a>与系统的交互步骤（或事件）组成，参与者通过用例完成具体的业务目标。<br/>即：用例图主要回答了两个问题：<br/>1. <span class = \"markbutton bgpurple\">是谁用软件</span><br/>2. <span class = \"markbutton bgpurple\">软件的功能</span><br/>从用户的角度描述了系统的功能，并指出各个功能的执行者，强调用户的使用者，系统为执行者完成哪些功能。\n\n<span class = \"markbutton bgblue\">系统用例模型</span>通过 `UML` 用例图进行可视化。`UML` 用例图基本符号有 <span class = \"markbutton bgpurple\">用例（椭圆形标识）、参与者（人性标识）、系统边界（矩形标识）、关联（直线标识）</span>。<br/>\n\n- 如图 `1.1` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./UML_yongli.png\" alt = \"UML用例图\"/>\n        <br/>图1.1&nbsp;&nbsp;&nbsp;&nbsp;UML用例图基本符号\n    </div>\n    \n<span class = \"markbutton bgblue\">用例建模</span> 是面向对象软件分析的重要技术和方法，开发人员在实用用例图进行用例模型可视化时需要<span class = \"markbutton bgred\">注意如下事项</span>：\n<ol>\n    <li>用例图无法可视化非交互或非功能性的系统需求；</li>\n    <li>用例的定义没有统一标准；</li>\n    <li>复杂系统用例模型的全局可视化可能会降低用例图的可用性等。</li>\n</ol>\n\n<hr/>\n\n### <i class = \"fa fa-angle-double-right\"></i> 序列图-时序图（Sequence Diagrams）\n> <span class = \"markbutton bgblue\">UML时序图</span>通过对象、消息、交互顺序等方式可视化软件业务过程中的控制流或数据流。\n\n<span class = \"markbutton bgblue\">时序图</span>中的对象通过发送消息和接受消息进行交互，消息具有先后顺序。UML时序图基本符号有<span class = \"markbutton bgpurple\">对象、消息、对象生命线、消息组合片段、终止符号等</span>。\n\n- 时序图如图 `1.2` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./UML_shixu.jpg\" alt = \"UML时序图\"/>\n        <br/>图1.2&nbsp;&nbsp;&nbsp;&nbsp;UML时序图基本符号\n    </div>\n    \n> <span class = \"markbutton bgblue\">消息</span>用从一个对象的生命线到另一个对象生命线的箭头表示。<br/>\n> 箭头以<span class = \"markbutton bgblue\">时间顺序</span>在图中从上到下排列。 \n<br/>\n\n#### <i class = \"fa fa-angle-right\"></i> 生命线\n\n> 生命线名称可带下划线。当使用下划线时，意味着序列图中的生命线代表一个类的特定实例。\n\n- 生命线如图 `1.3` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./shengmingxian.png\" alt = \"生命线\"/>\n        <br/>图1.3&nbsp;&nbsp;&nbsp;&nbsp;生命线\n    </div>\n    \n#### <i class = \"fa fa-angle-right\"></i> 同步消息\n\n> 同步等待消息。\n\n- 同步消息如图 `1.4` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./tongbuxiaoxi.png\" alt = \"同步消息\"/>\n        <br/>图1.4&nbsp;&nbsp;&nbsp;&nbsp;同步消息\n    </div>\n    \n#### <i class = \"fa fa-angle-right\"></i> 异步消息\n\n> 异步发送消息，不需等待。\n\n- 异步消息如图 `1.5` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./yibuxiaoxi.png\" alt = \"异步消息\"/>\n        <br/>图1.5&nbsp;&nbsp;&nbsp;&nbsp;异步消息\n    </div>\n    \n#### <i class = \"fa fa-angle-right\"></i> 注释\n\n- 注释如图 `1.6` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./zhushi.png\" alt = \"注释\"/>\n        <br/>图1.6&nbsp;&nbsp;&nbsp;&nbsp;注释\n    </div>\n    \n#### <i class = \"fa fa-angle-right\"></i> 约束\n\n- 约束如图 `1.7` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./yueshu.png\" alt = \"约束\"/>\n        <br/>图1.7&nbsp;&nbsp;&nbsp;&nbsp;约束\n    </div>\n    \n#### <i class = \"fa fa-angle-right\"></i> 组合\n> <span class = \"markbutton bgblue\">组合片段用来解决交互执行的条件及方式。</span><br/>它允许在序列图中直接表示逻辑组件，用于通过指定条件或子进程的应用区域，为任何生命线的任何部分定义特殊条件和子进程。<br/>常用的组合片段有：<span class = \"markbutton bgpurple\">抉择、选项、循环、并行</span>。\n\n使用<span class = \"markbutton bgblue\">时序图</span> 进行对象交互模型可视化时，需要<span class = \"markbutton bgred\">注意如下事项</span>：\n<ol>\n    <li>消息类型有同步消息、异步消息、返回消息、自关联消息等；</li>\n    <li>如果需要在时序图中标注对象生命周期的终止，可以使用终止符号；</li>\n    <li>可以对时序图标注<a name = \"type\">对象类型（Type）</a>和<a name = \"stereotype\">构造类型（Stereotype）</a>；</li>\n    <li>当系统内部对象需要和系统外部环境交互时，可以将外部环境（第三方系统或用户）标注为对象。</li>\n</ol>\n\n<hr/>\n\n### <i class = \"fa fa-angle-double-right\"></i> 类图（Class Diagrams）\n> **类是面向对象软件分析和设计的核心目标。**<br/>定义了静态代码逻辑，是软件内部的<a name = \"generalization\">泛化（Generalization）</a>类型；对象是类的实例；类的关联是对象写作逻辑的静态表示。<br/><span class = \"markbutton bgblue\">采用面向对象方法实施软件编码活动的本质是定义类。</span>\n\n用户根据用例图抽象成类，描述类的内部结构和类与类之间的关系，是一种静态结构图。<br/> 在UML类图中，常见的有以下几种关系: \n- <a name = \"generalization-inheritance\">泛化/继承（Generalization / Inheritance）</a>\n- <a name = \"realization\">实现（Realization）</a>\n- <a name = \"association\">关联（Association)</a>\n- <a name = \"aggregation\">聚合（Aggregation）</a>\n- <a name = \"composition\">组合（Composition）</a>\n- <a name = \"dependency\">依赖（Dependency）</a>\n\n> **类图不仅可以用于呈现需求的业务领域，也可以用于表达逻辑代码的设计模型。**\n\n各种关系的强弱顺序： 泛化（继承） = 实现 > 组合 > 聚合 > 关联 > 依赖\n\n### <i class = \"fa fa-angle-right\"></i> 泛化（继承）\n> `【泛化关系】`：是一种继承关系，表示一般与特殊的关系，它指定了子类如何继承父类的所有特征和行为。<br/>\n> 例如：`学生（Student）` 也同样是 `人（Person）`，即有学生的特性也有人类的共性。\n\n<div class = \"image-display\">\n    <img src = \"./generalization.png\" alt = \"泛化\"/>\n    <br/>泛化（继承）\n</div>\n\n<br/>\n\n```java\n// 定义 Person 类\nclass Person {\n    private String name;\n    private int age;\n    \n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n    \n    @Override\n    public String toString() {\n        return \"{Name: \" + this.name + \", Age: \" + this.age + \"}\\n\";\n    }\n}\n\n// 定义 Student 类，继承 Person 类\nclass Student extends Person {\n    private String studentID;\n    \n    public Student(String name, int age, String studentID) {\n        super(name, age);\n        this.studentID = studentID;\n    }\n    \n    @Override\n    public String toString() {\n        return super.toString() + \"{Student ID: \" + this.studentID + \"}\";\n    }\n}\n```\n\n### <i class = \"fa fa-angle-right\"></i> 实现\n> `【实现关系】`：是一种类与接口的关系，表示类是接口所有特征和行为的实现。\n\n<div class = \"image-display\">\n    <img src = \"./implements.png\" alt = \"泛化\"/>\n    <br/>实现\n</div>\n\n<br/>\n\n``` java\n// 定义动作接口 Action\ninterface Action {\n    void Running();\n    void Sleeping();\n}\n\n// 定义 Animals 类，实现动作接口 Action\nclass Animals implements Action {\n    @Override\n    public void Running() {\n        System.out.println(\"It's Running!\");\n    }\n    \n    @Override\n    public void Sleeping() {\n        System.out.println(\"It's Sleeping!\");\n    }\n}\n```\n\n### <i class = \"fa fa-angle-right\"></i> 关联\n> `【关联关系】`：是一种拥有的关系，它使一个类知道另一个类的属性和方法；<br/>如：老师与学生，丈夫与妻子关联可以是双向的，也可以是单向的。<br/>双向的关联可以有两个箭头或者没有箭头，单向的关联有一个箭头。<br/>\n> `【代码体现】`：成员变量\n\n<div class = \"image-display\">\n    <img src = \"./association.png\" alt = \"关联\"/>\n    <br/>关联\n</div>\n\n<br/>\n\n```java\n// 定义学院类 College\nclass College {\n    private String name;\n    private ArrayList<Student> student; // 学生与学院 n : 1\n    \n    public Courses(String name) {\n        this.name = name;\n        this.student = new ArrayList<>();\n    }\n    \n    // 省略 getter 和 setter 方法...\n}\n\n// 定义学生类 Students\nclass Student {\n    private ArrayList<Teacher> teachers; // 学生与老师 n : m\n    \n    public Student() {\n        this.teachers = new ArrayList<>();\n    }\n    \n    // 省略 getter 和 setter 方法...\n}\n\n// 定义教师类 Teacher\nclass Teacher {\n    private ArrayList<Student> students; // 学生与老师 n : m\n    \n    public Teacher() {\n        this.students = new ArrayList<>();\n    }\n    \n    // 省略 getter 和 setter 方法...\n}\n```\n\n### <i class = \"fa fa-angle-right\"></i> 聚合\n> `【聚合关系】`：是整体与部分的关系，且<span class = \"markbutton bgblue\">部分可以离开整体而单独存在</span>。如车和轮胎是整体和部分的关系，轮胎离开车仍然可以存在。<br/>\n> <span class = \"markbutton bgblue\">聚合关系是关联关系的一种，是强的关联关系；</span> 关联和聚合在语法上无法区分，必须考察具体的逻辑关系。<br/>\n> `【代码体现】`：成员变量\n\n<div class = \"image-display\">\n    <img src = \"./aggregation.png\" alt = \"聚合\"/>\n    <br/>聚合\n</div>\n\n<br/>\n\n```java\n// 定义引擎类 Engine\nclass Engine {\n    private String name;\n\n    public Engine(String name) {\n        this.name = name;\n    }\n\n    public String getName() {\n        return name;\n    }\n}\n\n// 定义汽车类 Car\nclass Car {\n    private Engine engine; // 1:1 聚合关系\n    private Tyre[] tyres = new Tyre[4]; // 1:4 聚合关系\n\n    public Car() {\n        engine = new Engine(\"Engine\");\n    }\n\n    public Engine getEngine() {\n        return engine;\n    }\n\n    public Tyre[] getTyres() {\n        return tyres;\n    }\n}\n\n// 定义轮胎类 Tyre\nclass Tyre {\n    public void running() {\n        System.out.println(\"Tyre is running...\");\n    }\n}\n```\n\n### <i class = \"fa fa-angle-right\"></i> 组合\n> `【组合关系】`：是整体与部分的关系，但<span class = \"markbutton bgblue\">部分不能离开整体而单独存在</span>。如公司和部门是整体和部分的关系，没有公司就不存在部门。<br/>\n> 组合关系是关联关系的一种，是比聚合关系还要强的关系，它要求普通的聚合关系中代表整体的对象负责代表部分的对象的生命周期。<br/>\n> `【代码体现】`：成员变量<br/>\n> `【箭头及指向】`：带实心菱形的实线，菱形指向整体\n\n<div class = \"image-display\">\n    <img src = \"./composition.png\" alt = \"组合\"/>\n    <br/>组合\n</div>\n\n<br/>\n\n```java\n// 定义公司类 Company\nclass Company {\n    private String name;\n    \n    public Company(String name) {\n        this.name = name;\n    }\n}\n\n// 定义部门类 Department\nclass Department {\n    private Company company;\n    \n    public Department(Company company) {\n        this.company = company;\n    }\n}\n```\n\n### <i class = \"fa fa-angle-right\"></i> 依赖\n> `【依赖关系】`：是一种使用的关系，即<span class = \"markbutton bgblue\">一个类的实现需要另一个类的协助</span>，所以要尽量不使用双向的互相依赖.<br/>\n> `【代码表现】`：局部变量、方法的参数或者对静态方法的调用<br/>\n> `【箭头及指向】`：带箭头的虚线，指向被使用者\n\n<div class = \"image-display\">\n    <img src = \"./dependency.png\" alt = \"依赖\"/>\n    <br/>依赖\n</div>\n\n<br/>\n\n```c\n// 定义计算机类 Computer\nclass Computer {\n    private String name;\n    private static String cpu = \"Intel\";\n\n    public Computer(String name) {\n        this.name = name;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public static String showCPU() {\n        return cpu;\n    }\n}\n\n// 定义人类 People\nclass People {\n    // 使用局部方法参数\n    public void getComputerName(Computer computer) {\n        System.out.println(computer.getName());\n    }\n\n    // 使用静态方法\n    public void getComputerCPU() {\n        System.out.println(Computer.showCPU());\n    }\n}\n```\n\n### <i class = \"fa fa-angle-right\"></i> 类图应用\n<div class = \"image-display\">\n    <img src = \"./group.png\" alt = \"类图应用\"/>\n    <br/>类图应用\n</div>\n\n<br/>\n\n使用<span class = \"markbutton bgblue\">类图</span> 进行建模时，需要<span class = \"markbutton bgred\">注意如下事项</span>：\n<ol>\n    <li>类图可以呈现域、方法和类关系等代码要素，但无法表达详细业务流程。因此，如果只有类图模型，则并不能直接进行程序实现；</li>\n    <li>类图文档通常与代码实现不一致，且更新代价较高；</li>\n    <li>从静态代码形式上看，不同的类关系代码形式常常相同或类似。因此，一般按系统对象的角色或业务职责区分类关系。</li>\n</ol>","source":"_posts/UML图例详解.md","raw":"---\ntitle: UML图例详解\ndate: 2019-08-28 16:13:57\ntags:\n- 设计模式\n- UML\n- 软件工程\ncategories:\n- 软件工程\ncopyright: true\n---\n\n<style type=\"text/css\">\n.redspan {\n    color: red;\n}\n.quotetitle {\n    color: #337ab7;\n    font-weight: 700;\n}\n.purpletitle {\n    color: #9954bb;\n    font-weight: 700;\n}\n.italic {\n    font-style: italic;\n}\n.markbutton {\n    padding: 3px 5px;\n    margin: 0 4px;\n    font-size: 16px;\n    font-weight: 700;\n    color: white;\n}\n.bgblue {\n    background-color: #337ab7;\n}\n.bgpurple {\n    background-color: #9954bb;\n}\n.bgred {\n    background-color: red;\n}\ntd {\n    text-align: center;\n    vertical-align: bottom;\n}\ntd, th {\n    border: 2px solid white;\n    font-size: 18px;\n}\nth {\n    background-color: #337ab7;\n    color: white;\n}\n.image-display {\n    text-align: center;\n    font-size: 16px;\n}\n.image-display img {\n    padding-bottom: 8px;\n}\n.code {\n    text-align: left;\n}\n</style>\n\n> <span class = \"redspan\">志向和热爱是伟大行为的双翼。</span><br/>\n<a name = \"UML\">UML（Unified Modeling Language）</a>是一种统一建模语言，为面向对象开发系统的产品进行说明、可视化、和编制文档的一种标准语言。<br/>在这里将介绍 `UML` 基本概念以及各个图的使用场景。\n\n<!-- more -->\n\n<hr/>\n\n## `UML` 图例详解\n`UML` 分为用例视图、设计视图、进程视图、实现视图和拓扑视图，又可以静动分为静态视图和动态视图。静态图分为：用例图，类图，对象图，包图，构件图，部署图。动态图分为：状态图，活动图，协作图，序列图。\n\n### <i class = \"fa fa-angle-double-right\"></i> 用例图（UseCase Diagrams）\n> 用例是目标系统<a name = \"business-process\">业务过程（Business Process）</a>的抽象，由<a name = \"actor\">参与者（Actor）</a>与系统的交互步骤（或事件）组成，参与者通过用例完成具体的业务目标。<br/>即：用例图主要回答了两个问题：<br/>1. <span class = \"markbutton bgpurple\">是谁用软件</span><br/>2. <span class = \"markbutton bgpurple\">软件的功能</span><br/>从用户的角度描述了系统的功能，并指出各个功能的执行者，强调用户的使用者，系统为执行者完成哪些功能。\n\n<span class = \"markbutton bgblue\">系统用例模型</span>通过 `UML` 用例图进行可视化。`UML` 用例图基本符号有 <span class = \"markbutton bgpurple\">用例（椭圆形标识）、参与者（人性标识）、系统边界（矩形标识）、关联（直线标识）</span>。<br/>\n\n- 如图 `1.1` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./UML_yongli.png\" alt = \"UML用例图\"/>\n        <br/>图1.1&nbsp;&nbsp;&nbsp;&nbsp;UML用例图基本符号\n    </div>\n    \n<span class = \"markbutton bgblue\">用例建模</span> 是面向对象软件分析的重要技术和方法，开发人员在实用用例图进行用例模型可视化时需要<span class = \"markbutton bgred\">注意如下事项</span>：\n<ol>\n    <li>用例图无法可视化非交互或非功能性的系统需求；</li>\n    <li>用例的定义没有统一标准；</li>\n    <li>复杂系统用例模型的全局可视化可能会降低用例图的可用性等。</li>\n</ol>\n\n<hr/>\n\n### <i class = \"fa fa-angle-double-right\"></i> 序列图-时序图（Sequence Diagrams）\n> <span class = \"markbutton bgblue\">UML时序图</span>通过对象、消息、交互顺序等方式可视化软件业务过程中的控制流或数据流。\n\n<span class = \"markbutton bgblue\">时序图</span>中的对象通过发送消息和接受消息进行交互，消息具有先后顺序。UML时序图基本符号有<span class = \"markbutton bgpurple\">对象、消息、对象生命线、消息组合片段、终止符号等</span>。\n\n- 时序图如图 `1.2` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./UML_shixu.jpg\" alt = \"UML时序图\"/>\n        <br/>图1.2&nbsp;&nbsp;&nbsp;&nbsp;UML时序图基本符号\n    </div>\n    \n> <span class = \"markbutton bgblue\">消息</span>用从一个对象的生命线到另一个对象生命线的箭头表示。<br/>\n> 箭头以<span class = \"markbutton bgblue\">时间顺序</span>在图中从上到下排列。 \n<br/>\n\n#### <i class = \"fa fa-angle-right\"></i> 生命线\n\n> 生命线名称可带下划线。当使用下划线时，意味着序列图中的生命线代表一个类的特定实例。\n\n- 生命线如图 `1.3` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./shengmingxian.png\" alt = \"生命线\"/>\n        <br/>图1.3&nbsp;&nbsp;&nbsp;&nbsp;生命线\n    </div>\n    \n#### <i class = \"fa fa-angle-right\"></i> 同步消息\n\n> 同步等待消息。\n\n- 同步消息如图 `1.4` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./tongbuxiaoxi.png\" alt = \"同步消息\"/>\n        <br/>图1.4&nbsp;&nbsp;&nbsp;&nbsp;同步消息\n    </div>\n    \n#### <i class = \"fa fa-angle-right\"></i> 异步消息\n\n> 异步发送消息，不需等待。\n\n- 异步消息如图 `1.5` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./yibuxiaoxi.png\" alt = \"异步消息\"/>\n        <br/>图1.5&nbsp;&nbsp;&nbsp;&nbsp;异步消息\n    </div>\n    \n#### <i class = \"fa fa-angle-right\"></i> 注释\n\n- 注释如图 `1.6` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./zhushi.png\" alt = \"注释\"/>\n        <br/>图1.6&nbsp;&nbsp;&nbsp;&nbsp;注释\n    </div>\n    \n#### <i class = \"fa fa-angle-right\"></i> 约束\n\n- 约束如图 `1.7` 所示：\n\n    <div class = \"image-display\">\n        <img src = \"./yueshu.png\" alt = \"约束\"/>\n        <br/>图1.7&nbsp;&nbsp;&nbsp;&nbsp;约束\n    </div>\n    \n#### <i class = \"fa fa-angle-right\"></i> 组合\n> <span class = \"markbutton bgblue\">组合片段用来解决交互执行的条件及方式。</span><br/>它允许在序列图中直接表示逻辑组件，用于通过指定条件或子进程的应用区域，为任何生命线的任何部分定义特殊条件和子进程。<br/>常用的组合片段有：<span class = \"markbutton bgpurple\">抉择、选项、循环、并行</span>。\n\n使用<span class = \"markbutton bgblue\">时序图</span> 进行对象交互模型可视化时，需要<span class = \"markbutton bgred\">注意如下事项</span>：\n<ol>\n    <li>消息类型有同步消息、异步消息、返回消息、自关联消息等；</li>\n    <li>如果需要在时序图中标注对象生命周期的终止，可以使用终止符号；</li>\n    <li>可以对时序图标注<a name = \"type\">对象类型（Type）</a>和<a name = \"stereotype\">构造类型（Stereotype）</a>；</li>\n    <li>当系统内部对象需要和系统外部环境交互时，可以将外部环境（第三方系统或用户）标注为对象。</li>\n</ol>\n\n<hr/>\n\n### <i class = \"fa fa-angle-double-right\"></i> 类图（Class Diagrams）\n> **类是面向对象软件分析和设计的核心目标。**<br/>定义了静态代码逻辑，是软件内部的<a name = \"generalization\">泛化（Generalization）</a>类型；对象是类的实例；类的关联是对象写作逻辑的静态表示。<br/><span class = \"markbutton bgblue\">采用面向对象方法实施软件编码活动的本质是定义类。</span>\n\n用户根据用例图抽象成类，描述类的内部结构和类与类之间的关系，是一种静态结构图。<br/> 在UML类图中，常见的有以下几种关系: \n- <a name = \"generalization-inheritance\">泛化/继承（Generalization / Inheritance）</a>\n- <a name = \"realization\">实现（Realization）</a>\n- <a name = \"association\">关联（Association)</a>\n- <a name = \"aggregation\">聚合（Aggregation）</a>\n- <a name = \"composition\">组合（Composition）</a>\n- <a name = \"dependency\">依赖（Dependency）</a>\n\n> **类图不仅可以用于呈现需求的业务领域，也可以用于表达逻辑代码的设计模型。**\n\n各种关系的强弱顺序： 泛化（继承） = 实现 > 组合 > 聚合 > 关联 > 依赖\n\n### <i class = \"fa fa-angle-right\"></i> 泛化（继承）\n> `【泛化关系】`：是一种继承关系，表示一般与特殊的关系，它指定了子类如何继承父类的所有特征和行为。<br/>\n> 例如：`学生（Student）` 也同样是 `人（Person）`，即有学生的特性也有人类的共性。\n\n<div class = \"image-display\">\n    <img src = \"./generalization.png\" alt = \"泛化\"/>\n    <br/>泛化（继承）\n</div>\n\n<br/>\n\n```java\n// 定义 Person 类\nclass Person {\n    private String name;\n    private int age;\n    \n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n    \n    @Override\n    public String toString() {\n        return \"{Name: \" + this.name + \", Age: \" + this.age + \"}\\n\";\n    }\n}\n\n// 定义 Student 类，继承 Person 类\nclass Student extends Person {\n    private String studentID;\n    \n    public Student(String name, int age, String studentID) {\n        super(name, age);\n        this.studentID = studentID;\n    }\n    \n    @Override\n    public String toString() {\n        return super.toString() + \"{Student ID: \" + this.studentID + \"}\";\n    }\n}\n```\n\n### <i class = \"fa fa-angle-right\"></i> 实现\n> `【实现关系】`：是一种类与接口的关系，表示类是接口所有特征和行为的实现。\n\n<div class = \"image-display\">\n    <img src = \"./implements.png\" alt = \"泛化\"/>\n    <br/>实现\n</div>\n\n<br/>\n\n``` java\n// 定义动作接口 Action\ninterface Action {\n    void Running();\n    void Sleeping();\n}\n\n// 定义 Animals 类，实现动作接口 Action\nclass Animals implements Action {\n    @Override\n    public void Running() {\n        System.out.println(\"It's Running!\");\n    }\n    \n    @Override\n    public void Sleeping() {\n        System.out.println(\"It's Sleeping!\");\n    }\n}\n```\n\n### <i class = \"fa fa-angle-right\"></i> 关联\n> `【关联关系】`：是一种拥有的关系，它使一个类知道另一个类的属性和方法；<br/>如：老师与学生，丈夫与妻子关联可以是双向的，也可以是单向的。<br/>双向的关联可以有两个箭头或者没有箭头，单向的关联有一个箭头。<br/>\n> `【代码体现】`：成员变量\n\n<div class = \"image-display\">\n    <img src = \"./association.png\" alt = \"关联\"/>\n    <br/>关联\n</div>\n\n<br/>\n\n```java\n// 定义学院类 College\nclass College {\n    private String name;\n    private ArrayList<Student> student; // 学生与学院 n : 1\n    \n    public Courses(String name) {\n        this.name = name;\n        this.student = new ArrayList<>();\n    }\n    \n    // 省略 getter 和 setter 方法...\n}\n\n// 定义学生类 Students\nclass Student {\n    private ArrayList<Teacher> teachers; // 学生与老师 n : m\n    \n    public Student() {\n        this.teachers = new ArrayList<>();\n    }\n    \n    // 省略 getter 和 setter 方法...\n}\n\n// 定义教师类 Teacher\nclass Teacher {\n    private ArrayList<Student> students; // 学生与老师 n : m\n    \n    public Teacher() {\n        this.students = new ArrayList<>();\n    }\n    \n    // 省略 getter 和 setter 方法...\n}\n```\n\n### <i class = \"fa fa-angle-right\"></i> 聚合\n> `【聚合关系】`：是整体与部分的关系，且<span class = \"markbutton bgblue\">部分可以离开整体而单独存在</span>。如车和轮胎是整体和部分的关系，轮胎离开车仍然可以存在。<br/>\n> <span class = \"markbutton bgblue\">聚合关系是关联关系的一种，是强的关联关系；</span> 关联和聚合在语法上无法区分，必须考察具体的逻辑关系。<br/>\n> `【代码体现】`：成员变量\n\n<div class = \"image-display\">\n    <img src = \"./aggregation.png\" alt = \"聚合\"/>\n    <br/>聚合\n</div>\n\n<br/>\n\n```java\n// 定义引擎类 Engine\nclass Engine {\n    private String name;\n\n    public Engine(String name) {\n        this.name = name;\n    }\n\n    public String getName() {\n        return name;\n    }\n}\n\n// 定义汽车类 Car\nclass Car {\n    private Engine engine; // 1:1 聚合关系\n    private Tyre[] tyres = new Tyre[4]; // 1:4 聚合关系\n\n    public Car() {\n        engine = new Engine(\"Engine\");\n    }\n\n    public Engine getEngine() {\n        return engine;\n    }\n\n    public Tyre[] getTyres() {\n        return tyres;\n    }\n}\n\n// 定义轮胎类 Tyre\nclass Tyre {\n    public void running() {\n        System.out.println(\"Tyre is running...\");\n    }\n}\n```\n\n### <i class = \"fa fa-angle-right\"></i> 组合\n> `【组合关系】`：是整体与部分的关系，但<span class = \"markbutton bgblue\">部分不能离开整体而单独存在</span>。如公司和部门是整体和部分的关系，没有公司就不存在部门。<br/>\n> 组合关系是关联关系的一种，是比聚合关系还要强的关系，它要求普通的聚合关系中代表整体的对象负责代表部分的对象的生命周期。<br/>\n> `【代码体现】`：成员变量<br/>\n> `【箭头及指向】`：带实心菱形的实线，菱形指向整体\n\n<div class = \"image-display\">\n    <img src = \"./composition.png\" alt = \"组合\"/>\n    <br/>组合\n</div>\n\n<br/>\n\n```java\n// 定义公司类 Company\nclass Company {\n    private String name;\n    \n    public Company(String name) {\n        this.name = name;\n    }\n}\n\n// 定义部门类 Department\nclass Department {\n    private Company company;\n    \n    public Department(Company company) {\n        this.company = company;\n    }\n}\n```\n\n### <i class = \"fa fa-angle-right\"></i> 依赖\n> `【依赖关系】`：是一种使用的关系，即<span class = \"markbutton bgblue\">一个类的实现需要另一个类的协助</span>，所以要尽量不使用双向的互相依赖.<br/>\n> `【代码表现】`：局部变量、方法的参数或者对静态方法的调用<br/>\n> `【箭头及指向】`：带箭头的虚线，指向被使用者\n\n<div class = \"image-display\">\n    <img src = \"./dependency.png\" alt = \"依赖\"/>\n    <br/>依赖\n</div>\n\n<br/>\n\n```c\n// 定义计算机类 Computer\nclass Computer {\n    private String name;\n    private static String cpu = \"Intel\";\n\n    public Computer(String name) {\n        this.name = name;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public static String showCPU() {\n        return cpu;\n    }\n}\n\n// 定义人类 People\nclass People {\n    // 使用局部方法参数\n    public void getComputerName(Computer computer) {\n        System.out.println(computer.getName());\n    }\n\n    // 使用静态方法\n    public void getComputerCPU() {\n        System.out.println(Computer.showCPU());\n    }\n}\n```\n\n### <i class = \"fa fa-angle-right\"></i> 类图应用\n<div class = \"image-display\">\n    <img src = \"./group.png\" alt = \"类图应用\"/>\n    <br/>类图应用\n</div>\n\n<br/>\n\n使用<span class = \"markbutton bgblue\">类图</span> 进行建模时，需要<span class = \"markbutton bgred\">注意如下事项</span>：\n<ol>\n    <li>类图可以呈现域、方法和类关系等代码要素，但无法表达详细业务流程。因此，如果只有类图模型，则并不能直接进行程序实现；</li>\n    <li>类图文档通常与代码实现不一致，且更新代价较高；</li>\n    <li>从静态代码形式上看，不同的类关系代码形式常常相同或类似。因此，一般按系统对象的角色或业务职责区分类关系。</li>\n</ol>","slug":"UML图例详解","published":1,"updated":"2020-01-14T20:30:47.525Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn62000y2lwj9nnweh6q","content":"<style type=\"text/css\">\n.redspan {\n    color: red;\n}\n.quotetitle {\n    color: #337ab7;\n    font-weight: 700;\n}\n.purpletitle {\n    color: #9954bb;\n    font-weight: 700;\n}\n.italic {\n    font-style: italic;\n}\n.markbutton {\n    padding: 3px 5px;\n    margin: 0 4px;\n    font-size: 16px;\n    font-weight: 700;\n    color: white;\n}\n.bgblue {\n    background-color: #337ab7;\n}\n.bgpurple {\n    background-color: #9954bb;\n}\n.bgred {\n    background-color: red;\n}\ntd {\n    text-align: center;\n    vertical-align: bottom;\n}\ntd, th {\n    border: 2px solid white;\n    font-size: 18px;\n}\nth {\n    background-color: #337ab7;\n    color: white;\n}\n.image-display {\n    text-align: center;\n    font-size: 16px;\n}\n.image-display img {\n    padding-bottom: 8px;\n}\n.code {\n    text-align: left;\n}\n</style>\n\n<blockquote>\n<p><span class=\"redspan\">志向和热爱是伟大行为的双翼。</span><br><br><a name=\"UML\">UML（Unified Modeling Language）</a>是一种统一建模语言，为面向对象开发系统的产品进行说明、可视化、和编制文档的一种标准语言。<br>在这里将介绍 <code>UML</code> 基本概念以及各个图的使用场景。</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"UML-图例详解\"><a href=\"#UML-图例详解\" class=\"headerlink\" title=\"UML 图例详解\"></a><code>UML</code> 图例详解</h2><p><code>UML</code> 分为用例视图、设计视图、进程视图、实现视图和拓扑视图，又可以静动分为静态视图和动态视图。静态图分为：用例图，类图，对象图，包图，构件图，部署图。动态图分为：状态图，活动图，协作图，序列图。</p>\n<h3 id=\"用例图（UseCase-Diagrams）\"><a href=\"#用例图（UseCase-Diagrams）\" class=\"headerlink\" title=\" 用例图（UseCase Diagrams）\"></a><i class=\"fa fa-angle-double-right\"></i> 用例图（UseCase Diagrams）</h3><blockquote>\n<p>用例是目标系统<a name=\"business-process\">业务过程（Business Process）</a>的抽象，由<a name=\"actor\">参与者（Actor）</a>与系统的交互步骤（或事件）组成，参与者通过用例完成具体的业务目标。<br>即：用例图主要回答了两个问题：<br>1. <span class=\"markbutton bgpurple\">是谁用软件</span><br>2. <span class=\"markbutton bgpurple\">软件的功能</span><br>从用户的角度描述了系统的功能，并指出各个功能的执行者，强调用户的使用者，系统为执行者完成哪些功能。</p>\n</blockquote>\n<p><span class=\"markbutton bgblue\">系统用例模型</span>通过 <code>UML</code> 用例图进行可视化。<code>UML</code> 用例图基本符号有 <span class=\"markbutton bgpurple\">用例（椭圆形标识）、参与者（人性标识）、系统边界（矩形标识）、关联（直线标识）</span>。<br></p>\n<ul>\n<li><p>如图 <code>1.1</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/UML_yongli.png\" alt=\"UML用例图\">\n      <br>图1.1&nbsp;&nbsp;&nbsp;&nbsp;UML用例图基本符号\n  </div>\n\n</li>\n</ul>\n<p><span class=\"markbutton bgblue\">用例建模</span> 是面向对象软件分析的重要技术和方法，开发人员在实用用例图进行用例模型可视化时需要<span class=\"markbutton bgred\">注意如下事项</span>：</p>\n<ol>\n    <li>用例图无法可视化非交互或非功能性的系统需求；</li>\n    <li>用例的定义没有统一标准；</li>\n    <li>复杂系统用例模型的全局可视化可能会降低用例图的可用性等。</li>\n</ol>\n\n<hr>\n\n<h3 id=\"序列图-时序图（Sequence-Diagrams）\"><a href=\"#序列图-时序图（Sequence-Diagrams）\" class=\"headerlink\" title=\" 序列图-时序图（Sequence Diagrams）\"></a><i class=\"fa fa-angle-double-right\"></i> 序列图-时序图（Sequence Diagrams）</h3><blockquote>\n<p><span class=\"markbutton bgblue\">UML时序图</span>通过对象、消息、交互顺序等方式可视化软件业务过程中的控制流或数据流。</p>\n</blockquote>\n<p><span class=\"markbutton bgblue\">时序图</span>中的对象通过发送消息和接受消息进行交互，消息具有先后顺序。UML时序图基本符号有<span class=\"markbutton bgpurple\">对象、消息、对象生命线、消息组合片段、终止符号等</span>。</p>\n<ul>\n<li><p>时序图如图 <code>1.2</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/UML_shixu.jpg\" alt=\"UML时序图\">\n      <br>图1.2&nbsp;&nbsp;&nbsp;&nbsp;UML时序图基本符号\n  </div>\n\n</li>\n</ul>\n<blockquote>\n<p><span class=\"markbutton bgblue\">消息</span>用从一个对象的生命线到另一个对象生命线的箭头表示。<br><br>箭头以<span class=\"markbutton bgblue\">时间顺序</span>在图中从上到下排列。<br><br></p>\n</blockquote>\n<h4 id=\"生命线\"><a href=\"#生命线\" class=\"headerlink\" title=\" 生命线\"></a><i class=\"fa fa-angle-right\"></i> 生命线</h4><blockquote>\n<p>生命线名称可带下划线。当使用下划线时，意味着序列图中的生命线代表一个类的特定实例。</p>\n</blockquote>\n<ul>\n<li><p>生命线如图 <code>1.3</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/shengmingxian.png\" alt=\"生命线\">\n      <br>图1.3&nbsp;&nbsp;&nbsp;&nbsp;生命线\n  </div>\n\n</li>\n</ul>\n<h4 id=\"同步消息\"><a href=\"#同步消息\" class=\"headerlink\" title=\" 同步消息\"></a><i class=\"fa fa-angle-right\"></i> 同步消息</h4><blockquote>\n<p>同步等待消息。</p>\n</blockquote>\n<ul>\n<li><p>同步消息如图 <code>1.4</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/tongbuxiaoxi.png\" alt=\"同步消息\">\n      <br>图1.4&nbsp;&nbsp;&nbsp;&nbsp;同步消息\n  </div>\n\n</li>\n</ul>\n<h4 id=\"异步消息\"><a href=\"#异步消息\" class=\"headerlink\" title=\" 异步消息\"></a><i class=\"fa fa-angle-right\"></i> 异步消息</h4><blockquote>\n<p>异步发送消息，不需等待。</p>\n</blockquote>\n<ul>\n<li><p>异步消息如图 <code>1.5</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/yibuxiaoxi.png\" alt=\"异步消息\">\n      <br>图1.5&nbsp;&nbsp;&nbsp;&nbsp;异步消息\n  </div>\n\n</li>\n</ul>\n<h4 id=\"注释\"><a href=\"#注释\" class=\"headerlink\" title=\" 注释\"></a><i class=\"fa fa-angle-right\"></i> 注释</h4><ul>\n<li><p>注释如图 <code>1.6</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/zhushi.png\" alt=\"注释\">\n      <br>图1.6&nbsp;&nbsp;&nbsp;&nbsp;注释\n  </div>\n\n</li>\n</ul>\n<h4 id=\"约束\"><a href=\"#约束\" class=\"headerlink\" title=\" 约束\"></a><i class=\"fa fa-angle-right\"></i> 约束</h4><ul>\n<li><p>约束如图 <code>1.7</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/yueshu.png\" alt=\"约束\">\n      <br>图1.7&nbsp;&nbsp;&nbsp;&nbsp;约束\n  </div>\n\n</li>\n</ul>\n<h4 id=\"组合\"><a href=\"#组合\" class=\"headerlink\" title=\" 组合\"></a><i class=\"fa fa-angle-right\"></i> 组合</h4><blockquote>\n<p><span class=\"markbutton bgblue\">组合片段用来解决交互执行的条件及方式。</span><br>它允许在序列图中直接表示逻辑组件，用于通过指定条件或子进程的应用区域，为任何生命线的任何部分定义特殊条件和子进程。<br>常用的组合片段有：<span class=\"markbutton bgpurple\">抉择、选项、循环、并行</span>。</p>\n</blockquote>\n<p>使用<span class=\"markbutton bgblue\">时序图</span> 进行对象交互模型可视化时，需要<span class=\"markbutton bgred\">注意如下事项</span>：</p>\n<ol>\n    <li>消息类型有同步消息、异步消息、返回消息、自关联消息等；</li>\n    <li>如果需要在时序图中标注对象生命周期的终止，可以使用终止符号；</li>\n    <li>可以对时序图标注<a name=\"type\">对象类型（Type）</a>和<a name=\"stereotype\">构造类型（Stereotype）</a>；</li>\n    <li>当系统内部对象需要和系统外部环境交互时，可以将外部环境（第三方系统或用户）标注为对象。</li>\n</ol>\n\n<hr>\n\n<h3 id=\"类图（Class-Diagrams）\"><a href=\"#类图（Class-Diagrams）\" class=\"headerlink\" title=\" 类图（Class Diagrams）\"></a><i class=\"fa fa-angle-double-right\"></i> 类图（Class Diagrams）</h3><blockquote>\n<p><strong>类是面向对象软件分析和设计的核心目标。</strong><br>定义了静态代码逻辑，是软件内部的<a name=\"generalization\">泛化（Generalization）</a>类型；对象是类的实例；类的关联是对象写作逻辑的静态表示。<br><span class=\"markbutton bgblue\">采用面向对象方法实施软件编码活动的本质是定义类。</span></p>\n</blockquote>\n<p>用户根据用例图抽象成类，描述类的内部结构和类与类之间的关系，是一种静态结构图。<br> 在UML类图中，常见的有以下几种关系: </p>\n<ul>\n<li><a name=\"generalization-inheritance\">泛化/继承（Generalization / Inheritance）</a></li>\n<li><a name=\"realization\">实现（Realization）</a></li>\n<li><a name=\"association\">关联（Association)</a></li>\n<li><a name=\"aggregation\">聚合（Aggregation）</a></li>\n<li><a name=\"composition\">组合（Composition）</a></li>\n<li><a name=\"dependency\">依赖（Dependency）</a></li>\n</ul>\n<blockquote>\n<p><strong>类图不仅可以用于呈现需求的业务领域，也可以用于表达逻辑代码的设计模型。</strong></p>\n</blockquote>\n<p>各种关系的强弱顺序： 泛化（继承） = 实现 &gt; 组合 &gt; 聚合 &gt; 关联 &gt; 依赖</p>\n<h3 id=\"泛化（继承）\"><a href=\"#泛化（继承）\" class=\"headerlink\" title=\" 泛化（继承）\"></a><i class=\"fa fa-angle-right\"></i> 泛化（继承）</h3><blockquote>\n<p><code>【泛化关系】</code>：是一种继承关系，表示一般与特殊的关系，它指定了子类如何继承父类的所有特征和行为。<br><br>例如：<code>学生（Student）</code> 也同样是 <code>人（Person）</code>，即有学生的特性也有人类的共性。</p>\n</blockquote>\n<div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/generalization.png\" alt=\"泛化\">\n    <br>泛化（继承）\n</div>\n\n<br>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义 Person 类</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> age;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Person</span><span class=\"params\">(String name, <span class=\"keyword\">int</span> age)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"&#123;Name: \"</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">\", Age: \"</span> + <span class=\"keyword\">this</span>.age + <span class=\"string\">\"&#125;\\n\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义 Student 类，继承 Person 类</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> <span class=\"keyword\">extends</span> <span class=\"title\">Person</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String studentID;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Student</span><span class=\"params\">(String name, <span class=\"keyword\">int</span> age, String studentID)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>(name, age);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.studentID = studentID;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.toString() + <span class=\"string\">\"&#123;Student ID: \"</span> + <span class=\"keyword\">this</span>.studentID + <span class=\"string\">\"&#125;\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"实现\"><a href=\"#实现\" class=\"headerlink\" title=\" 实现\"></a><i class=\"fa fa-angle-right\"></i> 实现</h3><blockquote>\n<p><code>【实现关系】</code>：是一种类与接口的关系，表示类是接口所有特征和行为的实现。</p>\n</blockquote>\n<div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/implements.png\" alt=\"泛化\">\n    <br>实现\n</div>\n\n<br>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义动作接口 Action</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Action</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Running</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Sleeping</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义 Animals 类，实现动作接口 Action</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Animals</span> <span class=\"keyword\">implements</span> <span class=\"title\">Action</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Running</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"It's Running!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Sleeping</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"It's Sleeping!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"关联\"><a href=\"#关联\" class=\"headerlink\" title=\" 关联\"></a><i class=\"fa fa-angle-right\"></i> 关联</h3><blockquote>\n<p><code>【关联关系】</code>：是一种拥有的关系，它使一个类知道另一个类的属性和方法；<br>如：老师与学生，丈夫与妻子关联可以是双向的，也可以是单向的。<br>双向的关联可以有两个箭头或者没有箭头，单向的关联有一个箭头。<br><br><code>【代码体现】</code>：成员变量</p>\n</blockquote>\n<div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/association.png\" alt=\"关联\">\n    <br>关联\n</div>\n\n<br>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义学院类 College</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">College</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ArrayList&lt;Student&gt; student; <span class=\"comment\">// 学生与学院 n : 1</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Courses</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.student = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 省略 getter 和 setter 方法...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义学生类 Students</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ArrayList&lt;Teacher&gt; teachers; <span class=\"comment\">// 学生与老师 n : m</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Student</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.teachers = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 省略 getter 和 setter 方法...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义教师类 Teacher</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Teacher</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ArrayList&lt;Student&gt; students; <span class=\"comment\">// 学生与老师 n : m</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Teacher</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.students = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 省略 getter 和 setter 方法...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"聚合\"><a href=\"#聚合\" class=\"headerlink\" title=\" 聚合\"></a><i class=\"fa fa-angle-right\"></i> 聚合</h3><blockquote>\n<p><code>【聚合关系】</code>：是整体与部分的关系，且<span class=\"markbutton bgblue\">部分可以离开整体而单独存在</span>。如车和轮胎是整体和部分的关系，轮胎离开车仍然可以存在。<br><br><span class=\"markbutton bgblue\">聚合关系是关联关系的一种，是强的关联关系；</span> 关联和聚合在语法上无法区分，必须考察具体的逻辑关系。<br><br><code>【代码体现】</code>：成员变量</p>\n</blockquote>\n<div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/aggregation.png\" alt=\"聚合\">\n    <br>聚合\n</div>\n\n<br>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义引擎类 Engine</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Engine</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Engine</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义汽车类 Car</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Engine engine; <span class=\"comment\">// 1:1 聚合关系</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Tyre[] tyres = <span class=\"keyword\">new</span> Tyre[<span class=\"number\">4</span>]; <span class=\"comment\">// 1:4 聚合关系</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Car</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        engine = <span class=\"keyword\">new</span> Engine(<span class=\"string\">\"Engine\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Engine <span class=\"title\">getEngine</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> engine;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Tyre[] getTyres() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tyres;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义轮胎类 Tyre</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Tyre</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">running</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Tyre is running...\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"组合-1\"><a href=\"#组合-1\" class=\"headerlink\" title=\" 组合\"></a><i class=\"fa fa-angle-right\"></i> 组合</h3><blockquote>\n<p><code>【组合关系】</code>：是整体与部分的关系，但<span class=\"markbutton bgblue\">部分不能离开整体而单独存在</span>。如公司和部门是整体和部分的关系，没有公司就不存在部门。<br><br>组合关系是关联关系的一种，是比聚合关系还要强的关系，它要求普通的聚合关系中代表整体的对象负责代表部分的对象的生命周期。<br><br><code>【代码体现】</code>：成员变量<br><br><code>【箭头及指向】</code>：带实心菱形的实线，菱形指向整体</p>\n</blockquote>\n<div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/composition.png\" alt=\"组合\">\n    <br>组合\n</div>\n\n<br>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义公司类 Company</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Company</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Company</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义部门类 Department</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Department</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Company company;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Department</span><span class=\"params\">(Company company)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.company = company;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"依赖\"><a href=\"#依赖\" class=\"headerlink\" title=\" 依赖\"></a><i class=\"fa fa-angle-right\"></i> 依赖</h3><blockquote>\n<p><code>【依赖关系】</code>：是一种使用的关系，即<span class=\"markbutton bgblue\">一个类的实现需要另一个类的协助</span>，所以要尽量不使用双向的互相依赖.<br><br><code>【代码表现】</code>：局部变量、方法的参数或者对静态方法的调用<br><br><code>【箭头及指向】</code>：带箭头的虚线，指向被使用者</p>\n</blockquote>\n<div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/dependency.png\" alt=\"依赖\">\n    <br>依赖\n</div>\n\n<br>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义计算机类 Computer</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Computer</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">String</span> name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">String</span> cpu = <span class=\"string\">\"Intel\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Computer</span><span class=\"params\">(<span class=\"keyword\">String</span> name)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">String</span> <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">String</span> <span class=\"title\">showCPU</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> cpu;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义人类 People</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">People</span> &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">// 使用局部方法参数</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">getComputerName</span><span class=\"params\">(Computer computer)</span> </span>&#123;</span><br><span class=\"line\">        System.out.<span class=\"built_in\">println</span>(computer.getName());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 使用静态方法</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">getComputerCPU</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.<span class=\"built_in\">println</span>(Computer.showCPU());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"类图应用\"><a href=\"#类图应用\" class=\"headerlink\" title=\" 类图应用\"></a><i class=\"fa fa-angle-right\"></i> 类图应用</h3><div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/group.png\" alt=\"类图应用\">\n    <br>类图应用\n</div>\n\n<br>\n\n<p>使用<span class=\"markbutton bgblue\">类图</span> 进行建模时，需要<span class=\"markbutton bgred\">注意如下事项</span>：</p>\n<ol>\n    <li>类图可以呈现域、方法和类关系等代码要素，但无法表达详细业务流程。因此，如果只有类图模型，则并不能直接进行程序实现；</li>\n    <li>类图文档通常与代码实现不一致，且更新代价较高；</li>\n    <li>从静态代码形式上看，不同的类关系代码形式常常相同或类似。因此，一般按系统对象的角色或业务职责区分类关系。</li>\n</ol>","site":{"data":{}},"length":5948,"excerpt":"<style type=\"text/css\">\n.redspan {\n    color: red;\n}\n.quotetitle {\n    color: #337ab7;\n    font-weight: 700;\n}\n.purpletitle {\n    color: #9954bb;\n    font-weight: 700;\n}\n.italic {\n    font-style: italic;\n}\n.markbutton {\n    padding: 3px 5px;\n    margin: 0 4px;\n    font-size: 16px;\n    font-weight: 700;\n    color: white;\n}\n.bgblue {\n    background-color: #337ab7;\n}\n.bgpurple {\n    background-color: #9954bb;\n}\n.bgred {\n    background-color: red;\n}\ntd {\n    text-align: center;\n    vertical-align: bottom;\n}\ntd, th {\n    border: 2px solid white;\n    font-size: 18px;\n}\nth {\n    background-color: #337ab7;\n    color: white;\n}\n.image-display {\n    text-align: center;\n    font-size: 16px;\n}\n.image-display img {\n    padding-bottom: 8px;\n}\n.code {\n    text-align: left;\n}\n</style>\n\n<blockquote>\n<p><span class=\"redspan\">志向和热爱是伟大行为的双翼。</span><br><br><a name=\"UML\">UML（Unified Modeling Language）</a>是一种统一建模语言，为面向对象开发系统的产品进行说明、可视化、和编制文档的一种标准语言。<br>在这里将介绍 <code>UML</code> 基本概念以及各个图的使用场景。</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"UML-图例详解\"><a href=\"#UML-图例详解\" class=\"headerlink\" title=\"UML 图例详解\"></a><code>UML</code> 图例详解</h2><p><code>UML</code> 分为用例视图、设计视图、进程视图、实现视图和拓扑视图，又可以静动分为静态视图和动态视图。静态图分为：用例图，类图，对象图，包图，构件图，部署图。动态图分为：状态图，活动图，协作图，序列图。</p>\n<h3 id=\"用例图（UseCase-Diagrams）\"><a href=\"#用例图（UseCase-Diagrams）\" class=\"headerlink\" title=\" 用例图（UseCase Diagrams）\"></a><i class=\"fa fa-angle-double-right\"></i> 用例图（UseCase Diagrams）</h3><blockquote>\n<p>用例是目标系统<a name=\"business-process\">业务过程（Business Process）</a>的抽象，由<a name=\"actor\">参与者（Actor）</a>与系统的交互步骤（或事件）组成，参与者通过用例完成具体的业务目标。<br>即：用例图主要回答了两个问题：<br>1. <span class=\"markbutton bgpurple\">是谁用软件</span><br>2. <span class=\"markbutton bgpurple\">软件的功能</span><br>从用户的角度描述了系统的功能，并指出各个功能的执行者，强调用户的使用者，系统为执行者完成哪些功能。</p>\n</blockquote>\n<p><span class=\"markbutton bgblue\">系统用例模型</span>通过 <code>UML</code> 用例图进行可视化。<code>UML</code> 用例图基本符号有 <span class=\"markbutton bgpurple\">用例（椭圆形标识）、参与者（人性标识）、系统边界（矩形标识）、关联（直线标识）</span>。<br></p>\n<ul>\n<li><p>如图 <code>1.1</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/UML_yongli.png\" alt=\"UML用例图\">\n      <br>图1.1&nbsp;&nbsp;&nbsp;&nbsp;UML用例图基本符号\n  </div>\n\n</li>\n</ul>\n<p><span class=\"markbutton bgblue\">用例建模</span> 是面向对象软件分析的重要技术和方法，开发人员在实用用例图进行用例模型可视化时需要<span class=\"markbutton bgred\">注意如下事项</span>：</p>\n<ol>\n    <li>用例图无法可视化非交互或非功能性的系统需求；</li>\n    <li>用例的定义没有统一标准；</li>\n    <li>复杂系统用例模型的全局可视化可能会降低用例图的可用性等。</li>\n</ol>\n\n<hr>\n\n<h3 id=\"序列图-时序图（Sequence-Diagrams）\"><a href=\"#序列图-时序图（Sequence-Diagrams）\" class=\"headerlink\" title=\" 序列图-时序图（Sequence Diagrams）\"></a><i class=\"fa fa-angle-double-right\"></i> 序列图-时序图（Sequence Diagrams）</h3><blockquote>\n<p><span class=\"markbutton bgblue\">UML时序图</span>通过对象、消息、交互顺序等方式可视化软件业务过程中的控制流或数据流。</p>\n</blockquote>\n<p><span class=\"markbutton bgblue\">时序图</span>中的对象通过发送消息和接受消息进行交互，消息具有先后顺序。UML时序图基本符号有<span class=\"markbutton bgpurple\">对象、消息、对象生命线、消息组合片段、终止符号等</span>。</p>\n<ul>\n<li><p>时序图如图 <code>1.2</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/UML_shixu.jpg\" alt=\"UML时序图\">\n      <br>图1.2&nbsp;&nbsp;&nbsp;&nbsp;UML时序图基本符号\n  </div>\n\n</li>\n</ul>\n<blockquote>\n<p><span class=\"markbutton bgblue\">消息</span>用从一个对象的生命线到另一个对象生命线的箭头表示。<br><br>箭头以<span class=\"markbutton bgblue\">时间顺序</span>在图中从上到下排列。<br><br></p>\n</blockquote>\n<h4 id=\"生命线\"><a href=\"#生命线\" class=\"headerlink\" title=\" 生命线\"></a><i class=\"fa fa-angle-right\"></i> 生命线</h4><blockquote>\n<p>生命线名称可带下划线。当使用下划线时，意味着序列图中的生命线代表一个类的特定实例。</p>\n</blockquote>\n<ul>\n<li><p>生命线如图 <code>1.3</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/shengmingxian.png\" alt=\"生命线\">\n      <br>图1.3&nbsp;&nbsp;&nbsp;&nbsp;生命线\n  </div>\n\n</li>\n</ul>\n<h4 id=\"同步消息\"><a href=\"#同步消息\" class=\"headerlink\" title=\" 同步消息\"></a><i class=\"fa fa-angle-right\"></i> 同步消息</h4><blockquote>\n<p>同步等待消息。</p>\n</blockquote>\n<ul>\n<li><p>同步消息如图 <code>1.4</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/tongbuxiaoxi.png\" alt=\"同步消息\">\n      <br>图1.4&nbsp;&nbsp;&nbsp;&nbsp;同步消息\n  </div>\n\n</li>\n</ul>\n<h4 id=\"异步消息\"><a href=\"#异步消息\" class=\"headerlink\" title=\" 异步消息\"></a><i class=\"fa fa-angle-right\"></i> 异步消息</h4><blockquote>\n<p>异步发送消息，不需等待。</p>\n</blockquote>\n<ul>\n<li><p>异步消息如图 <code>1.5</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/yibuxiaoxi.png\" alt=\"异步消息\">\n      <br>图1.5&nbsp;&nbsp;&nbsp;&nbsp;异步消息\n  </div>\n\n</li>\n</ul>\n<h4 id=\"注释\"><a href=\"#注释\" class=\"headerlink\" title=\" 注释\"></a><i class=\"fa fa-angle-right\"></i> 注释</h4><ul>\n<li><p>注释如图 <code>1.6</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/zhushi.png\" alt=\"注释\">\n      <br>图1.6&nbsp;&nbsp;&nbsp;&nbsp;注释\n  </div>\n\n</li>\n</ul>\n<h4 id=\"约束\"><a href=\"#约束\" class=\"headerlink\" title=\" 约束\"></a><i class=\"fa fa-angle-right\"></i> 约束</h4><ul>\n<li><p>约束如图 <code>1.7</code> 所示：</p>\n  <div class=\"image-display\">\n      <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/yueshu.png\" alt=\"约束\">\n      <br>图1.7&nbsp;&nbsp;&nbsp;&nbsp;约束\n  </div>\n\n</li>\n</ul>\n<h4 id=\"组合\"><a href=\"#组合\" class=\"headerlink\" title=\" 组合\"></a><i class=\"fa fa-angle-right\"></i> 组合</h4><blockquote>\n<p><span class=\"markbutton bgblue\">组合片段用来解决交互执行的条件及方式。</span><br>它允许在序列图中直接表示逻辑组件，用于通过指定条件或子进程的应用区域，为任何生命线的任何部分定义特殊条件和子进程。<br>常用的组合片段有：<span class=\"markbutton bgpurple\">抉择、选项、循环、并行</span>。</p>\n</blockquote>\n<p>使用<span class=\"markbutton bgblue\">时序图</span> 进行对象交互模型可视化时，需要<span class=\"markbutton bgred\">注意如下事项</span>：</p>\n<ol>\n    <li>消息类型有同步消息、异步消息、返回消息、自关联消息等；</li>\n    <li>如果需要在时序图中标注对象生命周期的终止，可以使用终止符号；</li>\n    <li>可以对时序图标注<a name=\"type\">对象类型（Type）</a>和<a name=\"stereotype\">构造类型（Stereotype）</a>；</li>\n    <li>当系统内部对象需要和系统外部环境交互时，可以将外部环境（第三方系统或用户）标注为对象。</li>\n</ol>\n\n<hr>\n\n<h3 id=\"类图（Class-Diagrams）\"><a href=\"#类图（Class-Diagrams）\" class=\"headerlink\" title=\" 类图（Class Diagrams）\"></a><i class=\"fa fa-angle-double-right\"></i> 类图（Class Diagrams）</h3><blockquote>\n<p><strong>类是面向对象软件分析和设计的核心目标。</strong><br>定义了静态代码逻辑，是软件内部的<a name=\"generalization\">泛化（Generalization）</a>类型；对象是类的实例；类的关联是对象写作逻辑的静态表示。<br><span class=\"markbutton bgblue\">采用面向对象方法实施软件编码活动的本质是定义类。</span></p>\n</blockquote>\n<p>用户根据用例图抽象成类，描述类的内部结构和类与类之间的关系，是一种静态结构图。<br> 在UML类图中，常见的有以下几种关系: </p>\n<ul>\n<li><a name=\"generalization-inheritance\">泛化/继承（Generalization / Inheritance）</a></li>\n<li><a name=\"realization\">实现（Realization）</a></li>\n<li><a name=\"association\">关联（Association)</a></li>\n<li><a name=\"aggregation\">聚合（Aggregation）</a></li>\n<li><a name=\"composition\">组合（Composition）</a></li>\n<li><a name=\"dependency\">依赖（Dependency）</a></li>\n</ul>\n<blockquote>\n<p><strong>类图不仅可以用于呈现需求的业务领域，也可以用于表达逻辑代码的设计模型。</strong></p>\n</blockquote>\n<p>各种关系的强弱顺序： 泛化（继承） = 实现 &gt; 组合 &gt; 聚合 &gt; 关联 &gt; 依赖</p>\n<h3 id=\"泛化（继承）\"><a href=\"#泛化（继承）\" class=\"headerlink\" title=\" 泛化（继承）\"></a><i class=\"fa fa-angle-right\"></i> 泛化（继承）</h3><blockquote>\n<p><code>【泛化关系】</code>：是一种继承关系，表示一般与特殊的关系，它指定了子类如何继承父类的所有特征和行为。<br><br>例如：<code>学生（Student）</code> 也同样是 <code>人（Person）</code>，即有学生的特性也有人类的共性。</p>\n</blockquote>\n<div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/generalization.png\" alt=\"泛化\">\n    <br>泛化（继承）\n</div>\n\n<br>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义 Person 类</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Person</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> age;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Person</span><span class=\"params\">(String name, <span class=\"keyword\">int</span> age)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.age = age;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"&#123;Name: \"</span> + <span class=\"keyword\">this</span>.name + <span class=\"string\">\", Age: \"</span> + <span class=\"keyword\">this</span>.age + <span class=\"string\">\"&#125;\\n\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义 Student 类，继承 Person 类</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> <span class=\"keyword\">extends</span> <span class=\"title\">Person</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String studentID;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Student</span><span class=\"params\">(String name, <span class=\"keyword\">int</span> age, String studentID)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>(name, age);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.studentID = studentID;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.toString() + <span class=\"string\">\"&#123;Student ID: \"</span> + <span class=\"keyword\">this</span>.studentID + <span class=\"string\">\"&#125;\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"实现\"><a href=\"#实现\" class=\"headerlink\" title=\" 实现\"></a><i class=\"fa fa-angle-right\"></i> 实现</h3><blockquote>\n<p><code>【实现关系】</code>：是一种类与接口的关系，表示类是接口所有特征和行为的实现。</p>\n</blockquote>\n<div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/implements.png\" alt=\"泛化\">\n    <br>实现\n</div>\n\n<br>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义动作接口 Action</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Action</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Running</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Sleeping</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义 Animals 类，实现动作接口 Action</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Animals</span> <span class=\"keyword\">implements</span> <span class=\"title\">Action</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Running</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"It's Running!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Sleeping</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"It's Sleeping!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"关联\"><a href=\"#关联\" class=\"headerlink\" title=\" 关联\"></a><i class=\"fa fa-angle-right\"></i> 关联</h3><blockquote>\n<p><code>【关联关系】</code>：是一种拥有的关系，它使一个类知道另一个类的属性和方法；<br>如：老师与学生，丈夫与妻子关联可以是双向的，也可以是单向的。<br>双向的关联可以有两个箭头或者没有箭头，单向的关联有一个箭头。<br><br><code>【代码体现】</code>：成员变量</p>\n</blockquote>\n<div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/association.png\" alt=\"关联\">\n    <br>关联\n</div>\n\n<br>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义学院类 College</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">College</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ArrayList&lt;Student&gt; student; <span class=\"comment\">// 学生与学院 n : 1</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Courses</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.student = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 省略 getter 和 setter 方法...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义学生类 Students</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Student</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ArrayList&lt;Teacher&gt; teachers; <span class=\"comment\">// 学生与老师 n : m</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Student</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.teachers = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 省略 getter 和 setter 方法...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义教师类 Teacher</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Teacher</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ArrayList&lt;Student&gt; students; <span class=\"comment\">// 学生与老师 n : m</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Teacher</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.students = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 省略 getter 和 setter 方法...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"聚合\"><a href=\"#聚合\" class=\"headerlink\" title=\" 聚合\"></a><i class=\"fa fa-angle-right\"></i> 聚合</h3><blockquote>\n<p><code>【聚合关系】</code>：是整体与部分的关系，且<span class=\"markbutton bgblue\">部分可以离开整体而单独存在</span>。如车和轮胎是整体和部分的关系，轮胎离开车仍然可以存在。<br><br><span class=\"markbutton bgblue\">聚合关系是关联关系的一种，是强的关联关系；</span> 关联和聚合在语法上无法区分，必须考察具体的逻辑关系。<br><br><code>【代码体现】</code>：成员变量</p>\n</blockquote>\n<div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/aggregation.png\" alt=\"聚合\">\n    <br>聚合\n</div>\n\n<br>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义引擎类 Engine</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Engine</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Engine</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义汽车类 Car</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Engine engine; <span class=\"comment\">// 1:1 聚合关系</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Tyre[] tyres = <span class=\"keyword\">new</span> Tyre[<span class=\"number\">4</span>]; <span class=\"comment\">// 1:4 聚合关系</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Car</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        engine = <span class=\"keyword\">new</span> Engine(<span class=\"string\">\"Engine\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Engine <span class=\"title\">getEngine</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> engine;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Tyre[] getTyres() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tyres;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义轮胎类 Tyre</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Tyre</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">running</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Tyre is running...\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"组合-1\"><a href=\"#组合-1\" class=\"headerlink\" title=\" 组合\"></a><i class=\"fa fa-angle-right\"></i> 组合</h3><blockquote>\n<p><code>【组合关系】</code>：是整体与部分的关系，但<span class=\"markbutton bgblue\">部分不能离开整体而单独存在</span>。如公司和部门是整体和部分的关系，没有公司就不存在部门。<br><br>组合关系是关联关系的一种，是比聚合关系还要强的关系，它要求普通的聚合关系中代表整体的对象负责代表部分的对象的生命周期。<br><br><code>【代码体现】</code>：成员变量<br><br><code>【箭头及指向】</code>：带实心菱形的实线，菱形指向整体</p>\n</blockquote>\n<div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/composition.png\" alt=\"组合\">\n    <br>组合\n</div>\n\n<br>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义公司类 Company</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Company</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Company</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义部门类 Department</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Department</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Company company;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Department</span><span class=\"params\">(Company company)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.company = company;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"依赖\"><a href=\"#依赖\" class=\"headerlink\" title=\" 依赖\"></a><i class=\"fa fa-angle-right\"></i> 依赖</h3><blockquote>\n<p><code>【依赖关系】</code>：是一种使用的关系，即<span class=\"markbutton bgblue\">一个类的实现需要另一个类的协助</span>，所以要尽量不使用双向的互相依赖.<br><br><code>【代码表现】</code>：局部变量、方法的参数或者对静态方法的调用<br><br><code>【箭头及指向】</code>：带箭头的虚线，指向被使用者</p>\n</blockquote>\n<div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/dependency.png\" alt=\"依赖\">\n    <br>依赖\n</div>\n\n<br>\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义计算机类 Computer</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Computer</span> &#123;</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">String</span> name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">String</span> cpu = <span class=\"string\">\"Intel\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Computer</span><span class=\"params\">(<span class=\"keyword\">String</span> name)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">String</span> <span class=\"title\">getName</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">String</span> <span class=\"title\">showCPU</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> cpu;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义人类 People</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">People</span> &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">// 使用局部方法参数</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">getComputerName</span><span class=\"params\">(Computer computer)</span> </span>&#123;</span><br><span class=\"line\">        System.out.<span class=\"built_in\">println</span>(computer.getName());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 使用静态方法</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">getComputerCPU</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.<span class=\"built_in\">println</span>(Computer.showCPU());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"类图应用\"><a href=\"#类图应用\" class=\"headerlink\" title=\" 类图应用\"></a><i class=\"fa fa-angle-right\"></i> 类图应用</h3><div class=\"image-display\">\n    <img src=\"/2019/08/28/UML%E5%9B%BE%E4%BE%8B%E8%AF%A6%E8%A7%A3/group.png\" alt=\"类图应用\">\n    <br>类图应用\n</div>\n\n<br>\n\n<p>使用<span class=\"markbutton bgblue\">类图</span> 进行建模时，需要<span class=\"markbutton bgred\">注意如下事项</span>：</p>\n<ol>\n    <li>类图可以呈现域、方法和类关系等代码要素，但无法表达详细业务流程。因此，如果只有类图模型，则并不能直接进行程序实现；</li>\n    <li>类图文档通常与代码实现不一致，且更新代价较高；</li>\n    <li>从静态代码形式上看，不同的类关系代码形式常常相同或类似。因此，一般按系统对象的角色或业务职责区分类关系。</li>\n</ol>"},{"title":"主流浏览器内核简述与Web标准","date":"2019-09-28T11:35:56.000Z","updated":"2020-01-21T16:43:12.000Z","copyright":true,"_content":"\n\n> <span class = 'introduction'>时间是个常数，但也是个变数。勤奋的人无穷多，懒惰的人无穷少。</span><br/>\n浏览器最重要或者说核心的部分是 <code>“Rendering Engine”</code>，可大概译为“渲染引擎”，不过我们一般习惯将之称为“浏览器内核”。这个问题也是前端面试中最为常见的问题。\n\n<!--more-->\n\n<hr/>\n\n## 什么是浏览器内核\n\n<div class = \"note info\" style = \"text-indent: 2em;\">\n<p>\n浏览器最重要或者说核心的部分是 <code>“Rendering Engine”</code>，可大概译为“渲染引擎”，不过我们一般习惯将之称为“浏览器内核”。</p>\n<p>\n负责对网页语法的解释（如标准通用标记语言下的一个应用HTML、JavaScript）并渲染（显示）网页。 所以，通常所谓的浏览器内核也就是浏览器所采用的渲染引擎，渲染引擎决定了浏览器如何显示网页的内容以及页面的格式信息。\n</p>\n<p>\n不同的浏览器内核对网页编写语法的解释也有不同，因此同一网页在不同的内核的浏览器里的渲染（显示）效果也可能不同，这也是网页编写者需要在不同内核的浏览器中测试网页显示效果的原因。\n</p>\n</div>\n<p>浏览器内核又可以分成两部分：渲染引擎(Layout Engineer 或者 Rendering Engine)和 JS 引擎。</p>\n<div class = \"note danger\">\n    <p><strong>1. 渲染引擎</strong></p>\n    <p>它负责取得网页的内容（HTML、XML、图像等等）、整理讯息（例如加入 CSS 等），以及计算网页的显示方式，然后会输出至显示器或打印机。浏览器的内核的不同对于网页的语法解释会有不同，所以渲染的效果也不相同。</p>\n    <p><strong>2. JS 引擎</strong></p>\n    <p>解析 Javascript 语言，执行 javascript语言来实现网页的动态效果。</p>\n</div>\n\n<hr />\n\n## 常见的浏览器内核\n\n### Trident：[ˈtraɪdnt]\n\n国内很多的双核浏览器的其中一核便是 Trident，美其名曰 \"兼容模式\"。\n\n代表： IE、傲游、世界之窗浏览器、Avant、腾讯TT、猎豹安全浏览器、360极速浏览器、百度浏览器等。\n\nWindows 10 发布后，IE 将其内置浏览器命名为 Edge，Edge 最显著的特点就是新内核 EdgeHTML。\n\n### Gecko：[ˈgekəʊ]\n\nGecko(Firefox 内核)： Mozilla FireFox(火狐浏览器) 采用该内核，Gecko 的特点是开放源代码、以 C++ 编写的网页排版引擎，是跨平台的。因此，其可开发程度很高，全世界的程序员都可以为其编写代码，增加功能。 \n\n<div class = \"note danger\">\n可惜这几年已经没落了， 比如打开速度慢、升级频繁、猪一样的队友 Flash、神一样的对手 Chrome。\n</div>\n\n### Presto：[ˈprestəʊ]\n\n目前公认网页浏览速度最快的浏览器内核，然而代价是牺牲了网页的兼容性。\n\n由 Opera Software 开发的浏览器排版引擎，Opera（欧朋浏览器），但由于市场选择问题，主要应用在手机平台–Opera mini\n\n### Webkit：[webˈkɪt]\n\n一个**开源**的浏览器引擎，同时 WebKit 也是苹果 Mac OS X **系统引擎框架**版本的名称，它拥有**清晰的源码结构、极快的渲染速度**，包含的 WebCore 排版引擎和 JavaScriptCore解析引擎，均是从 **KDE 的 KHTML 及 KJS 引擎**衍生而来。\n\n许多网站都是**按照 IE 来架设**的，很多网站不兼容 Webkit 内核，比如登录界面、网银等网页均不可使用 Webkit 内核的浏览器。\n\nSafari([səˈfɑri]), Google Chrome, 傲游3, 猎豹浏览器, 百度浏览器 opera浏览器 基于 Webkit 开发。\n\n<div class = \"note danger\">\n注1：2013 年 2 月 Opera 宣布转向 WebKit 引擎\n\n注2：2013 年 4 月 Opera 宣布放弃 WEBKIT，跟随 Google 的新开发的 Blink 引擎\n</div>\n\n- 2008年9月2日，谷歌公司发布的第一个版本Google Chrome（中文名为谷歌浏览器）就采用了 Webkit 引擎。\n- 2009年，广受关注的 Android 的自带的浏览器也是 Webkit 内核，加载网页速度比 IE 手机浏览器快了近一倍。\n- 2010年1月24日，搜狗公司发布搜狗浏览器 V2.0Beta，采用 Chromium 引擎，并支持与 **IE 引擎互相切换**。\n- 2010年1月24日，傲游浏览器3.0beta发布。2012年5月31日已发布3.3.9.1000。傲游3修正了众多**假死问题**。拥有**双引擎切换功能**。\n- 2010年9月16日，**360极速浏览器发布**，这是一款使用 Chromium 开源代码（基于 Webkit 内核）的浏览器，网页浏览比 IE 快一倍。\n- 2010年6月11日，**阿里云浏览器**内测第一版(0.1.9.0)发布，这是一款**集成** Chromium 内核、IE 内核的浏览器。\n- 2010年5月25日，腾讯推出的 **QQ浏览器** 采用 Webkit 内核以及 IE 内核。\n- 2011年7月18日，百度推出的**百度 PC 浏览器**支持 IE 和 Webkit **双内核智能切换**。\n- 2013年2月，Opera 宣布将用 WebKit 替代当前的核心浏览器引擎。[4]\n- 2013年4月4日，谷歌星期三（4月3日）宣布，他们将利用 WebKit 渲染引擎开发自主的网页渲染引擎 **Blink**。\n\n### Chromium：[ˈkrəʊmiəm]\n\nGoogle 的 Chrome 浏览器背后的引擎，Chromium 是一个由 Google 主导开发的网页浏览器，其目的是为了创建一个安全、稳定和快速的通用浏览器。\n\nChromium 相当于 Chrome 的工程版或称实验版。 在 Chromium 项目中研发 Blink 渲染引擎（即浏览器核心），内置于 Chrome 浏览器之中，Blink 其实是 WebKit 的分支。\n\n### 了解一点\n\n<div class = \"note info\" style = \"text-indent=2em\">\n<p>移动端的浏览器内核主要说的是系统内置浏览器的内核。</p>\n<p>目前移动设备浏览器上常用的内核有 Webkit，Blink，Trident，Gecko 等，其中 iPhone 和 iPad 等苹果 iOS 平台主要是 WebKit，Android 4.4 之前的 Android 系统浏览器内核是 WebKit，Android4.4 系统浏览器切换到了 Chromium，内核是 Webkit 的分支 Blink，Windows Phone 8 系统浏览器内核是 Trident。</p>\n</div>\n\n<hr />\n\n## Web 标准\n\nWeb标准不是某一个标准，而是由W3C和其他标准化组织制定的**一系列标准的集合**。\n\n主要包括结构（Structure）、表现（Presentation）和行为（Behavior）三个方面。\n\n1. 结构标准：结构用于对网页元素进行整理和分类，主要包括 XML 和 XHTML 两个部分；\n2. 样式标准：表现用于设置网页元素的版式、颜色、大小等外观样式，主要指的是 CSS；\n3. 行为标准：行为是指网页模型的定义及交互的编写，主要包括 DOM 和 ECMAScript 两个部分。\n\n### Web 标准的好处\n\n1. 让Web的发展前景更广阔 \n2. 内容能被更广泛的设备访问\n3. 更容易被搜寻引擎搜索\n4. 降低网站流量费用\n5. 使网站更易于维护\n6. 提高页面浏览速度\n","source":"_posts/主流浏览器内核简述与Web标准.md","raw":"---\ntitle: 主流浏览器内核简述与Web标准\ndate: 2019-09-28 19:35:56\nupdated: 2020-01-22 00:43:12\ntags:\n- HTML\n- 浏览器\n- web\ncategories:\n- 前端\n- 面经\ncopyright: true\n---\n\n\n> <span class = 'introduction'>时间是个常数，但也是个变数。勤奋的人无穷多，懒惰的人无穷少。</span><br/>\n浏览器最重要或者说核心的部分是 <code>“Rendering Engine”</code>，可大概译为“渲染引擎”，不过我们一般习惯将之称为“浏览器内核”。这个问题也是前端面试中最为常见的问题。\n\n<!--more-->\n\n<hr/>\n\n## 什么是浏览器内核\n\n<div class = \"note info\" style = \"text-indent: 2em;\">\n<p>\n浏览器最重要或者说核心的部分是 <code>“Rendering Engine”</code>，可大概译为“渲染引擎”，不过我们一般习惯将之称为“浏览器内核”。</p>\n<p>\n负责对网页语法的解释（如标准通用标记语言下的一个应用HTML、JavaScript）并渲染（显示）网页。 所以，通常所谓的浏览器内核也就是浏览器所采用的渲染引擎，渲染引擎决定了浏览器如何显示网页的内容以及页面的格式信息。\n</p>\n<p>\n不同的浏览器内核对网页编写语法的解释也有不同，因此同一网页在不同的内核的浏览器里的渲染（显示）效果也可能不同，这也是网页编写者需要在不同内核的浏览器中测试网页显示效果的原因。\n</p>\n</div>\n<p>浏览器内核又可以分成两部分：渲染引擎(Layout Engineer 或者 Rendering Engine)和 JS 引擎。</p>\n<div class = \"note danger\">\n    <p><strong>1. 渲染引擎</strong></p>\n    <p>它负责取得网页的内容（HTML、XML、图像等等）、整理讯息（例如加入 CSS 等），以及计算网页的显示方式，然后会输出至显示器或打印机。浏览器的内核的不同对于网页的语法解释会有不同，所以渲染的效果也不相同。</p>\n    <p><strong>2. JS 引擎</strong></p>\n    <p>解析 Javascript 语言，执行 javascript语言来实现网页的动态效果。</p>\n</div>\n\n<hr />\n\n## 常见的浏览器内核\n\n### Trident：[ˈtraɪdnt]\n\n国内很多的双核浏览器的其中一核便是 Trident，美其名曰 \"兼容模式\"。\n\n代表： IE、傲游、世界之窗浏览器、Avant、腾讯TT、猎豹安全浏览器、360极速浏览器、百度浏览器等。\n\nWindows 10 发布后，IE 将其内置浏览器命名为 Edge，Edge 最显著的特点就是新内核 EdgeHTML。\n\n### Gecko：[ˈgekəʊ]\n\nGecko(Firefox 内核)： Mozilla FireFox(火狐浏览器) 采用该内核，Gecko 的特点是开放源代码、以 C++ 编写的网页排版引擎，是跨平台的。因此，其可开发程度很高，全世界的程序员都可以为其编写代码，增加功能。 \n\n<div class = \"note danger\">\n可惜这几年已经没落了， 比如打开速度慢、升级频繁、猪一样的队友 Flash、神一样的对手 Chrome。\n</div>\n\n### Presto：[ˈprestəʊ]\n\n目前公认网页浏览速度最快的浏览器内核，然而代价是牺牲了网页的兼容性。\n\n由 Opera Software 开发的浏览器排版引擎，Opera（欧朋浏览器），但由于市场选择问题，主要应用在手机平台–Opera mini\n\n### Webkit：[webˈkɪt]\n\n一个**开源**的浏览器引擎，同时 WebKit 也是苹果 Mac OS X **系统引擎框架**版本的名称，它拥有**清晰的源码结构、极快的渲染速度**，包含的 WebCore 排版引擎和 JavaScriptCore解析引擎，均是从 **KDE 的 KHTML 及 KJS 引擎**衍生而来。\n\n许多网站都是**按照 IE 来架设**的，很多网站不兼容 Webkit 内核，比如登录界面、网银等网页均不可使用 Webkit 内核的浏览器。\n\nSafari([səˈfɑri]), Google Chrome, 傲游3, 猎豹浏览器, 百度浏览器 opera浏览器 基于 Webkit 开发。\n\n<div class = \"note danger\">\n注1：2013 年 2 月 Opera 宣布转向 WebKit 引擎\n\n注2：2013 年 4 月 Opera 宣布放弃 WEBKIT，跟随 Google 的新开发的 Blink 引擎\n</div>\n\n- 2008年9月2日，谷歌公司发布的第一个版本Google Chrome（中文名为谷歌浏览器）就采用了 Webkit 引擎。\n- 2009年，广受关注的 Android 的自带的浏览器也是 Webkit 内核，加载网页速度比 IE 手机浏览器快了近一倍。\n- 2010年1月24日，搜狗公司发布搜狗浏览器 V2.0Beta，采用 Chromium 引擎，并支持与 **IE 引擎互相切换**。\n- 2010年1月24日，傲游浏览器3.0beta发布。2012年5月31日已发布3.3.9.1000。傲游3修正了众多**假死问题**。拥有**双引擎切换功能**。\n- 2010年9月16日，**360极速浏览器发布**，这是一款使用 Chromium 开源代码（基于 Webkit 内核）的浏览器，网页浏览比 IE 快一倍。\n- 2010年6月11日，**阿里云浏览器**内测第一版(0.1.9.0)发布，这是一款**集成** Chromium 内核、IE 内核的浏览器。\n- 2010年5月25日，腾讯推出的 **QQ浏览器** 采用 Webkit 内核以及 IE 内核。\n- 2011年7月18日，百度推出的**百度 PC 浏览器**支持 IE 和 Webkit **双内核智能切换**。\n- 2013年2月，Opera 宣布将用 WebKit 替代当前的核心浏览器引擎。[4]\n- 2013年4月4日，谷歌星期三（4月3日）宣布，他们将利用 WebKit 渲染引擎开发自主的网页渲染引擎 **Blink**。\n\n### Chromium：[ˈkrəʊmiəm]\n\nGoogle 的 Chrome 浏览器背后的引擎，Chromium 是一个由 Google 主导开发的网页浏览器，其目的是为了创建一个安全、稳定和快速的通用浏览器。\n\nChromium 相当于 Chrome 的工程版或称实验版。 在 Chromium 项目中研发 Blink 渲染引擎（即浏览器核心），内置于 Chrome 浏览器之中，Blink 其实是 WebKit 的分支。\n\n### 了解一点\n\n<div class = \"note info\" style = \"text-indent=2em\">\n<p>移动端的浏览器内核主要说的是系统内置浏览器的内核。</p>\n<p>目前移动设备浏览器上常用的内核有 Webkit，Blink，Trident，Gecko 等，其中 iPhone 和 iPad 等苹果 iOS 平台主要是 WebKit，Android 4.4 之前的 Android 系统浏览器内核是 WebKit，Android4.4 系统浏览器切换到了 Chromium，内核是 Webkit 的分支 Blink，Windows Phone 8 系统浏览器内核是 Trident。</p>\n</div>\n\n<hr />\n\n## Web 标准\n\nWeb标准不是某一个标准，而是由W3C和其他标准化组织制定的**一系列标准的集合**。\n\n主要包括结构（Structure）、表现（Presentation）和行为（Behavior）三个方面。\n\n1. 结构标准：结构用于对网页元素进行整理和分类，主要包括 XML 和 XHTML 两个部分；\n2. 样式标准：表现用于设置网页元素的版式、颜色、大小等外观样式，主要指的是 CSS；\n3. 行为标准：行为是指网页模型的定义及交互的编写，主要包括 DOM 和 ECMAScript 两个部分。\n\n### Web 标准的好处\n\n1. 让Web的发展前景更广阔 \n2. 内容能被更广泛的设备访问\n3. 更容易被搜寻引擎搜索\n4. 降低网站流量费用\n5. 使网站更易于维护\n6. 提高页面浏览速度\n","slug":"主流浏览器内核简述与Web标准","published":1,"comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn6300102lwjhq0iaio9","content":"<blockquote>\n<p><span class=\"introduction\">时间是个常数，但也是个变数。勤奋的人无穷多，懒惰的人无穷少。</span><br><br>浏览器最重要或者说核心的部分是 <code>“Rendering Engine”</code>，可大概译为“渲染引擎”，不过我们一般习惯将之称为“浏览器内核”。这个问题也是前端面试中最为常见的问题。</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"什么是浏览器内核\"><a href=\"#什么是浏览器内核\" class=\"headerlink\" title=\"什么是浏览器内核\"></a>什么是浏览器内核</h2><div class=\"note info\" style=\"text-indent: 2em;\">\n<p>\n浏览器最重要或者说核心的部分是 <code>“Rendering Engine”</code>，可大概译为“渲染引擎”，不过我们一般习惯将之称为“浏览器内核”。</p>\n<p>\n负责对网页语法的解释（如标准通用标记语言下的一个应用HTML、JavaScript）并渲染（显示）网页。 所以，通常所谓的浏览器内核也就是浏览器所采用的渲染引擎，渲染引擎决定了浏览器如何显示网页的内容以及页面的格式信息。\n</p>\n<p>\n不同的浏览器内核对网页编写语法的解释也有不同，因此同一网页在不同的内核的浏览器里的渲染（显示）效果也可能不同，这也是网页编写者需要在不同内核的浏览器中测试网页显示效果的原因。\n</p>\n</div>\n<p>浏览器内核又可以分成两部分：渲染引擎(Layout Engineer 或者 Rendering Engine)和 JS 引擎。</p>\n<div class=\"note danger\">\n    <p><strong>1. 渲染引擎</strong></p>\n    <p>它负责取得网页的内容（HTML、XML、图像等等）、整理讯息（例如加入 CSS 等），以及计算网页的显示方式，然后会输出至显示器或打印机。浏览器的内核的不同对于网页的语法解释会有不同，所以渲染的效果也不相同。</p>\n    <p><strong>2. JS 引擎</strong></p>\n    <p>解析 Javascript 语言，执行 javascript语言来实现网页的动态效果。</p>\n</div>\n\n<hr>\n\n<h2 id=\"常见的浏览器内核\"><a href=\"#常见的浏览器内核\" class=\"headerlink\" title=\"常见的浏览器内核\"></a>常见的浏览器内核</h2><h3 id=\"Trident：-ˈtraɪdnt\"><a href=\"#Trident：-ˈtraɪdnt\" class=\"headerlink\" title=\"Trident：[ˈtraɪdnt]\"></a>Trident：[ˈtraɪdnt]</h3><p>国内很多的双核浏览器的其中一核便是 Trident，美其名曰 “兼容模式”。</p>\n<p>代表： IE、傲游、世界之窗浏览器、Avant、腾讯TT、猎豹安全浏览器、360极速浏览器、百度浏览器等。</p>\n<p>Windows 10 发布后，IE 将其内置浏览器命名为 Edge，Edge 最显著的特点就是新内核 EdgeHTML。</p>\n<h3 id=\"Gecko：-ˈgekəʊ\"><a href=\"#Gecko：-ˈgekəʊ\" class=\"headerlink\" title=\"Gecko：[ˈgekəʊ]\"></a>Gecko：[ˈgekəʊ]</h3><p>Gecko(Firefox 内核)： Mozilla FireFox(火狐浏览器) 采用该内核，Gecko 的特点是开放源代码、以 C++ 编写的网页排版引擎，是跨平台的。因此，其可开发程度很高，全世界的程序员都可以为其编写代码，增加功能。 </p>\n<div class=\"note danger\">\n可惜这几年已经没落了， 比如打开速度慢、升级频繁、猪一样的队友 Flash、神一样的对手 Chrome。\n</div>\n\n<h3 id=\"Presto：-ˈprestəʊ\"><a href=\"#Presto：-ˈprestəʊ\" class=\"headerlink\" title=\"Presto：[ˈprestəʊ]\"></a>Presto：[ˈprestəʊ]</h3><p>目前公认网页浏览速度最快的浏览器内核，然而代价是牺牲了网页的兼容性。</p>\n<p>由 Opera Software 开发的浏览器排版引擎，Opera（欧朋浏览器），但由于市场选择问题，主要应用在手机平台–Opera mini</p>\n<h3 id=\"Webkit：-webˈkɪt\"><a href=\"#Webkit：-webˈkɪt\" class=\"headerlink\" title=\"Webkit：[webˈkɪt]\"></a>Webkit：[webˈkɪt]</h3><p>一个<strong>开源</strong>的浏览器引擎，同时 WebKit 也是苹果 Mac OS X <strong>系统引擎框架</strong>版本的名称，它拥有<strong>清晰的源码结构、极快的渲染速度</strong>，包含的 WebCore 排版引擎和 JavaScriptCore解析引擎，均是从 <strong>KDE 的 KHTML 及 KJS 引擎</strong>衍生而来。</p>\n<p>许多网站都是<strong>按照 IE 来架设</strong>的，很多网站不兼容 Webkit 内核，比如登录界面、网银等网页均不可使用 Webkit 内核的浏览器。</p>\n<p>Safari([səˈfɑri]), Google Chrome, 傲游3, 猎豹浏览器, 百度浏览器 opera浏览器 基于 Webkit 开发。</p>\n<div class=\"note danger\">\n注1：2013 年 2 月 Opera 宣布转向 WebKit 引擎\n\n<p>注2：2013 年 4 月 Opera 宣布放弃 WEBKIT，跟随 Google 的新开发的 Blink 引擎</p>\n</div>\n\n<ul>\n<li>2008年9月2日，谷歌公司发布的第一个版本Google Chrome（中文名为谷歌浏览器）就采用了 Webkit 引擎。</li>\n<li>2009年，广受关注的 Android 的自带的浏览器也是 Webkit 内核，加载网页速度比 IE 手机浏览器快了近一倍。</li>\n<li>2010年1月24日，搜狗公司发布搜狗浏览器 V2.0Beta，采用 Chromium 引擎，并支持与 <strong>IE 引擎互相切换</strong>。</li>\n<li>2010年1月24日，傲游浏览器3.0beta发布。2012年5月31日已发布3.3.9.1000。傲游3修正了众多<strong>假死问题</strong>。拥有<strong>双引擎切换功能</strong>。</li>\n<li>2010年9月16日，<strong>360极速浏览器发布</strong>，这是一款使用 Chromium 开源代码（基于 Webkit 内核）的浏览器，网页浏览比 IE 快一倍。</li>\n<li>2010年6月11日，<strong>阿里云浏览器</strong>内测第一版(0.1.9.0)发布，这是一款<strong>集成</strong> Chromium 内核、IE 内核的浏览器。</li>\n<li>2010年5月25日，腾讯推出的 <strong>QQ浏览器</strong> 采用 Webkit 内核以及 IE 内核。</li>\n<li>2011年7月18日，百度推出的<strong>百度 PC 浏览器</strong>支持 IE 和 Webkit <strong>双内核智能切换</strong>。</li>\n<li>2013年2月，Opera 宣布将用 WebKit 替代当前的核心浏览器引擎。[4]</li>\n<li>2013年4月4日，谷歌星期三（4月3日）宣布，他们将利用 WebKit 渲染引擎开发自主的网页渲染引擎 <strong>Blink</strong>。</li>\n</ul>\n<h3 id=\"Chromium：-ˈkrəʊmiəm\"><a href=\"#Chromium：-ˈkrəʊmiəm\" class=\"headerlink\" title=\"Chromium：[ˈkrəʊmiəm]\"></a>Chromium：[ˈkrəʊmiəm]</h3><p>Google 的 Chrome 浏览器背后的引擎，Chromium 是一个由 Google 主导开发的网页浏览器，其目的是为了创建一个安全、稳定和快速的通用浏览器。</p>\n<p>Chromium 相当于 Chrome 的工程版或称实验版。 在 Chromium 项目中研发 Blink 渲染引擎（即浏览器核心），内置于 Chrome 浏览器之中，Blink 其实是 WebKit 的分支。</p>\n<h3 id=\"了解一点\"><a href=\"#了解一点\" class=\"headerlink\" title=\"了解一点\"></a>了解一点</h3><div class=\"note info\" style=\"text-indent=2em\">\n<p>移动端的浏览器内核主要说的是系统内置浏览器的内核。</p>\n<p>目前移动设备浏览器上常用的内核有 Webkit，Blink，Trident，Gecko 等，其中 iPhone 和 iPad 等苹果 iOS 平台主要是 WebKit，Android 4.4 之前的 Android 系统浏览器内核是 WebKit，Android4.4 系统浏览器切换到了 Chromium，内核是 Webkit 的分支 Blink，Windows Phone 8 系统浏览器内核是 Trident。</p>\n</div>\n\n<hr>\n\n<h2 id=\"Web-标准\"><a href=\"#Web-标准\" class=\"headerlink\" title=\"Web 标准\"></a>Web 标准</h2><p>Web标准不是某一个标准，而是由W3C和其他标准化组织制定的<strong>一系列标准的集合</strong>。</p>\n<p>主要包括结构（Structure）、表现（Presentation）和行为（Behavior）三个方面。</p>\n<ol>\n<li>结构标准：结构用于对网页元素进行整理和分类，主要包括 XML 和 XHTML 两个部分；</li>\n<li>样式标准：表现用于设置网页元素的版式、颜色、大小等外观样式，主要指的是 CSS；</li>\n<li>行为标准：行为是指网页模型的定义及交互的编写，主要包括 DOM 和 ECMAScript 两个部分。</li>\n</ol>\n<h3 id=\"Web-标准的好处\"><a href=\"#Web-标准的好处\" class=\"headerlink\" title=\"Web 标准的好处\"></a>Web 标准的好处</h3><ol>\n<li>让Web的发展前景更广阔 </li>\n<li>内容能被更广泛的设备访问</li>\n<li>更容易被搜寻引擎搜索</li>\n<li>降低网站流量费用</li>\n<li>使网站更易于维护</li>\n<li>提高页面浏览速度</li>\n</ol>\n","site":{"data":{}},"length":2624,"excerpt":"<blockquote>\n<p><span class=\"introduction\">时间是个常数，但也是个变数。勤奋的人无穷多，懒惰的人无穷少。</span><br><br>浏览器最重要或者说核心的部分是 <code>“Rendering Engine”</code>，可大概译为“渲染引擎”，不过我们一般习惯将之称为“浏览器内核”。这个问题也是前端面试中最为常见的问题。</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"什么是浏览器内核\"><a href=\"#什么是浏览器内核\" class=\"headerlink\" title=\"什么是浏览器内核\"></a>什么是浏览器内核</h2><div class=\"note info\" style=\"text-indent: 2em;\">\n<p>\n浏览器最重要或者说核心的部分是 <code>“Rendering Engine”</code>，可大概译为“渲染引擎”，不过我们一般习惯将之称为“浏览器内核”。</p>\n<p>\n负责对网页语法的解释（如标准通用标记语言下的一个应用HTML、JavaScript）并渲染（显示）网页。 所以，通常所谓的浏览器内核也就是浏览器所采用的渲染引擎，渲染引擎决定了浏览器如何显示网页的内容以及页面的格式信息。\n</p>\n<p>\n不同的浏览器内核对网页编写语法的解释也有不同，因此同一网页在不同的内核的浏览器里的渲染（显示）效果也可能不同，这也是网页编写者需要在不同内核的浏览器中测试网页显示效果的原因。\n</p>\n</div>\n<p>浏览器内核又可以分成两部分：渲染引擎(Layout Engineer 或者 Rendering Engine)和 JS 引擎。</p>\n<div class=\"note danger\">\n    <p><strong>1. 渲染引擎</strong></p>\n    <p>它负责取得网页的内容（HTML、XML、图像等等）、整理讯息（例如加入 CSS 等），以及计算网页的显示方式，然后会输出至显示器或打印机。浏览器的内核的不同对于网页的语法解释会有不同，所以渲染的效果也不相同。</p>\n    <p><strong>2. JS 引擎</strong></p>\n    <p>解析 Javascript 语言，执行 javascript语言来实现网页的动态效果。</p>\n</div>\n\n<hr>\n\n<h2 id=\"常见的浏览器内核\"><a href=\"#常见的浏览器内核\" class=\"headerlink\" title=\"常见的浏览器内核\"></a>常见的浏览器内核</h2><h3 id=\"Trident：-ˈtraɪdnt\"><a href=\"#Trident：-ˈtraɪdnt\" class=\"headerlink\" title=\"Trident：[ˈtraɪdnt]\"></a>Trident：[ˈtraɪdnt]</h3><p>国内很多的双核浏览器的其中一核便是 Trident，美其名曰 “兼容模式”。</p>\n<p>代表： IE、傲游、世界之窗浏览器、Avant、腾讯TT、猎豹安全浏览器、360极速浏览器、百度浏览器等。</p>\n<p>Windows 10 发布后，IE 将其内置浏览器命名为 Edge，Edge 最显著的特点就是新内核 EdgeHTML。</p>\n<h3 id=\"Gecko：-ˈgekəʊ\"><a href=\"#Gecko：-ˈgekəʊ\" class=\"headerlink\" title=\"Gecko：[ˈgekəʊ]\"></a>Gecko：[ˈgekəʊ]</h3><p>Gecko(Firefox 内核)： Mozilla FireFox(火狐浏览器) 采用该内核，Gecko 的特点是开放源代码、以 C++ 编写的网页排版引擎，是跨平台的。因此，其可开发程度很高，全世界的程序员都可以为其编写代码，增加功能。 </p>\n<div class=\"note danger\">\n可惜这几年已经没落了， 比如打开速度慢、升级频繁、猪一样的队友 Flash、神一样的对手 Chrome。\n</div>\n\n<h3 id=\"Presto：-ˈprestəʊ\"><a href=\"#Presto：-ˈprestəʊ\" class=\"headerlink\" title=\"Presto：[ˈprestəʊ]\"></a>Presto：[ˈprestəʊ]</h3><p>目前公认网页浏览速度最快的浏览器内核，然而代价是牺牲了网页的兼容性。</p>\n<p>由 Opera Software 开发的浏览器排版引擎，Opera（欧朋浏览器），但由于市场选择问题，主要应用在手机平台–Opera mini</p>\n<h3 id=\"Webkit：-webˈkɪt\"><a href=\"#Webkit：-webˈkɪt\" class=\"headerlink\" title=\"Webkit：[webˈkɪt]\"></a>Webkit：[webˈkɪt]</h3><p>一个<strong>开源</strong>的浏览器引擎，同时 WebKit 也是苹果 Mac OS X <strong>系统引擎框架</strong>版本的名称，它拥有<strong>清晰的源码结构、极快的渲染速度</strong>，包含的 WebCore 排版引擎和 JavaScriptCore解析引擎，均是从 <strong>KDE 的 KHTML 及 KJS 引擎</strong>衍生而来。</p>\n<p>许多网站都是<strong>按照 IE 来架设</strong>的，很多网站不兼容 Webkit 内核，比如登录界面、网银等网页均不可使用 Webkit 内核的浏览器。</p>\n<p>Safari([səˈfɑri]), Google Chrome, 傲游3, 猎豹浏览器, 百度浏览器 opera浏览器 基于 Webkit 开发。</p>\n<div class=\"note danger\">\n注1：2013 年 2 月 Opera 宣布转向 WebKit 引擎\n\n<p>注2：2013 年 4 月 Opera 宣布放弃 WEBKIT，跟随 Google 的新开发的 Blink 引擎</p>\n</div>\n\n<ul>\n<li>2008年9月2日，谷歌公司发布的第一个版本Google Chrome（中文名为谷歌浏览器）就采用了 Webkit 引擎。</li>\n<li>2009年，广受关注的 Android 的自带的浏览器也是 Webkit 内核，加载网页速度比 IE 手机浏览器快了近一倍。</li>\n<li>2010年1月24日，搜狗公司发布搜狗浏览器 V2.0Beta，采用 Chromium 引擎，并支持与 <strong>IE 引擎互相切换</strong>。</li>\n<li>2010年1月24日，傲游浏览器3.0beta发布。2012年5月31日已发布3.3.9.1000。傲游3修正了众多<strong>假死问题</strong>。拥有<strong>双引擎切换功能</strong>。</li>\n<li>2010年9月16日，<strong>360极速浏览器发布</strong>，这是一款使用 Chromium 开源代码（基于 Webkit 内核）的浏览器，网页浏览比 IE 快一倍。</li>\n<li>2010年6月11日，<strong>阿里云浏览器</strong>内测第一版(0.1.9.0)发布，这是一款<strong>集成</strong> Chromium 内核、IE 内核的浏览器。</li>\n<li>2010年5月25日，腾讯推出的 <strong>QQ浏览器</strong> 采用 Webkit 内核以及 IE 内核。</li>\n<li>2011年7月18日，百度推出的<strong>百度 PC 浏览器</strong>支持 IE 和 Webkit <strong>双内核智能切换</strong>。</li>\n<li>2013年2月，Opera 宣布将用 WebKit 替代当前的核心浏览器引擎。[4]</li>\n<li>2013年4月4日，谷歌星期三（4月3日）宣布，他们将利用 WebKit 渲染引擎开发自主的网页渲染引擎 <strong>Blink</strong>。</li>\n</ul>\n<h3 id=\"Chromium：-ˈkrəʊmiəm\"><a href=\"#Chromium：-ˈkrəʊmiəm\" class=\"headerlink\" title=\"Chromium：[ˈkrəʊmiəm]\"></a>Chromium：[ˈkrəʊmiəm]</h3><p>Google 的 Chrome 浏览器背后的引擎，Chromium 是一个由 Google 主导开发的网页浏览器，其目的是为了创建一个安全、稳定和快速的通用浏览器。</p>\n<p>Chromium 相当于 Chrome 的工程版或称实验版。 在 Chromium 项目中研发 Blink 渲染引擎（即浏览器核心），内置于 Chrome 浏览器之中，Blink 其实是 WebKit 的分支。</p>\n<h3 id=\"了解一点\"><a href=\"#了解一点\" class=\"headerlink\" title=\"了解一点\"></a>了解一点</h3><div class=\"note info\" style=\"text-indent=2em\">\n<p>移动端的浏览器内核主要说的是系统内置浏览器的内核。</p>\n<p>目前移动设备浏览器上常用的内核有 Webkit，Blink，Trident，Gecko 等，其中 iPhone 和 iPad 等苹果 iOS 平台主要是 WebKit，Android 4.4 之前的 Android 系统浏览器内核是 WebKit，Android4.4 系统浏览器切换到了 Chromium，内核是 Webkit 的分支 Blink，Windows Phone 8 系统浏览器内核是 Trident。</p>\n</div>\n\n<hr>\n\n<h2 id=\"Web-标准\"><a href=\"#Web-标准\" class=\"headerlink\" title=\"Web 标准\"></a>Web 标准</h2><p>Web标准不是某一个标准，而是由W3C和其他标准化组织制定的<strong>一系列标准的集合</strong>。</p>\n<p>主要包括结构（Structure）、表现（Presentation）和行为（Behavior）三个方面。</p>\n<ol>\n<li>结构标准：结构用于对网页元素进行整理和分类，主要包括 XML 和 XHTML 两个部分；</li>\n<li>样式标准：表现用于设置网页元素的版式、颜色、大小等外观样式，主要指的是 CSS；</li>\n<li>行为标准：行为是指网页模型的定义及交互的编写，主要包括 DOM 和 ECMAScript 两个部分。</li>\n</ol>\n<h3 id=\"Web-标准的好处\"><a href=\"#Web-标准的好处\" class=\"headerlink\" title=\"Web 标准的好处\"></a>Web 标准的好处</h3><ol>\n<li>让Web的发展前景更广阔 </li>\n<li>内容能被更广泛的设备访问</li>\n<li>更容易被搜寻引擎搜索</li>\n<li>降低网站流量费用</li>\n<li>使网站更易于维护</li>\n<li>提高页面浏览速度</li>\n</ol>"},{"title":"关于渐进增强与优雅降级","date":"2019-10-18T13:05:04.000Z","copyright":true,"image":"http://www.wqh4u.cn/2019/10/18/关于渐进增强与优雅降级/main.png","_content":"\n> <span class = 'introduction'>相信谎言的人必将在真理之前毁灭。</span><br/>\n<strong>渐进增强</strong> 与 <strong>优雅降级</strong> 是网页设计的一种策略，强调可访问性，语义 HTML 标记，外部样式表和脚本技术，这两个观点是在 CSS3 出现之后才火起来的。<br />由于低级浏览器，比如 <em><s>(特别是)</s></em> IE6 等，不支持 CSS3 的浏览器，但是 CSS3 的样式又特别优秀不忍放弃，所以在高级浏览器中应用 CSS3 样式，在低级浏览器只保证基本功能。\n\n<!--more-->\n\n<hr/>\n\n## 背景介绍\n\n**渐进增强** 是被 <i>Steven Champeon</i> 创造于 2003年3月11日 在奥斯汀的 <i>SXSW</i> 互动大会，并于 2003年3月和6月 间通过一系列 <i>Webmonkey</i> 教程文章的公布。谷歌公司是很支持这种开发方式，我认为渐进增强不仅是一个 **前端开发思想**，更加是一个 **程序开发思想**。\n\n## Progressive Enhancement\n\n在网页开发中，渐进增强认为 <span class=\"red-target\">应该专注于内容本身</span>。一开始针对低版本的浏览器构建页面，满足最基本的功能，再针对高级浏览器进行 **效果交互** 与 **追加各种功能** 以达到更好用户体验。<br />换句话说，就是以最低要求，实现最基础功能为基本，向上兼容。<br />以 CSS 为例，以下这种写法就是渐进增强：\n\n```css\n.box {\n    -webkit-border-radius: 10px;\n    -moz-border-radius: 10px;\n    border-radius: 10px;\n}\n```\n\n<div class=\"note info\">\n渐进增强也就是：一开始就针对低版本浏览器进行构建页面，完成基本的功能，然后再针对高级浏览器进行效果、交互、追加功能达到更好的体验。\n</div>\n\n### 渐进增强的核心原则\n\n- 基本内容应该是被所有网络浏览器访问\n- 基本功能应该是被所有网络浏览器访问\n- 稀疏的，语义化的标记包含的所有内容\n- 增强的布局是由外部链接的CSS提供\n- 增强的行为是由外部链接的非侵入式JavaScript提供\n- 最终用户的网络浏览器偏好被受到尊重\n\n<hr />\n\n## Graceful Degradation\n\n在网页开发中，优雅降级指的是一开始针对一个高版本的浏览器构建页面，先完善所有的功能。然后针对各个不同的浏览器进行测试、修复，保证低级浏览器也有基本功能 就好，低级浏览器被认为“简陋却无妨 (poor, but passable)”， 可以做一些小的调整来适应某个特定的浏览器。<br />但由于它们并非我们所关注的焦点，因此除了修复较 大的错误之外，其它的差异将被直接忽略。**也就是以高要求，高版本为基准，向下兼容。** <br />同样以css为例，优雅降级的写法如下。\n\n```css\n.box {\n    border-radius: 10px;\n    -webkit-border-radius: 10px;\n    -moz-border-radius: 10px;\n}\n```\n\n<div class=\"note info\">\n优雅降级也就是：一开始就构建站点的完整功能，然后针对浏览器测试和修复。比如一开始使用 CSS3 的特性构建了一个应用，然后逐步针对各大浏览器进行 hack 使其可以在低版本浏览器上正常浏览。\n</div>\n\n<hr />\n\n## 渐进增强与优雅降级的区别\n\n**优雅降级和渐进增强只是看待同种事物的两种观点。** <br />优雅降级和渐进增强都关注于同一网站在不同设备里不同浏览器下的表现程度。\n<br />关键的区别则在于它们各自关注于何处，以及这种关注如何影响工作的流程。\n\n<div class=\"note info\">\n<span class=\"blue-target\">优雅降级</span> 观点认为应该针对那些 <strong>最高级、最完善的浏览器</strong> 来设计网站。而将那些被认为“过时”或有功能缺失的浏览器下的测试工作安排在开发周期的最后阶段，并把测试对象限定为主流浏览器（如 IE、Mozilla 等）的前一个版本。\n<br />在这种设计范例下，旧版的浏览器被认为仅能提供 <strong>“简陋却无妨 (poor, but passable)”</strong> 的浏览体验。\n<br />你可以做一些小的调整来适应某个特定的浏览器。但由于它们并非我们所关注的焦点，因此除了修复较大的错误之外，其它的差异将被直接忽略。\n</div>\n<br />\n<div class=\"note info\">\n<strong>渐进增强</strong> 观点则认为应关注于内容本身。\n<br />请注意其中的差别：连 <strong>“浏览器”</strong> 三个字都没提。\n<br />内容是我们建立网站的诱因：有的网站展示它，有的则收集它，有的寻求，有的操作，还有的网站甚至会包含以上的种种，但相同点是它们全都涉及到内容。这使得渐进增强成为一种更为合理的设计范例。这也是它立即被 Yahoo! 所采纳并用以构建其 <strong>“分级式浏览器支持 (Graded Browser Support)”</strong> 策略的原因所在。\n</div>\n\n- 如果你采用渐进增强的开发流程，先做一个基本功能版，然后针对各个浏览器进行渐进增加，增加各种功能。相对于优雅降级来说，开发周期长，初期投入资金大。 你想一下不可能拿个基本功能版给客户看呀，多寒酸，搞不好一气之下就不找你做了，然后就炸了。但是呢，也有好处，就是提供了较好的平台稳定性，维护起来资金小， 长期来说降低开发成本。\n\n- 那采用优雅降级呢，这样可以在较短时间内开发出一个只用于一个浏览器的完整功能版，然后就可以拿给 PM 找客户谈呀，可以拿去测试，市场试水呀，对于功能尚未确定的 产品，优雅降级不失为一种节约成本的方法。\n\n<hr />\n\n## 案例分析\n\n```css\n/*渐进增强写法*/\n.transition {\n    -webkit-transition: all .5s;\n    -moz-transition: all .5s;\n    -o-transition: all .5s;\n    transition: all .5s;\n}\n```\n\n```css\n /*优雅降级写法*/\n.transition {\n    transition: all .5s;\n    -o-transition: all .5s;\n    -moz-transition: all .5s;\n    -webkit-transition: all .5s;\n}\n```\n\n前缀CSS3（-webkit- / -moz- / -o-*）和正常 CSS3 在浏览器中的支持情况是这样的：\n\n<ol>\n<li><strong>很久以前：</strong>浏览器 前缀CSS3 和 正常CSS3 <strong>都不支持</strong>；</li>\n<li><strong>不久之前：</strong>浏览器 <strong>只支持</strong> 前缀CSS3，<strong>不支持</strong> 正常CSS3；</li>\n<li><strong>现在：</strong>浏览器 <strong>既支持</strong> 前缀CSS3，<strong>又支持</strong> 正常CSS3；</li>\n<li><strong>未来：</strong>浏览器 <strong>不支持</strong> 前缀CSS3，<strong>仅支持</strong> 正常CSS3.</li>\n</ol>\n\n<ul>\n<li><strong>渐进增强</strong> 的写法，优先考虑老版本浏览器的可用性，最后才考虑新版本的可用性。在时期3前缀CSS3和正常CSS3都可用的情况下，正常CSS3会覆盖前缀CSS3。</li>\n<li><strong>优雅降级</strong> 的写法，优先考虑新版本浏览器的可用性，最后才考虑老版本的可用性。在时期3前缀CSS3和正常CSS3都可用的情况下，前缀CSS3会覆盖正常的CSS3。</li>\n</ul>\n\n<div class=\"note info\">\n就 CSS3 这种例子而言，我更加推崇渐进增强的写法。因为前缀 CSS3 的某些属性在浏览器中的实现效果有可能与正常的 CSS3 实现效果不太一样，所以最终还是得以正常 CSS3 为准。\n<br />如果你好奇究竟是什么属性在前缀 CSS3 和正常 CSS3 中显式效果不一样，可以看看这篇文章 <a href=\"http://www.zhangxinxu.com/wordpress/2010/09/需警惕css3属性的书写顺序/\">《需警惕CSS3属性的书写顺序》</a>。\n</div>\n\n<hr />\n\n## 如何抉择\n\n如果软件开发的预算和时间充足，就不存在抉择的问题。然而现实很残酷，要么开发周期短，要么开发预算少，或者二者兼而有之，这个时候该如何抉择？\n<br />就我个人而言，讲讲我的观点。\n\n<strong>根据你的用户所使用的客户端的版本来做决定。</strong> 请注意我的措辞，我没有用 <em>浏览器</em>，而是用 <em>客户端</em>。因为渐进增强和优雅降级的概念本质上是软件开发过程中低版本软件与高版本软件面对新功能的兼容抉择问题。\n<br />服务端程序很少存在这种问题，因为开发者可以控制服务端运行程序的版本，就无所谓渐进增强和优雅降级的问题。但是客户端程序则不是开发者所能控制的（你总不能强制用户去升级它们的浏览器吧）。我们所谓的客户端，可以指浏览器，移动终端设备（如：手机，平板电脑，智能手表等）以及它们对应的应用程序（浏览器对应的是网站，移动终端设备对应的是相应的APP）。\n\n现在有很成熟的技术，能够让你分析使用你客户端程序的版本比例。\n- 如果低版本用户居多，当然优先采用渐进增强的开发流程；\n- 如果高版本用户居多，为了提高大多数用户的使用体验，那当然优先采用优雅降级的开发流程。\n\n然而事实情况是怎么样的呢？<strong>绝大多数的大公司都是采用渐进增强的方式</strong>，因为业务优先，提升用户体验永远不会排在最前面。\n<br />例如：新浪微博网站前端的更新，拥有这种亿级用户的网站，绝对不可能追求某个特效而不考虑低版本用户可不可用，一定是确保低版本到高版本的可访问性，再去渐进增强，采用新功能给高版本用户提供更好的用户体验。\n<br />但也不是没有反例。如果你开发的是一款面向青少年的软件（或网站），你知道这个群体的人总是喜欢尝试新事物，总是喜欢酷炫的特效，总是喜欢把它们的软件更新到最新版本（而不像我们老一辈的用户）。面对这种情况，渐进增强的开发流程实为上选。\n\n<strong><span style=\"color: red;\">软件开发中，从来就没有银弹。</span>具体的抉择，请读者视情况而定。</strong>\n\n<hr />\n\n## 参考文献\n<ol>\n<li><a href=\"https://www.2cto.com/kf/201708/667067.html\">渐进增强和优雅降级之间有什么不同?</a></li>\n<li><a href=\"https://www.cnblogs.com/web-wjg/p/7240985.html\">前端开发之优雅降级与渐进增强</a></li>\n<li><a href=\"https://wikipedia.tw.wjbk.site/wiki/渐进增强\">渐进增强---Wikipedia</a></li>\n<li><a href=\"https://wikipedia.tw.wjbk.site/wiki/优雅降级\">优雅降级---Wikipedia</a></li>\n</ol>","source":"_posts/关于渐进增强与优雅降级.md","raw":"---\ntitle: 关于渐进增强与优雅降级\ndate: 2019-10-18 21:05:04\ntags:\n- Web\n- 浏览器\ncategories:\n- 前端\n- 面经\ncopyright: true\nimage: \"http://www.wqh4u.cn/2019/10/18/关于渐进增强与优雅降级/main.png\"\n---\n\n> <span class = 'introduction'>相信谎言的人必将在真理之前毁灭。</span><br/>\n<strong>渐进增强</strong> 与 <strong>优雅降级</strong> 是网页设计的一种策略，强调可访问性，语义 HTML 标记，外部样式表和脚本技术，这两个观点是在 CSS3 出现之后才火起来的。<br />由于低级浏览器，比如 <em><s>(特别是)</s></em> IE6 等，不支持 CSS3 的浏览器，但是 CSS3 的样式又特别优秀不忍放弃，所以在高级浏览器中应用 CSS3 样式，在低级浏览器只保证基本功能。\n\n<!--more-->\n\n<hr/>\n\n## 背景介绍\n\n**渐进增强** 是被 <i>Steven Champeon</i> 创造于 2003年3月11日 在奥斯汀的 <i>SXSW</i> 互动大会，并于 2003年3月和6月 间通过一系列 <i>Webmonkey</i> 教程文章的公布。谷歌公司是很支持这种开发方式，我认为渐进增强不仅是一个 **前端开发思想**，更加是一个 **程序开发思想**。\n\n## Progressive Enhancement\n\n在网页开发中，渐进增强认为 <span class=\"red-target\">应该专注于内容本身</span>。一开始针对低版本的浏览器构建页面，满足最基本的功能，再针对高级浏览器进行 **效果交互** 与 **追加各种功能** 以达到更好用户体验。<br />换句话说，就是以最低要求，实现最基础功能为基本，向上兼容。<br />以 CSS 为例，以下这种写法就是渐进增强：\n\n```css\n.box {\n    -webkit-border-radius: 10px;\n    -moz-border-radius: 10px;\n    border-radius: 10px;\n}\n```\n\n<div class=\"note info\">\n渐进增强也就是：一开始就针对低版本浏览器进行构建页面，完成基本的功能，然后再针对高级浏览器进行效果、交互、追加功能达到更好的体验。\n</div>\n\n### 渐进增强的核心原则\n\n- 基本内容应该是被所有网络浏览器访问\n- 基本功能应该是被所有网络浏览器访问\n- 稀疏的，语义化的标记包含的所有内容\n- 增强的布局是由外部链接的CSS提供\n- 增强的行为是由外部链接的非侵入式JavaScript提供\n- 最终用户的网络浏览器偏好被受到尊重\n\n<hr />\n\n## Graceful Degradation\n\n在网页开发中，优雅降级指的是一开始针对一个高版本的浏览器构建页面，先完善所有的功能。然后针对各个不同的浏览器进行测试、修复，保证低级浏览器也有基本功能 就好，低级浏览器被认为“简陋却无妨 (poor, but passable)”， 可以做一些小的调整来适应某个特定的浏览器。<br />但由于它们并非我们所关注的焦点，因此除了修复较 大的错误之外，其它的差异将被直接忽略。**也就是以高要求，高版本为基准，向下兼容。** <br />同样以css为例，优雅降级的写法如下。\n\n```css\n.box {\n    border-radius: 10px;\n    -webkit-border-radius: 10px;\n    -moz-border-radius: 10px;\n}\n```\n\n<div class=\"note info\">\n优雅降级也就是：一开始就构建站点的完整功能，然后针对浏览器测试和修复。比如一开始使用 CSS3 的特性构建了一个应用，然后逐步针对各大浏览器进行 hack 使其可以在低版本浏览器上正常浏览。\n</div>\n\n<hr />\n\n## 渐进增强与优雅降级的区别\n\n**优雅降级和渐进增强只是看待同种事物的两种观点。** <br />优雅降级和渐进增强都关注于同一网站在不同设备里不同浏览器下的表现程度。\n<br />关键的区别则在于它们各自关注于何处，以及这种关注如何影响工作的流程。\n\n<div class=\"note info\">\n<span class=\"blue-target\">优雅降级</span> 观点认为应该针对那些 <strong>最高级、最完善的浏览器</strong> 来设计网站。而将那些被认为“过时”或有功能缺失的浏览器下的测试工作安排在开发周期的最后阶段，并把测试对象限定为主流浏览器（如 IE、Mozilla 等）的前一个版本。\n<br />在这种设计范例下，旧版的浏览器被认为仅能提供 <strong>“简陋却无妨 (poor, but passable)”</strong> 的浏览体验。\n<br />你可以做一些小的调整来适应某个特定的浏览器。但由于它们并非我们所关注的焦点，因此除了修复较大的错误之外，其它的差异将被直接忽略。\n</div>\n<br />\n<div class=\"note info\">\n<strong>渐进增强</strong> 观点则认为应关注于内容本身。\n<br />请注意其中的差别：连 <strong>“浏览器”</strong> 三个字都没提。\n<br />内容是我们建立网站的诱因：有的网站展示它，有的则收集它，有的寻求，有的操作，还有的网站甚至会包含以上的种种，但相同点是它们全都涉及到内容。这使得渐进增强成为一种更为合理的设计范例。这也是它立即被 Yahoo! 所采纳并用以构建其 <strong>“分级式浏览器支持 (Graded Browser Support)”</strong> 策略的原因所在。\n</div>\n\n- 如果你采用渐进增强的开发流程，先做一个基本功能版，然后针对各个浏览器进行渐进增加，增加各种功能。相对于优雅降级来说，开发周期长，初期投入资金大。 你想一下不可能拿个基本功能版给客户看呀，多寒酸，搞不好一气之下就不找你做了，然后就炸了。但是呢，也有好处，就是提供了较好的平台稳定性，维护起来资金小， 长期来说降低开发成本。\n\n- 那采用优雅降级呢，这样可以在较短时间内开发出一个只用于一个浏览器的完整功能版，然后就可以拿给 PM 找客户谈呀，可以拿去测试，市场试水呀，对于功能尚未确定的 产品，优雅降级不失为一种节约成本的方法。\n\n<hr />\n\n## 案例分析\n\n```css\n/*渐进增强写法*/\n.transition {\n    -webkit-transition: all .5s;\n    -moz-transition: all .5s;\n    -o-transition: all .5s;\n    transition: all .5s;\n}\n```\n\n```css\n /*优雅降级写法*/\n.transition {\n    transition: all .5s;\n    -o-transition: all .5s;\n    -moz-transition: all .5s;\n    -webkit-transition: all .5s;\n}\n```\n\n前缀CSS3（-webkit- / -moz- / -o-*）和正常 CSS3 在浏览器中的支持情况是这样的：\n\n<ol>\n<li><strong>很久以前：</strong>浏览器 前缀CSS3 和 正常CSS3 <strong>都不支持</strong>；</li>\n<li><strong>不久之前：</strong>浏览器 <strong>只支持</strong> 前缀CSS3，<strong>不支持</strong> 正常CSS3；</li>\n<li><strong>现在：</strong>浏览器 <strong>既支持</strong> 前缀CSS3，<strong>又支持</strong> 正常CSS3；</li>\n<li><strong>未来：</strong>浏览器 <strong>不支持</strong> 前缀CSS3，<strong>仅支持</strong> 正常CSS3.</li>\n</ol>\n\n<ul>\n<li><strong>渐进增强</strong> 的写法，优先考虑老版本浏览器的可用性，最后才考虑新版本的可用性。在时期3前缀CSS3和正常CSS3都可用的情况下，正常CSS3会覆盖前缀CSS3。</li>\n<li><strong>优雅降级</strong> 的写法，优先考虑新版本浏览器的可用性，最后才考虑老版本的可用性。在时期3前缀CSS3和正常CSS3都可用的情况下，前缀CSS3会覆盖正常的CSS3。</li>\n</ul>\n\n<div class=\"note info\">\n就 CSS3 这种例子而言，我更加推崇渐进增强的写法。因为前缀 CSS3 的某些属性在浏览器中的实现效果有可能与正常的 CSS3 实现效果不太一样，所以最终还是得以正常 CSS3 为准。\n<br />如果你好奇究竟是什么属性在前缀 CSS3 和正常 CSS3 中显式效果不一样，可以看看这篇文章 <a href=\"http://www.zhangxinxu.com/wordpress/2010/09/需警惕css3属性的书写顺序/\">《需警惕CSS3属性的书写顺序》</a>。\n</div>\n\n<hr />\n\n## 如何抉择\n\n如果软件开发的预算和时间充足，就不存在抉择的问题。然而现实很残酷，要么开发周期短，要么开发预算少，或者二者兼而有之，这个时候该如何抉择？\n<br />就我个人而言，讲讲我的观点。\n\n<strong>根据你的用户所使用的客户端的版本来做决定。</strong> 请注意我的措辞，我没有用 <em>浏览器</em>，而是用 <em>客户端</em>。因为渐进增强和优雅降级的概念本质上是软件开发过程中低版本软件与高版本软件面对新功能的兼容抉择问题。\n<br />服务端程序很少存在这种问题，因为开发者可以控制服务端运行程序的版本，就无所谓渐进增强和优雅降级的问题。但是客户端程序则不是开发者所能控制的（你总不能强制用户去升级它们的浏览器吧）。我们所谓的客户端，可以指浏览器，移动终端设备（如：手机，平板电脑，智能手表等）以及它们对应的应用程序（浏览器对应的是网站，移动终端设备对应的是相应的APP）。\n\n现在有很成熟的技术，能够让你分析使用你客户端程序的版本比例。\n- 如果低版本用户居多，当然优先采用渐进增强的开发流程；\n- 如果高版本用户居多，为了提高大多数用户的使用体验，那当然优先采用优雅降级的开发流程。\n\n然而事实情况是怎么样的呢？<strong>绝大多数的大公司都是采用渐进增强的方式</strong>，因为业务优先，提升用户体验永远不会排在最前面。\n<br />例如：新浪微博网站前端的更新，拥有这种亿级用户的网站，绝对不可能追求某个特效而不考虑低版本用户可不可用，一定是确保低版本到高版本的可访问性，再去渐进增强，采用新功能给高版本用户提供更好的用户体验。\n<br />但也不是没有反例。如果你开发的是一款面向青少年的软件（或网站），你知道这个群体的人总是喜欢尝试新事物，总是喜欢酷炫的特效，总是喜欢把它们的软件更新到最新版本（而不像我们老一辈的用户）。面对这种情况，渐进增强的开发流程实为上选。\n\n<strong><span style=\"color: red;\">软件开发中，从来就没有银弹。</span>具体的抉择，请读者视情况而定。</strong>\n\n<hr />\n\n## 参考文献\n<ol>\n<li><a href=\"https://www.2cto.com/kf/201708/667067.html\">渐进增强和优雅降级之间有什么不同?</a></li>\n<li><a href=\"https://www.cnblogs.com/web-wjg/p/7240985.html\">前端开发之优雅降级与渐进增强</a></li>\n<li><a href=\"https://wikipedia.tw.wjbk.site/wiki/渐进增强\">渐进增强---Wikipedia</a></li>\n<li><a href=\"https://wikipedia.tw.wjbk.site/wiki/优雅降级\">优雅降级---Wikipedia</a></li>\n</ol>","slug":"关于渐进增强与优雅降级","published":1,"updated":"2020-01-14T20:30:47.765Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn6500122lwjg5oia3r1","content":"<blockquote>\n<p><span class=\"introduction\">相信谎言的人必将在真理之前毁灭。</span><br><br><strong>渐进增强</strong> 与 <strong>优雅降级</strong> 是网页设计的一种策略，强调可访问性，语义 HTML 标记，外部样式表和脚本技术，这两个观点是在 CSS3 出现之后才火起来的。<br>由于低级浏览器，比如 <em><s>(特别是)</s></em> IE6 等，不支持 CSS3 的浏览器，但是 CSS3 的样式又特别优秀不忍放弃，所以在高级浏览器中应用 CSS3 样式，在低级浏览器只保证基本功能。</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"背景介绍\"><a href=\"#背景介绍\" class=\"headerlink\" title=\"背景介绍\"></a>背景介绍</h2><p><strong>渐进增强</strong> 是被 <i>Steven Champeon</i> 创造于 2003年3月11日 在奥斯汀的 <i>SXSW</i> 互动大会，并于 2003年3月和6月 间通过一系列 <i>Webmonkey</i> 教程文章的公布。谷歌公司是很支持这种开发方式，我认为渐进增强不仅是一个 <strong>前端开发思想</strong>，更加是一个 <strong>程序开发思想</strong>。</p>\n<h2 id=\"Progressive-Enhancement\"><a href=\"#Progressive-Enhancement\" class=\"headerlink\" title=\"Progressive Enhancement\"></a>Progressive Enhancement</h2><p>在网页开发中，渐进增强认为 <span class=\"red-target\">应该专注于内容本身</span>。一开始针对低版本的浏览器构建页面，满足最基本的功能，再针对高级浏览器进行 <strong>效果交互</strong> 与 <strong>追加各种功能</strong> 以达到更好用户体验。<br>换句话说，就是以最低要求，实现最基础功能为基本，向上兼容。<br>以 CSS 为例，以下这种写法就是渐进增强：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-moz-border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<div class=\"note info\">\n渐进增强也就是：一开始就针对低版本浏览器进行构建页面，完成基本的功能，然后再针对高级浏览器进行效果、交互、追加功能达到更好的体验。\n</div>\n\n<h3 id=\"渐进增强的核心原则\"><a href=\"#渐进增强的核心原则\" class=\"headerlink\" title=\"渐进增强的核心原则\"></a>渐进增强的核心原则</h3><ul>\n<li>基本内容应该是被所有网络浏览器访问</li>\n<li>基本功能应该是被所有网络浏览器访问</li>\n<li>稀疏的，语义化的标记包含的所有内容</li>\n<li>增强的布局是由外部链接的CSS提供</li>\n<li>增强的行为是由外部链接的非侵入式JavaScript提供</li>\n<li>最终用户的网络浏览器偏好被受到尊重</li>\n</ul>\n<hr>\n\n<h2 id=\"Graceful-Degradation\"><a href=\"#Graceful-Degradation\" class=\"headerlink\" title=\"Graceful Degradation\"></a>Graceful Degradation</h2><p>在网页开发中，优雅降级指的是一开始针对一个高版本的浏览器构建页面，先完善所有的功能。然后针对各个不同的浏览器进行测试、修复，保证低级浏览器也有基本功能 就好，低级浏览器被认为“简陋却无妨 (poor, but passable)”， 可以做一些小的调整来适应某个特定的浏览器。<br>但由于它们并非我们所关注的焦点，因此除了修复较 大的错误之外，其它的差异将被直接忽略。<strong>也就是以高要求，高版本为基准，向下兼容。</strong> <br>同样以css为例，优雅降级的写法如下。</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-moz-border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<div class=\"note info\">\n优雅降级也就是：一开始就构建站点的完整功能，然后针对浏览器测试和修复。比如一开始使用 CSS3 的特性构建了一个应用，然后逐步针对各大浏览器进行 hack 使其可以在低版本浏览器上正常浏览。\n</div>\n\n<hr>\n\n<h2 id=\"渐进增强与优雅降级的区别\"><a href=\"#渐进增强与优雅降级的区别\" class=\"headerlink\" title=\"渐进增强与优雅降级的区别\"></a>渐进增强与优雅降级的区别</h2><p><strong>优雅降级和渐进增强只是看待同种事物的两种观点。</strong> <br>优雅降级和渐进增强都关注于同一网站在不同设备里不同浏览器下的表现程度。<br><br>关键的区别则在于它们各自关注于何处，以及这种关注如何影响工作的流程。</p>\n<div class=\"note info\">\n<span class=\"blue-target\">优雅降级</span> 观点认为应该针对那些 <strong>最高级、最完善的浏览器</strong> 来设计网站。而将那些被认为“过时”或有功能缺失的浏览器下的测试工作安排在开发周期的最后阶段，并把测试对象限定为主流浏览器（如 IE、Mozilla 等）的前一个版本。\n<br>在这种设计范例下，旧版的浏览器被认为仅能提供 <strong>“简陋却无妨 (poor, but passable)”</strong> 的浏览体验。\n<br>你可以做一些小的调整来适应某个特定的浏览器。但由于它们并非我们所关注的焦点，因此除了修复较大的错误之外，其它的差异将被直接忽略。\n</div>\n<br>\n<div class=\"note info\">\n<strong>渐进增强</strong> 观点则认为应关注于内容本身。\n<br>请注意其中的差别：连 <strong>“浏览器”</strong> 三个字都没提。\n<br>内容是我们建立网站的诱因：有的网站展示它，有的则收集它，有的寻求，有的操作，还有的网站甚至会包含以上的种种，但相同点是它们全都涉及到内容。这使得渐进增强成为一种更为合理的设计范例。这也是它立即被 Yahoo! 所采纳并用以构建其 <strong>“分级式浏览器支持 (Graded Browser Support)”</strong> 策略的原因所在。\n</div>\n\n<ul>\n<li><p>如果你采用渐进增强的开发流程，先做一个基本功能版，然后针对各个浏览器进行渐进增加，增加各种功能。相对于优雅降级来说，开发周期长，初期投入资金大。 你想一下不可能拿个基本功能版给客户看呀，多寒酸，搞不好一气之下就不找你做了，然后就炸了。但是呢，也有好处，就是提供了较好的平台稳定性，维护起来资金小， 长期来说降低开发成本。</p>\n</li>\n<li><p>那采用优雅降级呢，这样可以在较短时间内开发出一个只用于一个浏览器的完整功能版，然后就可以拿给 PM 找客户谈呀，可以拿去测试，市场试水呀，对于功能尚未确定的 产品，优雅降级不失为一种节约成本的方法。</p>\n</li>\n</ul>\n<hr>\n\n<h2 id=\"案例分析\"><a href=\"#案例分析\" class=\"headerlink\" title=\"案例分析\"></a>案例分析</h2><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*渐进增强写法*/</span></span><br><span class=\"line\"><span class=\"selector-class\">.transition</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-moz-transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-o-transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">/*优雅降级写法*/</span></span><br><span class=\"line\"><span class=\"selector-class\">.transition</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-o-transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-moz-transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>前缀CSS3（-webkit- / -moz- / -o-*）和正常 CSS3 在浏览器中的支持情况是这样的：</p>\n<ol>\n<li><strong>很久以前：</strong>浏览器 前缀CSS3 和 正常CSS3 <strong>都不支持</strong>；</li>\n<li><strong>不久之前：</strong>浏览器 <strong>只支持</strong> 前缀CSS3，<strong>不支持</strong> 正常CSS3；</li>\n<li><strong>现在：</strong>浏览器 <strong>既支持</strong> 前缀CSS3，<strong>又支持</strong> 正常CSS3；</li>\n<li><strong>未来：</strong>浏览器 <strong>不支持</strong> 前缀CSS3，<strong>仅支持</strong> 正常CSS3.</li>\n</ol>\n\n<ul>\n<li><strong>渐进增强</strong> 的写法，优先考虑老版本浏览器的可用性，最后才考虑新版本的可用性。在时期3前缀CSS3和正常CSS3都可用的情况下，正常CSS3会覆盖前缀CSS3。</li>\n<li><strong>优雅降级</strong> 的写法，优先考虑新版本浏览器的可用性，最后才考虑老版本的可用性。在时期3前缀CSS3和正常CSS3都可用的情况下，前缀CSS3会覆盖正常的CSS3。</li>\n</ul>\n\n<div class=\"note info\">\n就 CSS3 这种例子而言，我更加推崇渐进增强的写法。因为前缀 CSS3 的某些属性在浏览器中的实现效果有可能与正常的 CSS3 实现效果不太一样，所以最终还是得以正常 CSS3 为准。\n<br>如果你好奇究竟是什么属性在前缀 CSS3 和正常 CSS3 中显式效果不一样，可以看看这篇文章 <a href=\"http://www.zhangxinxu.com/wordpress/2010/09/需警惕css3属性的书写顺序/\" target=\"_blank\" rel=\"noopener\">《需警惕CSS3属性的书写顺序》</a>。\n</div>\n\n<hr>\n\n<h2 id=\"如何抉择\"><a href=\"#如何抉择\" class=\"headerlink\" title=\"如何抉择\"></a>如何抉择</h2><p>如果软件开发的预算和时间充足，就不存在抉择的问题。然而现实很残酷，要么开发周期短，要么开发预算少，或者二者兼而有之，这个时候该如何抉择？<br><br>就我个人而言，讲讲我的观点。</p>\n<p><strong>根据你的用户所使用的客户端的版本来做决定。</strong> 请注意我的措辞，我没有用 <em>浏览器</em>，而是用 <em>客户端</em>。因为渐进增强和优雅降级的概念本质上是软件开发过程中低版本软件与高版本软件面对新功能的兼容抉择问题。<br><br>服务端程序很少存在这种问题，因为开发者可以控制服务端运行程序的版本，就无所谓渐进增强和优雅降级的问题。但是客户端程序则不是开发者所能控制的（你总不能强制用户去升级它们的浏览器吧）。我们所谓的客户端，可以指浏览器，移动终端设备（如：手机，平板电脑，智能手表等）以及它们对应的应用程序（浏览器对应的是网站，移动终端设备对应的是相应的APP）。</p>\n<p>现在有很成熟的技术，能够让你分析使用你客户端程序的版本比例。</p>\n<ul>\n<li>如果低版本用户居多，当然优先采用渐进增强的开发流程；</li>\n<li>如果高版本用户居多，为了提高大多数用户的使用体验，那当然优先采用优雅降级的开发流程。</li>\n</ul>\n<p>然而事实情况是怎么样的呢？<strong>绝大多数的大公司都是采用渐进增强的方式</strong>，因为业务优先，提升用户体验永远不会排在最前面。<br><br>例如：新浪微博网站前端的更新，拥有这种亿级用户的网站，绝对不可能追求某个特效而不考虑低版本用户可不可用，一定是确保低版本到高版本的可访问性，再去渐进增强，采用新功能给高版本用户提供更好的用户体验。<br><br>但也不是没有反例。如果你开发的是一款面向青少年的软件（或网站），你知道这个群体的人总是喜欢尝试新事物，总是喜欢酷炫的特效，总是喜欢把它们的软件更新到最新版本（而不像我们老一辈的用户）。面对这种情况，渐进增强的开发流程实为上选。</p>\n<p><strong><span style=\"color: red;\">软件开发中，从来就没有银弹。</span>具体的抉择，请读者视情况而定。</strong></p>\n<hr>\n\n<h2 id=\"参考文献\"><a href=\"#参考文献\" class=\"headerlink\" title=\"参考文献\"></a>参考文献</h2><ol>\n<li><a href=\"https://www.2cto.com/kf/201708/667067.html\" target=\"_blank\" rel=\"noopener\">渐进增强和优雅降级之间有什么不同?</a></li>\n<li><a href=\"https://www.cnblogs.com/web-wjg/p/7240985.html\" target=\"_blank\" rel=\"noopener\">前端开发之优雅降级与渐进增强</a></li>\n<li><a href=\"https://wikipedia.tw.wjbk.site/wiki/渐进增强\" target=\"_blank\" rel=\"noopener\">渐进增强---Wikipedia</a></li>\n<li><a href=\"https://wikipedia.tw.wjbk.site/wiki/优雅降级\" target=\"_blank\" rel=\"noopener\">优雅降级---Wikipedia</a></li>\n</ol>","site":{"data":{}},"length":3440,"excerpt":"<blockquote>\n<p><span class=\"introduction\">相信谎言的人必将在真理之前毁灭。</span><br><br><strong>渐进增强</strong> 与 <strong>优雅降级</strong> 是网页设计的一种策略，强调可访问性，语义 HTML 标记，外部样式表和脚本技术，这两个观点是在 CSS3 出现之后才火起来的。<br>由于低级浏览器，比如 <em><s>(特别是)</s></em> IE6 等，不支持 CSS3 的浏览器，但是 CSS3 的样式又特别优秀不忍放弃，所以在高级浏览器中应用 CSS3 样式，在低级浏览器只保证基本功能。</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"背景介绍\"><a href=\"#背景介绍\" class=\"headerlink\" title=\"背景介绍\"></a>背景介绍</h2><p><strong>渐进增强</strong> 是被 <i>Steven Champeon</i> 创造于 2003年3月11日 在奥斯汀的 <i>SXSW</i> 互动大会，并于 2003年3月和6月 间通过一系列 <i>Webmonkey</i> 教程文章的公布。谷歌公司是很支持这种开发方式，我认为渐进增强不仅是一个 <strong>前端开发思想</strong>，更加是一个 <strong>程序开发思想</strong>。</p>\n<h2 id=\"Progressive-Enhancement\"><a href=\"#Progressive-Enhancement\" class=\"headerlink\" title=\"Progressive Enhancement\"></a>Progressive Enhancement</h2><p>在网页开发中，渐进增强认为 <span class=\"red-target\">应该专注于内容本身</span>。一开始针对低版本的浏览器构建页面，满足最基本的功能，再针对高级浏览器进行 <strong>效果交互</strong> 与 <strong>追加各种功能</strong> 以达到更好用户体验。<br>换句话说，就是以最低要求，实现最基础功能为基本，向上兼容。<br>以 CSS 为例，以下这种写法就是渐进增强：</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-moz-border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<div class=\"note info\">\n渐进增强也就是：一开始就针对低版本浏览器进行构建页面，完成基本的功能，然后再针对高级浏览器进行效果、交互、追加功能达到更好的体验。\n</div>\n\n<h3 id=\"渐进增强的核心原则\"><a href=\"#渐进增强的核心原则\" class=\"headerlink\" title=\"渐进增强的核心原则\"></a>渐进增强的核心原则</h3><ul>\n<li>基本内容应该是被所有网络浏览器访问</li>\n<li>基本功能应该是被所有网络浏览器访问</li>\n<li>稀疏的，语义化的标记包含的所有内容</li>\n<li>增强的布局是由外部链接的CSS提供</li>\n<li>增强的行为是由外部链接的非侵入式JavaScript提供</li>\n<li>最终用户的网络浏览器偏好被受到尊重</li>\n</ul>\n<hr>\n\n<h2 id=\"Graceful-Degradation\"><a href=\"#Graceful-Degradation\" class=\"headerlink\" title=\"Graceful Degradation\"></a>Graceful Degradation</h2><p>在网页开发中，优雅降级指的是一开始针对一个高版本的浏览器构建页面，先完善所有的功能。然后针对各个不同的浏览器进行测试、修复，保证低级浏览器也有基本功能 就好，低级浏览器被认为“简陋却无妨 (poor, but passable)”， 可以做一些小的调整来适应某个特定的浏览器。<br>但由于它们并非我们所关注的焦点，因此除了修复较 大的错误之外，其它的差异将被直接忽略。<strong>也就是以高要求，高版本为基准，向下兼容。</strong> <br>同样以css为例，优雅降级的写法如下。</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.box</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-moz-border-radius</span>: <span class=\"number\">10px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<div class=\"note info\">\n优雅降级也就是：一开始就构建站点的完整功能，然后针对浏览器测试和修复。比如一开始使用 CSS3 的特性构建了一个应用，然后逐步针对各大浏览器进行 hack 使其可以在低版本浏览器上正常浏览。\n</div>\n\n<hr>\n\n<h2 id=\"渐进增强与优雅降级的区别\"><a href=\"#渐进增强与优雅降级的区别\" class=\"headerlink\" title=\"渐进增强与优雅降级的区别\"></a>渐进增强与优雅降级的区别</h2><p><strong>优雅降级和渐进增强只是看待同种事物的两种观点。</strong> <br>优雅降级和渐进增强都关注于同一网站在不同设备里不同浏览器下的表现程度。<br><br>关键的区别则在于它们各自关注于何处，以及这种关注如何影响工作的流程。</p>\n<div class=\"note info\">\n<span class=\"blue-target\">优雅降级</span> 观点认为应该针对那些 <strong>最高级、最完善的浏览器</strong> 来设计网站。而将那些被认为“过时”或有功能缺失的浏览器下的测试工作安排在开发周期的最后阶段，并把测试对象限定为主流浏览器（如 IE、Mozilla 等）的前一个版本。\n<br>在这种设计范例下，旧版的浏览器被认为仅能提供 <strong>“简陋却无妨 (poor, but passable)”</strong> 的浏览体验。\n<br>你可以做一些小的调整来适应某个特定的浏览器。但由于它们并非我们所关注的焦点，因此除了修复较大的错误之外，其它的差异将被直接忽略。\n</div>\n<br>\n<div class=\"note info\">\n<strong>渐进增强</strong> 观点则认为应关注于内容本身。\n<br>请注意其中的差别：连 <strong>“浏览器”</strong> 三个字都没提。\n<br>内容是我们建立网站的诱因：有的网站展示它，有的则收集它，有的寻求，有的操作，还有的网站甚至会包含以上的种种，但相同点是它们全都涉及到内容。这使得渐进增强成为一种更为合理的设计范例。这也是它立即被 Yahoo! 所采纳并用以构建其 <strong>“分级式浏览器支持 (Graded Browser Support)”</strong> 策略的原因所在。\n</div>\n\n<ul>\n<li><p>如果你采用渐进增强的开发流程，先做一个基本功能版，然后针对各个浏览器进行渐进增加，增加各种功能。相对于优雅降级来说，开发周期长，初期投入资金大。 你想一下不可能拿个基本功能版给客户看呀，多寒酸，搞不好一气之下就不找你做了，然后就炸了。但是呢，也有好处，就是提供了较好的平台稳定性，维护起来资金小， 长期来说降低开发成本。</p>\n</li>\n<li><p>那采用优雅降级呢，这样可以在较短时间内开发出一个只用于一个浏览器的完整功能版，然后就可以拿给 PM 找客户谈呀，可以拿去测试，市场试水呀，对于功能尚未确定的 产品，优雅降级不失为一种节约成本的方法。</p>\n</li>\n</ul>\n<hr>\n\n<h2 id=\"案例分析\"><a href=\"#案例分析\" class=\"headerlink\" title=\"案例分析\"></a>案例分析</h2><figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*渐进增强写法*/</span></span><br><span class=\"line\"><span class=\"selector-class\">.transition</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-moz-transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-o-transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">/*优雅降级写法*/</span></span><br><span class=\"line\"><span class=\"selector-class\">.transition</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-o-transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-moz-transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">    <span class=\"attribute\">-webkit-transition</span>: all .<span class=\"number\">5s</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>前缀CSS3（-webkit- / -moz- / -o-*）和正常 CSS3 在浏览器中的支持情况是这样的：</p>\n<ol>\n<li><strong>很久以前：</strong>浏览器 前缀CSS3 和 正常CSS3 <strong>都不支持</strong>；</li>\n<li><strong>不久之前：</strong>浏览器 <strong>只支持</strong> 前缀CSS3，<strong>不支持</strong> 正常CSS3；</li>\n<li><strong>现在：</strong>浏览器 <strong>既支持</strong> 前缀CSS3，<strong>又支持</strong> 正常CSS3；</li>\n<li><strong>未来：</strong>浏览器 <strong>不支持</strong> 前缀CSS3，<strong>仅支持</strong> 正常CSS3.</li>\n</ol>\n\n<ul>\n<li><strong>渐进增强</strong> 的写法，优先考虑老版本浏览器的可用性，最后才考虑新版本的可用性。在时期3前缀CSS3和正常CSS3都可用的情况下，正常CSS3会覆盖前缀CSS3。</li>\n<li><strong>优雅降级</strong> 的写法，优先考虑新版本浏览器的可用性，最后才考虑老版本的可用性。在时期3前缀CSS3和正常CSS3都可用的情况下，前缀CSS3会覆盖正常的CSS3。</li>\n</ul>\n\n<div class=\"note info\">\n就 CSS3 这种例子而言，我更加推崇渐进增强的写法。因为前缀 CSS3 的某些属性在浏览器中的实现效果有可能与正常的 CSS3 实现效果不太一样，所以最终还是得以正常 CSS3 为准。\n<br>如果你好奇究竟是什么属性在前缀 CSS3 和正常 CSS3 中显式效果不一样，可以看看这篇文章 <a href=\"http://www.zhangxinxu.com/wordpress/2010/09/需警惕css3属性的书写顺序/\" target=\"_blank\" rel=\"noopener\">《需警惕CSS3属性的书写顺序》</a>。\n</div>\n\n<hr>\n\n<h2 id=\"如何抉择\"><a href=\"#如何抉择\" class=\"headerlink\" title=\"如何抉择\"></a>如何抉择</h2><p>如果软件开发的预算和时间充足，就不存在抉择的问题。然而现实很残酷，要么开发周期短，要么开发预算少，或者二者兼而有之，这个时候该如何抉择？<br><br>就我个人而言，讲讲我的观点。</p>\n<p><strong>根据你的用户所使用的客户端的版本来做决定。</strong> 请注意我的措辞，我没有用 <em>浏览器</em>，而是用 <em>客户端</em>。因为渐进增强和优雅降级的概念本质上是软件开发过程中低版本软件与高版本软件面对新功能的兼容抉择问题。<br><br>服务端程序很少存在这种问题，因为开发者可以控制服务端运行程序的版本，就无所谓渐进增强和优雅降级的问题。但是客户端程序则不是开发者所能控制的（你总不能强制用户去升级它们的浏览器吧）。我们所谓的客户端，可以指浏览器，移动终端设备（如：手机，平板电脑，智能手表等）以及它们对应的应用程序（浏览器对应的是网站，移动终端设备对应的是相应的APP）。</p>\n<p>现在有很成熟的技术，能够让你分析使用你客户端程序的版本比例。</p>\n<ul>\n<li>如果低版本用户居多，当然优先采用渐进增强的开发流程；</li>\n<li>如果高版本用户居多，为了提高大多数用户的使用体验，那当然优先采用优雅降级的开发流程。</li>\n</ul>\n<p>然而事实情况是怎么样的呢？<strong>绝大多数的大公司都是采用渐进增强的方式</strong>，因为业务优先，提升用户体验永远不会排在最前面。<br><br>例如：新浪微博网站前端的更新，拥有这种亿级用户的网站，绝对不可能追求某个特效而不考虑低版本用户可不可用，一定是确保低版本到高版本的可访问性，再去渐进增强，采用新功能给高版本用户提供更好的用户体验。<br><br>但也不是没有反例。如果你开发的是一款面向青少年的软件（或网站），你知道这个群体的人总是喜欢尝试新事物，总是喜欢酷炫的特效，总是喜欢把它们的软件更新到最新版本（而不像我们老一辈的用户）。面对这种情况，渐进增强的开发流程实为上选。</p>\n<p><strong><span style=\"color: red;\">软件开发中，从来就没有银弹。</span>具体的抉择，请读者视情况而定。</strong></p>\n<hr>\n\n<h2 id=\"参考文献\"><a href=\"#参考文献\" class=\"headerlink\" title=\"参考文献\"></a>参考文献</h2><ol>\n<li><a href=\"https://www.2cto.com/kf/201708/667067.html\" target=\"_blank\" rel=\"noopener\">渐进增强和优雅降级之间有什么不同?</a></li>\n<li><a href=\"https://www.cnblogs.com/web-wjg/p/7240985.html\" target=\"_blank\" rel=\"noopener\">前端开发之优雅降级与渐进增强</a></li>\n<li><a href=\"https://wikipedia.tw.wjbk.site/wiki/渐进增强\" target=\"_blank\" rel=\"noopener\">渐进增强---Wikipedia</a></li>\n<li><a href=\"https://wikipedia.tw.wjbk.site/wiki/优雅降级\" target=\"_blank\" rel=\"noopener\">优雅降级---Wikipedia</a></li>\n</ol>"},{"title":"原生JavaScript实现Ajax","date":"2019-11-18T11:15:53.000Z","copyright":true,"image":"http://www.wqh4u.cn/2019/11/18/原生JavaScript实现Ajax/image.jpg","_content":"\n> <span class = 'introduction'>没有礁石，就没有美丽的浪花；没有挫折，就没有壮丽的人生。</span><br />\nAjax 即“Asynchronous Javascript And XML”（异步 JavaScript 和 XML），是指一种创建交互式网页应用的网页开发技术。<br />通过在后台与服务器进行少量数据交换，Ajax 可以使网页实现异步更新。这意味着可以在不重新加载整个网页的情况下，对网页的某部分进行更新。\n\n<!--more-->\n\n<hr/>\n\n## 什么是 Ajax\n\n<div class=\"note info\">\n<p>\nAJAX 即 “Asynchronous JavaScript and XML”（非同步的 JavaScript 与 XML 技术），指的是一套综合了多项技术的浏览器端网页开发技术。Ajax的概念由杰西·詹姆士·贾瑞特所提出。\n</p>\n<p>\n传统的 Web 应用允许用户端填写表单（form），当送出表单时就向网页伺服器发送一个请求。伺服器接收并处理传来的表单，然后送回一个新的网页，但这个做法浪费了许多带宽，因为在前后两个页面中的大部分 HTML 码往往是相同的。由于每次应用的沟通都需要向伺服器发送请求，应用的回应时间依赖于伺服器的回应时间。这导致了用户界面的回应比本机应用慢得多。\n</p>\n<p>\n与此不同，AJAX应用可以仅向伺服器发送并取回必须的数据，并在客户端采用 JavaScript 处理来自伺服器的回应。因为在伺服器和浏览器之间交换的数据大量减少，伺服器回应更快了。同时，很多的处理工作可以在发出请求的客户端机器上完成，因此 Web 伺服器的负荷也减少了。\n</p>\n<p>\n类似于 DHTML 或 LAMP，AJAX 不是指一种单一的技术，而是有机地利用了一系列相关的技术。虽然其名称包含 XML，但实际上数据格式可以由 JSON 代替，进一步减少数据量，形成所谓的 AJAJ。而客户端与服务器也并不需要异步。一些基于 AJAX 的 “派生／合成” 式（derivative/composite）的技术也正在出现，如 AFLAX。\n</p>\n</div>\n\n### Ajax 的运行原理\n页面发起请求，会将请求发送给游览器的内核中的Ajax引擎中，Ajax引擎会提交请求到服务器端。\n\n在这段时间里，客服端可以任意进行操作，直到服务器将数据返回Ajax之后，会触发你设置事件。\n\n从而执行自定义的js逻辑代码完成某种页面的功能，实现页面的局部刷新。\n\n<hr />\n\n## Ajax 的优缺点\n\n<div class=\"note info\">\n<p>\n使用 Ajax 的最大优点，<code>就是能在不更新整个页面的前提下维护数据</code>。这使得 Web 应用程序更为迅捷地回应用户动作，并避免了在网络上发送那些没有改变的信息。\n</p>\n<p>\nAjax 不需要任何浏览器插件，但需要用户允许 JavaScript 在浏览器上执行。就像 DHTML 应用程序那样，Ajax 应用程序必须在众多不同的浏览器和平台上经过严格的测试。\n</p>\n<p>\n随着 Ajax 的成熟，一些简化 Ajax 使用方法的程序库也相继问世。同样，也出现了另一种辅助程序设计的技术，为那些不支持 JavaScript 的用户提供替代功能。\n</p>\n</div>\n\n<div class=\"note danger\">\n<p>\n对应用Ajax最主要的批评就是，它可能破坏浏览器的后退与加入收藏书签功能。\n</p>\n<p>\n在动态更新页面的情况下，用户无法回到前一个页面状态，这是因为浏览器仅能记下历史记录中的静态页面。一个被完整读入的页面与一个已经被动态修改过的页面之间的可能差别非常微妙；\n</p>\n<p>用户通常都希望单击后退按钮，就能够取消他们的前一次操作，但是在Ajax应用程序中，却无法这样做。不过开发者已想出了种种办法来解决这个问题，HTML5 之前的方法大多是在用户单击后退按钮访问历史记录时，通过建立或使用一个隐藏的IFRAME来重现页面上的变更。（例如，当用户在 Google Maps 中单击后退时，它在一个隐藏的 IFRAME 中进行搜索，然后将搜索结果反映到 Ajax 元素上，以便将应用程序状态恢复到当时的状态）。\n</p>\n</div>\n\n### Ajax 的兼容性\n\nJavaScript 编程的最大问题来自不同的浏览器对各种技术和标准的支持。\n\n`XmlHttpRequest` 对象在不同浏览器中不同的创建方法，以下是跨浏览器的通用方法：\n\n```javascript\n// Provide the XMLHttpRequest class for IE 5.x-6.x:\n// Other browsers (including IE 7.x-8.x) ignore this\n//   when XMLHttpRequest is predefined\nvar xmlHttp;\nif (typeof XMLHttpRequest != \"undefined\") {\n    xmlHttp = new XMLHttpRequest();\n} else if (window.ActiveXObject) {\n    var aVersions = [\"Msxml2.XMLHttp.5.0\", \"Msxml2.XMLHttp.4.0\", \"Msxml2.XMLHttp.3.0\", \"Msxml2.XMLHttp\", \"Microsoft.XMLHttp\"];\n    for (var i = 0; i < aVersions.length; i++) {\n        try {\n            xmlHttp = new ActiveXObject(aVersions[i]);\n            break;\n        } catch (e) {}\n    }\n}\n```\n\n<div class=\"note info\">此内容来自 <a href=\"https://zh.wikipedia.org/zh/AJAX\">维基百科-Ajax</a>。</div>\n\n<hr />\n\n## 实现 Ajax\n\n主要思路有以下五点：\n<ol>\n<li>创建一个 Ajax 对象，使用 <code>XMLHttpRequest</code>；</li>\n<li>绑定监听函数 <code>onreadystatechange</code>；</li>\n<li>绑定处理请求的地址，对 <code>async</code> 参数的选项：<code>true</code> 为异步，<code>false</code> 为同步；</li>\n<li>POST 提交设置的协议头（GET方式省略）</li>\n<li>发送请求</li>\n</ol>\n\n上代码：\n\n```javascript\nlet ajax = request => {\n    // 创建 Ajax 对象\n    let xmlHttp = new XMLHttpRequest();\n    \n    // 绑定处理请求的地址，启动一个请求\n    // 请求方式，目标地址，是否异步\n    xmlHttp.open(request.type, request.url, request.async || true);\n\n    // 若请求为 POST 方法，则设置请求协议头\n    xmlHttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n\n    if (!(request.data instanceof Object)) {\n        request.error('error');\n        return;\n    }\n\n    // 绑定监听函数\n    // 每当 readyState 改变时，就会触发 onreadystatechange 事件\n    // readyState 总是在 0~4 之间变化\n    // 0：请求未初始化，未调用open()方法\n    // 1：服务器链接已经建立，已调用open()方法\n    // 2：请求已接收，已调用send()方法，尚未收到响应\n    // 3：请求处理中，已接收到部分响应数据\n    // 4：请求已完成，已经接收到全部响应数据，且已经可以在客户端使用了\n    xmlHttp.onreadystatechange = () => {\n        // 判断数据是否正常返回\n        if (xmlHttp.readyState === 4 && xmlHttp.status === 200) {\n            // 回调函数\n            // 返回一个 JSON 字符串，格式化为对象后传入 success callback\n            request.success(JSON.parse(xmlHttp.responseText));\n        }\n    };\n\n    let data = [];\n    for (let key in request.data) {\n        data[data.length] = `${key}=${request.data[key]}`\n    }\n\n    // POST 将会提交参数，GET 则不用\n    // 若不需要发送任何数据则填写 null\n    // 发送数据格式为：'key1=value1&key2=value2'\n    xmlHttp.send(data.join('$'));\n};\n```\n\n就可以像使用 `jQuery` 那样去调用这个函数：\n\n```javascript\najax({\n    url: 'http://xxx.xxxxxx.xxx',\n    type: 'post',\n    data: {\n        xxx: 'xxx'\n    },\n    success(res) {\n        console.log(res);\n    },\n    error(e) {\n        console.error(e);\n    }\n});\n```\n\n### 类 Axios 调用\n\nAxios 是一个易用、简洁且高效的 http 库，<a href=\"http://www.axios-js.com/\">这是蓝链</a>。使用 Axios 时可以以一种 “舒服” 的方式去使用 callback，那么我们需要使用 Promise 去实现一个类 Axios 的调用。\n\n这是 Axios 的原版调用：\n\n```javascript\n// Make a request for a user with a given ID\naxios.get('/user?ID=12345')\n    .then(function (response) {\n        // handle success\n        console.log(response);\n    })\n    .catch(function (error) {\n        // handle error\n        console.log(error);\n    })\n    .then(function () {\n        // always executed\n    });\n  \n// Optionally the request above could also be done as\naxios.get('/user', {\n    params: {\n        ID: 12345\n    }\n  })\n  .then(function (response) {\n      console.log(response);\n  })\n  .catch(function (error) {\n      console.log(error);\n  })\n  .then(function () {\n      // always executed\n  });  \n\n// Want to use async/await? Add the `async` keyword to your outer function/method.\nasync function getUser() {\n    try {\n        const response = await axios.get('/user?ID=12345');\n        console.log(response);\n    } catch (error) {\n        console.error(error);\n    }\n}\n```\n\n那么我们可以这样去模仿：\n\n```javascript\nlet axios = {\n    post: (url, data) => {\n        return new Promise((resolve, reject) => {\n            // 康康 data 格式对不对\n            if (!(data instanceof Object)) {\n                reject('error');\n            }\n\n            // Ajax 对象\n            let xmlHttpRequest = new XMLHttpRequest();\n            \n            // 启动一个 post 异步请求\n            xmlHttpRequest.open('post', url, true);\n            \n            // 为 post 设置请求协议头\n            xmlHttpRequest.setRequestHeader('Content-type', 'application/x-www-urlencoded');\n\n            // 消息相应函数\n            xmlHttpRequest.onreadystatechange = () => {\n                if (xmlHttpRequest.readyState === 4 && xmlHttpRequest.status === 200) {\n                    resolve(JSON.parse(xmlHttpRequest.responseText))\n                }\n            };\n\n            // 格式化请求数据格式\n            let requestData = [];\n            for (let key in data) {\n                requestData[requestData.length] = `${key}=${data[key]}`\n            }\n\n            // 发送请求\n            xmlHttpRequest.send(requestData.join('&'));\n        });\n    }\n};\n```\n\n愉快调用：\n\n```javascript\naxios.post('http://xxx.xxxxx.xxx',\n    {\n        xxx: 'xxx'\n    })\n    .then(resolve => {\n        console.log(resolve);\n    })\n    .catch(reject => {\n        console.error(reject);\n    })\n    .finally(() => {\n        // Always\n    });\n```\n\n<del>当然还是直接用轮子的好~</del>\n","source":"_posts/原生JavaScript实现Ajax.md","raw":"---\ntitle: 原生JavaScript实现Ajax\ndate: 2019-11-18 19:15:53\ntags:\n- Web\n- 浏览器\ncategories:\n- 前端\n- 面经\ncopyright: true\nimage: \"http://www.wqh4u.cn/2019/11/18/原生JavaScript实现Ajax/image.jpg\"\n---\n\n> <span class = 'introduction'>没有礁石，就没有美丽的浪花；没有挫折，就没有壮丽的人生。</span><br />\nAjax 即“Asynchronous Javascript And XML”（异步 JavaScript 和 XML），是指一种创建交互式网页应用的网页开发技术。<br />通过在后台与服务器进行少量数据交换，Ajax 可以使网页实现异步更新。这意味着可以在不重新加载整个网页的情况下，对网页的某部分进行更新。\n\n<!--more-->\n\n<hr/>\n\n## 什么是 Ajax\n\n<div class=\"note info\">\n<p>\nAJAX 即 “Asynchronous JavaScript and XML”（非同步的 JavaScript 与 XML 技术），指的是一套综合了多项技术的浏览器端网页开发技术。Ajax的概念由杰西·詹姆士·贾瑞特所提出。\n</p>\n<p>\n传统的 Web 应用允许用户端填写表单（form），当送出表单时就向网页伺服器发送一个请求。伺服器接收并处理传来的表单，然后送回一个新的网页，但这个做法浪费了许多带宽，因为在前后两个页面中的大部分 HTML 码往往是相同的。由于每次应用的沟通都需要向伺服器发送请求，应用的回应时间依赖于伺服器的回应时间。这导致了用户界面的回应比本机应用慢得多。\n</p>\n<p>\n与此不同，AJAX应用可以仅向伺服器发送并取回必须的数据，并在客户端采用 JavaScript 处理来自伺服器的回应。因为在伺服器和浏览器之间交换的数据大量减少，伺服器回应更快了。同时，很多的处理工作可以在发出请求的客户端机器上完成，因此 Web 伺服器的负荷也减少了。\n</p>\n<p>\n类似于 DHTML 或 LAMP，AJAX 不是指一种单一的技术，而是有机地利用了一系列相关的技术。虽然其名称包含 XML，但实际上数据格式可以由 JSON 代替，进一步减少数据量，形成所谓的 AJAJ。而客户端与服务器也并不需要异步。一些基于 AJAX 的 “派生／合成” 式（derivative/composite）的技术也正在出现，如 AFLAX。\n</p>\n</div>\n\n### Ajax 的运行原理\n页面发起请求，会将请求发送给游览器的内核中的Ajax引擎中，Ajax引擎会提交请求到服务器端。\n\n在这段时间里，客服端可以任意进行操作，直到服务器将数据返回Ajax之后，会触发你设置事件。\n\n从而执行自定义的js逻辑代码完成某种页面的功能，实现页面的局部刷新。\n\n<hr />\n\n## Ajax 的优缺点\n\n<div class=\"note info\">\n<p>\n使用 Ajax 的最大优点，<code>就是能在不更新整个页面的前提下维护数据</code>。这使得 Web 应用程序更为迅捷地回应用户动作，并避免了在网络上发送那些没有改变的信息。\n</p>\n<p>\nAjax 不需要任何浏览器插件，但需要用户允许 JavaScript 在浏览器上执行。就像 DHTML 应用程序那样，Ajax 应用程序必须在众多不同的浏览器和平台上经过严格的测试。\n</p>\n<p>\n随着 Ajax 的成熟，一些简化 Ajax 使用方法的程序库也相继问世。同样，也出现了另一种辅助程序设计的技术，为那些不支持 JavaScript 的用户提供替代功能。\n</p>\n</div>\n\n<div class=\"note danger\">\n<p>\n对应用Ajax最主要的批评就是，它可能破坏浏览器的后退与加入收藏书签功能。\n</p>\n<p>\n在动态更新页面的情况下，用户无法回到前一个页面状态，这是因为浏览器仅能记下历史记录中的静态页面。一个被完整读入的页面与一个已经被动态修改过的页面之间的可能差别非常微妙；\n</p>\n<p>用户通常都希望单击后退按钮，就能够取消他们的前一次操作，但是在Ajax应用程序中，却无法这样做。不过开发者已想出了种种办法来解决这个问题，HTML5 之前的方法大多是在用户单击后退按钮访问历史记录时，通过建立或使用一个隐藏的IFRAME来重现页面上的变更。（例如，当用户在 Google Maps 中单击后退时，它在一个隐藏的 IFRAME 中进行搜索，然后将搜索结果反映到 Ajax 元素上，以便将应用程序状态恢复到当时的状态）。\n</p>\n</div>\n\n### Ajax 的兼容性\n\nJavaScript 编程的最大问题来自不同的浏览器对各种技术和标准的支持。\n\n`XmlHttpRequest` 对象在不同浏览器中不同的创建方法，以下是跨浏览器的通用方法：\n\n```javascript\n// Provide the XMLHttpRequest class for IE 5.x-6.x:\n// Other browsers (including IE 7.x-8.x) ignore this\n//   when XMLHttpRequest is predefined\nvar xmlHttp;\nif (typeof XMLHttpRequest != \"undefined\") {\n    xmlHttp = new XMLHttpRequest();\n} else if (window.ActiveXObject) {\n    var aVersions = [\"Msxml2.XMLHttp.5.0\", \"Msxml2.XMLHttp.4.0\", \"Msxml2.XMLHttp.3.0\", \"Msxml2.XMLHttp\", \"Microsoft.XMLHttp\"];\n    for (var i = 0; i < aVersions.length; i++) {\n        try {\n            xmlHttp = new ActiveXObject(aVersions[i]);\n            break;\n        } catch (e) {}\n    }\n}\n```\n\n<div class=\"note info\">此内容来自 <a href=\"https://zh.wikipedia.org/zh/AJAX\">维基百科-Ajax</a>。</div>\n\n<hr />\n\n## 实现 Ajax\n\n主要思路有以下五点：\n<ol>\n<li>创建一个 Ajax 对象，使用 <code>XMLHttpRequest</code>；</li>\n<li>绑定监听函数 <code>onreadystatechange</code>；</li>\n<li>绑定处理请求的地址，对 <code>async</code> 参数的选项：<code>true</code> 为异步，<code>false</code> 为同步；</li>\n<li>POST 提交设置的协议头（GET方式省略）</li>\n<li>发送请求</li>\n</ol>\n\n上代码：\n\n```javascript\nlet ajax = request => {\n    // 创建 Ajax 对象\n    let xmlHttp = new XMLHttpRequest();\n    \n    // 绑定处理请求的地址，启动一个请求\n    // 请求方式，目标地址，是否异步\n    xmlHttp.open(request.type, request.url, request.async || true);\n\n    // 若请求为 POST 方法，则设置请求协议头\n    xmlHttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n\n    if (!(request.data instanceof Object)) {\n        request.error('error');\n        return;\n    }\n\n    // 绑定监听函数\n    // 每当 readyState 改变时，就会触发 onreadystatechange 事件\n    // readyState 总是在 0~4 之间变化\n    // 0：请求未初始化，未调用open()方法\n    // 1：服务器链接已经建立，已调用open()方法\n    // 2：请求已接收，已调用send()方法，尚未收到响应\n    // 3：请求处理中，已接收到部分响应数据\n    // 4：请求已完成，已经接收到全部响应数据，且已经可以在客户端使用了\n    xmlHttp.onreadystatechange = () => {\n        // 判断数据是否正常返回\n        if (xmlHttp.readyState === 4 && xmlHttp.status === 200) {\n            // 回调函数\n            // 返回一个 JSON 字符串，格式化为对象后传入 success callback\n            request.success(JSON.parse(xmlHttp.responseText));\n        }\n    };\n\n    let data = [];\n    for (let key in request.data) {\n        data[data.length] = `${key}=${request.data[key]}`\n    }\n\n    // POST 将会提交参数，GET 则不用\n    // 若不需要发送任何数据则填写 null\n    // 发送数据格式为：'key1=value1&key2=value2'\n    xmlHttp.send(data.join('$'));\n};\n```\n\n就可以像使用 `jQuery` 那样去调用这个函数：\n\n```javascript\najax({\n    url: 'http://xxx.xxxxxx.xxx',\n    type: 'post',\n    data: {\n        xxx: 'xxx'\n    },\n    success(res) {\n        console.log(res);\n    },\n    error(e) {\n        console.error(e);\n    }\n});\n```\n\n### 类 Axios 调用\n\nAxios 是一个易用、简洁且高效的 http 库，<a href=\"http://www.axios-js.com/\">这是蓝链</a>。使用 Axios 时可以以一种 “舒服” 的方式去使用 callback，那么我们需要使用 Promise 去实现一个类 Axios 的调用。\n\n这是 Axios 的原版调用：\n\n```javascript\n// Make a request for a user with a given ID\naxios.get('/user?ID=12345')\n    .then(function (response) {\n        // handle success\n        console.log(response);\n    })\n    .catch(function (error) {\n        // handle error\n        console.log(error);\n    })\n    .then(function () {\n        // always executed\n    });\n  \n// Optionally the request above could also be done as\naxios.get('/user', {\n    params: {\n        ID: 12345\n    }\n  })\n  .then(function (response) {\n      console.log(response);\n  })\n  .catch(function (error) {\n      console.log(error);\n  })\n  .then(function () {\n      // always executed\n  });  \n\n// Want to use async/await? Add the `async` keyword to your outer function/method.\nasync function getUser() {\n    try {\n        const response = await axios.get('/user?ID=12345');\n        console.log(response);\n    } catch (error) {\n        console.error(error);\n    }\n}\n```\n\n那么我们可以这样去模仿：\n\n```javascript\nlet axios = {\n    post: (url, data) => {\n        return new Promise((resolve, reject) => {\n            // 康康 data 格式对不对\n            if (!(data instanceof Object)) {\n                reject('error');\n            }\n\n            // Ajax 对象\n            let xmlHttpRequest = new XMLHttpRequest();\n            \n            // 启动一个 post 异步请求\n            xmlHttpRequest.open('post', url, true);\n            \n            // 为 post 设置请求协议头\n            xmlHttpRequest.setRequestHeader('Content-type', 'application/x-www-urlencoded');\n\n            // 消息相应函数\n            xmlHttpRequest.onreadystatechange = () => {\n                if (xmlHttpRequest.readyState === 4 && xmlHttpRequest.status === 200) {\n                    resolve(JSON.parse(xmlHttpRequest.responseText))\n                }\n            };\n\n            // 格式化请求数据格式\n            let requestData = [];\n            for (let key in data) {\n                requestData[requestData.length] = `${key}=${data[key]}`\n            }\n\n            // 发送请求\n            xmlHttpRequest.send(requestData.join('&'));\n        });\n    }\n};\n```\n\n愉快调用：\n\n```javascript\naxios.post('http://xxx.xxxxx.xxx',\n    {\n        xxx: 'xxx'\n    })\n    .then(resolve => {\n        console.log(resolve);\n    })\n    .catch(reject => {\n        console.error(reject);\n    })\n    .finally(() => {\n        // Always\n    });\n```\n\n<del>当然还是直接用轮子的好~</del>\n","slug":"原生JavaScript实现Ajax","published":1,"updated":"2020-01-14T20:30:47.877Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn6600152lwj4bqfdksm","content":"<blockquote>\n<p><span class=\"introduction\">没有礁石，就没有美丽的浪花；没有挫折，就没有壮丽的人生。</span><br><br>Ajax 即“Asynchronous Javascript And XML”（异步 JavaScript 和 XML），是指一种创建交互式网页应用的网页开发技术。<br>通过在后台与服务器进行少量数据交换，Ajax 可以使网页实现异步更新。这意味着可以在不重新加载整个网页的情况下，对网页的某部分进行更新。</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"什么是-Ajax\"><a href=\"#什么是-Ajax\" class=\"headerlink\" title=\"什么是 Ajax\"></a>什么是 Ajax</h2><div class=\"note info\">\n<p>\nAJAX 即 “Asynchronous JavaScript and XML”（非同步的 JavaScript 与 XML 技术），指的是一套综合了多项技术的浏览器端网页开发技术。Ajax的概念由杰西·詹姆士·贾瑞特所提出。\n</p>\n<p>\n传统的 Web 应用允许用户端填写表单（form），当送出表单时就向网页伺服器发送一个请求。伺服器接收并处理传来的表单，然后送回一个新的网页，但这个做法浪费了许多带宽，因为在前后两个页面中的大部分 HTML 码往往是相同的。由于每次应用的沟通都需要向伺服器发送请求，应用的回应时间依赖于伺服器的回应时间。这导致了用户界面的回应比本机应用慢得多。\n</p>\n<p>\n与此不同，AJAX应用可以仅向伺服器发送并取回必须的数据，并在客户端采用 JavaScript 处理来自伺服器的回应。因为在伺服器和浏览器之间交换的数据大量减少，伺服器回应更快了。同时，很多的处理工作可以在发出请求的客户端机器上完成，因此 Web 伺服器的负荷也减少了。\n</p>\n<p>\n类似于 DHTML 或 LAMP，AJAX 不是指一种单一的技术，而是有机地利用了一系列相关的技术。虽然其名称包含 XML，但实际上数据格式可以由 JSON 代替，进一步减少数据量，形成所谓的 AJAJ。而客户端与服务器也并不需要异步。一些基于 AJAX 的 “派生／合成” 式（derivative/composite）的技术也正在出现，如 AFLAX。\n</p>\n</div>\n\n<h3 id=\"Ajax-的运行原理\"><a href=\"#Ajax-的运行原理\" class=\"headerlink\" title=\"Ajax 的运行原理\"></a>Ajax 的运行原理</h3><p>页面发起请求，会将请求发送给游览器的内核中的Ajax引擎中，Ajax引擎会提交请求到服务器端。</p>\n<p>在这段时间里，客服端可以任意进行操作，直到服务器将数据返回Ajax之后，会触发你设置事件。</p>\n<p>从而执行自定义的js逻辑代码完成某种页面的功能，实现页面的局部刷新。</p>\n<hr>\n\n<h2 id=\"Ajax-的优缺点\"><a href=\"#Ajax-的优缺点\" class=\"headerlink\" title=\"Ajax 的优缺点\"></a>Ajax 的优缺点</h2><div class=\"note info\">\n<p>\n使用 Ajax 的最大优点，<code>就是能在不更新整个页面的前提下维护数据</code>。这使得 Web 应用程序更为迅捷地回应用户动作，并避免了在网络上发送那些没有改变的信息。\n</p>\n<p>\nAjax 不需要任何浏览器插件，但需要用户允许 JavaScript 在浏览器上执行。就像 DHTML 应用程序那样，Ajax 应用程序必须在众多不同的浏览器和平台上经过严格的测试。\n</p>\n<p>\n随着 Ajax 的成熟，一些简化 Ajax 使用方法的程序库也相继问世。同样，也出现了另一种辅助程序设计的技术，为那些不支持 JavaScript 的用户提供替代功能。\n</p>\n</div>\n\n<div class=\"note danger\">\n<p>\n对应用Ajax最主要的批评就是，它可能破坏浏览器的后退与加入收藏书签功能。\n</p>\n<p>\n在动态更新页面的情况下，用户无法回到前一个页面状态，这是因为浏览器仅能记下历史记录中的静态页面。一个被完整读入的页面与一个已经被动态修改过的页面之间的可能差别非常微妙；\n</p>\n<p>用户通常都希望单击后退按钮，就能够取消他们的前一次操作，但是在Ajax应用程序中，却无法这样做。不过开发者已想出了种种办法来解决这个问题，HTML5 之前的方法大多是在用户单击后退按钮访问历史记录时，通过建立或使用一个隐藏的IFRAME来重现页面上的变更。（例如，当用户在 Google Maps 中单击后退时，它在一个隐藏的 IFRAME 中进行搜索，然后将搜索结果反映到 Ajax 元素上，以便将应用程序状态恢复到当时的状态）。\n</p>\n</div>\n\n<h3 id=\"Ajax-的兼容性\"><a href=\"#Ajax-的兼容性\" class=\"headerlink\" title=\"Ajax 的兼容性\"></a>Ajax 的兼容性</h3><p>JavaScript 编程的最大问题来自不同的浏览器对各种技术和标准的支持。</p>\n<p><code>XmlHttpRequest</code> 对象在不同浏览器中不同的创建方法，以下是跨浏览器的通用方法：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Provide the XMLHttpRequest class for IE 5.x-6.x:</span></span><br><span class=\"line\"><span class=\"comment\">// Other browsers (including IE 7.x-8.x) ignore this</span></span><br><span class=\"line\"><span class=\"comment\">//   when XMLHttpRequest is predefined</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> xmlHttp;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> XMLHttpRequest != <span class=\"string\">\"undefined\"</span>) &#123;</span><br><span class=\"line\">    xmlHttp = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"built_in\">window</span>.ActiveXObject) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> aVersions = [<span class=\"string\">\"Msxml2.XMLHttp.5.0\"</span>, <span class=\"string\">\"Msxml2.XMLHttp.4.0\"</span>, <span class=\"string\">\"Msxml2.XMLHttp.3.0\"</span>, <span class=\"string\">\"Msxml2.XMLHttp\"</span>, <span class=\"string\">\"Microsoft.XMLHttp\"</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; aVersions.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            xmlHttp = <span class=\"keyword\">new</span> ActiveXObject(aVersions[i]);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<div class=\"note info\">此内容来自 <a href=\"https://zh.wikipedia.org/zh/AJAX\" target=\"_blank\" rel=\"noopener\">维基百科-Ajax</a>。</div>\n\n<hr>\n\n<h2 id=\"实现-Ajax\"><a href=\"#实现-Ajax\" class=\"headerlink\" title=\"实现 Ajax\"></a>实现 Ajax</h2><p>主要思路有以下五点：</p>\n<ol>\n<li>创建一个 Ajax 对象，使用 <code>XMLHttpRequest</code>；</li>\n<li>绑定监听函数 <code>onreadystatechange</code>；</li>\n<li>绑定处理请求的地址，对 <code>async</code> 参数的选项：<code>true</code> 为异步，<code>false</code> 为同步；</li>\n<li>POST 提交设置的协议头（GET方式省略）</li>\n<li>发送请求</li>\n</ol>\n\n<p>上代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> ajax = <span class=\"function\"><span class=\"params\">request</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 创建 Ajax 对象</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> xmlHttp = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 绑定处理请求的地址，启动一个请求</span></span><br><span class=\"line\">    <span class=\"comment\">// 请求方式，目标地址，是否异步</span></span><br><span class=\"line\">    xmlHttp.open(request.type, request.url, request.async || <span class=\"literal\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 若请求为 POST 方法，则设置请求协议头</span></span><br><span class=\"line\">    xmlHttp.setRequestHeader(<span class=\"string\">'Content-type'</span>, <span class=\"string\">'application/x-www-form-urlencoded'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!(request.data <span class=\"keyword\">instanceof</span> <span class=\"built_in\">Object</span>)) &#123;</span><br><span class=\"line\">        request.error(<span class=\"string\">'error'</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 绑定监听函数</span></span><br><span class=\"line\">    <span class=\"comment\">// 每当 readyState 改变时，就会触发 onreadystatechange 事件</span></span><br><span class=\"line\">    <span class=\"comment\">// readyState 总是在 0~4 之间变化</span></span><br><span class=\"line\">    <span class=\"comment\">// 0：请求未初始化，未调用open()方法</span></span><br><span class=\"line\">    <span class=\"comment\">// 1：服务器链接已经建立，已调用open()方法</span></span><br><span class=\"line\">    <span class=\"comment\">// 2：请求已接收，已调用send()方法，尚未收到响应</span></span><br><span class=\"line\">    <span class=\"comment\">// 3：请求处理中，已接收到部分响应数据</span></span><br><span class=\"line\">    <span class=\"comment\">// 4：请求已完成，已经接收到全部响应数据，且已经可以在客户端使用了</span></span><br><span class=\"line\">    xmlHttp.onreadystatechange = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 判断数据是否正常返回</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (xmlHttp.readyState === <span class=\"number\">4</span> &amp;&amp; xmlHttp.status === <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 回调函数</span></span><br><span class=\"line\">            <span class=\"comment\">// 返回一个 JSON 字符串，格式化为对象后传入 success callback</span></span><br><span class=\"line\">            request.success(<span class=\"built_in\">JSON</span>.parse(xmlHttp.responseText));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">let</span> data = [];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> key <span class=\"keyword\">in</span> request.data) &#123;</span><br><span class=\"line\">        data[data.length] = <span class=\"string\">`<span class=\"subst\">$&#123;key&#125;</span>=<span class=\"subst\">$&#123;request.data[key]&#125;</span>`</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// POST 将会提交参数，GET 则不用</span></span><br><span class=\"line\">    <span class=\"comment\">// 若不需要发送任何数据则填写 null</span></span><br><span class=\"line\">    <span class=\"comment\">// 发送数据格式为：'key1=value1&amp;key2=value2'</span></span><br><span class=\"line\">    xmlHttp.send(data.join(<span class=\"string\">'$'</span>));</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>就可以像使用 <code>jQuery</code> 那样去调用这个函数：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ajax(&#123;</span><br><span class=\"line\">    url: <span class=\"string\">'http://xxx.xxxxxx.xxx'</span>,</span><br><span class=\"line\">    type: <span class=\"string\">'post'</span>,</span><br><span class=\"line\">    data: &#123;</span><br><span class=\"line\">        xxx: <span class=\"string\">'xxx'</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    success(res) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(res);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    error(e) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.error(e);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"类-Axios-调用\"><a href=\"#类-Axios-调用\" class=\"headerlink\" title=\"类 Axios 调用\"></a>类 Axios 调用</h3><p>Axios 是一个易用、简洁且高效的 http 库，<a href=\"http://www.axios-js.com/\" target=\"_blank\" rel=\"noopener\">这是蓝链</a>。使用 Axios 时可以以一种 “舒服” 的方式去使用 callback，那么我们需要使用 Promise 去实现一个类 Axios 的调用。</p>\n<p>这是 Axios 的原版调用：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Make a request for a user with a given ID</span></span><br><span class=\"line\">axios.get(<span class=\"string\">'/user?ID=12345'</span>)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">response</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle success</span></span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(response);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    .catch(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle error</span></span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(error);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// always executed</span></span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">// Optionally the request above could also be done as</span></span><br><span class=\"line\">axios.get(<span class=\"string\">'/user'</span>, &#123;</span><br><span class=\"line\">    params: &#123;</span><br><span class=\"line\">        ID: <span class=\"number\">12345</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">response</span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"built_in\">console</span>.log(response);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .catch(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error</span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"built_in\">console</span>.log(error);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"comment\">// always executed</span></span><br><span class=\"line\">  &#125;);  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Want to use async/await? Add the `async` keyword to your outer function/method.</span></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getUser</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> response = <span class=\"keyword\">await</span> axios.get(<span class=\"string\">'/user?ID=12345'</span>);</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(response);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.error(error);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>那么我们可以这样去模仿：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> axios = &#123;</span><br><span class=\"line\">    post: <span class=\"function\">(<span class=\"params\">url, data</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 康康 data 格式对不对</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!(data <span class=\"keyword\">instanceof</span> <span class=\"built_in\">Object</span>)) &#123;</span><br><span class=\"line\">                reject(<span class=\"string\">'error'</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// Ajax 对象</span></span><br><span class=\"line\">            <span class=\"keyword\">let</span> xmlHttpRequest = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 启动一个 post 异步请求</span></span><br><span class=\"line\">            xmlHttpRequest.open(<span class=\"string\">'post'</span>, url, <span class=\"literal\">true</span>);</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 为 post 设置请求协议头</span></span><br><span class=\"line\">            xmlHttpRequest.setRequestHeader(<span class=\"string\">'Content-type'</span>, <span class=\"string\">'application/x-www-urlencoded'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 消息相应函数</span></span><br><span class=\"line\">            xmlHttpRequest.onreadystatechange = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (xmlHttpRequest.readyState === <span class=\"number\">4</span> &amp;&amp; xmlHttpRequest.status === <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">                    resolve(<span class=\"built_in\">JSON</span>.parse(xmlHttpRequest.responseText))</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 格式化请求数据格式</span></span><br><span class=\"line\">            <span class=\"keyword\">let</span> requestData = [];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> key <span class=\"keyword\">in</span> data) &#123;</span><br><span class=\"line\">                requestData[requestData.length] = <span class=\"string\">`<span class=\"subst\">$&#123;key&#125;</span>=<span class=\"subst\">$&#123;data[key]&#125;</span>`</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 发送请求</span></span><br><span class=\"line\">            xmlHttpRequest.send(requestData.join(<span class=\"string\">'&amp;'</span>));</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>愉快调用：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">axios.post(<span class=\"string\">'http://xxx.xxxxx.xxx'</span>,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        xxx: <span class=\"string\">'xxx'</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(resolve);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    .catch(<span class=\"function\"><span class=\"params\">reject</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.error(reject);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    .finally(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Always</span></span><br><span class=\"line\">    &#125;);</span><br></pre></td></tr></table></figure>\n\n<p><del>当然还是直接用轮子的好~</del></p>\n","site":{"data":{}},"length":5443,"excerpt":"<blockquote>\n<p><span class=\"introduction\">没有礁石，就没有美丽的浪花；没有挫折，就没有壮丽的人生。</span><br><br>Ajax 即“Asynchronous Javascript And XML”（异步 JavaScript 和 XML），是指一种创建交互式网页应用的网页开发技术。<br>通过在后台与服务器进行少量数据交换，Ajax 可以使网页实现异步更新。这意味着可以在不重新加载整个网页的情况下，对网页的某部分进行更新。</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"什么是-Ajax\"><a href=\"#什么是-Ajax\" class=\"headerlink\" title=\"什么是 Ajax\"></a>什么是 Ajax</h2><div class=\"note info\">\n<p>\nAJAX 即 “Asynchronous JavaScript and XML”（非同步的 JavaScript 与 XML 技术），指的是一套综合了多项技术的浏览器端网页开发技术。Ajax的概念由杰西·詹姆士·贾瑞特所提出。\n</p>\n<p>\n传统的 Web 应用允许用户端填写表单（form），当送出表单时就向网页伺服器发送一个请求。伺服器接收并处理传来的表单，然后送回一个新的网页，但这个做法浪费了许多带宽，因为在前后两个页面中的大部分 HTML 码往往是相同的。由于每次应用的沟通都需要向伺服器发送请求，应用的回应时间依赖于伺服器的回应时间。这导致了用户界面的回应比本机应用慢得多。\n</p>\n<p>\n与此不同，AJAX应用可以仅向伺服器发送并取回必须的数据，并在客户端采用 JavaScript 处理来自伺服器的回应。因为在伺服器和浏览器之间交换的数据大量减少，伺服器回应更快了。同时，很多的处理工作可以在发出请求的客户端机器上完成，因此 Web 伺服器的负荷也减少了。\n</p>\n<p>\n类似于 DHTML 或 LAMP，AJAX 不是指一种单一的技术，而是有机地利用了一系列相关的技术。虽然其名称包含 XML，但实际上数据格式可以由 JSON 代替，进一步减少数据量，形成所谓的 AJAJ。而客户端与服务器也并不需要异步。一些基于 AJAX 的 “派生／合成” 式（derivative/composite）的技术也正在出现，如 AFLAX。\n</p>\n</div>\n\n<h3 id=\"Ajax-的运行原理\"><a href=\"#Ajax-的运行原理\" class=\"headerlink\" title=\"Ajax 的运行原理\"></a>Ajax 的运行原理</h3><p>页面发起请求，会将请求发送给游览器的内核中的Ajax引擎中，Ajax引擎会提交请求到服务器端。</p>\n<p>在这段时间里，客服端可以任意进行操作，直到服务器将数据返回Ajax之后，会触发你设置事件。</p>\n<p>从而执行自定义的js逻辑代码完成某种页面的功能，实现页面的局部刷新。</p>\n<hr>\n\n<h2 id=\"Ajax-的优缺点\"><a href=\"#Ajax-的优缺点\" class=\"headerlink\" title=\"Ajax 的优缺点\"></a>Ajax 的优缺点</h2><div class=\"note info\">\n<p>\n使用 Ajax 的最大优点，<code>就是能在不更新整个页面的前提下维护数据</code>。这使得 Web 应用程序更为迅捷地回应用户动作，并避免了在网络上发送那些没有改变的信息。\n</p>\n<p>\nAjax 不需要任何浏览器插件，但需要用户允许 JavaScript 在浏览器上执行。就像 DHTML 应用程序那样，Ajax 应用程序必须在众多不同的浏览器和平台上经过严格的测试。\n</p>\n<p>\n随着 Ajax 的成熟，一些简化 Ajax 使用方法的程序库也相继问世。同样，也出现了另一种辅助程序设计的技术，为那些不支持 JavaScript 的用户提供替代功能。\n</p>\n</div>\n\n<div class=\"note danger\">\n<p>\n对应用Ajax最主要的批评就是，它可能破坏浏览器的后退与加入收藏书签功能。\n</p>\n<p>\n在动态更新页面的情况下，用户无法回到前一个页面状态，这是因为浏览器仅能记下历史记录中的静态页面。一个被完整读入的页面与一个已经被动态修改过的页面之间的可能差别非常微妙；\n</p>\n<p>用户通常都希望单击后退按钮，就能够取消他们的前一次操作，但是在Ajax应用程序中，却无法这样做。不过开发者已想出了种种办法来解决这个问题，HTML5 之前的方法大多是在用户单击后退按钮访问历史记录时，通过建立或使用一个隐藏的IFRAME来重现页面上的变更。（例如，当用户在 Google Maps 中单击后退时，它在一个隐藏的 IFRAME 中进行搜索，然后将搜索结果反映到 Ajax 元素上，以便将应用程序状态恢复到当时的状态）。\n</p>\n</div>\n\n<h3 id=\"Ajax-的兼容性\"><a href=\"#Ajax-的兼容性\" class=\"headerlink\" title=\"Ajax 的兼容性\"></a>Ajax 的兼容性</h3><p>JavaScript 编程的最大问题来自不同的浏览器对各种技术和标准的支持。</p>\n<p><code>XmlHttpRequest</code> 对象在不同浏览器中不同的创建方法，以下是跨浏览器的通用方法：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Provide the XMLHttpRequest class for IE 5.x-6.x:</span></span><br><span class=\"line\"><span class=\"comment\">// Other browsers (including IE 7.x-8.x) ignore this</span></span><br><span class=\"line\"><span class=\"comment\">//   when XMLHttpRequest is predefined</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> xmlHttp;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> XMLHttpRequest != <span class=\"string\">\"undefined\"</span>) &#123;</span><br><span class=\"line\">    xmlHttp = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"built_in\">window</span>.ActiveXObject) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> aVersions = [<span class=\"string\">\"Msxml2.XMLHttp.5.0\"</span>, <span class=\"string\">\"Msxml2.XMLHttp.4.0\"</span>, <span class=\"string\">\"Msxml2.XMLHttp.3.0\"</span>, <span class=\"string\">\"Msxml2.XMLHttp\"</span>, <span class=\"string\">\"Microsoft.XMLHttp\"</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; aVersions.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            xmlHttp = <span class=\"keyword\">new</span> ActiveXObject(aVersions[i]);</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<div class=\"note info\">此内容来自 <a href=\"https://zh.wikipedia.org/zh/AJAX\" target=\"_blank\" rel=\"noopener\">维基百科-Ajax</a>。</div>\n\n<hr>\n\n<h2 id=\"实现-Ajax\"><a href=\"#实现-Ajax\" class=\"headerlink\" title=\"实现 Ajax\"></a>实现 Ajax</h2><p>主要思路有以下五点：</p>\n<ol>\n<li>创建一个 Ajax 对象，使用 <code>XMLHttpRequest</code>；</li>\n<li>绑定监听函数 <code>onreadystatechange</code>；</li>\n<li>绑定处理请求的地址，对 <code>async</code> 参数的选项：<code>true</code> 为异步，<code>false</code> 为同步；</li>\n<li>POST 提交设置的协议头（GET方式省略）</li>\n<li>发送请求</li>\n</ol>\n\n<p>上代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> ajax = <span class=\"function\"><span class=\"params\">request</span> =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 创建 Ajax 对象</span></span><br><span class=\"line\">    <span class=\"keyword\">let</span> xmlHttp = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// 绑定处理请求的地址，启动一个请求</span></span><br><span class=\"line\">    <span class=\"comment\">// 请求方式，目标地址，是否异步</span></span><br><span class=\"line\">    xmlHttp.open(request.type, request.url, request.async || <span class=\"literal\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 若请求为 POST 方法，则设置请求协议头</span></span><br><span class=\"line\">    xmlHttp.setRequestHeader(<span class=\"string\">'Content-type'</span>, <span class=\"string\">'application/x-www-form-urlencoded'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!(request.data <span class=\"keyword\">instanceof</span> <span class=\"built_in\">Object</span>)) &#123;</span><br><span class=\"line\">        request.error(<span class=\"string\">'error'</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 绑定监听函数</span></span><br><span class=\"line\">    <span class=\"comment\">// 每当 readyState 改变时，就会触发 onreadystatechange 事件</span></span><br><span class=\"line\">    <span class=\"comment\">// readyState 总是在 0~4 之间变化</span></span><br><span class=\"line\">    <span class=\"comment\">// 0：请求未初始化，未调用open()方法</span></span><br><span class=\"line\">    <span class=\"comment\">// 1：服务器链接已经建立，已调用open()方法</span></span><br><span class=\"line\">    <span class=\"comment\">// 2：请求已接收，已调用send()方法，尚未收到响应</span></span><br><span class=\"line\">    <span class=\"comment\">// 3：请求处理中，已接收到部分响应数据</span></span><br><span class=\"line\">    <span class=\"comment\">// 4：请求已完成，已经接收到全部响应数据，且已经可以在客户端使用了</span></span><br><span class=\"line\">    xmlHttp.onreadystatechange = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 判断数据是否正常返回</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (xmlHttp.readyState === <span class=\"number\">4</span> &amp;&amp; xmlHttp.status === <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 回调函数</span></span><br><span class=\"line\">            <span class=\"comment\">// 返回一个 JSON 字符串，格式化为对象后传入 success callback</span></span><br><span class=\"line\">            request.success(<span class=\"built_in\">JSON</span>.parse(xmlHttp.responseText));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">let</span> data = [];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> key <span class=\"keyword\">in</span> request.data) &#123;</span><br><span class=\"line\">        data[data.length] = <span class=\"string\">`<span class=\"subst\">$&#123;key&#125;</span>=<span class=\"subst\">$&#123;request.data[key]&#125;</span>`</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// POST 将会提交参数，GET 则不用</span></span><br><span class=\"line\">    <span class=\"comment\">// 若不需要发送任何数据则填写 null</span></span><br><span class=\"line\">    <span class=\"comment\">// 发送数据格式为：'key1=value1&amp;key2=value2'</span></span><br><span class=\"line\">    xmlHttp.send(data.join(<span class=\"string\">'$'</span>));</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>就可以像使用 <code>jQuery</code> 那样去调用这个函数：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ajax(&#123;</span><br><span class=\"line\">    url: <span class=\"string\">'http://xxx.xxxxxx.xxx'</span>,</span><br><span class=\"line\">    type: <span class=\"string\">'post'</span>,</span><br><span class=\"line\">    data: &#123;</span><br><span class=\"line\">        xxx: <span class=\"string\">'xxx'</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    success(res) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(res);</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    error(e) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.error(e);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"类-Axios-调用\"><a href=\"#类-Axios-调用\" class=\"headerlink\" title=\"类 Axios 调用\"></a>类 Axios 调用</h3><p>Axios 是一个易用、简洁且高效的 http 库，<a href=\"http://www.axios-js.com/\" target=\"_blank\" rel=\"noopener\">这是蓝链</a>。使用 Axios 时可以以一种 “舒服” 的方式去使用 callback，那么我们需要使用 Promise 去实现一个类 Axios 的调用。</p>\n<p>这是 Axios 的原版调用：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// Make a request for a user with a given ID</span></span><br><span class=\"line\">axios.get(<span class=\"string\">'/user?ID=12345'</span>)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">response</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle success</span></span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(response);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    .catch(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error</span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// handle error</span></span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(error);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// always executed</span></span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"comment\">// Optionally the request above could also be done as</span></span><br><span class=\"line\">axios.get(<span class=\"string\">'/user'</span>, &#123;</span><br><span class=\"line\">    params: &#123;</span><br><span class=\"line\">        ID: <span class=\"number\">12345</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">response</span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"built_in\">console</span>.log(response);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .catch(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">error</span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"built_in\">console</span>.log(error);</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">  .then(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">      <span class=\"comment\">// always executed</span></span><br><span class=\"line\">  &#125;);  </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Want to use async/await? Add the `async` keyword to your outer function/method.</span></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getUser</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> response = <span class=\"keyword\">await</span> axios.get(<span class=\"string\">'/user?ID=12345'</span>);</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(response);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (error) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.error(error);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>那么我们可以这样去模仿：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> axios = &#123;</span><br><span class=\"line\">    post: <span class=\"function\">(<span class=\"params\">url, data</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 康康 data 格式对不对</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!(data <span class=\"keyword\">instanceof</span> <span class=\"built_in\">Object</span>)) &#123;</span><br><span class=\"line\">                reject(<span class=\"string\">'error'</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// Ajax 对象</span></span><br><span class=\"line\">            <span class=\"keyword\">let</span> xmlHttpRequest = <span class=\"keyword\">new</span> XMLHttpRequest();</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 启动一个 post 异步请求</span></span><br><span class=\"line\">            xmlHttpRequest.open(<span class=\"string\">'post'</span>, url, <span class=\"literal\">true</span>);</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 为 post 设置请求协议头</span></span><br><span class=\"line\">            xmlHttpRequest.setRequestHeader(<span class=\"string\">'Content-type'</span>, <span class=\"string\">'application/x-www-urlencoded'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 消息相应函数</span></span><br><span class=\"line\">            xmlHttpRequest.onreadystatechange = <span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (xmlHttpRequest.readyState === <span class=\"number\">4</span> &amp;&amp; xmlHttpRequest.status === <span class=\"number\">200</span>) &#123;</span><br><span class=\"line\">                    resolve(<span class=\"built_in\">JSON</span>.parse(xmlHttpRequest.responseText))</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 格式化请求数据格式</span></span><br><span class=\"line\">            <span class=\"keyword\">let</span> requestData = [];</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> key <span class=\"keyword\">in</span> data) &#123;</span><br><span class=\"line\">                requestData[requestData.length] = <span class=\"string\">`<span class=\"subst\">$&#123;key&#125;</span>=<span class=\"subst\">$&#123;data[key]&#125;</span>`</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 发送请求</span></span><br><span class=\"line\">            xmlHttpRequest.send(requestData.join(<span class=\"string\">'&amp;'</span>));</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>愉快调用：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">axios.post(<span class=\"string\">'http://xxx.xxxxx.xxx'</span>,</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        xxx: <span class=\"string\">'xxx'</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    .then(<span class=\"function\"><span class=\"params\">resolve</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.log(resolve);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    .catch(<span class=\"function\"><span class=\"params\">reject</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.error(reject);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    .finally(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Always</span></span><br><span class=\"line\">    &#125;);</span><br></pre></td></tr></table></figure>\n\n<p><del>当然还是直接用轮子的好~</del></p>"},{"title":"原生JavaScript实现Promise","date":"2020-01-21T10:17:36.000Z","copyright":true,"_content":"\n> <span class = 'introduction'>孤单一人的时间使自己变得优秀，给来的人一个惊喜，也给自己一个好的交代。</span><br/>\nPromise 是前端面试中的高频问题，如果能根据 Promise A+ 规范，写出符合规范的源码，那么对于面试中的 Promise 相关的问题，都能够给出比较完美的答案。\n<span class=\"introduction\">长文警告！</span>\n\n<!--more-->\n\n<hr/>\n\n## 前言\n\n此篇博客实操性极强，单纯的阅读是行不通的！\n\n直至博客发布日，Euphoria 已将 Promise 的实现前前后后敲了快二十遍，最快（仅包含 constructor，then，resolvePromise 方法与测试）只需要七分钟，同时通过了 `promises-aplus-tests` 测试 <del>闲得无聊</del>。\n\nEuphoria 建议需要完全理解下面要介绍的 Promise A+ 规范，对照规范多写几次实现。\n\n<hr />\n\n## 为什么会出现 Promise A+ 规范\n\n### 规范出现的原因\n\n在编写 JavaScript 程序时，经常会用到异步，但往往在异步请求数据时，我们并不知道什么时候会返回数据。这对需要处理异步在返回数据之后的逻辑造成了困难，因此我们需要用到 **回调函数**。\n\n然而有时候，我们需要在回调函数中再次嵌套一个异步操作，这个异步操作就又需要一个回调函数...\n\n就这样，形成了 <span class=\"red-target\">回调地狱</span>。\n\n```javascript\n// jQuery\n$http.get('localhost:8080').success((data, status, config, headers) => {\n    setTimeout(() => {\n        $(element).fadeIn(1000, function() {\n            // 回调地狱\n            $(this).fadeOut(1000);\n        });\n    });\n}).error((data, status, config, headers) => {\n    \n});\n```\n\n正是为了杜绝以上两种情况的出现，<a href=\"https://promisesaplus.com/\">Promise/A+</a> 规范诞生了。\n\n<hr />\n\n## 什么是 Promise/A+ 规范\n\n<div class=\"note info\"><b>An open standard for sound, interoperable JavaScript promises—by implementers, for implementers.</b></div>\n\n一个 Promise 表示异步操作的最终结果，与 promise 进行交互主要是通过其 `then` 方法，该方法传入的回调函数以接收 promise 的最终值或 promise 失败的原因。\n\n<a href=\"https://promisesaplus.com/\">Promise/A+</a> 规范详细地介绍了 `then` 方法的行为，提供了可互操作的基础，所有 <a href=\"https://promisesaplus.com/\">Promise/A+</a> 兼容的 Promise 实现都可以依靠该基础来提供。\n\n因此，该规范被认为是非常稳定的。\n\n从历史上看，<a href=\"https://promisesaplus.com/\">Promise/A+</a> 阐明了早期的 <a href=\"http://wiki.commonjs.org/wiki/Promises/A\">Promise/A</a> 提案的行为条款。\n\n核心的 <a href=\"https://promisesaplus.com/\">Promise/A+</a> 是专注于提供一种可以互操作的 `then` 方法。\n\n<hr />\n\n## Promise/A+ 规范解读\n\n以下内容是源自 <a href=\"https://promisesaplus.com/\">Promise/A+</a> 官网的翻译版本 + 个人理解版本，英语好的朋友可以自行阅读 <a href=\"https://promisesaplus.com/\">Promise/A+</a> 官方文档。\n\n### Terminology\n\n**1.1.** \"promise\" 是一个符合本规范的，并具有 `then` 方法的一个对象或函数\n\n**1.2.** \"thenable\" 是一个具有 `then` 方法的对象或函数\n\n**1.3.** \"value\" 可以是任何一个合法的 JavaScript 值，包括 `undefined`、一个 *thenable* 或一个 promise\n\n**1.4.** \"exception\" 是一个使用 `throw` 关键字所抛出的值\n\n**1.5.** \"reason\" 是表明这个 promise 被 reject 的原因\n\n### Requirements\n\n#### Promise States\n\n一个 promise 必须处于以下三个状态之一：`pending`、`fulfilled` 或 `rejected`\n\n**2.1.1.** 当处于 `pending` 态时，一个 promise：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.1.1.1.</b> 可能会转换为 <code>fulfilled</code> 或 <code>rejected</code> 状态</li>\n</ul>\n\n**2.1.2.** 当处于 `fulfilled` 时，一个 promise：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.1.2.1.</b> 它绝不会再转变为其他状态</li>\n    <li><b>2.1.2.2.</b> 它必须存在一个不可被改变的 <em>value</em> 值，以此表明成功时的值</li>\n</ul>\n\n**2.1.3.** 当处于 `rejected` 时，一个 promise：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.1.3.1.</b> 它绝不会再转变为其他状态</li>\n    <li><b>2.1.3.2.</b> 它必须存在一个不可被改变的 <em>reason</em> 值，以此表明其失败的原因</li>\n</ul>\n\n#### The `then` Method\n\n一个 promise 必须提供一个 `then` 方法去访问其最终成功时的值或其失败的原因。\n\n一个 promise 的 `then` 方法可以接收两个参数：\n\n```javascript\npromise.then(onFulfilled, onRejected)\n```\n\n**2.2.1.** 这两个参数都是可选的参数：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.2.1.1.</b> 如果 <code>onFulfilled</code> 不是一个函数，那么必须忽略</li>\n    <li><b>2.2.1.2.</b> 如果 <code>onRejected</code> 不是一个函数，那么必须忽略</li>\n</ul>\n\n**2.2.2.** 如果 `onFulfilled` 是一个函数：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.2.2.1.</b> 它必须在 promise 状态变为 <code>fulfilled</code> 之后调用，并使用 <em>value</em> 的值作为其第一个参数</li>\n    <li><b>2.2.2.2.</b> 它绝不能在 promise 状态变为 <code>fulfilled</code> 之前调用</li>\n    <li><b>2.2.2.3.</b> 它的调用次数绝不能超过一次</li>\n</ul>\n\n**2.2.3.** 如果 `onFulfilled` 是一个函数：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.2.3.1.</b> 它必须在 promise 状态变为 <code>rejected</code> 之后调用，并使用 <em>value</em> 的值作为其第一个参数</li>\n    <li><b>2.2.3.2.</b> 它绝不能在 promise 状态变为 <code>rejected</code> 之前调用</li>\n    <li><b>2.2.3.3.</b> 它的调用次数绝不能超过一次</li>\n</ul>\n\n**2.2.4.** `onFulfilled` 和 `onRejected` 在 <a href=\"https://es5.github.io/#x10.3\">执行上下文</a> 堆栈仅包含平台代码前不得调用 [<a href=\"#point-3-1\">3.1</a>]\n\n**2.2.5.** `onFulfilled` 和 `onRejected` 必须作为函数去调用（即使没有 *value* 值）[<a href=\"#point-3-2\">3.2</a>]\n\n**2.2.6.** `then` 方法可能在同一个 promise 中被多次调用：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.2.6.1.</b> 如果/当 promise 被 fulfilled 了，那么所有相应的 <code>onFulfilled</code> 回调函数必须按照其对应 <code>then</code> 函数调用顺序依次执行</li>\n    <li><b>2.2.6.2.</b> 如果/当 promise 被 rejected 了，那么所有相应的 <code>onRejected</code> 回调函数必须按照其对应 <code>then</code> 函数调用顺序依次执行</li>\n</ul>\n\n**2.2.7.** `then` 方法必须返回一个 promise [<a href=\"#point-3-3\">3.3</a>]：\n\n```javascript\npromise2 = promise1.then(onFulfilled, onRejected);\n```\n\n<ul style=\"list-style: none;\">\n    <li><b>2.2.7.1.</b> 如果 <code>onFulfilled</code> 或 <code>onRejected</code> 其中一个返回了值 <code>x</code>，则需要运行 Promise 解决程序 <code>[[Resolve]](promise2, x)</code></li>\n    <li><b>2.2.7.2.</b> 如果 <code>onFulfilled</code> 或 <code>onRejected</code> 其中抛出了一个异常 <code>e</code>，则 promise2 必须以 <code>e</code> 为缘由被 <em>reject</em></li>\n    <li><b>2.2.7.3.</b> 如果 <code>onFulfilled</code> 不是一个函数，并且 promise1 已经处于成功态，那么 promise2 必须以与 promise1 的 <em>value</em> 相同的值被 <em>resolve</em></li>\n    <li><b>2.2.7.4.</b> 如果 <code>onRejected</code> 不是一个函数，并且 promise1 已经处于失败态，那么 promise2 必须以与 promise1 的 <em>reason</em> 相同的值被 <em>reject</em></li>\n</ul>\n\n#### The Promise Resolution Procedure\n\nPromise 解决程序是一个抽象的操作 <code>[[Resolve]](promise2, x)</code>，其输入一个 promise 和一个值 `x`。\n\n**2.3.1.** 如果 promise2 和 `x` 是同一个对象，那么令 promise2 为 *reject*，并以 `TypeError` 作为原因\n\n**2.3.2.** 如果 `x` 恰好是一个 Promise 对象，那么采用它的状态 [<a href=\"#point-3-4\">3.4</a>]：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.3.2.1.</b> 如果 <code>x</code> 处于 <em>pending</em> 态，那么 promise2 也要处于 <em>pending</em> 态，直到 <code>x</code> 变成了 <em>fulfilled</em> 态或者 <em>rejected</em> 态</li>\n    <li><b>2.3.2.2.</b> 如果 <code>x</code> 处于 <em>fulfilled</em> 态，那么 promise2 也以与 <code>x</code> 同样的 <em>value</em> 被 <em>resolve</em></li>\n    <li><b>2.3.2.3.</b> 如果 <code>x</code> 处于 <em>rejected</em> 态，那么 promise2 也以与 <code>x</code> 同样的 <em>reason</em> 被 <em>reject</em></li>\n</ul>\n\n**2.3.3.** 否则，如果 `x` 是一个对象或函数：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.3.3.1.</b> 新建一个变量 <code>then</code>，令其等于 <code>x.then</code> [<a href=\"#point-3-5\">3.5</a>]</li>\n    <li><b>2.3.3.2.</b> 如果在 <code>x.then</code> 中抛出了一个异常 <code>e</code>，那么 promise2 将会以 <code>e</code> 被 <em>reject</em></li>\n    <li><b>2.3.3.3.</b> 如果 <code>then</code> 是一个函数，那么以 <code>x</code> 为函数中的 <code>this</code> 去调用它，与普通的 <code>then</code> 方法相同，其接收两个参数：<code>onFulfilled</code> 和 <code>onRejected</code>：</li>\n    <li>\n        <ul style=\"list-style: none;\">\n            <li><b>2.3.3.3.1.</b> 如果/当 <code>onFulfilled</code> 被调用了，并且传入的参数是 <code>y</code>，那么再次调用 <code>[[Resolve]](promise2, y)</code></li>\n            <li><b>2.3.3.3.2.</b> 如果/当 <code>onRejected</code> 被调用了，并且传入的参数是 <code>r</code>，那么 promise2 需要以 <code>r</code> 为 <em>reason</em> 被 <em>reject</em></li>\n            <li><b>2.3.3.3.3.</b> 如果同时调用了 <code>onFulfilled</code> 与 <code>onRejected</code>，或者对同一个函数进行了多次调用，则只执行第一次调用，其余的所有调用都应当被忽略</li>\n            <li><b>2.3.3.3.4.</b> 如果在调用 <code>then</code> 时抛出了异常 <code>e</code>：</li>\n            <li>\n                <ul style=\"list-style: none;\">\n                    <li><b>2.3.3.3.4.1.</b> 如果 <code>onFulfilled</code> 或 <code>onRejectde</code> 已经被调用过了，则忽略这个异常</li>\n                    <li><b>2.3.3.3.4.2.</b> 否则，以 <code>e</code> 为 <em>reason</em>，令 promise2 被 <em>reject</em></li>\n                </ul>\n            </li>\n        </ul>\n    </li>\n    <li><b>2.3.3.4.</b> 如果 <code>then</code> 不是一个函数，那么将 <code>x</code> 作为 <em>value</em>，令 promise2 被 <em>resolve</em></li>\n</ul>\n\n**2.3.4.** 如果 <code>x</code> 不是一个函数或对象，那么将 <code>x</code> 作为 <em>value</em>，令 promise2 被 <em>resolve</em>\n\n如果 promise2 被一个循环的 *thenable* *resolve* 了，这样会因为 `[[Resolve]](promise, thenable)` 的递归性质最终再次调用 `[[Resolve]](promise, thenable)`，遵循上述算法将会导致递归没有出口。<a href=\"https://promisesaplus.com/\">Promise/A+</a> 规范鼓励（但不是必须的）去检测这种递归，并以 `TypeError` 为 *reason* 使得当前递归栈顶中的 promise 被 *reject*。[<a href=\"#point-3-6\">3.6</a>]\n\n### Notes\n\n<a name=\"point-3-1\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.1.</b></a> 这里的“平台代码”是指 JS 引擎、环境和 promise 实现代码。实际上，这一要求确保 `onFulfilled` 和 `onRejected` 在调用 `then` 事件循环之后，使用一个新的堆栈去异步执行。这可以通过“宏任务”机制（例如 <a href=\"https://html.spec.whatwg.org/multipage/webappapis.html#timers\">setTimeout</a> 或 <a href=\"https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/setImmediate/Overview.html#processingmodel\">setImmediate</a>）或通过“微任务”机制（例如 <a href=\"https://dom.spec.whatwg.org/#interface-mutationobserver\">MutationObserver</a> 或 <a href=\"https://nodejs.org/api/process.html#process_process_nexttick_callback\">process.nextTick</a>）。由于 promise 的实现被视为了平台代码，因此它本身可能包含一个任务调度队列或调用处理程序的“蹦床”。\n\n<a name=\"point-3-2\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.2.</b></a> 也就是说，在 JavaScript 的严格模式下，`undefined` 可能会作为 `this` 的值出现，然而在非严格模式下，它将会作为一个全局变量。\n\n<a name=\"point-3-3\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.3.</b></a> promise 的实现可以允许 `promise2 === promise1`（即：`promise2 === x`），前提是应当满足所有的要求。每个实现都应该记录它是否可以生成 `promise2 === promise1` 以及在什么条件下会生成 `promise1`。\n\n<a name=\"point-3-4\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.4.</b></a> 一般来说，只有当 `x` 来自于当前的 promise 时，才可以知道它是一个真正的 promise。该条款允许使用特定的手段来采用一些已知且一致的 promise 状态。\n\n<a name=\"point-3-5\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.5.</b></a> 这个过程首先存储了 `x.then` 的引用，然后测试这个引用（是否是一个函数），然后再调用这个引用。避免了对 x.then 属性的访问。这些预防措施对于确保访问器属性的一致性非常重要，因为访问器属性的值可能在两次检索之间发生变化。\n\n<a name=\"point-3-6\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.6.</b></a> 实现不应该对递归循环链的深度做限制，并且假设超过该任意递归限制将会是无线的递归。只有真正的循环才会导致 `TypeError`；如果遇到了无限长的非重复的链，则永远的去递归其正确的行为。\n\n<hr />\n\n## 实现\n\n### 创建 Promise 类\n\n根据术语 1，promise 是一个有 then 方法的对象或者是函数，行为遵循本规范。那么就创建一个类（ES6 写法，下同）：\n\n```javascript\nclass Promise {\n    \n}\n```\n\n### 完善 Promise 的状态\n\n根据规范 2.1，Promise 必须处于以下三个状态之一: pending, fulfilled 或者是 rejected：\n\n```javascript\nconst PENDING = 'pending';\nconst FULFILLED = 'fulfilled';\nconst REJECTED = 'rejected';\n\nclass Promise {\n    \n}\n```\n\n### 完善构造器\n\n根据原生 Promise，在 new 的时候需要传入一个 **executor** 执行器，这个执行器会在 new 返回这个 Promise 实例之前被调用。\n\n在构造器中，令这个 Promise 实例的状态处于 *PENDING* 态。\n\n**executor** 构造器接收两个参数，*resolve* 和 *reject*，他们两个都是函数：\n\n- *resolve* 接收一个参数 *value*，代表当前 Promise 成功时的值（术语 3）\n- *reject* 接收一个参数 *reason*，代表当前 Promise 失败的原因（术语 5）\n\n根据规则 2.1.1、2.1.2、2.1.3，在调用 *resolve* 或 *reject* 时，如果当前 Promise 的状态是 *PENDING* 态，那么应该转换成对应的 *FULFILLED* 或 *REJECTED*。\n\n根据原生 Promise 得知，如果 **executor** 在执行中抛出了一个异常，那么当前 promise 则要进入失败态：\n\n```javascript\nconst PENDING = 'pending';\nconst FULFILLED = 'fulfilled';\nconst REJECTED = 'rejected';\n\nclass Promise {\n    constructor(executor) {\n        this.status = PENDING;\n        \n        // 使用箭头函数是为了保证 this 的一致性\n        let resolve = value => {\n            if (this.status === PENDING) {\n                this.status = FULFILLED;\n                this.value = value;\n            }\n        };\n        \n        let reject = reason => {\n            if (this.status === PENDING) {\n                this.status = REJECTED;\n                this.reason = reason;\n            }\n        };\n        \n        try {\n            executor(resolve, reject);\n        } catch (e) {\n            reject(e);\n        }\n    }\n}\n```\n\n### 构造 then 方法\n\n根据规则 2.2.1，`then` 方法接收两个参数 `onFulfilled` 和 `onRejected`：\n\n```javascript\n// 上面省略，then 方法是一个成员函数\nthen(onFulfilled, onRejected) {\n    \n}\n// 下面省略\n```\n\n### then 方法的参数\n\n根据规则 2.2.5、2.2.7.3、2.2.7.4，需要对传入的 `onFulfilled` 和 `onRejected` 的类型进行判断：\n\n```javascript\nthen(onFulfilled, onRejected) {\n    onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;\n    onRejected = typeof onRejected === 'function' ? onRejected : reason => { throw reason; };\n}\n```\n\n### then 方法的返回值\n\n根据规则 2.2.7，`then` 方法会返回一个新的 Promise 实例 `promise2`：\n\n```javascript\nthen(onFulfilled, onRejected) {\n    onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;\n    onRejected = typeof onRejected === 'function' ? onRejected : reason => { throw reason; };\n    \n    let promise2 = new Promise((resolve, reject) => {\n        \n    });\n    \n    return promise2;\n}\n```\n\n### 实现返回的新的 Promise 实例\n\n根据规则 2.2.2、2.2.3，需要对原先的 promise（即调用 `then` 方法的 `this`）的状态进行判断，以此来确定 `promise2` 的状态。\n\n根据规则 2.2.4，需要以异步的方式去执行 `onFulfilled` 和 `onRejected`（这里统一采用 `setTimeout`）。\n\n<div class=\"note info\">setTimeout() 可以省略第二个参数，只传入第一个回调函数作为参数，但是由于 JS 引擎与硬件等原因，不可能达到完全的 0ms 立即执行，往往会有一个最小时间（浏览器中通常是 4ms）</div>\n\n```javascript\nthen(onFulfilled, onRejected) {\n    onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;\n    onRejected = typeof onRejected === 'function' ? onRejected : reason => { throw reason; };\n    \n    let promise2 = new Promise((resolve, reject) => {\n        // 这里如果不使用箭头函数，这个 this 的值就会变成 promise2\n        // 如果使用 function，请在此之前使用 let self = this; 去存储一个 promise 的引用\n        if (this.status === FULFILLED) {\n            // Promise/A+ 2.2.4 --- setTimeout\n            setTimeout(() => {\n                onFulfilled(this.value);\n            });\n        } else if (this.status === REJECTED) {\n            setTimeout(() => {\n                onRejected(this.reason);\n            });\n        } else {\n            \n        }\n    });\n    \n    return promise2;\n}\n```\n\n### 利用发布订阅解决 PENDING 态的问题\n\n在我的 <a href=\"https://www.wqh4u.cn/2020/01/14/JavaScript%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/\">这篇博客</a> 中解释了什么是发布订阅哦~\n\n根据规则 2.2.6.1、2.2.6.2，如果当前调用 `then` 的 promise 实例还处于 *PENDING* 态，那么所有相应的 `onFulfilled` 和 `onRejected` 都需要等到这个 promise 实例被完成时（改变状态时），去依次执行（这里也解决了同一个 promise 实例多次调用 `then` 方法的问题）。\n\n这其实就用到了 **“发布订阅”** 的思想，首先将所有的 `onFulfilled` 和 `onRejected` 存储起来（订阅），等到 promise 实例的状态改变时（发布），依次调用订阅的回调函数（广播）。\n\n首先修改构造器，增加两个属性去接收订阅的回调函数：\n\n```javascript\nclass Promise {\n    constructor(executor) {\n        this.status = PENDING;\n        \n        // 增加两个属性\n        this.onFulfilledCallback = [];\n        this.onRejectedCallback = [];\n        \n        // 以下省略...\n    }\n}\n```\n\n然后修改 `then` 中的方法：\n\n```javascript\nthen(onFulfilled, onRejected) {\n    onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;\n    onRejected = typeof onRejected === 'function' ? onRejected : reason => { throw reason; };\n    \n    let promise2 = new Promise((resolve, reject) => {\n        if (this.status === FULFILLED) {\n            setTimeout(() => {\n                onFulfilled(this.value);\n            });\n        } else if (this.status === REJECTED) {\n            setTimeout(() => {\n                onRejected(this.reason);\n            });\n        } else {\n            // 当 this.status === PENDING 时，需要将回调函数进行存储\n            // 因为 “发布订阅” 最后是逐个调用订阅回调的，所以这里要 push 一个函数\n            this.onFulfilledCallback.push(() => {\n                // 又因为规则 2.2.4，即使存储了 onFulfilled 和 onRejected，也要去异步的执行\n                setTimeout(() => {\n                    onFulfilled(this.value);\n                });\n            });\n            this.onRejectedCallback.push(() => {\n                setTimeout(() => {\n                    onRejected(this.reason);\n                });\n            });\n        }\n    });\n    \n    return promise2;\n```\n\n最后修改构造器中的 *resolve* 和 *reject*，因为它们的调用会造成 promise 状态的改变，既然状态发生了改变，则需要去对订阅者 **发布广播** ：\n\n```javascript\nclass Promise {\n    constructor(executor) {\n        // 以上省略...\n        \n        let resolve = value => {\n            if (this.status === PENDING) {\n                this.status = FULFILLED;\n                this.value = value;\n                // publish\n                this.onFulfilledCallback.forEach(value => value());\n                // 注意这个 value 值，它只是 forEach 回调的第一个参数哦\n            }\n        };\n        \n        let reject = reason => {\n            if (this.status === PENDING) {\n                this.status = REJECTED;\n                this.reason = reason;\n                // publish\n                this.onRejectedCallback.forEach(value => value());\n            }\n        };\n        \n        // 以下省略...\n    }\n}\n```\n\n### 定义 Promise Resolution Procedure\n\n根据规则 2.3，我们需要一个承诺解决函数 promiseResolutionProcedure()，我们令其接收四个参数：\n\n- promise2：为 `then` 方法应当返回的值，即 promise2（本身也是对他进行处理）\n- x：为 `then` 中，调用 `then` 方法的 promise 实例（就是 `this`）的 `onFulfilled` 和 `onRejected` 的返回值，因为其的可能性太多，所以需要 romise Resolution Procedure 去处理\n- resolve：为传入 promise2 的构造器中 **executor** 的第一个参数\n- reject：为传入 promise2 的构造器中 **executor** 的第二个参数\n\n这里传入 *resolve* 和 *reject* 的原因之一是方便对 promise2 进行状态确定的处理：\n\n```javascript\nclass Promise {\n    // 省略\n}\n\nfunction promiseResolutionProcedure(promise2, x, resolve, reject) {  \n    // 暂时不写\n}\n```\n\n### 完善 then 方法\n\n根据规则 2.2.7.1 和 2.2.7.2 得知：\n\n- **2.2.7.1** `onFulfilled` 和 `onRejected` 都是会有返回值 `x` 的，并且需要对这个 x 进行 Promise Resolution Procedure\n- **2.2.7.2** 如果在 `onFulfilled` 和 `onRejected` 中抛出了异常 `e`，那么 promise2 需要以 `e` 为 *reason* 被 *reject*\n\n这里不要忘了，因为是对所有的 `onFulfilled` 和 `onRejected` 进行处理，所以在 promise.status 为 *PENDING* 态时，也要写进去奥：\n\n```javascript\n// 以上省略...\n\nthen(onFulfilled, onRejected) {\n    onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;\n    onRejected = typeof onRejected === 'function' ? onRejected : reason => { throw reason; };\n    \n    let promise2 = new Promise((resolve, reject) => {\n        if (this.status === FULFILLED) {\n            setTimeout(() => {\n                // 首先根据 2.2.7.2，需要对 onFulfilled 和 onRejected 进行异常处理\n                try {\n                    // 又因为 2.2.7.1，onFulfilled 和 onRejected 都可能返回一个 x\n                    // 这时候需要对 x 进行捕获\n                    let x = onFulfilled(this.value);\n                    // 捕获完了后就要对 x 的值进行分析\n                    // 此时需要调用 Promise Resolution Procedure\n                    promiseResolutionProcedure(promise2, x, resolve, reject);\n                    // 不用担心这里由于 promise2 是由 let 定义的，从而导致这一句 promise2 的值是 undefined\n                    // 因为这块代码是异步执行，在真正执行到这里时对 promise2 的定义早都完了\n                } catch (e) {\n                    reject(e); // 这个 reject 是 promise2 的 reject，不要搞混了\n                }\n                // 下同，对每一个 onFulfilled 和 onRejected 都要处理\n            });\n        } else if (this.status === REJECTED) {\n            setTimeout(() => {\n                try {\n                    let x = onRejected(this.reason);\n                    promiseResolutionProcedure(promise2, x, resolve, reject);\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        } else {\n            this.onFulfilledCallback.push(() => {\n                setTimeout(() => {\n                    try {\n                        let x = onFulfilled(this.value);\n                        promiseResolutionProcedure(promise2, x, resolve, reject);\n                    } catch (e) {\n                        reject(e);\n                    }\n                });\n            });\n            this.onRejectedCallback.push(() => {\n                setTimeout(() => {\n                    try {\n                        let x = onRejected(this.reason);\n                        promiseResolutionProcedure(promise2, x, resolve, reject);\n                    } catch (e) {\n                        reject(e);\n                    }\n                });\n            });\n        }\n    });\n    \n    return promise2;\n}\n\n// 以下省略...\n```\n\n### 最难的 Promise Resolution Procedure\n\n根据规范 2.3.1，如果 promise2 和 x 是全等的，那么 promise2 应该以 `TypeError('Chaining cycle')` 被 *reject*。\n\n因为一个 promise 对象也是属于 `object` 或一个 `function` 的，所以在执行规范 2.3.2 之前需要去验证规范 2.3.3，即 `x` 是否为一个对象或者函数。\n\n<div class=\"note danger\">注意一点，在神奇的 JavaScript 中，<code>typeof null === 'object'</code></div>\n\n根据规范 2.3.4，如果 `x` 既不是对象也不是函数，那么 promise2 应该处于成功态（被 <em>resolve</em>），且 <em>value</em> 值为 `x`：\n\n```javascript\n// 以上省略...\nfunction promiseResolutionProcedure(promise2, x, resolve, reject) {\n    // Promise/A+ 2.3.1\n    if (promise2 === x) {\n        reject(new TypeError('Chaining cycle'));\n    }\n    \n    // Promise/A+ 2.3.3\n    if (x && typeof x === 'object' || typeof x === 'function') {\n        // 这里由于运算符优先级的问题，不能将 object 和 function 颠倒！\n    } else {\n        // Promise/A+ 2.3.4\n        resolve(x);\n    }\n}\n```\n\n现在就该检查 `x` 是不是一个 *thenable* 了。\n\n根据规范 2.3.3.1，令 `then` 变量与 `x.then` 同引用。\n\n根据规范 2.3.3.3，如果同时调用 `onFulfilled` 和 `onRejected`，或者对同一参数进行了多次调用，则第一个调用优先，而所有其他调用均被忽略，所以需要维护一个值，去判断是否为第一次调用。\n\n根据规范 2.3.3.2，如果在检索 `x.then` 时抛出了异常 `e`，那么 promise2 则应该以 `e` 为 *reason* 被 *reject*。\n\n根据规范 2.3.3.4，如果 `x.then` 不是一个函数（不是 <em>thenable</em>），那么 promise2 则应该以 `x` 为 <em>value</em> 被 *resolve*。\n\n根据规范 2.3.3，如果 `x.then` 是一个函数，且根据 Promise Resolution Procedure 的定义：<b>如果 x 是 <em>thenable</em>，那么最起码在 then 行为类似于一个 promise 实例的情况下，尝试对其采用 promise 实例应该有的方法，否则执行规范 2.3.3.4。</b>\n\n<div class=\"note info\">个人认为，这一步是将规范 2.3.2 结合到了 2.3.3 中去实现，因为 2.3.3 中的 x 也是一个 <em>thenable</em>，又因为 Promise Resolution Procedure 定义也说了，那么只要是一个 <em>thenable</em>，就把它当作一个 promise 实例去试试。</div>\n\n根据规范 2.3.3.3，`then` 是一个函数，那么需要用 `x` 作为调用这个 `then` 的 `this`，并且这个 `then` 接收两个参数 `onFulfilled` 和 `onRejected`。（这就是对于 Promise Resolution Procedure 定义的一个实现，不管他到底是不是真正的 promise 实例的 then 方法，传进去就是了）\n\n根据规范 2.3.3.3.1 和 2.3.3.3.2，对传入 `then` 中的 `onFulfilled` 和 `onRejected` 进行实现：\n\n```javascript\nfunction promiseResolutionProcedure(proemise2, x, resolve, reject) {\n    if (promise2 === x) {\n        reject(new TypeError('Chaining cycle'));\n    }\n    \n    if (x && typeof x === 'object' || typeof x === 'function') {\n        // Promise/A+ 2.3.3.3\n        let used = false;\n        try {\n            // Promise/A+ 2.3.3.1\n            let then = x.then;\n            \n            // Promise/A+ 2.3.3.4\n            if (typeof x === 'function') {\n                // Promise/A+ 2.3.3.3\n                // Promise Resolution Procedure\n                then.call(x, y => {\n                    // Promise/A+ 2.3.3.3.1\n                    if (used) return;\n                    used = true;\n                    promiseResolutionProcedure(promise2, y, resolve, reject);\n                }, reason => {\n                    // Promise/A+ 2.3.3.3.2\n                    if (used) return;\n                    used = true;\n                    reject(reason);\n                });\n            } else {\n                if (used) return;\n                used = true;\n                resolve(x);\n            }\n        } catch (e) {\n            // Promise/A+ 2.3.3.2\n            if (used) return;\n            used = true;\n            reject(e);\n        }\n    } else {\n        resolve(x);\n    }\n}\n```\n\n<hr />\n\n## 测试\n\n### 准备工作\n\n#### 导出模块\n\n如果你的 Promise 代码在一个单独的文件（比如 Promise.js）中，那么需要使用 Node.js 中导出模块：\n\n```javascript\nclass Promise {\n    // 省略...\n}\n\nfunction promiseResolutionProcedure(promise2, x, resolve, reject) {\n    // 省略...\n}\n\nmodule.exports = Promise; // 导出模块\n```\n\n#### 安装测试脚本\n\n有专门的测试脚本可以测试所编写的代码是否符合 Promise/A+ 的规范：\n\n```bash\nnpm install -g promises-aplus-tests\n```\n\n#### 编写测试代码\n\n在 Promise.js 中，添加如下代码：\n\n```javascript\nclass Promise {\n    // 省略...\n}\n\nfunction promiseResolutionProcedure(promise2, x, resolve, reject) {\n    // 省略...\n}\n\nPromise.defer = Promise.deferred = function() {\n    let dfd = {};\n    dfd.promise = new Promise((resolve, reject) => {\n        dfd.resolve = resolve;\n        dfd.reject = reject;\n    });\n    return dfd;\n};\n\nmodule.exports = Promise; // 导出模块\n```\n\n如果不加的话，可以康康报错，你就懂了 /doge\n\n### 再贴一遍全部的代码吧~\n\n```javascript\n'use strict';\n\n// Promise/A+ 2.1 --- 有三个状态\nconst PENDING = 'pending';\nconst FULFILLED = 'fulfilled';\nconst REJECTED = 'rejected';\n\n// 术语 1 --- Promise 实例\nclass Promise {\n    constructor(executor) {\n        this.status = PENDING;\n\n        // Promise/A+ 2.2.6.1 --- onFulfilled 订阅\n        // Promise/A+ 2.2.6.2 --- onRejected 订阅\n        this.onFulfilledCallback = [];\n        this.onRejectedCallback = [];\n\n        // 术语 3 --- resolve 定义\n        let resolve = value => {\n            if (this.status === PENDING) {\n                // Promise/A+ 2.1.1 --- 对于 pending 态的描述\n                // Promise/A+ 2.1.2 --- 对于 fulfilled 态的描述\n                this.status = FULFILLED;\n                this.value = value;\n                // Promise/A+ 2.2.6.1 --- 当 resolve（发布）时，则需要广播\n                this.onFulfilledCallback.forEach(value => value());\n            }\n        };\n\n        // 术语 5 --- reject 定义\n        let reject = reason => {\n            if (this.status === PENDING) {\n                // Promise/A+ 2.1.1 --- 对于 pending 态的描述\n                // Promise/A+ 2.1.3 --- 对于 rejected 态的描述\n                this.status = REJECTED;\n                this.reason = reason;\n                // Promise/A+ 2.2.6.2 --- 当 reject（发布）时，则需要进行广播\n                this.onRejectedCallback.forEach(value => value());\n            }\n        };\n\n        try {\n            // 由原生 Promise 推断而来\n            executor(resolve, reject);\n        } catch (e) {\n            reject(e);\n        }\n    }\n\n    // Promise/A+ 2.2 --- then 方法\n    // Promise/A+ 2.2.1 --- then 方法接收两个参数\n    then(onFulfilled, onRejected) {\n        // Promise/A+ 2.2.5 --- 这两个参数要作为函数被调用\n        // Promise/A+ 2.2.7.3 --- 如果 onFulfilled 不是函数且 this 已 resolve，则 promise2 必须使用与相同的 value 来 resolve\n        onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;\n        // Promise/A+ 2.2.7.4 --- 如果 onFulfilled 不是函数且 this 已 reject，则 promise2 必须使用与相同的 reason 来 reject\n        onRejected = typeof onRejected === 'function' ? onRejected : reason => {\n            throw reason;\n        };\n\n        // Promise/A+ 2.2.7 --- then 方法会返回一个新的 promise 实例\n        let nextPromise = new Promise((resolve, reject) => {\n            // Promise/A+ 2.2.2 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数\n            // Promise/A+ 2.2.3 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数\n            if (this.status === FULFILLED) {\n                setTimeout(() => {\n                    // Promise/A+ 2.2.4 --- 需要以异步的方式去执行\n                    try {\n                        // Promise/A+ 2.2.7.1 --- 需要对 onFulfilled 的返回值 x 去进行 Promise Resolution Procedure\n                        let x = onFulfilled(this.value);\n                        promiseResolutionProcedure(nextPromise, x, resolve, reject);\n                    } catch (e) {\n                        // Promise/A+ 2.2.7.2 --- 如果在执行 onFulfilled 时抛异常，那么 promise2 以异常为 reason 被 reject\n                        reject(e);\n                    }\n                });\n            } else if (this.status === REJECTED) {\n                // Promise/A+ 2.2.2 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数\n                // Promise/A+ 2.2.3 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数\n                setTimeout(() => {\n                    // Promise/A+ 2.2.4 --- 需要以异步的方式去执行\n                    try {\n                        // Promise/A+ 2.2.7.1 --- 需要对 onRejected 的返回值 x 去进行 Promise Resolution Procedure\n                        let x = onRejected(this.reason);\n                        promiseResolutionProcedure(nextPromise, x, resolve, reject);\n                    } catch (e) {\n                        // Promise/A+ 2.2.7.2 --- 如果在执行 onRejected 时抛异常，那么 promise2 以异常为 reason 被 reject\n                        reject(e);\n                    }\n                });\n            } else {\n                // Promise/A+ 2.2.6.1 --- 如果还在 pending 态或多次调用，需要以 “发布订阅” 方法去解决 onFulfilled\n                this.onFulfilledCallback.push(() => {\n                    setTimeout(() => {\n                        // Promise/A+ 2.2.4 --- 需要以异步的方式去执行\n                        try {\n                            // Promise/A+ 2.2.7.1 --- 需要对 onFulfilled 的返回值 x 去进行 Promise Resolution Procedure\n                            let x = onFulfilled(this.value);\n                            promiseResolutionProcedure(nextPromise, x, resolve, reject);\n                        } catch (e) {\n                            // Promise/A+ 2.2.7.2 --- 如果在执行 onFulfilled 时抛异常，那么 promise2 以异常为 reason 被 reject\n                            reject(e);\n                        }\n                    });\n                });\n                // Promise/A+ 2.2.6.2 --- 如果还在 pending 态或多次调用，需要以 “发布订阅” 方法去解决 onRejected\n                this.onRejectedCallback.push(() => {\n                    setTimeout(() => {\n                        // Promise/A+ 2.2.4 --- 需要以异步的方式去执行\n                        try {\n                            // Promise/A+ 2.2.7.1 --- 需要对 onRejected 的返回值 x 去进行 Promise Resolution Procedure\n                            let x = onRejected(this.reason);\n                            promiseResolutionProcedure(nextPromise, x, resolve, reject);\n                        } catch (e) {\n                            // Promise/A+ 2.2.7.2 --- 如果在执行 onRejected 时抛异常，那么 promise2 以异常为 reason 被 reject\n                            reject(e);\n                        }\n                    });\n                });\n            }\n        });\n        return nextPromise;\n    }\n}\n\n// Promise/A+ 2.3 --- 定义 Promise Resolution Procedure\nfunction promiseResolutionProcedure(promise, x, resolve, reject) {\n    // Promise/A+ 2.3.1 --- 如果 promise2 和 x 是全等的，那么 promise2 应该以 TypeError('Chaining cycle') 被 reject\n    if (x === promise) {\n        reject(new TypeError('Chaining cycle'));\n    }\n\n    // Promise/A+ 2.3.3 --- x 是否是一个对象或函数\n    if (x && typeof x === 'object' || typeof x === 'function') {\n        // Promise/A+ 2.3.3.3 --- 维护一个 used，保证只调用一次 onFulfilled 或 onRejected\n        let used = false;\n        try {\n            // Promise/A+ 2.3.3.1 --- 令 then 与 x.then 同引用\n            let then = x.then;\n            if (typeof then === 'function') {\n                // Promise/A+ 2.3.3 --- 如果 then 是一个函数，则将 x 当作 promise 实例来处理\n                // Promise Resolution Procedure 定义的实现\n                // Promise/A+ 2.3.3.3 --- 以 x 为 this 去调用 then 方法，并传入两个回调函数作为参数\n                then.call(x, y => {\n                    // Promise/A+ 2.3.3.3.1 --- 继续去以 Promise Resolution Procedure 处理 y 值\n                    if (used) {\n                        return;\n                    }\n                    used = true;\n                    promiseResolutionProcedure(promise, y, resolve, reject);\n                }, reason => {\n                    // Promise/A+ 2.3.3.3.2 --- 如果失败了，那么以 reason 去将 promise2 reject\n                    if (used) {\n                        return;\n                    }\n                    used = true;\n                    reject(reason);\n                });\n            } else {\n                // Promise/A+ 2.3.3.4 --- 如果 then 不是一个函数，那么 promise2 以 x 为 value 被 resolve\n                if (used) {\n                    return;\n                }\n                used = true;\n                resolve(x);\n            }\n        } catch (e) {\n            // Promise/A+ 2.3.3.2 --- 如果检索 x.then 时抛异常，那么 promise2 应以异常值为 reason 被 reject\n            if (used) {\n                return;\n            }\n            used = true;\n            reject(e);\n        }\n    } else {\n        // Promise/A+ 2.3.4 --- 如果 x 既不是对象也不是函数，那么 promise2 以 x 为 value 被 resolve\n        resolve(x);\n    }\n}\n\nPromise.defer = Promise.deferred = function() {\n    let dfd = {};\n    dfd.promise = new Promise((resolve, reject) => {\n        dfd.resolve = resolve;\n        dfd.reject = reject;\n    });\n    return dfd;\n};\n\nmodule.exports = Promise;\n```\n\n### 开始测试\n\n控制台切到当前目录下，执行以下命令：\n\n```bash\npromises-aplus-tests ./Promise.js\n```\n\n一共 872 个测试用例（2020.01.22 版本，不知道以后会不会多），如果都 OK 了最后会告诉你：\n\n<div class=\"note success\">872 passing</div>\n\n即使不 OK，他在最后也会告诉你哪个测试点错了，比如在刚刚实现 Promise Resolution Procedure 时，特别强调了这一句话：\n\n```javascript\n// 以上省略...\nfunction promiseResolutionProcedure(promise2, x, resolve, reject) {\n    // 以上省略...\n\n    if (x && typeof x === 'object' || typeof x === 'function') {\n        // 这里由于运算符优先级的问题，不能将 object 和 function 颠倒！\n    } else {\n        \n    }\n}\n```\n\n原因也说了，`typeof null === 'object'`，那如果颠倒过来，写成这样：\n\n```javascript\n// 以上省略...\nfunction promiseResolutionProcedure(promise2, x, resolve, reject) {\n    // 以上省略...\n\n    if (x && typeof x === 'function' || typeof x === 'object') {\n        \n    } else {\n        \n    }\n}\n```\n\n再次执行测试，那么最终的结果是：\n\n<div class=\"note\">\n    <p>862 passing</p>\n    <p>10 failing</p>\n</div>\n\n再往下就是错误信息（很贴心了，还告诉你针对哪一个 Promise/A+ 规范错了）：\n\n<ul style=\"list-style: none;\">\n    <li>\n        <p>1) 2.3.3: Otherwise, if `x` is an object or function, 2.3.3.3: If `then` is a function, call it with `x` as `this`, first argument `resolvePromise`, and second argument `rejectPromise` 2.3.3.3.1: If/when `resolvePromise` is called with value `y`, run `[[Resolve]](promise, y)` `y` is not a thenable `y` is `null` `then` calls `resolvePromise` synchronously via return from a fulfilled promise:</p>\n        <p style=\"color: rgb(255, 107, 104);\">Error: timeout of 200ms exceeded. Ensure the done() callback is being called in this test.</p>\n        <p style=\"color: rgb(85, 85, 85);\">at Timeout.<anonymous> (NODE_MODULES_PATH\\runnable.js:226:19)</p>\n    </li>\n</ul>\n\n剩下的就不列举了，可以看出来错误原因：run [[Resolve]](promise, y) y is not a thenable y is null then calls resolvePromise...，再往下看其余的错误原因，要么 `x` 是 null 给错了，要么就是 `y` 是 null 给错了，这个时候就知道是查验类型时的报错了~\n\n<hr />\n\n## 后记\n\n### 关于 Promise 其他功能的封装\n\n虽然上述的 Promise 实现已经符合了 Promise/A+ 的规范，但是原生的 Promise 还提供了一些其他方法，比如说这些成员方法:\n\n- catch()\n- finally()\n\n还有这些类方法：\n\n- resolve()\n- reject()\n- all()\n- race()\n\n抽空更新这些函数的实现~\n\n### 其他\n\n这算是截至 2020.01.22，个人准备时间最长、最费心的一篇 Blog，算上写这篇博客，满足 Promise/A+ 的实现已经敲了二十次了吧（大概？）。\n\n在准备的时候看到其中讲到了微服务又去看了微服务，看微服务的时候又看到了“HTTP的三次握手和四次挥手”，于是也就有了 <a href=\"https://www.wqh4u.cn/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/\">这篇博客</a> 的诞生。\n\n快过年了🎉🎉🎉，给 2020 年所有看到这篇 Blog 的人说一声新年快乐（这句话是在 2020-01-22 04:11 时写下的）\n\n<span class=\"red-target\">若需转载，请一定注明来源！</span>\n\n（下次更新一个关于微服务的？）\n","source":"_posts/原生JavaScript实现Promise.md","raw":"---\ntitle: 原生JavaScript实现Promise\ndate: 2020-01-21 18:17:36\ntags:\n- Web\n- JavaScript\ncategories:\n- 前端\n- 面经\n- JavaScript\ncopyright: true\n---\n\n> <span class = 'introduction'>孤单一人的时间使自己变得优秀，给来的人一个惊喜，也给自己一个好的交代。</span><br/>\nPromise 是前端面试中的高频问题，如果能根据 Promise A+ 规范，写出符合规范的源码，那么对于面试中的 Promise 相关的问题，都能够给出比较完美的答案。\n<span class=\"introduction\">长文警告！</span>\n\n<!--more-->\n\n<hr/>\n\n## 前言\n\n此篇博客实操性极强，单纯的阅读是行不通的！\n\n直至博客发布日，Euphoria 已将 Promise 的实现前前后后敲了快二十遍，最快（仅包含 constructor，then，resolvePromise 方法与测试）只需要七分钟，同时通过了 `promises-aplus-tests` 测试 <del>闲得无聊</del>。\n\nEuphoria 建议需要完全理解下面要介绍的 Promise A+ 规范，对照规范多写几次实现。\n\n<hr />\n\n## 为什么会出现 Promise A+ 规范\n\n### 规范出现的原因\n\n在编写 JavaScript 程序时，经常会用到异步，但往往在异步请求数据时，我们并不知道什么时候会返回数据。这对需要处理异步在返回数据之后的逻辑造成了困难，因此我们需要用到 **回调函数**。\n\n然而有时候，我们需要在回调函数中再次嵌套一个异步操作，这个异步操作就又需要一个回调函数...\n\n就这样，形成了 <span class=\"red-target\">回调地狱</span>。\n\n```javascript\n// jQuery\n$http.get('localhost:8080').success((data, status, config, headers) => {\n    setTimeout(() => {\n        $(element).fadeIn(1000, function() {\n            // 回调地狱\n            $(this).fadeOut(1000);\n        });\n    });\n}).error((data, status, config, headers) => {\n    \n});\n```\n\n正是为了杜绝以上两种情况的出现，<a href=\"https://promisesaplus.com/\">Promise/A+</a> 规范诞生了。\n\n<hr />\n\n## 什么是 Promise/A+ 规范\n\n<div class=\"note info\"><b>An open standard for sound, interoperable JavaScript promises—by implementers, for implementers.</b></div>\n\n一个 Promise 表示异步操作的最终结果，与 promise 进行交互主要是通过其 `then` 方法，该方法传入的回调函数以接收 promise 的最终值或 promise 失败的原因。\n\n<a href=\"https://promisesaplus.com/\">Promise/A+</a> 规范详细地介绍了 `then` 方法的行为，提供了可互操作的基础，所有 <a href=\"https://promisesaplus.com/\">Promise/A+</a> 兼容的 Promise 实现都可以依靠该基础来提供。\n\n因此，该规范被认为是非常稳定的。\n\n从历史上看，<a href=\"https://promisesaplus.com/\">Promise/A+</a> 阐明了早期的 <a href=\"http://wiki.commonjs.org/wiki/Promises/A\">Promise/A</a> 提案的行为条款。\n\n核心的 <a href=\"https://promisesaplus.com/\">Promise/A+</a> 是专注于提供一种可以互操作的 `then` 方法。\n\n<hr />\n\n## Promise/A+ 规范解读\n\n以下内容是源自 <a href=\"https://promisesaplus.com/\">Promise/A+</a> 官网的翻译版本 + 个人理解版本，英语好的朋友可以自行阅读 <a href=\"https://promisesaplus.com/\">Promise/A+</a> 官方文档。\n\n### Terminology\n\n**1.1.** \"promise\" 是一个符合本规范的，并具有 `then` 方法的一个对象或函数\n\n**1.2.** \"thenable\" 是一个具有 `then` 方法的对象或函数\n\n**1.3.** \"value\" 可以是任何一个合法的 JavaScript 值，包括 `undefined`、一个 *thenable* 或一个 promise\n\n**1.4.** \"exception\" 是一个使用 `throw` 关键字所抛出的值\n\n**1.5.** \"reason\" 是表明这个 promise 被 reject 的原因\n\n### Requirements\n\n#### Promise States\n\n一个 promise 必须处于以下三个状态之一：`pending`、`fulfilled` 或 `rejected`\n\n**2.1.1.** 当处于 `pending` 态时，一个 promise：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.1.1.1.</b> 可能会转换为 <code>fulfilled</code> 或 <code>rejected</code> 状态</li>\n</ul>\n\n**2.1.2.** 当处于 `fulfilled` 时，一个 promise：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.1.2.1.</b> 它绝不会再转变为其他状态</li>\n    <li><b>2.1.2.2.</b> 它必须存在一个不可被改变的 <em>value</em> 值，以此表明成功时的值</li>\n</ul>\n\n**2.1.3.** 当处于 `rejected` 时，一个 promise：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.1.3.1.</b> 它绝不会再转变为其他状态</li>\n    <li><b>2.1.3.2.</b> 它必须存在一个不可被改变的 <em>reason</em> 值，以此表明其失败的原因</li>\n</ul>\n\n#### The `then` Method\n\n一个 promise 必须提供一个 `then` 方法去访问其最终成功时的值或其失败的原因。\n\n一个 promise 的 `then` 方法可以接收两个参数：\n\n```javascript\npromise.then(onFulfilled, onRejected)\n```\n\n**2.2.1.** 这两个参数都是可选的参数：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.2.1.1.</b> 如果 <code>onFulfilled</code> 不是一个函数，那么必须忽略</li>\n    <li><b>2.2.1.2.</b> 如果 <code>onRejected</code> 不是一个函数，那么必须忽略</li>\n</ul>\n\n**2.2.2.** 如果 `onFulfilled` 是一个函数：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.2.2.1.</b> 它必须在 promise 状态变为 <code>fulfilled</code> 之后调用，并使用 <em>value</em> 的值作为其第一个参数</li>\n    <li><b>2.2.2.2.</b> 它绝不能在 promise 状态变为 <code>fulfilled</code> 之前调用</li>\n    <li><b>2.2.2.3.</b> 它的调用次数绝不能超过一次</li>\n</ul>\n\n**2.2.3.** 如果 `onFulfilled` 是一个函数：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.2.3.1.</b> 它必须在 promise 状态变为 <code>rejected</code> 之后调用，并使用 <em>value</em> 的值作为其第一个参数</li>\n    <li><b>2.2.3.2.</b> 它绝不能在 promise 状态变为 <code>rejected</code> 之前调用</li>\n    <li><b>2.2.3.3.</b> 它的调用次数绝不能超过一次</li>\n</ul>\n\n**2.2.4.** `onFulfilled` 和 `onRejected` 在 <a href=\"https://es5.github.io/#x10.3\">执行上下文</a> 堆栈仅包含平台代码前不得调用 [<a href=\"#point-3-1\">3.1</a>]\n\n**2.2.5.** `onFulfilled` 和 `onRejected` 必须作为函数去调用（即使没有 *value* 值）[<a href=\"#point-3-2\">3.2</a>]\n\n**2.2.6.** `then` 方法可能在同一个 promise 中被多次调用：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.2.6.1.</b> 如果/当 promise 被 fulfilled 了，那么所有相应的 <code>onFulfilled</code> 回调函数必须按照其对应 <code>then</code> 函数调用顺序依次执行</li>\n    <li><b>2.2.6.2.</b> 如果/当 promise 被 rejected 了，那么所有相应的 <code>onRejected</code> 回调函数必须按照其对应 <code>then</code> 函数调用顺序依次执行</li>\n</ul>\n\n**2.2.7.** `then` 方法必须返回一个 promise [<a href=\"#point-3-3\">3.3</a>]：\n\n```javascript\npromise2 = promise1.then(onFulfilled, onRejected);\n```\n\n<ul style=\"list-style: none;\">\n    <li><b>2.2.7.1.</b> 如果 <code>onFulfilled</code> 或 <code>onRejected</code> 其中一个返回了值 <code>x</code>，则需要运行 Promise 解决程序 <code>[[Resolve]](promise2, x)</code></li>\n    <li><b>2.2.7.2.</b> 如果 <code>onFulfilled</code> 或 <code>onRejected</code> 其中抛出了一个异常 <code>e</code>，则 promise2 必须以 <code>e</code> 为缘由被 <em>reject</em></li>\n    <li><b>2.2.7.3.</b> 如果 <code>onFulfilled</code> 不是一个函数，并且 promise1 已经处于成功态，那么 promise2 必须以与 promise1 的 <em>value</em> 相同的值被 <em>resolve</em></li>\n    <li><b>2.2.7.4.</b> 如果 <code>onRejected</code> 不是一个函数，并且 promise1 已经处于失败态，那么 promise2 必须以与 promise1 的 <em>reason</em> 相同的值被 <em>reject</em></li>\n</ul>\n\n#### The Promise Resolution Procedure\n\nPromise 解决程序是一个抽象的操作 <code>[[Resolve]](promise2, x)</code>，其输入一个 promise 和一个值 `x`。\n\n**2.3.1.** 如果 promise2 和 `x` 是同一个对象，那么令 promise2 为 *reject*，并以 `TypeError` 作为原因\n\n**2.3.2.** 如果 `x` 恰好是一个 Promise 对象，那么采用它的状态 [<a href=\"#point-3-4\">3.4</a>]：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.3.2.1.</b> 如果 <code>x</code> 处于 <em>pending</em> 态，那么 promise2 也要处于 <em>pending</em> 态，直到 <code>x</code> 变成了 <em>fulfilled</em> 态或者 <em>rejected</em> 态</li>\n    <li><b>2.3.2.2.</b> 如果 <code>x</code> 处于 <em>fulfilled</em> 态，那么 promise2 也以与 <code>x</code> 同样的 <em>value</em> 被 <em>resolve</em></li>\n    <li><b>2.3.2.3.</b> 如果 <code>x</code> 处于 <em>rejected</em> 态，那么 promise2 也以与 <code>x</code> 同样的 <em>reason</em> 被 <em>reject</em></li>\n</ul>\n\n**2.3.3.** 否则，如果 `x` 是一个对象或函数：\n\n<ul style=\"list-style: none;\">\n    <li><b>2.3.3.1.</b> 新建一个变量 <code>then</code>，令其等于 <code>x.then</code> [<a href=\"#point-3-5\">3.5</a>]</li>\n    <li><b>2.3.3.2.</b> 如果在 <code>x.then</code> 中抛出了一个异常 <code>e</code>，那么 promise2 将会以 <code>e</code> 被 <em>reject</em></li>\n    <li><b>2.3.3.3.</b> 如果 <code>then</code> 是一个函数，那么以 <code>x</code> 为函数中的 <code>this</code> 去调用它，与普通的 <code>then</code> 方法相同，其接收两个参数：<code>onFulfilled</code> 和 <code>onRejected</code>：</li>\n    <li>\n        <ul style=\"list-style: none;\">\n            <li><b>2.3.3.3.1.</b> 如果/当 <code>onFulfilled</code> 被调用了，并且传入的参数是 <code>y</code>，那么再次调用 <code>[[Resolve]](promise2, y)</code></li>\n            <li><b>2.3.3.3.2.</b> 如果/当 <code>onRejected</code> 被调用了，并且传入的参数是 <code>r</code>，那么 promise2 需要以 <code>r</code> 为 <em>reason</em> 被 <em>reject</em></li>\n            <li><b>2.3.3.3.3.</b> 如果同时调用了 <code>onFulfilled</code> 与 <code>onRejected</code>，或者对同一个函数进行了多次调用，则只执行第一次调用，其余的所有调用都应当被忽略</li>\n            <li><b>2.3.3.3.4.</b> 如果在调用 <code>then</code> 时抛出了异常 <code>e</code>：</li>\n            <li>\n                <ul style=\"list-style: none;\">\n                    <li><b>2.3.3.3.4.1.</b> 如果 <code>onFulfilled</code> 或 <code>onRejectde</code> 已经被调用过了，则忽略这个异常</li>\n                    <li><b>2.3.3.3.4.2.</b> 否则，以 <code>e</code> 为 <em>reason</em>，令 promise2 被 <em>reject</em></li>\n                </ul>\n            </li>\n        </ul>\n    </li>\n    <li><b>2.3.3.4.</b> 如果 <code>then</code> 不是一个函数，那么将 <code>x</code> 作为 <em>value</em>，令 promise2 被 <em>resolve</em></li>\n</ul>\n\n**2.3.4.** 如果 <code>x</code> 不是一个函数或对象，那么将 <code>x</code> 作为 <em>value</em>，令 promise2 被 <em>resolve</em>\n\n如果 promise2 被一个循环的 *thenable* *resolve* 了，这样会因为 `[[Resolve]](promise, thenable)` 的递归性质最终再次调用 `[[Resolve]](promise, thenable)`，遵循上述算法将会导致递归没有出口。<a href=\"https://promisesaplus.com/\">Promise/A+</a> 规范鼓励（但不是必须的）去检测这种递归，并以 `TypeError` 为 *reason* 使得当前递归栈顶中的 promise 被 *reject*。[<a href=\"#point-3-6\">3.6</a>]\n\n### Notes\n\n<a name=\"point-3-1\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.1.</b></a> 这里的“平台代码”是指 JS 引擎、环境和 promise 实现代码。实际上，这一要求确保 `onFulfilled` 和 `onRejected` 在调用 `then` 事件循环之后，使用一个新的堆栈去异步执行。这可以通过“宏任务”机制（例如 <a href=\"https://html.spec.whatwg.org/multipage/webappapis.html#timers\">setTimeout</a> 或 <a href=\"https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/setImmediate/Overview.html#processingmodel\">setImmediate</a>）或通过“微任务”机制（例如 <a href=\"https://dom.spec.whatwg.org/#interface-mutationobserver\">MutationObserver</a> 或 <a href=\"https://nodejs.org/api/process.html#process_process_nexttick_callback\">process.nextTick</a>）。由于 promise 的实现被视为了平台代码，因此它本身可能包含一个任务调度队列或调用处理程序的“蹦床”。\n\n<a name=\"point-3-2\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.2.</b></a> 也就是说，在 JavaScript 的严格模式下，`undefined` 可能会作为 `this` 的值出现，然而在非严格模式下，它将会作为一个全局变量。\n\n<a name=\"point-3-3\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.3.</b></a> promise 的实现可以允许 `promise2 === promise1`（即：`promise2 === x`），前提是应当满足所有的要求。每个实现都应该记录它是否可以生成 `promise2 === promise1` 以及在什么条件下会生成 `promise1`。\n\n<a name=\"point-3-4\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.4.</b></a> 一般来说，只有当 `x` 来自于当前的 promise 时，才可以知道它是一个真正的 promise。该条款允许使用特定的手段来采用一些已知且一致的 promise 状态。\n\n<a name=\"point-3-5\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.5.</b></a> 这个过程首先存储了 `x.then` 的引用，然后测试这个引用（是否是一个函数），然后再调用这个引用。避免了对 x.then 属性的访问。这些预防措施对于确保访问器属性的一致性非常重要，因为访问器属性的值可能在两次检索之间发生变化。\n\n<a name=\"point-3-6\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.6.</b></a> 实现不应该对递归循环链的深度做限制，并且假设超过该任意递归限制将会是无线的递归。只有真正的循环才会导致 `TypeError`；如果遇到了无限长的非重复的链，则永远的去递归其正确的行为。\n\n<hr />\n\n## 实现\n\n### 创建 Promise 类\n\n根据术语 1，promise 是一个有 then 方法的对象或者是函数，行为遵循本规范。那么就创建一个类（ES6 写法，下同）：\n\n```javascript\nclass Promise {\n    \n}\n```\n\n### 完善 Promise 的状态\n\n根据规范 2.1，Promise 必须处于以下三个状态之一: pending, fulfilled 或者是 rejected：\n\n```javascript\nconst PENDING = 'pending';\nconst FULFILLED = 'fulfilled';\nconst REJECTED = 'rejected';\n\nclass Promise {\n    \n}\n```\n\n### 完善构造器\n\n根据原生 Promise，在 new 的时候需要传入一个 **executor** 执行器，这个执行器会在 new 返回这个 Promise 实例之前被调用。\n\n在构造器中，令这个 Promise 实例的状态处于 *PENDING* 态。\n\n**executor** 构造器接收两个参数，*resolve* 和 *reject*，他们两个都是函数：\n\n- *resolve* 接收一个参数 *value*，代表当前 Promise 成功时的值（术语 3）\n- *reject* 接收一个参数 *reason*，代表当前 Promise 失败的原因（术语 5）\n\n根据规则 2.1.1、2.1.2、2.1.3，在调用 *resolve* 或 *reject* 时，如果当前 Promise 的状态是 *PENDING* 态，那么应该转换成对应的 *FULFILLED* 或 *REJECTED*。\n\n根据原生 Promise 得知，如果 **executor** 在执行中抛出了一个异常，那么当前 promise 则要进入失败态：\n\n```javascript\nconst PENDING = 'pending';\nconst FULFILLED = 'fulfilled';\nconst REJECTED = 'rejected';\n\nclass Promise {\n    constructor(executor) {\n        this.status = PENDING;\n        \n        // 使用箭头函数是为了保证 this 的一致性\n        let resolve = value => {\n            if (this.status === PENDING) {\n                this.status = FULFILLED;\n                this.value = value;\n            }\n        };\n        \n        let reject = reason => {\n            if (this.status === PENDING) {\n                this.status = REJECTED;\n                this.reason = reason;\n            }\n        };\n        \n        try {\n            executor(resolve, reject);\n        } catch (e) {\n            reject(e);\n        }\n    }\n}\n```\n\n### 构造 then 方法\n\n根据规则 2.2.1，`then` 方法接收两个参数 `onFulfilled` 和 `onRejected`：\n\n```javascript\n// 上面省略，then 方法是一个成员函数\nthen(onFulfilled, onRejected) {\n    \n}\n// 下面省略\n```\n\n### then 方法的参数\n\n根据规则 2.2.5、2.2.7.3、2.2.7.4，需要对传入的 `onFulfilled` 和 `onRejected` 的类型进行判断：\n\n```javascript\nthen(onFulfilled, onRejected) {\n    onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;\n    onRejected = typeof onRejected === 'function' ? onRejected : reason => { throw reason; };\n}\n```\n\n### then 方法的返回值\n\n根据规则 2.2.7，`then` 方法会返回一个新的 Promise 实例 `promise2`：\n\n```javascript\nthen(onFulfilled, onRejected) {\n    onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;\n    onRejected = typeof onRejected === 'function' ? onRejected : reason => { throw reason; };\n    \n    let promise2 = new Promise((resolve, reject) => {\n        \n    });\n    \n    return promise2;\n}\n```\n\n### 实现返回的新的 Promise 实例\n\n根据规则 2.2.2、2.2.3，需要对原先的 promise（即调用 `then` 方法的 `this`）的状态进行判断，以此来确定 `promise2` 的状态。\n\n根据规则 2.2.4，需要以异步的方式去执行 `onFulfilled` 和 `onRejected`（这里统一采用 `setTimeout`）。\n\n<div class=\"note info\">setTimeout() 可以省略第二个参数，只传入第一个回调函数作为参数，但是由于 JS 引擎与硬件等原因，不可能达到完全的 0ms 立即执行，往往会有一个最小时间（浏览器中通常是 4ms）</div>\n\n```javascript\nthen(onFulfilled, onRejected) {\n    onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;\n    onRejected = typeof onRejected === 'function' ? onRejected : reason => { throw reason; };\n    \n    let promise2 = new Promise((resolve, reject) => {\n        // 这里如果不使用箭头函数，这个 this 的值就会变成 promise2\n        // 如果使用 function，请在此之前使用 let self = this; 去存储一个 promise 的引用\n        if (this.status === FULFILLED) {\n            // Promise/A+ 2.2.4 --- setTimeout\n            setTimeout(() => {\n                onFulfilled(this.value);\n            });\n        } else if (this.status === REJECTED) {\n            setTimeout(() => {\n                onRejected(this.reason);\n            });\n        } else {\n            \n        }\n    });\n    \n    return promise2;\n}\n```\n\n### 利用发布订阅解决 PENDING 态的问题\n\n在我的 <a href=\"https://www.wqh4u.cn/2020/01/14/JavaScript%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/\">这篇博客</a> 中解释了什么是发布订阅哦~\n\n根据规则 2.2.6.1、2.2.6.2，如果当前调用 `then` 的 promise 实例还处于 *PENDING* 态，那么所有相应的 `onFulfilled` 和 `onRejected` 都需要等到这个 promise 实例被完成时（改变状态时），去依次执行（这里也解决了同一个 promise 实例多次调用 `then` 方法的问题）。\n\n这其实就用到了 **“发布订阅”** 的思想，首先将所有的 `onFulfilled` 和 `onRejected` 存储起来（订阅），等到 promise 实例的状态改变时（发布），依次调用订阅的回调函数（广播）。\n\n首先修改构造器，增加两个属性去接收订阅的回调函数：\n\n```javascript\nclass Promise {\n    constructor(executor) {\n        this.status = PENDING;\n        \n        // 增加两个属性\n        this.onFulfilledCallback = [];\n        this.onRejectedCallback = [];\n        \n        // 以下省略...\n    }\n}\n```\n\n然后修改 `then` 中的方法：\n\n```javascript\nthen(onFulfilled, onRejected) {\n    onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;\n    onRejected = typeof onRejected === 'function' ? onRejected : reason => { throw reason; };\n    \n    let promise2 = new Promise((resolve, reject) => {\n        if (this.status === FULFILLED) {\n            setTimeout(() => {\n                onFulfilled(this.value);\n            });\n        } else if (this.status === REJECTED) {\n            setTimeout(() => {\n                onRejected(this.reason);\n            });\n        } else {\n            // 当 this.status === PENDING 时，需要将回调函数进行存储\n            // 因为 “发布订阅” 最后是逐个调用订阅回调的，所以这里要 push 一个函数\n            this.onFulfilledCallback.push(() => {\n                // 又因为规则 2.2.4，即使存储了 onFulfilled 和 onRejected，也要去异步的执行\n                setTimeout(() => {\n                    onFulfilled(this.value);\n                });\n            });\n            this.onRejectedCallback.push(() => {\n                setTimeout(() => {\n                    onRejected(this.reason);\n                });\n            });\n        }\n    });\n    \n    return promise2;\n```\n\n最后修改构造器中的 *resolve* 和 *reject*，因为它们的调用会造成 promise 状态的改变，既然状态发生了改变，则需要去对订阅者 **发布广播** ：\n\n```javascript\nclass Promise {\n    constructor(executor) {\n        // 以上省略...\n        \n        let resolve = value => {\n            if (this.status === PENDING) {\n                this.status = FULFILLED;\n                this.value = value;\n                // publish\n                this.onFulfilledCallback.forEach(value => value());\n                // 注意这个 value 值，它只是 forEach 回调的第一个参数哦\n            }\n        };\n        \n        let reject = reason => {\n            if (this.status === PENDING) {\n                this.status = REJECTED;\n                this.reason = reason;\n                // publish\n                this.onRejectedCallback.forEach(value => value());\n            }\n        };\n        \n        // 以下省略...\n    }\n}\n```\n\n### 定义 Promise Resolution Procedure\n\n根据规则 2.3，我们需要一个承诺解决函数 promiseResolutionProcedure()，我们令其接收四个参数：\n\n- promise2：为 `then` 方法应当返回的值，即 promise2（本身也是对他进行处理）\n- x：为 `then` 中，调用 `then` 方法的 promise 实例（就是 `this`）的 `onFulfilled` 和 `onRejected` 的返回值，因为其的可能性太多，所以需要 romise Resolution Procedure 去处理\n- resolve：为传入 promise2 的构造器中 **executor** 的第一个参数\n- reject：为传入 promise2 的构造器中 **executor** 的第二个参数\n\n这里传入 *resolve* 和 *reject* 的原因之一是方便对 promise2 进行状态确定的处理：\n\n```javascript\nclass Promise {\n    // 省略\n}\n\nfunction promiseResolutionProcedure(promise2, x, resolve, reject) {  \n    // 暂时不写\n}\n```\n\n### 完善 then 方法\n\n根据规则 2.2.7.1 和 2.2.7.2 得知：\n\n- **2.2.7.1** `onFulfilled` 和 `onRejected` 都是会有返回值 `x` 的，并且需要对这个 x 进行 Promise Resolution Procedure\n- **2.2.7.2** 如果在 `onFulfilled` 和 `onRejected` 中抛出了异常 `e`，那么 promise2 需要以 `e` 为 *reason* 被 *reject*\n\n这里不要忘了，因为是对所有的 `onFulfilled` 和 `onRejected` 进行处理，所以在 promise.status 为 *PENDING* 态时，也要写进去奥：\n\n```javascript\n// 以上省略...\n\nthen(onFulfilled, onRejected) {\n    onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;\n    onRejected = typeof onRejected === 'function' ? onRejected : reason => { throw reason; };\n    \n    let promise2 = new Promise((resolve, reject) => {\n        if (this.status === FULFILLED) {\n            setTimeout(() => {\n                // 首先根据 2.2.7.2，需要对 onFulfilled 和 onRejected 进行异常处理\n                try {\n                    // 又因为 2.2.7.1，onFulfilled 和 onRejected 都可能返回一个 x\n                    // 这时候需要对 x 进行捕获\n                    let x = onFulfilled(this.value);\n                    // 捕获完了后就要对 x 的值进行分析\n                    // 此时需要调用 Promise Resolution Procedure\n                    promiseResolutionProcedure(promise2, x, resolve, reject);\n                    // 不用担心这里由于 promise2 是由 let 定义的，从而导致这一句 promise2 的值是 undefined\n                    // 因为这块代码是异步执行，在真正执行到这里时对 promise2 的定义早都完了\n                } catch (e) {\n                    reject(e); // 这个 reject 是 promise2 的 reject，不要搞混了\n                }\n                // 下同，对每一个 onFulfilled 和 onRejected 都要处理\n            });\n        } else if (this.status === REJECTED) {\n            setTimeout(() => {\n                try {\n                    let x = onRejected(this.reason);\n                    promiseResolutionProcedure(promise2, x, resolve, reject);\n                } catch (e) {\n                    reject(e);\n                }\n            });\n        } else {\n            this.onFulfilledCallback.push(() => {\n                setTimeout(() => {\n                    try {\n                        let x = onFulfilled(this.value);\n                        promiseResolutionProcedure(promise2, x, resolve, reject);\n                    } catch (e) {\n                        reject(e);\n                    }\n                });\n            });\n            this.onRejectedCallback.push(() => {\n                setTimeout(() => {\n                    try {\n                        let x = onRejected(this.reason);\n                        promiseResolutionProcedure(promise2, x, resolve, reject);\n                    } catch (e) {\n                        reject(e);\n                    }\n                });\n            });\n        }\n    });\n    \n    return promise2;\n}\n\n// 以下省略...\n```\n\n### 最难的 Promise Resolution Procedure\n\n根据规范 2.3.1，如果 promise2 和 x 是全等的，那么 promise2 应该以 `TypeError('Chaining cycle')` 被 *reject*。\n\n因为一个 promise 对象也是属于 `object` 或一个 `function` 的，所以在执行规范 2.3.2 之前需要去验证规范 2.3.3，即 `x` 是否为一个对象或者函数。\n\n<div class=\"note danger\">注意一点，在神奇的 JavaScript 中，<code>typeof null === 'object'</code></div>\n\n根据规范 2.3.4，如果 `x` 既不是对象也不是函数，那么 promise2 应该处于成功态（被 <em>resolve</em>），且 <em>value</em> 值为 `x`：\n\n```javascript\n// 以上省略...\nfunction promiseResolutionProcedure(promise2, x, resolve, reject) {\n    // Promise/A+ 2.3.1\n    if (promise2 === x) {\n        reject(new TypeError('Chaining cycle'));\n    }\n    \n    // Promise/A+ 2.3.3\n    if (x && typeof x === 'object' || typeof x === 'function') {\n        // 这里由于运算符优先级的问题，不能将 object 和 function 颠倒！\n    } else {\n        // Promise/A+ 2.3.4\n        resolve(x);\n    }\n}\n```\n\n现在就该检查 `x` 是不是一个 *thenable* 了。\n\n根据规范 2.3.3.1，令 `then` 变量与 `x.then` 同引用。\n\n根据规范 2.3.3.3，如果同时调用 `onFulfilled` 和 `onRejected`，或者对同一参数进行了多次调用，则第一个调用优先，而所有其他调用均被忽略，所以需要维护一个值，去判断是否为第一次调用。\n\n根据规范 2.3.3.2，如果在检索 `x.then` 时抛出了异常 `e`，那么 promise2 则应该以 `e` 为 *reason* 被 *reject*。\n\n根据规范 2.3.3.4，如果 `x.then` 不是一个函数（不是 <em>thenable</em>），那么 promise2 则应该以 `x` 为 <em>value</em> 被 *resolve*。\n\n根据规范 2.3.3，如果 `x.then` 是一个函数，且根据 Promise Resolution Procedure 的定义：<b>如果 x 是 <em>thenable</em>，那么最起码在 then 行为类似于一个 promise 实例的情况下，尝试对其采用 promise 实例应该有的方法，否则执行规范 2.3.3.4。</b>\n\n<div class=\"note info\">个人认为，这一步是将规范 2.3.2 结合到了 2.3.3 中去实现，因为 2.3.3 中的 x 也是一个 <em>thenable</em>，又因为 Promise Resolution Procedure 定义也说了，那么只要是一个 <em>thenable</em>，就把它当作一个 promise 实例去试试。</div>\n\n根据规范 2.3.3.3，`then` 是一个函数，那么需要用 `x` 作为调用这个 `then` 的 `this`，并且这个 `then` 接收两个参数 `onFulfilled` 和 `onRejected`。（这就是对于 Promise Resolution Procedure 定义的一个实现，不管他到底是不是真正的 promise 实例的 then 方法，传进去就是了）\n\n根据规范 2.3.3.3.1 和 2.3.3.3.2，对传入 `then` 中的 `onFulfilled` 和 `onRejected` 进行实现：\n\n```javascript\nfunction promiseResolutionProcedure(proemise2, x, resolve, reject) {\n    if (promise2 === x) {\n        reject(new TypeError('Chaining cycle'));\n    }\n    \n    if (x && typeof x === 'object' || typeof x === 'function') {\n        // Promise/A+ 2.3.3.3\n        let used = false;\n        try {\n            // Promise/A+ 2.3.3.1\n            let then = x.then;\n            \n            // Promise/A+ 2.3.3.4\n            if (typeof x === 'function') {\n                // Promise/A+ 2.3.3.3\n                // Promise Resolution Procedure\n                then.call(x, y => {\n                    // Promise/A+ 2.3.3.3.1\n                    if (used) return;\n                    used = true;\n                    promiseResolutionProcedure(promise2, y, resolve, reject);\n                }, reason => {\n                    // Promise/A+ 2.3.3.3.2\n                    if (used) return;\n                    used = true;\n                    reject(reason);\n                });\n            } else {\n                if (used) return;\n                used = true;\n                resolve(x);\n            }\n        } catch (e) {\n            // Promise/A+ 2.3.3.2\n            if (used) return;\n            used = true;\n            reject(e);\n        }\n    } else {\n        resolve(x);\n    }\n}\n```\n\n<hr />\n\n## 测试\n\n### 准备工作\n\n#### 导出模块\n\n如果你的 Promise 代码在一个单独的文件（比如 Promise.js）中，那么需要使用 Node.js 中导出模块：\n\n```javascript\nclass Promise {\n    // 省略...\n}\n\nfunction promiseResolutionProcedure(promise2, x, resolve, reject) {\n    // 省略...\n}\n\nmodule.exports = Promise; // 导出模块\n```\n\n#### 安装测试脚本\n\n有专门的测试脚本可以测试所编写的代码是否符合 Promise/A+ 的规范：\n\n```bash\nnpm install -g promises-aplus-tests\n```\n\n#### 编写测试代码\n\n在 Promise.js 中，添加如下代码：\n\n```javascript\nclass Promise {\n    // 省略...\n}\n\nfunction promiseResolutionProcedure(promise2, x, resolve, reject) {\n    // 省略...\n}\n\nPromise.defer = Promise.deferred = function() {\n    let dfd = {};\n    dfd.promise = new Promise((resolve, reject) => {\n        dfd.resolve = resolve;\n        dfd.reject = reject;\n    });\n    return dfd;\n};\n\nmodule.exports = Promise; // 导出模块\n```\n\n如果不加的话，可以康康报错，你就懂了 /doge\n\n### 再贴一遍全部的代码吧~\n\n```javascript\n'use strict';\n\n// Promise/A+ 2.1 --- 有三个状态\nconst PENDING = 'pending';\nconst FULFILLED = 'fulfilled';\nconst REJECTED = 'rejected';\n\n// 术语 1 --- Promise 实例\nclass Promise {\n    constructor(executor) {\n        this.status = PENDING;\n\n        // Promise/A+ 2.2.6.1 --- onFulfilled 订阅\n        // Promise/A+ 2.2.6.2 --- onRejected 订阅\n        this.onFulfilledCallback = [];\n        this.onRejectedCallback = [];\n\n        // 术语 3 --- resolve 定义\n        let resolve = value => {\n            if (this.status === PENDING) {\n                // Promise/A+ 2.1.1 --- 对于 pending 态的描述\n                // Promise/A+ 2.1.2 --- 对于 fulfilled 态的描述\n                this.status = FULFILLED;\n                this.value = value;\n                // Promise/A+ 2.2.6.1 --- 当 resolve（发布）时，则需要广播\n                this.onFulfilledCallback.forEach(value => value());\n            }\n        };\n\n        // 术语 5 --- reject 定义\n        let reject = reason => {\n            if (this.status === PENDING) {\n                // Promise/A+ 2.1.1 --- 对于 pending 态的描述\n                // Promise/A+ 2.1.3 --- 对于 rejected 态的描述\n                this.status = REJECTED;\n                this.reason = reason;\n                // Promise/A+ 2.2.6.2 --- 当 reject（发布）时，则需要进行广播\n                this.onRejectedCallback.forEach(value => value());\n            }\n        };\n\n        try {\n            // 由原生 Promise 推断而来\n            executor(resolve, reject);\n        } catch (e) {\n            reject(e);\n        }\n    }\n\n    // Promise/A+ 2.2 --- then 方法\n    // Promise/A+ 2.2.1 --- then 方法接收两个参数\n    then(onFulfilled, onRejected) {\n        // Promise/A+ 2.2.5 --- 这两个参数要作为函数被调用\n        // Promise/A+ 2.2.7.3 --- 如果 onFulfilled 不是函数且 this 已 resolve，则 promise2 必须使用与相同的 value 来 resolve\n        onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : value => value;\n        // Promise/A+ 2.2.7.4 --- 如果 onFulfilled 不是函数且 this 已 reject，则 promise2 必须使用与相同的 reason 来 reject\n        onRejected = typeof onRejected === 'function' ? onRejected : reason => {\n            throw reason;\n        };\n\n        // Promise/A+ 2.2.7 --- then 方法会返回一个新的 promise 实例\n        let nextPromise = new Promise((resolve, reject) => {\n            // Promise/A+ 2.2.2 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数\n            // Promise/A+ 2.2.3 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数\n            if (this.status === FULFILLED) {\n                setTimeout(() => {\n                    // Promise/A+ 2.2.4 --- 需要以异步的方式去执行\n                    try {\n                        // Promise/A+ 2.2.7.1 --- 需要对 onFulfilled 的返回值 x 去进行 Promise Resolution Procedure\n                        let x = onFulfilled(this.value);\n                        promiseResolutionProcedure(nextPromise, x, resolve, reject);\n                    } catch (e) {\n                        // Promise/A+ 2.2.7.2 --- 如果在执行 onFulfilled 时抛异常，那么 promise2 以异常为 reason 被 reject\n                        reject(e);\n                    }\n                });\n            } else if (this.status === REJECTED) {\n                // Promise/A+ 2.2.2 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数\n                // Promise/A+ 2.2.3 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数\n                setTimeout(() => {\n                    // Promise/A+ 2.2.4 --- 需要以异步的方式去执行\n                    try {\n                        // Promise/A+ 2.2.7.1 --- 需要对 onRejected 的返回值 x 去进行 Promise Resolution Procedure\n                        let x = onRejected(this.reason);\n                        promiseResolutionProcedure(nextPromise, x, resolve, reject);\n                    } catch (e) {\n                        // Promise/A+ 2.2.7.2 --- 如果在执行 onRejected 时抛异常，那么 promise2 以异常为 reason 被 reject\n                        reject(e);\n                    }\n                });\n            } else {\n                // Promise/A+ 2.2.6.1 --- 如果还在 pending 态或多次调用，需要以 “发布订阅” 方法去解决 onFulfilled\n                this.onFulfilledCallback.push(() => {\n                    setTimeout(() => {\n                        // Promise/A+ 2.2.4 --- 需要以异步的方式去执行\n                        try {\n                            // Promise/A+ 2.2.7.1 --- 需要对 onFulfilled 的返回值 x 去进行 Promise Resolution Procedure\n                            let x = onFulfilled(this.value);\n                            promiseResolutionProcedure(nextPromise, x, resolve, reject);\n                        } catch (e) {\n                            // Promise/A+ 2.2.7.2 --- 如果在执行 onFulfilled 时抛异常，那么 promise2 以异常为 reason 被 reject\n                            reject(e);\n                        }\n                    });\n                });\n                // Promise/A+ 2.2.6.2 --- 如果还在 pending 态或多次调用，需要以 “发布订阅” 方法去解决 onRejected\n                this.onRejectedCallback.push(() => {\n                    setTimeout(() => {\n                        // Promise/A+ 2.2.4 --- 需要以异步的方式去执行\n                        try {\n                            // Promise/A+ 2.2.7.1 --- 需要对 onRejected 的返回值 x 去进行 Promise Resolution Procedure\n                            let x = onRejected(this.reason);\n                            promiseResolutionProcedure(nextPromise, x, resolve, reject);\n                        } catch (e) {\n                            // Promise/A+ 2.2.7.2 --- 如果在执行 onRejected 时抛异常，那么 promise2 以异常为 reason 被 reject\n                            reject(e);\n                        }\n                    });\n                });\n            }\n        });\n        return nextPromise;\n    }\n}\n\n// Promise/A+ 2.3 --- 定义 Promise Resolution Procedure\nfunction promiseResolutionProcedure(promise, x, resolve, reject) {\n    // Promise/A+ 2.3.1 --- 如果 promise2 和 x 是全等的，那么 promise2 应该以 TypeError('Chaining cycle') 被 reject\n    if (x === promise) {\n        reject(new TypeError('Chaining cycle'));\n    }\n\n    // Promise/A+ 2.3.3 --- x 是否是一个对象或函数\n    if (x && typeof x === 'object' || typeof x === 'function') {\n        // Promise/A+ 2.3.3.3 --- 维护一个 used，保证只调用一次 onFulfilled 或 onRejected\n        let used = false;\n        try {\n            // Promise/A+ 2.3.3.1 --- 令 then 与 x.then 同引用\n            let then = x.then;\n            if (typeof then === 'function') {\n                // Promise/A+ 2.3.3 --- 如果 then 是一个函数，则将 x 当作 promise 实例来处理\n                // Promise Resolution Procedure 定义的实现\n                // Promise/A+ 2.3.3.3 --- 以 x 为 this 去调用 then 方法，并传入两个回调函数作为参数\n                then.call(x, y => {\n                    // Promise/A+ 2.3.3.3.1 --- 继续去以 Promise Resolution Procedure 处理 y 值\n                    if (used) {\n                        return;\n                    }\n                    used = true;\n                    promiseResolutionProcedure(promise, y, resolve, reject);\n                }, reason => {\n                    // Promise/A+ 2.3.3.3.2 --- 如果失败了，那么以 reason 去将 promise2 reject\n                    if (used) {\n                        return;\n                    }\n                    used = true;\n                    reject(reason);\n                });\n            } else {\n                // Promise/A+ 2.3.3.4 --- 如果 then 不是一个函数，那么 promise2 以 x 为 value 被 resolve\n                if (used) {\n                    return;\n                }\n                used = true;\n                resolve(x);\n            }\n        } catch (e) {\n            // Promise/A+ 2.3.3.2 --- 如果检索 x.then 时抛异常，那么 promise2 应以异常值为 reason 被 reject\n            if (used) {\n                return;\n            }\n            used = true;\n            reject(e);\n        }\n    } else {\n        // Promise/A+ 2.3.4 --- 如果 x 既不是对象也不是函数，那么 promise2 以 x 为 value 被 resolve\n        resolve(x);\n    }\n}\n\nPromise.defer = Promise.deferred = function() {\n    let dfd = {};\n    dfd.promise = new Promise((resolve, reject) => {\n        dfd.resolve = resolve;\n        dfd.reject = reject;\n    });\n    return dfd;\n};\n\nmodule.exports = Promise;\n```\n\n### 开始测试\n\n控制台切到当前目录下，执行以下命令：\n\n```bash\npromises-aplus-tests ./Promise.js\n```\n\n一共 872 个测试用例（2020.01.22 版本，不知道以后会不会多），如果都 OK 了最后会告诉你：\n\n<div class=\"note success\">872 passing</div>\n\n即使不 OK，他在最后也会告诉你哪个测试点错了，比如在刚刚实现 Promise Resolution Procedure 时，特别强调了这一句话：\n\n```javascript\n// 以上省略...\nfunction promiseResolutionProcedure(promise2, x, resolve, reject) {\n    // 以上省略...\n\n    if (x && typeof x === 'object' || typeof x === 'function') {\n        // 这里由于运算符优先级的问题，不能将 object 和 function 颠倒！\n    } else {\n        \n    }\n}\n```\n\n原因也说了，`typeof null === 'object'`，那如果颠倒过来，写成这样：\n\n```javascript\n// 以上省略...\nfunction promiseResolutionProcedure(promise2, x, resolve, reject) {\n    // 以上省略...\n\n    if (x && typeof x === 'function' || typeof x === 'object') {\n        \n    } else {\n        \n    }\n}\n```\n\n再次执行测试，那么最终的结果是：\n\n<div class=\"note\">\n    <p>862 passing</p>\n    <p>10 failing</p>\n</div>\n\n再往下就是错误信息（很贴心了，还告诉你针对哪一个 Promise/A+ 规范错了）：\n\n<ul style=\"list-style: none;\">\n    <li>\n        <p>1) 2.3.3: Otherwise, if `x` is an object or function, 2.3.3.3: If `then` is a function, call it with `x` as `this`, first argument `resolvePromise`, and second argument `rejectPromise` 2.3.3.3.1: If/when `resolvePromise` is called with value `y`, run `[[Resolve]](promise, y)` `y` is not a thenable `y` is `null` `then` calls `resolvePromise` synchronously via return from a fulfilled promise:</p>\n        <p style=\"color: rgb(255, 107, 104);\">Error: timeout of 200ms exceeded. Ensure the done() callback is being called in this test.</p>\n        <p style=\"color: rgb(85, 85, 85);\">at Timeout.<anonymous> (NODE_MODULES_PATH\\runnable.js:226:19)</p>\n    </li>\n</ul>\n\n剩下的就不列举了，可以看出来错误原因：run [[Resolve]](promise, y) y is not a thenable y is null then calls resolvePromise...，再往下看其余的错误原因，要么 `x` 是 null 给错了，要么就是 `y` 是 null 给错了，这个时候就知道是查验类型时的报错了~\n\n<hr />\n\n## 后记\n\n### 关于 Promise 其他功能的封装\n\n虽然上述的 Promise 实现已经符合了 Promise/A+ 的规范，但是原生的 Promise 还提供了一些其他方法，比如说这些成员方法:\n\n- catch()\n- finally()\n\n还有这些类方法：\n\n- resolve()\n- reject()\n- all()\n- race()\n\n抽空更新这些函数的实现~\n\n### 其他\n\n这算是截至 2020.01.22，个人准备时间最长、最费心的一篇 Blog，算上写这篇博客，满足 Promise/A+ 的实现已经敲了二十次了吧（大概？）。\n\n在准备的时候看到其中讲到了微服务又去看了微服务，看微服务的时候又看到了“HTTP的三次握手和四次挥手”，于是也就有了 <a href=\"https://www.wqh4u.cn/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/\">这篇博客</a> 的诞生。\n\n快过年了🎉🎉🎉，给 2020 年所有看到这篇 Blog 的人说一声新年快乐（这句话是在 2020-01-22 04:11 时写下的）\n\n<span class=\"red-target\">若需转载，请一定注明来源！</span>\n\n（下次更新一个关于微服务的？）\n","slug":"原生JavaScript实现Promise","published":1,"updated":"2020-01-21T20:20:52.199Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn6f00182lwj50wx4q7f","content":"<blockquote>\n<p><span class=\"introduction\">孤单一人的时间使自己变得优秀，给来的人一个惊喜，也给自己一个好的交代。</span><br><br>Promise 是前端面试中的高频问题，如果能根据 Promise A+ 规范，写出符合规范的源码，那么对于面试中的 Promise 相关的问题，都能够给出比较完美的答案。<br><span class=\"introduction\">长文警告！</span></p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>此篇博客实操性极强，单纯的阅读是行不通的！</p>\n<p>直至博客发布日，Euphoria 已将 Promise 的实现前前后后敲了快二十遍，最快（仅包含 constructor，then，resolvePromise 方法与测试）只需要七分钟，同时通过了 <code>promises-aplus-tests</code> 测试 <del>闲得无聊</del>。</p>\n<p>Euphoria 建议需要完全理解下面要介绍的 Promise A+ 规范，对照规范多写几次实现。</p>\n<hr>\n\n<h2 id=\"为什么会出现-Promise-A-规范\"><a href=\"#为什么会出现-Promise-A-规范\" class=\"headerlink\" title=\"为什么会出现 Promise A+ 规范\"></a>为什么会出现 Promise A+ 规范</h2><h3 id=\"规范出现的原因\"><a href=\"#规范出现的原因\" class=\"headerlink\" title=\"规范出现的原因\"></a>规范出现的原因</h3><p>在编写 JavaScript 程序时，经常会用到异步，但往往在异步请求数据时，我们并不知道什么时候会返回数据。这对需要处理异步在返回数据之后的逻辑造成了困难，因此我们需要用到 <strong>回调函数</strong>。</p>\n<p>然而有时候，我们需要在回调函数中再次嵌套一个异步操作，这个异步操作就又需要一个回调函数…</p>\n<p>就这样，形成了 <span class=\"red-target\">回调地狱</span>。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// jQuery</span></span><br><span class=\"line\">$http.get(<span class=\"string\">'localhost:8080'</span>).success(<span class=\"function\">(<span class=\"params\">data, status, config, headers</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        $(element).fadeIn(<span class=\"number\">1000</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 回调地狱</span></span><br><span class=\"line\">            $(<span class=\"keyword\">this</span>).fadeOut(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;).error(<span class=\"function\">(<span class=\"params\">data, status, config, headers</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>正是为了杜绝以上两种情况的出现，<a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 规范诞生了。</p>\n<hr>\n\n<h2 id=\"什么是-Promise-A-规范\"><a href=\"#什么是-Promise-A-规范\" class=\"headerlink\" title=\"什么是 Promise/A+ 规范\"></a>什么是 Promise/A+ 规范</h2><div class=\"note info\"><b>An open standard for sound, interoperable JavaScript promises—by implementers, for implementers.</b></div>\n\n<p>一个 Promise 表示异步操作的最终结果，与 promise 进行交互主要是通过其 <code>then</code> 方法，该方法传入的回调函数以接收 promise 的最终值或 promise 失败的原因。</p>\n<p><a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 规范详细地介绍了 <code>then</code> 方法的行为，提供了可互操作的基础，所有 <a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 兼容的 Promise 实现都可以依靠该基础来提供。</p>\n<p>因此，该规范被认为是非常稳定的。</p>\n<p>从历史上看，<a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 阐明了早期的 <a href=\"http://wiki.commonjs.org/wiki/Promises/A\" target=\"_blank\" rel=\"noopener\">Promise/A</a> 提案的行为条款。</p>\n<p>核心的 <a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 是专注于提供一种可以互操作的 <code>then</code> 方法。</p>\n<hr>\n\n<h2 id=\"Promise-A-规范解读\"><a href=\"#Promise-A-规范解读\" class=\"headerlink\" title=\"Promise/A+ 规范解读\"></a>Promise/A+ 规范解读</h2><p>以下内容是源自 <a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 官网的翻译版本 + 个人理解版本，英语好的朋友可以自行阅读 <a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 官方文档。</p>\n<h3 id=\"Terminology\"><a href=\"#Terminology\" class=\"headerlink\" title=\"Terminology\"></a>Terminology</h3><p><strong>1.1.</strong> “promise” 是一个符合本规范的，并具有 <code>then</code> 方法的一个对象或函数</p>\n<p><strong>1.2.</strong> “thenable” 是一个具有 <code>then</code> 方法的对象或函数</p>\n<p><strong>1.3.</strong> “value” 可以是任何一个合法的 JavaScript 值，包括 <code>undefined</code>、一个 <em>thenable</em> 或一个 promise</p>\n<p><strong>1.4.</strong> “exception” 是一个使用 <code>throw</code> 关键字所抛出的值</p>\n<p><strong>1.5.</strong> “reason” 是表明这个 promise 被 reject 的原因</p>\n<h3 id=\"Requirements\"><a href=\"#Requirements\" class=\"headerlink\" title=\"Requirements\"></a>Requirements</h3><h4 id=\"Promise-States\"><a href=\"#Promise-States\" class=\"headerlink\" title=\"Promise States\"></a>Promise States</h4><p>一个 promise 必须处于以下三个状态之一：<code>pending</code>、<code>fulfilled</code> 或 <code>rejected</code></p>\n<p><strong>2.1.1.</strong> 当处于 <code>pending</code> 态时，一个 promise：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.1.1.1.</b> 可能会转换为 <code>fulfilled</code> 或 <code>rejected</code> 状态</li>\n</ul>\n\n<p><strong>2.1.2.</strong> 当处于 <code>fulfilled</code> 时，一个 promise：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.1.2.1.</b> 它绝不会再转变为其他状态</li>\n    <li><b>2.1.2.2.</b> 它必须存在一个不可被改变的 <em>value</em> 值，以此表明成功时的值</li>\n</ul>\n\n<p><strong>2.1.3.</strong> 当处于 <code>rejected</code> 时，一个 promise：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.1.3.1.</b> 它绝不会再转变为其他状态</li>\n    <li><b>2.1.3.2.</b> 它必须存在一个不可被改变的 <em>reason</em> 值，以此表明其失败的原因</li>\n</ul>\n\n<h4 id=\"The-then-Method\"><a href=\"#The-then-Method\" class=\"headerlink\" title=\"The then Method\"></a>The <code>then</code> Method</h4><p>一个 promise 必须提供一个 <code>then</code> 方法去访问其最终成功时的值或其失败的原因。</p>\n<p>一个 promise 的 <code>then</code> 方法可以接收两个参数：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">promise.then(onFulfilled, onRejected)</span><br></pre></td></tr></table></figure>\n\n<p><strong>2.2.1.</strong> 这两个参数都是可选的参数：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.2.1.1.</b> 如果 <code>onFulfilled</code> 不是一个函数，那么必须忽略</li>\n    <li><b>2.2.1.2.</b> 如果 <code>onRejected</code> 不是一个函数，那么必须忽略</li>\n</ul>\n\n<p><strong>2.2.2.</strong> 如果 <code>onFulfilled</code> 是一个函数：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.2.2.1.</b> 它必须在 promise 状态变为 <code>fulfilled</code> 之后调用，并使用 <em>value</em> 的值作为其第一个参数</li>\n    <li><b>2.2.2.2.</b> 它绝不能在 promise 状态变为 <code>fulfilled</code> 之前调用</li>\n    <li><b>2.2.2.3.</b> 它的调用次数绝不能超过一次</li>\n</ul>\n\n<p><strong>2.2.3.</strong> 如果 <code>onFulfilled</code> 是一个函数：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.2.3.1.</b> 它必须在 promise 状态变为 <code>rejected</code> 之后调用，并使用 <em>value</em> 的值作为其第一个参数</li>\n    <li><b>2.2.3.2.</b> 它绝不能在 promise 状态变为 <code>rejected</code> 之前调用</li>\n    <li><b>2.2.3.3.</b> 它的调用次数绝不能超过一次</li>\n</ul>\n\n<p><strong>2.2.4.</strong> <code>onFulfilled</code> 和 <code>onRejected</code> 在 <a href=\"https://es5.github.io/#x10.3\" target=\"_blank\" rel=\"noopener\">执行上下文</a> 堆栈仅包含平台代码前不得调用 [<a href=\"#point-3-1\">3.1</a>]</p>\n<p><strong>2.2.5.</strong> <code>onFulfilled</code> 和 <code>onRejected</code> 必须作为函数去调用（即使没有 <em>value</em> 值）[<a href=\"#point-3-2\">3.2</a>]</p>\n<p><strong>2.2.6.</strong> <code>then</code> 方法可能在同一个 promise 中被多次调用：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.2.6.1.</b> 如果/当 promise 被 fulfilled 了，那么所有相应的 <code>onFulfilled</code> 回调函数必须按照其对应 <code>then</code> 函数调用顺序依次执行</li>\n    <li><b>2.2.6.2.</b> 如果/当 promise 被 rejected 了，那么所有相应的 <code>onRejected</code> 回调函数必须按照其对应 <code>then</code> 函数调用顺序依次执行</li>\n</ul>\n\n<p><strong>2.2.7.</strong> <code>then</code> 方法必须返回一个 promise [<a href=\"#point-3-3\">3.3</a>]：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">promise2 = promise1.then(onFulfilled, onRejected);</span><br></pre></td></tr></table></figure>\n\n<ul style=\"list-style: none;\">\n    <li><b>2.2.7.1.</b> 如果 <code>onFulfilled</code> 或 <code>onRejected</code> 其中一个返回了值 <code>x</code>，则需要运行 Promise 解决程序 <code>[[Resolve]](promise2, x)</code></li>\n    <li><b>2.2.7.2.</b> 如果 <code>onFulfilled</code> 或 <code>onRejected</code> 其中抛出了一个异常 <code>e</code>，则 promise2 必须以 <code>e</code> 为缘由被 <em>reject</em></li>\n    <li><b>2.2.7.3.</b> 如果 <code>onFulfilled</code> 不是一个函数，并且 promise1 已经处于成功态，那么 promise2 必须以与 promise1 的 <em>value</em> 相同的值被 <em>resolve</em></li>\n    <li><b>2.2.7.4.</b> 如果 <code>onRejected</code> 不是一个函数，并且 promise1 已经处于失败态，那么 promise2 必须以与 promise1 的 <em>reason</em> 相同的值被 <em>reject</em></li>\n</ul>\n\n<h4 id=\"The-Promise-Resolution-Procedure\"><a href=\"#The-Promise-Resolution-Procedure\" class=\"headerlink\" title=\"The Promise Resolution Procedure\"></a>The Promise Resolution Procedure</h4><p>Promise 解决程序是一个抽象的操作 <code>[[Resolve]](promise2, x)</code>，其输入一个 promise 和一个值 <code>x</code>。</p>\n<p><strong>2.3.1.</strong> 如果 promise2 和 <code>x</code> 是同一个对象，那么令 promise2 为 <em>reject</em>，并以 <code>TypeError</code> 作为原因</p>\n<p><strong>2.3.2.</strong> 如果 <code>x</code> 恰好是一个 Promise 对象，那么采用它的状态 [<a href=\"#point-3-4\">3.4</a>]：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.3.2.1.</b> 如果 <code>x</code> 处于 <em>pending</em> 态，那么 promise2 也要处于 <em>pending</em> 态，直到 <code>x</code> 变成了 <em>fulfilled</em> 态或者 <em>rejected</em> 态</li>\n    <li><b>2.3.2.2.</b> 如果 <code>x</code> 处于 <em>fulfilled</em> 态，那么 promise2 也以与 <code>x</code> 同样的 <em>value</em> 被 <em>resolve</em></li>\n    <li><b>2.3.2.3.</b> 如果 <code>x</code> 处于 <em>rejected</em> 态，那么 promise2 也以与 <code>x</code> 同样的 <em>reason</em> 被 <em>reject</em></li>\n</ul>\n\n<p><strong>2.3.3.</strong> 否则，如果 <code>x</code> 是一个对象或函数：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.3.3.1.</b> 新建一个变量 <code>then</code>，令其等于 <code>x.then</code> [<a href=\"#point-3-5\">3.5</a>]</li>\n    <li><b>2.3.3.2.</b> 如果在 <code>x.then</code> 中抛出了一个异常 <code>e</code>，那么 promise2 将会以 <code>e</code> 被 <em>reject</em></li>\n    <li><b>2.3.3.3.</b> 如果 <code>then</code> 是一个函数，那么以 <code>x</code> 为函数中的 <code>this</code> 去调用它，与普通的 <code>then</code> 方法相同，其接收两个参数：<code>onFulfilled</code> 和 <code>onRejected</code>：</li>\n    <li>\n        <ul style=\"list-style: none;\">\n            <li><b>2.3.3.3.1.</b> 如果/当 <code>onFulfilled</code> 被调用了，并且传入的参数是 <code>y</code>，那么再次调用 <code>[[Resolve]](promise2, y)</code></li>\n            <li><b>2.3.3.3.2.</b> 如果/当 <code>onRejected</code> 被调用了，并且传入的参数是 <code>r</code>，那么 promise2 需要以 <code>r</code> 为 <em>reason</em> 被 <em>reject</em></li>\n            <li><b>2.3.3.3.3.</b> 如果同时调用了 <code>onFulfilled</code> 与 <code>onRejected</code>，或者对同一个函数进行了多次调用，则只执行第一次调用，其余的所有调用都应当被忽略</li>\n            <li><b>2.3.3.3.4.</b> 如果在调用 <code>then</code> 时抛出了异常 <code>e</code>：</li>\n            <li>\n                <ul style=\"list-style: none;\">\n                    <li><b>2.3.3.3.4.1.</b> 如果 <code>onFulfilled</code> 或 <code>onRejectde</code> 已经被调用过了，则忽略这个异常</li>\n                    <li><b>2.3.3.3.4.2.</b> 否则，以 <code>e</code> 为 <em>reason</em>，令 promise2 被 <em>reject</em></li>\n                </ul>\n            </li>\n        </ul>\n    </li>\n    <li><b>2.3.3.4.</b> 如果 <code>then</code> 不是一个函数，那么将 <code>x</code> 作为 <em>value</em>，令 promise2 被 <em>resolve</em></li>\n</ul>\n\n<p><strong>2.3.4.</strong> 如果 <code>x</code> 不是一个函数或对象，那么将 <code>x</code> 作为 <em>value</em>，令 promise2 被 <em>resolve</em></p>\n<p>如果 promise2 被一个循环的 <em>thenable</em> <em>resolve</em> 了，这样会因为 <code>[[Resolve]](promise, thenable)</code> 的递归性质最终再次调用 <code>[[Resolve]](promise, thenable)</code>，遵循上述算法将会导致递归没有出口。<a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 规范鼓励（但不是必须的）去检测这种递归，并以 <code>TypeError</code> 为 <em>reason</em> 使得当前递归栈顶中的 promise 被 <em>reject</em>。[<a href=\"#point-3-6\">3.6</a>]</p>\n<h3 id=\"Notes\"><a href=\"#Notes\" class=\"headerlink\" title=\"Notes\"></a>Notes</h3><p><a name=\"point-3-1\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.1.</b></a> 这里的“平台代码”是指 JS 引擎、环境和 promise 实现代码。实际上，这一要求确保 <code>onFulfilled</code> 和 <code>onRejected</code> 在调用 <code>then</code> 事件循环之后，使用一个新的堆栈去异步执行。这可以通过“宏任务”机制（例如 <a href=\"https://html.spec.whatwg.org/multipage/webappapis.html#timers\" target=\"_blank\" rel=\"noopener\">setTimeout</a> 或 <a href=\"https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/setImmediate/Overview.html#processingmodel\" target=\"_blank\" rel=\"noopener\">setImmediate</a>）或通过“微任务”机制（例如 <a href=\"https://dom.spec.whatwg.org/#interface-mutationobserver\" target=\"_blank\" rel=\"noopener\">MutationObserver</a> 或 <a href=\"https://nodejs.org/api/process.html#process_process_nexttick_callback\" target=\"_blank\" rel=\"noopener\">process.nextTick</a>）。由于 promise 的实现被视为了平台代码，因此它本身可能包含一个任务调度队列或调用处理程序的“蹦床”。</p>\n<p><a name=\"point-3-2\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.2.</b></a> 也就是说，在 JavaScript 的严格模式下，<code>undefined</code> 可能会作为 <code>this</code> 的值出现，然而在非严格模式下，它将会作为一个全局变量。</p>\n<p><a name=\"point-3-3\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.3.</b></a> promise 的实现可以允许 <code>promise2 === promise1</code>（即：<code>promise2 === x</code>），前提是应当满足所有的要求。每个实现都应该记录它是否可以生成 <code>promise2 === promise1</code> 以及在什么条件下会生成 <code>promise1</code>。</p>\n<p><a name=\"point-3-4\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.4.</b></a> 一般来说，只有当 <code>x</code> 来自于当前的 promise 时，才可以知道它是一个真正的 promise。该条款允许使用特定的手段来采用一些已知且一致的 promise 状态。</p>\n<p><a name=\"point-3-5\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.5.</b></a> 这个过程首先存储了 <code>x.then</code> 的引用，然后测试这个引用（是否是一个函数），然后再调用这个引用。避免了对 x.then 属性的访问。这些预防措施对于确保访问器属性的一致性非常重要，因为访问器属性的值可能在两次检索之间发生变化。</p>\n<p><a name=\"point-3-6\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.6.</b></a> 实现不应该对递归循环链的深度做限制，并且假设超过该任意递归限制将会是无线的递归。只有真正的循环才会导致 <code>TypeError</code>；如果遇到了无限长的非重复的链，则永远的去递归其正确的行为。</p>\n<hr>\n\n<h2 id=\"实现\"><a href=\"#实现\" class=\"headerlink\" title=\"实现\"></a>实现</h2><h3 id=\"创建-Promise-类\"><a href=\"#创建-Promise-类\" class=\"headerlink\" title=\"创建 Promise 类\"></a>创建 Promise 类</h3><p>根据术语 1，promise 是一个有 then 方法的对象或者是函数，行为遵循本规范。那么就创建一个类（ES6 写法，下同）：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"完善-Promise-的状态\"><a href=\"#完善-Promise-的状态\" class=\"headerlink\" title=\"完善 Promise 的状态\"></a>完善 Promise 的状态</h3><p>根据规范 2.1，Promise 必须处于以下三个状态之一: pending, fulfilled 或者是 rejected：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> PENDING = <span class=\"string\">'pending'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> FULFILLED = <span class=\"string\">'fulfilled'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> REJECTED = <span class=\"string\">'rejected'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"完善构造器\"><a href=\"#完善构造器\" class=\"headerlink\" title=\"完善构造器\"></a>完善构造器</h3><p>根据原生 Promise，在 new 的时候需要传入一个 <strong>executor</strong> 执行器，这个执行器会在 new 返回这个 Promise 实例之前被调用。</p>\n<p>在构造器中，令这个 Promise 实例的状态处于 <em>PENDING</em> 态。</p>\n<p><strong>executor</strong> 构造器接收两个参数，<em>resolve</em> 和 <em>reject</em>，他们两个都是函数：</p>\n<ul>\n<li><em>resolve</em> 接收一个参数 <em>value</em>，代表当前 Promise 成功时的值（术语 3）</li>\n<li><em>reject</em> 接收一个参数 <em>reason</em>，代表当前 Promise 失败的原因（术语 5）</li>\n</ul>\n<p>根据规则 2.1.1、2.1.2、2.1.3，在调用 <em>resolve</em> 或 <em>reject</em> 时，如果当前 Promise 的状态是 <em>PENDING</em> 态，那么应该转换成对应的 <em>FULFILLED</em> 或 <em>REJECTED</em>。</p>\n<p>根据原生 Promise 得知，如果 <strong>executor</strong> 在执行中抛出了一个异常，那么当前 promise 则要进入失败态：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> PENDING = <span class=\"string\">'pending'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> FULFILLED = <span class=\"string\">'fulfilled'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> REJECTED = <span class=\"string\">'rejected'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(executor) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.status = PENDING;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 使用箭头函数是为了保证 this 的一致性</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> resolve = <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === PENDING) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.status = FULFILLED;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.value = value;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">let</span> reject = <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === PENDING) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.status = REJECTED;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.reason = reason;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            executor(resolve, reject);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">            reject(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"构造-then-方法\"><a href=\"#构造-then-方法\" class=\"headerlink\" title=\"构造 then 方法\"></a>构造 then 方法</h3><p>根据规则 2.2.1，<code>then</code> 方法接收两个参数 <code>onFulfilled</code> 和 <code>onRejected</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 上面省略，then 方法是一个成员函数</span></span><br><span class=\"line\">then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 下面省略</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"then-方法的参数\"><a href=\"#then-方法的参数\" class=\"headerlink\" title=\"then 方法的参数\"></a>then 方法的参数</h3><p>根据规则 2.2.5、2.2.7.3、2.2.7.4，需要对传入的 <code>onFulfilled</code> 和 <code>onRejected</code> 的类型进行判断：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">    onFulfilled = <span class=\"keyword\">typeof</span> onFulfilled === <span class=\"string\">'function'</span> ? onFulfilled : <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value;</span><br><span class=\"line\">    onRejected = <span class=\"keyword\">typeof</span> onRejected === <span class=\"string\">'function'</span> ? onRejected : <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123; <span class=\"keyword\">throw</span> reason; &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"then-方法的返回值\"><a href=\"#then-方法的返回值\" class=\"headerlink\" title=\"then 方法的返回值\"></a>then 方法的返回值</h3><p>根据规则 2.2.7，<code>then</code> 方法会返回一个新的 Promise 实例 <code>promise2</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">    onFulfilled = <span class=\"keyword\">typeof</span> onFulfilled === <span class=\"string\">'function'</span> ? onFulfilled : <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value;</span><br><span class=\"line\">    onRejected = <span class=\"keyword\">typeof</span> onRejected === <span class=\"string\">'function'</span> ? onRejected : <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123; <span class=\"keyword\">throw</span> reason; &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"实现返回的新的-Promise-实例\"><a href=\"#实现返回的新的-Promise-实例\" class=\"headerlink\" title=\"实现返回的新的 Promise 实例\"></a>实现返回的新的 Promise 实例</h3><p>根据规则 2.2.2、2.2.3，需要对原先的 promise（即调用 <code>then</code> 方法的 <code>this</code>）的状态进行判断，以此来确定 <code>promise2</code> 的状态。</p>\n<p>根据规则 2.2.4，需要以异步的方式去执行 <code>onFulfilled</code> 和 <code>onRejected</code>（这里统一采用 <code>setTimeout</code>）。</p>\n<div class=\"note info\">setTimeout() 可以省略第二个参数，只传入第一个回调函数作为参数，但是由于 JS 引擎与硬件等原因，不可能达到完全的 0ms 立即执行，往往会有一个最小时间（浏览器中通常是 4ms）</div>\n\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">    onFulfilled = <span class=\"keyword\">typeof</span> onFulfilled === <span class=\"string\">'function'</span> ? onFulfilled : <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value;</span><br><span class=\"line\">    onRejected = <span class=\"keyword\">typeof</span> onRejected === <span class=\"string\">'function'</span> ? onRejected : <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123; <span class=\"keyword\">throw</span> reason; &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 这里如果不使用箭头函数，这个 this 的值就会变成 promise2</span></span><br><span class=\"line\">        <span class=\"comment\">// 如果使用 function，请在此之前使用 let self = this; 去存储一个 promise 的引用</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === FULFILLED) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.2.4 --- setTimeout</span></span><br><span class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === REJECTED) &#123;</span><br><span class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"利用发布订阅解决-PENDING-态的问题\"><a href=\"#利用发布订阅解决-PENDING-态的问题\" class=\"headerlink\" title=\"利用发布订阅解决 PENDING 态的问题\"></a>利用发布订阅解决 PENDING 态的问题</h3><p>在我的 <a href=\"https://www.wqh4u.cn/2020/01/14/JavaScript%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/\">这篇博客</a> 中解释了什么是发布订阅哦~</p>\n<p>根据规则 2.2.6.1、2.2.6.2，如果当前调用 <code>then</code> 的 promise 实例还处于 <em>PENDING</em> 态，那么所有相应的 <code>onFulfilled</code> 和 <code>onRejected</code> 都需要等到这个 promise 实例被完成时（改变状态时），去依次执行（这里也解决了同一个 promise 实例多次调用 <code>then</code> 方法的问题）。</p>\n<p>这其实就用到了 <strong>“发布订阅”</strong> 的思想，首先将所有的 <code>onFulfilled</code> 和 <code>onRejected</code> 存储起来（订阅），等到 promise 实例的状态改变时（发布），依次调用订阅的回调函数（广播）。</p>\n<p>首先修改构造器，增加两个属性去接收订阅的回调函数：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(executor) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.status = PENDING;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 增加两个属性</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.onFulfilledCallback = [];</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.onRejectedCallback = [];</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 以下省略...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>然后修改 <code>then</code> 中的方法：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">    onFulfilled = <span class=\"keyword\">typeof</span> onFulfilled === <span class=\"string\">'function'</span> ? onFulfilled : <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value;</span><br><span class=\"line\">    onRejected = <span class=\"keyword\">typeof</span> onRejected === <span class=\"string\">'function'</span> ? onRejected : <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123; <span class=\"keyword\">throw</span> reason; &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === FULFILLED) &#123;</span><br><span class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === REJECTED) &#123;</span><br><span class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 当 this.status === PENDING 时，需要将回调函数进行存储</span></span><br><span class=\"line\">            <span class=\"comment\">// 因为 “发布订阅” 最后是逐个调用订阅回调的，所以这里要 push 一个函数</span></span><br><span class=\"line\">            <span class=\"keyword\">this</span>.onFulfilledCallback.push(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 又因为规则 2.2.4，即使存储了 onFulfilled 和 onRejected，也要去异步的执行</span></span><br><span class=\"line\">                setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.onRejectedCallback.push(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2;</span><br></pre></td></tr></table></figure>\n\n<p>最后修改构造器中的 <em>resolve</em> 和 <em>reject</em>，因为它们的调用会造成 promise 状态的改变，既然状态发生了改变，则需要去对订阅者 <strong>发布广播</strong> ：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(executor) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">let</span> resolve = <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === PENDING) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.status = FULFILLED;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.value = value;</span><br><span class=\"line\">                <span class=\"comment\">// publish</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.onFulfilledCallback.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value());</span><br><span class=\"line\">                <span class=\"comment\">// 注意这个 value 值，它只是 forEach 回调的第一个参数哦</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">let</span> reject = <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === PENDING) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.status = REJECTED;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.reason = reason;</span><br><span class=\"line\">                <span class=\"comment\">// publish</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.onRejectedCallback.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 以下省略...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"定义-Promise-Resolution-Procedure\"><a href=\"#定义-Promise-Resolution-Procedure\" class=\"headerlink\" title=\"定义 Promise Resolution Procedure\"></a>定义 Promise Resolution Procedure</h3><p>根据规则 2.3，我们需要一个承诺解决函数 promiseResolutionProcedure()，我们令其接收四个参数：</p>\n<ul>\n<li>promise2：为 <code>then</code> 方法应当返回的值，即 promise2（本身也是对他进行处理）</li>\n<li>x：为 <code>then</code> 中，调用 <code>then</code> 方法的 promise 实例（就是 <code>this</code>）的 <code>onFulfilled</code> 和 <code>onRejected</code> 的返回值，因为其的可能性太多，所以需要 romise Resolution Procedure 去处理</li>\n<li>resolve：为传入 promise2 的构造器中 <strong>executor</strong> 的第一个参数</li>\n<li>reject：为传入 promise2 的构造器中 <strong>executor</strong> 的第二个参数</li>\n</ul>\n<p>这里传入 <em>resolve</em> 和 <em>reject</em> 的原因之一是方便对 promise2 进行状态确定的处理：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 省略</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise2, x, resolve, reject</span>) </span>&#123;  </span><br><span class=\"line\">    <span class=\"comment\">// 暂时不写</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"完善-then-方法\"><a href=\"#完善-then-方法\" class=\"headerlink\" title=\"完善 then 方法\"></a>完善 then 方法</h3><p>根据规则 2.2.7.1 和 2.2.7.2 得知：</p>\n<ul>\n<li><strong>2.2.7.1</strong> <code>onFulfilled</code> 和 <code>onRejected</code> 都是会有返回值 <code>x</code> 的，并且需要对这个 x 进行 Promise Resolution Procedure</li>\n<li><strong>2.2.7.2</strong> 如果在 <code>onFulfilled</code> 和 <code>onRejected</code> 中抛出了异常 <code>e</code>，那么 promise2 需要以 <code>e</code> 为 <em>reason</em> 被 <em>reject</em></li>\n</ul>\n<p>这里不要忘了，因为是对所有的 <code>onFulfilled</code> 和 <code>onRejected</code> 进行处理，所以在 promise.status 为 <em>PENDING</em> 态时，也要写进去奥：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\"></span><br><span class=\"line\">then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">    onFulfilled = <span class=\"keyword\">typeof</span> onFulfilled === <span class=\"string\">'function'</span> ? onFulfilled : <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value;</span><br><span class=\"line\">    onRejected = <span class=\"keyword\">typeof</span> onRejected === <span class=\"string\">'function'</span> ? onRejected : <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123; <span class=\"keyword\">throw</span> reason; &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === FULFILLED) &#123;</span><br><span class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 首先根据 2.2.7.2，需要对 onFulfilled 和 onRejected 进行异常处理</span></span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// 又因为 2.2.7.1，onFulfilled 和 onRejected 都可能返回一个 x</span></span><br><span class=\"line\">                    <span class=\"comment\">// 这时候需要对 x 进行捕获</span></span><br><span class=\"line\">                    <span class=\"keyword\">let</span> x = onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">                    <span class=\"comment\">// 捕获完了后就要对 x 的值进行分析</span></span><br><span class=\"line\">                    <span class=\"comment\">// 此时需要调用 Promise Resolution Procedure</span></span><br><span class=\"line\">                    promiseResolutionProcedure(promise2, x, resolve, reject);</span><br><span class=\"line\">                    <span class=\"comment\">// 不用担心这里由于 promise2 是由 let 定义的，从而导致这一句 promise2 的值是 undefined</span></span><br><span class=\"line\">                    <span class=\"comment\">// 因为这块代码是异步执行，在真正执行到这里时对 promise2 的定义早都完了</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                    reject(e); <span class=\"comment\">// 这个 reject 是 promise2 的 reject，不要搞混了</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// 下同，对每一个 onFulfilled 和 onRejected 都要处理</span></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === REJECTED) &#123;</span><br><span class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">let</span> x = onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">                    promiseResolutionProcedure(promise2, x, resolve, reject);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                    reject(e);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.onFulfilledCallback.push(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">let</span> x = onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">                        promiseResolutionProcedure(promise2, x, resolve, reject);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                        reject(e);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.onRejectedCallback.push(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">let</span> x = onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">                        promiseResolutionProcedure(promise2, x, resolve, reject);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                        reject(e);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 以下省略...</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"最难的-Promise-Resolution-Procedure\"><a href=\"#最难的-Promise-Resolution-Procedure\" class=\"headerlink\" title=\"最难的 Promise Resolution Procedure\"></a>最难的 Promise Resolution Procedure</h3><p>根据规范 2.3.1，如果 promise2 和 x 是全等的，那么 promise2 应该以 <code>TypeError(&#39;Chaining cycle&#39;)</code> 被 <em>reject</em>。</p>\n<p>因为一个 promise 对象也是属于 <code>object</code> 或一个 <code>function</code> 的，所以在执行规范 2.3.2 之前需要去验证规范 2.3.3，即 <code>x</code> 是否为一个对象或者函数。</p>\n<div class=\"note danger\">注意一点，在神奇的 JavaScript 中，<code>typeof null === 'object'</code></div>\n\n<p>根据规范 2.3.4，如果 <code>x</code> 既不是对象也不是函数，那么 promise2 应该处于成功态（被 <em>resolve</em>），且 <em>value</em> 值为 <code>x</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise2, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Promise/A+ 2.3.1</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (promise2 === x) &#123;</span><br><span class=\"line\">        reject(<span class=\"keyword\">new</span> <span class=\"built_in\">TypeError</span>(<span class=\"string\">'Chaining cycle'</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Promise/A+ 2.3.3</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &amp;&amp; <span class=\"keyword\">typeof</span> x === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 这里由于运算符优先级的问题，不能将 object 和 function 颠倒！</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.3.4</span></span><br><span class=\"line\">        resolve(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>现在就该检查 <code>x</code> 是不是一个 <em>thenable</em> 了。</p>\n<p>根据规范 2.3.3.1，令 <code>then</code> 变量与 <code>x.then</code> 同引用。</p>\n<p>根据规范 2.3.3.3，如果同时调用 <code>onFulfilled</code> 和 <code>onRejected</code>，或者对同一参数进行了多次调用，则第一个调用优先，而所有其他调用均被忽略，所以需要维护一个值，去判断是否为第一次调用。</p>\n<p>根据规范 2.3.3.2，如果在检索 <code>x.then</code> 时抛出了异常 <code>e</code>，那么 promise2 则应该以 <code>e</code> 为 <em>reason</em> 被 <em>reject</em>。</p>\n<p>根据规范 2.3.3.4，如果 <code>x.then</code> 不是一个函数（不是 <em>thenable</em>），那么 promise2 则应该以 <code>x</code> 为 <em>value</em> 被 <em>resolve</em>。</p>\n<p>根据规范 2.3.3，如果 <code>x.then</code> 是一个函数，且根据 Promise Resolution Procedure 的定义：<b>如果 x 是 <em>thenable</em>，那么最起码在 then 行为类似于一个 promise 实例的情况下，尝试对其采用 promise 实例应该有的方法，否则执行规范 2.3.3.4。</b></p>\n<div class=\"note info\">个人认为，这一步是将规范 2.3.2 结合到了 2.3.3 中去实现，因为 2.3.3 中的 x 也是一个 <em>thenable</em>，又因为 Promise Resolution Procedure 定义也说了，那么只要是一个 <em>thenable</em>，就把它当作一个 promise 实例去试试。</div>\n\n<p>根据规范 2.3.3.3，<code>then</code> 是一个函数，那么需要用 <code>x</code> 作为调用这个 <code>then</code> 的 <code>this</code>，并且这个 <code>then</code> 接收两个参数 <code>onFulfilled</code> 和 <code>onRejected</code>。（这就是对于 Promise Resolution Procedure 定义的一个实现，不管他到底是不是真正的 promise 实例的 then 方法，传进去就是了）</p>\n<p>根据规范 2.3.3.3.1 和 2.3.3.3.2，对传入 <code>then</code> 中的 <code>onFulfilled</code> 和 <code>onRejected</code> 进行实现：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">proemise2, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (promise2 === x) &#123;</span><br><span class=\"line\">        reject(<span class=\"keyword\">new</span> <span class=\"built_in\">TypeError</span>(<span class=\"string\">'Chaining cycle'</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &amp;&amp; <span class=\"keyword\">typeof</span> x === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.3.3.3</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> used = <span class=\"literal\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.3.3.1</span></span><br><span class=\"line\">            <span class=\"keyword\">let</span> then = x.then;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.3.3.4</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.3.3.3</span></span><br><span class=\"line\">                <span class=\"comment\">// Promise Resolution Procedure</span></span><br><span class=\"line\">                then.call(x, y =&gt; &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Promise/A+ 2.3.3.3.1</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (used) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                    used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    promiseResolutionProcedure(promise2, y, resolve, reject);</span><br><span class=\"line\">                &#125;, reason =&gt; &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Promise/A+ 2.3.3.3.2</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (used) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                    used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    reject(reason);</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (used) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                resolve(x);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.3.3.2</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (used) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            reject(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        resolve(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><h3 id=\"准备工作\"><a href=\"#准备工作\" class=\"headerlink\" title=\"准备工作\"></a>准备工作</h3><h4 id=\"导出模块\"><a href=\"#导出模块\" class=\"headerlink\" title=\"导出模块\"></a>导出模块</h4><p>如果你的 Promise 代码在一个单独的文件（比如 Promise.js）中，那么需要使用 Node.js 中导出模块：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 省略...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise2, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 省略...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = <span class=\"built_in\">Promise</span>; <span class=\"comment\">// 导出模块</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装测试脚本\"><a href=\"#安装测试脚本\" class=\"headerlink\" title=\"安装测试脚本\"></a>安装测试脚本</h4><p>有专门的测试脚本可以测试所编写的代码是否符合 Promise/A+ 的规范：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g promises-aplus-tests</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"编写测试代码\"><a href=\"#编写测试代码\" class=\"headerlink\" title=\"编写测试代码\"></a>编写测试代码</h4><p>在 Promise.js 中，添加如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 省略...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise2, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 省略...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">Promise</span>.defer = <span class=\"built_in\">Promise</span>.deferred = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> dfd = &#123;&#125;;</span><br><span class=\"line\">    dfd.promise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        dfd.resolve = resolve;</span><br><span class=\"line\">        dfd.reject = reject;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> dfd;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = <span class=\"built_in\">Promise</span>; <span class=\"comment\">// 导出模块</span></span><br></pre></td></tr></table></figure>\n\n<p>如果不加的话，可以康康报错，你就懂了 /doge</p>\n<h3 id=\"再贴一遍全部的代码吧\"><a href=\"#再贴一遍全部的代码吧\" class=\"headerlink\" title=\"再贴一遍全部的代码吧~\"></a>再贴一遍全部的代码吧~</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">'use strict'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Promise/A+ 2.1 --- 有三个状态</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> PENDING = <span class=\"string\">'pending'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> FULFILLED = <span class=\"string\">'fulfilled'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> REJECTED = <span class=\"string\">'rejected'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 术语 1 --- Promise 实例</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(executor) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.status = PENDING;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.2.6.1 --- onFulfilled 订阅</span></span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.2.6.2 --- onRejected 订阅</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.onFulfilledCallback = [];</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.onRejectedCallback = [];</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 术语 3 --- resolve 定义</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> resolve = <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === PENDING) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.1.1 --- 对于 pending 态的描述</span></span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.1.2 --- 对于 fulfilled 态的描述</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.status = FULFILLED;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.value = value;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.2.6.1 --- 当 resolve（发布）时，则需要广播</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.onFulfilledCallback.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 术语 5 --- reject 定义</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> reject = <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === PENDING) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.1.1 --- 对于 pending 态的描述</span></span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.1.3 --- 对于 rejected 态的描述</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.status = REJECTED;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.reason = reason;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.2.6.2 --- 当 reject（发布）时，则需要进行广播</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.onRejectedCallback.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 由原生 Promise 推断而来</span></span><br><span class=\"line\">            executor(resolve, reject);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">            reject(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Promise/A+ 2.2 --- then 方法</span></span><br><span class=\"line\">    <span class=\"comment\">// Promise/A+ 2.2.1 --- then 方法接收两个参数</span></span><br><span class=\"line\">    then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.2.5 --- 这两个参数要作为函数被调用</span></span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.2.7.3 --- 如果 onFulfilled 不是函数且 this 已 resolve，则 promise2 必须使用与相同的 value 来 resolve</span></span><br><span class=\"line\">        onFulfilled = <span class=\"keyword\">typeof</span> onFulfilled === <span class=\"string\">'function'</span> ? onFulfilled : <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value;</span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.2.7.4 --- 如果 onFulfilled 不是函数且 this 已 reject，则 promise2 必须使用与相同的 reason 来 reject</span></span><br><span class=\"line\">        onRejected = <span class=\"keyword\">typeof</span> onRejected === <span class=\"string\">'function'</span> ? onRejected : <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> reason;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.2.7 --- then 方法会返回一个新的 promise 实例</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> nextPromise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.2.2 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数</span></span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.2.3 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === FULFILLED) &#123;</span><br><span class=\"line\">                setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Promise/A+ 2.2.4 --- 需要以异步的方式去执行</span></span><br><span class=\"line\">                    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Promise/A+ 2.2.7.1 --- 需要对 onFulfilled 的返回值 x 去进行 Promise Resolution Procedure</span></span><br><span class=\"line\">                        <span class=\"keyword\">let</span> x = onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">                        promiseResolutionProcedure(nextPromise, x, resolve, reject);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Promise/A+ 2.2.7.2 --- 如果在执行 onFulfilled 时抛异常，那么 promise2 以异常为 reason 被 reject</span></span><br><span class=\"line\">                        reject(e);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === REJECTED) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.2.2 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数</span></span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.2.3 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数</span></span><br><span class=\"line\">                setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Promise/A+ 2.2.4 --- 需要以异步的方式去执行</span></span><br><span class=\"line\">                    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Promise/A+ 2.2.7.1 --- 需要对 onRejected 的返回值 x 去进行 Promise Resolution Procedure</span></span><br><span class=\"line\">                        <span class=\"keyword\">let</span> x = onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">                        promiseResolutionProcedure(nextPromise, x, resolve, reject);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Promise/A+ 2.2.7.2 --- 如果在执行 onRejected 时抛异常，那么 promise2 以异常为 reason 被 reject</span></span><br><span class=\"line\">                        reject(e);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.2.6.1 --- 如果还在 pending 态或多次调用，需要以 “发布订阅” 方法去解决 onFulfilled</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.onFulfilledCallback.push(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Promise/A+ 2.2.4 --- 需要以异步的方式去执行</span></span><br><span class=\"line\">                        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                            <span class=\"comment\">// Promise/A+ 2.2.7.1 --- 需要对 onFulfilled 的返回值 x 去进行 Promise Resolution Procedure</span></span><br><span class=\"line\">                            <span class=\"keyword\">let</span> x = onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">                            promiseResolutionProcedure(nextPromise, x, resolve, reject);</span><br><span class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                            <span class=\"comment\">// Promise/A+ 2.2.7.2 --- 如果在执行 onFulfilled 时抛异常，那么 promise2 以异常为 reason 被 reject</span></span><br><span class=\"line\">                            reject(e);</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;);</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.2.6.2 --- 如果还在 pending 态或多次调用，需要以 “发布订阅” 方法去解决 onRejected</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.onRejectedCallback.push(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Promise/A+ 2.2.4 --- 需要以异步的方式去执行</span></span><br><span class=\"line\">                        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                            <span class=\"comment\">// Promise/A+ 2.2.7.1 --- 需要对 onRejected 的返回值 x 去进行 Promise Resolution Procedure</span></span><br><span class=\"line\">                            <span class=\"keyword\">let</span> x = onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">                            promiseResolutionProcedure(nextPromise, x, resolve, reject);</span><br><span class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                            <span class=\"comment\">// Promise/A+ 2.2.7.2 --- 如果在执行 onRejected 时抛异常，那么 promise2 以异常为 reason 被 reject</span></span><br><span class=\"line\">                            reject(e);</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;);</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> nextPromise;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Promise/A+ 2.3 --- 定义 Promise Resolution Procedure</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Promise/A+ 2.3.1 --- 如果 promise2 和 x 是全等的，那么 promise2 应该以 TypeError('Chaining cycle') 被 reject</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x === promise) &#123;</span><br><span class=\"line\">        reject(<span class=\"keyword\">new</span> <span class=\"built_in\">TypeError</span>(<span class=\"string\">'Chaining cycle'</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Promise/A+ 2.3.3 --- x 是否是一个对象或函数</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &amp;&amp; <span class=\"keyword\">typeof</span> x === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.3.3.3 --- 维护一个 used，保证只调用一次 onFulfilled 或 onRejected</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> used = <span class=\"literal\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.3.3.1 --- 令 then 与 x.then 同引用</span></span><br><span class=\"line\">            <span class=\"keyword\">let</span> then = x.then;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> then === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.3.3 --- 如果 then 是一个函数，则将 x 当作 promise 实例来处理</span></span><br><span class=\"line\">                <span class=\"comment\">// Promise Resolution Procedure 定义的实现</span></span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.3.3.3 --- 以 x 为 this 去调用 then 方法，并传入两个回调函数作为参数</span></span><br><span class=\"line\">                then.call(x, y =&gt; &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Promise/A+ 2.3.3.3.1 --- 继续去以 Promise Resolution Procedure 处理 y 值</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (used) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    promiseResolutionProcedure(promise, y, resolve, reject);</span><br><span class=\"line\">                &#125;, reason =&gt; &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Promise/A+ 2.3.3.3.2 --- 如果失败了，那么以 reason 去将 promise2 reject</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (used) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    reject(reason);</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.3.3.4 --- 如果 then 不是一个函数，那么 promise2 以 x 为 value 被 resolve</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (used) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                resolve(x);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.3.3.2 --- 如果检索 x.then 时抛异常，那么 promise2 应以异常值为 reason 被 reject</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (used) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            reject(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.3.4 --- 如果 x 既不是对象也不是函数，那么 promise2 以 x 为 value 被 resolve</span></span><br><span class=\"line\">        resolve(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">Promise</span>.defer = <span class=\"built_in\">Promise</span>.deferred = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> dfd = &#123;&#125;;</span><br><span class=\"line\">    dfd.promise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        dfd.resolve = resolve;</span><br><span class=\"line\">        dfd.reject = reject;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> dfd;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = <span class=\"built_in\">Promise</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"开始测试\"><a href=\"#开始测试\" class=\"headerlink\" title=\"开始测试\"></a>开始测试</h3><p>控制台切到当前目录下，执行以下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">promises-aplus-tests ./Promise.js</span><br></pre></td></tr></table></figure>\n\n<p>一共 872 个测试用例（2020.01.22 版本，不知道以后会不会多），如果都 OK 了最后会告诉你：</p>\n<div class=\"note success\">872 passing</div>\n\n<p>即使不 OK，他在最后也会告诉你哪个测试点错了，比如在刚刚实现 Promise Resolution Procedure 时，特别强调了这一句话：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise2, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &amp;&amp; <span class=\"keyword\">typeof</span> x === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 这里由于运算符优先级的问题，不能将 object 和 function 颠倒！</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>原因也说了，<code>typeof null === &#39;object&#39;</code>，那如果颠倒过来，写成这样：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise2, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &amp;&amp; <span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span> || <span class=\"keyword\">typeof</span> x === <span class=\"string\">'object'</span>) &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>再次执行测试，那么最终的结果是：</p>\n<div class=\"note\">\n    <p>862 passing</p>\n    <p>10 failing</p>\n</div>\n\n<p>再往下就是错误信息（很贴心了，还告诉你针对哪一个 Promise/A+ 规范错了）：</p>\n<ul style=\"list-style: none;\">\n    <li>\n        <p>1) 2.3.3: Otherwise, if `x` is an object or function, 2.3.3.3: If `then` is a function, call it with `x` as `this`, first argument `resolvePromise`, and second argument `rejectPromise` 2.3.3.3.1: If/when `resolvePromise` is called with value `y`, run `[[Resolve]](promise, y)` `y` is not a thenable `y` is `null` `then` calls `resolvePromise` synchronously via return from a fulfilled promise:</p>\n        <p style=\"color: rgb(255, 107, 104);\">Error: timeout of 200ms exceeded. Ensure the done() callback is being called in this test.</p>\n        <p style=\"color: rgb(85, 85, 85);\">at Timeout.<anonymous> (NODE_MODULES_PATH\\runnable.js:226:19)</anonymous></p>\n    </li>\n</ul>\n\n<p>剩下的就不列举了，可以看出来错误原因：run [[Resolve]](promise, y) y is not a thenable y is null then calls resolvePromise…，再往下看其余的错误原因，要么 <code>x</code> 是 null 给错了，要么就是 <code>y</code> 是 null 给错了，这个时候就知道是查验类型时的报错了~</p>\n<hr>\n\n<h2 id=\"后记\"><a href=\"#后记\" class=\"headerlink\" title=\"后记\"></a>后记</h2><h3 id=\"关于-Promise-其他功能的封装\"><a href=\"#关于-Promise-其他功能的封装\" class=\"headerlink\" title=\"关于 Promise 其他功能的封装\"></a>关于 Promise 其他功能的封装</h3><p>虽然上述的 Promise 实现已经符合了 Promise/A+ 的规范，但是原生的 Promise 还提供了一些其他方法，比如说这些成员方法:</p>\n<ul>\n<li>catch()</li>\n<li>finally()</li>\n</ul>\n<p>还有这些类方法：</p>\n<ul>\n<li>resolve()</li>\n<li>reject()</li>\n<li>all()</li>\n<li>race()</li>\n</ul>\n<p>抽空更新这些函数的实现~</p>\n<h3 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h3><p>这算是截至 2020.01.22，个人准备时间最长、最费心的一篇 Blog，算上写这篇博客，满足 Promise/A+ 的实现已经敲了二十次了吧（大概？）。</p>\n<p>在准备的时候看到其中讲到了微服务又去看了微服务，看微服务的时候又看到了“HTTP的三次握手和四次挥手”，于是也就有了 <a href=\"https://www.wqh4u.cn/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/\">这篇博客</a> 的诞生。</p>\n<p>快过年了🎉🎉🎉，给 2020 年所有看到这篇 Blog 的人说一声新年快乐（这句话是在 2020-01-22 04:11 时写下的）</p>\n<p><span class=\"red-target\">若需转载，请一定注明来源！</span></p>\n<p>（下次更新一个关于微服务的？）</p>\n","site":{"data":{}},"length":21802,"excerpt":"<blockquote>\n<p><span class=\"introduction\">孤单一人的时间使自己变得优秀，给来的人一个惊喜，也给自己一个好的交代。</span><br><br>Promise 是前端面试中的高频问题，如果能根据 Promise A+ 规范，写出符合规范的源码，那么对于面试中的 Promise 相关的问题，都能够给出比较完美的答案。<br><span class=\"introduction\">长文警告！</span></p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>此篇博客实操性极强，单纯的阅读是行不通的！</p>\n<p>直至博客发布日，Euphoria 已将 Promise 的实现前前后后敲了快二十遍，最快（仅包含 constructor，then，resolvePromise 方法与测试）只需要七分钟，同时通过了 <code>promises-aplus-tests</code> 测试 <del>闲得无聊</del>。</p>\n<p>Euphoria 建议需要完全理解下面要介绍的 Promise A+ 规范，对照规范多写几次实现。</p>\n<hr>\n\n<h2 id=\"为什么会出现-Promise-A-规范\"><a href=\"#为什么会出现-Promise-A-规范\" class=\"headerlink\" title=\"为什么会出现 Promise A+ 规范\"></a>为什么会出现 Promise A+ 规范</h2><h3 id=\"规范出现的原因\"><a href=\"#规范出现的原因\" class=\"headerlink\" title=\"规范出现的原因\"></a>规范出现的原因</h3><p>在编写 JavaScript 程序时，经常会用到异步，但往往在异步请求数据时，我们并不知道什么时候会返回数据。这对需要处理异步在返回数据之后的逻辑造成了困难，因此我们需要用到 <strong>回调函数</strong>。</p>\n<p>然而有时候，我们需要在回调函数中再次嵌套一个异步操作，这个异步操作就又需要一个回调函数…</p>\n<p>就这样，形成了 <span class=\"red-target\">回调地狱</span>。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// jQuery</span></span><br><span class=\"line\">$http.get(<span class=\"string\">'localhost:8080'</span>).success(<span class=\"function\">(<span class=\"params\">data, status, config, headers</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">        $(element).fadeIn(<span class=\"number\">1000</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 回调地狱</span></span><br><span class=\"line\">            $(<span class=\"keyword\">this</span>).fadeOut(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;).error(<span class=\"function\">(<span class=\"params\">data, status, config, headers</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>正是为了杜绝以上两种情况的出现，<a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 规范诞生了。</p>\n<hr>\n\n<h2 id=\"什么是-Promise-A-规范\"><a href=\"#什么是-Promise-A-规范\" class=\"headerlink\" title=\"什么是 Promise/A+ 规范\"></a>什么是 Promise/A+ 规范</h2><div class=\"note info\"><b>An open standard for sound, interoperable JavaScript promises—by implementers, for implementers.</b></div>\n\n<p>一个 Promise 表示异步操作的最终结果，与 promise 进行交互主要是通过其 <code>then</code> 方法，该方法传入的回调函数以接收 promise 的最终值或 promise 失败的原因。</p>\n<p><a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 规范详细地介绍了 <code>then</code> 方法的行为，提供了可互操作的基础，所有 <a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 兼容的 Promise 实现都可以依靠该基础来提供。</p>\n<p>因此，该规范被认为是非常稳定的。</p>\n<p>从历史上看，<a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 阐明了早期的 <a href=\"http://wiki.commonjs.org/wiki/Promises/A\" target=\"_blank\" rel=\"noopener\">Promise/A</a> 提案的行为条款。</p>\n<p>核心的 <a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 是专注于提供一种可以互操作的 <code>then</code> 方法。</p>\n<hr>\n\n<h2 id=\"Promise-A-规范解读\"><a href=\"#Promise-A-规范解读\" class=\"headerlink\" title=\"Promise/A+ 规范解读\"></a>Promise/A+ 规范解读</h2><p>以下内容是源自 <a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 官网的翻译版本 + 个人理解版本，英语好的朋友可以自行阅读 <a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 官方文档。</p>\n<h3 id=\"Terminology\"><a href=\"#Terminology\" class=\"headerlink\" title=\"Terminology\"></a>Terminology</h3><p><strong>1.1.</strong> “promise” 是一个符合本规范的，并具有 <code>then</code> 方法的一个对象或函数</p>\n<p><strong>1.2.</strong> “thenable” 是一个具有 <code>then</code> 方法的对象或函数</p>\n<p><strong>1.3.</strong> “value” 可以是任何一个合法的 JavaScript 值，包括 <code>undefined</code>、一个 <em>thenable</em> 或一个 promise</p>\n<p><strong>1.4.</strong> “exception” 是一个使用 <code>throw</code> 关键字所抛出的值</p>\n<p><strong>1.5.</strong> “reason” 是表明这个 promise 被 reject 的原因</p>\n<h3 id=\"Requirements\"><a href=\"#Requirements\" class=\"headerlink\" title=\"Requirements\"></a>Requirements</h3><h4 id=\"Promise-States\"><a href=\"#Promise-States\" class=\"headerlink\" title=\"Promise States\"></a>Promise States</h4><p>一个 promise 必须处于以下三个状态之一：<code>pending</code>、<code>fulfilled</code> 或 <code>rejected</code></p>\n<p><strong>2.1.1.</strong> 当处于 <code>pending</code> 态时，一个 promise：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.1.1.1.</b> 可能会转换为 <code>fulfilled</code> 或 <code>rejected</code> 状态</li>\n</ul>\n\n<p><strong>2.1.2.</strong> 当处于 <code>fulfilled</code> 时，一个 promise：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.1.2.1.</b> 它绝不会再转变为其他状态</li>\n    <li><b>2.1.2.2.</b> 它必须存在一个不可被改变的 <em>value</em> 值，以此表明成功时的值</li>\n</ul>\n\n<p><strong>2.1.3.</strong> 当处于 <code>rejected</code> 时，一个 promise：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.1.3.1.</b> 它绝不会再转变为其他状态</li>\n    <li><b>2.1.3.2.</b> 它必须存在一个不可被改变的 <em>reason</em> 值，以此表明其失败的原因</li>\n</ul>\n\n<h4 id=\"The-then-Method\"><a href=\"#The-then-Method\" class=\"headerlink\" title=\"The then Method\"></a>The <code>then</code> Method</h4><p>一个 promise 必须提供一个 <code>then</code> 方法去访问其最终成功时的值或其失败的原因。</p>\n<p>一个 promise 的 <code>then</code> 方法可以接收两个参数：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">promise.then(onFulfilled, onRejected)</span><br></pre></td></tr></table></figure>\n\n<p><strong>2.2.1.</strong> 这两个参数都是可选的参数：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.2.1.1.</b> 如果 <code>onFulfilled</code> 不是一个函数，那么必须忽略</li>\n    <li><b>2.2.1.2.</b> 如果 <code>onRejected</code> 不是一个函数，那么必须忽略</li>\n</ul>\n\n<p><strong>2.2.2.</strong> 如果 <code>onFulfilled</code> 是一个函数：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.2.2.1.</b> 它必须在 promise 状态变为 <code>fulfilled</code> 之后调用，并使用 <em>value</em> 的值作为其第一个参数</li>\n    <li><b>2.2.2.2.</b> 它绝不能在 promise 状态变为 <code>fulfilled</code> 之前调用</li>\n    <li><b>2.2.2.3.</b> 它的调用次数绝不能超过一次</li>\n</ul>\n\n<p><strong>2.2.3.</strong> 如果 <code>onFulfilled</code> 是一个函数：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.2.3.1.</b> 它必须在 promise 状态变为 <code>rejected</code> 之后调用，并使用 <em>value</em> 的值作为其第一个参数</li>\n    <li><b>2.2.3.2.</b> 它绝不能在 promise 状态变为 <code>rejected</code> 之前调用</li>\n    <li><b>2.2.3.3.</b> 它的调用次数绝不能超过一次</li>\n</ul>\n\n<p><strong>2.2.4.</strong> <code>onFulfilled</code> 和 <code>onRejected</code> 在 <a href=\"https://es5.github.io/#x10.3\" target=\"_blank\" rel=\"noopener\">执行上下文</a> 堆栈仅包含平台代码前不得调用 [<a href=\"#point-3-1\">3.1</a>]</p>\n<p><strong>2.2.5.</strong> <code>onFulfilled</code> 和 <code>onRejected</code> 必须作为函数去调用（即使没有 <em>value</em> 值）[<a href=\"#point-3-2\">3.2</a>]</p>\n<p><strong>2.2.6.</strong> <code>then</code> 方法可能在同一个 promise 中被多次调用：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.2.6.1.</b> 如果/当 promise 被 fulfilled 了，那么所有相应的 <code>onFulfilled</code> 回调函数必须按照其对应 <code>then</code> 函数调用顺序依次执行</li>\n    <li><b>2.2.6.2.</b> 如果/当 promise 被 rejected 了，那么所有相应的 <code>onRejected</code> 回调函数必须按照其对应 <code>then</code> 函数调用顺序依次执行</li>\n</ul>\n\n<p><strong>2.2.7.</strong> <code>then</code> 方法必须返回一个 promise [<a href=\"#point-3-3\">3.3</a>]：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">promise2 = promise1.then(onFulfilled, onRejected);</span><br></pre></td></tr></table></figure>\n\n<ul style=\"list-style: none;\">\n    <li><b>2.2.7.1.</b> 如果 <code>onFulfilled</code> 或 <code>onRejected</code> 其中一个返回了值 <code>x</code>，则需要运行 Promise 解决程序 <code>[[Resolve]](promise2, x)</code></li>\n    <li><b>2.2.7.2.</b> 如果 <code>onFulfilled</code> 或 <code>onRejected</code> 其中抛出了一个异常 <code>e</code>，则 promise2 必须以 <code>e</code> 为缘由被 <em>reject</em></li>\n    <li><b>2.2.7.3.</b> 如果 <code>onFulfilled</code> 不是一个函数，并且 promise1 已经处于成功态，那么 promise2 必须以与 promise1 的 <em>value</em> 相同的值被 <em>resolve</em></li>\n    <li><b>2.2.7.4.</b> 如果 <code>onRejected</code> 不是一个函数，并且 promise1 已经处于失败态，那么 promise2 必须以与 promise1 的 <em>reason</em> 相同的值被 <em>reject</em></li>\n</ul>\n\n<h4 id=\"The-Promise-Resolution-Procedure\"><a href=\"#The-Promise-Resolution-Procedure\" class=\"headerlink\" title=\"The Promise Resolution Procedure\"></a>The Promise Resolution Procedure</h4><p>Promise 解决程序是一个抽象的操作 <code>[[Resolve]](promise2, x)</code>，其输入一个 promise 和一个值 <code>x</code>。</p>\n<p><strong>2.3.1.</strong> 如果 promise2 和 <code>x</code> 是同一个对象，那么令 promise2 为 <em>reject</em>，并以 <code>TypeError</code> 作为原因</p>\n<p><strong>2.3.2.</strong> 如果 <code>x</code> 恰好是一个 Promise 对象，那么采用它的状态 [<a href=\"#point-3-4\">3.4</a>]：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.3.2.1.</b> 如果 <code>x</code> 处于 <em>pending</em> 态，那么 promise2 也要处于 <em>pending</em> 态，直到 <code>x</code> 变成了 <em>fulfilled</em> 态或者 <em>rejected</em> 态</li>\n    <li><b>2.3.2.2.</b> 如果 <code>x</code> 处于 <em>fulfilled</em> 态，那么 promise2 也以与 <code>x</code> 同样的 <em>value</em> 被 <em>resolve</em></li>\n    <li><b>2.3.2.3.</b> 如果 <code>x</code> 处于 <em>rejected</em> 态，那么 promise2 也以与 <code>x</code> 同样的 <em>reason</em> 被 <em>reject</em></li>\n</ul>\n\n<p><strong>2.3.3.</strong> 否则，如果 <code>x</code> 是一个对象或函数：</p>\n<ul style=\"list-style: none;\">\n    <li><b>2.3.3.1.</b> 新建一个变量 <code>then</code>，令其等于 <code>x.then</code> [<a href=\"#point-3-5\">3.5</a>]</li>\n    <li><b>2.3.3.2.</b> 如果在 <code>x.then</code> 中抛出了一个异常 <code>e</code>，那么 promise2 将会以 <code>e</code> 被 <em>reject</em></li>\n    <li><b>2.3.3.3.</b> 如果 <code>then</code> 是一个函数，那么以 <code>x</code> 为函数中的 <code>this</code> 去调用它，与普通的 <code>then</code> 方法相同，其接收两个参数：<code>onFulfilled</code> 和 <code>onRejected</code>：</li>\n    <li>\n        <ul style=\"list-style: none;\">\n            <li><b>2.3.3.3.1.</b> 如果/当 <code>onFulfilled</code> 被调用了，并且传入的参数是 <code>y</code>，那么再次调用 <code>[[Resolve]](promise2, y)</code></li>\n            <li><b>2.3.3.3.2.</b> 如果/当 <code>onRejected</code> 被调用了，并且传入的参数是 <code>r</code>，那么 promise2 需要以 <code>r</code> 为 <em>reason</em> 被 <em>reject</em></li>\n            <li><b>2.3.3.3.3.</b> 如果同时调用了 <code>onFulfilled</code> 与 <code>onRejected</code>，或者对同一个函数进行了多次调用，则只执行第一次调用，其余的所有调用都应当被忽略</li>\n            <li><b>2.3.3.3.4.</b> 如果在调用 <code>then</code> 时抛出了异常 <code>e</code>：</li>\n            <li>\n                <ul style=\"list-style: none;\">\n                    <li><b>2.3.3.3.4.1.</b> 如果 <code>onFulfilled</code> 或 <code>onRejectde</code> 已经被调用过了，则忽略这个异常</li>\n                    <li><b>2.3.3.3.4.2.</b> 否则，以 <code>e</code> 为 <em>reason</em>，令 promise2 被 <em>reject</em></li>\n                </ul>\n            </li>\n        </ul>\n    </li>\n    <li><b>2.3.3.4.</b> 如果 <code>then</code> 不是一个函数，那么将 <code>x</code> 作为 <em>value</em>，令 promise2 被 <em>resolve</em></li>\n</ul>\n\n<p><strong>2.3.4.</strong> 如果 <code>x</code> 不是一个函数或对象，那么将 <code>x</code> 作为 <em>value</em>，令 promise2 被 <em>resolve</em></p>\n<p>如果 promise2 被一个循环的 <em>thenable</em> <em>resolve</em> 了，这样会因为 <code>[[Resolve]](promise, thenable)</code> 的递归性质最终再次调用 <code>[[Resolve]](promise, thenable)</code>，遵循上述算法将会导致递归没有出口。<a href=\"https://promisesaplus.com/\" target=\"_blank\" rel=\"noopener\">Promise/A+</a> 规范鼓励（但不是必须的）去检测这种递归，并以 <code>TypeError</code> 为 <em>reason</em> 使得当前递归栈顶中的 promise 被 <em>reject</em>。[<a href=\"#point-3-6\">3.6</a>]</p>\n<h3 id=\"Notes\"><a href=\"#Notes\" class=\"headerlink\" title=\"Notes\"></a>Notes</h3><p><a name=\"point-3-1\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.1.</b></a> 这里的“平台代码”是指 JS 引擎、环境和 promise 实现代码。实际上，这一要求确保 <code>onFulfilled</code> 和 <code>onRejected</code> 在调用 <code>then</code> 事件循环之后，使用一个新的堆栈去异步执行。这可以通过“宏任务”机制（例如 <a href=\"https://html.spec.whatwg.org/multipage/webappapis.html#timers\" target=\"_blank\" rel=\"noopener\">setTimeout</a> 或 <a href=\"https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/setImmediate/Overview.html#processingmodel\" target=\"_blank\" rel=\"noopener\">setImmediate</a>）或通过“微任务”机制（例如 <a href=\"https://dom.spec.whatwg.org/#interface-mutationobserver\" target=\"_blank\" rel=\"noopener\">MutationObserver</a> 或 <a href=\"https://nodejs.org/api/process.html#process_process_nexttick_callback\" target=\"_blank\" rel=\"noopener\">process.nextTick</a>）。由于 promise 的实现被视为了平台代码，因此它本身可能包含一个任务调度队列或调用处理程序的“蹦床”。</p>\n<p><a name=\"point-3-2\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.2.</b></a> 也就是说，在 JavaScript 的严格模式下，<code>undefined</code> 可能会作为 <code>this</code> 的值出现，然而在非严格模式下，它将会作为一个全局变量。</p>\n<p><a name=\"point-3-3\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.3.</b></a> promise 的实现可以允许 <code>promise2 === promise1</code>（即：<code>promise2 === x</code>），前提是应当满足所有的要求。每个实现都应该记录它是否可以生成 <code>promise2 === promise1</code> 以及在什么条件下会生成 <code>promise1</code>。</p>\n<p><a name=\"point-3-4\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.4.</b></a> 一般来说，只有当 <code>x</code> 来自于当前的 promise 时，才可以知道它是一个真正的 promise。该条款允许使用特定的手段来采用一些已知且一致的 promise 状态。</p>\n<p><a name=\"point-3-5\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.5.</b></a> 这个过程首先存储了 <code>x.then</code> 的引用，然后测试这个引用（是否是一个函数），然后再调用这个引用。避免了对 x.then 属性的访问。这些预防措施对于确保访问器属性的一致性非常重要，因为访问器属性的值可能在两次检索之间发生变化。</p>\n<p><a name=\"point-3-6\" style=\"text-decoration: none; color: rgb(100, 98, 97);\"><b>3.6.</b></a> 实现不应该对递归循环链的深度做限制，并且假设超过该任意递归限制将会是无线的递归。只有真正的循环才会导致 <code>TypeError</code>；如果遇到了无限长的非重复的链，则永远的去递归其正确的行为。</p>\n<hr>\n\n<h2 id=\"实现\"><a href=\"#实现\" class=\"headerlink\" title=\"实现\"></a>实现</h2><h3 id=\"创建-Promise-类\"><a href=\"#创建-Promise-类\" class=\"headerlink\" title=\"创建 Promise 类\"></a>创建 Promise 类</h3><p>根据术语 1，promise 是一个有 then 方法的对象或者是函数，行为遵循本规范。那么就创建一个类（ES6 写法，下同）：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"完善-Promise-的状态\"><a href=\"#完善-Promise-的状态\" class=\"headerlink\" title=\"完善 Promise 的状态\"></a>完善 Promise 的状态</h3><p>根据规范 2.1，Promise 必须处于以下三个状态之一: pending, fulfilled 或者是 rejected：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> PENDING = <span class=\"string\">'pending'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> FULFILLED = <span class=\"string\">'fulfilled'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> REJECTED = <span class=\"string\">'rejected'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"完善构造器\"><a href=\"#完善构造器\" class=\"headerlink\" title=\"完善构造器\"></a>完善构造器</h3><p>根据原生 Promise，在 new 的时候需要传入一个 <strong>executor</strong> 执行器，这个执行器会在 new 返回这个 Promise 实例之前被调用。</p>\n<p>在构造器中，令这个 Promise 实例的状态处于 <em>PENDING</em> 态。</p>\n<p><strong>executor</strong> 构造器接收两个参数，<em>resolve</em> 和 <em>reject</em>，他们两个都是函数：</p>\n<ul>\n<li><em>resolve</em> 接收一个参数 <em>value</em>，代表当前 Promise 成功时的值（术语 3）</li>\n<li><em>reject</em> 接收一个参数 <em>reason</em>，代表当前 Promise 失败的原因（术语 5）</li>\n</ul>\n<p>根据规则 2.1.1、2.1.2、2.1.3，在调用 <em>resolve</em> 或 <em>reject</em> 时，如果当前 Promise 的状态是 <em>PENDING</em> 态，那么应该转换成对应的 <em>FULFILLED</em> 或 <em>REJECTED</em>。</p>\n<p>根据原生 Promise 得知，如果 <strong>executor</strong> 在执行中抛出了一个异常，那么当前 promise 则要进入失败态：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> PENDING = <span class=\"string\">'pending'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> FULFILLED = <span class=\"string\">'fulfilled'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> REJECTED = <span class=\"string\">'rejected'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(executor) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.status = PENDING;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 使用箭头函数是为了保证 this 的一致性</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> resolve = <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === PENDING) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.status = FULFILLED;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.value = value;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">let</span> reject = <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === PENDING) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.status = REJECTED;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.reason = reason;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            executor(resolve, reject);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">            reject(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"构造-then-方法\"><a href=\"#构造-then-方法\" class=\"headerlink\" title=\"构造 then 方法\"></a>构造 then 方法</h3><p>根据规则 2.2.1，<code>then</code> 方法接收两个参数 <code>onFulfilled</code> 和 <code>onRejected</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 上面省略，then 方法是一个成员函数</span></span><br><span class=\"line\">then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 下面省略</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"then-方法的参数\"><a href=\"#then-方法的参数\" class=\"headerlink\" title=\"then 方法的参数\"></a>then 方法的参数</h3><p>根据规则 2.2.5、2.2.7.3、2.2.7.4，需要对传入的 <code>onFulfilled</code> 和 <code>onRejected</code> 的类型进行判断：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">    onFulfilled = <span class=\"keyword\">typeof</span> onFulfilled === <span class=\"string\">'function'</span> ? onFulfilled : <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value;</span><br><span class=\"line\">    onRejected = <span class=\"keyword\">typeof</span> onRejected === <span class=\"string\">'function'</span> ? onRejected : <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123; <span class=\"keyword\">throw</span> reason; &#125;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"then-方法的返回值\"><a href=\"#then-方法的返回值\" class=\"headerlink\" title=\"then 方法的返回值\"></a>then 方法的返回值</h3><p>根据规则 2.2.7，<code>then</code> 方法会返回一个新的 Promise 实例 <code>promise2</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">    onFulfilled = <span class=\"keyword\">typeof</span> onFulfilled === <span class=\"string\">'function'</span> ? onFulfilled : <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value;</span><br><span class=\"line\">    onRejected = <span class=\"keyword\">typeof</span> onRejected === <span class=\"string\">'function'</span> ? onRejected : <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123; <span class=\"keyword\">throw</span> reason; &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"实现返回的新的-Promise-实例\"><a href=\"#实现返回的新的-Promise-实例\" class=\"headerlink\" title=\"实现返回的新的 Promise 实例\"></a>实现返回的新的 Promise 实例</h3><p>根据规则 2.2.2、2.2.3，需要对原先的 promise（即调用 <code>then</code> 方法的 <code>this</code>）的状态进行判断，以此来确定 <code>promise2</code> 的状态。</p>\n<p>根据规则 2.2.4，需要以异步的方式去执行 <code>onFulfilled</code> 和 <code>onRejected</code>（这里统一采用 <code>setTimeout</code>）。</p>\n<div class=\"note info\">setTimeout() 可以省略第二个参数，只传入第一个回调函数作为参数，但是由于 JS 引擎与硬件等原因，不可能达到完全的 0ms 立即执行，往往会有一个最小时间（浏览器中通常是 4ms）</div>\n\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">    onFulfilled = <span class=\"keyword\">typeof</span> onFulfilled === <span class=\"string\">'function'</span> ? onFulfilled : <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value;</span><br><span class=\"line\">    onRejected = <span class=\"keyword\">typeof</span> onRejected === <span class=\"string\">'function'</span> ? onRejected : <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123; <span class=\"keyword\">throw</span> reason; &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 这里如果不使用箭头函数，这个 this 的值就会变成 promise2</span></span><br><span class=\"line\">        <span class=\"comment\">// 如果使用 function，请在此之前使用 let self = this; 去存储一个 promise 的引用</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === FULFILLED) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.2.4 --- setTimeout</span></span><br><span class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === REJECTED) &#123;</span><br><span class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"利用发布订阅解决-PENDING-态的问题\"><a href=\"#利用发布订阅解决-PENDING-态的问题\" class=\"headerlink\" title=\"利用发布订阅解决 PENDING 态的问题\"></a>利用发布订阅解决 PENDING 态的问题</h3><p>在我的 <a href=\"https://www.wqh4u.cn/2020/01/14/JavaScript%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%E4%B8%8E%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/\">这篇博客</a> 中解释了什么是发布订阅哦~</p>\n<p>根据规则 2.2.6.1、2.2.6.2，如果当前调用 <code>then</code> 的 promise 实例还处于 <em>PENDING</em> 态，那么所有相应的 <code>onFulfilled</code> 和 <code>onRejected</code> 都需要等到这个 promise 实例被完成时（改变状态时），去依次执行（这里也解决了同一个 promise 实例多次调用 <code>then</code> 方法的问题）。</p>\n<p>这其实就用到了 <strong>“发布订阅”</strong> 的思想，首先将所有的 <code>onFulfilled</code> 和 <code>onRejected</code> 存储起来（订阅），等到 promise 实例的状态改变时（发布），依次调用订阅的回调函数（广播）。</p>\n<p>首先修改构造器，增加两个属性去接收订阅的回调函数：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(executor) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.status = PENDING;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 增加两个属性</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.onFulfilledCallback = [];</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.onRejectedCallback = [];</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 以下省略...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>然后修改 <code>then</code> 中的方法：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">    onFulfilled = <span class=\"keyword\">typeof</span> onFulfilled === <span class=\"string\">'function'</span> ? onFulfilled : <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value;</span><br><span class=\"line\">    onRejected = <span class=\"keyword\">typeof</span> onRejected === <span class=\"string\">'function'</span> ? onRejected : <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123; <span class=\"keyword\">throw</span> reason; &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === FULFILLED) &#123;</span><br><span class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === REJECTED) &#123;</span><br><span class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 当 this.status === PENDING 时，需要将回调函数进行存储</span></span><br><span class=\"line\">            <span class=\"comment\">// 因为 “发布订阅” 最后是逐个调用订阅回调的，所以这里要 push 一个函数</span></span><br><span class=\"line\">            <span class=\"keyword\">this</span>.onFulfilledCallback.push(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 又因为规则 2.2.4，即使存储了 onFulfilled 和 onRejected，也要去异步的执行</span></span><br><span class=\"line\">                setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.onRejectedCallback.push(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2;</span><br></pre></td></tr></table></figure>\n\n<p>最后修改构造器中的 <em>resolve</em> 和 <em>reject</em>，因为它们的调用会造成 promise 状态的改变，既然状态发生了改变，则需要去对订阅者 <strong>发布广播</strong> ：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(executor) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">let</span> resolve = <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === PENDING) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.status = FULFILLED;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.value = value;</span><br><span class=\"line\">                <span class=\"comment\">// publish</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.onFulfilledCallback.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value());</span><br><span class=\"line\">                <span class=\"comment\">// 注意这个 value 值，它只是 forEach 回调的第一个参数哦</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">let</span> reject = <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === PENDING) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.status = REJECTED;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.reason = reason;</span><br><span class=\"line\">                <span class=\"comment\">// publish</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.onRejectedCallback.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 以下省略...</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"定义-Promise-Resolution-Procedure\"><a href=\"#定义-Promise-Resolution-Procedure\" class=\"headerlink\" title=\"定义 Promise Resolution Procedure\"></a>定义 Promise Resolution Procedure</h3><p>根据规则 2.3，我们需要一个承诺解决函数 promiseResolutionProcedure()，我们令其接收四个参数：</p>\n<ul>\n<li>promise2：为 <code>then</code> 方法应当返回的值，即 promise2（本身也是对他进行处理）</li>\n<li>x：为 <code>then</code> 中，调用 <code>then</code> 方法的 promise 实例（就是 <code>this</code>）的 <code>onFulfilled</code> 和 <code>onRejected</code> 的返回值，因为其的可能性太多，所以需要 romise Resolution Procedure 去处理</li>\n<li>resolve：为传入 promise2 的构造器中 <strong>executor</strong> 的第一个参数</li>\n<li>reject：为传入 promise2 的构造器中 <strong>executor</strong> 的第二个参数</li>\n</ul>\n<p>这里传入 <em>resolve</em> 和 <em>reject</em> 的原因之一是方便对 promise2 进行状态确定的处理：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 省略</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise2, x, resolve, reject</span>) </span>&#123;  </span><br><span class=\"line\">    <span class=\"comment\">// 暂时不写</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"完善-then-方法\"><a href=\"#完善-then-方法\" class=\"headerlink\" title=\"完善 then 方法\"></a>完善 then 方法</h3><p>根据规则 2.2.7.1 和 2.2.7.2 得知：</p>\n<ul>\n<li><strong>2.2.7.1</strong> <code>onFulfilled</code> 和 <code>onRejected</code> 都是会有返回值 <code>x</code> 的，并且需要对这个 x 进行 Promise Resolution Procedure</li>\n<li><strong>2.2.7.2</strong> 如果在 <code>onFulfilled</code> 和 <code>onRejected</code> 中抛出了异常 <code>e</code>，那么 promise2 需要以 <code>e</code> 为 <em>reason</em> 被 <em>reject</em></li>\n</ul>\n<p>这里不要忘了，因为是对所有的 <code>onFulfilled</code> 和 <code>onRejected</code> 进行处理，所以在 promise.status 为 <em>PENDING</em> 态时，也要写进去奥：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\"></span><br><span class=\"line\">then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">    onFulfilled = <span class=\"keyword\">typeof</span> onFulfilled === <span class=\"string\">'function'</span> ? onFulfilled : <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value;</span><br><span class=\"line\">    onRejected = <span class=\"keyword\">typeof</span> onRejected === <span class=\"string\">'function'</span> ? onRejected : <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123; <span class=\"keyword\">throw</span> reason; &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">let</span> promise2 = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === FULFILLED) &#123;</span><br><span class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 首先根据 2.2.7.2，需要对 onFulfilled 和 onRejected 进行异常处理</span></span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// 又因为 2.2.7.1，onFulfilled 和 onRejected 都可能返回一个 x</span></span><br><span class=\"line\">                    <span class=\"comment\">// 这时候需要对 x 进行捕获</span></span><br><span class=\"line\">                    <span class=\"keyword\">let</span> x = onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">                    <span class=\"comment\">// 捕获完了后就要对 x 的值进行分析</span></span><br><span class=\"line\">                    <span class=\"comment\">// 此时需要调用 Promise Resolution Procedure</span></span><br><span class=\"line\">                    promiseResolutionProcedure(promise2, x, resolve, reject);</span><br><span class=\"line\">                    <span class=\"comment\">// 不用担心这里由于 promise2 是由 let 定义的，从而导致这一句 promise2 的值是 undefined</span></span><br><span class=\"line\">                    <span class=\"comment\">// 因为这块代码是异步执行，在真正执行到这里时对 promise2 的定义早都完了</span></span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                    reject(e); <span class=\"comment\">// 这个 reject 是 promise2 的 reject，不要搞混了</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// 下同，对每一个 onFulfilled 和 onRejected 都要处理</span></span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === REJECTED) &#123;</span><br><span class=\"line\">            setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">let</span> x = onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">                    promiseResolutionProcedure(promise2, x, resolve, reject);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                    reject(e);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.onFulfilledCallback.push(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">let</span> x = onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">                        promiseResolutionProcedure(promise2, x, resolve, reject);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                        reject(e);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.onRejectedCallback.push(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">let</span> x = onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">                        promiseResolutionProcedure(promise2, x, resolve, reject);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                        reject(e);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">return</span> promise2;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 以下省略...</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"最难的-Promise-Resolution-Procedure\"><a href=\"#最难的-Promise-Resolution-Procedure\" class=\"headerlink\" title=\"最难的 Promise Resolution Procedure\"></a>最难的 Promise Resolution Procedure</h3><p>根据规范 2.3.1，如果 promise2 和 x 是全等的，那么 promise2 应该以 <code>TypeError(&#39;Chaining cycle&#39;)</code> 被 <em>reject</em>。</p>\n<p>因为一个 promise 对象也是属于 <code>object</code> 或一个 <code>function</code> 的，所以在执行规范 2.3.2 之前需要去验证规范 2.3.3，即 <code>x</code> 是否为一个对象或者函数。</p>\n<div class=\"note danger\">注意一点，在神奇的 JavaScript 中，<code>typeof null === 'object'</code></div>\n\n<p>根据规范 2.3.4，如果 <code>x</code> 既不是对象也不是函数，那么 promise2 应该处于成功态（被 <em>resolve</em>），且 <em>value</em> 值为 <code>x</code>：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise2, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Promise/A+ 2.3.1</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (promise2 === x) &#123;</span><br><span class=\"line\">        reject(<span class=\"keyword\">new</span> <span class=\"built_in\">TypeError</span>(<span class=\"string\">'Chaining cycle'</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// Promise/A+ 2.3.3</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &amp;&amp; <span class=\"keyword\">typeof</span> x === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 这里由于运算符优先级的问题，不能将 object 和 function 颠倒！</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.3.4</span></span><br><span class=\"line\">        resolve(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>现在就该检查 <code>x</code> 是不是一个 <em>thenable</em> 了。</p>\n<p>根据规范 2.3.3.1，令 <code>then</code> 变量与 <code>x.then</code> 同引用。</p>\n<p>根据规范 2.3.3.3，如果同时调用 <code>onFulfilled</code> 和 <code>onRejected</code>，或者对同一参数进行了多次调用，则第一个调用优先，而所有其他调用均被忽略，所以需要维护一个值，去判断是否为第一次调用。</p>\n<p>根据规范 2.3.3.2，如果在检索 <code>x.then</code> 时抛出了异常 <code>e</code>，那么 promise2 则应该以 <code>e</code> 为 <em>reason</em> 被 <em>reject</em>。</p>\n<p>根据规范 2.3.3.4，如果 <code>x.then</code> 不是一个函数（不是 <em>thenable</em>），那么 promise2 则应该以 <code>x</code> 为 <em>value</em> 被 <em>resolve</em>。</p>\n<p>根据规范 2.3.3，如果 <code>x.then</code> 是一个函数，且根据 Promise Resolution Procedure 的定义：<b>如果 x 是 <em>thenable</em>，那么最起码在 then 行为类似于一个 promise 实例的情况下，尝试对其采用 promise 实例应该有的方法，否则执行规范 2.3.3.4。</b></p>\n<div class=\"note info\">个人认为，这一步是将规范 2.3.2 结合到了 2.3.3 中去实现，因为 2.3.3 中的 x 也是一个 <em>thenable</em>，又因为 Promise Resolution Procedure 定义也说了，那么只要是一个 <em>thenable</em>，就把它当作一个 promise 实例去试试。</div>\n\n<p>根据规范 2.3.3.3，<code>then</code> 是一个函数，那么需要用 <code>x</code> 作为调用这个 <code>then</code> 的 <code>this</code>，并且这个 <code>then</code> 接收两个参数 <code>onFulfilled</code> 和 <code>onRejected</code>。（这就是对于 Promise Resolution Procedure 定义的一个实现，不管他到底是不是真正的 promise 实例的 then 方法，传进去就是了）</p>\n<p>根据规范 2.3.3.3.1 和 2.3.3.3.2，对传入 <code>then</code> 中的 <code>onFulfilled</code> 和 <code>onRejected</code> 进行实现：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">proemise2, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (promise2 === x) &#123;</span><br><span class=\"line\">        reject(<span class=\"keyword\">new</span> <span class=\"built_in\">TypeError</span>(<span class=\"string\">'Chaining cycle'</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &amp;&amp; <span class=\"keyword\">typeof</span> x === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.3.3.3</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> used = <span class=\"literal\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.3.3.1</span></span><br><span class=\"line\">            <span class=\"keyword\">let</span> then = x.then;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.3.3.4</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.3.3.3</span></span><br><span class=\"line\">                <span class=\"comment\">// Promise Resolution Procedure</span></span><br><span class=\"line\">                then.call(x, y =&gt; &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Promise/A+ 2.3.3.3.1</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (used) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                    used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    promiseResolutionProcedure(promise2, y, resolve, reject);</span><br><span class=\"line\">                &#125;, reason =&gt; &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Promise/A+ 2.3.3.3.2</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (used) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                    used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    reject(reason);</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (used) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                resolve(x);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.3.3.2</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (used) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            reject(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        resolve(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><h3 id=\"准备工作\"><a href=\"#准备工作\" class=\"headerlink\" title=\"准备工作\"></a>准备工作</h3><h4 id=\"导出模块\"><a href=\"#导出模块\" class=\"headerlink\" title=\"导出模块\"></a>导出模块</h4><p>如果你的 Promise 代码在一个单独的文件（比如 Promise.js）中，那么需要使用 Node.js 中导出模块：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 省略...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise2, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 省略...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = <span class=\"built_in\">Promise</span>; <span class=\"comment\">// 导出模块</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"安装测试脚本\"><a href=\"#安装测试脚本\" class=\"headerlink\" title=\"安装测试脚本\"></a>安装测试脚本</h4><p>有专门的测试脚本可以测试所编写的代码是否符合 Promise/A+ 的规范：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g promises-aplus-tests</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"编写测试代码\"><a href=\"#编写测试代码\" class=\"headerlink\" title=\"编写测试代码\"></a>编写测试代码</h4><p>在 Promise.js 中，添加如下代码：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 省略...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise2, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 省略...</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">Promise</span>.defer = <span class=\"built_in\">Promise</span>.deferred = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> dfd = &#123;&#125;;</span><br><span class=\"line\">    dfd.promise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        dfd.resolve = resolve;</span><br><span class=\"line\">        dfd.reject = reject;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> dfd;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = <span class=\"built_in\">Promise</span>; <span class=\"comment\">// 导出模块</span></span><br></pre></td></tr></table></figure>\n\n<p>如果不加的话，可以康康报错，你就懂了 /doge</p>\n<h3 id=\"再贴一遍全部的代码吧\"><a href=\"#再贴一遍全部的代码吧\" class=\"headerlink\" title=\"再贴一遍全部的代码吧~\"></a>再贴一遍全部的代码吧~</h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">'use strict'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Promise/A+ 2.1 --- 有三个状态</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> PENDING = <span class=\"string\">'pending'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> FULFILLED = <span class=\"string\">'fulfilled'</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> REJECTED = <span class=\"string\">'rejected'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 术语 1 --- Promise 实例</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Promise</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">constructor</span>(executor) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.status = PENDING;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.2.6.1 --- onFulfilled 订阅</span></span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.2.6.2 --- onRejected 订阅</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.onFulfilledCallback = [];</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.onRejectedCallback = [];</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 术语 3 --- resolve 定义</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> resolve = <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === PENDING) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.1.1 --- 对于 pending 态的描述</span></span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.1.2 --- 对于 fulfilled 态的描述</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.status = FULFILLED;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.value = value;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.2.6.1 --- 当 resolve（发布）时，则需要广播</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.onFulfilledCallback.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 术语 5 --- reject 定义</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> reject = <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === PENDING) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.1.1 --- 对于 pending 态的描述</span></span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.1.3 --- 对于 rejected 态的描述</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.status = REJECTED;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.reason = reason;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.2.6.2 --- 当 reject（发布）时，则需要进行广播</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.onRejectedCallback.forEach(<span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 由原生 Promise 推断而来</span></span><br><span class=\"line\">            executor(resolve, reject);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">            reject(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Promise/A+ 2.2 --- then 方法</span></span><br><span class=\"line\">    <span class=\"comment\">// Promise/A+ 2.2.1 --- then 方法接收两个参数</span></span><br><span class=\"line\">    then(onFulfilled, onRejected) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.2.5 --- 这两个参数要作为函数被调用</span></span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.2.7.3 --- 如果 onFulfilled 不是函数且 this 已 resolve，则 promise2 必须使用与相同的 value 来 resolve</span></span><br><span class=\"line\">        onFulfilled = <span class=\"keyword\">typeof</span> onFulfilled === <span class=\"string\">'function'</span> ? onFulfilled : <span class=\"function\"><span class=\"params\">value</span> =&gt;</span> value;</span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.2.7.4 --- 如果 onFulfilled 不是函数且 this 已 reject，则 promise2 必须使用与相同的 reason 来 reject</span></span><br><span class=\"line\">        onRejected = <span class=\"keyword\">typeof</span> onRejected === <span class=\"string\">'function'</span> ? onRejected : <span class=\"function\"><span class=\"params\">reason</span> =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> reason;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.2.7 --- then 方法会返回一个新的 promise 实例</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> nextPromise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.2.2 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数</span></span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.2.3 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === FULFILLED) &#123;</span><br><span class=\"line\">                setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Promise/A+ 2.2.4 --- 需要以异步的方式去执行</span></span><br><span class=\"line\">                    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Promise/A+ 2.2.7.1 --- 需要对 onFulfilled 的返回值 x 去进行 Promise Resolution Procedure</span></span><br><span class=\"line\">                        <span class=\"keyword\">let</span> x = onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">                        promiseResolutionProcedure(nextPromise, x, resolve, reject);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Promise/A+ 2.2.7.2 --- 如果在执行 onFulfilled 时抛异常，那么 promise2 以异常为 reason 被 reject</span></span><br><span class=\"line\">                        reject(e);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.status === REJECTED) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.2.2 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数</span></span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.2.3 --- 需要对 this 的状态进行判断（不能是 pending），从而调用对应函数</span></span><br><span class=\"line\">                setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Promise/A+ 2.2.4 --- 需要以异步的方式去执行</span></span><br><span class=\"line\">                    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Promise/A+ 2.2.7.1 --- 需要对 onRejected 的返回值 x 去进行 Promise Resolution Procedure</span></span><br><span class=\"line\">                        <span class=\"keyword\">let</span> x = onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">                        promiseResolutionProcedure(nextPromise, x, resolve, reject);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Promise/A+ 2.2.7.2 --- 如果在执行 onRejected 时抛异常，那么 promise2 以异常为 reason 被 reject</span></span><br><span class=\"line\">                        reject(e);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.2.6.1 --- 如果还在 pending 态或多次调用，需要以 “发布订阅” 方法去解决 onFulfilled</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.onFulfilledCallback.push(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Promise/A+ 2.2.4 --- 需要以异步的方式去执行</span></span><br><span class=\"line\">                        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                            <span class=\"comment\">// Promise/A+ 2.2.7.1 --- 需要对 onFulfilled 的返回值 x 去进行 Promise Resolution Procedure</span></span><br><span class=\"line\">                            <span class=\"keyword\">let</span> x = onFulfilled(<span class=\"keyword\">this</span>.value);</span><br><span class=\"line\">                            promiseResolutionProcedure(nextPromise, x, resolve, reject);</span><br><span class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                            <span class=\"comment\">// Promise/A+ 2.2.7.2 --- 如果在执行 onFulfilled 时抛异常，那么 promise2 以异常为 reason 被 reject</span></span><br><span class=\"line\">                            reject(e);</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;);</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.2.6.2 --- 如果还在 pending 态或多次调用，需要以 “发布订阅” 方法去解决 onRejected</span></span><br><span class=\"line\">                <span class=\"keyword\">this</span>.onRejectedCallback.push(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                    setTimeout(<span class=\"function\"><span class=\"params\">()</span> =&gt;</span> &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// Promise/A+ 2.2.4 --- 需要以异步的方式去执行</span></span><br><span class=\"line\">                        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                            <span class=\"comment\">// Promise/A+ 2.2.7.1 --- 需要对 onRejected 的返回值 x 去进行 Promise Resolution Procedure</span></span><br><span class=\"line\">                            <span class=\"keyword\">let</span> x = onRejected(<span class=\"keyword\">this</span>.reason);</span><br><span class=\"line\">                            promiseResolutionProcedure(nextPromise, x, resolve, reject);</span><br><span class=\"line\">                        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">                            <span class=\"comment\">// Promise/A+ 2.2.7.2 --- 如果在执行 onRejected 时抛异常，那么 promise2 以异常为 reason 被 reject</span></span><br><span class=\"line\">                            reject(e);</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;);</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> nextPromise;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Promise/A+ 2.3 --- 定义 Promise Resolution Procedure</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// Promise/A+ 2.3.1 --- 如果 promise2 和 x 是全等的，那么 promise2 应该以 TypeError('Chaining cycle') 被 reject</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x === promise) &#123;</span><br><span class=\"line\">        reject(<span class=\"keyword\">new</span> <span class=\"built_in\">TypeError</span>(<span class=\"string\">'Chaining cycle'</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Promise/A+ 2.3.3 --- x 是否是一个对象或函数</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &amp;&amp; <span class=\"keyword\">typeof</span> x === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.3.3.3 --- 维护一个 used，保证只调用一次 onFulfilled 或 onRejected</span></span><br><span class=\"line\">        <span class=\"keyword\">let</span> used = <span class=\"literal\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.3.3.1 --- 令 then 与 x.then 同引用</span></span><br><span class=\"line\">            <span class=\"keyword\">let</span> then = x.then;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> then === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.3.3 --- 如果 then 是一个函数，则将 x 当作 promise 实例来处理</span></span><br><span class=\"line\">                <span class=\"comment\">// Promise Resolution Procedure 定义的实现</span></span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.3.3.3 --- 以 x 为 this 去调用 then 方法，并传入两个回调函数作为参数</span></span><br><span class=\"line\">                then.call(x, y =&gt; &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Promise/A+ 2.3.3.3.1 --- 继续去以 Promise Resolution Procedure 处理 y 值</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (used) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    promiseResolutionProcedure(promise, y, resolve, reject);</span><br><span class=\"line\">                &#125;, reason =&gt; &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// Promise/A+ 2.3.3.3.2 --- 如果失败了，那么以 reason 去将 promise2 reject</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (used) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                    reject(reason);</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// Promise/A+ 2.3.3.4 --- 如果 then 不是一个函数，那么 promise2 以 x 为 value 被 resolve</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (used) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                resolve(x);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (e) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// Promise/A+ 2.3.3.2 --- 如果检索 x.then 时抛异常，那么 promise2 应以异常值为 reason 被 reject</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (used) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            used = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            reject(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Promise/A+ 2.3.4 --- 如果 x 既不是对象也不是函数，那么 promise2 以 x 为 value 被 resolve</span></span><br><span class=\"line\">        resolve(x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">Promise</span>.defer = <span class=\"built_in\">Promise</span>.deferred = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> dfd = &#123;&#125;;</span><br><span class=\"line\">    dfd.promise = <span class=\"keyword\">new</span> <span class=\"built_in\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        dfd.resolve = resolve;</span><br><span class=\"line\">        dfd.reject = reject;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> dfd;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = <span class=\"built_in\">Promise</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"开始测试\"><a href=\"#开始测试\" class=\"headerlink\" title=\"开始测试\"></a>开始测试</h3><p>控制台切到当前目录下，执行以下命令：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">promises-aplus-tests ./Promise.js</span><br></pre></td></tr></table></figure>\n\n<p>一共 872 个测试用例（2020.01.22 版本，不知道以后会不会多），如果都 OK 了最后会告诉你：</p>\n<div class=\"note success\">872 passing</div>\n\n<p>即使不 OK，他在最后也会告诉你哪个测试点错了，比如在刚刚实现 Promise Resolution Procedure 时，特别强调了这一句话：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise2, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &amp;&amp; <span class=\"keyword\">typeof</span> x === <span class=\"string\">'object'</span> || <span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 这里由于运算符优先级的问题，不能将 object 和 function 颠倒！</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>原因也说了，<code>typeof null === &#39;object&#39;</code>，那如果颠倒过来，写成这样：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">promiseResolutionProcedure</span>(<span class=\"params\">promise2, x, resolve, reject</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// 以上省略...</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x &amp;&amp; <span class=\"keyword\">typeof</span> x === <span class=\"string\">'function'</span> || <span class=\"keyword\">typeof</span> x === <span class=\"string\">'object'</span>) &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>再次执行测试，那么最终的结果是：</p>\n<div class=\"note\">\n    <p>862 passing</p>\n    <p>10 failing</p>\n</div>\n\n<p>再往下就是错误信息（很贴心了，还告诉你针对哪一个 Promise/A+ 规范错了）：</p>\n<ul style=\"list-style: none;\">\n    <li>\n        <p>1) 2.3.3: Otherwise, if `x` is an object or function, 2.3.3.3: If `then` is a function, call it with `x` as `this`, first argument `resolvePromise`, and second argument `rejectPromise` 2.3.3.3.1: If/when `resolvePromise` is called with value `y`, run `[[Resolve]](promise, y)` `y` is not a thenable `y` is `null` `then` calls `resolvePromise` synchronously via return from a fulfilled promise:</p>\n        <p style=\"color: rgb(255, 107, 104);\">Error: timeout of 200ms exceeded. Ensure the done() callback is being called in this test.</p>\n        <p style=\"color: rgb(85, 85, 85);\">at Timeout.<anonymous> (NODE_MODULES_PATH\\runnable.js:226:19)</anonymous></p>\n    </li>\n</ul>\n\n<p>剩下的就不列举了，可以看出来错误原因：run [[Resolve]](promise, y) y is not a thenable y is null then calls resolvePromise…，再往下看其余的错误原因，要么 <code>x</code> 是 null 给错了，要么就是 <code>y</code> 是 null 给错了，这个时候就知道是查验类型时的报错了~</p>\n<hr>\n\n<h2 id=\"后记\"><a href=\"#后记\" class=\"headerlink\" title=\"后记\"></a>后记</h2><h3 id=\"关于-Promise-其他功能的封装\"><a href=\"#关于-Promise-其他功能的封装\" class=\"headerlink\" title=\"关于 Promise 其他功能的封装\"></a>关于 Promise 其他功能的封装</h3><p>虽然上述的 Promise 实现已经符合了 Promise/A+ 的规范，但是原生的 Promise 还提供了一些其他方法，比如说这些成员方法:</p>\n<ul>\n<li>catch()</li>\n<li>finally()</li>\n</ul>\n<p>还有这些类方法：</p>\n<ul>\n<li>resolve()</li>\n<li>reject()</li>\n<li>all()</li>\n<li>race()</li>\n</ul>\n<p>抽空更新这些函数的实现~</p>\n<h3 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h3><p>这算是截至 2020.01.22，个人准备时间最长、最费心的一篇 Blog，算上写这篇博客，满足 Promise/A+ 的实现已经敲了二十次了吧（大概？）。</p>\n<p>在准备的时候看到其中讲到了微服务又去看了微服务，看微服务的时候又看到了“HTTP的三次握手和四次挥手”，于是也就有了 <a href=\"https://www.wqh4u.cn/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/\">这篇博客</a> 的诞生。</p>\n<p>快过年了🎉🎉🎉，给 2020 年所有看到这篇 Blog 的人说一声新年快乐（这句话是在 2020-01-22 04:11 时写下的）</p>\n<p><span class=\"red-target\">若需转载，请一定注明来源！</span></p>\n<p>（下次更新一个关于微服务的？）</p>"},{"title":"在Apache上开始部署ThinkPHP5","date":"2019-09-23T10:09:43.000Z","copyright":true,"_content":"\n> <span class = 'introduction'>真正的才智是刚毅的志向。</span><br/>\nThinkPHP框架 - 是由上海顶想公司开发维护的 MVC 结构的开源 PHP 框架，遵循 Apache2 开源协议发布，是为了敏捷 WEB 应用开发和简化企业应用开发而诞生的。\n\n<!--more-->\n\n<hr/>\n\n## Think PHP 框架\n\n我们可以在 <a href = \"http://www.thinkphp.cn/down.html\">Think PHP框架官网</a> 进行下载，然后将其直接解压至网站根目录下。\n\n他的目录结构如下：\n\n```\nproject  应用部署目录\n├─application           应用目录（可设置）\n│  ├─common             公共模块目录（可更改）\n│  ├─index              模块目录(可更改)\n│  │  ├─config.php      模块配置文件\n│  │  ├─common.php      模块函数文件\n│  │  ├─controller      控制器目录\n│  │  ├─model           模型目录\n│  │  ├─view            视图目录\n│  │  └─ ...            更多类库目录\n│  ├─command.php        命令行工具配置文件\n│  ├─common.php         应用公共（函数）文件\n│  ├─config.php         应用（公共）配置文件\n│  ├─database.php       数据库配置文件\n│  ├─tags.php           应用行为扩展定义文件\n│  └─route.php          路由配置文件\n├─extend                扩展类库目录（可定义）\n├─public                WEB 部署目录（对外访问目录）\n│  ├─static             静态资源存放目录(css,js,image)\n│  ├─index.php          应用入口文件\n│  ├─router.php         快速测试文件\n│  └─.htaccess          用于 apache 的重写\n├─runtime               应用的运行时目录（可写，可设置）\n├─vendor                第三方类库目录（Composer）\n├─thinkphp              框架系统目录\n│  ├─lang               语言包目录\n│  ├─library            框架核心类库目录\n│  │  ├─think           Think 类库包目录\n│  │  └─traits          系统 Traits 目录\n│  ├─tpl                系统模板目录\n│  ├─.htaccess          用于 apache 的重写\n│  ├─.travis.yml        CI 定义文件\n│  ├─base.php           基础定义文件\n│  ├─composer.json      composer 定义文件\n│  ├─console.php        控制台入口文件\n│  ├─convention.php     惯例配置文件\n│  ├─helper.php         助手函数文件（可选）\n│  ├─LICENSE.txt        授权说明文件\n│  ├─phpunit.xml        单元测试配置文件\n│  ├─README.md          README 文件\n│  └─start.php          框架引导文件\n├─build.php             自动生成定义文件（参考）\n├─composer.json         composer 定义文件\n├─LICENSE.txt           授权说明文件\n├─README.md             README 文件\n├─think                 命令行入口文件\n```\n\n<div class = \"note danger\">\n如果是 mac 或者 linux 环境，请确保 <code>runtime</code> 目录有可写权限\n</div>\n\n<div class = \"note info\">\n5.0 的部署建议是 public 目录作为 web 目录访问内容，其它都是 web 目录之外，当然，你必须要修改 <code>public/index.php</code> 中的相关路径。如果没法做到这点，请记得设置目录的访问权限或者添加目录列表的保护文件。\n</div>\n\n<hr/>\n\n## 新建应用入口文件\n\n在网站的根目录下添加 `index.php` 并加入以下代码：\n\n```php\n<?php\n// +----------------------------------------------------------------------\n// | ThinkPHP [ WE CAN DO IT JUST THINK ]\n// +----------------------------------------------------------------------\n// | Copyright (c) 2006-2018 http://thinkphp.cn All rights reserved.\n// +----------------------------------------------------------------------\n// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )\n// +----------------------------------------------------------------------\n// | Author: liu21st <liu21st@gmail.com>\n// +----------------------------------------------------------------------\n\n// [ 应用入口文件 ]\nnamespace think;\n\nheader(\"Access-Control-Allow-Origin: http://localhost:8080\");//  add by euphoria\nheader(\"Access-Control-Allow-Credentials: true\");//  add by euphoria\n\ndefine('APP_PATH', __DIR__ . '/application/');\n// 加载基础文件\nrequire __DIR__ . '/thinkphp/base.php';\n\n// 支持事先使用静态方法设置Request对象和Config对象\n\n// 执行应用并响应\nContainer::get('app')->run()->send();\n```\n\n<hr/>\n\n## Apache 配置伪静态\n\n### 启用 Rewrite\n\n在终端下输入：\n\n```bash\nfind / -name httpd.conf\n```\n\n找到 Apache 的配置文件 `httpd.conf`，找到 `# LoadModule rewrite_module modules/mod_rewrite.so` 去除前面的 #，开启伪静态模块。\n\n### 启动 .htaccess\n\n在系统配置项中找到 Apache 的配置文件 `/etc/httpd/conf/httpd.conf`\n\n将 `AllowOverride None` 修改为： `AllowOverride All`\n\n> 对于配置文件，建议在修改前做下备份\n\n对于网站的伪静态，可以配置为这样：\n\n```yml\n<IfModule mod_rewrite.c>\n  Options +FollowSymlinks -Multiviews\n  RewriteEngine On\n\n  RewriteCond %{REQUEST_FILENAME} !-d\n  RewriteCond %{REQUEST_FILENAME} !-f\n  RewriteRule ^(.*)$ index.php/$1 [QSA,PT,L]\n</IfModule>\n```\n\n如果你的服务器采用的 <a href = \"https://www.bt.cn\">宝塔运维面板</a>，那么可以直接在网站设置中配置伪静态。\n\n### 添加自己的视图模块\n\n在你需要的地方创建你的视图文件夹，修改 `/application/index/controller/index.php`：\n\n```php\n<?php\nnamespace app\\index\\controller;\n\nuse think\\Controller;\n\nclass Index  extends Controller\n{\n    public function main()\n    {\n        $this->redirect('https://xxxx.xxxxx.xxxx/你的视图文件目录/');\n    }\n}\n```\n\n也就是加了个重定向过去就好\n\n<hr/>\n\n## 添加自己的 Controller\n\n在 `/application/` 目录下创建一个模块文件夹，里面再创建好控制器 Controller 目录，然后就可以写接口文件了（比如 Main.php）\n\n```php\n<?php\n\nnamespace app\\interfaces\\controller; // 这个根据你的文件目录要改 interfaces 这一段话\n\nuse think\\Controller;\n\nclass Main extends Controller {\n    /**\n    * 默认入口方法\n    */\n    public function main() {\n        return json(\"OK\");\n    }\n    \n    /**\n    * 其余方法\n    */\n    public function demo() {\n        return json(\"...\");\n    }\n}\n```\n\n然后就可以通过路由去调用你的接口啦，前端的事情就交给前端去处理吧！\n","source":"_posts/在Apache上开始部署ThinkPHP5.md","raw":"---\ntitle: 在Apache上开始部署ThinkPHP5\ndate: 2019-09-23 18:09:43\ntags:\n- PHP\n- ThinkPHP5\n- Apache\ncategories:\n- PHP\n- ThinkPHP5\ncopyright: true\n---\n\n> <span class = 'introduction'>真正的才智是刚毅的志向。</span><br/>\nThinkPHP框架 - 是由上海顶想公司开发维护的 MVC 结构的开源 PHP 框架，遵循 Apache2 开源协议发布，是为了敏捷 WEB 应用开发和简化企业应用开发而诞生的。\n\n<!--more-->\n\n<hr/>\n\n## Think PHP 框架\n\n我们可以在 <a href = \"http://www.thinkphp.cn/down.html\">Think PHP框架官网</a> 进行下载，然后将其直接解压至网站根目录下。\n\n他的目录结构如下：\n\n```\nproject  应用部署目录\n├─application           应用目录（可设置）\n│  ├─common             公共模块目录（可更改）\n│  ├─index              模块目录(可更改)\n│  │  ├─config.php      模块配置文件\n│  │  ├─common.php      模块函数文件\n│  │  ├─controller      控制器目录\n│  │  ├─model           模型目录\n│  │  ├─view            视图目录\n│  │  └─ ...            更多类库目录\n│  ├─command.php        命令行工具配置文件\n│  ├─common.php         应用公共（函数）文件\n│  ├─config.php         应用（公共）配置文件\n│  ├─database.php       数据库配置文件\n│  ├─tags.php           应用行为扩展定义文件\n│  └─route.php          路由配置文件\n├─extend                扩展类库目录（可定义）\n├─public                WEB 部署目录（对外访问目录）\n│  ├─static             静态资源存放目录(css,js,image)\n│  ├─index.php          应用入口文件\n│  ├─router.php         快速测试文件\n│  └─.htaccess          用于 apache 的重写\n├─runtime               应用的运行时目录（可写，可设置）\n├─vendor                第三方类库目录（Composer）\n├─thinkphp              框架系统目录\n│  ├─lang               语言包目录\n│  ├─library            框架核心类库目录\n│  │  ├─think           Think 类库包目录\n│  │  └─traits          系统 Traits 目录\n│  ├─tpl                系统模板目录\n│  ├─.htaccess          用于 apache 的重写\n│  ├─.travis.yml        CI 定义文件\n│  ├─base.php           基础定义文件\n│  ├─composer.json      composer 定义文件\n│  ├─console.php        控制台入口文件\n│  ├─convention.php     惯例配置文件\n│  ├─helper.php         助手函数文件（可选）\n│  ├─LICENSE.txt        授权说明文件\n│  ├─phpunit.xml        单元测试配置文件\n│  ├─README.md          README 文件\n│  └─start.php          框架引导文件\n├─build.php             自动生成定义文件（参考）\n├─composer.json         composer 定义文件\n├─LICENSE.txt           授权说明文件\n├─README.md             README 文件\n├─think                 命令行入口文件\n```\n\n<div class = \"note danger\">\n如果是 mac 或者 linux 环境，请确保 <code>runtime</code> 目录有可写权限\n</div>\n\n<div class = \"note info\">\n5.0 的部署建议是 public 目录作为 web 目录访问内容，其它都是 web 目录之外，当然，你必须要修改 <code>public/index.php</code> 中的相关路径。如果没法做到这点，请记得设置目录的访问权限或者添加目录列表的保护文件。\n</div>\n\n<hr/>\n\n## 新建应用入口文件\n\n在网站的根目录下添加 `index.php` 并加入以下代码：\n\n```php\n<?php\n// +----------------------------------------------------------------------\n// | ThinkPHP [ WE CAN DO IT JUST THINK ]\n// +----------------------------------------------------------------------\n// | Copyright (c) 2006-2018 http://thinkphp.cn All rights reserved.\n// +----------------------------------------------------------------------\n// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )\n// +----------------------------------------------------------------------\n// | Author: liu21st <liu21st@gmail.com>\n// +----------------------------------------------------------------------\n\n// [ 应用入口文件 ]\nnamespace think;\n\nheader(\"Access-Control-Allow-Origin: http://localhost:8080\");//  add by euphoria\nheader(\"Access-Control-Allow-Credentials: true\");//  add by euphoria\n\ndefine('APP_PATH', __DIR__ . '/application/');\n// 加载基础文件\nrequire __DIR__ . '/thinkphp/base.php';\n\n// 支持事先使用静态方法设置Request对象和Config对象\n\n// 执行应用并响应\nContainer::get('app')->run()->send();\n```\n\n<hr/>\n\n## Apache 配置伪静态\n\n### 启用 Rewrite\n\n在终端下输入：\n\n```bash\nfind / -name httpd.conf\n```\n\n找到 Apache 的配置文件 `httpd.conf`，找到 `# LoadModule rewrite_module modules/mod_rewrite.so` 去除前面的 #，开启伪静态模块。\n\n### 启动 .htaccess\n\n在系统配置项中找到 Apache 的配置文件 `/etc/httpd/conf/httpd.conf`\n\n将 `AllowOverride None` 修改为： `AllowOverride All`\n\n> 对于配置文件，建议在修改前做下备份\n\n对于网站的伪静态，可以配置为这样：\n\n```yml\n<IfModule mod_rewrite.c>\n  Options +FollowSymlinks -Multiviews\n  RewriteEngine On\n\n  RewriteCond %{REQUEST_FILENAME} !-d\n  RewriteCond %{REQUEST_FILENAME} !-f\n  RewriteRule ^(.*)$ index.php/$1 [QSA,PT,L]\n</IfModule>\n```\n\n如果你的服务器采用的 <a href = \"https://www.bt.cn\">宝塔运维面板</a>，那么可以直接在网站设置中配置伪静态。\n\n### 添加自己的视图模块\n\n在你需要的地方创建你的视图文件夹，修改 `/application/index/controller/index.php`：\n\n```php\n<?php\nnamespace app\\index\\controller;\n\nuse think\\Controller;\n\nclass Index  extends Controller\n{\n    public function main()\n    {\n        $this->redirect('https://xxxx.xxxxx.xxxx/你的视图文件目录/');\n    }\n}\n```\n\n也就是加了个重定向过去就好\n\n<hr/>\n\n## 添加自己的 Controller\n\n在 `/application/` 目录下创建一个模块文件夹，里面再创建好控制器 Controller 目录，然后就可以写接口文件了（比如 Main.php）\n\n```php\n<?php\n\nnamespace app\\interfaces\\controller; // 这个根据你的文件目录要改 interfaces 这一段话\n\nuse think\\Controller;\n\nclass Main extends Controller {\n    /**\n    * 默认入口方法\n    */\n    public function main() {\n        return json(\"OK\");\n    }\n    \n    /**\n    * 其余方法\n    */\n    public function demo() {\n        return json(\"...\");\n    }\n}\n```\n\n然后就可以通过路由去调用你的接口啦，前端的事情就交给前端去处理吧！\n","slug":"在Apache上开始部署ThinkPHP5","published":1,"updated":"2020-01-14T20:30:48.005Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn6g001a2lwj1hmr1a7a","content":"<blockquote>\n<p><span class=\"introduction\">真正的才智是刚毅的志向。</span><br><br>ThinkPHP框架 - 是由上海顶想公司开发维护的 MVC 结构的开源 PHP 框架，遵循 Apache2 开源协议发布，是为了敏捷 WEB 应用开发和简化企业应用开发而诞生的。</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"Think-PHP-框架\"><a href=\"#Think-PHP-框架\" class=\"headerlink\" title=\"Think PHP 框架\"></a>Think PHP 框架</h2><p>我们可以在 <a href=\"http://www.thinkphp.cn/down.html\">Think PHP框架官网</a> 进行下载，然后将其直接解压至网站根目录下。</p>\n<p>他的目录结构如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">project  应用部署目录</span><br><span class=\"line\">├─application           应用目录（可设置）</span><br><span class=\"line\">│  ├─common             公共模块目录（可更改）</span><br><span class=\"line\">│  ├─index              模块目录(可更改)</span><br><span class=\"line\">│  │  ├─config.php      模块配置文件</span><br><span class=\"line\">│  │  ├─common.php      模块函数文件</span><br><span class=\"line\">│  │  ├─controller      控制器目录</span><br><span class=\"line\">│  │  ├─model           模型目录</span><br><span class=\"line\">│  │  ├─view            视图目录</span><br><span class=\"line\">│  │  └─ ...            更多类库目录</span><br><span class=\"line\">│  ├─command.php        命令行工具配置文件</span><br><span class=\"line\">│  ├─common.php         应用公共（函数）文件</span><br><span class=\"line\">│  ├─config.php         应用（公共）配置文件</span><br><span class=\"line\">│  ├─database.php       数据库配置文件</span><br><span class=\"line\">│  ├─tags.php           应用行为扩展定义文件</span><br><span class=\"line\">│  └─route.php          路由配置文件</span><br><span class=\"line\">├─extend                扩展类库目录（可定义）</span><br><span class=\"line\">├─public                WEB 部署目录（对外访问目录）</span><br><span class=\"line\">│  ├─static             静态资源存放目录(css,js,image)</span><br><span class=\"line\">│  ├─index.php          应用入口文件</span><br><span class=\"line\">│  ├─router.php         快速测试文件</span><br><span class=\"line\">│  └─.htaccess          用于 apache 的重写</span><br><span class=\"line\">├─runtime               应用的运行时目录（可写，可设置）</span><br><span class=\"line\">├─vendor                第三方类库目录（Composer）</span><br><span class=\"line\">├─thinkphp              框架系统目录</span><br><span class=\"line\">│  ├─lang               语言包目录</span><br><span class=\"line\">│  ├─library            框架核心类库目录</span><br><span class=\"line\">│  │  ├─think           Think 类库包目录</span><br><span class=\"line\">│  │  └─traits          系统 Traits 目录</span><br><span class=\"line\">│  ├─tpl                系统模板目录</span><br><span class=\"line\">│  ├─.htaccess          用于 apache 的重写</span><br><span class=\"line\">│  ├─.travis.yml        CI 定义文件</span><br><span class=\"line\">│  ├─base.php           基础定义文件</span><br><span class=\"line\">│  ├─composer.json      composer 定义文件</span><br><span class=\"line\">│  ├─console.php        控制台入口文件</span><br><span class=\"line\">│  ├─convention.php     惯例配置文件</span><br><span class=\"line\">│  ├─helper.php         助手函数文件（可选）</span><br><span class=\"line\">│  ├─LICENSE.txt        授权说明文件</span><br><span class=\"line\">│  ├─phpunit.xml        单元测试配置文件</span><br><span class=\"line\">│  ├─README.md          README 文件</span><br><span class=\"line\">│  └─start.php          框架引导文件</span><br><span class=\"line\">├─build.php             自动生成定义文件（参考）</span><br><span class=\"line\">├─composer.json         composer 定义文件</span><br><span class=\"line\">├─LICENSE.txt           授权说明文件</span><br><span class=\"line\">├─README.md             README 文件</span><br><span class=\"line\">├─think                 命令行入口文件</span><br></pre></td></tr></table></figure>\n\n<div class=\"note danger\">\n如果是 mac 或者 linux 环境，请确保 <code>runtime</code> 目录有可写权限\n</div>\n\n<div class=\"note info\">\n5.0 的部署建议是 public 目录作为 web 目录访问内容，其它都是 web 目录之外，当然，你必须要修改 <code>public/index.php</code> 中的相关路径。如果没法做到这点，请记得设置目录的访问权限或者添加目录列表的保护文件。\n</div>\n\n<hr>\n\n<h2 id=\"新建应用入口文件\"><a href=\"#新建应用入口文件\" class=\"headerlink\" title=\"新建应用入口文件\"></a>新建应用入口文件</h2><p>在网站的根目录下添加 <code>index.php</code> 并加入以下代码：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"comment\">// +----------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">// | ThinkPHP [ WE CAN DO IT JUST THINK ]</span></span><br><span class=\"line\"><span class=\"comment\">// +----------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">// | Copyright (c) 2006-2018 http://thinkphp.cn All rights reserved.</span></span><br><span class=\"line\"><span class=\"comment\">// +----------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )</span></span><br><span class=\"line\"><span class=\"comment\">// +----------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">// | Author: liu21st &lt;liu21st@gmail.com&gt;</span></span><br><span class=\"line\"><span class=\"comment\">// +----------------------------------------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// [ 应用入口文件 ]</span></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">think</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">header(<span class=\"string\">\"Access-Control-Allow-Origin: http://localhost:8080\"</span>);<span class=\"comment\">//  add by euphoria</span></span><br><span class=\"line\">header(<span class=\"string\">\"Access-Control-Allow-Credentials: true\"</span>);<span class=\"comment\">//  add by euphoria</span></span><br><span class=\"line\"></span><br><span class=\"line\">define(<span class=\"string\">'APP_PATH'</span>, <span class=\"keyword\">__DIR__</span> . <span class=\"string\">'/application/'</span>);</span><br><span class=\"line\"><span class=\"comment\">// 加载基础文件</span></span><br><span class=\"line\"><span class=\"keyword\">require</span> <span class=\"keyword\">__DIR__</span> . <span class=\"string\">'/thinkphp/base.php'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 支持事先使用静态方法设置Request对象和Config对象</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 执行应用并响应</span></span><br><span class=\"line\">Container::get(<span class=\"string\">'app'</span>)-&gt;run()-&gt;send();</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"Apache-配置伪静态\"><a href=\"#Apache-配置伪静态\" class=\"headerlink\" title=\"Apache 配置伪静态\"></a>Apache 配置伪静态</h2><h3 id=\"启用-Rewrite\"><a href=\"#启用-Rewrite\" class=\"headerlink\" title=\"启用 Rewrite\"></a>启用 Rewrite</h3><p>在终端下输入：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find / -name httpd.conf</span><br></pre></td></tr></table></figure>\n\n<p>找到 Apache 的配置文件 <code>httpd.conf</code>，找到 <code># LoadModule rewrite_module modules/mod_rewrite.so</code> 去除前面的 #，开启伪静态模块。</p>\n<h3 id=\"启动-htaccess\"><a href=\"#启动-htaccess\" class=\"headerlink\" title=\"启动 .htaccess\"></a>启动 .htaccess</h3><p>在系统配置项中找到 Apache 的配置文件 <code>/etc/httpd/conf/httpd.conf</code></p>\n<p>将 <code>AllowOverride None</code> 修改为： <code>AllowOverride All</code></p>\n<blockquote>\n<p>对于配置文件，建议在修改前做下备份</p>\n</blockquote>\n<p>对于网站的伪静态，可以配置为这样：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&lt;IfModule</span> <span class=\"string\">mod_rewrite.c&gt;</span></span><br><span class=\"line\">  <span class=\"string\">Options</span> <span class=\"string\">+FollowSymlinks</span> <span class=\"string\">-Multiviews</span></span><br><span class=\"line\">  <span class=\"string\">RewriteEngine</span> <span class=\"string\">On</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"string\">RewriteCond</span> <span class=\"string\">%&#123;REQUEST_FILENAME&#125;</span> <span class=\"string\">!-d</span></span><br><span class=\"line\">  <span class=\"string\">RewriteCond</span> <span class=\"string\">%&#123;REQUEST_FILENAME&#125;</span> <span class=\"string\">!-f</span></span><br><span class=\"line\">  <span class=\"string\">RewriteRule</span> <span class=\"string\">^(.*)$</span> <span class=\"string\">index.php/$1</span> <span class=\"string\">[QSA,PT,L]</span></span><br><span class=\"line\"><span class=\"string\">&lt;/IfModule&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>如果你的服务器采用的 <a href=\"https://www.bt.cn\">宝塔运维面板</a>，那么可以直接在网站设置中配置伪静态。</p>\n<h3 id=\"添加自己的视图模块\"><a href=\"#添加自己的视图模块\" class=\"headerlink\" title=\"添加自己的视图模块\"></a>添加自己的视图模块</h3><p>在你需要的地方创建你的视图文件夹，修改 <code>/application/index/controller/index.php</code>：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">app</span>\\<span class=\"title\">index</span>\\<span class=\"title\">controller</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">think</span>\\<span class=\"title\">Controller</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Index</span>  <span class=\"keyword\">extends</span> <span class=\"title\">Controller</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;redirect(<span class=\"string\">'https://xxxx.xxxxx.xxxx/你的视图文件目录/'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>也就是加了个重定向过去就好</p>\n<hr>\n\n<h2 id=\"添加自己的-Controller\"><a href=\"#添加自己的-Controller\" class=\"headerlink\" title=\"添加自己的 Controller\"></a>添加自己的 Controller</h2><p>在 <code>/application/</code> 目录下创建一个模块文件夹，里面再创建好控制器 Controller 目录，然后就可以写接口文件了（比如 Main.php）</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">app</span>\\<span class=\"title\">interfaces</span>\\<span class=\"title\">controller</span>; <span class=\"comment\">// 这个根据你的文件目录要改 interfaces 这一段话</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">think</span>\\<span class=\"title\">Controller</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> <span class=\"keyword\">extends</span> <span class=\"title\">Controller</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 默认入口方法</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> json(<span class=\"string\">\"OK\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 其余方法</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">demo</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> json(<span class=\"string\">\"...\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>然后就可以通过路由去调用你的接口啦，前端的事情就交给前端去处理吧！</p>\n","site":{"data":{}},"length":3471,"excerpt":"<blockquote>\n<p><span class=\"introduction\">真正的才智是刚毅的志向。</span><br><br>ThinkPHP框架 - 是由上海顶想公司开发维护的 MVC 结构的开源 PHP 框架，遵循 Apache2 开源协议发布，是为了敏捷 WEB 应用开发和简化企业应用开发而诞生的。</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"Think-PHP-框架\"><a href=\"#Think-PHP-框架\" class=\"headerlink\" title=\"Think PHP 框架\"></a>Think PHP 框架</h2><p>我们可以在 <a href=\"http://www.thinkphp.cn/down.html\">Think PHP框架官网</a> 进行下载，然后将其直接解压至网站根目录下。</p>\n<p>他的目录结构如下：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">project  应用部署目录</span><br><span class=\"line\">├─application           应用目录（可设置）</span><br><span class=\"line\">│  ├─common             公共模块目录（可更改）</span><br><span class=\"line\">│  ├─index              模块目录(可更改)</span><br><span class=\"line\">│  │  ├─config.php      模块配置文件</span><br><span class=\"line\">│  │  ├─common.php      模块函数文件</span><br><span class=\"line\">│  │  ├─controller      控制器目录</span><br><span class=\"line\">│  │  ├─model           模型目录</span><br><span class=\"line\">│  │  ├─view            视图目录</span><br><span class=\"line\">│  │  └─ ...            更多类库目录</span><br><span class=\"line\">│  ├─command.php        命令行工具配置文件</span><br><span class=\"line\">│  ├─common.php         应用公共（函数）文件</span><br><span class=\"line\">│  ├─config.php         应用（公共）配置文件</span><br><span class=\"line\">│  ├─database.php       数据库配置文件</span><br><span class=\"line\">│  ├─tags.php           应用行为扩展定义文件</span><br><span class=\"line\">│  └─route.php          路由配置文件</span><br><span class=\"line\">├─extend                扩展类库目录（可定义）</span><br><span class=\"line\">├─public                WEB 部署目录（对外访问目录）</span><br><span class=\"line\">│  ├─static             静态资源存放目录(css,js,image)</span><br><span class=\"line\">│  ├─index.php          应用入口文件</span><br><span class=\"line\">│  ├─router.php         快速测试文件</span><br><span class=\"line\">│  └─.htaccess          用于 apache 的重写</span><br><span class=\"line\">├─runtime               应用的运行时目录（可写，可设置）</span><br><span class=\"line\">├─vendor                第三方类库目录（Composer）</span><br><span class=\"line\">├─thinkphp              框架系统目录</span><br><span class=\"line\">│  ├─lang               语言包目录</span><br><span class=\"line\">│  ├─library            框架核心类库目录</span><br><span class=\"line\">│  │  ├─think           Think 类库包目录</span><br><span class=\"line\">│  │  └─traits          系统 Traits 目录</span><br><span class=\"line\">│  ├─tpl                系统模板目录</span><br><span class=\"line\">│  ├─.htaccess          用于 apache 的重写</span><br><span class=\"line\">│  ├─.travis.yml        CI 定义文件</span><br><span class=\"line\">│  ├─base.php           基础定义文件</span><br><span class=\"line\">│  ├─composer.json      composer 定义文件</span><br><span class=\"line\">│  ├─console.php        控制台入口文件</span><br><span class=\"line\">│  ├─convention.php     惯例配置文件</span><br><span class=\"line\">│  ├─helper.php         助手函数文件（可选）</span><br><span class=\"line\">│  ├─LICENSE.txt        授权说明文件</span><br><span class=\"line\">│  ├─phpunit.xml        单元测试配置文件</span><br><span class=\"line\">│  ├─README.md          README 文件</span><br><span class=\"line\">│  └─start.php          框架引导文件</span><br><span class=\"line\">├─build.php             自动生成定义文件（参考）</span><br><span class=\"line\">├─composer.json         composer 定义文件</span><br><span class=\"line\">├─LICENSE.txt           授权说明文件</span><br><span class=\"line\">├─README.md             README 文件</span><br><span class=\"line\">├─think                 命令行入口文件</span><br></pre></td></tr></table></figure>\n\n<div class=\"note danger\">\n如果是 mac 或者 linux 环境，请确保 <code>runtime</code> 目录有可写权限\n</div>\n\n<div class=\"note info\">\n5.0 的部署建议是 public 目录作为 web 目录访问内容，其它都是 web 目录之外，当然，你必须要修改 <code>public/index.php</code> 中的相关路径。如果没法做到这点，请记得设置目录的访问权限或者添加目录列表的保护文件。\n</div>\n\n<hr>\n\n<h2 id=\"新建应用入口文件\"><a href=\"#新建应用入口文件\" class=\"headerlink\" title=\"新建应用入口文件\"></a>新建应用入口文件</h2><p>在网站的根目录下添加 <code>index.php</code> 并加入以下代码：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"comment\">// +----------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">// | ThinkPHP [ WE CAN DO IT JUST THINK ]</span></span><br><span class=\"line\"><span class=\"comment\">// +----------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">// | Copyright (c) 2006-2018 http://thinkphp.cn All rights reserved.</span></span><br><span class=\"line\"><span class=\"comment\">// +----------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )</span></span><br><span class=\"line\"><span class=\"comment\">// +----------------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\">// | Author: liu21st &lt;liu21st@gmail.com&gt;</span></span><br><span class=\"line\"><span class=\"comment\">// +----------------------------------------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// [ 应用入口文件 ]</span></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">think</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">header(<span class=\"string\">\"Access-Control-Allow-Origin: http://localhost:8080\"</span>);<span class=\"comment\">//  add by euphoria</span></span><br><span class=\"line\">header(<span class=\"string\">\"Access-Control-Allow-Credentials: true\"</span>);<span class=\"comment\">//  add by euphoria</span></span><br><span class=\"line\"></span><br><span class=\"line\">define(<span class=\"string\">'APP_PATH'</span>, <span class=\"keyword\">__DIR__</span> . <span class=\"string\">'/application/'</span>);</span><br><span class=\"line\"><span class=\"comment\">// 加载基础文件</span></span><br><span class=\"line\"><span class=\"keyword\">require</span> <span class=\"keyword\">__DIR__</span> . <span class=\"string\">'/thinkphp/base.php'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 支持事先使用静态方法设置Request对象和Config对象</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 执行应用并响应</span></span><br><span class=\"line\">Container::get(<span class=\"string\">'app'</span>)-&gt;run()-&gt;send();</span><br></pre></td></tr></table></figure>\n\n<hr>\n\n<h2 id=\"Apache-配置伪静态\"><a href=\"#Apache-配置伪静态\" class=\"headerlink\" title=\"Apache 配置伪静态\"></a>Apache 配置伪静态</h2><h3 id=\"启用-Rewrite\"><a href=\"#启用-Rewrite\" class=\"headerlink\" title=\"启用 Rewrite\"></a>启用 Rewrite</h3><p>在终端下输入：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">find / -name httpd.conf</span><br></pre></td></tr></table></figure>\n\n<p>找到 Apache 的配置文件 <code>httpd.conf</code>，找到 <code># LoadModule rewrite_module modules/mod_rewrite.so</code> 去除前面的 #，开启伪静态模块。</p>\n<h3 id=\"启动-htaccess\"><a href=\"#启动-htaccess\" class=\"headerlink\" title=\"启动 .htaccess\"></a>启动 .htaccess</h3><p>在系统配置项中找到 Apache 的配置文件 <code>/etc/httpd/conf/httpd.conf</code></p>\n<p>将 <code>AllowOverride None</code> 修改为： <code>AllowOverride All</code></p>\n<blockquote>\n<p>对于配置文件，建议在修改前做下备份</p>\n</blockquote>\n<p>对于网站的伪静态，可以配置为这样：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&lt;IfModule</span> <span class=\"string\">mod_rewrite.c&gt;</span></span><br><span class=\"line\">  <span class=\"string\">Options</span> <span class=\"string\">+FollowSymlinks</span> <span class=\"string\">-Multiviews</span></span><br><span class=\"line\">  <span class=\"string\">RewriteEngine</span> <span class=\"string\">On</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"string\">RewriteCond</span> <span class=\"string\">%&#123;REQUEST_FILENAME&#125;</span> <span class=\"string\">!-d</span></span><br><span class=\"line\">  <span class=\"string\">RewriteCond</span> <span class=\"string\">%&#123;REQUEST_FILENAME&#125;</span> <span class=\"string\">!-f</span></span><br><span class=\"line\">  <span class=\"string\">RewriteRule</span> <span class=\"string\">^(.*)$</span> <span class=\"string\">index.php/$1</span> <span class=\"string\">[QSA,PT,L]</span></span><br><span class=\"line\"><span class=\"string\">&lt;/IfModule&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>如果你的服务器采用的 <a href=\"https://www.bt.cn\">宝塔运维面板</a>，那么可以直接在网站设置中配置伪静态。</p>\n<h3 id=\"添加自己的视图模块\"><a href=\"#添加自己的视图模块\" class=\"headerlink\" title=\"添加自己的视图模块\"></a>添加自己的视图模块</h3><p>在你需要的地方创建你的视图文件夹，修改 <code>/application/index/controller/index.php</code>：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">app</span>\\<span class=\"title\">index</span>\\<span class=\"title\">controller</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">think</span>\\<span class=\"title\">Controller</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Index</span>  <span class=\"keyword\">extends</span> <span class=\"title\">Controller</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">main</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;redirect(<span class=\"string\">'https://xxxx.xxxxx.xxxx/你的视图文件目录/'</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>也就是加了个重定向过去就好</p>\n<hr>\n\n<h2 id=\"添加自己的-Controller\"><a href=\"#添加自己的-Controller\" class=\"headerlink\" title=\"添加自己的 Controller\"></a>添加自己的 Controller</h2><p>在 <code>/application/</code> 目录下创建一个模块文件夹，里面再创建好控制器 Controller 目录，然后就可以写接口文件了（比如 Main.php）</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">app</span>\\<span class=\"title\">interfaces</span>\\<span class=\"title\">controller</span>; <span class=\"comment\">// 这个根据你的文件目录要改 interfaces 这一段话</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">use</span> <span class=\"title\">think</span>\\<span class=\"title\">Controller</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> <span class=\"keyword\">extends</span> <span class=\"title\">Controller</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 默认入口方法</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">main</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> json(<span class=\"string\">\"OK\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 其余方法</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">demo</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> json(<span class=\"string\">\"...\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>然后就可以通过路由去调用你的接口啦，前端的事情就交给前端去处理吧！</p>"},{"title":"来说说TCP的三次握手和四次挥手吧","date":"2020-01-19T12:38:53.000Z","copyright":true,"_content":"\n> <span class = 'introduction'>活得快乐的最重要因素是人生有事干、有人可去爱，以及生命中有所冀望。</span><br/>\n在面试中，三次握手和四次挥手可以说是问的最频繁的一个知识点了。今天重点围绕着面试，我们应该掌握哪些比较重要的点，哪些是比较被面试官给问到的呢？\n\n<!--more-->\n\n<hr/>\n\n## TCP 报文格式\n\n在了解三次握手和四次挥手之前，先知道TCP报文内部包含了哪些东西。\n\n<img src=\"./TcpMessage.png\" alt=\"TCP 报文格式\" />\n\nTCP 报头中的源端口号和目的端口号同 IP 数据报中的源 IP 与目的 IP 唯一确定一条 TCP 连接。TCP在发送数据前必须在彼此间建立连接，这里连接意思是：双方需要内保存对方信息（例如：IP，Port…）\n\n报文主要段的意思大致是这样：\n\n|字段|含义|\n|:---|:---|\n|序号|表示发送的数据字节流，确保 TCP 传输有序，对每个字节编号|\n|确认序号|发送方期待接收的下一序列号，接收成功后的数据字节序列号加 1。只有 ACK = 1 时才有效。|\n|URG|紧急指针是否有效。如果为 1，则表示某一位需要被优先处理（告知系统此报文段有紧急数据）|\n|ACK|确认号是否有效，一般置为 1|\n|PSH|提示接收端应用程序立即从 TCP 缓冲区把数据读走（Push，一般 PSH = 1 的情况只出现在 DATA 内容不为 0 的包中，即表示有真正的 TCP 数据包内容被传递）|\n|RST|对方要求重新建立连接，复位。当 RST = 1 时，表明 TCP 连接中出现严重差错，必须释放连接再重新建立连接|\n|SYN|请求建立连接，并在其序列号的字段进行序列号的初始值设定。建立连接，设置为 1|\n|FIN|希望断开连接，当 FIN = 1 时，表明此报文段的发送方数据已经发送完毕，要求断开连接|\n\n<hr />\n\n## 状态值（不看这个是看不懂接下来的东西的哦）\n\n|状态名|含义|\n|:---|:---|\n|Listen|侦听来自远方 TCP 端口的连接请求|\n|SYN-Sent|在发送连接请求后等待匹配的连接请求|\n|SYN-Received|在收到和发送一个连接请求等待对连接请求的确认|\n|Established|代表一个打开的连接，数据可以传送|\n|FIN-Wait-1|等待远程 TCP 的连接中断请求，或先前的连接中断请求的确认|\n|FIN-Wait-2|从远程 TCP 连接中断请求|\n|Close-Wait|等待从本地用户发来的连接中断请求|\n|Last-ACK|等待原来发向远程 TCP 的连接中断请求的确认|\n|Time-Wait|等待的时间以确保远程 TCP 接收到连接中断请求的确认|  \n|Closed|没有任何连接状态|\n\n<hr />\n\n## 三次握手\n\n### 过程\n\n#### 正经一点的\n\n**刚开始客户端处于 closed 的状态，服务端处于 listen 状态**。然后：\n\n1. 第一次握手：客户端给服务端发一个 `SYN` 报文，并指明客户端的初始化序列号 `ISN(c)`。此时客户端处于 **`SYN_Sent`** 状态。\n2. 第二次握手：服务器收到客户端的 `SYN` 报文之后，会以自己的 `SYN` 报文作为应答，并且也是指定了自己的初始化序列号 `ISN(s)`，同时会把客户端的 `ISN + 1` 作为 `ACK` 的值，表示自己已经收到了客户端的 `SYN`，此时服务器处于 **`SYN_REVD`** 的状态。\n3. 第三次握手：客户端收到 `SYN` 报文之后，会发送一个 `ACK` 报文，当然，也是一样把服务器的 `ISN + 1` 作为 `ACK` 的值，表示已经收到了服务端的 `SYN` 报文，此时客户端处于 **`establised`** 状态。\n4. 服务器收到 `ACK` 报文之后，也处于 **`establised`** 状态，此时，双方以建立起了链接。\n\n<img src=\"./three.png\" alt=\"TCP 三次握手\" />\n\n来个动图叭：\n\n<img src=\"./three.gif\" alt=\"TCP 三次握手\" />\n\n#### 不正经的\n\n<img src=\"./three01.png\" alt=\"TCP 三次握手\" />\n\n### 为什么得握三次？两次不行吗？\n\n需要三次握手主要是 **双方彼此确认对方的接收与发送能力是否正常**，因为双方中间是有距离的，而除了发包通信又没其他办法联系到对方：\n\n1. 第一次握手：客户端给服务端发包，服务端收到了，那么服务端就知道 **客户端的发送能力没问题**，但此时客户端并不知道服务端收到了它发送的这条消息；\n2. 第二次握手：服务端向客户端回复，此时：\n    1. **客户端知道了服务端发送能力没问题**；\n    2. 既然客户端收到了服务端发来的消息，那么也就证明了，**服务端收到了客户端最开始发送的消息**，即客户端也同时知道了 **服务端的接收能力没问题**；\n3. 第三次握手：客户端向服务端发包，服务端收到了这个回复，那么一定是客户端收到了服务端的上一条消息，这个时候服务端也就知道了 **客户端的接收能力没问题**。\n\n因此，需要三次握手才能确认双方的接收与发送能力是否正常。\n\n<div class=\"note info\">3次握手完成两个重要的功能，既要双方做好发送数据的准备工作（双方都知道彼此已准备好），也要允许双方就初始序列号进行协商，这个序列号在握手过程中被发送和确认。</div>\n\n现在把三次握手改成仅需要两次握手，这样就可能发生 **死锁**。\n\n作为例子，考虑计算机 S 和 C 之间的通信，假定 C 给 S 发送一个连接请求分组，S 收到了这个分组，并发送了确认应答分组。按照两次握手的协定，**S 认为连接已经成功地建立了，可以开始发送数据分组**。可是，C 在 S 的应答分组在传输中被丢失的情况下，将不知道 S 是否已准备好，不知道 S 建立什么样的序列号，**C 甚至怀疑 S 是否收到自己的连接请求分组**。在这种情况下，**C 认为连接还未建立成功，将忽略 S 发来的任何数据分组，只等待连接确认应答分组**。而 S 在发出的分组超时后，重复发送同样的分组。\n\n这样就形成了死锁。\n\n### 三次握手的作用是什么\n\n1. 确认双方的接受能力、发送能力是否正常；\n2. 指定自己的初始化序列号，为后面的可靠传送做准备；\n3. 如果是 https 协议的话，三次握手这个过程，还会进行数字证书的验证以及加密密钥的生成。\n\n### 三次握手中可以携带数据吗\n\n第一次、第二次握手不可以携带数据，而第三次握手是可以携带数据。\n\n<div class=\"note danger\"><b>假如第一次握手可以携带数据</b> 的话，如果有人要恶意攻击服务器，那他每次都在第一次握手中的 <code>SYN</code> 报文中放入大量的数据，因为 <b>攻击者根本就不理服务器的接收、发送能力是否正常</b>，然后疯狂着重复发 <code>SYN</code> 报文的话，这会让服务器花费很多时间、内存空间来接收这些报文。也就是说，第一次握手可以放数据的话，其中一个简单的原因就是会让服务器更加容易受到攻击了。</div>\n\n而对于第三次的话，此时客户端已经处于 **`established`** 状态，也就是说，对于客户端来说，他已经建立起连接了，并且也已经知道服务器的接收、发送能力是正常的了，所以能携带数据页没啥毛病。\n\n### （ISN）是固定的吗\n\n三次握手的一个重要功能是客户端和服务端交换 ISN（Initial Sequence Number）, 以便让对方知道接下来接收数据的时候如何按序列号组装数据。\n\n如果 `ISN` 是固定的，攻击者很容易猜出后续的确认号，**因此 `ISN` 是动态生成的**。\n\n### 什么是半连接队列\n\n服务器第一次收到客户端的 `SYN` 之后，就会处于 **`syn_rcvd`** 状态，此时双方还没有完全建立其连接，服务器会把此种状态下请求连接放在一个队列里，我们把这种队列称之为半连接队列。\n\n**`syn_sent`** 是主动打开方的 **「半打开」状态**，**`syn_rcvd`** 是被动打开方的 **「半打开」状态**。客户端是主动打开方，服务端是被动打开方。\n\n当然还有一个全连接队列，就是已经完成三次握手，建立起连接的就会放在全连接队列中。**如果队列满了就有可能会出现丢包现象**。\n\n<div class=\"note info\">这里再补充一点关于 <b><code>SYN-ACK</code> 重传次数</b> 的问题：服务器发送完 <b><code>SYN-ACK</code></b> 包，如果未收到客户确认包，服务器进行首次重传，等待一段时间仍未收到客户确认包，进行第二次重传，如果重传次数超过系统规定的最大重传次数，系统将该连接信息从半连接队列中删除。注意，每次重传等待的时间不一定相同，一般会是指数增长，例如间隔时间为 1s, 2s, 4s, 8s, ….</div>\n\n### 如果已经建立了连接，但客户端突然出现了故障？\n\n显然，客户端如果出现故障，服务器不能一直等下去，白白浪费资源。\n\n**TCP** 设有一个 **保活计时器**，**服务器每收到一次客户端的请求后都会重新复位这个计时器**，时间通常是设置为 2 小时，若两小时还没有收到客户端的任何数据，服务器就会发送一个**探测报文段**，以后每隔 75 秒钟发送一次。\n\n若一连发送 10 个探测报文仍然没反应，服务器就认为客户端出了故障，接着就关闭连接。\n\n### 其他需要补充的\n\n#### TCP 重传\n\nA 发送了一个 data，如果 B 收到了要向 A 回复自己收到了（ACK），但是如果 A 发送完 data 半天都没得到 B 的回复，那么 A 就会认为自己的 data 半路被大风刮跑了，需要重新发送一遍，**这就是 TCP 重传**。\n\n但是也有可能是 B 收到了 A 的消息，只不过是 B 给 A 的 ACK 回复半路被刮跑了，以至于 A 收不到 B 的回复。\n\n那么既然 A 不能判断究竟是自己的 data 半路没了，还是 B 的回复半路没了，那就干脆不管了，重新发送一遍 data 就行。\n\n既然发生了 TCP 重传，那么 B 就有可能同一个消息收到了多次，这里就需要 **「去重」**，**「重传」** 和 **「去重」** 工作在操作系统的网络内核模块都已经帮我们处理好了，用户层是不用关心的。\n\n#### TCP 的双工通信\n\nA 可以向 B 喊话，同样 B 也可以向 A 喊话，因为 **TCP 链接是「双工的」**，双方都可以主动发起数据传输。\n\n**不过无论是哪方喊话，都需要收到对方的确认才能认为对方收到了自己的喊话。**\n\nA 可能是个高射炮，一连说了八句话，这时候 B 可以不用一句一句回复，而是连续听了这八句话之后，一起向对方回复说前面你说的八句话我都听见了，这就是**批量 ACK**。\n\n网络环境的数据交互同人类之间的对话还要复杂一些，它存在数据包乱序的现象。\n\n同一个来源发出来的不同数据包在 **「网际路由」** 上可能会走过不同的路径，最终达到同一个地方时，顺序就不一样了。\n\n操作系统的网络内核模块会负责对数据包进行排序，到用户层时顺序就已经完全一致了（所以说我们不用管咯？）。\n\n<hr />\n\n## 四次挥手\n\n### 过程\n\n#### 正经一点的\n\n刚开始双方都处于 `establised` 状态，假如是客户端先发起关闭请求，则：\n\n1. 第一次挥手：第一次挥手：客户端发送一个 `FIN` 报文，报文中会指定一个序列号。此时客户端处于 **`FIN-Wait-1`** 状态；\n2. 第二次挥手：服务端收到 `FIN` 之后，会发送 `ACK` 报文，且把 **客户端的序列号值 + 1** 作为 `ACK` 报文的序列号值，表明已经收到客户端的报文了，此时服务端处于 **`Close-Wait`** 状态，客户端收到后进入 **`FIN-Wait-2`** 状态；\n3. 第三次挥手：如果服务端也想断开连接了，和客户端的第一次挥手一样，向客户端发送 `FIN` 报文，且指定一个序列号。此时服务端处于 **Last-ACK** 的状态。\n4. 第四次挥手：客户端收到来自服务端的 `FIN` 之后，一样发送一个 `ACK` 报文作为应答，且把 **服务端的序列号值 + 1** 作为自己 `ACK` 报文的序列号值，此时客户端处于 **`Time-Wait`** 状态。需要过一阵子以 **确保服务端收到** 自己的 `ACK` 报文之后才会进入 **`Closed`** 状态。\n5. 服务端收到 `ACK` 报文之后，就处于关闭连接了，处于 **`Closed`** 状态。\n\n<img src=\"four.png\" alt=\"TCP 四次挥手\" />\n\n也来个动图叭：\n\n<img src=\"four.gif\" alt=\"TCP 四次挥手\" />\n\n#### 不正经的\n\n<img src=\"four01.png\" alt=\"TCP 四次挥手\" />\n\n### 超级重要的 Time-Wait 状态\n\n#### 什么是 Time-Wait\n\n为什么客户端发送 ACK 之后不直接关闭，而是要等一阵子才关闭？\n\n**`Time-Wait`** 是主动关闭的一方在回复完对方的挥手后进入的一个长期状态。\n\n这个状态标准的持续时间是 4 分钟，4 分钟后才会进入到 **`Closed`** 状态，释放套接字资源。不过在具体实现上这个时间是可以调整的。\n\n4 分钟就是 2 个 MSL，每个 MSL 是 2 分钟。MSL 就是 **Maximum Segment Lifetime —— 最长报文寿命**。\n\n这个时间是由官方 RFC 协议规定的。至于为什么是 2 个 MSL 而不是 1 个 MSL，还没有看到一个非常满意的解释。\n\n它就好比主动分手方要承担的责任，是你提出的要分手，你得付出代价。这个后果就是持续 4 分钟的 **`Time-Wait`** 状态，不能释放套接字资源(端口)，就好比守寡期，这段时间内套接字资源(端口)不得回收利用。\n\n它的作用是重传最后一个 `ACK` 报文，确保对方可以收到。因为如果对方没有收到 `ACK` 的话，会重传 `FIN` 报文，处于 **`Time-Wait`** 状态的套接字会立即向对方重发 ack 报文。\n\n即：要确保服务器是否已经收到了我们的 `ACK` 报文，如果没有收到的话，服务器会重新发 `FIN` 报文给客户端，客户端再次收到 `FIN` 报文之后，就知道之前的 `ACK` 报文丢失了，然后再次发送 `ACK` 报文。\n\n#### 为什么必须要经过 2 MSL 才能返回到 Close 状态\n\n虽然按道理，四个报文都发送完毕，我们可以直接进入 **`Close`** 状态了，但是我们必须假象网络是不可靠的，有可以最后一个 `ACK` 丢失。所以 **`Time-Wait`** 状态就是用来重发可能丢失的 `ACK` 报文。\n\n在客户端发送出最后的 `ACK` 回复后，该 `ACK` 可能丢失。服务端如果没有收到 `ACK`，将不断重复发送 `FIN` 片段。**所以客户端不能立即关闭，它必须确认服务端接收到了该 `ACK`**。\n\n客户端会在发送出 `ACK` 之后进入到 **`Time-Wait`** 状态。客户端会设置一个计时器，等待 2 MSL 的时间。\n\n如果在该时间内再次收到 `FIN`（因为服务端没收到客户端最后的 `ACK` 就会重发 `FIN`，如果客户端在等待 2 MSL 的时候又收到了来自服务端的 `FIN`，那就说明自己之前的 `ACK` 丢了），那么客户端会重发 `ACK` 并再次等待 2 MSL。\n\nMSL 指一个片段在网络中最大的存活时间，2 MSL 就是一个发送和一个回复所需的最大时间。如果直到 2 MSL，客户端都没有再次收到来自服务端的 `FIN`，那么服务端就有理由推断自己的最后一个 `ACK` 已经被成功接收，则结束 `TCP` 连接。\n\n### 总是四次挥手吗？\n\n四次挥手也并不总是四次挥手，中间的两个动作有时候是可以合并一起进行的。\n\n这个时候就成了三次挥手，主动关闭方就会从 **`FIN-Wait-1`** 状态直接进入到 **`Time-Wait`** 状态，跳过了 **`FIN-Wait-2`** 状态。\n\n### 为什么连接的时候要三次握手，而关闭的时候要四次挥手\n\n因为当服务端收到客户端端的 `SYN` 连接请求报文后，可以直接发送 `SYN + ACK` 报文。其中 `ACK` 报文是用来应答的，`SYN` 报文是用来同步的。\n\n但是关闭连接时，当服务端端收到 `FIN` 报文时，很可能并不会立即关闭 `SOCKET`，所以只能先回复一个 `ACK` 报文，告诉客户端：**\"你发的 `FIN` 报文我收到了\"**。只有等到我这边（服务端）所有的报文都发送完了，我才能发送 `FIN` 报文，因此不能一起发送。**故需要四步挥手。**\n\n<hr />\n\n## 总结\n\n一图胜千言了...\n\n<img src=\"total.png\" alt=\"总览\" />\n\n<hr />\n\n## 参考资料\n\n- [6张动态图轻松学习TCP三次握手和四次挥手](http://www.sohu.com/a/246199963_463994)\n- [TCP的三次握手与四次挥手理解及面试题（很全面）](https://blog.csdn.net/qq_38950316/article/details/81087809)\n- [关于三次握手与四次挥手面试官想考什么？](https://blog.csdn.net/weixin_44460333/article/details/89369316)\n- [TCP三次握手和四次挥手通俗理解](https://www.cnblogs.com/jainszhang/p/10641728.html)\n- [在深谈TCP/IP三步握手&四步挥手原理及衍生问题——长文解剖IP](http://www.pianshen.com/article/1002102250/)","source":"_posts/来说说TCP的三次握手和四次挥手吧.md","raw":"---\ntitle: 来说说TCP的三次握手和四次挥手吧\ndate: 2020-01-19 20:38:53\ntags:\n- 计算机网络\ncategories:\n- 面经\n- 计算机网络\n- TCP\ncopyright: true\n---\n\n> <span class = 'introduction'>活得快乐的最重要因素是人生有事干、有人可去爱，以及生命中有所冀望。</span><br/>\n在面试中，三次握手和四次挥手可以说是问的最频繁的一个知识点了。今天重点围绕着面试，我们应该掌握哪些比较重要的点，哪些是比较被面试官给问到的呢？\n\n<!--more-->\n\n<hr/>\n\n## TCP 报文格式\n\n在了解三次握手和四次挥手之前，先知道TCP报文内部包含了哪些东西。\n\n<img src=\"./TcpMessage.png\" alt=\"TCP 报文格式\" />\n\nTCP 报头中的源端口号和目的端口号同 IP 数据报中的源 IP 与目的 IP 唯一确定一条 TCP 连接。TCP在发送数据前必须在彼此间建立连接，这里连接意思是：双方需要内保存对方信息（例如：IP，Port…）\n\n报文主要段的意思大致是这样：\n\n|字段|含义|\n|:---|:---|\n|序号|表示发送的数据字节流，确保 TCP 传输有序，对每个字节编号|\n|确认序号|发送方期待接收的下一序列号，接收成功后的数据字节序列号加 1。只有 ACK = 1 时才有效。|\n|URG|紧急指针是否有效。如果为 1，则表示某一位需要被优先处理（告知系统此报文段有紧急数据）|\n|ACK|确认号是否有效，一般置为 1|\n|PSH|提示接收端应用程序立即从 TCP 缓冲区把数据读走（Push，一般 PSH = 1 的情况只出现在 DATA 内容不为 0 的包中，即表示有真正的 TCP 数据包内容被传递）|\n|RST|对方要求重新建立连接，复位。当 RST = 1 时，表明 TCP 连接中出现严重差错，必须释放连接再重新建立连接|\n|SYN|请求建立连接，并在其序列号的字段进行序列号的初始值设定。建立连接，设置为 1|\n|FIN|希望断开连接，当 FIN = 1 时，表明此报文段的发送方数据已经发送完毕，要求断开连接|\n\n<hr />\n\n## 状态值（不看这个是看不懂接下来的东西的哦）\n\n|状态名|含义|\n|:---|:---|\n|Listen|侦听来自远方 TCP 端口的连接请求|\n|SYN-Sent|在发送连接请求后等待匹配的连接请求|\n|SYN-Received|在收到和发送一个连接请求等待对连接请求的确认|\n|Established|代表一个打开的连接，数据可以传送|\n|FIN-Wait-1|等待远程 TCP 的连接中断请求，或先前的连接中断请求的确认|\n|FIN-Wait-2|从远程 TCP 连接中断请求|\n|Close-Wait|等待从本地用户发来的连接中断请求|\n|Last-ACK|等待原来发向远程 TCP 的连接中断请求的确认|\n|Time-Wait|等待的时间以确保远程 TCP 接收到连接中断请求的确认|  \n|Closed|没有任何连接状态|\n\n<hr />\n\n## 三次握手\n\n### 过程\n\n#### 正经一点的\n\n**刚开始客户端处于 closed 的状态，服务端处于 listen 状态**。然后：\n\n1. 第一次握手：客户端给服务端发一个 `SYN` 报文，并指明客户端的初始化序列号 `ISN(c)`。此时客户端处于 **`SYN_Sent`** 状态。\n2. 第二次握手：服务器收到客户端的 `SYN` 报文之后，会以自己的 `SYN` 报文作为应答，并且也是指定了自己的初始化序列号 `ISN(s)`，同时会把客户端的 `ISN + 1` 作为 `ACK` 的值，表示自己已经收到了客户端的 `SYN`，此时服务器处于 **`SYN_REVD`** 的状态。\n3. 第三次握手：客户端收到 `SYN` 报文之后，会发送一个 `ACK` 报文，当然，也是一样把服务器的 `ISN + 1` 作为 `ACK` 的值，表示已经收到了服务端的 `SYN` 报文，此时客户端处于 **`establised`** 状态。\n4. 服务器收到 `ACK` 报文之后，也处于 **`establised`** 状态，此时，双方以建立起了链接。\n\n<img src=\"./three.png\" alt=\"TCP 三次握手\" />\n\n来个动图叭：\n\n<img src=\"./three.gif\" alt=\"TCP 三次握手\" />\n\n#### 不正经的\n\n<img src=\"./three01.png\" alt=\"TCP 三次握手\" />\n\n### 为什么得握三次？两次不行吗？\n\n需要三次握手主要是 **双方彼此确认对方的接收与发送能力是否正常**，因为双方中间是有距离的，而除了发包通信又没其他办法联系到对方：\n\n1. 第一次握手：客户端给服务端发包，服务端收到了，那么服务端就知道 **客户端的发送能力没问题**，但此时客户端并不知道服务端收到了它发送的这条消息；\n2. 第二次握手：服务端向客户端回复，此时：\n    1. **客户端知道了服务端发送能力没问题**；\n    2. 既然客户端收到了服务端发来的消息，那么也就证明了，**服务端收到了客户端最开始发送的消息**，即客户端也同时知道了 **服务端的接收能力没问题**；\n3. 第三次握手：客户端向服务端发包，服务端收到了这个回复，那么一定是客户端收到了服务端的上一条消息，这个时候服务端也就知道了 **客户端的接收能力没问题**。\n\n因此，需要三次握手才能确认双方的接收与发送能力是否正常。\n\n<div class=\"note info\">3次握手完成两个重要的功能，既要双方做好发送数据的准备工作（双方都知道彼此已准备好），也要允许双方就初始序列号进行协商，这个序列号在握手过程中被发送和确认。</div>\n\n现在把三次握手改成仅需要两次握手，这样就可能发生 **死锁**。\n\n作为例子，考虑计算机 S 和 C 之间的通信，假定 C 给 S 发送一个连接请求分组，S 收到了这个分组，并发送了确认应答分组。按照两次握手的协定，**S 认为连接已经成功地建立了，可以开始发送数据分组**。可是，C 在 S 的应答分组在传输中被丢失的情况下，将不知道 S 是否已准备好，不知道 S 建立什么样的序列号，**C 甚至怀疑 S 是否收到自己的连接请求分组**。在这种情况下，**C 认为连接还未建立成功，将忽略 S 发来的任何数据分组，只等待连接确认应答分组**。而 S 在发出的分组超时后，重复发送同样的分组。\n\n这样就形成了死锁。\n\n### 三次握手的作用是什么\n\n1. 确认双方的接受能力、发送能力是否正常；\n2. 指定自己的初始化序列号，为后面的可靠传送做准备；\n3. 如果是 https 协议的话，三次握手这个过程，还会进行数字证书的验证以及加密密钥的生成。\n\n### 三次握手中可以携带数据吗\n\n第一次、第二次握手不可以携带数据，而第三次握手是可以携带数据。\n\n<div class=\"note danger\"><b>假如第一次握手可以携带数据</b> 的话，如果有人要恶意攻击服务器，那他每次都在第一次握手中的 <code>SYN</code> 报文中放入大量的数据，因为 <b>攻击者根本就不理服务器的接收、发送能力是否正常</b>，然后疯狂着重复发 <code>SYN</code> 报文的话，这会让服务器花费很多时间、内存空间来接收这些报文。也就是说，第一次握手可以放数据的话，其中一个简单的原因就是会让服务器更加容易受到攻击了。</div>\n\n而对于第三次的话，此时客户端已经处于 **`established`** 状态，也就是说，对于客户端来说，他已经建立起连接了，并且也已经知道服务器的接收、发送能力是正常的了，所以能携带数据页没啥毛病。\n\n### （ISN）是固定的吗\n\n三次握手的一个重要功能是客户端和服务端交换 ISN（Initial Sequence Number）, 以便让对方知道接下来接收数据的时候如何按序列号组装数据。\n\n如果 `ISN` 是固定的，攻击者很容易猜出后续的确认号，**因此 `ISN` 是动态生成的**。\n\n### 什么是半连接队列\n\n服务器第一次收到客户端的 `SYN` 之后，就会处于 **`syn_rcvd`** 状态，此时双方还没有完全建立其连接，服务器会把此种状态下请求连接放在一个队列里，我们把这种队列称之为半连接队列。\n\n**`syn_sent`** 是主动打开方的 **「半打开」状态**，**`syn_rcvd`** 是被动打开方的 **「半打开」状态**。客户端是主动打开方，服务端是被动打开方。\n\n当然还有一个全连接队列，就是已经完成三次握手，建立起连接的就会放在全连接队列中。**如果队列满了就有可能会出现丢包现象**。\n\n<div class=\"note info\">这里再补充一点关于 <b><code>SYN-ACK</code> 重传次数</b> 的问题：服务器发送完 <b><code>SYN-ACK</code></b> 包，如果未收到客户确认包，服务器进行首次重传，等待一段时间仍未收到客户确认包，进行第二次重传，如果重传次数超过系统规定的最大重传次数，系统将该连接信息从半连接队列中删除。注意，每次重传等待的时间不一定相同，一般会是指数增长，例如间隔时间为 1s, 2s, 4s, 8s, ….</div>\n\n### 如果已经建立了连接，但客户端突然出现了故障？\n\n显然，客户端如果出现故障，服务器不能一直等下去，白白浪费资源。\n\n**TCP** 设有一个 **保活计时器**，**服务器每收到一次客户端的请求后都会重新复位这个计时器**，时间通常是设置为 2 小时，若两小时还没有收到客户端的任何数据，服务器就会发送一个**探测报文段**，以后每隔 75 秒钟发送一次。\n\n若一连发送 10 个探测报文仍然没反应，服务器就认为客户端出了故障，接着就关闭连接。\n\n### 其他需要补充的\n\n#### TCP 重传\n\nA 发送了一个 data，如果 B 收到了要向 A 回复自己收到了（ACK），但是如果 A 发送完 data 半天都没得到 B 的回复，那么 A 就会认为自己的 data 半路被大风刮跑了，需要重新发送一遍，**这就是 TCP 重传**。\n\n但是也有可能是 B 收到了 A 的消息，只不过是 B 给 A 的 ACK 回复半路被刮跑了，以至于 A 收不到 B 的回复。\n\n那么既然 A 不能判断究竟是自己的 data 半路没了，还是 B 的回复半路没了，那就干脆不管了，重新发送一遍 data 就行。\n\n既然发生了 TCP 重传，那么 B 就有可能同一个消息收到了多次，这里就需要 **「去重」**，**「重传」** 和 **「去重」** 工作在操作系统的网络内核模块都已经帮我们处理好了，用户层是不用关心的。\n\n#### TCP 的双工通信\n\nA 可以向 B 喊话，同样 B 也可以向 A 喊话，因为 **TCP 链接是「双工的」**，双方都可以主动发起数据传输。\n\n**不过无论是哪方喊话，都需要收到对方的确认才能认为对方收到了自己的喊话。**\n\nA 可能是个高射炮，一连说了八句话，这时候 B 可以不用一句一句回复，而是连续听了这八句话之后，一起向对方回复说前面你说的八句话我都听见了，这就是**批量 ACK**。\n\n网络环境的数据交互同人类之间的对话还要复杂一些，它存在数据包乱序的现象。\n\n同一个来源发出来的不同数据包在 **「网际路由」** 上可能会走过不同的路径，最终达到同一个地方时，顺序就不一样了。\n\n操作系统的网络内核模块会负责对数据包进行排序，到用户层时顺序就已经完全一致了（所以说我们不用管咯？）。\n\n<hr />\n\n## 四次挥手\n\n### 过程\n\n#### 正经一点的\n\n刚开始双方都处于 `establised` 状态，假如是客户端先发起关闭请求，则：\n\n1. 第一次挥手：第一次挥手：客户端发送一个 `FIN` 报文，报文中会指定一个序列号。此时客户端处于 **`FIN-Wait-1`** 状态；\n2. 第二次挥手：服务端收到 `FIN` 之后，会发送 `ACK` 报文，且把 **客户端的序列号值 + 1** 作为 `ACK` 报文的序列号值，表明已经收到客户端的报文了，此时服务端处于 **`Close-Wait`** 状态，客户端收到后进入 **`FIN-Wait-2`** 状态；\n3. 第三次挥手：如果服务端也想断开连接了，和客户端的第一次挥手一样，向客户端发送 `FIN` 报文，且指定一个序列号。此时服务端处于 **Last-ACK** 的状态。\n4. 第四次挥手：客户端收到来自服务端的 `FIN` 之后，一样发送一个 `ACK` 报文作为应答，且把 **服务端的序列号值 + 1** 作为自己 `ACK` 报文的序列号值，此时客户端处于 **`Time-Wait`** 状态。需要过一阵子以 **确保服务端收到** 自己的 `ACK` 报文之后才会进入 **`Closed`** 状态。\n5. 服务端收到 `ACK` 报文之后，就处于关闭连接了，处于 **`Closed`** 状态。\n\n<img src=\"four.png\" alt=\"TCP 四次挥手\" />\n\n也来个动图叭：\n\n<img src=\"four.gif\" alt=\"TCP 四次挥手\" />\n\n#### 不正经的\n\n<img src=\"four01.png\" alt=\"TCP 四次挥手\" />\n\n### 超级重要的 Time-Wait 状态\n\n#### 什么是 Time-Wait\n\n为什么客户端发送 ACK 之后不直接关闭，而是要等一阵子才关闭？\n\n**`Time-Wait`** 是主动关闭的一方在回复完对方的挥手后进入的一个长期状态。\n\n这个状态标准的持续时间是 4 分钟，4 分钟后才会进入到 **`Closed`** 状态，释放套接字资源。不过在具体实现上这个时间是可以调整的。\n\n4 分钟就是 2 个 MSL，每个 MSL 是 2 分钟。MSL 就是 **Maximum Segment Lifetime —— 最长报文寿命**。\n\n这个时间是由官方 RFC 协议规定的。至于为什么是 2 个 MSL 而不是 1 个 MSL，还没有看到一个非常满意的解释。\n\n它就好比主动分手方要承担的责任，是你提出的要分手，你得付出代价。这个后果就是持续 4 分钟的 **`Time-Wait`** 状态，不能释放套接字资源(端口)，就好比守寡期，这段时间内套接字资源(端口)不得回收利用。\n\n它的作用是重传最后一个 `ACK` 报文，确保对方可以收到。因为如果对方没有收到 `ACK` 的话，会重传 `FIN` 报文，处于 **`Time-Wait`** 状态的套接字会立即向对方重发 ack 报文。\n\n即：要确保服务器是否已经收到了我们的 `ACK` 报文，如果没有收到的话，服务器会重新发 `FIN` 报文给客户端，客户端再次收到 `FIN` 报文之后，就知道之前的 `ACK` 报文丢失了，然后再次发送 `ACK` 报文。\n\n#### 为什么必须要经过 2 MSL 才能返回到 Close 状态\n\n虽然按道理，四个报文都发送完毕，我们可以直接进入 **`Close`** 状态了，但是我们必须假象网络是不可靠的，有可以最后一个 `ACK` 丢失。所以 **`Time-Wait`** 状态就是用来重发可能丢失的 `ACK` 报文。\n\n在客户端发送出最后的 `ACK` 回复后，该 `ACK` 可能丢失。服务端如果没有收到 `ACK`，将不断重复发送 `FIN` 片段。**所以客户端不能立即关闭，它必须确认服务端接收到了该 `ACK`**。\n\n客户端会在发送出 `ACK` 之后进入到 **`Time-Wait`** 状态。客户端会设置一个计时器，等待 2 MSL 的时间。\n\n如果在该时间内再次收到 `FIN`（因为服务端没收到客户端最后的 `ACK` 就会重发 `FIN`，如果客户端在等待 2 MSL 的时候又收到了来自服务端的 `FIN`，那就说明自己之前的 `ACK` 丢了），那么客户端会重发 `ACK` 并再次等待 2 MSL。\n\nMSL 指一个片段在网络中最大的存活时间，2 MSL 就是一个发送和一个回复所需的最大时间。如果直到 2 MSL，客户端都没有再次收到来自服务端的 `FIN`，那么服务端就有理由推断自己的最后一个 `ACK` 已经被成功接收，则结束 `TCP` 连接。\n\n### 总是四次挥手吗？\n\n四次挥手也并不总是四次挥手，中间的两个动作有时候是可以合并一起进行的。\n\n这个时候就成了三次挥手，主动关闭方就会从 **`FIN-Wait-1`** 状态直接进入到 **`Time-Wait`** 状态，跳过了 **`FIN-Wait-2`** 状态。\n\n### 为什么连接的时候要三次握手，而关闭的时候要四次挥手\n\n因为当服务端收到客户端端的 `SYN` 连接请求报文后，可以直接发送 `SYN + ACK` 报文。其中 `ACK` 报文是用来应答的，`SYN` 报文是用来同步的。\n\n但是关闭连接时，当服务端端收到 `FIN` 报文时，很可能并不会立即关闭 `SOCKET`，所以只能先回复一个 `ACK` 报文，告诉客户端：**\"你发的 `FIN` 报文我收到了\"**。只有等到我这边（服务端）所有的报文都发送完了，我才能发送 `FIN` 报文，因此不能一起发送。**故需要四步挥手。**\n\n<hr />\n\n## 总结\n\n一图胜千言了...\n\n<img src=\"total.png\" alt=\"总览\" />\n\n<hr />\n\n## 参考资料\n\n- [6张动态图轻松学习TCP三次握手和四次挥手](http://www.sohu.com/a/246199963_463994)\n- [TCP的三次握手与四次挥手理解及面试题（很全面）](https://blog.csdn.net/qq_38950316/article/details/81087809)\n- [关于三次握手与四次挥手面试官想考什么？](https://blog.csdn.net/weixin_44460333/article/details/89369316)\n- [TCP三次握手和四次挥手通俗理解](https://www.cnblogs.com/jainszhang/p/10641728.html)\n- [在深谈TCP/IP三步握手&四步挥手原理及衍生问题——长文解剖IP](http://www.pianshen.com/article/1002102250/)","slug":"来说说TCP的三次握手和四次挥手吧","published":1,"updated":"2020-01-19T15:26:15.304Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn6n001c2lwj7kyn8i6x","content":"<blockquote>\n<p><span class=\"introduction\">活得快乐的最重要因素是人生有事干、有人可去爱，以及生命中有所冀望。</span><br><br>在面试中，三次握手和四次挥手可以说是问的最频繁的一个知识点了。今天重点围绕着面试，我们应该掌握哪些比较重要的点，哪些是比较被面试官给问到的呢？</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"TCP-报文格式\"><a href=\"#TCP-报文格式\" class=\"headerlink\" title=\"TCP 报文格式\"></a>TCP 报文格式</h2><p>在了解三次握手和四次挥手之前，先知道TCP报文内部包含了哪些东西。</p>\n<img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/TcpMessage.png\" alt=\"TCP 报文格式\">\n\n<p>TCP 报头中的源端口号和目的端口号同 IP 数据报中的源 IP 与目的 IP 唯一确定一条 TCP 连接。TCP在发送数据前必须在彼此间建立连接，这里连接意思是：双方需要内保存对方信息（例如：IP，Port…）</p>\n<p>报文主要段的意思大致是这样：</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">字段</th>\n<th align=\"left\">含义</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">序号</td>\n<td align=\"left\">表示发送的数据字节流，确保 TCP 传输有序，对每个字节编号</td>\n</tr>\n<tr>\n<td align=\"left\">确认序号</td>\n<td align=\"left\">发送方期待接收的下一序列号，接收成功后的数据字节序列号加 1。只有 ACK = 1 时才有效。</td>\n</tr>\n<tr>\n<td align=\"left\">URG</td>\n<td align=\"left\">紧急指针是否有效。如果为 1，则表示某一位需要被优先处理（告知系统此报文段有紧急数据）</td>\n</tr>\n<tr>\n<td align=\"left\">ACK</td>\n<td align=\"left\">确认号是否有效，一般置为 1</td>\n</tr>\n<tr>\n<td align=\"left\">PSH</td>\n<td align=\"left\">提示接收端应用程序立即从 TCP 缓冲区把数据读走（Push，一般 PSH = 1 的情况只出现在 DATA 内容不为 0 的包中，即表示有真正的 TCP 数据包内容被传递）</td>\n</tr>\n<tr>\n<td align=\"left\">RST</td>\n<td align=\"left\">对方要求重新建立连接，复位。当 RST = 1 时，表明 TCP 连接中出现严重差错，必须释放连接再重新建立连接</td>\n</tr>\n<tr>\n<td align=\"left\">SYN</td>\n<td align=\"left\">请求建立连接，并在其序列号的字段进行序列号的初始值设定。建立连接，设置为 1</td>\n</tr>\n<tr>\n<td align=\"left\">FIN</td>\n<td align=\"left\">希望断开连接，当 FIN = 1 时，表明此报文段的发送方数据已经发送完毕，要求断开连接</td>\n</tr>\n</tbody></table>\n<hr>\n\n<h2 id=\"状态值（不看这个是看不懂接下来的东西的哦）\"><a href=\"#状态值（不看这个是看不懂接下来的东西的哦）\" class=\"headerlink\" title=\"状态值（不看这个是看不懂接下来的东西的哦）\"></a>状态值（不看这个是看不懂接下来的东西的哦）</h2><table>\n<thead>\n<tr>\n<th align=\"left\">状态名</th>\n<th align=\"left\">含义</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">Listen</td>\n<td align=\"left\">侦听来自远方 TCP 端口的连接请求</td>\n</tr>\n<tr>\n<td align=\"left\">SYN-Sent</td>\n<td align=\"left\">在发送连接请求后等待匹配的连接请求</td>\n</tr>\n<tr>\n<td align=\"left\">SYN-Received</td>\n<td align=\"left\">在收到和发送一个连接请求等待对连接请求的确认</td>\n</tr>\n<tr>\n<td align=\"left\">Established</td>\n<td align=\"left\">代表一个打开的连接，数据可以传送</td>\n</tr>\n<tr>\n<td align=\"left\">FIN-Wait-1</td>\n<td align=\"left\">等待远程 TCP 的连接中断请求，或先前的连接中断请求的确认</td>\n</tr>\n<tr>\n<td align=\"left\">FIN-Wait-2</td>\n<td align=\"left\">从远程 TCP 连接中断请求</td>\n</tr>\n<tr>\n<td align=\"left\">Close-Wait</td>\n<td align=\"left\">等待从本地用户发来的连接中断请求</td>\n</tr>\n<tr>\n<td align=\"left\">Last-ACK</td>\n<td align=\"left\">等待原来发向远程 TCP 的连接中断请求的确认</td>\n</tr>\n<tr>\n<td align=\"left\">Time-Wait</td>\n<td align=\"left\">等待的时间以确保远程 TCP 接收到连接中断请求的确认</td>\n</tr>\n<tr>\n<td align=\"left\">Closed</td>\n<td align=\"left\">没有任何连接状态</td>\n</tr>\n</tbody></table>\n<hr>\n\n<h2 id=\"三次握手\"><a href=\"#三次握手\" class=\"headerlink\" title=\"三次握手\"></a>三次握手</h2><h3 id=\"过程\"><a href=\"#过程\" class=\"headerlink\" title=\"过程\"></a>过程</h3><h4 id=\"正经一点的\"><a href=\"#正经一点的\" class=\"headerlink\" title=\"正经一点的\"></a>正经一点的</h4><p><strong>刚开始客户端处于 closed 的状态，服务端处于 listen 状态</strong>。然后：</p>\n<ol>\n<li>第一次握手：客户端给服务端发一个 <code>SYN</code> 报文，并指明客户端的初始化序列号 <code>ISN(c)</code>。此时客户端处于 <strong><code>SYN_Sent</code></strong> 状态。</li>\n<li>第二次握手：服务器收到客户端的 <code>SYN</code> 报文之后，会以自己的 <code>SYN</code> 报文作为应答，并且也是指定了自己的初始化序列号 <code>ISN(s)</code>，同时会把客户端的 <code>ISN + 1</code> 作为 <code>ACK</code> 的值，表示自己已经收到了客户端的 <code>SYN</code>，此时服务器处于 <strong><code>SYN_REVD</code></strong> 的状态。</li>\n<li>第三次握手：客户端收到 <code>SYN</code> 报文之后，会发送一个 <code>ACK</code> 报文，当然，也是一样把服务器的 <code>ISN + 1</code> 作为 <code>ACK</code> 的值，表示已经收到了服务端的 <code>SYN</code> 报文，此时客户端处于 <strong><code>establised</code></strong> 状态。</li>\n<li>服务器收到 <code>ACK</code> 报文之后，也处于 <strong><code>establised</code></strong> 状态，此时，双方以建立起了链接。</li>\n</ol>\n<img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/three.png\" alt=\"TCP 三次握手\">\n\n<p>来个动图叭：</p>\n<img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/three.gif\" alt=\"TCP 三次握手\">\n\n<h4 id=\"不正经的\"><a href=\"#不正经的\" class=\"headerlink\" title=\"不正经的\"></a>不正经的</h4><img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/three01.png\" alt=\"TCP 三次握手\">\n\n<h3 id=\"为什么得握三次？两次不行吗？\"><a href=\"#为什么得握三次？两次不行吗？\" class=\"headerlink\" title=\"为什么得握三次？两次不行吗？\"></a>为什么得握三次？两次不行吗？</h3><p>需要三次握手主要是 <strong>双方彼此确认对方的接收与发送能力是否正常</strong>，因为双方中间是有距离的，而除了发包通信又没其他办法联系到对方：</p>\n<ol>\n<li>第一次握手：客户端给服务端发包，服务端收到了，那么服务端就知道 <strong>客户端的发送能力没问题</strong>，但此时客户端并不知道服务端收到了它发送的这条消息；</li>\n<li>第二次握手：服务端向客户端回复，此时：<ol>\n<li><strong>客户端知道了服务端发送能力没问题</strong>；</li>\n<li>既然客户端收到了服务端发来的消息，那么也就证明了，<strong>服务端收到了客户端最开始发送的消息</strong>，即客户端也同时知道了 <strong>服务端的接收能力没问题</strong>；</li>\n</ol>\n</li>\n<li>第三次握手：客户端向服务端发包，服务端收到了这个回复，那么一定是客户端收到了服务端的上一条消息，这个时候服务端也就知道了 <strong>客户端的接收能力没问题</strong>。</li>\n</ol>\n<p>因此，需要三次握手才能确认双方的接收与发送能力是否正常。</p>\n<div class=\"note info\">3次握手完成两个重要的功能，既要双方做好发送数据的准备工作（双方都知道彼此已准备好），也要允许双方就初始序列号进行协商，这个序列号在握手过程中被发送和确认。</div>\n\n<p>现在把三次握手改成仅需要两次握手，这样就可能发生 <strong>死锁</strong>。</p>\n<p>作为例子，考虑计算机 S 和 C 之间的通信，假定 C 给 S 发送一个连接请求分组，S 收到了这个分组，并发送了确认应答分组。按照两次握手的协定，<strong>S 认为连接已经成功地建立了，可以开始发送数据分组</strong>。可是，C 在 S 的应答分组在传输中被丢失的情况下，将不知道 S 是否已准备好，不知道 S 建立什么样的序列号，<strong>C 甚至怀疑 S 是否收到自己的连接请求分组</strong>。在这种情况下，<strong>C 认为连接还未建立成功，将忽略 S 发来的任何数据分组，只等待连接确认应答分组</strong>。而 S 在发出的分组超时后，重复发送同样的分组。</p>\n<p>这样就形成了死锁。</p>\n<h3 id=\"三次握手的作用是什么\"><a href=\"#三次握手的作用是什么\" class=\"headerlink\" title=\"三次握手的作用是什么\"></a>三次握手的作用是什么</h3><ol>\n<li>确认双方的接受能力、发送能力是否正常；</li>\n<li>指定自己的初始化序列号，为后面的可靠传送做准备；</li>\n<li>如果是 https 协议的话，三次握手这个过程，还会进行数字证书的验证以及加密密钥的生成。</li>\n</ol>\n<h3 id=\"三次握手中可以携带数据吗\"><a href=\"#三次握手中可以携带数据吗\" class=\"headerlink\" title=\"三次握手中可以携带数据吗\"></a>三次握手中可以携带数据吗</h3><p>第一次、第二次握手不可以携带数据，而第三次握手是可以携带数据。</p>\n<div class=\"note danger\"><b>假如第一次握手可以携带数据</b> 的话，如果有人要恶意攻击服务器，那他每次都在第一次握手中的 <code>SYN</code> 报文中放入大量的数据，因为 <b>攻击者根本就不理服务器的接收、发送能力是否正常</b>，然后疯狂着重复发 <code>SYN</code> 报文的话，这会让服务器花费很多时间、内存空间来接收这些报文。也就是说，第一次握手可以放数据的话，其中一个简单的原因就是会让服务器更加容易受到攻击了。</div>\n\n<p>而对于第三次的话，此时客户端已经处于 <strong><code>established</code></strong> 状态，也就是说，对于客户端来说，他已经建立起连接了，并且也已经知道服务器的接收、发送能力是正常的了，所以能携带数据页没啥毛病。</p>\n<h3 id=\"（ISN）是固定的吗\"><a href=\"#（ISN）是固定的吗\" class=\"headerlink\" title=\"（ISN）是固定的吗\"></a>（ISN）是固定的吗</h3><p>三次握手的一个重要功能是客户端和服务端交换 ISN（Initial Sequence Number）, 以便让对方知道接下来接收数据的时候如何按序列号组装数据。</p>\n<p>如果 <code>ISN</code> 是固定的，攻击者很容易猜出后续的确认号，<strong>因此 <code>ISN</code> 是动态生成的</strong>。</p>\n<h3 id=\"什么是半连接队列\"><a href=\"#什么是半连接队列\" class=\"headerlink\" title=\"什么是半连接队列\"></a>什么是半连接队列</h3><p>服务器第一次收到客户端的 <code>SYN</code> 之后，就会处于 <strong><code>syn_rcvd</code></strong> 状态，此时双方还没有完全建立其连接，服务器会把此种状态下请求连接放在一个队列里，我们把这种队列称之为半连接队列。</p>\n<p><strong><code>syn_sent</code></strong> 是主动打开方的 <strong>「半打开」状态</strong>，<strong><code>syn_rcvd</code></strong> 是被动打开方的 <strong>「半打开」状态</strong>。客户端是主动打开方，服务端是被动打开方。</p>\n<p>当然还有一个全连接队列，就是已经完成三次握手，建立起连接的就会放在全连接队列中。<strong>如果队列满了就有可能会出现丢包现象</strong>。</p>\n<div class=\"note info\">这里再补充一点关于 <b><code>SYN-ACK</code> 重传次数</b> 的问题：服务器发送完 <b><code>SYN-ACK</code></b> 包，如果未收到客户确认包，服务器进行首次重传，等待一段时间仍未收到客户确认包，进行第二次重传，如果重传次数超过系统规定的最大重传次数，系统将该连接信息从半连接队列中删除。注意，每次重传等待的时间不一定相同，一般会是指数增长，例如间隔时间为 1s, 2s, 4s, 8s, ….</div>\n\n<h3 id=\"如果已经建立了连接，但客户端突然出现了故障？\"><a href=\"#如果已经建立了连接，但客户端突然出现了故障？\" class=\"headerlink\" title=\"如果已经建立了连接，但客户端突然出现了故障？\"></a>如果已经建立了连接，但客户端突然出现了故障？</h3><p>显然，客户端如果出现故障，服务器不能一直等下去，白白浪费资源。</p>\n<p><strong>TCP</strong> 设有一个 <strong>保活计时器</strong>，<strong>服务器每收到一次客户端的请求后都会重新复位这个计时器</strong>，时间通常是设置为 2 小时，若两小时还没有收到客户端的任何数据，服务器就会发送一个<strong>探测报文段</strong>，以后每隔 75 秒钟发送一次。</p>\n<p>若一连发送 10 个探测报文仍然没反应，服务器就认为客户端出了故障，接着就关闭连接。</p>\n<h3 id=\"其他需要补充的\"><a href=\"#其他需要补充的\" class=\"headerlink\" title=\"其他需要补充的\"></a>其他需要补充的</h3><h4 id=\"TCP-重传\"><a href=\"#TCP-重传\" class=\"headerlink\" title=\"TCP 重传\"></a>TCP 重传</h4><p>A 发送了一个 data，如果 B 收到了要向 A 回复自己收到了（ACK），但是如果 A 发送完 data 半天都没得到 B 的回复，那么 A 就会认为自己的 data 半路被大风刮跑了，需要重新发送一遍，<strong>这就是 TCP 重传</strong>。</p>\n<p>但是也有可能是 B 收到了 A 的消息，只不过是 B 给 A 的 ACK 回复半路被刮跑了，以至于 A 收不到 B 的回复。</p>\n<p>那么既然 A 不能判断究竟是自己的 data 半路没了，还是 B 的回复半路没了，那就干脆不管了，重新发送一遍 data 就行。</p>\n<p>既然发生了 TCP 重传，那么 B 就有可能同一个消息收到了多次，这里就需要 <strong>「去重」</strong>，<strong>「重传」</strong> 和 <strong>「去重」</strong> 工作在操作系统的网络内核模块都已经帮我们处理好了，用户层是不用关心的。</p>\n<h4 id=\"TCP-的双工通信\"><a href=\"#TCP-的双工通信\" class=\"headerlink\" title=\"TCP 的双工通信\"></a>TCP 的双工通信</h4><p>A 可以向 B 喊话，同样 B 也可以向 A 喊话，因为 <strong>TCP 链接是「双工的」</strong>，双方都可以主动发起数据传输。</p>\n<p><strong>不过无论是哪方喊话，都需要收到对方的确认才能认为对方收到了自己的喊话。</strong></p>\n<p>A 可能是个高射炮，一连说了八句话，这时候 B 可以不用一句一句回复，而是连续听了这八句话之后，一起向对方回复说前面你说的八句话我都听见了，这就是<strong>批量 ACK</strong>。</p>\n<p>网络环境的数据交互同人类之间的对话还要复杂一些，它存在数据包乱序的现象。</p>\n<p>同一个来源发出来的不同数据包在 <strong>「网际路由」</strong> 上可能会走过不同的路径，最终达到同一个地方时，顺序就不一样了。</p>\n<p>操作系统的网络内核模块会负责对数据包进行排序，到用户层时顺序就已经完全一致了（所以说我们不用管咯？）。</p>\n<hr>\n\n<h2 id=\"四次挥手\"><a href=\"#四次挥手\" class=\"headerlink\" title=\"四次挥手\"></a>四次挥手</h2><h3 id=\"过程-1\"><a href=\"#过程-1\" class=\"headerlink\" title=\"过程\"></a>过程</h3><h4 id=\"正经一点的-1\"><a href=\"#正经一点的-1\" class=\"headerlink\" title=\"正经一点的\"></a>正经一点的</h4><p>刚开始双方都处于 <code>establised</code> 状态，假如是客户端先发起关闭请求，则：</p>\n<ol>\n<li>第一次挥手：第一次挥手：客户端发送一个 <code>FIN</code> 报文，报文中会指定一个序列号。此时客户端处于 <strong><code>FIN-Wait-1</code></strong> 状态；</li>\n<li>第二次挥手：服务端收到 <code>FIN</code> 之后，会发送 <code>ACK</code> 报文，且把 <strong>客户端的序列号值 + 1</strong> 作为 <code>ACK</code> 报文的序列号值，表明已经收到客户端的报文了，此时服务端处于 <strong><code>Close-Wait</code></strong> 状态，客户端收到后进入 <strong><code>FIN-Wait-2</code></strong> 状态；</li>\n<li>第三次挥手：如果服务端也想断开连接了，和客户端的第一次挥手一样，向客户端发送 <code>FIN</code> 报文，且指定一个序列号。此时服务端处于 <strong>Last-ACK</strong> 的状态。</li>\n<li>第四次挥手：客户端收到来自服务端的 <code>FIN</code> 之后，一样发送一个 <code>ACK</code> 报文作为应答，且把 <strong>服务端的序列号值 + 1</strong> 作为自己 <code>ACK</code> 报文的序列号值，此时客户端处于 <strong><code>Time-Wait</code></strong> 状态。需要过一阵子以 <strong>确保服务端收到</strong> 自己的 <code>ACK</code> 报文之后才会进入 <strong><code>Closed</code></strong> 状态。</li>\n<li>服务端收到 <code>ACK</code> 报文之后，就处于关闭连接了，处于 <strong><code>Closed</code></strong> 状态。</li>\n</ol>\n<img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/four.png\" alt=\"TCP 四次挥手\">\n\n<p>也来个动图叭：</p>\n<img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/four.gif\" alt=\"TCP 四次挥手\">\n\n<h4 id=\"不正经的-1\"><a href=\"#不正经的-1\" class=\"headerlink\" title=\"不正经的\"></a>不正经的</h4><img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/four01.png\" alt=\"TCP 四次挥手\">\n\n<h3 id=\"超级重要的-Time-Wait-状态\"><a href=\"#超级重要的-Time-Wait-状态\" class=\"headerlink\" title=\"超级重要的 Time-Wait 状态\"></a>超级重要的 Time-Wait 状态</h3><h4 id=\"什么是-Time-Wait\"><a href=\"#什么是-Time-Wait\" class=\"headerlink\" title=\"什么是 Time-Wait\"></a>什么是 Time-Wait</h4><p>为什么客户端发送 ACK 之后不直接关闭，而是要等一阵子才关闭？</p>\n<p><strong><code>Time-Wait</code></strong> 是主动关闭的一方在回复完对方的挥手后进入的一个长期状态。</p>\n<p>这个状态标准的持续时间是 4 分钟，4 分钟后才会进入到 <strong><code>Closed</code></strong> 状态，释放套接字资源。不过在具体实现上这个时间是可以调整的。</p>\n<p>4 分钟就是 2 个 MSL，每个 MSL 是 2 分钟。MSL 就是 <strong>Maximum Segment Lifetime —— 最长报文寿命</strong>。</p>\n<p>这个时间是由官方 RFC 协议规定的。至于为什么是 2 个 MSL 而不是 1 个 MSL，还没有看到一个非常满意的解释。</p>\n<p>它就好比主动分手方要承担的责任，是你提出的要分手，你得付出代价。这个后果就是持续 4 分钟的 <strong><code>Time-Wait</code></strong> 状态，不能释放套接字资源(端口)，就好比守寡期，这段时间内套接字资源(端口)不得回收利用。</p>\n<p>它的作用是重传最后一个 <code>ACK</code> 报文，确保对方可以收到。因为如果对方没有收到 <code>ACK</code> 的话，会重传 <code>FIN</code> 报文，处于 <strong><code>Time-Wait</code></strong> 状态的套接字会立即向对方重发 ack 报文。</p>\n<p>即：要确保服务器是否已经收到了我们的 <code>ACK</code> 报文，如果没有收到的话，服务器会重新发 <code>FIN</code> 报文给客户端，客户端再次收到 <code>FIN</code> 报文之后，就知道之前的 <code>ACK</code> 报文丢失了，然后再次发送 <code>ACK</code> 报文。</p>\n<h4 id=\"为什么必须要经过-2-MSL-才能返回到-Close-状态\"><a href=\"#为什么必须要经过-2-MSL-才能返回到-Close-状态\" class=\"headerlink\" title=\"为什么必须要经过 2 MSL 才能返回到 Close 状态\"></a>为什么必须要经过 2 MSL 才能返回到 Close 状态</h4><p>虽然按道理，四个报文都发送完毕，我们可以直接进入 <strong><code>Close</code></strong> 状态了，但是我们必须假象网络是不可靠的，有可以最后一个 <code>ACK</code> 丢失。所以 <strong><code>Time-Wait</code></strong> 状态就是用来重发可能丢失的 <code>ACK</code> 报文。</p>\n<p>在客户端发送出最后的 <code>ACK</code> 回复后，该 <code>ACK</code> 可能丢失。服务端如果没有收到 <code>ACK</code>，将不断重复发送 <code>FIN</code> 片段。<strong>所以客户端不能立即关闭，它必须确认服务端接收到了该 <code>ACK</code></strong>。</p>\n<p>客户端会在发送出 <code>ACK</code> 之后进入到 <strong><code>Time-Wait</code></strong> 状态。客户端会设置一个计时器，等待 2 MSL 的时间。</p>\n<p>如果在该时间内再次收到 <code>FIN</code>（因为服务端没收到客户端最后的 <code>ACK</code> 就会重发 <code>FIN</code>，如果客户端在等待 2 MSL 的时候又收到了来自服务端的 <code>FIN</code>，那就说明自己之前的 <code>ACK</code> 丢了），那么客户端会重发 <code>ACK</code> 并再次等待 2 MSL。</p>\n<p>MSL 指一个片段在网络中最大的存活时间，2 MSL 就是一个发送和一个回复所需的最大时间。如果直到 2 MSL，客户端都没有再次收到来自服务端的 <code>FIN</code>，那么服务端就有理由推断自己的最后一个 <code>ACK</code> 已经被成功接收，则结束 <code>TCP</code> 连接。</p>\n<h3 id=\"总是四次挥手吗？\"><a href=\"#总是四次挥手吗？\" class=\"headerlink\" title=\"总是四次挥手吗？\"></a>总是四次挥手吗？</h3><p>四次挥手也并不总是四次挥手，中间的两个动作有时候是可以合并一起进行的。</p>\n<p>这个时候就成了三次挥手，主动关闭方就会从 <strong><code>FIN-Wait-1</code></strong> 状态直接进入到 <strong><code>Time-Wait</code></strong> 状态，跳过了 <strong><code>FIN-Wait-2</code></strong> 状态。</p>\n<h3 id=\"为什么连接的时候要三次握手，而关闭的时候要四次挥手\"><a href=\"#为什么连接的时候要三次握手，而关闭的时候要四次挥手\" class=\"headerlink\" title=\"为什么连接的时候要三次握手，而关闭的时候要四次挥手\"></a>为什么连接的时候要三次握手，而关闭的时候要四次挥手</h3><p>因为当服务端收到客户端端的 <code>SYN</code> 连接请求报文后，可以直接发送 <code>SYN + ACK</code> 报文。其中 <code>ACK</code> 报文是用来应答的，<code>SYN</code> 报文是用来同步的。</p>\n<p>但是关闭连接时，当服务端端收到 <code>FIN</code> 报文时，很可能并不会立即关闭 <code>SOCKET</code>，所以只能先回复一个 <code>ACK</code> 报文，告诉客户端：<strong>“你发的 <code>FIN</code> 报文我收到了”</strong>。只有等到我这边（服务端）所有的报文都发送完了，我才能发送 <code>FIN</code> 报文，因此不能一起发送。<strong>故需要四步挥手。</strong></p>\n<hr>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>一图胜千言了…</p>\n<img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/total.png\" alt=\"总览\">\n\n<hr>\n\n<h2 id=\"参考资料\"><a href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"></a>参考资料</h2><ul>\n<li><a href=\"http://www.sohu.com/a/246199963_463994\" target=\"_blank\" rel=\"noopener\">6张动态图轻松学习TCP三次握手和四次挥手</a></li>\n<li><a href=\"https://blog.csdn.net/qq_38950316/article/details/81087809\" target=\"_blank\" rel=\"noopener\">TCP的三次握手与四次挥手理解及面试题（很全面）</a></li>\n<li><a href=\"https://blog.csdn.net/weixin_44460333/article/details/89369316\" target=\"_blank\" rel=\"noopener\">关于三次握手与四次挥手面试官想考什么？</a></li>\n<li><a href=\"https://www.cnblogs.com/jainszhang/p/10641728.html\" target=\"_blank\" rel=\"noopener\">TCP三次握手和四次挥手通俗理解</a></li>\n<li><a href=\"http://www.pianshen.com/article/1002102250/\" target=\"_blank\" rel=\"noopener\">在深谈TCP/IP三步握手&amp;四步挥手原理及衍生问题——长文解剖IP</a></li>\n</ul>\n","site":{"data":{}},"length":5564,"excerpt":"<blockquote>\n<p><span class=\"introduction\">活得快乐的最重要因素是人生有事干、有人可去爱，以及生命中有所冀望。</span><br><br>在面试中，三次握手和四次挥手可以说是问的最频繁的一个知识点了。今天重点围绕着面试，我们应该掌握哪些比较重要的点，哪些是比较被面试官给问到的呢？</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"TCP-报文格式\"><a href=\"#TCP-报文格式\" class=\"headerlink\" title=\"TCP 报文格式\"></a>TCP 报文格式</h2><p>在了解三次握手和四次挥手之前，先知道TCP报文内部包含了哪些东西。</p>\n<img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/TcpMessage.png\" alt=\"TCP 报文格式\">\n\n<p>TCP 报头中的源端口号和目的端口号同 IP 数据报中的源 IP 与目的 IP 唯一确定一条 TCP 连接。TCP在发送数据前必须在彼此间建立连接，这里连接意思是：双方需要内保存对方信息（例如：IP，Port…）</p>\n<p>报文主要段的意思大致是这样：</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">字段</th>\n<th align=\"left\">含义</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">序号</td>\n<td align=\"left\">表示发送的数据字节流，确保 TCP 传输有序，对每个字节编号</td>\n</tr>\n<tr>\n<td align=\"left\">确认序号</td>\n<td align=\"left\">发送方期待接收的下一序列号，接收成功后的数据字节序列号加 1。只有 ACK = 1 时才有效。</td>\n</tr>\n<tr>\n<td align=\"left\">URG</td>\n<td align=\"left\">紧急指针是否有效。如果为 1，则表示某一位需要被优先处理（告知系统此报文段有紧急数据）</td>\n</tr>\n<tr>\n<td align=\"left\">ACK</td>\n<td align=\"left\">确认号是否有效，一般置为 1</td>\n</tr>\n<tr>\n<td align=\"left\">PSH</td>\n<td align=\"left\">提示接收端应用程序立即从 TCP 缓冲区把数据读走（Push，一般 PSH = 1 的情况只出现在 DATA 内容不为 0 的包中，即表示有真正的 TCP 数据包内容被传递）</td>\n</tr>\n<tr>\n<td align=\"left\">RST</td>\n<td align=\"left\">对方要求重新建立连接，复位。当 RST = 1 时，表明 TCP 连接中出现严重差错，必须释放连接再重新建立连接</td>\n</tr>\n<tr>\n<td align=\"left\">SYN</td>\n<td align=\"left\">请求建立连接，并在其序列号的字段进行序列号的初始值设定。建立连接，设置为 1</td>\n</tr>\n<tr>\n<td align=\"left\">FIN</td>\n<td align=\"left\">希望断开连接，当 FIN = 1 时，表明此报文段的发送方数据已经发送完毕，要求断开连接</td>\n</tr>\n</tbody></table>\n<hr>\n\n<h2 id=\"状态值（不看这个是看不懂接下来的东西的哦）\"><a href=\"#状态值（不看这个是看不懂接下来的东西的哦）\" class=\"headerlink\" title=\"状态值（不看这个是看不懂接下来的东西的哦）\"></a>状态值（不看这个是看不懂接下来的东西的哦）</h2><table>\n<thead>\n<tr>\n<th align=\"left\">状态名</th>\n<th align=\"left\">含义</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">Listen</td>\n<td align=\"left\">侦听来自远方 TCP 端口的连接请求</td>\n</tr>\n<tr>\n<td align=\"left\">SYN-Sent</td>\n<td align=\"left\">在发送连接请求后等待匹配的连接请求</td>\n</tr>\n<tr>\n<td align=\"left\">SYN-Received</td>\n<td align=\"left\">在收到和发送一个连接请求等待对连接请求的确认</td>\n</tr>\n<tr>\n<td align=\"left\">Established</td>\n<td align=\"left\">代表一个打开的连接，数据可以传送</td>\n</tr>\n<tr>\n<td align=\"left\">FIN-Wait-1</td>\n<td align=\"left\">等待远程 TCP 的连接中断请求，或先前的连接中断请求的确认</td>\n</tr>\n<tr>\n<td align=\"left\">FIN-Wait-2</td>\n<td align=\"left\">从远程 TCP 连接中断请求</td>\n</tr>\n<tr>\n<td align=\"left\">Close-Wait</td>\n<td align=\"left\">等待从本地用户发来的连接中断请求</td>\n</tr>\n<tr>\n<td align=\"left\">Last-ACK</td>\n<td align=\"left\">等待原来发向远程 TCP 的连接中断请求的确认</td>\n</tr>\n<tr>\n<td align=\"left\">Time-Wait</td>\n<td align=\"left\">等待的时间以确保远程 TCP 接收到连接中断请求的确认</td>\n</tr>\n<tr>\n<td align=\"left\">Closed</td>\n<td align=\"left\">没有任何连接状态</td>\n</tr>\n</tbody></table>\n<hr>\n\n<h2 id=\"三次握手\"><a href=\"#三次握手\" class=\"headerlink\" title=\"三次握手\"></a>三次握手</h2><h3 id=\"过程\"><a href=\"#过程\" class=\"headerlink\" title=\"过程\"></a>过程</h3><h4 id=\"正经一点的\"><a href=\"#正经一点的\" class=\"headerlink\" title=\"正经一点的\"></a>正经一点的</h4><p><strong>刚开始客户端处于 closed 的状态，服务端处于 listen 状态</strong>。然后：</p>\n<ol>\n<li>第一次握手：客户端给服务端发一个 <code>SYN</code> 报文，并指明客户端的初始化序列号 <code>ISN(c)</code>。此时客户端处于 <strong><code>SYN_Sent</code></strong> 状态。</li>\n<li>第二次握手：服务器收到客户端的 <code>SYN</code> 报文之后，会以自己的 <code>SYN</code> 报文作为应答，并且也是指定了自己的初始化序列号 <code>ISN(s)</code>，同时会把客户端的 <code>ISN + 1</code> 作为 <code>ACK</code> 的值，表示自己已经收到了客户端的 <code>SYN</code>，此时服务器处于 <strong><code>SYN_REVD</code></strong> 的状态。</li>\n<li>第三次握手：客户端收到 <code>SYN</code> 报文之后，会发送一个 <code>ACK</code> 报文，当然，也是一样把服务器的 <code>ISN + 1</code> 作为 <code>ACK</code> 的值，表示已经收到了服务端的 <code>SYN</code> 报文，此时客户端处于 <strong><code>establised</code></strong> 状态。</li>\n<li>服务器收到 <code>ACK</code> 报文之后，也处于 <strong><code>establised</code></strong> 状态，此时，双方以建立起了链接。</li>\n</ol>\n<img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/three.png\" alt=\"TCP 三次握手\">\n\n<p>来个动图叭：</p>\n<img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/three.gif\" alt=\"TCP 三次握手\">\n\n<h4 id=\"不正经的\"><a href=\"#不正经的\" class=\"headerlink\" title=\"不正经的\"></a>不正经的</h4><img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/three01.png\" alt=\"TCP 三次握手\">\n\n<h3 id=\"为什么得握三次？两次不行吗？\"><a href=\"#为什么得握三次？两次不行吗？\" class=\"headerlink\" title=\"为什么得握三次？两次不行吗？\"></a>为什么得握三次？两次不行吗？</h3><p>需要三次握手主要是 <strong>双方彼此确认对方的接收与发送能力是否正常</strong>，因为双方中间是有距离的，而除了发包通信又没其他办法联系到对方：</p>\n<ol>\n<li>第一次握手：客户端给服务端发包，服务端收到了，那么服务端就知道 <strong>客户端的发送能力没问题</strong>，但此时客户端并不知道服务端收到了它发送的这条消息；</li>\n<li>第二次握手：服务端向客户端回复，此时：<ol>\n<li><strong>客户端知道了服务端发送能力没问题</strong>；</li>\n<li>既然客户端收到了服务端发来的消息，那么也就证明了，<strong>服务端收到了客户端最开始发送的消息</strong>，即客户端也同时知道了 <strong>服务端的接收能力没问题</strong>；</li>\n</ol>\n</li>\n<li>第三次握手：客户端向服务端发包，服务端收到了这个回复，那么一定是客户端收到了服务端的上一条消息，这个时候服务端也就知道了 <strong>客户端的接收能力没问题</strong>。</li>\n</ol>\n<p>因此，需要三次握手才能确认双方的接收与发送能力是否正常。</p>\n<div class=\"note info\">3次握手完成两个重要的功能，既要双方做好发送数据的准备工作（双方都知道彼此已准备好），也要允许双方就初始序列号进行协商，这个序列号在握手过程中被发送和确认。</div>\n\n<p>现在把三次握手改成仅需要两次握手，这样就可能发生 <strong>死锁</strong>。</p>\n<p>作为例子，考虑计算机 S 和 C 之间的通信，假定 C 给 S 发送一个连接请求分组，S 收到了这个分组，并发送了确认应答分组。按照两次握手的协定，<strong>S 认为连接已经成功地建立了，可以开始发送数据分组</strong>。可是，C 在 S 的应答分组在传输中被丢失的情况下，将不知道 S 是否已准备好，不知道 S 建立什么样的序列号，<strong>C 甚至怀疑 S 是否收到自己的连接请求分组</strong>。在这种情况下，<strong>C 认为连接还未建立成功，将忽略 S 发来的任何数据分组，只等待连接确认应答分组</strong>。而 S 在发出的分组超时后，重复发送同样的分组。</p>\n<p>这样就形成了死锁。</p>\n<h3 id=\"三次握手的作用是什么\"><a href=\"#三次握手的作用是什么\" class=\"headerlink\" title=\"三次握手的作用是什么\"></a>三次握手的作用是什么</h3><ol>\n<li>确认双方的接受能力、发送能力是否正常；</li>\n<li>指定自己的初始化序列号，为后面的可靠传送做准备；</li>\n<li>如果是 https 协议的话，三次握手这个过程，还会进行数字证书的验证以及加密密钥的生成。</li>\n</ol>\n<h3 id=\"三次握手中可以携带数据吗\"><a href=\"#三次握手中可以携带数据吗\" class=\"headerlink\" title=\"三次握手中可以携带数据吗\"></a>三次握手中可以携带数据吗</h3><p>第一次、第二次握手不可以携带数据，而第三次握手是可以携带数据。</p>\n<div class=\"note danger\"><b>假如第一次握手可以携带数据</b> 的话，如果有人要恶意攻击服务器，那他每次都在第一次握手中的 <code>SYN</code> 报文中放入大量的数据，因为 <b>攻击者根本就不理服务器的接收、发送能力是否正常</b>，然后疯狂着重复发 <code>SYN</code> 报文的话，这会让服务器花费很多时间、内存空间来接收这些报文。也就是说，第一次握手可以放数据的话，其中一个简单的原因就是会让服务器更加容易受到攻击了。</div>\n\n<p>而对于第三次的话，此时客户端已经处于 <strong><code>established</code></strong> 状态，也就是说，对于客户端来说，他已经建立起连接了，并且也已经知道服务器的接收、发送能力是正常的了，所以能携带数据页没啥毛病。</p>\n<h3 id=\"（ISN）是固定的吗\"><a href=\"#（ISN）是固定的吗\" class=\"headerlink\" title=\"（ISN）是固定的吗\"></a>（ISN）是固定的吗</h3><p>三次握手的一个重要功能是客户端和服务端交换 ISN（Initial Sequence Number）, 以便让对方知道接下来接收数据的时候如何按序列号组装数据。</p>\n<p>如果 <code>ISN</code> 是固定的，攻击者很容易猜出后续的确认号，<strong>因此 <code>ISN</code> 是动态生成的</strong>。</p>\n<h3 id=\"什么是半连接队列\"><a href=\"#什么是半连接队列\" class=\"headerlink\" title=\"什么是半连接队列\"></a>什么是半连接队列</h3><p>服务器第一次收到客户端的 <code>SYN</code> 之后，就会处于 <strong><code>syn_rcvd</code></strong> 状态，此时双方还没有完全建立其连接，服务器会把此种状态下请求连接放在一个队列里，我们把这种队列称之为半连接队列。</p>\n<p><strong><code>syn_sent</code></strong> 是主动打开方的 <strong>「半打开」状态</strong>，<strong><code>syn_rcvd</code></strong> 是被动打开方的 <strong>「半打开」状态</strong>。客户端是主动打开方，服务端是被动打开方。</p>\n<p>当然还有一个全连接队列，就是已经完成三次握手，建立起连接的就会放在全连接队列中。<strong>如果队列满了就有可能会出现丢包现象</strong>。</p>\n<div class=\"note info\">这里再补充一点关于 <b><code>SYN-ACK</code> 重传次数</b> 的问题：服务器发送完 <b><code>SYN-ACK</code></b> 包，如果未收到客户确认包，服务器进行首次重传，等待一段时间仍未收到客户确认包，进行第二次重传，如果重传次数超过系统规定的最大重传次数，系统将该连接信息从半连接队列中删除。注意，每次重传等待的时间不一定相同，一般会是指数增长，例如间隔时间为 1s, 2s, 4s, 8s, ….</div>\n\n<h3 id=\"如果已经建立了连接，但客户端突然出现了故障？\"><a href=\"#如果已经建立了连接，但客户端突然出现了故障？\" class=\"headerlink\" title=\"如果已经建立了连接，但客户端突然出现了故障？\"></a>如果已经建立了连接，但客户端突然出现了故障？</h3><p>显然，客户端如果出现故障，服务器不能一直等下去，白白浪费资源。</p>\n<p><strong>TCP</strong> 设有一个 <strong>保活计时器</strong>，<strong>服务器每收到一次客户端的请求后都会重新复位这个计时器</strong>，时间通常是设置为 2 小时，若两小时还没有收到客户端的任何数据，服务器就会发送一个<strong>探测报文段</strong>，以后每隔 75 秒钟发送一次。</p>\n<p>若一连发送 10 个探测报文仍然没反应，服务器就认为客户端出了故障，接着就关闭连接。</p>\n<h3 id=\"其他需要补充的\"><a href=\"#其他需要补充的\" class=\"headerlink\" title=\"其他需要补充的\"></a>其他需要补充的</h3><h4 id=\"TCP-重传\"><a href=\"#TCP-重传\" class=\"headerlink\" title=\"TCP 重传\"></a>TCP 重传</h4><p>A 发送了一个 data，如果 B 收到了要向 A 回复自己收到了（ACK），但是如果 A 发送完 data 半天都没得到 B 的回复，那么 A 就会认为自己的 data 半路被大风刮跑了，需要重新发送一遍，<strong>这就是 TCP 重传</strong>。</p>\n<p>但是也有可能是 B 收到了 A 的消息，只不过是 B 给 A 的 ACK 回复半路被刮跑了，以至于 A 收不到 B 的回复。</p>\n<p>那么既然 A 不能判断究竟是自己的 data 半路没了，还是 B 的回复半路没了，那就干脆不管了，重新发送一遍 data 就行。</p>\n<p>既然发生了 TCP 重传，那么 B 就有可能同一个消息收到了多次，这里就需要 <strong>「去重」</strong>，<strong>「重传」</strong> 和 <strong>「去重」</strong> 工作在操作系统的网络内核模块都已经帮我们处理好了，用户层是不用关心的。</p>\n<h4 id=\"TCP-的双工通信\"><a href=\"#TCP-的双工通信\" class=\"headerlink\" title=\"TCP 的双工通信\"></a>TCP 的双工通信</h4><p>A 可以向 B 喊话，同样 B 也可以向 A 喊话，因为 <strong>TCP 链接是「双工的」</strong>，双方都可以主动发起数据传输。</p>\n<p><strong>不过无论是哪方喊话，都需要收到对方的确认才能认为对方收到了自己的喊话。</strong></p>\n<p>A 可能是个高射炮，一连说了八句话，这时候 B 可以不用一句一句回复，而是连续听了这八句话之后，一起向对方回复说前面你说的八句话我都听见了，这就是<strong>批量 ACK</strong>。</p>\n<p>网络环境的数据交互同人类之间的对话还要复杂一些，它存在数据包乱序的现象。</p>\n<p>同一个来源发出来的不同数据包在 <strong>「网际路由」</strong> 上可能会走过不同的路径，最终达到同一个地方时，顺序就不一样了。</p>\n<p>操作系统的网络内核模块会负责对数据包进行排序，到用户层时顺序就已经完全一致了（所以说我们不用管咯？）。</p>\n<hr>\n\n<h2 id=\"四次挥手\"><a href=\"#四次挥手\" class=\"headerlink\" title=\"四次挥手\"></a>四次挥手</h2><h3 id=\"过程-1\"><a href=\"#过程-1\" class=\"headerlink\" title=\"过程\"></a>过程</h3><h4 id=\"正经一点的-1\"><a href=\"#正经一点的-1\" class=\"headerlink\" title=\"正经一点的\"></a>正经一点的</h4><p>刚开始双方都处于 <code>establised</code> 状态，假如是客户端先发起关闭请求，则：</p>\n<ol>\n<li>第一次挥手：第一次挥手：客户端发送一个 <code>FIN</code> 报文，报文中会指定一个序列号。此时客户端处于 <strong><code>FIN-Wait-1</code></strong> 状态；</li>\n<li>第二次挥手：服务端收到 <code>FIN</code> 之后，会发送 <code>ACK</code> 报文，且把 <strong>客户端的序列号值 + 1</strong> 作为 <code>ACK</code> 报文的序列号值，表明已经收到客户端的报文了，此时服务端处于 <strong><code>Close-Wait</code></strong> 状态，客户端收到后进入 <strong><code>FIN-Wait-2</code></strong> 状态；</li>\n<li>第三次挥手：如果服务端也想断开连接了，和客户端的第一次挥手一样，向客户端发送 <code>FIN</code> 报文，且指定一个序列号。此时服务端处于 <strong>Last-ACK</strong> 的状态。</li>\n<li>第四次挥手：客户端收到来自服务端的 <code>FIN</code> 之后，一样发送一个 <code>ACK</code> 报文作为应答，且把 <strong>服务端的序列号值 + 1</strong> 作为自己 <code>ACK</code> 报文的序列号值，此时客户端处于 <strong><code>Time-Wait</code></strong> 状态。需要过一阵子以 <strong>确保服务端收到</strong> 自己的 <code>ACK</code> 报文之后才会进入 <strong><code>Closed</code></strong> 状态。</li>\n<li>服务端收到 <code>ACK</code> 报文之后，就处于关闭连接了，处于 <strong><code>Closed</code></strong> 状态。</li>\n</ol>\n<img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/four.png\" alt=\"TCP 四次挥手\">\n\n<p>也来个动图叭：</p>\n<img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/four.gif\" alt=\"TCP 四次挥手\">\n\n<h4 id=\"不正经的-1\"><a href=\"#不正经的-1\" class=\"headerlink\" title=\"不正经的\"></a>不正经的</h4><img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/four01.png\" alt=\"TCP 四次挥手\">\n\n<h3 id=\"超级重要的-Time-Wait-状态\"><a href=\"#超级重要的-Time-Wait-状态\" class=\"headerlink\" title=\"超级重要的 Time-Wait 状态\"></a>超级重要的 Time-Wait 状态</h3><h4 id=\"什么是-Time-Wait\"><a href=\"#什么是-Time-Wait\" class=\"headerlink\" title=\"什么是 Time-Wait\"></a>什么是 Time-Wait</h4><p>为什么客户端发送 ACK 之后不直接关闭，而是要等一阵子才关闭？</p>\n<p><strong><code>Time-Wait</code></strong> 是主动关闭的一方在回复完对方的挥手后进入的一个长期状态。</p>\n<p>这个状态标准的持续时间是 4 分钟，4 分钟后才会进入到 <strong><code>Closed</code></strong> 状态，释放套接字资源。不过在具体实现上这个时间是可以调整的。</p>\n<p>4 分钟就是 2 个 MSL，每个 MSL 是 2 分钟。MSL 就是 <strong>Maximum Segment Lifetime —— 最长报文寿命</strong>。</p>\n<p>这个时间是由官方 RFC 协议规定的。至于为什么是 2 个 MSL 而不是 1 个 MSL，还没有看到一个非常满意的解释。</p>\n<p>它就好比主动分手方要承担的责任，是你提出的要分手，你得付出代价。这个后果就是持续 4 分钟的 <strong><code>Time-Wait</code></strong> 状态，不能释放套接字资源(端口)，就好比守寡期，这段时间内套接字资源(端口)不得回收利用。</p>\n<p>它的作用是重传最后一个 <code>ACK</code> 报文，确保对方可以收到。因为如果对方没有收到 <code>ACK</code> 的话，会重传 <code>FIN</code> 报文，处于 <strong><code>Time-Wait</code></strong> 状态的套接字会立即向对方重发 ack 报文。</p>\n<p>即：要确保服务器是否已经收到了我们的 <code>ACK</code> 报文，如果没有收到的话，服务器会重新发 <code>FIN</code> 报文给客户端，客户端再次收到 <code>FIN</code> 报文之后，就知道之前的 <code>ACK</code> 报文丢失了，然后再次发送 <code>ACK</code> 报文。</p>\n<h4 id=\"为什么必须要经过-2-MSL-才能返回到-Close-状态\"><a href=\"#为什么必须要经过-2-MSL-才能返回到-Close-状态\" class=\"headerlink\" title=\"为什么必须要经过 2 MSL 才能返回到 Close 状态\"></a>为什么必须要经过 2 MSL 才能返回到 Close 状态</h4><p>虽然按道理，四个报文都发送完毕，我们可以直接进入 <strong><code>Close</code></strong> 状态了，但是我们必须假象网络是不可靠的，有可以最后一个 <code>ACK</code> 丢失。所以 <strong><code>Time-Wait</code></strong> 状态就是用来重发可能丢失的 <code>ACK</code> 报文。</p>\n<p>在客户端发送出最后的 <code>ACK</code> 回复后，该 <code>ACK</code> 可能丢失。服务端如果没有收到 <code>ACK</code>，将不断重复发送 <code>FIN</code> 片段。<strong>所以客户端不能立即关闭，它必须确认服务端接收到了该 <code>ACK</code></strong>。</p>\n<p>客户端会在发送出 <code>ACK</code> 之后进入到 <strong><code>Time-Wait</code></strong> 状态。客户端会设置一个计时器，等待 2 MSL 的时间。</p>\n<p>如果在该时间内再次收到 <code>FIN</code>（因为服务端没收到客户端最后的 <code>ACK</code> 就会重发 <code>FIN</code>，如果客户端在等待 2 MSL 的时候又收到了来自服务端的 <code>FIN</code>，那就说明自己之前的 <code>ACK</code> 丢了），那么客户端会重发 <code>ACK</code> 并再次等待 2 MSL。</p>\n<p>MSL 指一个片段在网络中最大的存活时间，2 MSL 就是一个发送和一个回复所需的最大时间。如果直到 2 MSL，客户端都没有再次收到来自服务端的 <code>FIN</code>，那么服务端就有理由推断自己的最后一个 <code>ACK</code> 已经被成功接收，则结束 <code>TCP</code> 连接。</p>\n<h3 id=\"总是四次挥手吗？\"><a href=\"#总是四次挥手吗？\" class=\"headerlink\" title=\"总是四次挥手吗？\"></a>总是四次挥手吗？</h3><p>四次挥手也并不总是四次挥手，中间的两个动作有时候是可以合并一起进行的。</p>\n<p>这个时候就成了三次挥手，主动关闭方就会从 <strong><code>FIN-Wait-1</code></strong> 状态直接进入到 <strong><code>Time-Wait</code></strong> 状态，跳过了 <strong><code>FIN-Wait-2</code></strong> 状态。</p>\n<h3 id=\"为什么连接的时候要三次握手，而关闭的时候要四次挥手\"><a href=\"#为什么连接的时候要三次握手，而关闭的时候要四次挥手\" class=\"headerlink\" title=\"为什么连接的时候要三次握手，而关闭的时候要四次挥手\"></a>为什么连接的时候要三次握手，而关闭的时候要四次挥手</h3><p>因为当服务端收到客户端端的 <code>SYN</code> 连接请求报文后，可以直接发送 <code>SYN + ACK</code> 报文。其中 <code>ACK</code> 报文是用来应答的，<code>SYN</code> 报文是用来同步的。</p>\n<p>但是关闭连接时，当服务端端收到 <code>FIN</code> 报文时，很可能并不会立即关闭 <code>SOCKET</code>，所以只能先回复一个 <code>ACK</code> 报文，告诉客户端：<strong>“你发的 <code>FIN</code> 报文我收到了”</strong>。只有等到我这边（服务端）所有的报文都发送完了，我才能发送 <code>FIN</code> 报文，因此不能一起发送。<strong>故需要四步挥手。</strong></p>\n<hr>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>一图胜千言了…</p>\n<img src=\"/2020/01/19/%E6%9D%A5%E8%AF%B4%E8%AF%B4TCP%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B%E5%90%A7/total.png\" alt=\"总览\">\n\n<hr>\n\n<h2 id=\"参考资料\"><a href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"></a>参考资料</h2><ul>\n<li><a href=\"http://www.sohu.com/a/246199963_463994\" target=\"_blank\" rel=\"noopener\">6张动态图轻松学习TCP三次握手和四次挥手</a></li>\n<li><a href=\"https://blog.csdn.net/qq_38950316/article/details/81087809\" target=\"_blank\" rel=\"noopener\">TCP的三次握手与四次挥手理解及面试题（很全面）</a></li>\n<li><a href=\"https://blog.csdn.net/weixin_44460333/article/details/89369316\" target=\"_blank\" rel=\"noopener\">关于三次握手与四次挥手面试官想考什么？</a></li>\n<li><a href=\"https://www.cnblogs.com/jainszhang/p/10641728.html\" target=\"_blank\" rel=\"noopener\">TCP三次握手和四次挥手通俗理解</a></li>\n<li><a href=\"http://www.pianshen.com/article/1002102250/\" target=\"_blank\" rel=\"noopener\">在深谈TCP/IP三步握手&amp;四步挥手原理及衍生问题——长文解剖IP</a></li>\n</ul>"},{"title":"设置你喜欢的live2d看板娘","date":"2019-09-04T08:49:48.000Z","copyright":true,"_content":"\n<style type=\"text/css\">\n.redspan {\n    color: red;\n}\n.quotetitle {\n    color: #337ab7;\n    font-weight: 700;\n}\n.purpletitle {\n    color: #9954bb;\n    font-weight: 700;\n}\n.italic {\n    font-style: italic;\n}\n.markbutton {\n    padding: 3px 5px;\n    margin: 0 4px;\n    font-size: 16px;\n    font-weight: 700;\n    color: white;\n}\n.bgblue {\n    background-color: #337ab7;\n}\n.bgpurple {\n    background-color: #9954bb;\n}\n.bgred {\n    background-color: red;\n}\ntd {\n    text-align: center;\n    vertical-align: bottom;\n}\ntable td img {\n    max-height: 320px;\n    width: 240px;\n}\ntd, th {\n    border: 2px dotted gray;\n    font-size: 18px;\n}\nth {\n    background-color: #337ab7;\n    color: white;\n}\n.image-display {\n    text-align: center;\n    font-size: 16px;\n}\n.image-display img {\n    padding-bottom: 8px;\n}\n.code {\n    text-align: left;\n}\n</style>\n\n> <span class = 'redspan'>从不浪费时间的人，没有工夫抱怨时间不够。</span><br/>\n又在踩了无数次坑后，将我的小看板娘配置好了，在这里我会详细的介绍如何配置 <a>Live 2D 看板娘</a> 与我踩过的那些坑。\n那么，现在开始配置属于你自己的 <a>Live 2D 看板娘</a> 吧！（多图警告！）\n\n<!--more-->\n\n<hr/>\n\n## 普通版本\n之前在我的 [这篇博客](https://www.wqh4u.cn/2019/07/31/Hexo博客的安装与基本配置/#live2d) 中有提到使用 [这个项目](https://github.com/EYHN/hexo-helper-live2d) 来制作个性化的看板娘，其中一个样式如下：\n\n<div class = \"image-display\">\n    <img src = \"./shizuku.gif\" alt = \"shizuku\" style = \"max-width: 240px;\"></img>\n    <p> 可爱的 SHIZUKU </p>\n</div>\n\n切换至 `Hexo` 根目录下，在终端中输入以下代码：\n```bash\n$ npm install -save hexo-helper-live2d\n```\n\n编辑 <span class = \"markbutton bgblue\">站点配置文件</span>：（具体配置见 [官方文档](https://github.com/EYHN/hexo-helper-live2d)）\n```yml\nlive2d:\n  enable: true\n  scriptFrom: local\n  pluginRootPath: live2dw/\n  pluginJsPath: lib/\n  pluginModelPath: assets/\n  model:\n    use: live2d-widget-model-wanko\n  display:\n    position: right\n    width: 150\n    height: 300\n  mobile:\n    show: true\n```\n\n你可以在 [这里](https://github.com/xiazeyu/live2d-widget-models) 找到非常多的 <a>MODEL</a>：\n\n<div class = \"image-display\">\n    <img src = \"./models.jpg\" alt = \"models\"></img>\n    <p>所有的 <a>Live 2D</a> MODELS</p>\n</div>\n\n我尝试配置了一些 <span class = \"markbutton bgblue\">MODELS</span> 并且做了截图，各位大佬们不用一个个的去试了：\n\n<table style = \"margin: 0 auto; max-width: 100%;\">\n    <tr>\n        <td>\n            <img src = \"./chitose.jpg\" alt = \"chitose\"></img>\n            <hr/>\n            <p> ChiToSe </p>\n        </td>\n        <td>\n            <img src = \"./Epsilon2.1.png\" alt = \"Epsilon2.1\"></img>\n            <hr/>\n            <p> Epsilon2.1 </p>\n        </td>\n        <td>\n            <img src = \"./Gantzert_Felixander.png\" alt = \"Gantzert_Felixander\"></img>\n            <hr/>\n            <p> Gantzert_Felixander </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src = \"./haru.png\" alt = \"haru\"></img>\n            <hr/>\n            <p> HaRu </p>\n        </td>\n        <td>\n            <img src = \"./haruto.png\" alt = \"haruto\"></img>\n            <hr/>\n            <p> HaRuTo </p>\n        </td>\n        <td>\n            <img src = \"./hibiki.png\" alt = \"hibiki\" style = \"width: 150px\"></img>\n            <hr/>\n            <p> HiBiKi </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src = \"./hijiki.png\" alt = \"hijiki\"></img>\n            <hr/>\n            <p> HiJiKi </p>\n        </td>\n        <td>\n            <img src = \"./izumi.jpg\" alt = \"izumi\"></img>\n            <hr/>\n            <p> IZuMi </p>\n        </td>\n        <td>\n            <img src = \"./koharu.png\" alt = \"koharu\"></img>\n            <hr/>\n            <p> KoHaRu </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src = \"./miku.png\" alt = \"miku\"></img>\n            <hr/>\n            <p> MiKu </p>\n        </td>\n        <td>\n            <img src = \"./nico.png\" alt = \"nico\"></img>\n            <hr/>\n            <p> NiCo </p>\n        </td>\n        <td>\n            <img src = \"./nietzche.png\" alt = \"nietzche\"></img>\n            <hr/>\n            <p> Nietzche </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src = \"./ni-j.png\" alt = \"ni-j\"></img>\n            <hr/>\n            <p> NI-J </p>\n        </td>\n        <td>\n            <img src = \"./nipsilon.png\" alt = \"nipsilon\"></img>\n            <hr/>\n            <p> Nipsilon </p>\n        </td>\n        <td>\n            <img src = \"./nito.png\" alt = \"nito\"></img>\n            <hr/>\n            <p> Nito </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src = \"./shizuku.png\" alt = \"shizuku\"></img>\n            <hr/>\n            <p> ShiZuKu </p>\n        </td>\n        <td>\n            <img src = \"./tororo.png\" alt = \"tororo\"></img>\n            <hr/>\n            <p> ToRoRo </p>\n        </td>\n        <td>\n            <img src = \"./tsumiki.png\" alt = \"tsumiki\" style = \"width: 220px;\"></img>\n            <hr/>\n            <p> TsuMiKi </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src = \"./Unitychan.png\" alt = \"Unitychan\"></img>\n            <hr/>\n            <p> Unitychan </p>\n        </td>\n        <td>\n            <img src = \"./wanko.png\" alt = \"wanko\"></img>\n            <hr/>\n            <p> wanko </p>\n        </td>\n        <td>\n            <img src = \"./z16.png\" alt = \"z16\"></img>\n            <hr/>\n            <p> Z16 </p>\n        </td>\n    </tr>\n</table>\n\n<del>（是不是还是感觉 ShiZuKu 还是最好看呢2333...）</del>\n\n<hr/>\n\n## 进阶版本\n\n> 什么？你想要一个 <span class = \"markbutton bgblue\">能说话</span>、<span class = \"markbutton bgblue\">能互动</span>、<span class = \"markbutton bgblue\">能玩游戏</span>、<span class = \"markbutton bgblue\">能换装</span>的看板娘？<del>呵~</del>\n\n感谢 [张书樵大神](https://zhangshuqiao.org) 的 [Live2D项目](https://github.com/stevenjoezhang/live2d-widget)，让你可以实现你的愿望。\n\n首先，`clone` 项目到你的本地（或你的 `Hexo` 根目录下）：\n\n```bash\ngit clone https://github.com/stevenjoezhang/live2d-widget\n```\n\n> 如果你是在你的 `Hexo` 下配置的，请将项目文件解压至 `你的Hexo根目录/source/live2d-widget/` 下（没有 `live2d-widget` 请手动创建）\n\n如果你想自定义你的看板娘 <span class = \"markbutton bgpurple\">初始加载模型</span> 或者 <span class = \"markbutton bgpurple\">互动话语</span> 的话，首先修改 <span class = \"markbutton bgblue\">live2d-widget</span> 目录下的 <span class = \"markbutton bgblue\">autoload.js</span> 文件，将：\n\n```javascript\nconst live2d_path = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/\";\n// const live2d_path = \"/live2d-widget/\";\n```\n\n改为：\n\n```javascript\n// const live2d_path = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/\";\nconst live2d_path = \"/live2d-widget/\";\n```\n\n随后，在 `你的Hexo根目录/themes/next/layout/_layout.swing` 中，`</body>` 之前，增加以下内容：\n\n```html\n<script src=\"/live2d-widget/autoload.js\"></script>\n```\n\n在 `</head>` 之前，增加以下内容：\n```html\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\">\n```\n\n在你的 <span class = \"markbutton bgpurple\">主题配置文件</span> 中，新增以下内容：\n\n```yml\nlive2d:\n  enable: true\n```\n\n> 如果你已经使用了 `普通版本` 的 `Live 2D`，请将其他无关属性注释掉！\n\n如果你想自定义看板娘大小、位置或者其他样式，请修改 <span class = \"markbutton bgblue\">waifu.css</span>\n\n如果你想自定义看板娘言语互动，请修改 <span class = \"markbutton bgblue\">waifu-tips.js</span> 和 <span class = \"markbutton bgblue\">waifu-tips.json</span>\n\n<hr/>\n\n## 高级版本中我所踩的那些坑\n\n### jQuery加载失败\n\n时刻注意着你的 `Console`，如果出现了找不到符号 `$`，因为首先加载的 <span class = \"markbutton bgblue\">autoload.js</span>，里面第一个干的事情就是通过 `Ajax` 去请求 <span class = \"markbutton bgblue\">live2d.min.js</span> 与 <span class = \"markbutton bgblue\">waifu-tips.js</span>，所以要保证你已经导入了 `jQuery` 库，如果没有的话请在 `你的Hexo根目录/themes/next/layout/_layout.swing` 中，`</head>` 标签前，手动导入 `jQuery`。\n\n### loadlive2d方法未定义\n\n在你的 <span class = \"markbutton bgblue\">autoload.js</span> 文件中，将加载 <span class = \"markbutton bgblue\">live2d.min.js</span> 那一段的 `URL` 请求改为：\n\n```javascript\n// 上面省略\nurl: \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/live2d.min.js\",\n// 下面省略\n```\n\n### CROS跨域请求失败\n\n因为 <del>人尽皆知</del> 的原因，在 <span class = \"markbutton bgblue\">waifu-tips.js</span> 中第 `162` 行向目标发起了一个 `getJSON` 请求你的目标文件 <span class = \"markbutton bgblue\">waifu-tips.json</span>，这里会出现问题，需要你去设置跨域请求头。\n\n我是用的 `Nginx` 来部署博客的，所以就用 `Nginx` 举例：\n\n在你的 `Nginx` 网站配置文件中，在你的服务里面，添加如下代码：\n\n```bash\nadd_header 'Access-Control-Allow-Origin' '*';\nadd_header 'Access-Control-Allow-Credentials' 'true';\nadd_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';\n```\n\n然后重启你的 `Nginx` 服务即可解决。\n\n### 奇奇怪怪的问题\n\n使用 `hexo g` 后，在你的 `/public/` 文件夹中会生成一个 `/live2d-widget/` 文件，其中 <span class = \"markbutton bgblue\">waifu-tips.js</span> 会有一些莫名其妙的问题，你需要将你的 `Hexo/source/live2d-widget/waifu-tips.js` 复制粘贴覆盖掉 `public` 目录下那个有问题的文件中的内容。同理，<span class = \"markbutton bgblue\">waifu-tips.json</span> 也会有一些奇奇怪怪的问题，也需要你手动的去覆盖一次。\n\nP.S.觉得麻烦的可以写一个 `bash` 脚本，代码大致如下：\n\n```bash\n#!/bin/bash\nhexo clean\nhexo g\nrm ./public/live2d-widget/waifu-tips.js\nrm ./public/live2d-widget/waifu-tips.json\ncp ./source/live2d-widget/waifu-tips.js ./public/live2d-widget/\ncp ./source/live2d-widget/waifu-tips.json ./public/live2d-widget/\necho OK\n```\n\n然后就可以一键生成辽~\n","source":"_posts/设置你喜欢的live2d看板娘.md","raw":"---\ntitle: 设置你喜欢的live2d看板娘\ndate: 2019-09-04 16:49:48\ntags:\n- Hexo\n- Nginx\n- NexT\ncategories:\n- Hexo\n- NexT\n- Live2D\ncopyright: true\n---\n\n<style type=\"text/css\">\n.redspan {\n    color: red;\n}\n.quotetitle {\n    color: #337ab7;\n    font-weight: 700;\n}\n.purpletitle {\n    color: #9954bb;\n    font-weight: 700;\n}\n.italic {\n    font-style: italic;\n}\n.markbutton {\n    padding: 3px 5px;\n    margin: 0 4px;\n    font-size: 16px;\n    font-weight: 700;\n    color: white;\n}\n.bgblue {\n    background-color: #337ab7;\n}\n.bgpurple {\n    background-color: #9954bb;\n}\n.bgred {\n    background-color: red;\n}\ntd {\n    text-align: center;\n    vertical-align: bottom;\n}\ntable td img {\n    max-height: 320px;\n    width: 240px;\n}\ntd, th {\n    border: 2px dotted gray;\n    font-size: 18px;\n}\nth {\n    background-color: #337ab7;\n    color: white;\n}\n.image-display {\n    text-align: center;\n    font-size: 16px;\n}\n.image-display img {\n    padding-bottom: 8px;\n}\n.code {\n    text-align: left;\n}\n</style>\n\n> <span class = 'redspan'>从不浪费时间的人，没有工夫抱怨时间不够。</span><br/>\n又在踩了无数次坑后，将我的小看板娘配置好了，在这里我会详细的介绍如何配置 <a>Live 2D 看板娘</a> 与我踩过的那些坑。\n那么，现在开始配置属于你自己的 <a>Live 2D 看板娘</a> 吧！（多图警告！）\n\n<!--more-->\n\n<hr/>\n\n## 普通版本\n之前在我的 [这篇博客](https://www.wqh4u.cn/2019/07/31/Hexo博客的安装与基本配置/#live2d) 中有提到使用 [这个项目](https://github.com/EYHN/hexo-helper-live2d) 来制作个性化的看板娘，其中一个样式如下：\n\n<div class = \"image-display\">\n    <img src = \"./shizuku.gif\" alt = \"shizuku\" style = \"max-width: 240px;\"></img>\n    <p> 可爱的 SHIZUKU </p>\n</div>\n\n切换至 `Hexo` 根目录下，在终端中输入以下代码：\n```bash\n$ npm install -save hexo-helper-live2d\n```\n\n编辑 <span class = \"markbutton bgblue\">站点配置文件</span>：（具体配置见 [官方文档](https://github.com/EYHN/hexo-helper-live2d)）\n```yml\nlive2d:\n  enable: true\n  scriptFrom: local\n  pluginRootPath: live2dw/\n  pluginJsPath: lib/\n  pluginModelPath: assets/\n  model:\n    use: live2d-widget-model-wanko\n  display:\n    position: right\n    width: 150\n    height: 300\n  mobile:\n    show: true\n```\n\n你可以在 [这里](https://github.com/xiazeyu/live2d-widget-models) 找到非常多的 <a>MODEL</a>：\n\n<div class = \"image-display\">\n    <img src = \"./models.jpg\" alt = \"models\"></img>\n    <p>所有的 <a>Live 2D</a> MODELS</p>\n</div>\n\n我尝试配置了一些 <span class = \"markbutton bgblue\">MODELS</span> 并且做了截图，各位大佬们不用一个个的去试了：\n\n<table style = \"margin: 0 auto; max-width: 100%;\">\n    <tr>\n        <td>\n            <img src = \"./chitose.jpg\" alt = \"chitose\"></img>\n            <hr/>\n            <p> ChiToSe </p>\n        </td>\n        <td>\n            <img src = \"./Epsilon2.1.png\" alt = \"Epsilon2.1\"></img>\n            <hr/>\n            <p> Epsilon2.1 </p>\n        </td>\n        <td>\n            <img src = \"./Gantzert_Felixander.png\" alt = \"Gantzert_Felixander\"></img>\n            <hr/>\n            <p> Gantzert_Felixander </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src = \"./haru.png\" alt = \"haru\"></img>\n            <hr/>\n            <p> HaRu </p>\n        </td>\n        <td>\n            <img src = \"./haruto.png\" alt = \"haruto\"></img>\n            <hr/>\n            <p> HaRuTo </p>\n        </td>\n        <td>\n            <img src = \"./hibiki.png\" alt = \"hibiki\" style = \"width: 150px\"></img>\n            <hr/>\n            <p> HiBiKi </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src = \"./hijiki.png\" alt = \"hijiki\"></img>\n            <hr/>\n            <p> HiJiKi </p>\n        </td>\n        <td>\n            <img src = \"./izumi.jpg\" alt = \"izumi\"></img>\n            <hr/>\n            <p> IZuMi </p>\n        </td>\n        <td>\n            <img src = \"./koharu.png\" alt = \"koharu\"></img>\n            <hr/>\n            <p> KoHaRu </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src = \"./miku.png\" alt = \"miku\"></img>\n            <hr/>\n            <p> MiKu </p>\n        </td>\n        <td>\n            <img src = \"./nico.png\" alt = \"nico\"></img>\n            <hr/>\n            <p> NiCo </p>\n        </td>\n        <td>\n            <img src = \"./nietzche.png\" alt = \"nietzche\"></img>\n            <hr/>\n            <p> Nietzche </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src = \"./ni-j.png\" alt = \"ni-j\"></img>\n            <hr/>\n            <p> NI-J </p>\n        </td>\n        <td>\n            <img src = \"./nipsilon.png\" alt = \"nipsilon\"></img>\n            <hr/>\n            <p> Nipsilon </p>\n        </td>\n        <td>\n            <img src = \"./nito.png\" alt = \"nito\"></img>\n            <hr/>\n            <p> Nito </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src = \"./shizuku.png\" alt = \"shizuku\"></img>\n            <hr/>\n            <p> ShiZuKu </p>\n        </td>\n        <td>\n            <img src = \"./tororo.png\" alt = \"tororo\"></img>\n            <hr/>\n            <p> ToRoRo </p>\n        </td>\n        <td>\n            <img src = \"./tsumiki.png\" alt = \"tsumiki\" style = \"width: 220px;\"></img>\n            <hr/>\n            <p> TsuMiKi </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src = \"./Unitychan.png\" alt = \"Unitychan\"></img>\n            <hr/>\n            <p> Unitychan </p>\n        </td>\n        <td>\n            <img src = \"./wanko.png\" alt = \"wanko\"></img>\n            <hr/>\n            <p> wanko </p>\n        </td>\n        <td>\n            <img src = \"./z16.png\" alt = \"z16\"></img>\n            <hr/>\n            <p> Z16 </p>\n        </td>\n    </tr>\n</table>\n\n<del>（是不是还是感觉 ShiZuKu 还是最好看呢2333...）</del>\n\n<hr/>\n\n## 进阶版本\n\n> 什么？你想要一个 <span class = \"markbutton bgblue\">能说话</span>、<span class = \"markbutton bgblue\">能互动</span>、<span class = \"markbutton bgblue\">能玩游戏</span>、<span class = \"markbutton bgblue\">能换装</span>的看板娘？<del>呵~</del>\n\n感谢 [张书樵大神](https://zhangshuqiao.org) 的 [Live2D项目](https://github.com/stevenjoezhang/live2d-widget)，让你可以实现你的愿望。\n\n首先，`clone` 项目到你的本地（或你的 `Hexo` 根目录下）：\n\n```bash\ngit clone https://github.com/stevenjoezhang/live2d-widget\n```\n\n> 如果你是在你的 `Hexo` 下配置的，请将项目文件解压至 `你的Hexo根目录/source/live2d-widget/` 下（没有 `live2d-widget` 请手动创建）\n\n如果你想自定义你的看板娘 <span class = \"markbutton bgpurple\">初始加载模型</span> 或者 <span class = \"markbutton bgpurple\">互动话语</span> 的话，首先修改 <span class = \"markbutton bgblue\">live2d-widget</span> 目录下的 <span class = \"markbutton bgblue\">autoload.js</span> 文件，将：\n\n```javascript\nconst live2d_path = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/\";\n// const live2d_path = \"/live2d-widget/\";\n```\n\n改为：\n\n```javascript\n// const live2d_path = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/\";\nconst live2d_path = \"/live2d-widget/\";\n```\n\n随后，在 `你的Hexo根目录/themes/next/layout/_layout.swing` 中，`</body>` 之前，增加以下内容：\n\n```html\n<script src=\"/live2d-widget/autoload.js\"></script>\n```\n\n在 `</head>` 之前，增加以下内容：\n```html\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\">\n```\n\n在你的 <span class = \"markbutton bgpurple\">主题配置文件</span> 中，新增以下内容：\n\n```yml\nlive2d:\n  enable: true\n```\n\n> 如果你已经使用了 `普通版本` 的 `Live 2D`，请将其他无关属性注释掉！\n\n如果你想自定义看板娘大小、位置或者其他样式，请修改 <span class = \"markbutton bgblue\">waifu.css</span>\n\n如果你想自定义看板娘言语互动，请修改 <span class = \"markbutton bgblue\">waifu-tips.js</span> 和 <span class = \"markbutton bgblue\">waifu-tips.json</span>\n\n<hr/>\n\n## 高级版本中我所踩的那些坑\n\n### jQuery加载失败\n\n时刻注意着你的 `Console`，如果出现了找不到符号 `$`，因为首先加载的 <span class = \"markbutton bgblue\">autoload.js</span>，里面第一个干的事情就是通过 `Ajax` 去请求 <span class = \"markbutton bgblue\">live2d.min.js</span> 与 <span class = \"markbutton bgblue\">waifu-tips.js</span>，所以要保证你已经导入了 `jQuery` 库，如果没有的话请在 `你的Hexo根目录/themes/next/layout/_layout.swing` 中，`</head>` 标签前，手动导入 `jQuery`。\n\n### loadlive2d方法未定义\n\n在你的 <span class = \"markbutton bgblue\">autoload.js</span> 文件中，将加载 <span class = \"markbutton bgblue\">live2d.min.js</span> 那一段的 `URL` 请求改为：\n\n```javascript\n// 上面省略\nurl: \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/live2d.min.js\",\n// 下面省略\n```\n\n### CROS跨域请求失败\n\n因为 <del>人尽皆知</del> 的原因，在 <span class = \"markbutton bgblue\">waifu-tips.js</span> 中第 `162` 行向目标发起了一个 `getJSON` 请求你的目标文件 <span class = \"markbutton bgblue\">waifu-tips.json</span>，这里会出现问题，需要你去设置跨域请求头。\n\n我是用的 `Nginx` 来部署博客的，所以就用 `Nginx` 举例：\n\n在你的 `Nginx` 网站配置文件中，在你的服务里面，添加如下代码：\n\n```bash\nadd_header 'Access-Control-Allow-Origin' '*';\nadd_header 'Access-Control-Allow-Credentials' 'true';\nadd_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';\n```\n\n然后重启你的 `Nginx` 服务即可解决。\n\n### 奇奇怪怪的问题\n\n使用 `hexo g` 后，在你的 `/public/` 文件夹中会生成一个 `/live2d-widget/` 文件，其中 <span class = \"markbutton bgblue\">waifu-tips.js</span> 会有一些莫名其妙的问题，你需要将你的 `Hexo/source/live2d-widget/waifu-tips.js` 复制粘贴覆盖掉 `public` 目录下那个有问题的文件中的内容。同理，<span class = \"markbutton bgblue\">waifu-tips.json</span> 也会有一些奇奇怪怪的问题，也需要你手动的去覆盖一次。\n\nP.S.觉得麻烦的可以写一个 `bash` 脚本，代码大致如下：\n\n```bash\n#!/bin/bash\nhexo clean\nhexo g\nrm ./public/live2d-widget/waifu-tips.js\nrm ./public/live2d-widget/waifu-tips.json\ncp ./source/live2d-widget/waifu-tips.js ./public/live2d-widget/\ncp ./source/live2d-widget/waifu-tips.json ./public/live2d-widget/\necho OK\n```\n\n然后就可以一键生成辽~\n","slug":"设置你喜欢的live2d看板娘","published":1,"updated":"2020-01-14T20:30:48.125Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck5obqn6o001e2lwjhxx884ul","content":"<style type=\"text/css\">\n.redspan {\n    color: red;\n}\n.quotetitle {\n    color: #337ab7;\n    font-weight: 700;\n}\n.purpletitle {\n    color: #9954bb;\n    font-weight: 700;\n}\n.italic {\n    font-style: italic;\n}\n.markbutton {\n    padding: 3px 5px;\n    margin: 0 4px;\n    font-size: 16px;\n    font-weight: 700;\n    color: white;\n}\n.bgblue {\n    background-color: #337ab7;\n}\n.bgpurple {\n    background-color: #9954bb;\n}\n.bgred {\n    background-color: red;\n}\ntd {\n    text-align: center;\n    vertical-align: bottom;\n}\ntable td img {\n    max-height: 320px;\n    width: 240px;\n}\ntd, th {\n    border: 2px dotted gray;\n    font-size: 18px;\n}\nth {\n    background-color: #337ab7;\n    color: white;\n}\n.image-display {\n    text-align: center;\n    font-size: 16px;\n}\n.image-display img {\n    padding-bottom: 8px;\n}\n.code {\n    text-align: left;\n}\n</style>\n\n<blockquote>\n<p><span class=\"redspan\">从不浪费时间的人，没有工夫抱怨时间不够。</span><br><br>又在踩了无数次坑后，将我的小看板娘配置好了，在这里我会详细的介绍如何配置 <a>Live 2D 看板娘</a> 与我踩过的那些坑。<br>那么，现在开始配置属于你自己的 <a>Live 2D 看板娘</a> 吧！（多图警告！）</p>\n</blockquote>\n<a id=\"more\"></a>\n\n<hr>\n\n<h2 id=\"普通版本\"><a href=\"#普通版本\" class=\"headerlink\" title=\"普通版本\"></a>普通版本</h2><p>之前在我的 <a href=\"https://www.wqh4u.cn/2019/07/31/Hexo博客的安装与基本配置/#live2d\">这篇博客</a> 中有提到使用 <a href=\"https://github.com/EYHN/hexo-helper-live2d\" target=\"_blank\" rel=\"noopener\">这个项目</a> 来制作个性化的看板娘，其中一个样式如下：</p>\n<div class=\"image-display\">\n    <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/shizuku.gif\" alt=\"shizuku\" style=\"max-width: 240px;\">\n    <p> 可爱的 SHIZUKU </p>\n</div>\n\n<p>切换至 <code>Hexo</code> 根目录下，在终端中输入以下代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install -save hexo-helper-live2d</span><br></pre></td></tr></table></figure>\n\n<p>编辑 <span class=\"markbutton bgblue\">站点配置文件</span>：（具体配置见 <a href=\"https://github.com/EYHN/hexo-helper-live2d\" target=\"_blank\" rel=\"noopener\">官方文档</a>）</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">live2d:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">scriptFrom:</span> <span class=\"string\">local</span></span><br><span class=\"line\">  <span class=\"attr\">pluginRootPath:</span> <span class=\"string\">live2dw/</span></span><br><span class=\"line\">  <span class=\"attr\">pluginJsPath:</span> <span class=\"string\">lib/</span></span><br><span class=\"line\">  <span class=\"attr\">pluginModelPath:</span> <span class=\"string\">assets/</span></span><br><span class=\"line\">  <span class=\"attr\">model:</span></span><br><span class=\"line\">    <span class=\"attr\">use:</span> <span class=\"string\">live2d-widget-model-wanko</span></span><br><span class=\"line\">  <span class=\"attr\">display:</span></span><br><span class=\"line\">    <span class=\"attr\">position:</span> <span class=\"string\">right</span></span><br><span class=\"line\">    <span class=\"attr\">width:</span> <span class=\"number\">150</span></span><br><span class=\"line\">    <span class=\"attr\">height:</span> <span class=\"number\">300</span></span><br><span class=\"line\">  <span class=\"attr\">mobile:</span></span><br><span class=\"line\">    <span class=\"attr\">show:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<p>你可以在 <a href=\"https://github.com/xiazeyu/live2d-widget-models\" target=\"_blank\" rel=\"noopener\">这里</a> 找到非常多的 <a>MODEL</a>：</p>\n<div class=\"image-display\">\n    <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/models.jpg\" alt=\"models\">\n    <p>所有的 <a>Live 2D</a> MODELS</p>\n</div>\n\n<p>我尝试配置了一些 <span class=\"markbutton bgblue\">MODELS</span> 并且做了截图，各位大佬们不用一个个的去试了：</p>\n<table style=\"margin: 0 auto; max-width: 100%;\">\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/chitose.jpg\" alt=\"chitose\">\n            <hr>\n            <p> ChiToSe </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/Epsilon2.1.png\" alt=\"Epsilon2.1\">\n            <hr>\n            <p> Epsilon2.1 </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/Gantzert_Felixander.png\" alt=\"Gantzert_Felixander\">\n            <hr>\n            <p> Gantzert_Felixander </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/haru.png\" alt=\"haru\">\n            <hr>\n            <p> HaRu </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/haruto.png\" alt=\"haruto\">\n            <hr>\n            <p> HaRuTo </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/hibiki.png\" alt=\"hibiki\" style=\"width: 150px\">\n            <hr>\n            <p> HiBiKi </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/hijiki.png\" alt=\"hijiki\">\n            <hr>\n            <p> HiJiKi </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/izumi.jpg\" alt=\"izumi\">\n            <hr>\n            <p> IZuMi </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/koharu.png\" alt=\"koharu\">\n            <hr>\n            <p> KoHaRu </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/miku.png\" alt=\"miku\">\n            <hr>\n            <p> MiKu </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/nico.png\" alt=\"nico\">\n            <hr>\n            <p> NiCo </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/nietzche.png\" alt=\"nietzche\">\n            <hr>\n            <p> Nietzche </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/ni-j.png\" alt=\"ni-j\">\n            <hr>\n            <p> NI-J </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/nipsilon.png\" alt=\"nipsilon\">\n            <hr>\n            <p> Nipsilon </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/nito.png\" alt=\"nito\">\n            <hr>\n            <p> Nito </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/shizuku.png\" alt=\"shizuku\">\n            <hr>\n            <p> ShiZuKu </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/tororo.png\" alt=\"tororo\">\n            <hr>\n            <p> ToRoRo </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/tsumiki.png\" alt=\"tsumiki\" style=\"width: 220px;\">\n            <hr>\n            <p> TsuMiKi </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/Unitychan.png\" alt=\"Unitychan\">\n            <hr>\n            <p> Unitychan </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/wanko.png\" alt=\"wanko\">\n            <hr>\n            <p> wanko </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/z16.png\" alt=\"z16\">\n            <hr>\n            <p> Z16 </p>\n        </td>\n    </tr>\n</table>\n\n<p><del>（是不是还是感觉 ShiZuKu 还是最好看呢2333…）</del></p>\n<hr>\n\n<h2 id=\"进阶版本\"><a href=\"#进阶版本\" class=\"headerlink\" title=\"进阶版本\"></a>进阶版本</h2><blockquote>\n<p>什么？你想要一个 <span class=\"markbutton bgblue\">能说话</span>、<span class=\"markbutton bgblue\">能互动</span>、<span class=\"markbutton bgblue\">能玩游戏</span>、<span class=\"markbutton bgblue\">能换装</span>的看板娘？<del>呵~</del></p>\n</blockquote>\n<p>感谢 <a href=\"https://zhangshuqiao.org\" target=\"_blank\" rel=\"noopener\">张书樵大神</a> 的 <a href=\"https://github.com/stevenjoezhang/live2d-widget\" target=\"_blank\" rel=\"noopener\">Live2D项目</a>，让你可以实现你的愿望。</p>\n<p>首先，<code>clone</code> 项目到你的本地（或你的 <code>Hexo</code> 根目录下）：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/stevenjoezhang/live2d-widget</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>如果你是在你的 <code>Hexo</code> 下配置的，请将项目文件解压至 <code>你的Hexo根目录/source/live2d-widget/</code> 下（没有 <code>live2d-widget</code> 请手动创建）</p>\n</blockquote>\n<p>如果你想自定义你的看板娘 <span class=\"markbutton bgpurple\">初始加载模型</span> 或者 <span class=\"markbutton bgpurple\">互动话语</span> 的话，首先修改 <span class=\"markbutton bgblue\">live2d-widget</span> 目录下的 <span class=\"markbutton bgblue\">autoload.js</span> 文件，将：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> live2d_path = <span class=\"string\">\"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/\"</span>;</span><br><span class=\"line\"><span class=\"comment\">// const live2d_path = \"/live2d-widget/\";</span></span><br></pre></td></tr></table></figure>\n\n<p>改为：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// const live2d_path = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/\";</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> live2d_path = <span class=\"string\">\"/live2d-widget/\"</span>;</span><br></pre></td></tr></table></figure>\n\n<p>随后，在 <code>你的Hexo根目录/themes/next/layout/_layout.swing</code> 中，<code>&lt;/body&gt;</code> 之前，增加以下内容：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"/live2d-widget/autoload.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在 <code>&lt;/head&gt;</code> 之前，增加以下内容：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\"</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在你的 <span class=\"markbutton bgpurple\">主题配置文件</span> 中，新增以下内容：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">live2d:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>如果你已经使用了 <code>普通版本</code> 的 <code>Live 2D</code>，请将其他无关属性注释掉！</p>\n</blockquote>\n<p>如果你想自定义看板娘大小、位置或者其他样式，请修改 <span class=\"markbutton bgblue\">waifu.css</span></p>\n<p>如果你想自定义看板娘言语互动，请修改 <span class=\"markbutton bgblue\">waifu-tips.js</span> 和 <span class=\"markbutton bgblue\">waifu-tips.json</span></p>\n<hr>\n\n<h2 id=\"高级版本中我所踩的那些坑\"><a href=\"#高级版本中我所踩的那些坑\" class=\"headerlink\" title=\"高级版本中我所踩的那些坑\"></a>高级版本中我所踩的那些坑</h2><h3 id=\"jQuery加载失败\"><a href=\"#jQuery加载失败\" class=\"headerlink\" title=\"jQuery加载失败\"></a>jQuery加载失败</h3><p>时刻注意着你的 <code>Console</code>，如果出现了找不到符号 <code>$</code>，因为首先加载的 <span class=\"markbutton bgblue\">autoload.js</span>，里面第一个干的事情就是通过 <code>Ajax</code> 去请求 <span class=\"markbutton bgblue\">live2d.min.js</span> 与 <span class=\"markbutton bgblue\">waifu-tips.js</span>，所以要保证你已经导入了 <code>jQuery</code> 库，如果没有的话请在 <code>你的Hexo根目录/themes/next/layout/_layout.swing</code> 中，<code>&lt;/head&gt;</code> 标签前，手动导入 <code>jQuery</code>。</p>\n<h3 id=\"loadlive2d方法未定义\"><a href=\"#loadlive2d方法未定义\" class=\"headerlink\" title=\"loadlive2d方法未定义\"></a>loadlive2d方法未定义</h3><p>在你的 <span class=\"markbutton bgblue\">autoload.js</span> 文件中，将加载 <span class=\"markbutton bgblue\">live2d.min.js</span> 那一段的 <code>URL</code> 请求改为：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 上面省略</span></span><br><span class=\"line\">url: <span class=\"string\">\"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/live2d.min.js\"</span>,</span><br><span class=\"line\"><span class=\"comment\">// 下面省略</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"CROS跨域请求失败\"><a href=\"#CROS跨域请求失败\" class=\"headerlink\" title=\"CROS跨域请求失败\"></a>CROS跨域请求失败</h3><p>因为 <del>人尽皆知</del> 的原因，在 <span class=\"markbutton bgblue\">waifu-tips.js</span> 中第 <code>162</code> 行向目标发起了一个 <code>getJSON</code> 请求你的目标文件 <span class=\"markbutton bgblue\">waifu-tips.json</span>，这里会出现问题，需要你去设置跨域请求头。</p>\n<p>我是用的 <code>Nginx</code> 来部署博客的，所以就用 <code>Nginx</code> 举例：</p>\n<p>在你的 <code>Nginx</code> 网站配置文件中，在你的服务里面，添加如下代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add_header <span class=\"string\">'Access-Control-Allow-Origin'</span> <span class=\"string\">'*'</span>;</span><br><span class=\"line\">add_header <span class=\"string\">'Access-Control-Allow-Credentials'</span> <span class=\"string\">'true'</span>;</span><br><span class=\"line\">add_header <span class=\"string\">'Access-Control-Allow-Methods'</span> <span class=\"string\">'GET, POST, OPTIONS'</span>;</span><br></pre></td></tr></table></figure>\n\n<p>然后重启你的 <code>Nginx</code> 服务即可解决。</p>\n<h3 id=\"奇奇怪怪的问题\"><a href=\"#奇奇怪怪的问题\" class=\"headerlink\" title=\"奇奇怪怪的问题\"></a>奇奇怪怪的问题</h3><p>使用 <code>hexo g</code> 后，在你的 <code>/public/</code> 文件夹中会生成一个 <code>/live2d-widget/</code> 文件，其中 <span class=\"markbutton bgblue\">waifu-tips.js</span> 会有一些莫名其妙的问题，你需要将你的 <code>Hexo/source/live2d-widget/waifu-tips.js</code> 复制粘贴覆盖掉 <code>public</code> 目录下那个有问题的文件中的内容。同理，<span class=\"markbutton bgblue\">waifu-tips.json</span> 也会有一些奇奇怪怪的问题，也需要你手动的去覆盖一次。</p>\n<p>P.S.觉得麻烦的可以写一个 <code>bash</code> 脚本，代码大致如下：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo g</span><br><span class=\"line\">rm ./public/live2d-widget/waifu-tips.js</span><br><span class=\"line\">rm ./public/live2d-widget/waifu-tips.json</span><br><span class=\"line\">cp ./<span class=\"built_in\">source</span>/live2d-widget/waifu-tips.js ./public/live2d-widget/</span><br><span class=\"line\">cp ./<span class=\"built_in\">source</span>/live2d-widget/waifu-tips.json ./public/live2d-widget/</span><br><span class=\"line\"><span class=\"built_in\">echo</span> OK</span><br></pre></td></tr></table></figure>\n\n<p>然后就可以一键生成辽~</p>\n","site":{"data":{}},"length":3390,"excerpt":"<style type=\"text/css\">\n.redspan {\n    color: red;\n}\n.quotetitle {\n    color: #337ab7;\n    font-weight: 700;\n}\n.purpletitle {\n    color: #9954bb;\n    font-weight: 700;\n}\n.italic {\n    font-style: italic;\n}\n.markbutton {\n    padding: 3px 5px;\n    margin: 0 4px;\n    font-size: 16px;\n    font-weight: 700;\n    color: white;\n}\n.bgblue {\n    background-color: #337ab7;\n}\n.bgpurple {\n    background-color: #9954bb;\n}\n.bgred {\n    background-color: red;\n}\ntd {\n    text-align: center;\n    vertical-align: bottom;\n}\ntable td img {\n    max-height: 320px;\n    width: 240px;\n}\ntd, th {\n    border: 2px dotted gray;\n    font-size: 18px;\n}\nth {\n    background-color: #337ab7;\n    color: white;\n}\n.image-display {\n    text-align: center;\n    font-size: 16px;\n}\n.image-display img {\n    padding-bottom: 8px;\n}\n.code {\n    text-align: left;\n}\n</style>\n\n<blockquote>\n<p><span class=\"redspan\">从不浪费时间的人，没有工夫抱怨时间不够。</span><br><br>又在踩了无数次坑后，将我的小看板娘配置好了，在这里我会详细的介绍如何配置 <a>Live 2D 看板娘</a> 与我踩过的那些坑。<br>那么，现在开始配置属于你自己的 <a>Live 2D 看板娘</a> 吧！（多图警告！）</p>\n</blockquote>","more":"<hr>\n\n<h2 id=\"普通版本\"><a href=\"#普通版本\" class=\"headerlink\" title=\"普通版本\"></a>普通版本</h2><p>之前在我的 <a href=\"https://www.wqh4u.cn/2019/07/31/Hexo博客的安装与基本配置/#live2d\">这篇博客</a> 中有提到使用 <a href=\"https://github.com/EYHN/hexo-helper-live2d\" target=\"_blank\" rel=\"noopener\">这个项目</a> 来制作个性化的看板娘，其中一个样式如下：</p>\n<div class=\"image-display\">\n    <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/shizuku.gif\" alt=\"shizuku\" style=\"max-width: 240px;\">\n    <p> 可爱的 SHIZUKU </p>\n</div>\n\n<p>切换至 <code>Hexo</code> 根目录下，在终端中输入以下代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install -save hexo-helper-live2d</span><br></pre></td></tr></table></figure>\n\n<p>编辑 <span class=\"markbutton bgblue\">站点配置文件</span>：（具体配置见 <a href=\"https://github.com/EYHN/hexo-helper-live2d\" target=\"_blank\" rel=\"noopener\">官方文档</a>）</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">live2d:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">  <span class=\"attr\">scriptFrom:</span> <span class=\"string\">local</span></span><br><span class=\"line\">  <span class=\"attr\">pluginRootPath:</span> <span class=\"string\">live2dw/</span></span><br><span class=\"line\">  <span class=\"attr\">pluginJsPath:</span> <span class=\"string\">lib/</span></span><br><span class=\"line\">  <span class=\"attr\">pluginModelPath:</span> <span class=\"string\">assets/</span></span><br><span class=\"line\">  <span class=\"attr\">model:</span></span><br><span class=\"line\">    <span class=\"attr\">use:</span> <span class=\"string\">live2d-widget-model-wanko</span></span><br><span class=\"line\">  <span class=\"attr\">display:</span></span><br><span class=\"line\">    <span class=\"attr\">position:</span> <span class=\"string\">right</span></span><br><span class=\"line\">    <span class=\"attr\">width:</span> <span class=\"number\">150</span></span><br><span class=\"line\">    <span class=\"attr\">height:</span> <span class=\"number\">300</span></span><br><span class=\"line\">  <span class=\"attr\">mobile:</span></span><br><span class=\"line\">    <span class=\"attr\">show:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<p>你可以在 <a href=\"https://github.com/xiazeyu/live2d-widget-models\" target=\"_blank\" rel=\"noopener\">这里</a> 找到非常多的 <a>MODEL</a>：</p>\n<div class=\"image-display\">\n    <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/models.jpg\" alt=\"models\">\n    <p>所有的 <a>Live 2D</a> MODELS</p>\n</div>\n\n<p>我尝试配置了一些 <span class=\"markbutton bgblue\">MODELS</span> 并且做了截图，各位大佬们不用一个个的去试了：</p>\n<table style=\"margin: 0 auto; max-width: 100%;\">\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/chitose.jpg\" alt=\"chitose\">\n            <hr>\n            <p> ChiToSe </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/Epsilon2.1.png\" alt=\"Epsilon2.1\">\n            <hr>\n            <p> Epsilon2.1 </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/Gantzert_Felixander.png\" alt=\"Gantzert_Felixander\">\n            <hr>\n            <p> Gantzert_Felixander </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/haru.png\" alt=\"haru\">\n            <hr>\n            <p> HaRu </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/haruto.png\" alt=\"haruto\">\n            <hr>\n            <p> HaRuTo </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/hibiki.png\" alt=\"hibiki\" style=\"width: 150px\">\n            <hr>\n            <p> HiBiKi </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/hijiki.png\" alt=\"hijiki\">\n            <hr>\n            <p> HiJiKi </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/izumi.jpg\" alt=\"izumi\">\n            <hr>\n            <p> IZuMi </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/koharu.png\" alt=\"koharu\">\n            <hr>\n            <p> KoHaRu </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/miku.png\" alt=\"miku\">\n            <hr>\n            <p> MiKu </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/nico.png\" alt=\"nico\">\n            <hr>\n            <p> NiCo </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/nietzche.png\" alt=\"nietzche\">\n            <hr>\n            <p> Nietzche </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/ni-j.png\" alt=\"ni-j\">\n            <hr>\n            <p> NI-J </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/nipsilon.png\" alt=\"nipsilon\">\n            <hr>\n            <p> Nipsilon </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/nito.png\" alt=\"nito\">\n            <hr>\n            <p> Nito </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/shizuku.png\" alt=\"shizuku\">\n            <hr>\n            <p> ShiZuKu </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/tororo.png\" alt=\"tororo\">\n            <hr>\n            <p> ToRoRo </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/tsumiki.png\" alt=\"tsumiki\" style=\"width: 220px;\">\n            <hr>\n            <p> TsuMiKi </p>\n        </td>\n    </tr>\n    <tr>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/Unitychan.png\" alt=\"Unitychan\">\n            <hr>\n            <p> Unitychan </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/wanko.png\" alt=\"wanko\">\n            <hr>\n            <p> wanko </p>\n        </td>\n        <td>\n            <img src=\"/2019/09/04/%E8%AE%BE%E7%BD%AE%E4%BD%A0%E5%96%9C%E6%AC%A2%E7%9A%84live2d%E7%9C%8B%E6%9D%BF%E5%A8%98/z16.png\" alt=\"z16\">\n            <hr>\n            <p> Z16 </p>\n        </td>\n    </tr>\n</table>\n\n<p><del>（是不是还是感觉 ShiZuKu 还是最好看呢2333…）</del></p>\n<hr>\n\n<h2 id=\"进阶版本\"><a href=\"#进阶版本\" class=\"headerlink\" title=\"进阶版本\"></a>进阶版本</h2><blockquote>\n<p>什么？你想要一个 <span class=\"markbutton bgblue\">能说话</span>、<span class=\"markbutton bgblue\">能互动</span>、<span class=\"markbutton bgblue\">能玩游戏</span>、<span class=\"markbutton bgblue\">能换装</span>的看板娘？<del>呵~</del></p>\n</blockquote>\n<p>感谢 <a href=\"https://zhangshuqiao.org\" target=\"_blank\" rel=\"noopener\">张书樵大神</a> 的 <a href=\"https://github.com/stevenjoezhang/live2d-widget\" target=\"_blank\" rel=\"noopener\">Live2D项目</a>，让你可以实现你的愿望。</p>\n<p>首先，<code>clone</code> 项目到你的本地（或你的 <code>Hexo</code> 根目录下）：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/stevenjoezhang/live2d-widget</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>如果你是在你的 <code>Hexo</code> 下配置的，请将项目文件解压至 <code>你的Hexo根目录/source/live2d-widget/</code> 下（没有 <code>live2d-widget</code> 请手动创建）</p>\n</blockquote>\n<p>如果你想自定义你的看板娘 <span class=\"markbutton bgpurple\">初始加载模型</span> 或者 <span class=\"markbutton bgpurple\">互动话语</span> 的话，首先修改 <span class=\"markbutton bgblue\">live2d-widget</span> 目录下的 <span class=\"markbutton bgblue\">autoload.js</span> 文件，将：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> live2d_path = <span class=\"string\">\"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/\"</span>;</span><br><span class=\"line\"><span class=\"comment\">// const live2d_path = \"/live2d-widget/\";</span></span><br></pre></td></tr></table></figure>\n\n<p>改为：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// const live2d_path = \"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/\";</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> live2d_path = <span class=\"string\">\"/live2d-widget/\"</span>;</span><br></pre></td></tr></table></figure>\n\n<p>随后，在 <code>你的Hexo根目录/themes/next/layout/_layout.swing</code> 中，<code>&lt;/body&gt;</code> 之前，增加以下内容：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"/live2d-widget/autoload.js\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在 <code>&lt;/head&gt;</code> 之前，增加以下内容：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css\"</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在你的 <span class=\"markbutton bgpurple\">主题配置文件</span> 中，新增以下内容：</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">live2d:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>如果你已经使用了 <code>普通版本</code> 的 <code>Live 2D</code>，请将其他无关属性注释掉！</p>\n</blockquote>\n<p>如果你想自定义看板娘大小、位置或者其他样式，请修改 <span class=\"markbutton bgblue\">waifu.css</span></p>\n<p>如果你想自定义看板娘言语互动，请修改 <span class=\"markbutton bgblue\">waifu-tips.js</span> 和 <span class=\"markbutton bgblue\">waifu-tips.json</span></p>\n<hr>\n\n<h2 id=\"高级版本中我所踩的那些坑\"><a href=\"#高级版本中我所踩的那些坑\" class=\"headerlink\" title=\"高级版本中我所踩的那些坑\"></a>高级版本中我所踩的那些坑</h2><h3 id=\"jQuery加载失败\"><a href=\"#jQuery加载失败\" class=\"headerlink\" title=\"jQuery加载失败\"></a>jQuery加载失败</h3><p>时刻注意着你的 <code>Console</code>，如果出现了找不到符号 <code>$</code>，因为首先加载的 <span class=\"markbutton bgblue\">autoload.js</span>，里面第一个干的事情就是通过 <code>Ajax</code> 去请求 <span class=\"markbutton bgblue\">live2d.min.js</span> 与 <span class=\"markbutton bgblue\">waifu-tips.js</span>，所以要保证你已经导入了 <code>jQuery</code> 库，如果没有的话请在 <code>你的Hexo根目录/themes/next/layout/_layout.swing</code> 中，<code>&lt;/head&gt;</code> 标签前，手动导入 <code>jQuery</code>。</p>\n<h3 id=\"loadlive2d方法未定义\"><a href=\"#loadlive2d方法未定义\" class=\"headerlink\" title=\"loadlive2d方法未定义\"></a>loadlive2d方法未定义</h3><p>在你的 <span class=\"markbutton bgblue\">autoload.js</span> 文件中，将加载 <span class=\"markbutton bgblue\">live2d.min.js</span> 那一段的 <code>URL</code> 请求改为：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 上面省略</span></span><br><span class=\"line\">url: <span class=\"string\">\"https://cdn.jsdelivr.net/gh/stevenjoezhang/live2d-widget/live2d.min.js\"</span>,</span><br><span class=\"line\"><span class=\"comment\">// 下面省略</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"CROS跨域请求失败\"><a href=\"#CROS跨域请求失败\" class=\"headerlink\" title=\"CROS跨域请求失败\"></a>CROS跨域请求失败</h3><p>因为 <del>人尽皆知</del> 的原因，在 <span class=\"markbutton bgblue\">waifu-tips.js</span> 中第 <code>162</code> 行向目标发起了一个 <code>getJSON</code> 请求你的目标文件 <span class=\"markbutton bgblue\">waifu-tips.json</span>，这里会出现问题，需要你去设置跨域请求头。</p>\n<p>我是用的 <code>Nginx</code> 来部署博客的，所以就用 <code>Nginx</code> 举例：</p>\n<p>在你的 <code>Nginx</code> 网站配置文件中，在你的服务里面，添加如下代码：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">add_header <span class=\"string\">'Access-Control-Allow-Origin'</span> <span class=\"string\">'*'</span>;</span><br><span class=\"line\">add_header <span class=\"string\">'Access-Control-Allow-Credentials'</span> <span class=\"string\">'true'</span>;</span><br><span class=\"line\">add_header <span class=\"string\">'Access-Control-Allow-Methods'</span> <span class=\"string\">'GET, POST, OPTIONS'</span>;</span><br></pre></td></tr></table></figure>\n\n<p>然后重启你的 <code>Nginx</code> 服务即可解决。</p>\n<h3 id=\"奇奇怪怪的问题\"><a href=\"#奇奇怪怪的问题\" class=\"headerlink\" title=\"奇奇怪怪的问题\"></a>奇奇怪怪的问题</h3><p>使用 <code>hexo g</code> 后，在你的 <code>/public/</code> 文件夹中会生成一个 <code>/live2d-widget/</code> 文件，其中 <span class=\"markbutton bgblue\">waifu-tips.js</span> 会有一些莫名其妙的问题，你需要将你的 <code>Hexo/source/live2d-widget/waifu-tips.js</code> 复制粘贴覆盖掉 <code>public</code> 目录下那个有问题的文件中的内容。同理，<span class=\"markbutton bgblue\">waifu-tips.json</span> 也会有一些奇奇怪怪的问题，也需要你手动的去覆盖一次。</p>\n<p>P.S.觉得麻烦的可以写一个 <code>bash</code> 脚本，代码大致如下：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\">hexo clean</span><br><span class=\"line\">hexo g</span><br><span class=\"line\">rm ./public/live2d-widget/waifu-tips.js</span><br><span class=\"line\">rm ./public/live2d-widget/waifu-tips.json</span><br><span class=\"line\">cp ./<span class=\"built_in\">source</span>/live2d-widget/waifu-tips.js ./public/live2d-widget/</span><br><span class=\"line\">cp ./<span class=\"built_in\">source</span>/live2d-widget/waifu-tips.json ./public/live2d-widget/</span><br><span class=\"line\"><span class=\"built_in\">echo</span> OK</span><br></pre></td></tr></table></figure>\n\n<p>然后就可以一键生成辽~</p>"}],"PostAsset":[{"_id":"source/_posts/2019银川ACM区域赛总结/20191020_141204.jpg","slug":"20191020_141204.jpg","post":"ck5obqn4r00002lwj36g994ba","modified":1,"renderable":0},{"_id":"source/_posts/原生JavaScript实现Ajax/image.jpg","slug":"image.jpg","post":"ck5obqn6600152lwj4bqfdksm","modified":1,"renderable":0},{"_id":"source/_posts/Hexo-NexT魔改系列-02-配置博客背景轮播图/F12.jpg","post":"ck5obqn5700062lwj7ivud9z9","slug":"F12.jpg","modified":1,"renderable":1},{"_id":"source/_posts/Hexo-NexT魔改系列-04-进阶设置/footer.png","post":"ck5obqn5e000a2lwjd6w6fv0u","slug":"footer.png","modified":1,"renderable":1},{"_id":"source/_posts/关于渐进增强与优雅降级/main.png","post":"ck5obqn6500122lwjg5oia3r1","slug":"main.png","modified":1,"renderable":1},{"_id":"source/_posts/JavaScript观察者模式与发布订阅/ObserverPattern.png","post":"ck5obqn5u000k2lwjev7necfz","slug":"ObserverPattern.png","modified":1,"renderable":1},{"_id":"source/_posts/JavaScript观察者模式与发布订阅/PubSubPattern.gif","post":"ck5obqn5u000k2lwjev7necfz","slug":"PubSubPattern.gif","modified":1,"renderable":1},{"_id":"source/_posts/JavaScript观察者模式与发布订阅/vs.jpeg","post":"ck5obqn5u000k2lwjev7necfz","slug":"vs.jpeg","modified":1,"renderable":1},{"_id":"source/_posts/Hexo-NexT魔改系列-03-添加数据统计/busuanzi.png","post":"ck5obqn5900082lwj9482hjee","slug":"busuanzi.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo-NexT魔改系列-03-添加数据统计/mini_footer.png","post":"ck5obqn5900082lwj9482hjee","slug":"mini_footer.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo-NexT魔改系列-03-添加数据统计/normal_footer.png","post":"ck5obqn5900082lwj9482hjee","slug":"normal_footer.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo-NexT魔改系列-03-添加数据统计/title.png","post":"ck5obqn5900082lwj9482hjee","slug":"title.png","modified":1,"renderable":1},{"_id":"source/_posts/JavaScript的基本组成部分/DOM_tree.png","post":"ck5obqn5i000g2lwjgnk8fvbc","slug":"DOM_tree.png","modified":1,"renderable":1},{"_id":"source/_posts/JavaScript的基本组成部分/java-script.jpg","post":"ck5obqn5i000g2lwjgnk8fvbc","slug":"java-script.jpg","modified":1,"renderable":1},{"_id":"source/_posts/JavaScript的基本组成部分/jszxgc.png","post":"ck5obqn5i000g2lwjgnk8fvbc","slug":"jszxgc.png","modified":1,"renderable":1},{"_id":"source/_posts/JavaScript的基本组成部分/structure.png","post":"ck5obqn5i000g2lwjgnk8fvbc","slug":"structure.png","modified":1,"renderable":1},{"_id":"source/_posts/JavaScript面向对象-02-Prototype/base__proto__.png","post":"ck5obqn5y000q2lwjckj9ayrl","slug":"base__proto__.png","modified":1,"renderable":1},{"_id":"source/_posts/JavaScript面向对象-02-Prototype/object.png","post":"ck5obqn5y000q2lwjckj9ayrl","slug":"object.png","modified":1,"renderable":1},{"_id":"source/_posts/JavaScript面向对象-02-Prototype/prototype_dir.png","post":"ck5obqn5y000q2lwjckj9ayrl","slug":"prototype_dir.png","modified":1,"renderable":1},{"_id":"source/_posts/JavaScript面向对象-02-Prototype/yuanxinglian.png","post":"ck5obqn5y000q2lwjckj9ayrl","slug":"yuanxinglian.png","modified":1,"renderable":1},{"_id":"source/_posts/2019银川ACM区域赛总结/20191019_145938.jpg","slug":"20191019_145938.jpg","post":"ck5obqn4r00002lwj36g994ba","modified":1,"renderable":0},{"_id":"source/_posts/2019银川ACM区域赛总结/20191020_141340.jpg","slug":"20191020_141340.jpg","post":"ck5obqn4r00002lwj36g994ba","modified":1,"renderable":0},{"_id":"source/_posts/2019银川ACM区域赛总结/20191022161721.jpg","slug":"20191022161721.jpg","post":"ck5obqn4r00002lwj36g994ba","modified":1,"renderable":0},{"_id":"source/_posts/2019银川ACM区域赛总结/acm.jpg","slug":"acm.jpg","post":"ck5obqn4r00002lwj36g994ba","modified":1,"renderable":0},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm/1024px-KnnClassification.svg.png","post":"ck5obqn61000w2lwjetj3b9p4","slug":"1024px-KnnClassification.svg.png","modified":1,"renderable":1},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm/run01.png","slug":"run01.png","post":"ck5obqn61000w2lwjetj3b9p4","modified":1,"renderable":0},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm/run02.png","slug":"run02.png","post":"ck5obqn61000w2lwjetj3b9p4","modified":1,"renderable":0},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm/run03.png","slug":"run03.png","post":"ck5obqn61000w2lwjetj3b9p4","modified":1,"renderable":0},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm/run04.png","slug":"run04.png","post":"ck5obqn61000w2lwjetj3b9p4","modified":1,"renderable":0},{"_id":"source/_posts/The-K-Nearest-Neighbor-Algorithm/temp.png","post":"ck5obqn61000w2lwjetj3b9p4","slug":"temp.png","modified":1,"renderable":1},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/TcpMessage.png","post":"ck5obqn6n001c2lwj7kyn8i6x","slug":"TcpMessage.png","modified":1,"renderable":1},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/four.gif","slug":"four.gif","post":"ck5obqn6n001c2lwj7kyn8i6x","modified":1,"renderable":0},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/four.png","post":"ck5obqn6n001c2lwj7kyn8i6x","slug":"four.png","modified":1,"renderable":1},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/four01.png","post":"ck5obqn6n001c2lwj7kyn8i6x","slug":"four01.png","modified":1,"renderable":1},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/three.gif","slug":"three.gif","post":"ck5obqn6n001c2lwj7kyn8i6x","modified":1,"renderable":0},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/three.png","post":"ck5obqn6n001c2lwj7kyn8i6x","slug":"three.png","modified":1,"renderable":1},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/three01.png","post":"ck5obqn6n001c2lwj7kyn8i6x","slug":"three01.png","modified":1,"renderable":1},{"_id":"source/_posts/来说说TCP的三次握手和四次挥手吧/total.png","slug":"total.png","post":"ck5obqn6n001c2lwj7kyn8i6x","modified":1,"renderable":0},{"_id":"source/_posts/Hexo博客的安装与基本配置/fork-on-github.png","post":"ck5obqn5h000e2lwj52zf0kud","slug":"fork-on-github.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo博客的安装与基本配置/hide-hexo.png","post":"ck5obqn5h000e2lwj52zf0kud","slug":"hide-hexo.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo博客的安装与基本配置/my-copyright.png","post":"ck5obqn5h000e2lwj52zf0kud","slug":"my-copyright.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo博客的安装与基本配置/show-copyright.png","post":"ck5obqn5h000e2lwj52zf0kud","slug":"show-copyright.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo博客的安装与基本配置/social-links.png","post":"ck5obqn5h000e2lwj52zf0kud","slug":"social-links.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo博客的安装与基本配置/thanks.png","post":"ck5obqn5h000e2lwj52zf0kud","slug":"thanks.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo博客的安装与基本配置/tomorrow-night-blue.png","post":"ck5obqn5h000e2lwj52zf0kud","slug":"tomorrow-night-blue.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo博客的安装与基本配置/tomorrow-night-bright.png","post":"ck5obqn5h000e2lwj52zf0kud","slug":"tomorrow-night-bright.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo博客的安装与基本配置/tomorrow-night-eighties.png","post":"ck5obqn5h000e2lwj52zf0kud","slug":"tomorrow-night-eighties.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo博客的安装与基本配置/tomorrow-night.png","post":"ck5obqn5h000e2lwj52zf0kud","slug":"tomorrow-night.png","modified":1,"renderable":1},{"_id":"source/_posts/Hexo博客的安装与基本配置/tomorrow.png","post":"ck5obqn5h000e2lwj52zf0kud","slug":"tomorrow.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/UML_shixu.jpg","post":"ck5obqn62000y2lwj9nnweh6q","slug":"UML_shixu.jpg","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/UML_yongli.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"UML_yongli.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/aggregation.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"aggregation.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/association.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"association.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/composition.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"composition.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/dependency.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"dependency.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/generalization.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"generalization.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/group.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"group.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/implements.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"implements.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/shengmingxian.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"shengmingxian.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/tongbuxiaoxi.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"tongbuxiaoxi.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/yibuxiaoxi.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"yibuxiaoxi.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/yueshu.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"yueshu.png","modified":1,"renderable":1},{"_id":"source/_posts/UML图例详解/zhushi.png","post":"ck5obqn62000y2lwj9nnweh6q","slug":"zhushi.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/Epsilon2.1.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"Epsilon2.1.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/Gantzert_Felixander.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"Gantzert_Felixander.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/Unitychan.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"Unitychan.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/chitose.jpg","post":"ck5obqn6o001e2lwjhxx884ul","slug":"chitose.jpg","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/haru.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"haru.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/haruto.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"haruto.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/hibiki.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"hibiki.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/hijiki.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"hijiki.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/izumi.jpg","post":"ck5obqn6o001e2lwjhxx884ul","slug":"izumi.jpg","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/koharu.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"koharu.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/miku.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"miku.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/models.jpg","post":"ck5obqn6o001e2lwjhxx884ul","slug":"models.jpg","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/ni-j.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"ni-j.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/nico.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"nico.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/nietzche.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"nietzche.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/nipsilon.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"nipsilon.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/nito.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"nito.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/shizuku.gif","slug":"shizuku.gif","post":"ck5obqn6o001e2lwjhxx884ul","modified":1,"renderable":0},{"_id":"source/_posts/设置你喜欢的live2d看板娘/shizuku.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"shizuku.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/tororo.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"tororo.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/tsumiki.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"tsumiki.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/wanko.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"wanko.png","modified":1,"renderable":1},{"_id":"source/_posts/设置你喜欢的live2d看板娘/z16.png","post":"ck5obqn6o001e2lwjhxx884ul","slug":"z16.png","modified":1,"renderable":1}],"PostCategory":[{"post_id":"ck5obqn5h000e2lwj52zf0kud","category_id":"ck5obqn5f000b2lwj94ot25rn","_id":"ck5obqn5w000n2lwjgv4k4uxo"},{"post_id":"ck5obqn4r00002lwj36g994ba","category_id":"ck5obqn5300042lwjga112xcn","_id":"ck5obqn6600142lwj0bp70hg9"},{"post_id":"ck5obqn4r00002lwj36g994ba","category_id":"ck5obqn60000t2lwj6j716v61","_id":"ck5obqn6f00172lwjfxvv74xz"},{"post_id":"ck5obqn61000w2lwjetj3b9p4","category_id":"ck5obqn6z001y2lwj2j4s4lau","_id":"ck5obqn7100232lwjd5fv50hi"},{"post_id":"ck5obqn62000y2lwj9nnweh6q","category_id":"ck5obqn7000202lwjbka7ht5q","_id":"ck5obqn73002a2lwjdmjidy9a"},{"post_id":"ck5obqn4z00022lwj81026hk2","category_id":"ck5obqn5f000b2lwj94ot25rn","_id":"ck5obqn7a002q2lwjfs07fx0l"},{"post_id":"ck5obqn4z00022lwj81026hk2","category_id":"ck5obqn6600132lwjamnq7dcq","_id":"ck5obqn7b002t2lwj0eq6h6o3"},{"post_id":"ck5obqn4z00022lwj81026hk2","category_id":"ck5obqn78002m2lwjembq0i0h","_id":"ck5obqn7c002v2lwjc5vib0g4"},{"post_id":"ck5obqn6o001e2lwjhxx884ul","category_id":"ck5obqn5f000b2lwj94ot25rn","_id":"ck5obqn7g00392lwjb2316mmf"},{"post_id":"ck5obqn6o001e2lwjhxx884ul","category_id":"ck5obqn6600132lwjamnq7dcq","_id":"ck5obqn7h003a2lwj4xs5ddbt"},{"post_id":"ck5obqn6o001e2lwjhxx884ul","category_id":"ck5obqn7d00312lwjfmwk45xh","_id":"ck5obqn7h003c2lwjazxhhkgo"},{"post_id":"ck5obqn5700062lwj7ivud9z9","category_id":"ck5obqn5f000b2lwj94ot25rn","_id":"ck5obqn7k003h2lwj8amz9f3z"},{"post_id":"ck5obqn5700062lwj7ivud9z9","category_id":"ck5obqn6600132lwjamnq7dcq","_id":"ck5obqn7m003k2lwj1t6y9osh"},{"post_id":"ck5obqn5700062lwj7ivud9z9","category_id":"ck5obqn78002m2lwjembq0i0h","_id":"ck5obqn7o003m2lwj2t8afxnb"},{"post_id":"ck5obqn5900082lwj9482hjee","category_id":"ck5obqn5f000b2lwj94ot25rn","_id":"ck5obqn7q003t2lwj8zbf0v3b"},{"post_id":"ck5obqn5900082lwj9482hjee","category_id":"ck5obqn6600132lwjamnq7dcq","_id":"ck5obqn7r003w2lwj509rdm5z"},{"post_id":"ck5obqn5900082lwj9482hjee","category_id":"ck5obqn78002m2lwjembq0i0h","_id":"ck5obqn7s003z2lwj2x47dvnb"},{"post_id":"ck5obqn6300102lwjhq0iaio9","category_id":"ck5obqn6g00192lwjctnw5q98","_id":"ck5obqn7t00422lwj9ivc47r6"},{"post_id":"ck5obqn6300102lwjhq0iaio9","category_id":"ck5obqn7c002x2lwj7ynm3y2b","_id":"ck5obqn7u00452lwjc4ox5t7j"},{"post_id":"ck5obqn5e000a2lwjd6w6fv0u","category_id":"ck5obqn5f000b2lwj94ot25rn","_id":"ck5obqn7v00482lwjgz8lfgxo"},{"post_id":"ck5obqn5e000a2lwjd6w6fv0u","category_id":"ck5obqn6600132lwjamnq7dcq","_id":"ck5obqn7v004a2lwjbsljewjn"},{"post_id":"ck5obqn5e000a2lwjd6w6fv0u","category_id":"ck5obqn78002m2lwjembq0i0h","_id":"ck5obqn7w004c2lwj0lab5yv0"},{"post_id":"ck5obqn6500122lwjg5oia3r1","category_id":"ck5obqn6g00192lwjctnw5q98","_id":"ck5obqn7x004e2lwj7zucazlv"},{"post_id":"ck5obqn6500122lwjg5oia3r1","category_id":"ck5obqn7c002x2lwj7ynm3y2b","_id":"ck5obqn7y004h2lwj3ck899az"},{"post_id":"ck5obqn6600152lwj4bqfdksm","category_id":"ck5obqn6g00192lwjctnw5q98","_id":"ck5obqn7z004k2lwj1vs07wab"},{"post_id":"ck5obqn6600152lwj4bqfdksm","category_id":"ck5obqn7c002x2lwj7ynm3y2b","_id":"ck5obqn7z004l2lwjfgld6rq6"},{"post_id":"ck5obqn6g001a2lwj1hmr1a7a","category_id":"ck5obqn79002o2lwj1n38ff4q","_id":"ck5obqn80004o2lwj8qeha67w"},{"post_id":"ck5obqn6g001a2lwj1hmr1a7a","category_id":"ck5obqn7x004g2lwj2r471jyf","_id":"ck5obqn81004r2lwjcm3c4y9u"},{"post_id":"ck5obqn5i000g2lwjgnk8fvbc","category_id":"ck5obqn6g00192lwjctnw5q98","_id":"ck5obqn84004y2lwj98hs8zhm"},{"post_id":"ck5obqn5i000g2lwjgnk8fvbc","category_id":"ck5obqn7c002x2lwj7ynm3y2b","_id":"ck5obqn8400502lwjbqsnh7s1"},{"post_id":"ck5obqn5i000g2lwjgnk8fvbc","category_id":"ck5obqn80004p2lwj772pdm51","_id":"ck5obqn8500522lwjb92c0dm3"},{"post_id":"ck5obqn5w000m2lwj6sl482pf","category_id":"ck5obqn6g00192lwjctnw5q98","_id":"ck5obqn8700562lwjh7hfgjw3"},{"post_id":"ck5obqn5w000m2lwj6sl482pf","category_id":"ck5obqn7c002x2lwj7ynm3y2b","_id":"ck5obqn8700582lwj02ua6x2o"},{"post_id":"ck5obqn5w000m2lwj6sl482pf","category_id":"ck5obqn80004p2lwj772pdm51","_id":"ck5obqn88005c2lwja0yj4m1c"},{"post_id":"ck5obqn5y000q2lwjckj9ayrl","category_id":"ck5obqn6g00192lwjctnw5q98","_id":"ck5obqn89005d2lwj1k264f7g"},{"post_id":"ck5obqn5y000q2lwjckj9ayrl","category_id":"ck5obqn7c002x2lwj7ynm3y2b","_id":"ck5obqn8a005h2lwjdtq32wpt"},{"post_id":"ck5obqn5y000q2lwjckj9ayrl","category_id":"ck5obqn80004p2lwj772pdm51","_id":"ck5obqn8b005j2lwjf5h9hycp"},{"post_id":"ck5obqn5z000s2lwjdzglgd8p","category_id":"ck5obqn6g00192lwjctnw5q98","_id":"ck5obqn8c005l2lwjgot1420r"},{"post_id":"ck5obqn5z000s2lwjdzglgd8p","category_id":"ck5obqn7c002x2lwj7ynm3y2b","_id":"ck5obqn8c005n2lwjbojj655z"},{"post_id":"ck5obqn5z000s2lwjdzglgd8p","category_id":"ck5obqn80004p2lwj772pdm51","_id":"ck5obqn8i005q2lwjgmzs19us"},{"post_id":"ck5obqn6f00182lwj50wx4q7f","category_id":"ck5obqn6g00192lwjctnw5q98","_id":"ck5obqn8i005s2lwjeiks2wez"},{"post_id":"ck5obqn6f00182lwj50wx4q7f","category_id":"ck5obqn7c002x2lwj7ynm3y2b","_id":"ck5obqn8j005u2lwjafml0waf"},{"post_id":"ck5obqn6f00182lwj50wx4q7f","category_id":"ck5obqn80004p2lwj772pdm51","_id":"ck5obqn8p005v2lwj09tjhtra"},{"post_id":"ck5obqn6n001c2lwj7kyn8i6x","category_id":"ck5obqn7a002r2lwje8c59sn3","_id":"ck5obqn8q005y2lwjgdu58p8l"},{"post_id":"ck5obqn6n001c2lwj7kyn8i6x","category_id":"ck5obqn7z004m2lwjh7da57s9","_id":"ck5obqn8q00602lwjhlhv6chx"},{"post_id":"ck5obqn6n001c2lwj7kyn8i6x","category_id":"ck5obqn8a005g2lwjf4b6a6lc","_id":"ck5obqn8r00622lwjabx5bf3v"},{"post_id":"ck5obqn5u000k2lwjev7necfz","category_id":"ck5obqn6g00192lwjctnw5q98","_id":"ck5obqn8r00632lwj3wpl5khd"},{"post_id":"ck5obqn5u000k2lwjev7necfz","category_id":"ck5obqn7c002x2lwj7ynm3y2b","_id":"ck5obqn8r00652lwjh0s45i2a"},{"post_id":"ck5obqn5u000k2lwjev7necfz","category_id":"ck5obqn80004p2lwj772pdm51","_id":"ck5obqn8s00662lwjabpufapj"},{"post_id":"ck5obqn5u000k2lwjev7necfz","category_id":"ck5obqn8c005m2lwj4ata7tt0","_id":"ck5obqn8s00682lwjg5h50d27"}],"PostTag":[{"post_id":"ck5obqn4r00002lwj36g994ba","tag_id":"ck5obqn5400052lwj8atwg2gw","_id":"ck5obqn5z000r2lwje2524191"},{"post_id":"ck5obqn4r00002lwj36g994ba","tag_id":"ck5obqn5f000c2lwj7v4bf6q9","_id":"ck5obqn60000u2lwj83uj7vm1"},{"post_id":"ck5obqn4r00002lwj36g994ba","tag_id":"ck5obqn5k000j2lwjd9031hje","_id":"ck5obqn62000x2lwj65j8gq6g"},{"post_id":"ck5obqn4z00022lwj81026hk2","tag_id":"ck5obqn5x000p2lwj658569pq","_id":"ck5obqn6o001d2lwj0ibhel1w"},{"post_id":"ck5obqn4z00022lwj81026hk2","tag_id":"ck5obqn60000v2lwj0wqd0wiq","_id":"ck5obqn6p001g2lwj15bie9ve"},{"post_id":"ck5obqn4z00022lwj81026hk2","tag_id":"ck5obqn6400112lwjdr7m57xs","_id":"ck5obqn6s001i2lwjca193auy"},{"post_id":"ck5obqn4z00022lwj81026hk2","tag_id":"ck5obqn6f00162lwjfust7h90","_id":"ck5obqn6t001k2lwjb97je6n7"},{"post_id":"ck5obqn5700062lwj7ivud9z9","tag_id":"ck5obqn5x000p2lwj658569pq","_id":"ck5obqn6w001q2lwj5l5v39qf"},{"post_id":"ck5obqn5700062lwj7ivud9z9","tag_id":"ck5obqn60000v2lwj0wqd0wiq","_id":"ck5obqn6x001s2lwjgi7abbj0"},{"post_id":"ck5obqn5700062lwj7ivud9z9","tag_id":"ck5obqn6400112lwjdr7m57xs","_id":"ck5obqn6x001u2lwj0nsoepwb"},{"post_id":"ck5obqn5700062lwj7ivud9z9","tag_id":"ck5obqn6f00162lwjfust7h90","_id":"ck5obqn6y001w2lwjbche9dc5"},{"post_id":"ck5obqn5900082lwj9482hjee","tag_id":"ck5obqn5x000p2lwj658569pq","_id":"ck5obqn7100222lwjhyuubu3b"},{"post_id":"ck5obqn5900082lwj9482hjee","tag_id":"ck5obqn60000v2lwj0wqd0wiq","_id":"ck5obqn7200242lwjf6io1t69"},{"post_id":"ck5obqn5900082lwj9482hjee","tag_id":"ck5obqn6400112lwjdr7m57xs","_id":"ck5obqn7300272lwj4r0rgbol"},{"post_id":"ck5obqn5900082lwj9482hjee","tag_id":"ck5obqn6f00162lwjfust7h90","_id":"ck5obqn7300282lwjedg9d1k7"},{"post_id":"ck5obqn5e000a2lwjd6w6fv0u","tag_id":"ck5obqn5x000p2lwj658569pq","_id":"ck5obqn76002g2lwjffkphd5f"},{"post_id":"ck5obqn5e000a2lwjd6w6fv0u","tag_id":"ck5obqn60000v2lwj0wqd0wiq","_id":"ck5obqn77002h2lwjaiai3k9l"},{"post_id":"ck5obqn5e000a2lwjd6w6fv0u","tag_id":"ck5obqn6400112lwjdr7m57xs","_id":"ck5obqn78002k2lwj7bycaxbd"},{"post_id":"ck5obqn5e000a2lwjd6w6fv0u","tag_id":"ck5obqn6f00162lwjfust7h90","_id":"ck5obqn78002l2lwj5zu29exi"},{"post_id":"ck5obqn5h000e2lwj52zf0kud","tag_id":"ck5obqn5x000p2lwj658569pq","_id":"ck5obqn7b002u2lwj7d0m35t8"},{"post_id":"ck5obqn5h000e2lwj52zf0kud","tag_id":"ck5obqn77002j2lwj7ibsf3rf","_id":"ck5obqn7c002w2lwjf5eb2hob"},{"post_id":"ck5obqn5h000e2lwj52zf0kud","tag_id":"ck5obqn79002n2lwj4rh1dw5m","_id":"ck5obqn7c002z2lwjhyxodw3r"},{"post_id":"ck5obqn5h000e2lwj52zf0kud","tag_id":"ck5obqn60000v2lwj0wqd0wiq","_id":"ck5obqn7d00302lwj5pt4fio1"},{"post_id":"ck5obqn5i000g2lwjgnk8fvbc","tag_id":"ck5obqn7b002s2lwj9cgmas2i","_id":"ck5obqn7e00332lwj5wn14njl"},{"post_id":"ck5obqn5i000g2lwjgnk8fvbc","tag_id":"ck5obqn7c002y2lwj8ziaeehf","_id":"ck5obqn7e00342lwj9mbf27hj"},{"post_id":"ck5obqn5u000k2lwjev7necfz","tag_id":"ck5obqn7b002s2lwj9cgmas2i","_id":"ck5obqn7j003e2lwj7e4u7hr7"},{"post_id":"ck5obqn5u000k2lwjev7necfz","tag_id":"ck5obqn7c002y2lwj8ziaeehf","_id":"ck5obqn7j003f2lwjgmmr5pce"},{"post_id":"ck5obqn5u000k2lwjev7necfz","tag_id":"ck5obqn7f00372lwj9cxoexzj","_id":"ck5obqn7k003j2lwjgyg61lpm"},{"post_id":"ck5obqn5w000m2lwj6sl482pf","tag_id":"ck5obqn7b002s2lwj9cgmas2i","_id":"ck5obqn7p003o2lwjfcl1hh77"},{"post_id":"ck5obqn5w000m2lwj6sl482pf","tag_id":"ck5obqn7c002y2lwj8ziaeehf","_id":"ck5obqn7p003p2lwj6zhd1iud"},{"post_id":"ck5obqn5y000q2lwjckj9ayrl","tag_id":"ck5obqn7b002s2lwj9cgmas2i","_id":"ck5obqn7r003v2lwj8ron9vav"},{"post_id":"ck5obqn5y000q2lwjckj9ayrl","tag_id":"ck5obqn7c002y2lwj8ziaeehf","_id":"ck5obqn7r003x2lwjbn7iavit"},{"post_id":"ck5obqn5z000s2lwjdzglgd8p","tag_id":"ck5obqn7b002s2lwj9cgmas2i","_id":"ck5obqn7u00442lwjacyy07h1"},{"post_id":"ck5obqn5z000s2lwjdzglgd8p","tag_id":"ck5obqn7c002y2lwj8ziaeehf","_id":"ck5obqn7u00462lwj2hxo20s9"},{"post_id":"ck5obqn61000w2lwjetj3b9p4","tag_id":"ck5obqn7t00432lwje2locfux","_id":"ck5obqn7x004f2lwj2yi12yia"},{"post_id":"ck5obqn61000w2lwjetj3b9p4","tag_id":"ck5obqn7v00492lwj435zcnyd","_id":"ck5obqn7y004i2lwjgqot4k4h"},{"post_id":"ck5obqn62000y2lwj9nnweh6q","tag_id":"ck5obqn7f00372lwj9cxoexzj","_id":"ck5obqn81004s2lwjd2u0fa16"},{"post_id":"ck5obqn62000y2lwj9nnweh6q","tag_id":"ck5obqn7y004j2lwj3ppn6n1m","_id":"ck5obqn82004u2lwj9v5w2o1b"},{"post_id":"ck5obqn62000y2lwj9nnweh6q","tag_id":"ck5obqn7z004n2lwjenrp344o","_id":"ck5obqn83004w2lwj2zgp1rhr"},{"post_id":"ck5obqn6300102lwjhq0iaio9","tag_id":"ck5obqn81004q2lwjfu3z1514","_id":"ck5obqn8600542lwjeuta2j8j"},{"post_id":"ck5obqn6300102lwjhq0iaio9","tag_id":"ck5obqn82004v2lwj07gf1ro5","_id":"ck5obqn8700572lwj2uiif1ei"},{"post_id":"ck5obqn6300102lwjhq0iaio9","tag_id":"ck5obqn84004z2lwjdi4ph05f","_id":"ck5obqn88005a2lwj9uud37s1"},{"post_id":"ck5obqn6500122lwjg5oia3r1","tag_id":"ck5obqn7b002s2lwj9cgmas2i","_id":"ck5obqn8a005f2lwj7zne9ok7"},{"post_id":"ck5obqn6500122lwjg5oia3r1","tag_id":"ck5obqn82004v2lwj07gf1ro5","_id":"ck5obqn8b005i2lwj27uo9hzl"},{"post_id":"ck5obqn6600152lwj4bqfdksm","tag_id":"ck5obqn7b002s2lwj9cgmas2i","_id":"ck5obqn8d005p2lwj2xafhexo"},{"post_id":"ck5obqn6600152lwj4bqfdksm","tag_id":"ck5obqn82004v2lwj07gf1ro5","_id":"ck5obqn8i005r2lwj0f2hbvzx"},{"post_id":"ck5obqn6f00182lwj50wx4q7f","tag_id":"ck5obqn7b002s2lwj9cgmas2i","_id":"ck5obqn8q005x2lwj7ixl1060"},{"post_id":"ck5obqn6f00182lwj50wx4q7f","tag_id":"ck5obqn7c002y2lwj8ziaeehf","_id":"ck5obqn8q005z2lwjfy3sd82p"},{"post_id":"ck5obqn6g001a2lwj1hmr1a7a","tag_id":"ck5obqn8p005w2lwj1mkvdom9","_id":"ck5obqn8s00692lwjade8cfb6"},{"post_id":"ck5obqn6g001a2lwj1hmr1a7a","tag_id":"ck5obqn8q00612lwjepbc4ap5","_id":"ck5obqn8t006a2lwj8h5048pk"},{"post_id":"ck5obqn6g001a2lwj1hmr1a7a","tag_id":"ck5obqn8r00642lwj3y0aansh","_id":"ck5obqn8t006c2lwj0umy0q71"},{"post_id":"ck5obqn6n001c2lwj7kyn8i6x","tag_id":"ck5obqn8s00672lwj1ehbgbke","_id":"ck5obqn8u006d2lwjg44h2y86"},{"post_id":"ck5obqn6o001e2lwjhxx884ul","tag_id":"ck5obqn5x000p2lwj658569pq","_id":"ck5obqn8u006e2lwjcb5f99rb"},{"post_id":"ck5obqn6o001e2lwjhxx884ul","tag_id":"ck5obqn79002n2lwj4rh1dw5m","_id":"ck5obqn8u006f2lwjapqnhipn"},{"post_id":"ck5obqn6o001e2lwjhxx884ul","tag_id":"ck5obqn60000v2lwj0wqd0wiq","_id":"ck5obqn8v006g2lwjfu658c1z"}],"Tag":[{"name":"ACM","_id":"ck5obqn5400052lwj8atwg2gw"},{"name":"比赛","_id":"ck5obqn5f000c2lwj7v4bf6q9"},{"name":"算法","_id":"ck5obqn5k000j2lwjd9031hje"},{"name":"Hexo","_id":"ck5obqn5x000p2lwj658569pq"},{"name":"NexT","_id":"ck5obqn60000v2lwj0wqd0wiq"},{"name":"魔改","_id":"ck5obqn6400112lwjdr7m57xs"},{"name":"瞎折腾","_id":"ck5obqn6f00162lwjfust7h90"},{"name":"建站","_id":"ck5obqn77002j2lwj7ibsf3rf"},{"name":"Nginx","_id":"ck5obqn79002n2lwj4rh1dw5m"},{"name":"Web","_id":"ck5obqn7b002s2lwj9cgmas2i"},{"name":"JavaScript","_id":"ck5obqn7c002y2lwj8ziaeehf"},{"name":"设计模式","_id":"ck5obqn7f00372lwj9cxoexzj"},{"name":"Python","_id":"ck5obqn7t00432lwje2locfux"},{"name":"人工智能","_id":"ck5obqn7v00492lwj435zcnyd"},{"name":"UML","_id":"ck5obqn7y004j2lwj3ppn6n1m"},{"name":"软件工程","_id":"ck5obqn7z004n2lwjenrp344o"},{"name":"HTML","_id":"ck5obqn81004q2lwjfu3z1514"},{"name":"浏览器","_id":"ck5obqn82004v2lwj07gf1ro5"},{"name":"web","_id":"ck5obqn84004z2lwjdi4ph05f"},{"name":"PHP","_id":"ck5obqn8p005w2lwj1mkvdom9"},{"name":"ThinkPHP5","_id":"ck5obqn8q00612lwjepbc4ap5"},{"name":"Apache","_id":"ck5obqn8r00642lwj3y0aansh"},{"name":"计算机网络","_id":"ck5obqn8s00672lwj1ehbgbke"}]}}